#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.23 $
# $Date: 2020/04/22 $
#
# Description	: This .audit is designed against the CIS Security Configuration
# 			  Benchmark For Oracle Database Server 11g version 1.1.0, December 31, 2011.
# 			  https://workbench.cisecurity.org/files/580
# 	  		  Oracle 11g version 11.2.0.2.0 installed on CentOS 5 was used in testing and developing
# 			  this .audit file.
#
# NOTE 			: Portions of the checklist require interview or manual inspection and are not included here.
#
# NOTE			: The checks in this audit were written against a default installation of
# 			  Oracle and assumes default installation locations, accounts, etc. The audits contained in this
# 			  document audit are for Level 1 items of the CIS Oracle Database Server 11g Benchmark and are
# 			  specific to the operating system and not the database.
#
# NOTE			: Some queries in this .audit require site-specific data to be
# 			  known to the query in order to function properly.  Please note
# 			  the following queries and edit their values accordingly.
#
#<ui_metadata>
#<display_name>CIS v1.1.0 Oracle 11g DB Level 1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Oracle 11g DB Level 1</name>
#  <version>1.1.0</version>
#  <link>https://workbench.cisecurity.org/files/580</link>
#</spec>
#<labels>database,cis,oracle,oracle_11g</labels>
#</ui_metadata>

<check_type:"Database" db_type:"Oracle" version:"1">
<group_policy:"CIS v1.0.1 Oracle 11g Level 1">

#
## 1. Operating System Specific Settings
#
#
## 2. Installation and Patch
#
#
## 3. Oracle Directory and File Permissions
#
#
## 4. Oracle Parameter Settings
#

<custom_item>
  type        : SQL_POLICY
  description : "4.01 init.ora - '_trace_files_public = FALSE'"
  info        : "Prevents users from having the ability to read trace files which may contain sensitive information about the running Oracle instance. This"
  info        : "is an internal Oracle parameter.  Do NOT use it unless instructed to do so by Oracle Support."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select ksppstvl from sys.x$ksppi x, sys.x$ksppcv y where x.indx=y.indx and x.ksppinm='_trace_files_public';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.02 init.ora - 'global_names = TRUE'"
  info        : "This parameter ensures that Oracle will check that the name of a database link is the same as that of the remote database. Default is TRUE."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'global_names';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Tt][Rr][Uu][Ee]"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.03 init.ora - 'remote_os_authent = false'"
  info        : "This setting has been deprecated, however is maintained for backwards compatibility. If this setting is used it is recommended to be set to"
  info        : "FALSE. remote_os_authent will allow a user that is authenticated to the network domain to access the database without DB credentials."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'remote_os_authent';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-53|IA-5(8),CSF|PR.AC-1,ITSG-33|IA-5(8),SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.04 init.ora - 'remote_os_roles = false'"
  info        : "Connection spoofing must be prevented."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'remote_os_roles';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,800-53|AC-2(7),CIP|005-5-R2,CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,ITSG-33|AC-2(7),NESA|M5.3.1,NESA|T5.4.5,SWIFT-CSCv1|2.6"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.05 init.ora - 'remote_listener = NULL'"
  info        : "Prevent the use of a listener on a remote machine separate from the database instance."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'remote_listener';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS48,NIAv2|NS51,NIAv2|NS5g,NIAv2|NS5h,SWIFT-CSCv1|2.6"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.06 init.ora - 'audit_trail = OS,DB, DB_EXTENDED, XML, or XML, EXTENDED'"
  info        : "Ensures that basic audit features are used. Recommend setting audit_trail to OS as it reduces the likelihood of a Denial of Service attack"
  info        : "and it is easier to secure the audit trail. OS is required if the auditor is distinct from the DBA. Any auditing information stored in the"
  info        : "database is viewable and modifiable by the DBA if set to DB or DB_EXTENDED.  Even with the audit_trail value set to FALSE, an audit session"
  info        : "will report, 'Audit succeeded.'"
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'audit_trail';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Oo][Ss]" || regex: "[Dd][Bb]" || regex: "[[Dd][Bb]_[Ee][Xx][Tt][Ee][Nn][Dd][Ee][Dd]" || regex: "[Xx][Mm][Ll]" || regex: "[Xx][Mm][Ll],\s*[Ee][Xx][Tt][Ee][Nn][Dd][Ee][Dd]"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.07 init.ora - 'os_authent_prefix = NULL String'"
  info        : "OS roles are subject to control outside the database. The duties and responsibilities of DBAs and system administrators must be separated."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'os_authent_prefix';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.08 init.ora - 'os_roles = FALSE'"
  info        : "os_roles allows externally created groups to be used to manage database roles. This can lead to misaligned or inherited permissions. This can"
  info        : "lead to misaligned or inherited permissions"
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'os_roles';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,800-53|AC-2(7),CIP|005-5-R2,CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.AC-4,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,ITSG-33|AC-2(7),NESA|M5.3.1,NESA|T5.4.5,SWIFT-CSCv1|2.6"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.09 init.ora - 'Avoid using utl_file_dir parameters'"
  info        : "Do not use the utl_file_dir parameter directories created with utl_file_dir as they can be read and written to by all users. Specify"
  info        : "directories using CREATE DIRECTORY which requires granting of privileges to each user. This function has been deprecated since version 9.2"
  info        : "migration is recommended."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'utl_file_dir';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|8.4,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.10 init.ora - 'Establish redundant physically separate locations for redo log files.'"
  info        : "Use log_archive_duplex_dest to establish a redundant location for the redo logs."
  info        : "Redundancy for the redo logs can prevent catastrophic loss in the event of a single physical drive failure."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select count(value) from v$parameter where name like 'log_archive_duplex_dest';"
  sql_types   : POLICY_INTEGER
  sql_expect  : regex: "[1-9]+"
  reference   : "800-53|AU-4(1),CSF|PR.DS-4,CSF|PR.PT-1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.11 init.ora - 'Specify redo logging must be successful.'"
  info        : "Use log_archive_min_succeed_dest to ensure the successful logging of the redo files."
  info        : "Specifying that the logging must succeed in one or more locations ensures redundance of the redo logs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select count(value) from v$parameter where name like 'log_archive_min_succeed_dest';"
  sql_types   : POLICY_INTEGER
  sql_expect  : regex: "[1-9]+"
  reference   : "800-53|AU-4(1),CSF|PR.DS-4,CSF|PR.PT-1"
</custom_item>

<report type:"WARNING">
  description : "4.15 Database object definition NOLOGGING clause - 'Do not leave database objects in NOLOGGING mode in production environments'"
  info        : "The NOLOGGING keyword instructs Oracle Database Server to forego writing essential recovery information to the redo log"
  info        : "when performing certain actions, including but not limited to ALTER INDEX, CREATE INDEX, CREATE TABLE, and ALTER TABLE."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires manual verification that database objects are not operating in NOLOGGING mode."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

<custom_item>
  type        : SQL_POLICY
  description : "4.33 init.ora - 'sec_case_sensitive_logon = TRUE'"
  info        : "Set Oracle database password to be case sensitive. This increases the complexity of passwords and helps defend against brute force password"
  info        : "attacks."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'sec_case_sensitive_logon';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Tt][Rr][Uu][Ee]"
  reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.34 init.ora - 'sec_max_failed_login_attempts = 3'"
  info        : "Set the maximum number of failed login attempts to be 3 or in sync with established password policies. This will reduce the effectiveness of"
  info        : "a password brute force attack.  Note: Setting SEC_MAX_FAILED_LOGIN_ATTEMPTS to a value other than UNLIMITED may increase an attacker's"
  info        : "ability to intentionally lockout sensitive accounts, such as those used by middle-tier applications. Given this, implementer's should"
  info        : "consider connectivity restrictions to the Oracle instance backing the application and the determinism of usernames used by such applications."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'sec_max_failed_login_attempts';"
  sql_types   : POLICY_INTEGER
  sql_expect  : regex: "^[0-3]$"
  reference   : "800-171|3.1.8,800-53|AC-7,800-53|SC-5,CN-L3|8.1.4.1(b),CSCv6|16.7,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|AC-7,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|AM24,NIAv2|GS10c,NIAv2|GS8e,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.35 init.ora - 'sec_protocol_error_further_action = DELAY <seconds> or DROP <seconds>'"
  info        : "When bad packets are received from a client the server will wait the specified number of seconds before allowing a connection from the same"
  info        : "client. This help mitigate malicious connections or DOS conditions."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'sec_protocol_error_further_action';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Dd][Rr][Oo][Pp],\s+[0-9]+" || regex: "[Dd][Ee][Ll][Aa][Yy],\s+[0-9]+"
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "4.36 init.ora - 'sec_protocol_error_trace_action = LOG or ALERT'"
  info        : "Specify the action a database should take when a bad packet is received. TRACE generates a detailed trace file and should only be used when"
  info        : "debugging.  ALERT or LOG should be used to capture the event. Use currently established procedures for checking console or log file data to"
  info        : "monitor these events."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select value from v$parameter where name like 'sec_protocol_error_trace_action';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : regex: "[Ll][Oo][Gg]" || regex: "[Aa][Ll][Ee][Rr][Tt]"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,800-53|SC-5,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.DS-4,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,ITSG-33|SC-5,NESA|T3.3.1,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|GS10c,NIAv2|GS8e,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
</custom_item>

#
## 5. Encryption Specific Settings
#
#
## 6. Startup and Shutdown
#

<report type:"WARNING">
  description : "6.01 Advanced queuing in asynchronous messaging - 'Empty queue at shutdown of Oracle'"
  info        : "Information in queue may be accessed outside of Oracle and beyond the control of the security parameters.  It should be subject to the same"
  info        : "security precautions as other tables."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires commands to be performed on the database before shutdown of the system."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

<report type:"WARNING">
  description : "6.02 Cache - 'Cache must be emptied at shutdown of Oracle'"
  info        : "Information in caches may be accessed outside of Oracle and beyond the controls of the security parameters."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires commands to be performed on the database before shutdown of the system."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

#
## 7. Backup and Disaster Recovery
#
#
## 8. Oracle Profile (User) Setup Settings
#

<if>
  <condition type:"AND">
    <custom_item>
      type        : SQL_POLICY
      description : "Database Profiles Unlimited Failed Login Attempts"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'FAILED_LOGIN_ATTEMPTS' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : SQL_POLICY
      description : "8.01 Database Profiles - 'failed_login_attempts <= 3'"
      info        : "Restricting the number of login attempts will help deter brute force attacks against profiles."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'FAILED_LOGIN_ATTEMPTS' AND LIMIT != 'DEFAULT' AND LIMIT < 3;"
      sql_types   : POLICY_VARCHAR,POLICY_INTEGER
      sql_expect  : NULL,NULL
      reference   : "800-171|3.1.8,800-53|AC-7,CIP|007-6-R5,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,PCI-DSSv3.1|8.1.6,PCI-DSSv3.2|8.1.6,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : SQL_POLICY
      description : "8.01 Database Profiles - 'failed_login_attempts = unlimited'"
      info        : "Restricting the number of login attempts will help deter brute force attacks against profiles."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'FAILED_LOGIN_ATTEMPTS' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
      reference   : "800-171|3.1.8,800-53|AC-7,CIP|007-6-R5,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,PCI-DSSv3.1|8.1.6,PCI-DSSv3.2|8.1.6,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : SQL_POLICY
      description : "Database Profiles - 'password_life_time = unlimited'"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_LIFE_TIME' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : SQL_POLICY
      description : "8.02 Database Profiles - 'password_life_time <= 90'"
      info        : "Restricting the password lifetime will help deter brute force attacks against user accounts and refresh passwords."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_LIFE_TIME' AND LIMIT != 'DEFAULT' AND LIMIT > 90;"
      sql_types   : POLICY_VARCHAR,POLICY_INTEGER
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : SQL_POLICY
      description : "8.02 Database Profiles - 'password_life_time = unlimited'"
      info        : "Restricting the password lifetime will help deter brute force attacks against user accounts and refresh passwords."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_LIFE_TIME' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : SQL_POLICY
      description : "Database Profiles - 'password_reuse_max = unlimited'"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_MAX' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : SQL_POLICY
      description : "8.03 Database Profiles - 'password_reuse_max >= 20'"
      info        : "password_reuse_max sets the number of different passwords that must be rotated by the user before the current password can be reused. This"
      info        : "prevents users from cycling through a few common passwords and helps ensure the integrity and strength of user credentials."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_MAX' AND LIMIT != 'DEFAULT' AND  LIMIT < 20;"
      sql_types   : POLICY_VARCHAR,POLICY_INTEGER
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : SQL_POLICY
      description : "8.03 Database Profiles - 'password_reuse_max = unlimited'"
      info        : "password_reuse_max sets the number of different passwords that must be rotated by the user before the current password can be reused. This"
      info        : "prevents users from cycling through a few common passwords and helps ensure the integrity and strength of user credentials."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_MAX' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : SQL_POLICY
      description : "Database Profiles - 'password_reuse_time = unlimited'"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_TIME' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : SQL_POLICY
      description : "8.04 Database Profiles - 'password_reuse_time >= 365'"
      info        : "password_reuse_time sets the amount of time that must pass before a password can be reused."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_TIME' and LIMIT < 365 AND LIMIT != 'DEFAULT';"
      sql_types   : POLICY_VARCHAR,POLICY_INTEGER
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : SQL_POLICY
      description : "8.04 Database Profiles - 'password_reuse_time = unlimited'"
      info        : "password_reuse_time sets the amount of time that must pass before a password can be reused."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_REUSE_TIME' AND LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : SQL_POLICY
      description : "8.05 Database Profiles - 'password_lock_time >= 1'"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_LOCK_TIME' and LIMIT = 'UNLIMITED';"
      sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
      sql_expect  : NULL,NULL
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : SQL_POLICY
      description : "8.05 Database Profiles - 'password_lock_time >= 1'"
      info        : "password_lock_time specifies the amount of time in days that the account will be locked out"
      info        : "if the maximum number of authentication attempts has been reached."
      info        : "Level 1, Scorable"
      see_also    : "https://workbench.cisecurity.org/files/580"
      sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_LOCK_TIME' AND LIMIT != 'DEFAULT' AND LIMIT < 1;"
      sql_types   : POLICY_VARCHAR,POLICY_INTEGER
      sql_expect  : NULL,NULL
      reference   : "800-171|3.1.8,800-53|AC-7,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
    </custom_item>
  </then>
</if>

<custom_item>
  type        : SQL_POLICY
  description : "8.06 Database Profiles - 'password_grace_time >= 3'"
  info        : "password_grace_time specified in days the amount of time that the user is warned to change their password before their password expires."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select PROFILE,LIMIT from DBA_PROFILES where RESOURCE_NAME = 'PASSWORD_GRACE_TIME' AND LIMIT != 'DEFAULT' and LIMIT < 3;"
  sql_types   : POLICY_VARCHAR,POLICY_INTEGER
  sql_expect  : NULL,NULL
  reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
</custom_item>

#
## 9. Oracle Profile (User) Access Settings
#

<custom_item>
  type        : SQL_POLICY
  description : "9.02 Tablespaces - 'Ensure application users have not been granted quotas on tablespaces.'"
  info        : "Set quotas for developers on shared production/development systems to prevent space resource contentions."
  info        : "Application users should be granted quotas on a case by case basis to avoid application failure."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select username from DBA_TS_QUOTAS where max_bytes = -1 and username not in ('OLAPSYS', 'WK_TEST', 'SYSMAN');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-53|SC-6,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),ITSG-33|SC-6"
</custom_item>

<report type:"WARNING">
  description : "9.03 Any dictionary object - 'Review access and revoke access where possible'"
  info        : "Check for any user that has access to any dictionary object and revoke where possible. This reduces the overall privileges of the user base"
  info        : "and reduces the attack surface of the Oracle database."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires manual verification to determine what access is required for each user."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

<custom_item>
  type        : SQL_POLICY
  description : "9.05 Tables - 'Prevent access to SYS.USERS_HISTORY$'"
  info        : "Revoke access to this table from all users and roles except for SYS and DBA accounts."
  info        : "Allowing users to alter the USER_HISTORY$ table can compromise the audit trail or integrity of the Oracle database."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME = 'USER_HISTORY$' and GRANTEE not in ('SYS', 'DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.06 Tables - 'Prevent access to SYS.LINK$'"
  info        : "Sensitive user and password data is stored in the LINK$ table."
  info        : "Non administrative or system users should be prevented from accessing this table."
  info        : "Check for any user that has access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME = 'LINK$' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.07 Tables - 'Prevent access to SYS.USER$'"
  info        : "Sensitive user and password data is stored in the USER$ table. Only administrative or system users should have rights to access this table."
  info        : "Check for any user that has access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME = 'USER$' and grantee not in ('CTXSYS','SYS','DBA','OLAPSYS','XDB','WKSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.08 Tables - 'Prevent access to SYS.SOURCES$'"
  info        : "Allowing users to alter codes in the SOURCE$ table can compromise the security and integrity of the Oracle database. Check for any user"
  info        : "accounts that have access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='SOURCE$' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.09 Tables - 'Prevent access to PREFSTAT.STATS$SQLTEXT'"
  info        : "Check for any user that has access and revoke where possible. SQLTEXT stores the full text of SQL statements that have been executed and can"
  info        : "contain sensitive information."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME = 'STATS$SQLTEXT';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.10 Tables - 'Prevent access to PERFSTAT.STATS$SQL_SUMMARY'"
  info        : "Check for any user that has access and revoke where possible. SQL_SUMMARY contains the first few lines of the executed SQL statements and"
  info        : "can contain sensitive information."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME = 'STATS$SQL_SUMMARY';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.11 Tables - 'Prevent access to X$ table'"
  info        : "X$ tables are kernel tables used by Oracle internals and should not be accessed by users. Check for any user that has access and revoke"
  info        : "where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME like 'X$_%' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.12 Views - 'Prevent access to any DBA_ views'"
  info        : "DBA views return information about all objects and should only be accessible by administrators. Check for any user that has access and"
  info        : "revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select distinct GRANTEE from DBA_TAB_PRIVS where TABLE_NAME LIKE 'DBA_%' and grantee not in ('AQ_ADMINISTRATOR_ROLE','SYS','DBA','WKSYS','MDSYS','CTXSYS','OLAPSYS','OWBSYS','OWB$CLIENT','XDBADMIN','SELECT_CATALOG_ROLE');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.13 Views - 'Prevent access to v$ views'"
  info        : "V$ tables contain sensitive information about Oracle database and should only be accessible by system administrators. Check for any user"
  info        : "that has access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select distinct GRANTEE from DBA_TAB_PRIVS where TABLE_NAME like 'V$%' and grantee not in ('AQ_ADMINISTRATOR_ROLE','SYS','DBA','WKSYS','CTXSYS','OLAPSYS','OWBSYS','OWB$CLIENT','SELECT_CATALOG_ROLE');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.14 Views - 'Prevent access to ALL_SOURCE'"
  info        : "ALL_SOURCE contains the text source for all of the user's objects. Check for any user that has access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='ALL_SOURCE' and grantee not in ('SYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.15 Views - 'Prevent access to DBA_ROLES'"
  info        : "Allowing the user to alter the DBA_ROLES can result in privilege escalation or system instability. Restrict access to this view to all users"
  info        : "except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='DBA_ROLES' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.16 Views - 'Prevent access to DBA_SYS_PRIVS'"
  info        : "Allowing a user to access the dba_sys_privs table will show the user's privileges for all users in the Oracle database. Restrict access to"
  info        : "this view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='DBA_SYS_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.17 Views - 'Prevent access to DBA_ROLE_PRIVS'"
  info        : "Allowing a user to access the dba_role_privs view will show the role privileges for all roles in the Oracle database. Restrict access to this"
  info        : "view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='DBA_ROLE_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.18 Views - 'Prevent access to DBA_TAB_PRIVS'"
  info        : "Allowing a user to access the dba_tab_privs view will show the table privileges for all users in the Oracle database. Restrict access to this"
  info        : "view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='DBA_TAB_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.19 Views - 'Prevent access to DBA_USERS'"
  info        : "Allowing a user to access the dba_users view will show the role privileges for all users in the Oracle database. Restrict access to this view"
  info        : "to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='DBA_USERS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.20 Views - 'Prevent access to ROLE_ROLE_PRIVS'"
  info        : "Allowing a user to access the dba_role_privs view will show the role grants for all roles in the Oracle database. Restrict access to this"
  info        : "view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='ROLE_ROLE_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.21 Views - 'Prevent access to USER_TAB_PRIVS'"
  info        : "Allowing a user to access the user_tab_privs view will show the granted table privileges for all users in the Oracle database. Restrict"
  info        : "access to this view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='USER_TAB_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.22 Views - 'Prevent access to USER_ROLE_PRIVS'"
  info        : "Allowing a user to access the user_role_privs view will show the granted role privileges for all users in the Oracle database. Restrict"
  info        : "access to this view to all users except SYS and DBAs."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_TAB_PRIVS where TABLE_NAME='USER_ROLE_PRIVS' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.23 Roles - 'Prevent assignment of roles that have _CATALOG_'"
  info        : "Revoke any catalog roles from those roles and users that do not need them.  These roles are SELECT_CATALOG_ROLE, EXECUTE_CATALOG_ROLE,"
  info        : "DELETE_CATALOG_ROLE, and RECOVERY_CATALOG_OWNER."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_ROLE_PRIVS where GRANTED_ROLE like '%_CATALOG_%' and GRANTEE not in ('DBA','EXP_FULL_DATABASE','IMP_FULL_DATABASE','IX','MDSYS','OLAP_DBA','OLAP_USER','SH','SYS','WKUSER');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.24 Synonyms - 'Prevent access to any V$ synonym'"
  info        : "Check for any user that has access and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select distinct GRANTEE from DBA_TAB_PRIVS where TABLE_NAME like 'V$%' and grantee not in ('SYS','DBA');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<report type:"WARNING">
  description : "9.25 Synonyms - 'When dropping synonyms, ensure privileges granted to the synonyms, if not required, are removed from the base object'"
  info        : "Granting privileges to synonyms actually grants privileges to the base objects."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires manual verification to determine what synonyms are being used and if the base object's"
  info        : "privileges have been removed."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

<custom_item>
  type        : SQL_POLICY
  description : "9.26 Privileges - 'Restrict system privileges'"
  info        : "All system privileges except for CREATE SESSION must be restricted to DBAs, application object owner accounts/schemas (locked accounts) and"
  info        : "default Oracle accounts.  Developers may be granted limited system privileges as required on development databases."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_SYS_PRIVS where privilege != 'CREATE SESSION' and GRANTEE not in ('AQ_ADMINISTRATOR_ROLE','DBA','DBSNMP','EXFSYS','EXP_FULL_DATABASE','IMP_FULL_DATABASE','IX','JAVADEBUGPRIV','MDSYS','HR','OE','OEM_MONITOR','OLAPSYS','OLAP_DBA','ORDPLUGINS','ORDSYS','OUTLN','SCHEDULER_ADMIN','SYS','SYSMAN','SYSTEM','WKSYS','BI','CTXSYS','DATAPUMP_EXP_FULL_DATABASE','FLOWS_0300000','OLAP_USER','OWBSYS','XDB','WMSYS','WKUSER','TSMSYS') order by GRANTEE;"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.27 Privileges - 'Prevent granting of privileges that contain the keyword ANY'"
  info        : "The ANY keyword grants the ability for the user to set privileges for the entire catalogue of objects in the database."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege like '%ANY%' and GRANTEE not in ('AQ_ADMINISTRATOR_ROLE','DATAPUMP_IMP_FULL_DATABASE','DBA','DBSNMP','EXFSYS','EXP_FULL_DATABASE','IMP_FULL_DATABASE','IX','JAVADEBUGPRIV','MDSYS','ORACLE_OCM','OEM_MONITOR','OLAPSYS','OLAP_DBA','ORDPLUGINS','ORDSYS','OUTLN','OWBSYS','SCHEDULER_ADMIN','SPATIAL_WFS_ADMIN_USR','SPATIAL_CSW_ADMIN_USR','SYS','SYSMAN','SYSTEM','WKSYS','WMSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.29 Privileges - 'Prevent granting of EXEMPT ACCESS POLICY(EAP)'"
  info        : "Revoke this privilege if not necessary. The EAP privilege provides access to all rows regardless of Row Level Security assigned to specific"
  info        : "rows."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where PRIVILEGE='EXEMPT ACCESS POLICY';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.30 Privileges - 'Prevent granting of privileges that have WITH ADMIN'"
  info        : "Check for any user or role that has been granted privileges WITH ADMIN and revoke where possible. The WITH ADMIN privilege allows a user to"
  info        : "grant the same privileges they possess."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_SYS_PRIVS where ADMIN_OPTION='YES' and GRANTEE not in ('AQ_ADMINISTRATOR_ROLE','DBA','SCHEDULER_ADMIN','SYS','SYSTEM','OWBSYS','WMSYS');"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.31 Privileges - 'Prevent granting of privileges that have WITH GRANT'"
  info        : "Check for any user or role that has been granted privileges WITH GRANT and revoke where possible. The WITH GRANT privilege allows a user to"
  info        : "grant the same privilege to other users."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where GRANTABLE='YES' and GRANTEE not in ('CTXSYS','MDSYS','OLAPSYS','ORDSYS','PUBLIC','SYS','SYSMAN','SYSTEM','WMSYS','OWBSYS','OE');"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.32 Privileges - 'Prevent granting of privileges that have CREATE'"
  info        : "Check for any user that has object creation privileges and revoke where possible. Excessive create privileges can allow an attack to create"
  info        : "arbitrary objects, tables, and views."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_SYS_PRIVS where privilege like 'CREATE%' and GRANTEE not in ('ANONYMOUS','AQ_ADMINISTRATOR_ROLE','CONNECT','CTXSYS','DBA','DIP','DMSYS','EXFSYS','IMP_FULL_DATABASE','IX','MDSYS','MGMT_USER','OE','OEM_MONITOR','OLAPSYS','OLAP_DBA','OLAP_USER','ORDPLUGINS','ORDSYS','OWBSYS','OWB$CLIENT','RECOVERY_CATALOG_OWNER','RESOURCE','SCHEDULER_ADMIN','SH','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYS','SYSMAN','SYSTEM','WKPROXY','WKSYS','WKUSER','WMSYS','XDB');"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.33 Privileges - 'Prevent granting of CREATE LIBRARY'"
  info        : "Check for any user or role that has this privilege and revoke where possible. The CREATE LIBRARY privilege allows a user to create an object"
  info        : "associated with a shared library. Allowing arbitrary library creation can compromise the integrity and security of the Oracle database."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='CREATE LIBRARY' and GRANTEE not in ('DBA','EXFSYS','MDSYS','OLAPSYS','ORDPLUGINS','ORDSYS','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYS','WKSYS','XDB');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.34 Privileges - 'Prevent granting of ALTER SYSTEM'"
  info        : "Check for any user or role that has this privilege and revoke where possible. The alter system privilege allows a user to dynamically alter"
  info        : "the Oracle instance."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='ALTER SYSTEM' and GRANTEE not in ('DBA','DMSYS','SYS','WKSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.35 Privileges - 'Prevent granting of CREATE PROCEDURE'"
  info        : "CREATE PROCEDURE allows a user to create a stored procedure in the database and should be restricted to administrative or development users."
  info        : "Check for any user or role that has this privilege and revoke where possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='CREATE PROCEDURE' and GRANTEE not in ('DBA','DMSYS','IX','MDSYS','OLAPSYS','OLAP_USER','ORDPLUGINS','ORDSYS','OWBSYS','RECOVERY_CATALOG_OWNER','RESOURCE','SYS','WKSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.36 Privileges - 'Prevent granting of BECOME USER'"
  info        : "BECOME USER allows a user to inherit the rights of another oracle system user and should not be used if possible."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='BECOME USER' and GRANTEE not in ('DBA','IMP_FULL_DATABASE','SYS','WKSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.37 Privileges - 'Prevent granting of SELECT ANY TABLE'"
  info        : "Check for any user that has access and revoke where possible.  If application data is sensitive, and it is possible, revoke this privilege"
  info        : "from the DBA accounts as well."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='SELECT ANY TABLE' and GRANTEE not in ('DBA','EXP_FULL_DATABASE','IMP_FULL_DATABASE','MDSYS','OLAPSYS','OLAP_DBA','SYS','SYSTEM','WKSYS','WMSYS');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.38 Privileges - 'Prevent granting of AUDIT SYSTEM'"
  info        : "Review which users have audit system privileges and limit as much as possible to ensure audit commands are not revoked."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='AUDIT SYSTEM' and GRANTEE not in ('DBA','SYS','WKSYS','IMP_FULL_DATABASE','DATAPUMP_IMP_FULL_DATABASE');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.39 Privileges - 'Grant privileges only to roles'"
  info        : "Grant privileges only to roles. Do not grant privileges to individual users."
  info        : "Level 1, Not Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select distinct GRANTEE from DBA_ROLE_PRIVS where GRANTEE in (select USERNAME from DBA_USERS) and GRANTEE not in ('BI','CTXSYS','DBSNMP','DIP','DMSYS','EXFSYS','HR','IX','MDDATA','MDSYS','MGMT_VIEW','OE','OLAPSYS','ORDPLUGINS','ORDSYS','OUTLN','OWBSYS','PM','SH','SI_INFORMTN_SCHEMA','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYS','SYSMAN','TSMSYS','WKSYS','WK_TEST','WMSYS','XDB');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.1,800-53|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii)"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.40 Privileges - 'Review pivileges granted to PUBLIC'"
  info        : "Review all privileges granted to PUBLIC.  Limit or revoke unnecessary PUBLIC privileges."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_SYS_PRIVS where GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.41 Roles - 'Prevent assignment of RESOURCE'"
  info        : "Revoke the resource role from normal application user accounts."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_SYS_PRIVS where privilege='RESOURCE';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.42 Roles - 'Prevent assignment of DBA'"
  info        : "Assigning the DBA role to users provides unnecessary access and control of the Oracle database."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE from DBA_ROLE_PRIVS where GRANTED_ROLE='DBA' and GRANTEE in (select USERNAME from DBA_USERS) and GRANTEE not in ('SYS','SYSMAN','SYSTEM');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.1,800-53|AC-3(7),CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii)"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.43 Packages - 'ACL or Deny access to UTL_FILE'"
  info        : "Review the ACL for usage of the UTL_FILE package. Revoke the public execute privilege on UTL_FILE as it can be used to access O/S."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='UTL_FILE' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.44 Packages - 'ACL or Deny access to UTL_TCP'"
  info        : "Review the ACL for usage of the UTL_TCP package. Revoke the public execute privilege on UTL_TCP as it can write and read sockets."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='UTL_TCP' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.45 Packages - 'ACL or Deny access to UTL_HTTP'"
  info        : "Review the ACL for usage of the UTL_HTTP package."
  info        : "Revoke the public execute privilege on UTL_HTTP as it can write content to a web browser."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='UTL_HTTP' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.46 Packages - 'ACL or Deny access to UTL_SMTP'"
  info        : "Review the ACL for usage of the UTL_SMTP packageRevoke the public execute privilege on UTL_SMTP as it can send mail from the database"
  info        : "server."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='UTL_SMTP' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.47 Packages - 'Deny access to UTL_LOB'"
  info        : "Revoke the public execute privilege. This procedure allows the manipulation of large objects and BFILE file read access. If not required its"
  info        : "usage should be revoked."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='DBMS_LOB' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.48 Packages - 'Deny access to DBMS_SYS_SQL'"
  info        : "Revoke the public execute privilege. If public permissions are granted on DBMS_SYS_SQL a user can acquire an administrative cursor and act"
  info        : "with DBA permissions."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where TABLE_NAME='DBMS_SYS_SQL' and GRANTEE='PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.49 Packages - 'Deny access to DBMS_JOB'"
  info        : "Revoke the public execute privilege. DBMS_JOB is a backwards compatible job scheduler for Oracle. If no longer required its usage should be"
  info        : "disabled to reduce Oracle's attack surface."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select GRANTEE,PRIVILEGE from DBA_TAB_PRIVS where OWNER = 'SYS' and TABLE_NAME = 'DBMS_JOB' and GRANTEE = 'PUBLIC';"
  sql_types   : POLICY_VARCHAR,POLICY_VARCHAR
  sql_expect  : NULL,NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<custom_item>
  type        : SQL_POLICY
  description : "9.50 Proxy Authentication - 'Limit the user schema privileges to CREATE SESSION only'"
  info        : "The proxy account should only have the ability to connect to the database. No other privileges should be granted to this account."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "select distinct GRANTEE from DBA_ROLE_PRIVS where GRANTED_ROLE!='CREATE SESSION' and GRANTEE in (select USERNAME from DBA_USERS) and GRANTEE not in ('BI','CTXSYS','DBSNMP','DIP','DMSYS','EXFSYS','HR','IX','MDDATA','MDSYS','MGMT_VIEW','OE','OLAPSYS','ORDPLUGINS','ORDSYS','OUTLN','OWBSYS','PM','SH','SI_INFORMTN_SCHEMA','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYS','SYSMAN','TSMSYS','WKSYS','WK_TEST','WMSYS','XDB');"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
</custom_item>

<report type:"WARNING">
  description : "9.51 Proxy role - 'Restrict the roles that can be enabled when privileges are granted in the database.'"
  info        : "If application roles have been granted to user then these roles need to be prevented from being enabled by default on the subsequent logins."
  info        : "Level 1, Not Scorable"
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.as it requires manual verification."
  see_also    : "https://workbench.cisecurity.org/files/580"
</report>

<custom_item>
  type        : SQL_POLICY
  description : "9.54 Packages - 'Limit or deny access to DBMS_BACKUP_RESTORE'"
  info        : "Provides file system functions such as copying files, altering control files, accessing devices, and deleting files."
  info        : "Level 1, Scorable"
  see_also    : "https://workbench.cisecurity.org/files/580"
  sql_request : "SELECT GRANTEE FROM DBA_TAB_PRIVS WHERE TABLE_NAME='DBMS_BACKUP_RESTORE';"
  sql_types   : POLICY_VARCHAR
  sql_expect  : NULL
  reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
</custom_item>

#
## 10. Enterprise Manager / Grid Control / Agents
#
#
## 11. Specific Systems
#
#
## 12. General Policy and Procedures
#
#
## 13. Auditing Policy and Procedures
#

</group_policy>
</check_type>
