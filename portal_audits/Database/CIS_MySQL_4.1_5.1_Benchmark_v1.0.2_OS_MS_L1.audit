#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.20 $
# $Date: 2020/04/22 $
#
# Description	: This audit is based on the Security Configuration Benchmark For MySQL 4.1, 5.0, 5.1 Community Editions
# 	  Version 1.0.2 April 2009
# 	  https://workbench.cisecurity.org/files/1613
#
# NOTE		: The CIS benchmark refers to MySQL 5.1 as beta software as of the benchmark date of 2009.
# 	  MySQL 5.1 and 5.5 are both currently GA, 5.6 is current development release.  This .audit is based on MySQL 5.1.66, and as such
# 	  does not include some queries which are relevent only to lower versions of MySQL.
#
# NOTE		: Some queries in this .audit require site-specific data to be known to the query in order to function properly.
# 	  Please note the following queries and edit their values accordingly.
# 	  2.4 Log files
# 	  2.5 SSL files '*'
# 	  3.2 Logs not on system partition
# 	  3.3 Logs not on database partition
#
#<ui_metadata>
#<display_name>CIS MySQL 4.1 5.1 OS L1 v1.0.2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>MySQL 4.1 5.1 OS L1</name>
#  <version>1.0.2</version>
#  <link>https://workbench.cisecurity.org/files/1613</link>
#</spec>
#<labels>windows,cis,mysql,mysql_4,mysql_4.1,mysql_5,mysql_5.1,microsoft</labels>
#<benchmark_refs>LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>MYSQL_SERVICE_ACCT</name>
#    <default>mysql</default>
#    <description>MySQL Service Account</description>
#    <info>This is your MySQL service account.</info>
#  </variable>
#  <variable>
#    <name>MYSQL_USER</name>
#    <default>mysql</default>
#    <description>MySQL User Account</description>
#    <info>This is your MySQL user account.</info>
#  </variable>
#  <variable>
#    <name>MYSQL_DATA</name>
#    <default>C:\Program Files\MySQL\MySQL Server 5.1\Data\</default>
#    <description>MySQL Data Directory</description>
#    <info>This is your MySQL data directory.</info>
#  </variable>
#  <variable>
#    <name>MYSQL_INSTALL</name>
#    <default>C:\Program Files\MySQL\MySQL Server 5.1</default>
#    <description>MySQL Install Dir</description>
#    <info>This is your MySQL install directory.</info>
#  </variable>
#  <variable>
#    <name>MYSQL_LOG</name>
#    <default>C:\Program Files\MySQL\MySQL Server 5.1\Log\mysqld.log</default>
#    <description>MySQL Log File</description>
#    <info>This is your MySQL log file.</info>
#  </variable>
#  <variable>
#    <name>SSL_CA_PATH</name>
#    <default>C:\PATH\TO\ca-cert.pem</default>
#    <description>SSL CA Cert Path</description>
#    <info>This is the path to your Certificate Authority (CA) certificate.</info>
#  </variable>
#  <variable>
#    <name>SSL_CERT_PATH</name>
#    <default>C:\PATH\TO\server-cert.pem</default>
#    <description>SSL Cert Path</description>
#    <info>This is the path to your server's SSL certificate.</info>
#  </variable>
#  <variable>
#    <name>SSL_KEY_PATH</name>
#    <default>C:\PATH\TO\server-key.pem</default>
#    <description>SSL Key Path</description>
#    <info>This is the path to your server's SSL key.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"MySQL">

<file_acl:"DATADIR">
  <user:"Creator Owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "full control"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "<user".
  <user:"mysql">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>
</file_acl>

<file_acl:"BINARIES">
  <user:"Creator Owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "full control"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "<user".
  <user:"mysql">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>
</file_acl>

<file_acl:"CONF_FILES">
  <user:"Creator Owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "full control"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "<user".
  <user:"mysql">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>
</file_acl>

<file_acl:"LOG_FILES">
  <user:"Creator Owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "full control"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "<user".
  <user:"mysql">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>
</file_acl>

<file_acl:"SSL_CERT">
  <user:"Creator Owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "full control"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>

# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "<user".
  <user:"mysql">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "full control"
  </user>
</file_acl>

<if>
  <condition type:"OR">
    <custom_item>
      type        : REG_CHECK
      description : "MySQL 5.1 is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\SOFTWARE\MySQL AB\MySQL Server 5.1"
      reg_option  : MUST_EXIST
      key_item    : "Version"
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "MySQL 5.0 is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\SOFTWARE\MySQL AB\MySQL Server 5.0"
      reg_option  : MUST_EXIST
      key_item    : "Version"
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "MySQL 4.1 is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\SOFTWARE\MySQL AB\MySQL Server 4.1"
      reg_option  : MUST_EXIST
      key_item    : "Version"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "MySQL 4.1, 5.0, 5.1 Community Editions is installed"
    </report>

    <report type:"PASSED">
      description : "1.3 Unix Run in Chroot"
      info        : "Running MySQL in a chroot environment may reduce the impact of a MySQL-born vulnerability by making portions of the file system inaccessible to the MySQL instance."
      info        : "NOTE : This check is Not Applicable to Windows systems."
      solution    : "Run MySQL in Jail or Chroot"
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <custom_item>
      type          : WMI_POLICY
      description   : "1.4 Dedicated Account"
      info          : "Utilizing a least privilege account for MySQL to execute as may reduce the impact of a MySQL-born vulnerability. A restricted account will be unable to access resources unrelated to MySQL, such as operating system configurations."
      solution      : "Dedicated non-administrative account for MySQL daemon/service"
      reference     : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also      : "https://workbench.cisecurity.org/files/1613"
      value_type    : POLICY_TEXT
# Note: Variable @MYSQL_SERVICE_ACCT@ replaced with "mysql" in field "value_data".
      value_data    : "mysql" || "NT AUTHORITY\NETWORK SERVICE"
      wmi_namespace : "root/CIMV2"
      wmi_request   : "Select Caption,StartName from Win32_Service where Caption like '%MySQL%'"
      wmi_attribute : "Caption,StartName"
      wmi_key       : "StartName"
    </custom_item>

    <report type:"PASSED">
      description : "1.7 Command history"
      info        : "All commands run in the MySQL console application are saved to a history file. Disabling the MySQL command history reduces the probability of exposing sensitive information, such as passwords."
      info        : "NOTE : Nessus has not performed this query, and this check is only provided for informational purposes."
      solution    : "Admin and DBA's should disable command history by setting MYSQL_HISTFILE to /dev/null or linking .mysql_history to /dev/null"
      reference   : "LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"PASSED">
      description : "1.8 MYSQL_PWD"
      info        : "The use of the MYSQL_PWD environment variable implies the clear text storage of MySQL credentials. Avoiding this may increase assurance that the confidentiality of MySQL credentials is preserved."
      info        : "NOTE : Nessus has not performed this query, and this check is only provided for informational purposes."
      solution    : "MySQL can read the database password from an environmental variable called MYSQL_PWD. Verify MYSQL_PWD environmental variable not used"
      reference   : "LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "1.9 MySQL User"
      info        : "Preventing the MySQL user from logging in interactively may reduce the impact of a compromised MySQL account."
      info        : "NOTE : Update MYSQL_USER to the appropriate value for your local environment."
      solution    : "Disable interactive login. Deny the user the 'Log on locally' right"
      reference   : "800-53|AC-6(7),CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,LEVEL|1S,NESA|M1.1.3,NESA|T5.1.1"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : USER_RIGHT
# Note: Variable @MYSQL_USER@ replaced with "mysql" in field "value_data".
      value_data  : "mysql"
      right_type  : SeDenyInteractiveLogonRight
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "1.10 Windows Network Service Account"
      info        : "Executing the MySQL user as the NETWORK_SERVICE account may reduce the impact of a MySQL-born vulnerability because this account has a restricted privilege set."
      solution    : "MySQL should run as a network service account [Windows 2003, Windows XP]."
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : POLICY_TEXT
# Note: Variable @MYSQL_SERVICE_ACCT@ replaced with "mysql" in field "value_data".
      value_data  : "mysql" || "NT AUTHORITY\NETWORK SERVICE"
      reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\MySQL"
      reg_item    : "ObjectName"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type          : WMI_POLICY
      description   : "1.11 Windows Platform Selection"
      info          : "Installing MySQL on a non-domain controller may reduce the impact of a MySQL-born vulnerability."
      solution      : "Do not install MySQL on a domain controller."
      reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/1613"
      value_type    : POLICY_DWORD
      value_data    : "4" || "5"
      wmi_namespace : "root/CIMV2"
      wmi_request   : "select DomainRole from Win32_ComputerSystem"
      wmi_attribute : "DomainRole"
      wmi_key       : "DomainRole"
      check_type    : CHECK_NOT_EQUAL
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.1 Data Directory"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
      info        : "NOTE : Update MYSQL_DATA to the appropriate value for your local environment."
      solution    : "Read and write by MySQL user only."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "DATADIR"
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "file".
      file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.2 Binaries 'mysqld.exe'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
      info        : "NOTE : Update MYSQL_INSTALL to the appropriate value for your local environment."
      solution    : "Verify and set permissions such that binaries are accessible only by database administrators and database users. Typically these are located on Unix systems in the /usr/bin and /usr/sbin folders. For Windows they are located in the installation folder. Can be found by locating the mysqld, mysqladmin, and mysql executables."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "BINARIES"
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "file".
      file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\bin\mysqld.exe"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.2 Binaries 'mysqladmin.exe'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
      info        : "NOTE : Update MYSQL_INSTALL to the appropriate value for your local environment."
      solution    : "Verify and set permissions such that binaries are accessible only by database administrators and database users. Typically these are located on Unix systems in the /usr/bin and /usr/sbin folders. For Windows they are located in the installation folder. Can be found by locating the mysqld, mysqladmin, and mysql executables."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "BINARIES"
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "file".
      file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\bin\mysqladmin.exe"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.2 Binaries 'mysql.exe'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
      info        : "NOTE : Update MYSQL_INSTALL to the appropriate value for your local environment."
      solution    : "Verify and set permissions such that binaries are accessible only by database administrators and database users. Typically these are located on Unix systems in the /usr/bin and /usr/sbin folders. For Windows they are located in the installation folder. Can be found by locating the mysqld, mysqladmin, and mysql executables."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "BINARIES"
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "file".
      file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\bin\mysql.exe"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "2.3 Configuration File - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "file".
          file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "2.3 Configuration File - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "file".
          file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
          description : "2.3 Configuration File - %WINDIR%\my.ini"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
          file        : "%WINDIR%\my.ini"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
          description : "2.3 Configuration File - %WINDIR%\my.cnf"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
          file        : "%WINDIR%\my.cnf"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
          description : "2.3 Configuration File - C:\my.ini"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
          file        : "C:\my.ini"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_PERMISSIONS
          description : "2.3 Configuration File - C:\my.cnf"
          info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL database."
          solution    : "Set permissions so that configuration files are readable by database administrators and database users. Typically the MySQL configuration file on Unix systems is located in /etc/mysql/my.cnf. On Windows it will be located in the %SYSTEMDIR% or install folder."
          reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : FILE_ACL
          value_data  : "CONF_FILES"
          file        : "C:\my.cnf"
        </custom_item>
      </then>
    </if>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.4 Log files"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL logs."
      info        : "NOTE : Update MYSQL_LOG to the appropriate value for your local environment."
      solution    : "Permission log files to be readable and writeable by MySQL user and authorized administrators only."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "LOG_FILES"
# Note: Variable @MYSQL_LOG@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Log\\mysqld.log" in field "file".
      file        : "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Log\\mysqld.log"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.5 SSL files 'ssl_ca'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL logs."
      info        : "NOTE : Update SSL_CA_PATH to the appropriate value for your local environment."
      solution    : "SSL files should be readable by MySQL user. No other read or write permissions."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "SSL_CERT"
# Note: Variable @SSL_CA_PATH@ replaced with "C:\\PATH\\TO\\ca-cert.pem" in field "file".
      file        : "C:\\PATH\\TO\\ca-cert.pem"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.5 SSL files 'ssl_cert'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL logs."
      info        : "NOTE : Update SSL_CA_PATH to the appropriate value for your local environment."
      solution    : "SSL files should be readable by MySQL user. No other read or write permissions."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "SSL_CERT"
# Note: Variable @SSL_CERT_PATH@ replaced with "C:\\PATH\\TO\\server-cert.pem" in field "file".
      file        : "C:\\PATH\\TO\\server-cert.pem"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.5 SSL files 'ssl_key'"
      info        : "Limiting the accessibility of these objects will protect the confidentiality, integrity, and availability of the MySQL logs."
      info        : "NOTE : Update SSL_CA_PATH to the appropriate value for your local environment."
      solution    : "SSL files should be readable by MySQL user. No other read or write permissions."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,LEVEL|1S,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1613"
      value_type  : FILE_ACL
      value_data  : "SSL_CERT"
# Note: Variable @SSL_KEY_PATH@ replaced with "C:\\PATH\\TO\\server-key.pem" in field "file".
      file        : "C:\\PATH\\TO\\server-key.pem"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini contains log-bin"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.2 Logs not on system partition 'log file not on System partition' - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.2 Logs not on system partition 'log file not on System partition' - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "%WINDIR%\my.ini contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.2 Logs not on system partition 'log file not on System partition' - %WINDIR%\my.ini"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "%WINDIR%\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.2 Logs not on system partition 'log file not on System partition' - %WINDIR%\my.cnf"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "C:\my.ini contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.2 Logs not on system partition 'log file not on System partition' - C:\my.ini"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "C:\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.2 Logs not on system partition 'log file not on System partition' - C:\my.cnf"
          info        : "Moving the MySQL logs off the system partition will reduce the probability of denial of service via the   exhaustion of available disk space to the operating system."
          solution    : "Logs should be on a non-system partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini contains log-bin"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.3 Logs not on database partition 'log file not on Data partition' - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.3 Logs not on database partition 'log file not on Data partition' - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "%WINDIR%\my.ini contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.3 Logs not on database partition 'log file not on Data partition' - %WINDIR%\my.ini"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "%WINDIR%\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.3 Logs not on database partition 'log file not on Data partition' - %WINDIR%\my.cnf"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "C:\my.ini contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.3 Logs not on database partition 'log file not on Data partition' - C:\my.ini"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          file_option : MUST_EXIST
        </custom_item>

        <custom_item>
          type        : FILE_CONTENT_CHECK
          description : "C:\my.cnf contains log-bin"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
          expect      : "^[\s]*log-bin[\s]*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.3 Logs not on database partition 'log file not on Data partition' - C:\my.cnf"
          info        : "Moving the MySQL logs off the database partition will reduce the probability of denial of service via the exhaustion of available disk space to MySQL."
          solution    : "Logs should be on their own partition."
          reference   : "800-53|SC-5(2),CSF|PR.DS-4,ITSG-33|SC-5(2),LEVEL|1S,SWIFT-CSCv1|6.4"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          regex       : "^[\s]*log-bin[\s]*="
# Note: Variable @MYSQL_DATA@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\" in field "expect".
          expect      : "^[\s]*log-bin[\s]*=[\s]*.C:\\Program Files\\MySQL\\MySQL Server 5.1\\Data\\"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.4 Do not use Update log - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.ini"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf Exists"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "description".
          description : "3.4 Do not use Update log - C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
# Note: Variable @MYSQL_INSTALL@ replaced with "C:\\Program Files\\MySQL\\MySQL Server 5.1" in field "value_data".
          value_data  : "C:\\Program Files\\MySQL\\MySQL Server 5.1\my.cnf"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.4 Do not use Update log - %WINDIR%\my.ini"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.ini"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "%WINDIR%\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.4 Do not use Update log - %WINDIR%\my.cnf"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "%WINDIR%\my.cnf"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.ini Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.4 Do not use Update log - C:\my.ini"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.ini"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : FILE_CHECK
          description : "C:\my.cnf Exists"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          file_option : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : FILE_CONTENT_CHECK_NOT
          description : "3.4 Do not use Update log - C:\my.cnf"
          info        : "The update log is now deprecated and the binary log should be used instead. The update log is not transaction safe. Avoiding the --log-update option may increase the integrity and availability of MySQL log files."
          solution    : "Do not use --log-update"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1NS,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/1613"
          value_type  : POLICY_TEXT
          value_data  : "C:\my.cnf"
          regex       : "^[\s]*log-update[\s]*="
          expect      : "^[\s]*log-update[\s]*="
        </custom_item>
      </then>
    </if>

    <report type:"WARNING">
      description : "6.1 Suspicious UDFs"
      info        : "This will help prevent an attacker from executing arbitrary code. This option prevents attaching arbitrary shared library functions as user-defined functions by checking for at least one corresponding method named _init, _deinit, _reset, _clear, or _add.

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Avoid using the --allow-suspicious-udfs parameter"
      reference   : "LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"WARNING">
      description : "7.1 Client Verify Server Cert 'ssl_verify_server_cert'"
      info        : "Verifying the server's certificate will help protect against man in the middle attacks. Causes the server's common name (CN) to be verified against the server's hostname.

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Must use: --ssl-verify-server-cert"
      reference   : "LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"WARNING">
      description : "7.3 Unique Key/Cert"
      info        : "Use of default certificates can allow an attacker to impersonate the MySQL server.

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Do not use a default or example certificate. Generate a key specifically for MySQL."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"WARNING">
      description : "8.1 Backup of databases"
      info        : "Backing up MySQL databases, including  mysql, will help ensure the availability of data in the event of an incident.

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Regularly occurring backup"
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"WARNING">
      description : "8.2 Verify backups"
      info        : "Verifying that backups are occurring appropriately will help ensure the availability of data in the event of an incident.

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Verify backups are good"
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>

    <report type:"WARNING">
      description : "8.3 Replication slave backups"
      info        : "Additional files must be backed up for replication slaves. SQL_LOAD-* files are in the slave-load-tmpdir (defaults to tmpdir). Use 'show variables;'

   NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Verify master.info, relay-log.info, and SQL_LOAD-* files."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "MySQL 4.1, 5.0, 5.1 Community Editions is installed"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/1613"
    </report>
  </else>
</if>

</group_policy>
</check_type>
