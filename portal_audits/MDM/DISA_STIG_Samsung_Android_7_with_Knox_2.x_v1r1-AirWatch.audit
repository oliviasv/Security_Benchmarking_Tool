#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.3 $
# $Date: 2020/04/17 $
#
# description : This document implements the security configuration as recommended by the
#               DISA STIG Samsung Android 7 with Knox 2.x v1r1
#
#<ui_metadata>
#<display_name>AirWatch - DISA Samsung Android 7 with Knox 2.x v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>AirWatch - DISA Samsung Android 7 with Knox 2.x v1r1</name>
#  <version>1.1.0</version>
#</spec>
#<labels>mdm,airwatch,android,samsung,knox</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>WHITELIST</name>
#    <default>.*</default>
#    <description>Device Application Whitelist</description>
#    <info>This is a comma separated whitelist of applications. Only these applications may be present on the device. Use a variable value of '.*' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#  </variable>
#  <variable>
#    <name>BLACKLIST</name>
#    <default>!@#$%$#@!</default>
#    <description>Device Application Blacklist</description>
#    <info>This is a comma separated blacklist of applications. None of these applications may be present on the device. Use a variable value of !@#$%$#@!' if this check is N/A for your organization, otherwise use a format like 'application_name1,application_name2,etc'.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"MDM" mdm_type:AIRWATCH>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-000100 - The Samsung Android 7 with Knox must be configured to enforce a minimum password length of six characters."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise and resulting device and data compromise.

SFR ID: FMT_SMF_EXT.1.1 #1a"
  solution       : "Configure the Samsung Android 7 with Knox to enforce a minimum password length of six characters.

On the MDM console, set the \"Minimum Length\" value to \"6\" or greater in the \"Android Password Restrictions\" rule.

Note: When device encryption is enabled (always enabled by the DoD configuration), Samsung Android 7 with Knox automatically enforces a minimum length of \"6\"."
  reference      : "800-171|3.5.7,800-53|IA-5(1),CAT|III,CCI|CCI-000205,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-91211r1_rule,STIG-ID|KNOX-07-000100,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-76515"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Passcode Length ="
  expect         : "Passcode Length = ([6-9]|[1-8][0-9]|9[0-9])"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Passcode Length = \(.Passcode.MinimumPasscodeLength? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-000200 - The Samsung must be configured to not allow passwords with more than two repeating or sequential characters - Characters"
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Configure the Samsung Android 7 with Knox to prevent passwords from containing more than two repeating or sequential characters.

On the MDM console, do the following:
1. Set the \"Maximum Sequential Characters\" value to \"2\" in the \"Android Password Restrictions\" rule.
2. Set the \"Maximum Sequential Numbers\" value to \"2\" in the \"Android Password Restrictions\" rule."
  reference      : "800-171|3.5.7,800-53|IA-5(1),CAT|III,CCI|CCI-000366,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-91213r1_rule,STIG-ID|KNOX-07-000200,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-76517"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Maximum Repeating Characters ="
  expect         : "Maximum Repeating Characters = [1-2]"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Maximum Repeating Characters = \(.Passcode.MaximumRepeatCharacters? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-000200 - The Samsung must be configured to not allow passwords with more than two repeating or sequential characters - Numbers"
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b"
  solution       : "Configure the Samsung Android 7 with Knox to prevent passwords from containing more than two repeating or sequential characters.

On the MDM console, do the following:
1. Set the \"Maximum Sequential Characters\" value to \"2\" in the \"Android Password Restrictions\" rule.
2. Set the \"Maximum Sequential Numbers\" value to \"2\" in the \"Android Password Restrictions\" rule."
  reference      : "800-171|3.5.7,800-53|IA-5(1),CAT|III,CCI|CCI-000366,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-91213r1_rule,STIG-ID|KNOX-07-000200,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-76517"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Maximum Repeating Numbers ="
  expect         : "Maximum Repeating Numbers = [1-2]"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Maximum Repeating Numbers = \(.Passcode.MaximumLengthOfNumericSequences? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-000500 - The Samsung Android 7 with Knox must be configured to lock the display after 15 minutes (or less) of inactivity."
  info           : "The screen lock timeout must be set to a value that helps protect the device from unauthorized access. Having a too-long timeout would increase the window of opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device. The maximum timeout period of 15 minutes has been selected to balance functionality and security; shorter timeout periods may be appropriate depending on the risks posed to the mobile device.

SFR ID: FMT_SMF_EXT.1.1 #2a, 2b"
  solution       : "Configure the Samsung Android 7 with Knox to lock the device display after \"15\" minutes (or less) of inactivity.

On the MDM console, configure the \"Maximum Time to Lock\" option to \"15\" minutes in the \"Android Password Restrictions\" rule."
  reference      : "800-171|3.1.10,800-53|AC-11,CAT|II,CCI|CCI-000057,CN-L3|8.1.4.1(b),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,Rule-ID|SV-91215r1_rule,STIG-ID|KNOX-07-000500,Vuln-ID|V-76519"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Security Inactivity Timeout ="
  expect         : "Security Inactivity Timeout = ([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|900)"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Security Inactivity Timeout = \(.Passcode.DeviceLockTimeoutInMinutes? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-000600 - The Samsung Android 7 with Knox must be configured to not allow more than 10 consecutive failed authentication attempts."
  info           : "The more attempts an adversary has to guess a password, the more likely the adversary will enter the correct password and gain access to resources on the device. Setting a limit on the number of attempts mitigates this risk. Setting the limit at \"10\" or less gives authorized users the ability to make a few mistakes when entering the password but still provides adequate protection against dictionary or brute force attacks on the password.

SFR ID: FMT_SMF_EXT.1.1 #2c, FIA_AFL_EXT.1.5"
  solution       : "Configure the Samsung Android 7 with Knox to allow \"10\" or less consecutive failed authentication attempts.

On the MDM console, set the \"Maximum Failed Attempts for wipe\" to \"10\" or less in the \"Android Password Restrictions\" rule for the device unlock password."
  reference      : "800-171|3.1.8,800-53|AC-7,CAT|III,CCI|CCI-000044,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-91217r1_rule,STIG-ID|KNOX-07-000600,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-76521"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Failed Authentication Attempts ="
  expect         : "Failed Authentication Attempts = ([1-9]|10)"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Failed Authentication Attempts = \(.Passcode.MaximumNumberOfFailedAttempts? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-001100 - The Samsung Android 7 with Knox must be configured to enforce an application installation policy. Disable Google Play."
  info           : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DoD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a"
  solution       : "Configure the Samsung Android 7 with Knox to disable unauthorized application repositories.

On the MDM console, enable \"Disable Android Market\" in the \"Android Applications\" rule.

Note: Some MDM consoles may refer to \"Google Play\" instead of \"Android Market\"."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91219r1_rule,STIG-ID|KNOX-07-001100,SWIFT-CSCv1|2.3,Vuln-ID|V-76523"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Google Play ="
  expect         : "Allow Google Play = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Google Play = \(.Restriction.AllowAndroidMarket? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-001200 - The Samsung Android 7 with Knox must be configured to enforce an application installation policy. Disable unknown sources."
  info           : "Forcing all applications to be installed from authorized application repositories can prevent unauthorized and malicious applications from being installed and executed on mobile devices. Allowing such installations and executions could cause a compromise of DoD data accessible by these unauthorized/malicious applications.

SFR ID: FMT_SMF_EXT.1.1 #8a"
  solution       : "Configure the Samsung Android 7 with Knox to disable unauthorized application repositories.

On the MDM console, deselect the \"Allow Install Non Market App\" checkbox in the \"Android Restrictions\" rule.

Note: Some MDM consoles may refer to \"Unknown Sources\" instead of \"Non Market App\"."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91221r1_rule,STIG-ID|KNOX-07-001200,SWIFT-CSCv1|2.3,Vuln-ID|V-76525"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Non Market App Installation ="
  expect         : "Allow Non Market App Installation = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Non Market App Installation = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowNonMarketAppInstallation // "not defined") end)"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-001400 - The Samsung Android 7 with Knox must be configured to enforce an application installation policy."
  info           : "The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application - any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application - additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications.

The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core applications (included in the operating system (OS) by the OS vendor) and pre-installed applications (provided by the MD vendor and wireless carrier), or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox device to whitelist application installations based on the one of the following characteristics:
- Digital signature
- Package Name

Both whitelists apply to user installable applications only, and do not control user access/execution of core and preinstalled applications. To restrict user access/execution to core and pre-installed applications, the MDM administrator must configure the \"application disable list\".

It is important to note that if the MDM administrator has not blacklisted an application characteristic (package name, digital signature) then it is implicitly whitelisted, as whitelists are exceptions to blacklists. If an application characteristic appears in both the blacklist and whitelist, the white list (as the exception to the blacklist) takes priority, and the User will be able to install the application. Therefore, the MDM administrator must configure the blacklists to include all package names and digital signatures for whitelisting to behave as intended. Note that some MDM vendors have implemented the blacklist function described above behind the scenes and there may not be a blacklist function to configure by the system administrator.

On the MDM console, do one of the following:
1. Add each AO-approved package name to the \"Package Name Whitelist\" in the \"Android Applications\" rule.
2. Add each AO-approved digital signature to the \"Signature Whitelist\" in the \"Android Applications\" rule.

Note: Either list may be empty if the Authorizing Official (AO) has not approved any apps.

Note: Refer to the Supplemental document for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(5),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSCv6|2.2,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,Rule-ID|SV-91223r1_rule,STIG-ID|KNOX-07-001400,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76527"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'All items were whitelisted.'
# Note: Variable @WHITELIST@ replaced with ".*" in field "bw_list".
  bw_list        : ".*"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | whitelist |
                if (length > 0) then
                   hostname + " has one or more non-whitelisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " All items were whitelisted."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-001600 - The Samsung whitelist must be configured to not include applications that Back up MD data to non-DoD cloud servers."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Back up MD data to non-DoD cloud servers (including user and application access to cloud backup services).

On the MDM console, add all applications which backup MD data to non-DoD cloud servers (including user and application access to cloud backup services) to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information.

Note: Include Samsung Accounts on the list."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91225r1_rule,STIG-ID|KNOX-07-001600,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76529"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-001700 - The Samsung whitelist must be configured to not include applications that Transmit MD diagnostic data to non-DoD servers."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Transmit MD diagnostic data to non-DoD servers.

On the MDM console, add all applications which - transmit MD diagnostic data to non-DoD servers to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document, Table 6-1, for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91227r1_rule,STIG-ID|KNOX-07-001700,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76531"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-001800 - The Samsung whitelist must be configured to not include applications with Voice assistant available when MD is locked."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Voice assistant application if available when MD is locked.

On the MDM console, add all applications which provide voice assistant when MD is locked to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91229r1_rule,STIG-ID|KNOX-07-001800,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76533"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-001900 - The Samsung whitelist must be configured to not include applications with Voice dialing application when MD is locked."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Voice dialing application if available when MD is locked.

On the MDM console, add all applications which provide voice dialing when MD is locked to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91231r1_rule,STIG-ID|KNOX-07-001900,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76535"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-002000 - The Samsung whitelist must be configured to not include applications that Allows synchronization of data."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Allows synchronization of data or applications between devices associated with user.

On the MDM console, add all applications which allow synchronization of data or applications between devices associated with user to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91233r1_rule,STIG-ID|KNOX-07-002000,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76537"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-002200 - The Samsung whitelist must be configured to not include applications that Allows unencrypted data sharing."
  info           : "Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications. Applications with the listed characteristics have features that can cause the compromise of sensitive DoD data or have features with no known application in the DoD environment.

Application note: The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application \"? any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application \"? additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

SFR ID: FMT_SMF_EXT.1.1 #8b"
  solution       : "Configure the Samsung Android 7 with Knox application disable list to include applications with the following characteristics:

- Allows unencrypted (or encrypted but not FIPS 140-2 validated) data sharing with other MDs or printers.

On the MDM console, add all applications which allow unencrypted (or encrypted but not FIPS 140-2 validated) data sharing with other MDs or printers to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CCI|CCI-001806,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91235r1_rule,STIG-ID|KNOX-07-002200,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76539"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type           : FULL_PROFILE_INFO
      description    : "Check for Bluetooth"
      regex          : "Allow Bluetooth ="
      expect         : "Allow Bluetooth = true"
      json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Bluetooth = \(.Restriction.AllowBluetooth? // "Not Defined")"'
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : FULL_PROFILE_INFO
      description    : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Discoverable"
      info           : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h"
      solution       : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|III,CCI|CCI-000366,CCI|CCI-001761,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,SWIFT-CSCv1|2.3,Vuln-ID|V-76541"
      see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
      regex          : "Allow Bluetooth Discoverable ="
      expect         : "Allow Bluetooth Discoverable = False"
      json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                    "Profile: " + .General.Name + " - Allow Bluetooth Discoverable = \(.Restriction.AllowBluetoothDiscoverableMode? // "Not Defined")"'
      match_all      : YES
    </custom_item>

    <custom_item>
      type           : FULL_PROFILE_INFO
      description    : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Data Transfer"
      info           : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h"
      solution       : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|III,CCI|CCI-000366,CCI|CCI-001761,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,SWIFT-CSCv1|2.3,Vuln-ID|V-76541"
      see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
      regex          : "Allow Bluetooth Data Transfer ="
      expect         : "Allow Bluetooth Data Transfer = False"
      json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                    "Profile: " + .General.Name + " - Allow Bluetooth Data Transfer = \(.Restriction.AllowBluetoothDataTransfer? // "Not Defined")"'
      match_all      : YES
    </custom_item>

    <custom_item>
      type           : FULL_PROFILE_INFO
      description    : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Desktop Connectivity"
      info           : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h"
      solution       : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|III,CCI|CCI-000366,CCI|CCI-001761,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,SWIFT-CSCv1|2.3,Vuln-ID|V-76541"
      see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
      regex          : "Allow Bluetooth Desktop Connectivity ="
      expect         : "Allow Bluetooth Desktop Connectivity = False"
      json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                    "Profile: " + .General.Name + " - Allow Bluetooth Desktop Connectivity = \(.Restriction.AllowDesktopConnectivityViaBluetooth? // "Not Defined")"'
      match_all      : YES
    </custom_item>

    <report type:"WARNING">
      description : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - HSP, HFP, and SPP profiles"
      info        : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h

      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-001761,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,Vuln-ID|V-76541"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Discoverable"
      info        : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h

      NOTE: Nessus has identified that Bluetooth is disabled, which satisfies the requirement."
      solution    : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-001761,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,Vuln-ID|V-76541"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Data Transfer"
      info        : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h

      NOTE: Nessus has identified that Bluetooth is disabled, which satisfies the requirement."
      solution    : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-001761,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,Vuln-ID|V-76541"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - Disable Bluetooth Desktop Connectivity"
      info        : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h

      NOTE: Nessus has identified that Bluetooth is disabled, which satisfies the requirement."
      solution    : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-001761,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,Vuln-ID|V-76541"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "KNOX-07-002400 - Disable all Bluetooth profiles except for HSP, HFP, and SPP - HSP, HFP, and SPP profiles"
      info        : "Some Bluetooth profiles provide the capability for remote transfer of sensitive DoD data without encryption or otherwise do not meet DoD IT security policies and therefore should be disabled.

      SFR ID: FMT_SMF_EXT.1.1 #18h

      NOTE: Nessus has identified that Bluetooth is disabled, which satisfies the requirement."
      solution    : "Configure the Samsung Android 7 with Knox to disable all Bluetooth profiles except for HSP, HFP, and SPP.

      On the MDM console, make sure that all options are deselected except HFP, HSP, and SPP in the \"Allowed Bluetooth Profiles\" setting in the \"Android Bluetooth\" rule."
      reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-001761,Rule-ID|SV-91237r1_rule,STIG-ID|KNOX-07-002400,Vuln-ID|V-76541"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-002600 - The Samsung must be configured to not display the following notifications when the device is locked: All notifications."
  info           : "Many mobile devices display notifications on the lock screen so that users can obtain relevant information in a timely manner without having to frequently unlock the phone to determine if there are new notifications. However, in many cases, these notifications can contain sensitive information. When they are available on the lock screen, an adversary can see them merely by being in close physical proximity to the device. Configuring the Samsung Android 7 with Knox to not send notifications to the lock screen mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #19"
  solution       : "Configure the Samsung Android 7 with Knox to not display notifications when the device is locked.

On the MDM console, enable \"Hide content\" or \"Do not show notification\" in the \"Notifications on lock screen\" setting in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-001199,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91239r1_rule,STIG-ID|KNOX-07-002600,SWIFT-CSCv1|2.3,Vuln-ID|V-76543"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Lockscreen Notifications ="
  expect         : "Allow Lockscreen Notifications = false"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Lockscreen Notifications = \(.Restriction.AllowKeyguardNotifications? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-003000 - The Samsung must be configured to enable encryption for information at rest on removable storage media."
  info           : "The Samsung Android 7 with Knox must ensure the data being written to the mobile device's removable media is protected from unauthorized access. If data at rest is unencrypted, it is vulnerable to disclosure. Even if the operating system enforces permissions on data access, an adversary can read removable media directly, thereby circumventing operating system controls. Encrypting the data ensures confidentiality is protected even when the operating system is not running.

SFR ID: FMT_SMF_EXT.1.1 #21, #47f"
  solution       : "Configure the Samsung Android 7 with Knox to enable information at rest protection for removable media.

On the MDM console, do the following:
Enable the \"External Storage Encryption\" setting in the \"Android Security\" rule."
  reference      : "800-171|3.13.16,800-53|SC-28(1),CAT|I,CCI|CCI-001199,CSCv6|13.2,CSF|PR.DS-1,ITSG-33|SC-28(1),Rule-ID|SV-91241r1_rule,STIG-ID|KNOX-07-003000,TBA-FIISB|28.1,Vuln-ID|V-76545"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "SD Card Encryption ="
  expect         : "SD Card Encryption = True"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - SD Card Encryption = \(.Passcode.RequireSDCardEncryption? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-003300 - The Samsung must be configured to disable authentication mechanisms providing user access to protected data - Password"
  info           : "Trust Agents allows a user to unlock a mobile device without entering a passcode when the mobile device is, for example, connected to a user selected Bluetooth device or in a user selected location. This technology would allow unauthorized users to have access to DoD sensitive data if compromised. By not permitting the use of non-password authentication mechanisms, users are forced to use passcodes that meet DoD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #23, FIA_UAU.5.1"
  solution       : "Configure the Samsung Android 7 with Knox to disable authentication mechanisms providing user access to protected data other than a Password Authentication Factor.

Configure the Samsung Android 7 with Knox to disable Trust Agents.

On the MDM console, select the \"Disable Keyguard Trust Agents\" setting in the \"Android Password Restrictions\" rule.

Note: Disabling Trust Agents will disable Smart Lock."
  reference      : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-91243r1_rule,STIG-ID|KNOX-07-003300,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-76547"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Passcode Type ="
  expect         : "Passcode Type = 327680"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Passcode Type = \(.Passcode.PasscodeContent? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-003300 - The Samsung must be configured to disable authentication mechanisms providing user access to protected data - Trust Agents"
  info           : "Trust Agents allows a user to unlock a mobile device without entering a passcode when the mobile device is, for example, connected to a user selected Bluetooth device or in a user selected location. This technology would allow unauthorized users to have access to DoD sensitive data if compromised. By not permitting the use of non-password authentication mechanisms, users are forced to use passcodes that meet DoD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #23, FIA_UAU.5.1"
  solution       : "Configure the Samsung Android 7 with Knox to disable authentication mechanisms providing user access to protected data other than a Password Authentication Factor.

Configure the Samsung Android 7 with Knox to disable Trust Agents.

On the MDM console, select the \"Disable Keyguard Trust Agents\" setting in the \"Android Password Restrictions\" rule.

Note: Disabling Trust Agents will disable Smart Lock."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91243r1_rule,STIG-ID|KNOX-07-003300,SWIFT-CSCv1|2.3,Vuln-ID|V-76547"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Keyguard Trust Agent ="
  expect         : "Keyguard Trust Agent = false"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Keyguard Trust Agent = \(.Restriction.AllowKeyguardTrustAgent? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-003700 - The Samsung Android 7 with Knox must be configured to disable developer modes."
  info           : "Developer modes expose features of the Samsung Android 7 with Knox that are not available during standard operation. An adversary may leverage a vulnerability inherent in a developer mode to compromise the confidentiality, integrity, and availability of DoD-sensitive information. Disabling developer modes mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #26"
  solution       : "Configure the Samsung Android 7 with Knox to disable developer modes.

On the MDM console, deselect the \"Allow Developer Mode\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91245r1_rule,STIG-ID|KNOX-07-003700,SWIFT-CSCv1|2.3,Vuln-ID|V-76549"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Developer Options ="
  expect         : "Allow Developer Options = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                    "Profile: " + .General.Name + " - Allow Developer Options = \(.Restriction.AllowDeveloperOptions? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-004300 - The Samsung must be configured to display the DoD advisory warning message at start-up or when the user unlocks the device."
  info        : "The Samsung Android 7 with Knox is required to display the DoD-approved system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Required banners help ensure that DoD can audit and monitor the activities of mobile device users without legal restriction.

System use notification messages can be displayed when individuals first access or unlock the mobile device. The banner shall be implemented as a \"click-through\" banner at device unlock (to the extent permitted by the operating system). A \"click through\" banner prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating \"?OK.\"

The approved DoD text must be used exactly as required in the KS referenced in DoDI 8500.01. For devices accommodating banners of 1300 characters, the banner text is:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

For devices with severe character limitations, the banner text is:

I've read & consent to terms in IS user agreem't.

The administrator must configure the banner text exactly as written without any changes.

SFR ID: FMT_SMF_EXT.1.1 #36

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to display the DoD-mandated warning banner text.

On the MDM console, do the following:
1. Enter the correct text in the \"Banner Text\" field in the \"DoD Banner\" settings in the \"Android Security\" rule.
2. Select the enable checkbox in the \"DoD Banner\" settings in the \"Android Security\" rule.

Note: If enabled without configuring the \"Banner Text\", the device will display a default text which matches the required DoD banner.

Note: On some MDM vendor consoles, the logon banner automatically is displayed upon reboot while the device is MDM enrolled. On these consoles, this control is not configurable through the MDM server or on the device."
  reference   : "CAT|III,CCI|CCI-000048,Rule-ID|SV-91247r1_rule,STIG-ID|KNOX-07-004300,Vuln-ID|V-76551"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-004500 - The Samsung Android 7 with Knox must be configured to disable USB mass storage mode."
  info           : "USB mass storage mode enables the transfer of data and software from one device to another. This software can include malware. When USB mass storage is enabled on a mobile device, it becomes a potential vector for malware and unauthorized data exfiltration. Prohibiting USB mass storage mode mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #39a"
  solution       : "Configure the Samsung Android 7 with Knox to disable USB mass storage mode.

On the MDM console, select the \"Disable USB Media Player\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-91249r1_rule,STIG-ID|KNOX-07-004500,SWIFT-CSCv1|2.3,Vuln-ID|V-76553"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow USB Media Player ="
  expect         : "Allow USB Media Player = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow USB Media Player = \(.Restriction.AllowUSBMediaPlayer? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-004700 - The Samsung must be configured to not allow backup of [all applications, configuration data] to locally connected systems."
  info           : "Data on mobile devices is protected by numerous mechanisms, including user authentication, access control, and cryptography. When the data is backed up to an external system (either locally connected or cloud-based), many if not all of these mechanisms are no longer present. This leaves the backed up data vulnerable to attack. Disabling backup to external systems mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Configure the Samsung Android 7 with Knox to disable backup to locally connected systems.

On the MDM console, select the \"Disable USB Media Player\" checkbox in the \"Android Restrictions\" rule.

Note: Disabling USB Media Player will also disable USB MTP, USB mass storage, and USB vendor protocol (Smart Switch, KIES)."
  reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000097,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-91251r1_rule,STIG-ID|KNOX-07-004700,SWIFT-CSCv1|2.3,Vuln-ID|V-76555"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow USB Media Player ="
  expect         : "Allow USB Media Player = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow USB Media Player = \(.Restriction.AllowUSBMediaPlayer? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-004900 - The Samsung must be configured to not allow backup to remote systems: Deselect Allow Google Backup."
  info           : "Backups to remote systems (including cloud backup) can leave data vulnerable to breach on the external systems, which often offer less protection than the Samsung Android 7 with Knox. Where the remote backup involves a cloud-based solution, the backup capability is often used to synchronize data across multiple devices. In this case, DoD devices may synchronize DoD-sensitive information to a user's personal device or other unauthorized computers that are vulnerable to breach. Disallowing remote backup mitigates this risk. Google Backup is a device wide control and, if enabled, will backup both personal and Knox data to personal Google cloud storage accounts.

SFR ID: FMT_SMF_EXT.1.1 #40"
  solution       : "Configure the Samsung Android 7 with Knox to disable backup to remote systems (including commercial clouds).

On the MDM console, do the following: Deselect the \"Allow Google Backup\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-002338,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91253r1_rule,STIG-ID|KNOX-07-004900,SWIFT-CSCv1|2.3,Vuln-ID|V-76557"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Google Backup ="
  expect         : "Allow Google Backup = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Google Backup = \(.Restriction.AllowGoogleBackup? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-004950 - The Samsung must be configured to not allow backup to remote systems: Disable Allow Google Accounts Auto Sync."
  info        : "Backups to remote systems (including cloud backup) can leave data vulnerable to breach on the external systems, which often offer less protection than the Samsung Android 7 with Knox. Where the remote backup involves a cloud-based solution, the backup capability is often used to synchronize data across multiple devices. In this case, DoD devices may synchronize DoD-sensitive information to a user's personal device or other unauthorized computers that are vulnerable to breach. Disallowing remote backup mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #40

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable backup to remote systems (including commercial clouds).

On the MDM console, do the following:
- Deselect the \"Allow Google Accounts Auto Sync\" checkbox in the \"Android Restrictions\" rule.
- List all pre-installed public cloud backup applications, in the application disable list"
  reference   : "CAT|II,CCI|CCI-002338,Rule-ID|SV-91255r1_rule,STIG-ID|KNOX-07-004950,Vuln-ID|V-76559"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-005100 - The Samsung must be configured to enable authentication of hotspot connections to the device using a preshared key."
  info        : "If there is no authentication required to establish personal hotspot connections, an adversary may be able to use that device to perform attacks on other devices or networks without detection. A sophisticated adversary may also be able to exploit unknown system vulnerabilities to access information and computing resources on the device. Requiring authentication to establish personal hotspot connections mitigates this risk.

Application note: If hotspot functionality is permitted, it must be authenticated via a preshared key. There is no requirement to enable hotspot functionality.

SFR ID: FMT_SMF_EXT.1.1 #41a

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enable authentication of personal hotspot connections to the device using a preshared key.

On the MDM console, deselect the \"Allow Unsecured Hotspot\" checkbox in the \"WiFi Policy\" rule."
  reference   : "CAT|II,CCI|CCI-002314,Rule-ID|SV-91257r1_rule,STIG-ID|KNOX-07-005100,Vuln-ID|V-76561"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-005500 - The Samsung must be configured to disable exceptions to the access control policy."
  info        : "App data sharing gives apps the ability to access the data of other apps for enhanced user functionality. However, sharing also poses a significant risk that unauthorized users or apps will obtain access to DoD-sensitive information. To mitigate this risk, there are data sharing restrictions. If a user is allowed to make exceptions to the data sharing restriction policy, the user could enable unauthorized sharing of data, leaving it vulnerable to breach. Limiting the granting of exceptions to either the administrator or common application developer mitigates this risk.

Copy/paste of data between applications in different application processes or groups of application processes is considered an exception to the access control policy and therefore, the Administrator must be able to enable/disable the feature. Other exceptions include allowing any data or application sharing between process groups.

SFR ID: FMT_SMF_EXT.1.1 #42, FDP_ACF_EXT.1.2

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enable the access control policy that prevents groups of application processes from accessing all data stored by other groups of application processes.

On the MDM console, create the \"Android Knox Container\" rule and push this rule to the device."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-002191,Rule-ID|SV-91259r1_rule,STIG-ID|KNOX-07-005500,Vuln-ID|V-76563"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-005700 - The Samsung must be configured to disable automatic transfer of diagnostic data. Disable Google Crash Report."
  info           : "Many software systems automatically send diagnostic data to the manufacturer or a third-party. This data enables the developers to understand real-world field behavior and improve the product based on that information. Unfortunately, it can also reveal information about what DoD users are doing with the systems and what causes them to fail. An adversary embedded within the software development team or elsewhere could use the information acquired to breach Samsung Android 7 with Knox security. Disabling automatic transfer of such information mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1#47a"
  solution       : "Configure the Samsung Android 7 with Knox to disable automatic transfer of diagnostic data to an external device other than an MDM service with which the device has enrolled.

Configure the mobile operating system to disable Google Crash Report.

On the MDM console, deselect the \"Allow Google Crash Report\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|III,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91261r1_rule,STIG-ID|KNOX-07-005700,SWIFT-CSCv1|2.3,Vuln-ID|V-76565"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Google Crash Report ="
  expect         : "Allow Google Crash Report = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Google Crash Report = \(.Restriction.AllowGoogleCrashReport? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-005900 - The Samsung must be configured to disable automatic transfer of diagnostic data. Disable Report Diagnostic Info."
  info        : "Many software systems automatically send diagnostic data to the manufacturer or a third-party. This data enables the developers to understand real-world field behavior and improve the product based on that information. Unfortunately, it can also reveal information about what DoD users are doing with the systems and what causes them to fail. An adversary embedded within the software development team or elsewhere could use the information acquired to breach Samsung Android 7 with Knox security. Disabling automatic transfer of such information mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1#47a

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable automatic transfer of diagnostic data to an external device other than an MDM service with which the device has enrolled.

Configure the mobile operating system to disable Report diagnostic info.
1. Open the device settings.
2. Select \"Privacy and emergency\".
3. Uncheck the \"Report diagnostic info\" setting."
  reference   : "CAT|III,CCI|CCI-000381,Rule-ID|SV-91263r1_rule,STIG-ID|KNOX-07-005900,Vuln-ID|V-76567"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-006100 - The Samsung Android 7 with Knox must be configured to disable multi-user modes."
  info           : "Multi-user mode allows multiple users to share a mobile device by providing a degree of separation between user data. To date, no mobile device with multi-user mode features meets DoD requirements for access control, data separation, and non-repudiation for user accounts. In addition, the MDFPP does not include design requirements for multi-user account services. Disabling multi-user mode mitigates the risk of not meeting DoD multi-user account security policies.

SFR ID: FMT_SMF_EXT.1.1 #47b"
  solution       : "Configure the Samsung Android 7 with Knox to disable multi-user modes.

On the MDM console, deselect the \"Allow multi-user mode\" setting in the \"Android MultiUser\" rule.

Note: This requirement is only applicable for tablet devices."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CCI|CCI-002110,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91265r1_rule,STIG-ID|KNOX-07-006100,SWIFT-CSCv1|2.3,Vuln-ID|V-76569"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Multi-User Mode ="
  expect         : "Allow Multi-User Mode = false"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Multi-User Mode = \(.Restriction.AllowMultipleUsers? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-012100 - The Samsung Android 7 with Knox must implement the management setting: Enable CC mode."
  info        : "CC mode implements several security controls required by the Mobile Device Functional Protection Profile (MDFPP). If CC mode is not implemented, DoD data is more at risk of being compromised, and the mobile device is more at risk of being compromised if lost or stolen.

CC mode implements the following controls:
- enables the OpenSSL FIPS crypto library
- sets the password failure settings to wipe the device to 5 (5 failed consecutive attempts will wipe the device)
- disables ODIN mode (download mode)

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce CC mode.

On the MDM console, enable the \"Enable CC mode\" setting in the \"Android Advanced Restrictions\" rule.

If this setting is not available on the console, install the CC mode APK and enable CC mode from this application.

This APK will be made available by Samsung.

Note: Before applying CC policy, the CC mode state will be \"Ready\". Once policy is applied, the state will change to \"Enforced\" until device meets all the prerequisites.

If device meets all prerequisites, CC mode will be enabled after rebooting and state will change to \"Enabled\".

If the device is tampered or FIPS self-test is failed, the state will change to \"Disabled\".

Note: To fully enable CC mode, below prerequisites should be satisfied:
1. Enable Device Encryption
2. Enable SD Card Encryption
3. Set maximum Password Attempts before Wipe
4. Enable Certificate Revocation
5. Disable Password History"
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91267r1_rule,STIG-ID|KNOX-07-012100,Vuln-ID|V-76571"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-012300 - The Samsung Android 7 with Knox must implement the management setting: Install DoD root and intermediate PKI certificates."
  info        : "DoD root and intermediate PKI certificates are used to verify the authenticity of PKI certificates of users and web services. If the root and intermediate certificates are not available, an adversary could falsely sign a certificate in such a way that it could not be detected. Providing access to the DoD root and intermediate PKI certificates greatly diminishes the risk of this attack.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to install DoD root and intermediate certificates.

On the MDM console, add the PEM encoded representations of the DoD root and intermediate certificates to the certificate whitelist in the \"Android Certificate\" rule.

The current DoD root and intermediate PKI certificates may be obtained in self-extracting zip files at http://iase.disa.mil/pki-pke (for NIPRNet) or
http://iase.rel.disa.smil.mil/pki-pke/function_pages/tools.html (for SIPRNet)."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91269r1_rule,STIG-ID|KNOX-07-012300,Vuln-ID|V-76573"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-012400 - The Samsung Android 7 with Knox must implement the management setting: Disable Allow New Admin Install."
  info        : "An application with administrator permissions (e.g., MDM agent) is allowed to configure policies on the device. If a user is allowed to install another MDM agent on the device, then this will allow another MDM administrator (assuming it has the proper Knox licenses) the ability to configure potentially conflicting policies on the device that may not meet DoD security requirements. Although an MDM cannot disable another MDM's policies or remove another MDM from the device, there is the potential of creating policies that could conflict with enterprise policies. Therefore, other applications requesting administrator permissions should be blocked from installation.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disallow new admin installations.

On the MDM console, select the \"Prevent New Admin Install\" checkbox in the \"Android Advanced Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91271r1_rule,STIG-ID|KNOX-07-012400,Vuln-ID|V-76575"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : APP_INFO_BY_DEVICE
  description    : "KNOX-07-012500 - The Samsung Android 7 with Knox must implement the management setting: Configure application install blacklist."
  info           : "Blacklisting all applications is required so that only whitelisted applications can be installed on the device. Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist and blacklist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Samsung Android 7 with Knox to Blacklist Application Install.

On the MDM console, do one of the following:
1. Add all package names by wildcard ('.*') to the \"Package Name Blacklist\" setting in the \"Android Applications\" rule.
2. Add all digital signatures by wildcard ('.*') to the \"Signature Blacklist\" setting in the \"Android Applications\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.1,800-171|3.4.8,800-53|AC-19,800-53|CM-7(4),800-53|CM-8,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.AC-3,CSF|PR.DS-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ISO/IEC-27001|A.6.2.1,ISO/IEC-27001|A.8.1.1,ITSG-33|AC-19,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,NIAv2|SS13a,Rule-ID|SV-91273r1_rule,STIG-ID|KNOX-07-012500,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-76577"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : ''
  expect         : 'No blacklisted items found.'
# Note: Variable @BLACKLIST@ replaced with "!@#$%$#@!" in field "bw_list".
  bw_list        : "!@#$%$#@!"
  json_transform : '(.apps | map(.ApplicationName + " " + .Version)) | blacklist |
                if (length > 0) then
                   hostname + " has one or more blacklisted item(s):\n  - " + join("\n  - ")
                else
                   hostname + " No blacklisted items found."
                end'
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-012600 - The Samsung Android 7 with Knox must implement the management setting: Disable USB host storage."
  info           : "The USB host storage feature allows the device to connect to select USB devices (e.g., USB flash drives, USB mouse, USB keyboard) using a micro USB to USB adapter cable. A user can copy sensitive DoD information to external USB storage unencrypted, resulting in compromise of DoD data. Disabling this feature mitigates the risk of compromising sensitive DoD data. USB host storage is automatically disabled in the Knox container.

Note: USB host storage must be enabled in the personal space/container in order to use the DeX Station.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Samsung Android 7 with Knox to disable USB host storage.

On the MDM console, deselect the \"Allow USB host storage\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.8.7,800-53|MP-7,CAT|II,CCI|CCI-000366,CN-L3|8.5.4.1(c),CSF|PR.PT-2,ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,NESA|T1.4.1,Rule-ID|SV-91277r1_rule,STIG-ID|KNOX-07-012600,Vuln-ID|V-76581"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow USB Host Storage ="
  expect         : "Allow USB Host Storage = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow USB Host Storage = \(.Restriction.AllowUsbHostStorage? // "Not Defined")"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-012700 - The Samsung Android 7 with Knox must implement the management setting: Disable S Voice."
  info           : "On Samsung Android 7 with Knox devices, users may be able to access the device's contact database or calendar to obtain phone numbers and other information using a human voice even when the mobile device is locked. Often this information is personally identifiable information (PII), which is considered sensitive. It could also be used by an adversary to profile the user or engage in social engineering to obtain further information from other unsuspecting users. Disabling access to the contact database and calendar in these situations mitigates the risk of this attack. The Authorizing Official (AO) may waive this requirement with written notice if the operational environment requires this capability.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Samsung Android 7 with Knox to disable S Voice.

On the MDM console, deselect the \"Allow S Voice\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91279r1_rule,STIG-ID|KNOX-07-012700,SWIFT-CSCv1|2.3,Vuln-ID|V-76583"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow S Voice ="
  expect         : "Allow S Voice = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow S Voice = \(.Restriction.AllowSVoice? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-012800 - The Samsung Android 7 with Knox must be configured to implement the management setting: Enable Container."
  info        : "The container must be enabled by the administrator/MDM or the container's protections will not apply to the mobile device. This will cause the mobile device's apps and data to be at significantly higher risk of compromise because they are not protected by encryption, isolation, etc.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enable the container.

On the MDM console, create the \"Android Knox Container\" rule and push this rule to the device."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91281r1_rule,STIG-ID|KNOX-07-012800,Vuln-ID|V-76585"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-012900 - The Samsung Android 7 with Knox must implement the management setting: Disable Admin Remove."
  info        : "DoD policy requires DoD mobile devices to be managed via a mobile device management service. If Admin Remove is not disabled the mobile device user can remove the administrator (MDM) from the device.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to Disable Admin Remove.

On the MDM console, deselect the \"Allow Admin Remove\" checkbox in the \"Android Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91283r1_rule,STIG-ID|KNOX-07-012900,Vuln-ID|V-76587"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-013000 - The Samsung Android 7 with Knox must implement the management setting: Enable Certificate Revocation Status (CRL) Check."
  info        : "A CRL allows a certificate issuer to revoke a certificate for any reason, including improperly issued certificates and compromise of the private keys. Checking the revocation status of the certificate mitigates the risk associated with using a compromised certificate.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enable a Certificate Revocation Status (CRL) Check.

On the MDM console, do the following:
1. Enter the string '*' (asterisk) in the package list in the \"Certificate Revocation Check (CRL)\" settings in the \"Android Certificate\" rule.
2. Select the enable checkbox in the \"Certificate Revocation Check (CRL)\" settings in the \"Android Certificate\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91285r1_rule,STIG-ID|KNOX-07-013000,Vuln-ID|V-76589"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-013100 - The Samsung Android 7 with Knox must implement the management setting: Disable Manual Date Time Changes."
  info        : "Determining the correct time a particular application event occurred on a system is critical when conducting forensic analysis and investigating system events.

Periodically synchronizing internal clocks with an authoritative time source is needed in order to correctly correlate the timing of events that occur across the enterprise. The three authoritative time sources for Samsung Android 7 with Knox are an authoritative time server that is synchronized with redundant United States Naval Observatory (USNO) time servers as designated for the appropriate DoD network (NIPRNet or SIPRNet), or the Global Positioning System (GPS), or the wireless carrier.

Time stamps generated by the audit system in Samsung Android 7 with Knox must include both date and time. The time may be expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable manual date and time changes.

On the MDM console, deselect the \"Date Time Changes Enabled\" checkbox in the \"Android Date Time\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91287r1_rule,STIG-ID|KNOX-07-013100,Vuln-ID|V-76591"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-013900 - The Samsung Android 7 with Knox must implement the management setting: Disable Move Files from Container to Personal."
  info        : "Allowing movement of files between the container and personal side will result in both personal data and sensitive DoD data being placed in the same space. This can potentially result in DoD data being transmitted to unauthorized recipients via personal email accounts or social applications, or transmission of malicious files to DoD accounts. Disabling this feature mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce not allowing move of files from Container to personal.

On the MDM console, disable the \"Move Files from Container to Personal\" setting in the \"Android Knox Container >> Container Application\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91289r1_rule,STIG-ID|KNOX-07-013900,Vuln-ID|V-76593"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-014300 - The Samsung Android 7 with Knox must implement the management setting: Container Account whitelist."
  info        : "Whitelisting of authorized email accounts (POP3, IMAP, EAS) prevents a user from configuring a personal email account that could be used to forward sensitive DoD data to unauthorized recipients.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce Container Account Whitelisting.

On the MDM console, add all DoD-approved email domains to the \"Account whitelist\" setting in the \"Container Accounts\" rule.

Note: Recommended to add .*@mail.mil."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91291r1_rule,STIG-ID|KNOX-07-014300,Vuln-ID|V-76595"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017000 - The Samsung DeX Station multimedia dock must not be connected directly to a DoD network."
  info        : "If the Samsung DeX Station multimedia dock is connected to a DoD network, the Samsung smartphone connected to the DeX Station will be connected to the DoD network as well. The Samsung smartphone most likely has a number of personal apps installed that may include malware or have high risk behaviors (for example, off load data from the phone to third-party servers outside the United States). In addition, Smartphones do not generally meet security requirements for computer devices to connect directly to DD networks.

Note: The Samsung DeX Station will not work unless \"USB host storage\" is enabled (see requirement KNOX-07-012600 for more information).

SFR ID: FMT_MOF_EXT.1.2 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "When using the DeX Station multimedia dock with a DoD Samsung smartphone, do not connect the DeX Station to a DoD network via a wired or wireless connection.

Note: This setting cannot be managed by the MDM administrator and is a User Based Enforcement (UBE) requirement."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-000370,Rule-ID|SV-91293r1_rule,STIG-ID|KNOX-07-017000,Vuln-ID|V-76597"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-017100 - The VPN client must be configured: 1. Disabled 2. Configured for container use only. 3. Configured for per app use."
  info           : "The device VPN must be configured to disable access from the personal space/container since it is considered an untrusted environment. Therefore, apps located in the personal container on the device should not have the ability to access a DoD network. In addition, Smartphones do not generally meet security requirements for computer devices to connect directly to DoD networks.

SFR ID: FMT_SMF_EXT.1.1 #3"
  solution       : "Configure the Samsung Android 7 with Knox native VPN client in one of the following configurations so that the device VPN is not available in the personal space:
1. Disabled
2. Configured for container use only.
3. Configured for per app use for the personal side.

This implementation guidance covers the first of these options.

On the MDM console, deselect the \"Allow VPN\" checkbox in the \"Android Restrictions\" rule."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000068,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91295r1_rule,STIG-ID|KNOX-07-017100,SWIFT-CSCv1|2.3,Vuln-ID|V-76599"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow Native VPN ="
  expect         : "Allow Native VPN = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true")) |
                  "Profile: " + .General.Name + " - Allow Native VPN = \(.Restriction.AllowNativeVpn? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-017110 - The VPN client must be configured: 1. Disabled 2. Configured for container use only 3. Configured for per app use."
  info        : "The device VPN must be configured to disable access from the personal space/container since it is considered an untrusted environment. Therefore, apps located in the personal container on the device should not have the ability to access a DoD network. In addition, Smartphones do not generally meet security requirements for computer devices to connect directly to DoD networks.

SFR ID: FMT_SMF_EXT.1.1 #3

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox VPN client in one of the following configurations so that the device VPN is not available in the personal space:
1. Disabled
2. Configured for container use only
3. Configured for per app use for the personal side

This implementation guidance covers the second of these options.

On the MDM Administration Console, do the following:
1. Configure the organization VPN profile in the \"Enterprise VPN profiles\" rule.
2. Enable \"Add All Container Packages To Vpn\" in the \"Generic VPN\" rule."
  reference   : "CAT|II,CCI|CCI-000068,Rule-ID|SV-91297r1_rule,STIG-ID|KNOX-07-017110,Vuln-ID|V-76601"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017120 - The VPN client must be configured: 1. Disabled 2. Configured for container use only. 3. Configured for per app use."
  info        : "The device VPN must be configured to disable access from the personal space/container since it is considered an untrusted environment. Therefore, apps located in the personal container on the device should not have the ability to access a DoD network. In addition, Smartphones do not generally meet security requirements for computer devices to connect directly to DoD networks.

SFR ID: FMT_SMF_EXT.1.1 #3

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox VPN client in one of the following configurations so that the device VPN is not available in the personal space:
1. Disabled
2. Configured for container use only.
3. Configured for per app use for the personal side.

This implementation guidance covers the third of these options.

On the MDM Administration Console, do the following:
1. Configure the organization VPN profile in the \"Enterprise VPN profiles\" rule.
2. Add each AO-approved Package to \"Add Packages To Vpn\" in the \"Generic VPN\" rule."
  reference   : "CAT|II,CCI|CCI-000068,Rule-ID|SV-91299r1_rule,STIG-ID|KNOX-07-017120,Vuln-ID|V-76603"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017130 - If a third-party VPN client is installed, it must not be configured with a DoD network (work) VPN profile."
  info        : "The device VPN must be configured to disable access from the personal space/container since it is considered an untrusted environment. Therefore, apps located in the personal container on the device should not have the ability to access a DoD network. In addition, Smartphones do not generally meet security requirements for computer devices to connect directly to DoD networks.

SFR ID: FMT_SMF_EXT.1.1 #3

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If a third-party VPN client is installed in the personal space/container on a Samsung Android 7 with Knox device, do not configure the VPN client with a DoD network VPN profile."
  reference   : "CAT|II,CCI|CCI-000068,Rule-ID|SV-91301r1_rule,STIG-ID|KNOX-07-017130,Vuln-ID|V-76605"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017200 - The Samsung Android 7 with Knox must be configured to disable Phone Visibility."
  info        : "Phone Visibility feature allows other devices to find your phone (Galaxy S8) and transfer files. Your phone will appear in the list of available devices when files are transferred via Transfer files to devices.

This feature can potentially result in unauthorized access to and compromise of sensitive DoD files. Disabling this feature will mitigate this risk.

SFR ID: FMT_SMF_EXT.1.1 #47
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If the feature is not present as described on a specific device model, this requirement is Not Applicable (NA).

Configure the Samsung Android 7 with Knox to disable Phone Visibility.

On the Samsung Android 7 with Knox device, do the following:
1. Open the device settings.
2. Select \"More\" under Wireless and networks.
3. Disable \"Phone visibility\"."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91303r1_rule,STIG-ID|KNOX-07-017200,Vuln-ID|V-76607"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017400 - The Samsung must be configured to disable authentication mechanisms providing user access. Disable Face Recognition."
  info        : "The Face Recognition feature allows users face to be registered and used to unlock the device. This technology would allow unauthorized users to have access to DoD sensitive data if compromised. By not permitting the use of non-password authentication mechanisms, users are forced to use passcodes that meet DoD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #23, FIA_UAU.5.1

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable Face Recognition.

On the MDM console, add all packages associated with the Face Recognition feature to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,Rule-ID|SV-91305r1_rule,STIG-ID|KNOX-07-017400,Vuln-ID|V-76609"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017600 - The Samsung must be configured to disable authentication mechanisms providing user access. Disable Iris Scanner."
  info        : "The Iris Scanner allows a user to unlock a mobile device without entering a passcode when a registered user Iris is recognized. This technology would allow unauthorized users to have access to DoD sensitive data if compromised. By not permitting the use of non-password authentication mechanisms, users are forced to use passcodes that meet DoD passcode requirements.

SFR ID: FMT_SMF_EXT.1.1 #23, FIA_UAU.5.1

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable authentication mechanisms providing user access to protected data other than a Password Authentication Factor.

Configure the Samsung Android 7 with Knox to disable the Iris Scanner.

On the MDM console, deselect the \"Iris\" checkbox in the \"Android Password Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-000370,CCI|CCI-000381,Rule-ID|SV-91307r1_rule,STIG-ID|KNOX-07-017600,Vuln-ID|V-76611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-017800 - The Samsung Android 7 with Knox must be configured to Disable Bixby."
  info        : "On MOS devices, unauthorized users (may be able to) access the device's contact database or calendar to obtain phone numbers and other information using a human voice even when the mobile device is locked. Often this information is personally identifiable information (PII), which is considered sensitive. It could also be used by an adversary to profile the user or engage in social engineering to obtain further information from other unsuspecting users.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable Bixby.

On the MDM console, add all packages associated with the Bixby feature to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-91309r1_rule,STIG-ID|KNOX-07-017800,Vuln-ID|V-76613"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-018000 - The Samsung Android 7 with Knox must be configured to Disable Smart Call."
  info        : "Smart Call feature provides Caller ID and spam protection. It lets the user know who is calling even when the number is not on the user's contact list by using an online service to do the lookup. Users can also upload their name and number into the online service.

This could allow potentially DoD-sensitive data such as names and telephone number to be compromised.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to disable Smart Call.

On the Samsung Android 7 with Knox device Smart Call is disabled by default."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-91311r1_rule,STIG-ID|KNOX-07-018000,Vuln-ID|V-76615"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-018200 - The Samsung must be configured to Add the MDM Client application to the Battery optimizations modes Whitelist."
  info        : "Doze and App Standby are power-saving features that extend battery life by deferring background CPU and network activity.

If the MDM Client is put into Doze or App Standby mode, the MDM Administrator may not be able to administer the MDM.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to add the MDM Client application to the Battery optimizations modes Whitelist.

On the MDM console, add the MDM Client Package name to the \"Battery optimizations modes Whitelist\" in the \"Android Applications\" rule.

Note: Some MDM consoles may require (or take as an optional input) the MDM Client Signature."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-91313r1_rule,STIG-ID|KNOX-07-018200,Vuln-ID|V-76617"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-018400 - The Samsung Android 7 with Knox must implement the management setting: Configure application disable list."
  info        : "Applications from various sources (including the vendor, the carrier, and Google) are installed on the device at the time of manufacture. Core apps are apps preinstalled by Google. Third-party preinstalled apps included apps from the vendor and carrier. Some of the applications can compromise DoD data or upload users' information to non-DoD-approved servers. A user must be blocked from using such applications that exhibit behavior that can result in compromise of DoD data or DoD user information. The site administrator must analyze all pre-installed applications on the device and block all applications not approved for DoD use by configuring the application disable list.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce application disabled list.

On the MDM console, add all pre-installed applications that are not DoD-approved to the \"Application disable list\" setting in the \"Android Applications\" rule.

Note: Refer to the Supplemental document for additional information.

Note: Include Samsung Accounts on the list."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91315r1_rule,STIG-ID|KNOX-07-018400,Vuln-ID|V-76619"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-018600 - The Samsung Android 7 with Knox must implement the management setting: Configure minimum password complexity."
  info           : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. A minimum level of complexity is needed to ensure a simple password or easily guessed password is not used.

SFR ID: FMT_SMF_EXT.1.1 #47"
  solution       : "Configure the Samsung Android 7 with Knox to have a minimum password complexity.

On the MDM console, configure \"Minimum Password Complexity\" to Alphanumeric in the \"Android Password Restrictions\" rule."
  reference      : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000366,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-91317r1_rule,STIG-ID|KNOX-07-018600,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-76621"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Require Alphanumeric Passcode ="
  expect         : "Require Alphanumeric Passcode = True"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true"))|
                    "Profile: " + .General.Name + " - Require Alphanumeric Passcode = \(.Passcode.RequireAlphanumericValue? // "Not Defined")"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-018800 - The Samsung Android 7 with Knox must implement the management setting: Enable Audit Log."
  info        : "Audit logs enable monitoring of security-relevant events and subsequent forensics when breaches occur. They help identify attacks, so that breaches can either be prevented or limited in their scope. They facilitate analysis to improve performance and security. The Requirement Statement lists key events that the system must generate an audit record for.

SFR ID: FAU_GEN.1.1 #8

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enable \"Audit Log\".

On the MDM console, select the \"Enable Audit Log\" checkbox in the \"Android AuditLog\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91319r1_rule,STIG-ID|KNOX-07-018800,Vuln-ID|V-76623"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-018900 - The Samsung Android 7 with Knox must use a NIAP certified container for work data and applications."
  info        : "When a DoD mobile device contains apps in the personal container that have not been vetted by the DoD for malware or risky behaviors, the personal container must be considered an untrusted environment. Therefore the data separation implementation between the personal data container and the work container must meet the requirements of Mobile Device Fundamentals Protection Profile (FDP_ACF_EXT.1.2) to insure sensitive DoD data in the work container is adequately separated.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Deploy DoD Samsung mobile devices with the Knox container and implement the Knox container. (See requirement KNOX-07-012800.)

Note: Samsung Knox is currently the only container technology/application that is NIAP certified for Samsung mobile devices."
  reference   : "CAT|I,CCI|CCI-000366,Rule-ID|SV-91321r1_rule,STIG-ID|KNOX-07-018900,Vuln-ID|V-76625"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-019000 - Samsung Android 7 mobile device users must complete required training."
  info        : "The security posture of Samsung devices requires the device user to configure several required policy rules on their device. User Based Enforcement (UBE) is required for these controls. In addition, if the AO has approved the use of an unmanaged personal container, than the user must receive training on risks. If a user is not aware of their responsibilities and does not comply with UBE requirements, the security posture of the Samsung mobile device may become compromised and DoD sensitive data may become compromised.

SFR ID: NA

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Have all Samsung device users complete training on the following topics. Users should acknowledge they have received training via a signed User Agreement or similar written record.

Training Topics:

- Operational security concerns introduced by unmanaged applications/unmanaged personal space/container including applications utilizing global positioning system (GPS) tracking
- Need to ensure no DoD data is saved to the personal container or transmitted from a personal app (for example, from personal email)
- If the Purebred key management app is used, users are responsible for maintaining positive control of their credentialed device at all times. The DoD PKI certificate policy requires subscribers to maintain positive control of the devices that contain private keys, and to report any loss of control so that the credentials can be revoked. Upon device retirement, turn in, or reassignment, ensure a factory data reset is performed prior to device hand off. Follow Mobility service provider decommissioning procedures as applicable.
- How to configure the following User Based Enforcement (UBE) controls (users must configure the control) on the Samsung device:
- secure use of Calendar Alarm
- local screen mirroring and MirrorLink procedures (authorized/not authorized for use)
- disable Report Diagnostic Info
- do not connect Samsung DeX Station to any DoD network via Ethernet connection
- disable Phone Visibility
- disable Smart Call
- disable Nearby device scanning
- do not remove DoD intermediate and root PKI digital certificates
- disable WiFi Sharing
- do not configure a DoD network (work) VPN profile on any third-party VPN client installed in the personal space/container
- AO guidance on acceptable use and restrictions, if any, on downloading and installing personal apps and data (music, photos, etc.) in the Samsung device personal space/container."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91323r1_rule,STIG-ID|KNOX-07-019000,Vuln-ID|V-76627"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-019100 - The Samsung Android 7 with Knox platform must implement the management setting Disable Nearby devices."
  info        : "The Nearby devices feature allows the user to share files with other devices that are connected on the same WiFi access point using the DLNA technology. Even though the user must allow requests from other devices, this feature can potentially result in unauthorized access to and compromise of sensitive DoD files. Disabling this feature will mitigate this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the mobile operating system to disable Nearby devices."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91325r1_rule,STIG-ID|KNOX-07-019100,Vuln-ID|V-76629"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "KNOX-07-019200 - The Samsung Android 7 with Knox platform must implement the management setting: Disable Samsung WiFi Sharing."
  info           : "WiFi Tethering allows a device to act as an Access Point sharing its data connection with other wirelessly connected devices. Previously the device could only share its Mobile (Cellular) data connection. On the Device menus this is referred to as \"Mobile Hotspot\". The new feature is an optional configuration of WiFi Tethering/Mobile Hotspot, which allows the Device to share its WiFi connection with other wirelessly connected devices, instead of its Mobile (Cellular) connection.

WiFi sharing grants the \"other\" device access to a corporate WiFi network, and may possibly bypass the network access control mechanisms. This risk can be partially mitigated by requiring the use of a pre-shared key for personal hotspots.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution       : "Disable WiFi Sharing using one of the following methods:

1. If the AO has not approved hotspot tethering for site Samsung devices, on the MDM console, select the \"Disable WiFi Tethering/Mobile Hotspot\"\" checkbox in the \"WiFi Policy\" rule.
OR
2. If the AO has approved hotspot tethering for site Samsung devices, on the Samsung device go to Settings >> Connections >> Mobile Hotspot and Tethering >> Mobile Hotspot.

Turn off WiFi Sharing if it is enabled. WiFi Sharing is disabled by default.

Note: Mobile Hotspot must be enabled in order to enable WiFi Sharing."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CAT|II,CCI|CCI-000366,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-91327r1_rule,STIG-ID|KNOX-07-019200,SWIFT-CSCv1|2.3,Vuln-ID|V-76631"
  see_also       : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
  regex          : "Allow WiFi Tethering ="
  expect         : "Allow WiFi Tethering = False"
  json_transform : '.[] | select ((.type == "Android")  and (.General.IsActive == "true") and (.Restriction.AllowAllTethering? == "true")) |
                    "Profile: " + .General.Name + " - Allow WiFi Tethering = \(.Restriction.AllowWiFiTethering? // "Not Defined")"'
  match_all      : YES
  severity       : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "KNOX-07-900300 - The Samsung must be configured to not allow Container passwords with more than two repeating or sequential characters."
  info        : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute force attacks. Passwords that contain repeating or sequential characters are significantly easier to guess than those that do not contain repeating or sequential characters. Therefore, disallowing repeating or sequential characters increases password strength and decreases risk.

SFR ID: FMT_SMF_EXT.1.1 #1b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to prevent Container passwords from containing more than two repeating or sequential characters.

On the MDM console, do the following:
1. Set the \"Maximum Sequential Characters\" value to \"2\" in the \"Android Knox Container >> Container Password Restrictions\" rule.
2. Set the \"Maximum Sequential Numbers\" value to \"2\" in the \"Android Knox Container >> Container Password Restrictions\" rule."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-91329r1_rule,STIG-ID|KNOX-07-900300,Vuln-ID|V-76633"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-901500 - The Samsung must be configured to enforce a Container application install policy by specifying an application whitelist."
  info        : "The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core and preinstalled applications or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications. Core application - any application integrated into the operating system (OS) by the OS or mobile device (MD) vendors. Pre-installed application - additional non-core applications included in the OS build by the OS vendor, MD vendor, or wireless carrier.

Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications.

The application whitelist, in addition to controlling the installation of applications on the MD, must control user access/execution of all core applications (included in the operating system (OS) by the OS vendor) and pre-installed applications (provided by the MD vendor and wireless carrier), or the MD must provide an alternate method of restricting user access/execution to core and pre-installed applications.

SFR ID: FMT_SMF_EXT.1.1 #8b

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to whitelist application installations into the container based on one of the following characteristics:
- Digital signature
- Package Name

Both whitelists apply to user installable applications only, and do not control user access/execution of core and preinstalled applications. To restrict user access/execution to core and pre-installed applications, the MDM administrator must configure the \"application disable list\".

It is important to note that if the MDM administrator has not blacklisted an application characteristic (package name, digital signature) then it is implicitly whitelisted, as whitelists are exceptions to blacklists. If an application characteristic appears in both the blacklist and whitelist, the white list (as the exception to the blacklist) takes priority, and the User will be able to install the application. Therefore, the MDM administrator must configure the blacklists to include all package names or digital signatures for whitelisting to behave as intended.

On the MDM console, do one of the following:
1. Add each AO-approved package name to the \"Package Name Whitelist\" in the \"Android Knox Container >> Container Applications\" rule.
OR
2. Add each AO-approved digital signature to the \"Signature Whitelist\" in the \"Android Knox Container >> Container Applications\" rule.

Note: Either list may be empty if the Authorizing Official (AO) has not approved any app.

Note: Refer to the Supplemental document for additional information."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-001806,Rule-ID|SV-91331r1_rule,STIG-ID|KNOX-07-901500,Vuln-ID|V-76635"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-912200 - The Samsung Android 7 with Knox must be configured to lock the container after 15 minutes (or less) of inactivity."
  info        : "The screen lock timeout must be set to a value that helps protect the device from unauthorized access. Having a too-long timeout would increase the window of opportunity for adversaries who gain physical access to the mobile device through loss, theft, etc. Such devices are much more likely to be in an unlocked state when acquired by an adversary, thus granting immediate access to the data on the mobile device. The maximum timeout period of 15 minutes has been selected to balance functionality and security; shorter timeout periods may be appropriate, depending on the risks posed to the mobile device.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to lock the container after \"15\" minutes (or less) of inactivity.

On the MDM console, set the \"Maximum Time to Lock\" to the organization-defined value (\"15\" minutes) in the \"Android Knox Container >> Container Password Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91333r1_rule,STIG-ID|KNOX-07-912200,Vuln-ID|V-76637"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913200 - The Samsung must implement the management setting: Configure to enforce a minimum Container password length of 4 characters"
  info        : "Password strength is a measure of the effectiveness of a password in resisting guessing and brute-force attacks. The ability to crack a password is a function of how many attempts an adversary is permitted, how quickly an adversary can do each attempt, and the size of the password space. The longer the minimum length of the password is, the larger the password space. Having a too-short minimum password length significantly reduces password strength, increasing the chance of password compromise and resulting device and data compromise.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce a minimum Container password length of four characters.

On the MDM console, set the \"Minimum Length\" value to \"4\" or greater in the \"Android Knox Container >> Container Password Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91335r1_rule,STIG-ID|KNOX-07-913200,Vuln-ID|V-76639"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913300 - The Samsung must implement the management setting: Disable sharing of calendar information outside the Container."
  info        : "Calendar events can include potentially DoD-sensitive data such as names, contacts, dates and times, and locations. If made available outside the container, this information will be accessible to personal applications, resulting in potential compromise of DoD data.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce disabled sharing of calendar information outside the Container.

On the MDM console, disable the \"Allow calendar info outside container\" setting in the \"Android Knox Container >> Container Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91337r1_rule,STIG-ID|KNOX-07-913300,Vuln-ID|V-76641"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913400 - The Samsung must implement the setting: Configure to prohibit more than 10 failed Container authentication attempts."
  info        : "Users must not be able to override the system policy on the maximum number of consecutive failed authentication attempts because this could allow them to raise the maximum, thus giving adversaries more chances to guess/brute force passwords, which increases the risk of the mobile device being compromised. Therefore, only administrators should have the authority to set consecutive failed authentication attempt policies.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce \"10\" or less failed Container authentication attempts.

On the MDM console, set the \"Maximum Failed Attempts for wipe\" to the organization-defined value in the \"Android Knox Container >> Container Password Restrictions\" rule."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-91339r1_rule,STIG-ID|KNOX-07-913400,Vuln-ID|V-76643"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913500 - The Samsung Android 7 with Knox must be configured to disable sharing of contact information outside the Container."
  info        : "Contacts can include DoD-sensitive data and personally identifiable information (PII) of DoD employees, including names, numbers, addresses, and email addresses. If made available outside the container, this information will be accessible to personal applications, resulting in potential compromise of DoD data.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce disabled sharing of contact information outside the Container.

On the MDM console, do the following:
disable the \"Allow contact info outside container\" setting in the \"Android Knox Container >> Container Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91341r1_rule,STIG-ID|KNOX-07-913500,Vuln-ID|V-76645"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913600 - The Samsung must implement the management setting: Disable sharing of notification details outside the Container."
  info        : "Application notifications can include DoD sensitive data. If made available outside the container, this information will be accessible to personal applications, resulting in potential compromise of DoD data.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce disabled sharing of notification details outside the Container when the container is locked.

On the MDM console, disable the \"Allow Show detailed notifications\" setting in the \"Android Knox Container >> Container Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91343r1_rule,STIG-ID|KNOX-07-913600,Vuln-ID|V-76647"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913700 - The Samsung Android 7 with Knox must implement the management setting: Configure Container application install blacklist."
  info        : "Blacklisting all applications is required so only whitelisted applications can be installed on the device. Requiring all authorized applications to be in an application whitelist prevents the execution of any applications (e.g., unauthorized, malicious) that are not part of the whitelist. Failure to configure an application whitelist and blacklist properly could allow unauthorized and malicious applications to be downloaded, installed, and executed on the mobile device, causing a compromise of DoD data accessible by these applications.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to Blacklist Container Application Install.

On the MDM console, do the following:
1. Add all package names by wildcard ('.*') to the \"Package Name Blacklist\" setting in the \"Android Knox Container >> Container Application\" rule.
2. Add all digital signatures by wildcard ('.*') to the \"Signature Blacklist\" setting in the \"Android Knox Container >> Container Application\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91345r1_rule,STIG-ID|KNOX-07-913700,Vuln-ID|V-76649"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-913800 - The Samsung Android 7 with Knox must implement the management setting: Disable Move Applications to Container."
  info        : "Applications determined to be acceptable for personal use outside the container might not be acceptable for use within the container. The Move Applications to Container feature allows users to install personal side applications into the container, resulting in potential compromise of DoD data. Disabling this feature mitigates this risk.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce not allowing move of applications to Container.

On the MDM console, disable the \"Move Applications to Container\" setting in the \"Android Knox Container >> Container Application\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91347r1_rule,STIG-ID|KNOX-07-913800,Vuln-ID|V-76651"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-914100 - The Samsung Android 7 with Knox must implement the management setting: Configure Container application disable list."
  info        : "Applications from various sources (including the vendor, the carrier, and Google) are installed on the device at the time of manufacture. Core apps are apps preinstalled by Google. Third-party preinstalled apps included apps from the vendor and carrier. Some of the applications can compromise DoD data or upload users' information to non-DoD-approved servers. A user must be blocked from using such applications that exhibit behavior that can result in compromise of DoD data or DoD user information. The site administrator must analyze all pre-installed applications on the device and block all applications not approved for DoD use by configuring the application disable list.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce Container application disabled list.

On the MDM console, add all pre-installed container applications that are not DoD-approved to the \"Application disable list\" setting in the \"Android Knox Container >> Container Application\" rule.

Note: Refer to the Supplemental document for additional information.

Note: Include Samsung Accounts on the list."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91349r1_rule,STIG-ID|KNOX-07-914100,Vuln-ID|V-76653"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-914200 - The Samsung must implement the management setting: Disable automatic completion of Container browser text input."
  info        : "The auto-fill functionality in the web browser allows the user to complete a form that contains sensitive information, such as personally identifiable information (PII), without previous knowledge of the information. By allowing the use of auto-fill functionality, an adversary who learns a user's Samsung Android 7 with Knox device password, or who otherwise is able to unlock the device, may be able to further breach other systems by relying on the auto-fill feature to provide information unknown to the adversary. By disabling the auto-fill functionality, the risk of an adversary gaining further information about the device's user or compromising other systems is significantly mitigated.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce disabled automatic completion of Container browser text input.

On the MDM console, deselect the \"Allow Auto-Fill\" checkbox in the \"Android Knox Container >> Container Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91351r1_rule,STIG-ID|KNOX-07-914200,Vuln-ID|V-76655"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-914400 - The Samsung Android 7 with Knox must implement the management setting: Container Account blacklist."
  info        : "Blacklisting all email accounts is required so only whitelisted accounts can be configured.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce Container Account Blacklisting.

On the MDM console, add all email domains not approved by DoD to the \"Account blacklist\" setting in the \"Container Accounts\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91353r1_rule,STIG-ID|KNOX-07-914400,Vuln-ID|V-76657"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "KNOX-07-914500 - The Samsung Android 7 with Knox must implement the management setting: Configure minimum Container password complexity."
  info        : "Authentication mechanisms other than a Password Authentication Factor often provide convenience to users, but many of these mechanisms have known vulnerabilities. Configuring a minimum password complexity mitigates the risk associated with a weak authentication factor.

SFR ID: FMT_SMF_EXT.1.1 #47

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Samsung Android 7 with Knox to enforce minimum Container password complexity.

On the MDM console, set the \"Minimum Password Complexity\" value to \"Alphanumeric\" in the \"Android Knox Container >> Container Password Restrictions\" rule."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-91355r1_rule,STIG-ID|KNOX-07-914500,Vuln-ID|V-76659"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Samsung_Android_OS_7_with_Knox_2-x_V1R1_STIG.zip"
</report>

</check_type>
