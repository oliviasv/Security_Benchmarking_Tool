#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2020/04/17 $
#
# description : This document implements the security configuration as recommended by the
#               CIS Google Android Benchmark v1.3.0
#
#<ui_metadata>
#<display_name>AirWatch - CIS Google Android v1.3.0 L1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>AirWatch - CIS Google Android L1</name>
#  <version>1.3.0</version>
#</spec>
#<labels>mdm,cis,airwatch,android</labels>
#<benchmark_refs>CSCv6,LEVEL</benchmark_refs>
#</ui_metadata>

<check_type:"MDM" mdm_type:AIRWATCH>

<report type:"WARNING">
  description : "1.1  Ensure device firmware is up to date"
  info        : "Ensure that the device is kept up to date with security patch levels.
The recommended state for this setting is: Apply updates.

Rationale:

Firmware updates often include critical security fixes that reduce the probability of an attacker remotely exploiting the device. The device should be on the latest security patch level as applicable.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to check and update the device security patch level:

Tap Settings Gear Icon.
Tap System.
Tap Advanced.
Tap System Updates.
Tap Check for update.
Apply the update, if available.

Impact:

None

Default Value:

By default, users are notified about security patch level updates but are not installed until
the user initiates the process."
  reference   : "CSCv6|4,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.2  Ensure 'Screen Lock' is set to 'Enabled'"
  info           : "Enable Screen lock.
The recommended state for this setting is: Enabled.

Rationale:

Enabling Screen lock requires a form of user authentication before interacting with the device. This strengthens application and data protection and overall improves the device security."
  solution       : "To configure a Pattern, PIN or Password for the device:

Tap Settings Gear Icon.
Tap Security.
Scroll to the Device Security section.
Tap Screen Lock.
Tap Pattern, PIN or Password.
Enter a complex Pattern, PIN or Password.
Tap Continue.
Enter in the same complex Pattern, PIN or Password again.
Tap OK.

Impact:

A user will be prompted to unlock the device on every use.

Default Value:

By default, screen lock is not set."
  reference      : "800-53|AC-14,CSCv6|16.5,ITSG-33|AC-14,LEVEL|1NS,NESA|T5.6.1"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Require Passcode ="
  expect         : "Require Passcode = true"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Require Passcode = \(if (.Passcode.Passcode) then "not defined" else (.Passcode.RequirePasscode // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.3  Ensure 'Make pattern visible' is set to 'Disabled' (if using a pattern as device lock mechanism)"
  info        : "Disable pattern visibility if using a pattern as device lock mechanism.
The recommended state for this setting is: Disabled.

Rationale:

Keeping device unlock pattern visible during device unlock can reveal the pattern and is vulnerable to shoulder surfing attack. Hence, do not make the device unlock pattern visible.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "To disable device unlock pattern visibility, follow the below steps:

Tap Settings Gear Icon.
Tap Security.
Scroll to the Device security section.
If Screen lock has Pattern underneath the text, follow further steps. If not, then this recommendation is not applicable.
Tap the Gear Icon next to Screen lock.
Toggle Make pattern visible to OFF position.

Impact:

The user would have to be careful while entering the device unlock pattern since visual feedback would not provide any clues for tracing pattern input.

Default Value:

By default, device unlock pattern is visible."
  reference   : "CSCv6|16,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.4  Ensure 'Automatically Lock' is set to 'Immediately'"
  info           : "Immediately lock the phone as soon as the device goes to sleep.
The recommended state for this setting is: Immediately.

Rationale:

Automatically and immediately locking the device as soon as it goes to sleep ensure that there is no lag between the device entering the sleep state and the device getting locked. At times, the user just rests the device and moves away from it. The phone eventually enters the sleep state and automatically and immediately locking it ensures that no manual locking of the device is needed. This ensures that the unattended devices are locked immediately as soon as the device enters the sleep state."
  solution       : "Follow the below steps and set Automatically Lock to Immediately:

Tap Settings Gear Icon.
Tap Security.
Scroll to the Device security section.
Tap the Gear icon next to Screen lock.
Tap Automatically lock.
Tap Immediately.

Impact:

None

Default Value:

By default, Automatically lock is set to 5 seconds after sleep."
  reference      : "800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.4,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1NS,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Grace Period ="
  expect         : "Grace Period = 0"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Grace Period = \(if (.Passcode.Passcode) then "not defined" else (.Passcode.GracePeriodForDeviceLock // "not defined") end)"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.5  Ensure 'Power button instantly locks' is set to 'Enabled'"
  info           : "Pressing the power button should lock the device instantly.
The recommended state for this setting is: Enabled.

Rationale:

Pressing the power button instantly puts the phone to sleep. Enabling Power button instantly locks setting ensures that the device is instantly locked as well."
  solution       : "Follow the below steps to enable the Power button instantly locks setting:

Tap Settings Gear Icon.
Tap Security.
Scroll to the Device security.
Tap the Gear icon next to Screen lock.
Toggle Power button instantly locks setting to ON position.

Impact:

None

Default Value:

By default, Power button instantly locks setting is enabled."
  reference      : "800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1NS,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Grace Period ="
  expect         : "Grace Period = 0"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Grace Period = \(if (.Passcode.Passcode) then "not defined" else (.Passcode.GracePeriodForDeviceLock // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.6  Ensure 'Lock Screen Message' is configured"
  info        : "Set a message to be displayed on the locked screen.
The recommended state for this setting is: Configure Lock Screen Message.

Rationale:

When device screen is locked, a lock screen message helps to provide
deterrent warnings,
device recognition without needing to unlock it and
most importantly emergency information
Such information could be valuable to both your device security as well as personnel security. It is thus recommended to have a suitable lock screen message.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to set up a Lock screen message:

Tap Settings Gear Icon.
Tap Display.
Tap Advanced.
Tap Lock screen display.
Scroll to the WHAT TO SHOW section.
Tap Lock screen message.
Write your message and tap Save.

Impact:

Anyone who picks up your device can see your message and emergency information without unlocking your phone.

Default Value:

By default, no message is set."
  reference   : "CSCv6|16.5,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.9  Ensure 'Developer Options' is set to 'Disabled'"
  info           : "Disable Developer Options.
The recommended state for this setting is: Disabled.

Rationale:

Enabling Developer Options allows a user to drastically alter certain very advanced settings on the device. This can severely affect the way device functions and exposes greater and developmental features to the user. This also exposes the device to respond to features such as USB debugging (when enabled) and other such features that could be exploited to get malicious access to the device sub-system. Hence, the Developer Options should be disabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to disable Developer Options:

Tap Settings Gear Icon.
Tap System.
Tap Advanced.
Tap Developer options.
Toggle it to OFF position.

Impact:

None

Default Value:

By default, Developer options is disabled."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|5,CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow Developer Options ="
  expect         : "Allow Developer Options = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Developer Options = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowDeveloperOptions // "not defined") end)"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.10  Ensure 'Install unknown apps' is set to 'Disabled'"
  info           : "Disable installation of apps from unknown sources.
The recommended state for this setting is: Disabled.

Rationale:

This setting determines whether applications can be installed from locations other than Google Play. Disabling installation from untrusted distribution channels protects against inadvertent installation of untrusted or malicious applications. Apps on Google play are vetted by Google Security Team and are mostly safe to install. You should avoid installing apps from anywhere else.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to disable Install unknown apps:

Tap Settings Gear Icon.
Tap Apps & notifications.
Tap Advanced.
Tap Special app access.
Tap Install unknown apps.
Tap any app showing Allowed.
Toggle Allow from this source to OFF position.

Impact:

None

Default Value:

By default, Install unknown apps is disabled."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|2,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow Non-Market App Installation ="
  expect         : "Allow Non-Market App Installation = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Non-Market App Installation = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowNonMarketAppInstallation // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.11  Do not root your device"
  info        : "Do not root your device.
The recommended state for this setting is: Do not Root.

Rationale:

Rooting your Android device breaks the user level restrictions put by the Android operating system. This significantly opens up the device to allow literally any privileged action. Rooting enables any form of alteration to the device. This puts the device at a much greater risk because any vulnerability can be exploited without any restrictions. This also voids the warranty and future security updates are problematic to install. Hence, for all user purposes, do not root your device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow your device manufacturer support/documentation/community to completely un-root your device.
Impact:

None

Default Value:

By default, devices are not rooted and run with user level restrictions."
  reference   : "CSCv6|5,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.15  Ensure 'Use network-provided time' and 'Use network-provided time zone' are set to 'Enabled'"
  info        : "Enable Use network-provided time. For this setting to work correctly, Use network-provided time zone` setting should also be enabled.
The recommended state for this setting is: Enabled.

Rationale:

Use network-provided time setting fetches the date and time information from the cellular provider and is generally more accurate and reliable than your own managed and set date and time. Accurate date and time could help in forensics, device recovery through Android Device Manager and maintain application and logs in a time-sync manner.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Use network-provided time and Use network-provided time zone settings:

Tap Settings Gear Icon.
Tap System.
Tap Date & time.
Toggle Use network-provided time setting to ON position.
Toggle Use network-provided time zone setting to ON position.

Impact:

None
Default Value:

By default, Use network-provided time and Use network-provided time zone settings are Enabled."
  reference   : "CSCv6|6,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.16  Ensure 'Remotely locate this device' is set to 'Enabled'"
  info        : "Enable remotely locating the device.
The recommended state for this setting is: Enabled.

Rationale:

Remotely locate this device setting helps you to track your lost device using Find My Device. It must be enabled for improving the recovery possibility of your device.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Remotely locate this device:

Tap Settings Gear Icon..
Tap Google.
Scroll to the Services section.
Tap Security.
Scroll to Find My Device section.
Tap Find My Device.
Toggle Remotely locate this device setting to ON position.

Impact:

This setting requires you to keep location services enabled all the time. This might be a privacy issue for you.

Default Value:

By default, Remotely locate this device setting is enabled."
  reference   : "CSCv6|1,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.17  Ensure 'Allow remote lock and erase' is set to 'Enabled'"
  info        : "Enable remotely locking and erasing the device.
The recommended state for this setting is: Enabled.

Rationale:

Allow remote lock and erase setting helps you to remotely lock your device or erase your data through Find My Device. This helps you to safeguard your privacy and protect your data from unsanctioned access.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Allow remote lock and erase:

Tap Settings Gear Icon..
Tap Security.
Scroll to the DEVICE SECURITY section.
Tap Device admin apps.
Tap Find My Device toggle.
Tap Activate this device.

Impact:

This setting requires you to keep location services enabled all the time. This might be a privacy issue for you.

Default Value:

By default, Allow remote lock and erase setting is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.18  Ensure 'Scan device for security threats' is set to 'Enabled'"
  info        : "Scan device for security threats.
The recommended state for this setting is: Enabled.

Rationale:

Scan device for security threats setting lets Google regularly check your device and prevent or warn about potential harm. This should be always enabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Scan device for security threats:

Tap Settings Gear Icon.
Tap Google.
Scroll to the Services section.
Tap Security.
Scroll to the Security Status section.
Tap Google Play Protect.
Tap Settings Gear icon.
Toggle Scan device for security threats setting to ON position.

Impact:

None

Default Value:

By default, Scan device for security threats setting is disabled."
  reference   : "CSCv6|8,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.19  Ensure 'Improve harmful app detection' is set to 'Enabled'"
  info        : "Improve detection of harmful apps.
The recommended state for this setting is: Enabled.

Rationale:

Enabling Improve harmful app detection setting sends anonymous information to Google about apps that were not installed from Google Play. This is especially true if you choose to install apps from \"Unknown sources\" outside of the Google Play Store. This information helps Google better protect everyone from harmful apps.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Improve harmful app detection:

Tap Settings Gear Icon.
Tap Google.
Scroll to the Services section.
Tap Security.
Scroll to the Security Status section.
Tap Google Play Protect.
Toggle Improve harmful app detection setting to ON position.

Impact:

User data needs to be sent to Google that may incur data charges based on your carrier. Also, this user data might contain, but not restricted to, log information, URLs related to the app, device ID, your Android version, and IP address.

Default Value:

By default, Improve harmful app detection setting is disabled."
  reference   : "CSCv6|8,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.20  Ensure 'Ask for unlock pattern/PIN/password before unpinning' is set to 'Enabled'"
  info        : "Unpinning should require re-authentication.
The recommended state for this setting is: Enabled.

Rationale:

Your might lend your device to a friend or anyone else for carrying out a single task such as make an emergency phone call or play a game. You should use screen pinning in such a situation. It locks the users to the particular screen that you handed over the device with. Users cannot use the device outside of that application until the screen is unpinned. Unpinning screen should require re-authentication.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Ask for pattern/PIN/password before unpinning:

Tap the Settings Gear Icon.
Tap Security.
Scroll to the DEVICE SECURITY section.
Tap Advanced.
Tap Screen pinning.
If you are using Screen Pinning, then toggle Ask for pattern/PIN/password before unpinning setting to ON position.

Impact:

None

Default Value:

By default, if you enable Screen pinning, then Ask for pattern/PIN/password before unpinning setting is also enabled if you have previously chosen to lock your device with a pattern, PIN or password. If you have previously chosen to not lock your device, you would be required to set it up by tapping Lock device when unpinning after enabling Screen pinning."
  reference   : "CSCv6|16.5,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "1.21  Ensure 'Screen timeout' is set to '1 minute or less'"
  info           : "Set Screen timeout setting to 1 minute or less.
The recommended state for this setting is: 1 Minute or less.

Rationale:

You should set inactivity timeout to avoid unsanctioned usage of the device if you leave it unattended. The inactivity timeout not only blackens your screen after stipulated time period but also kicks in other security features such as screen lock that protect your device when you leave it unattended."
  solution       : "Follow the below steps to set Screen timeout setting to 1 minute or less:

Tap on Settings Gear Icon.
Tap Display.
Tap Advanced.
Tap Screen timeout.
Tap on time duration of 1 minute or less.

Impact:

You would need to unlock your device after every time inactivity period is reached.

Default Value:

By default, Screen timeout is set to 1 minute of inactivity."
  reference      : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.4,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1NS,NIAv2|AM23c,NIAv2|AM23d"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Device Lock Timeout ="
  expect         : "Device Lock Timeout = 1[^0-9]"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Device Lock Timeout = \(if (.Passcode.Passcode) then "not defined" else (.Passcode.DeviceLockTimeoutInMinutes // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "1.22  Ensure 'Wi-Fi assistant' is set to 'Disabled'"
  info        : "Disable automatically connecting your device to open Wi-Fi.
The recommended state for this setting is: Disabled.

Rationale:

Wi-Fi assistant automatically connects to any open Wi-Fi and tunnel the connection through Google VPN servers. Even with the level of security included when this setting is enabled, it is recommended that users only connect to trusted networks manually and to leave this setting disabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Wi-Fi assistant:

Tap Settings Gear Icon.
Tap Google.
Scroll to the Services section.
Tap Networking.
Toggle Wi-Fi assistant to OFF position.

Impact:

You would not benefit from open Wi-fi connections and would require using cellular data.

Default Value:

By default, Wi-Fi assistant setting is enabled.
Note: on the Verizon Variant this setting is disabled. Also, this feature is available only on Pixel phones and Nexus devices running Android 5.1 and up in the selected countries."
  reference   : "CSCv6|15.4,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.23  Keep device Apps up to date"
  info        : "Regularly update your device apps.
The recommended state for this setting is: Update apps.

Rationale:

Keeping apps updated gives you access to the latest features and improves app security and stability. This has similar advantages as patching. Hence, keep your device apps updated.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to update all Apps:

Tap/slide up Launcher.
Launch Play Store App in the App drawer.
Tap Menu.
Tap My apps & Games.
If there are any updates pending, then tap Update All.

Impact:

You might incur data charges.

Default Value:

By default, apps are automatically updated. If cellular data is not a concern or secure Wi-Fi is available then you can leave the default Playstore app setting to auto update the apps to ensure that apps are updated automatically."
  reference   : "CSCv6|4,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.24  Ensure 'Add users from lock screen' is set to 'Disabled'"
  info        : "Do not allow adding users on a locked device.
The recommended state for this setting is: Disabled.

Rationale:

Users and the guest profile can do most of the same things as the device's owner, but each profile has its own storage space. Guests could install malicious apps or carry out any other malicious activities that may compromise overall device security. Also, Wi-Fi and Bluetooth connections are shared which could give guests unauthorized access to networks/devices that could compromise data. Hence, Add users from lock screen setting should be disabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Add users from lock screen setting:

Tap Settings Gear Icon.
Tap System.
Tap Advanced.
Tap Multiple users.
Toggle Add users from lock screen setting to OFF position.

Impact:

Users will not be able to add additional users when the device is locked.

Default Value:

By default, Add users from lock screen setting is enabled."
  reference   : "CSCv6|16.5,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.25  Ensure 'Guest profiles' do not exist"
  info        : "Do not add any guest profiles on the device.
The recommended state for this setting is: Remove Guest profiles.

Rationale:

Users and the guest profile can do most of the same things as the device's owner, but each profile has its own storage space. Guests could install malicious apps or carry out any other malicious activities that may compromise overall device security. Also, Wi-Fi and Bluetooth connections are shared which could give guests unauthorized access to networks/devices that could compromise data. Hence, do not add any guest profiles on the device.
If you need to give your device to someone for temporary use, use Screen Pinning to restrict access to the desired app and be in the complete visibility of your device all the time.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps remove the Guest profile:

Open Quick Settings drawer.
Tap the Profile icon.
Switch to Guest profile.
Open Quick Settings drawer.
Tap Remove guest.
Confirm removal by tapping remove.

Impact:

None

Default Value:

By default, Guest profiles do not exist."
  reference   : "CSCv6|16,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.26  Review app permissions periodically"
  info        : "Review your device app's permissions periodically.
The recommended state for this setting is: Review app permissions regularly.

Rationale:

App permissions allow you to control which capabilities or information apps could access on your device. This can extend from using device hardware to using your personal data. You should periodically review your all app's permissions and ensure that those apps have legitimate permissions. Uninstall apps that over-seek permissions.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to set your app permissions appropriately:

Tap Settings Gear Icon.
Tap Apps & notifications.
Tap App permissions.
Tap on each permission and review the apps that have them.
Disable the app permissions that you feel are over-permissive.

Impact:

Some of the apps tend to have more than required permissions. Such apps might not work if you disable the permissions it originally asked for. Also, if you disable the needed permissions, you may not be able to use the app and might have to re-install it.

Default Value:

By default, apps seek permissions on first use or during installation."
  reference   : "CSCv6|14.4,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "1.27  Ensure 'Instant apps' is set to 'Disabled'"
  info        : "Disable instant apps.
The recommended state for this setting is: Disabled.

Rationale:

Instant apps allow you to use apps without installing them on your device. On clicking app links, the browser downloads and run app modules as desired by the user.
Having exposure to an app like this is dangerous since any malicious link could then potentially trick the user and then browser could download the app code and run on your device without requiring installation. Also, this feature defies enterprise security that relies on blacklisting or whitelisting apps based on installation. Hence, it is recommended to turn off instant apps.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Instant apps:

Tap on Settings Gear Icon.
Tap Apps & notifications.
Tap Advanced.
Tap Default apps.
Tap Opening links.
Toggle Instant apps setting to OFF position.

Impact:

Instant apps will not be available. The app links would open on the browser as other regular links.

Default Value:

By default, Instant apps is enabled."
  reference   : "CSCv6|18,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "2.1  Ensure 'Lock screen' is set to 'Don't show notifications at all'"
  info           : "Disable notifications on the lock screen.
The recommended state for this setting is: Don't show notifications at all.

Rationale:

If the device is lost or is unattended, then disabling notifications do not display any notification information on the locked screen. This information might be private or confidential and thus unwarranted disclosures could be avoided.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to set the On the lock screen to Don't show notifications at all:

Tap Settings Gear Icon.
Tap Apps & notifications.
Tap Notifications.
Tap Advanced.
Tap Lock Screen.
Tap Lock Screen and set it to Don't show notifications at all.

Impact:

The user will notbe able to see contents of notifications on lock screen requiring her to unlock the device each time.

Default Value:

By default, notification content is shown on the locked screen."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|16.5,CSCv6|9.1,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow Notifications ="
  expect         : "Allow Notifications = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Notifications = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowNotifications // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "2.4  Ensure 'Web and App Activity' is set to 'Disabled'"
  info        : "Disable linking of web and app activity to your account when you are logged out.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

When this setting is enabled, your searches and activity from other Google services are linked and saved to your Google Account, even when you are logged out or offline. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Web & App Activity setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle Web & App Activity setting to OFF position.

Impact:

Web and App activities would not be linked to your account. You might not get personalized user experience.

Default Value:

By default, Web & App Activity is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.5  Ensure 'Device Information' is set to 'Disabled'"
  info        : "Disable storing device information to your account.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

Turning on Device Information setting saves various device related information to your account to give you personalized results, suggestions, and experiences. The information saved might include contact lists, calendars, alarms, apps, and music. Additionally, information such as whether the screen is on, the battery level, the quality of your Wi-Fi or Bluetooth connection, touchscreen and sensor readings, and crash reports are also saved and shared with Google. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Device Information setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle Device Information setting to OFF position.

Impact:

You might not get personalized user experience.

Default Value:

By default, Device Information is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.6  Ensure 'Voice & Audio Activity' is set to 'Disabled'"
  info        : "Disable saving your voice and other audio to your Google Account.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

Google records your voice and other audio when you use audio activations. Audio can be saved even when your device is offline. When Voice & Audio Activity is off, voice inputs won't be saved to your Google Account, even if you're signed in. Instead, they may only be saved using anonymous identifiers. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Voice & Audio Activity setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle Voice & Audio Activity setting to OFF position.

Impact:

You might not get personalized user experience.

Default Value:

By default, Voice & Audio Activity setting is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.7  Ensure 'YouTube Search History' is set to 'Disabled'"
  info        : "Disable storing YouTube Search History to your account.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

Turning on YouTube Search History setting links and stores all your YouTube searches to your account across any device. Also, your YouTube and Google search history influences the recommendations that you see on your YouTube homepage when you are logged-in. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable YouTube Search History setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle YouTube Search History setting to OFF position.

Impact:

You might not get personalized user experience.

Default Value:

By default, YouTube Search History setting is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.8  Ensure 'YouTube Watch History' is set to 'Disabled'"
  info        : "Disable storing YouTube Watch History to your account.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

Turning on YouTube Watch History setting links and stores all your watched YouTube videos to your account from any device. Also, this influences the recommendations that you see on your YouTube homepage when you are logged-in and other YouTube video recommendations. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable YouTube Watch History setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle YouTube Watch History setting to OFF position.

Impact:

You might not get personalized user experience.

Default Value:

By default, YouTube Watch History setting is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.9  Ensure 'Google Location History' is set to 'Disabled'"
  info        : "Disable storing your location history.
Note: This setting is applicable only for Google Pixel range of devices.
The recommended state for this setting is: Disabled.

Rationale:

When Google Location History setting is turned on, your device periodically sends diagnostics information to Google about what's working and what's not working in relation to Location History. Location History allows Google to regularly obtain location data from the device. It also stores your Location History to provide results and recommendations across Google products. This could be privacy-invasive and hence it is recommended to disable this setting.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to disable Google Location History setting:

Tap Settings Gear Icon.
Tap Privacy.
Tap Advanced.
Tap Activity Controls.
Toggle Google Location History setting to OFF position.

Impact:

You might not get personalized user experience.

Default Value:

By default, Google Location History setting is enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<report type:"WARNING">
  description : "2.10  Ensure 'Opt out of Ads Personalization' is set to 'Enabled'"
  info        : "Restrict apps from building your app profile.
The recommended state for this setting is: Enabled.

Rationale:

Apps can use your app/browsing data to build a profile for displaying personalized ads. To protect your privacy, you should disable building your profiles from various app/browsing activities.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to enable Opt out of Ads Personalization setting:

Tap Settings Gear Icon.
Tap Google.
Scroll to the Services section.
Tap Ads.
Toggle Opt out of Ads Personalization setting to ON position.

Impact:

You might not get personalized ads experience.

Default Value:

By default, Opt out of Ads Personalization setting is disabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.1  Ensure 'Microphone' is set to 'Enabled'"
  info           : "This setting controls if a site asks before accessing the microphone.
The recommended state for this setting is: Enabled.

Rationale:

Websites will have to ask permission before being allowed to access the microphone which will help prevent unwanted access to the microphone and help protect against potential privacy concerns.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to Enable the Microphone permission request:

Tap Chrome Icon.
Tap Menu Icon.
Tap Settings.
Scroll to the Advanced section.
Tap Site settings.
Tap Microphone.
Toggle to the ON position.

Impact:

Users will be prompted each time a website requests access to the microphone.

Default Value:

Enabled."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|13,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow Microphone ="
  expect         : "Allow Microphone = true"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Microphone = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowMicrophone // "not defined") end)"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.2  Ensure 'Location' is set to 'Enabled'"
  info           : "This setting controls if a site asks before accessing the location.
The recommended state for this setting is: Enabled.

Rationale:

Websites will have to ask permission before being allowed to access the location which will help prevent unwanted access to the users location and help protect against potential privacy concerns.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to Enable the Location permission request:

Tap Chrome Icon.
Tap Menu Icon.
Tap Settings.
Scroll to the Advanced section.
Tap Site settings.
Tap Location.
Toggle to the ON position.

Impact:

Users will be prompted each time a website requests access to the location.

Default Value:

Enabled."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|13,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow GPS Location Services ="
  expect         : "Allow GPS Location Services = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow GPS Location Services = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowGpsLocationServices // "not defined") end)"'
  match_all      : YES
</custom_item>

<custom_item>
  type           : FULL_PROFILE_INFO
  description    : "3.3  Ensure 'Allow third-party cookies' is set to 'Disabled'"
  info           : "A third-party cookie is a cookie sent by a domain that differs from the domain in the browser's address bar.
The recommended state for this setting is: Disabled.

Rationale:

Blocking third party cookies can help protect a user's privacy by eliminating a number of website tracking cookies.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution       : "Follow the below steps to Disabled the Allow third-party cookies option:

Tap Chrome Icon.
Tap Menu Icon.
Tap Settings.
Scroll to the Advanced section.
Tap Site settings.
Tap Allow third-party cookies.
Uncheck the Allow third-party cookies checkbox.

Impact:

Blocking third-party cookies may adversely effect the functionality of some sites.

Default Value:

Enabled."
  reference      : "800-171|3.1.18,800-171|3.4.6,800-171|3.4.7,800-53|AC-19,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|13,CSF|PR.AC-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also       : "https://workbench.cisecurity.org/files/2466"
  regex          : "Allow Cookies ="
  expect         : "Allow Cookies = false"
  json_transform : '.[] | select((.type == "Android") and (.General.IsActive == "true")) | "Policy: " + .General.Name + " - Allow Cookies = \(if (.Restriction.Restriction) then "not defined" else (.Restriction.AllowCookies // "not defined") end)"'
  match_all      : YES
</custom_item>

<report type:"WARNING">
  description : "3.4  Ensure 'Safe Browsing' is set to 'Enabled'"
  info        : "This setting controls the Safe Browsing feature.
The recommended state for this setting is: Enabled.

Rationale:

Google Safe Browsing helps protect devices every day by showing warnings to users when they attempt to navigate to dangerous sites or download dangerous files.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Follow the below steps to Enable the Safe Browsing feature:

Tap Chrome Icon.
Tap Menu Icon.
Tap Settings.
Scroll to the Advanced section.
Tap Privacy.
Check the Safe Browsing checkbox.

Impact:

Users will be shown a warning message before they visit a dangerous site or download a harmful app.

Default Value:

Enabled."
  reference   : "CSCv6|13,LEVEL|1NS"
  see_also    : "https://workbench.cisecurity.org/files/2466"
</report>

</check_type>
