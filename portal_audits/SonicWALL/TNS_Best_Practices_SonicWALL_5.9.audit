#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.3 $
# $Date: 2020/04/07 $
#
# Description   : This .audit is designed to review the configuration of a SonicWALL v5.9 security appliance
#               and validate its settings against a comprehensive list of important settings.
#
#<ui_metadata>
#<display_name>TNS SonicWALL v5.9 Best Practices</display_name>
#<spec>
#  <type>TNS</type>
#  <name>SonicWALL v5.9 Best Practices</name>
#  <version>2.0.0</version>
#</spec>
#<labels>sonicwall,sonicos,tenable</labels>
#<variables>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>10\.0\.0\.2</default>
#    <description>Network Time Server</description>
#    <info>Host address of the NTP server for the target.</info>
#  </variable>
#  <variable>
#    <name>DNS_SERVER</name>
#    <default>10\.0\.0\.2</default>
#    <description>Domain Name Server</description>
#    <info>Host address of the DNS server for the target.</info>
#  </variable>
#  <variable>
#    <name>RADIUS_SERVER</name>
#    <default>10\.0\.0\.2</default>
#    <description>Radius Server</description>
#    <info>Host address of the Radius server for the target.</info>
#  </variable>
#  <variable>
#    <name>GMS_HOST</name>
#    <default>10\.0\.0\.2</default>
#    <description>Global Management System IP</description>
#    <info>Host address of the Global Management System for the target.</info>
#  </variable>
#  <variable>
#    <name>ATTACK_THRESHOLD</name>
#    <default>300</default>
#    <description>SYN Attack Threshold</description>
#    <info>Set the SYN attack threshold to a value that aligns with the statistics of your device</info>
#  </variable>
#  <variable>
#    <name>SYSLOG_SERVER</name>
#    <default>10\.0\.0\.2</default>
#    <description>Syslog server name or IP address</description>
#    <info>Ensure you use the syslog server name or IP found under log->syslog section of the web interface</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"SonicWALL">

<custom_item>
  description : "SonicWALL - Review the NTP server configuration"
  info        : "Ensuring that approved NTP servers are used allows for accurate log/audit file correlation."
  solution    : "To add an NTP server to the SonicWALL security appliance configuration:
Step 1 - Click Add. The Add NTP Server window is displayed.
Step 2 - Type the IP address of an NTP server in the NTP Server field.
Step 3 - Click OK.
Step 4 - Click Accept on the System > Time page to update the SonicWALL security appliance."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4.1,SANS-CSC|14"
  context     : "time"
  regex       : "^[\s]*ntp-server[\s]*"
# Note: Variable @NTP_SERVER@ replaced with "10\\.0\\.0\\.2" in field "expect".
  expect      : "^[\s]*ntp-server[\s]+10\\.0\\.0\\.2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Review the DNS Server Settings"
  info        : "The DNS server IP address should be reviewed. A DNS server may return malicious IP addresses in response to requests for domains that are normally good. This provides an avenue to leak information about the appliance or to download untrusted content."
  solution    : "The Network > DNS page allows you to manually configure your DNS settings, if necessary. In the DNS Settings section, select 'Specify DNS Servers Manually' and enter the IP address(es) into the DNS Server fields. Click Accept to save your changes."
  reference   : "800-53|SC-20,ITSG-33|SC-20,PCI-DSS|2.2.3,SANS-CSC|19"
  regex       : "[\s]*dns[\s]+primary[\s]*"
# Note: Variable @DNS_SERVER@ replaced with "10\\.0\\.0\\.2" in field "expect".
  expect      : "^[\s]*dns[\s]+primary[\s]+10\\.0\\.0\\.2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - AAA - RADIUS server is trusted"
  info        : "AAA - RADIUS - ensure RADIUS server is trusted - review configuration."
  solution    : "Configure the RADIUS server settings via the web management portal"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SANS-CSC|19,SWIFT-CSCv1|2.3"
  context     : "user radius"
  context     : "[\s]*server primary"
  regex       : "^[\s]*host[\s]*"
# Note: Variable @RADIUS_SERVER@ replaced with "10\\.0\\.0\\.2" in field "expect".
  expect      : "^[\s]*host[\s]+10\\.0\\.0\\.2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - AAA - LDAP server is trusted"
  info        : "AAA - LDAP - ensure LDAP server is trusted - review configuration."
  solution    : "Configure the LDAP server settings via the web management portal"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SANS-CSC|19,SWIFT-CSCv1|2.3"
  context     : "user authentication"
  regex       : "^[\s]*method"
  expect      : "^[\s]*method[\s]+(ldap|ldap\+local)[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - GMS hostname/IP - Review"
  info        : "Review the Global Management System hostname/IP"
  solution    : "Navigate to system->administration->advanced management. Check off 'Enable management using GMS' and click on the 'configure' button to configure GMS settings."
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SANS-CSC|10,SWIFT-CSCv1|2.3"
  context     : "administration"
  context     : "[\s]*gms-management.*"
  regex       : "^[\s]*host-name[\s]*"
# Note: Variable @GMS_HOST@ replaced with "10\\.0\\.0\\.2" in field "expect".
  expect      : "^[\s]*host-name[\s]+10\\.0\\.0\\.2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - minimum length >= 8"
  info        : "Ensure that the administrator password length is at least 8. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, modify the value of 'Enforce a minimum password length of' to 8 or greater."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  context     : "administration"
  regex       : "^[\s]*password[\s]+minimum-length[\s]*"
  expect      : "^[\s]*password[\s]+minimum-length[\s]+([8-9]|[1-9][0-9]+)"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Complexity Level"
  info        : "Password Complexity Level - 1 alpha, 1 num, 1 symb. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Modify the 'Enforce password complexity' drop down value to 'require alphabetic, numeric and symbolic characters'."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  context     : "administration"
  regex       : "^[\s]*password[\s]*complexity[\s]*"
  expect      : "^[\s]*password[\s]+complexity[\s]+alpha-and-numeric-and-symbols[\s]+"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Affected User types"
  info        : "Password Complexity Level - applicable to admins, full admins, ltd admins. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Modify the 'Apply the above password constraints for' checkbox section to have 'Administrator','Other full administrators' and 'Limited administrators' checked off."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  context     : "administration"
  expect      : "^[\s]*password[\s]+constraints-apply-to[\s]+builtin-admin"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Affected User types - full-admins"
  info        : "Password Complexity Level - applicable to admins, full admins, ltd admins. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Modify the 'Apply the above password constraints for' checkbox section to have 'Administrator','Other full administrators' and 'Limited administrators' checked off."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  context     : "administration"
  expect      : "^[\s]*password[\s]*constraints-apply-to[\s]*full-admins"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Affected User types - limited-admins"
  info        : "Password Complexity Level - applicable to admins, full admins, ltd admins. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Modify the 'Apply the above password constraints for' checkbox section to have 'Administrator','Other full administrators' and 'Limited administrators' checked off."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  context     : "administration"
  expect      : "^[\s]*password[\s]*constraints-apply-to[\s]*limited-admins"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Password Uniqueness >= 10"
  info        : "Password Uniqueness - no repeating passwords for at least the last 10 changes. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, check the box for 'Bar repeated passwords for this many changes' and change the value to 10 or greater."
  reference   : "800-171|3.5.2,800-53|IA-5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SANS-CSC|12"
  context     : "administration"
  regex       : "^[\s]*password[\s]*uniqueness[\s]*count[\s]*"
  expect      : "^[\s]*password[\s]*uniqueness[\s]*count[\s]*[1-9][0-9][0-9]*"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - Change Period <=30 days"
  info        : "Password Change Period <=30 days. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, check the box for 'Password must be changed every (days)' and change the value to 30 or less."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SANS-CSC|12,TBA-FIISB|26.2.2"
  context     : "administration"
  regex       : "^[\s]*password[\s]*aging[\s]*duration[\s]*"
  expect      : "^[\s]*password[\s]+aging[\s]+duration[\s]+([1-9][\s]+$|[1-2][0-9][\s]+$|30[\s]*$)"
</custom_item>

<custom_item>
  description : "SonicWALL - Password Policy - User Lockout - Enabled"
  info        : "User Lockout Enabled after failed login attempts. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, modify the value of 'Enable administrator/user lockout' to be checked off."
  reference   : "800-171|3.1.8,800-53|AC-7,800-53|IA-2,800-53|IA-4,800-53|IA-5,800-53|IA-6,CIP|007-6-R5,CSF|PR.AC-4,HIPAA|164.308(a)(5)(ii)(D),ITSG-33|AC-7,PCI-DSSv3.1|8.1.6,PCI-DSSv3.2|8.1.6,SANS-CSC|12"
  context     : "administration"
  not_expect  : "^[\s]*no[\s]+user-lockout"
</custom_item>

<custom_item>
  description : "SonicWALL - PW Policy - Lockout - Num Attempts <=3"
  info        : "User Lockout Number of Attempts  - 3 or less. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, modify the value of 'Failed login attempts per minute before lockout' to 3 or less."
  reference   : "800-171|3.1.8,800-53|AC-7,CIP|007-6-R5,CN-L3|8.1.4.1(b),CSF|PR.AC-4,HIPAA|164.308(a)(5)(ii)(D),ITSG-33|AC-7,NIAv2|AM24,PCI-DSSv3.1|8.1.6,PCI-DSSv3.2|8.1.6,SANS-CSC|12,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  context     : "administration"
  regex       : "^[\s]*user-lockout[\s]+"
  expect      : "failures-per-minute[\s]+[1-3]"
</custom_item>

<custom_item>
  description : "SonicWALL - PW Policy - Lockout Duration - >= 5 minutes"
  info        : "User Lockout Duration >=5 minutes. Enforcing strong password policies reduces the chance that a password will be compromised."
  solution    : "Navigate to the system->administration section of the web interface. Under login security, modify the value of 'Lockout Period (minutes)' to 5 or greater."
  reference   : "800-171|3.1.8,800-53|AC-7,CIP|007-6-R5,CN-L3|8.1.4.1(b),CSF|PR.AC-4,HIPAA|164.308(a)(5)(ii)(D),ITSG-33|AC-7,NIAv2|AM24,PCI-DSSv3.1|8.1.6,PCI-DSSv3.2|8.1.6,SANS-CSC|12,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2"
  context     : "administration"
  regex       : "^[\s]*user-lockout[\s]+"
  expect      : "lockout-duration[\s]+([5-9]|[1-9][0-9][0-9]*)"
</custom_item>

<custom_item>
  description : "SonicWALL - Use non default admin access ports - HTTP"
  info        : "Defense in depth - Use non-default administrative access ports - HTTP"
  solution    : "Navigate to the system->administration section of the web interface. Under 'web management settings', modify the value of 'HTTP Port' to a non default (80) available value."
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SANS-CSC|11,SWIFT-CSCv1|2.3"
  context     : "administration"
  regex       : "^[\s]*web-management[\s]*http-port[\s]*"
  not_expect  : "^[\s]*web-management[\s]+http-port[\s]+80"
</custom_item>

<custom_item>
  description : "SonicWALL - Use non default admin access ports - HTTPS"
  info        : "Defense in depth - Use non-default administrative access ports - HTTPS"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SANS-CSC|11,SWIFT-CSCv1|2.3"
  solution    : "Navigate to the system->administration section of the web interface. Under 'web management settings', modify the value of 'HTTPS Port' to a non default (443) available value."
  context     : "administration"
  regex       : "^[\s]*web-management[\s]+https-port[\s]*"
  not_expect  : "^[\s]*web-management[\s]+https-port[\s]+443"
</custom_item>

<custom_item>
  description : "SonicWALL - AV License - Not Licensed"
  info        : "Ensuring licenses are valid and timely updates are applied helps to remediate vulnerabilities or technical issues in the appliance.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.4.1,800-53|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,PCI-DSS|5.2,SANS-CSC|5"
  cmd         : "show tech-support-report status"
  regex       : "Gateway[\s]Anti-Virus[\s]*:"
  expect      : "Manual Review"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SonicWALL - Syslog server - >=1 server configured"
  info        : "Synchronize log messages with an external log server to have a backup of log messages for analysis if the SonicWALL unit is compromised."
  solution    : "Navigate to the log->syslog section of the web interface and configure syslog settings."
  reference   : "800-171|3.3.8,800-53|AU-9,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,SANS-CSC|14"
  context     : "log syslog"
  regex       : "^[\s]*server[\s]+name[\s]*"
# Note: Variable @SYSLOG_SERVER@ replaced with "10\\.0\\.0\\.2" in field "expect".
  expect      : "^[\s]*server[\s]+name[\s]+10\\.0\\.0\\.2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Logging Level - Information"
  info        : "Record as many log messages as you can without affecting performance. More log messages means more visibility into what's happening with the system."
  solution    : "Navigate to the log->categories section of the web interface and configure the logging level dropdown to 'informational'."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SANS-CSC|14,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  context     : "log categories"
  regex       : "^[\s]*logging-level"
  expect      : "^[\s]*logging-level[\s]+(info|debug)"
</custom_item>

<custom_item>
  description : "SonicWALL - Log Alert Emails - Enabled"
  info        : "Log alert email provides an efficient and direct method of notifying an administrator of events."
  solution    : "The Log -> Automation page includes settings for configuring the SonicWALL to send log files using e-mail and configuring mail server settings. Input an appropriate email address in the 'Send Alerts to E-mail address' text box."
  reference   : "800-53|AU-5(2),CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ITSG-33|AU-5(2),NIAv2|GS7f,SANS-CSC|14"
  context     : "log automation"
  not_expect  : "^[\s]*no[\s]+alert-email-address"
</custom_item>

<custom_item>
  description : "SonicWALL - AutoUpdate - Enabled"
  info        : "Ensuring timely updates are applied helps to remediate vulnerabilities or technical issues in the appliance."
  solution    : "Navigate to the system->settings->Firmware Auto-update section of the web interface and check off the checkbox next to 'enable firmware auto-update'"
  reference   : "800-171|3.14.1,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,PCI-DSS|2.2.3,SANS-CSC|4,SWIFT-CSCv1|2.2"
  expect      : "firmware[\s]*auto-update[\s]*"
</custom_item>

<custom_item>
  description : "SonicWALL - AutoDownload Firmware - Enabled"
  info        : "Ensuring timely updates are applied helps to remediate vulnerabilities or technical issues in the appliance."
  solution    : "Navigate to the System->Settings->Firmware Auto-update section of the web interface and check off the checkbox next to 'Download new firmware automatically when available'."
  reference   : "800-171|3.14.1,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,PCI-DSS|2.2.3,SANS-CSC|4,SWIFT-CSCv1|2.2"
  expect      : "firmware[\s]*auto-update[\s]*auto-download"
</custom_item>

<custom_item>
  description : "SonicWALL - Web Interface - Does not use self-signed cert"
  info        : "The web interface does not use the system self-signed certificate. A certificate from a trusted CA allows for secure identification of the appliance to clients."
  solution    : "Navigate to system->certificates to import a certificate from a trusted CA."
  reference   : "800-53|SC-17,CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-17,NESA|T7.4.2,NIAv2|CY10,NIAv2|CY12,NIAv2|CY5a,NIAv2|SS25,PCI-DSS|4.1,SANS-CSC|17"
  context     : "administration"
  regex       : "^[\s]*web-management[\s]+certificate[\s]*"
  not_expect  : "^[\s]*web-management[\s]+certificate[\s]+use-self-signed"
</custom_item>

<custom_item>
  description : "SonicWALL - Disable insecure services - HTTP"
  info        : "HTTP is insecure by nature as it sends all traffic across the wire in clear text."
  solution    : "Navigate to network->interfaces. Configure each interface by unchecking the http management box."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-6,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,SANS-CSC|10,SANS-CSC|11"
  context     : "administration"
  not_expect  : "^[\s]*web-management[\s]+allow-http"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      description : "SonicWALL - SNMP is enabled"
      context     : "administration"
      not_expect  : "^[\s]*no[\s]+snmp[\s]*$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SonicWALL - SNMP Community Name - 'public' or 'private'"
      info        : "Ensure SNMP does not use an easy to guess or default community string - 'public' or 'private'"
      solution    : "Navigate to the system->administration->advanced management section. Click on the 'Enable SNMP' checkbox. Click on 'configure' and fill out the applicable configuration information."
      reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSS|2.2.3,SANS-CSC|11"
      context     : "administration"
      context     : "^[\s]*snmp"
      regex       : "^[\s]*get-community-name[\s]*"
      not_expect  : "^[\s]*get-community-name[\s]*([Pp][Uu][Bb][Ll][Ii][Cc]|[Pp][Rr][Ii][Vv][Aa][Tt][Ee])"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SonicWALL - SNMP Community Name - 'public' or 'private'"
      info        : "Ensure SNMP does not use an easy to guess or default community string - 'public' or 'private'"
      solution    : "Navigate to the system->administration->advanced management section. Click on the 'Enable SNMP' checkbox. Click on 'configure' and fill out the applicable configuration information."
      reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSS|2.2.3,SANS-CSC|11"
    </report>
  </else>
</if>

<custom_item>
  description : "SonicWALL - User Inactivity Timeout - 5 minutes or less"
  info        : "Users are logged out after 5 minutes of inactivity or less. Set a timeout to avoid the possibility of an administrator walking away from the management computer and leaving it exposed to unauthorized personnel."
  solution    : "Navigate to user->settings->user session settings and modify the value of 'Inactivity timeout (minutes)' to a value of 5 or less."
  reference   : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,CSF|DE.AE-1,CSF|PR.AC-1,HIPAA|164.312(a)(2)(iii),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NIAv2|AM23c,NIAv2|AM23d,PCI-DSS|2.2.3,SANS-CSC|16"
  context     : "user authentication"
  regex       : "^[\s]*inactivity-timeout"
  expect      : "^[\s]*inactivity-timeout[\s]+[1-5][\s]+$"
</custom_item>

<custom_item>
  description : "SonicWALL -  Ensure default 'admin' username is not used"
  info        : "Ensure the default admin username is not used. The default administrator account, admin, is a well known administrator name so if this account is available it could be easier for attackers to access the SonicWALL unit because they know they can log in with this name, only having to determine the password. You can improve security by changing this name to one more difficult for an attacker to guess."
  solution    : "Navigate to System->Administration->Administrator Name & Password and modify the Administrator name to a non-default value."
  reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.3.2(d),CSCv6|5.3,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSSv3.1|2.1,PCI-DSSv3.2|2.1,PCI-DSS|2.2.3,SANS-CSC|12"
  context     : "administration"
  regex       : "^[\s]*admin-name"
  not_expect  : "^[\s]*admin-name[\s]+([aA][dD][mM][iI][nN]|[rR][oO][oO][tT]|[mM][aA][nN][aA][gG][eE][rR]|[oO][pP][eE][rR][aA][tT][oO][rR])"
</custom_item>

<custom_item>
  description : "SonicWALL - Login Banner - Trusted Zone"
  info        : "Login Banners are a warning to intruders regarding prohibited activity and also can be used to communicate acceptable use policies to legitimate users. Banners assist in legal aspects of prosecuting intruders."
  solution    : "Navigate to users->settings->acceptable use policy. Check off the trust zone boxes in the 'Display on login from' section. Configure an appropriate acceptable use policy notification in the text field."
  reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSS|2.2.3,TBA-FIISB|45.2.4"
  context     : "user authentication"
  regex       : "[\s]*aup-on-zones[\s]+trusted"
  expect      : "^[\s]*aup-on-zones[\s]+trusted$"
</custom_item>

<custom_item>
  description : "SonicWALL - Login Banner - WAN Zone"
  info        : "Login Banners are a warning to intruders regarding prohibited activity and also can be used to communicate acceptable use policies to legitimate users. Banners assist in legal aspects of prosecuting intruders."
  solution    : "Navigate to users->settings->acceptable use policy. Check off the trust zone boxes in the 'Display on login from' section. Configure an appropriate acceptable use policy notification in the text field."
  reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSS|2.2.3,TBA-FIISB|45.2.4"
  context     : "user authentication"
  regex       : "[\s]*aup-on-zones[\s]+wan"
  expect      : "^[\s]*aup-on-zones[\s]+wan$"
</custom_item>

<custom_item>
  description : "SonicWALL - Login Banner - Public Zone"
  info        : "Login Banners are a warning to intruders regarding prohibited activity and also can be used to communicate acceptable use policies to legitimate users. Banners assist in legal aspects of prosecuting intruders."
  solution    : "Navigate to users->settings->acceptable use policy. Check off the trust zone boxes in the 'Display on login from' section. Configure an appropriate acceptable use policy notification in the text field."
  reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSS|2.2.3,TBA-FIISB|45.2.4"
  context     : "user authentication"
  regex       : "[\s]*aup-on-zones[\s]+public"
  expect      : "^[\s]*aup-on-zones[\s]+public$"
</custom_item>

<custom_item>
  description : "SonicWALL - Login Banner - Wireless Zone"
  info        : "Login Banners are a warning to intruders regarding prohibited activity and also can be used to communicate acceptable use policies to legitimate users. Banners assist in legal aspects of prosecuting intruders."
  solution    : "Navigate to users->settings->acceptable use policy. Check off the trust zone boxes in the 'Display on login from' section. Configure an appropriate acceptable use policy notification in the text field."
  reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSS|2.2.3,TBA-FIISB|45.2.4"
  context     : "user authentication"
  regex       : "[\s]*aup-on-zones[\s]+wireless"
  expect      : "^[\s]*aup-on-zones[\s]+wireless$"
</custom_item>

<custom_item>
  description : "SonicWALL - Login Banner - VPN Zone"
  info        : "Login Banners are a warning to intruders regarding prohibited activity and also can be used to communicate acceptable use policies to legitimate users. Banners assist in legal aspects of prosecuting intruders."
  solution    : "Navigate to users->settings->acceptable use policy. Check off the trust zone boxes in the 'Display on login from' section. Configure an appropriate acceptable use policy notification in the text field."
  reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSS|2.2.3,TBA-FIISB|45.2.4"
  context     : "user authentication"
  regex       : "[\s]*aup-on-zones[\s]+vpn"
  expect      : "^[\s]*aup-on-zones[\s]+vpn$"
</custom_item>

<custom_item>
  description : "SonicWALL - Unused Interfaces"
  info        : "Review and disable unused interfaces. Disabling unused interfaces reduces the attack surface of the device.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "If any of the interfaces on the SonicWALL unit are not being used, disable traffic on that interface. This avoids someone plugging in network cables and potentially causing network bypass or loop issues."
  reference   : "800-171|3.4.1,800-53|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,PCI-DSS|2.2.3,SANS-CSC|13"
  cmd         : "show interfaces"
  regex       : ".*"
  expect      : "Manual Review"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SonicWALL - Use non default admin access ports - 'SSH'"
  info        : "Defense in depth - Use non-default administrative access ports - SSH."
  solution    : "Navigate to system-administration->SSH Management Settings and change the 'SSH Port:' setting to an available, alternate port."
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SANS-CSC|11,SWIFT-CSCv1|2.3"
  context     : "administration"
  regex       : "ssh[\s]+port[\s]*"
  not_expect  : "ssh[\s]+port[\s]*22[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Detection Prevention - Stealth Mode"
  info        : "By default, the security appliance responds to incoming connection requests as either 'blocked' or 'open.' If you enable Stealth Mode, your security appliance does not respond to blocked inbound connection requests. Stealth Mode makes your security appliance essentially invisible to hackers."
  solution    : "Navigate to Firewall Settings->Advanced->Detection Prevention and check off 'Enable Stealth Mode'."
  reference   : "800-171|3.13.1,800-53|SC-7,CSF|PR.PT-4,ITSG-33|SC-7,SANS-CSC|10,SANS-CSC|19"
  context     : "firewall"
  not_expect  : "^[\s]*no[\s]+stealth-mode[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Detection Prevention - Randomize IP IDs"
  info        : "Select Randomize IP ID to prevent hackers using various detection tools from detecting the presence of a security appliance. IP packets are given random IP IDs, which makes it more difficult for hackers to 'fingerprint' the security appliance."
  solution    : "Navigate to Firewall Settings->Advanced->Detection Prevention and check off 'Randomize IP ID'."
  reference   : "800-171|3.13.1,800-53|SC-7,CSF|PR.PT-4,ITSG-33|SC-7,SANS-CSC|10,SANS-CSC|19"
  context     : "firewall"
  not_expect  : "^[\s]*no[\s]+randomize-id[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Detection Prevention - IP TTL Decrement"
  info        : "Time-to-live (TTL) is a value in an IP packet that tells a network router whether or not the packet has been in the network too long and should be discarded. Select this option to decrease the TTL value for packets that have been forwarded and therefore have already been in the network for some time."
  solution    : "Navigate to Firewall Settings->Advanced->Detection Prevention and check off 'Decrement IP TTL for forwarded traffic'."
  reference   : "800-171|3.13.9,800-53|SC-10,CSF|PR.PT-4,ITSG-33|SC-10,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,SANS-CSC|10,SANS-CSC|19,SWIFT-CSCv1|2.6"
  context     : "firewall"
  expect      : "^[\s]*decrement-ttl[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Detection Prevention - ICMP packets"
  info        : "SonicWALL - Detection Prevention - Never generate ICMP Time-Exceeded packets. The SonicWALL appliance generates Time-Exceeded packets to report when it has dropped a packet because its TTL value has decreased to zero. Select this option if you do not want the SonicWALL appliance to generate these reporting packets."
  solution    : "Navigate to Firewall Settings->Advanced->Detection Prevention and check off 'Never generate ICMP Time-Exceeded packets' and 'Decrement IP TTL for forwarded traffic'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,SANS-CSC|10,SANS-CSC|19,TBA-FIISB|43.1"
  context     : "firewall"
  expect      : "^[\s]*icmp-time-exceeded-packets[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - TCP - Enforce compliance"
  info        : "Enforce strict TCP compliance with RFC 793 and RFC 1122 - Select to ensure strict compliance with several TCP timeout rules. This setting maximizes TCP security, but it may cause problems with the Window Scaling feature for Windows Vista users."
  solution    : "Navigate to Firewall Settings->Flood Protection->TCP Settings and check off 'Enforce strict TCP compliance with RFC 793 and RFC 1122'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  expect      : "^[\s]*enforce-strict-compliance[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - TCP - Handshake enforcement"
  info        : "Require a successful three-way TCP handshake for all TCP connections."
  solution    : "Navigate to Firewall Settings->Flood Protection->TCP Settings and check off 'Enforce strict TCP compliance with RFC 793 and RFC 1122' and 'Enable TCP handshake enforcement'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  not_expect  : "^[\s]*no[\s]+handshake-enforcement[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - TCP - checksum enforcement"
  info        : "If an invalid TCP checksum is calculated, the packet will be dropped."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,SANS-CSC|10,SANS-CSC|19"
  solution    : "Navigate to Firewall Settings->Flood Protection->TCP Settings and check off 'Enable TCP checksum enforcement'."
  context     : "tcp"
  not_expect  : "^[\s]*no[\s]+checksum-enforcement[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - TCP - Timeout <= 5 minutes"
  info        : "The default time assigned to Access Rules for TCP traffic. If a TCP session is active for a period in excess of this setting, the TCP connection will be cleared by the SonicWALL. The default value is 5 minutes, the minimum value is 1 minute, and the maximum value is 999 minutes.

  Note: Setting excessively long connection time-outs will slow the reclamation of stale resources, and in extreme cases could lead to exhaustion of the connection cache."
  reference   : "800-171|3.13.9,800-53|SC-10,ITSG-33|SC-10,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,SANS-CSC|10,SANS-CSC|19,SWIFT-CSCv1|2.6"
  solution    : "Navigate to Firewall Settings->Flood Protection->TCP Settings and check off 'Default TCP Connection Timeout (minutes):'. Set it to a value of 5 or less."
  context     : "tcp"
  regex       : "^[\s]*default-connection-timeout[\s]*"
  expect      : "^[\s]*default-connection-timeout[\s]+[1-5][\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - TCP - Max Seg Lifetime"
  info        : "SonicWALL - Flood Protection - TCP - Maximum Segment Lifetime <= 8 seconds.

  Determines the number of seconds that any TCP packet is valid before it expires. This setting is also used to determine the amount of time (calculated as twice the Maximum Segment Lifetime, or 2MSL) that an actively closed TCP connection remains in the TIME_WAIT state to ensure that the proper FIN / ACK exchange has occurred to cleanly close the TCP connection."
  solution    : "Navigate to Firewall Settings->Flood Protection->TCP Settings and set 'Maximum Segment Lifetime (seconds):' to a value of 8 or less."
  reference   : "800-171|3.13.9,800-53|SC-10,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,SANS-CSC|10,SANS-CSC|19,SWIFT-CSCv1|2.6"
  context     : "tcp"
  regex       : "^[\s]*maximum-segment-lifetime[\s]*"
  expect      : "^[\s]*maximum-segment-lifetime[\s]+[1-8][\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - Layer 3 - Protection Mode"
  info        : "SonicWALL - Flood Protection - Layer 3 - SYN Flood Protection Mode.

  A SYN Flood Protection mode is the level of protection that you can select to defend against half-opened TCP sessions and high-frequency SYN packet transmissions.

  Proxy WAN Client Connections When Attack is Suspected - This option enables the device to enable the SYN Proxy feature on WAN interfaces when the number of incomplete connection attempts per second surpasses a specified threshold. This method ensures the device continues to process valid traffic during the attack and that performance does not degrade. Proxy mode remains enabled until all WAN SYN flood attacks stop occurring or until the device blacklists all of them using the SYN Blacklisting feature. This is the intermediate level of SYN Flood protection.

  Always Proxy WAN Client Connections - This option sets the device to always use SYN Proxy. This method blocks all spoofed SYN packets from passing through the device. Note that this is an extreme security measure and directs the device to respond to port scans on all TCP ports because the SYN Proxy feature forces the device to respond to all TCP SYN connection attempts. This can degrade performance and can generate a false positive. Select this option only if your network is in a high risk environment."
  solution    : "Navigate to Firewall Settings->Flood Protection->Layer 3 SYN Flood Protection - SYN Proxy and set 'SYN Flood Protection Mode' to a value of other than 'Watch and report possible syn floods'. 'Proxy WAN Client Connections When Attack is Suspected' - Medium Security or 'Always Proxy WAN Client Connections' - High Security, lower performance."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  regex       : "^[\s]*syn-flood-protection-mode[\s]*"
  not_expect  : "^[\s]*syn-flood-protection-mode[\s]+watch-and-report[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - Layer 3 - Attack Threshold"
  info        : "The SYN Attack Threshold configuration options provide limits for SYN Flood activity before the device drops packets. The device gathers statistics on WAN TCP connections, keeping track of the maximum and average maximum and incomplete WAN connections per second. Out of these statistics, the device suggests a value for the SYN flood threshold.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Navigate to Firewall Settings->Flood Protection->Layer 3 SYN Flood Protection - SYN Proxy and set 'SYN Attack Threshold' to a value that aligns with the statistics of your device 'Suggested value calculated from gathered statistics'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  regex       : "^[\s]*syn-attack-threshold[\s]*"
# Note: Variable @ATTACK_THRESHOLD@ replaced with "300" in field "expect".
  expect      : "^[\s]*syn-attack-threshold[\s]*300[\s]*$"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - Layer 2 - Threshold"
  info        : "Flood Protection - Layer 2 - Threshold for SYN/RST/FIN flood blacklisting (SYNs / Sec)<=1000.

  The SYN/RST/FIN Blacklisting feature is a list that contains devices that exceeded the SYN, RST, and FIN Blacklist attack threshold. The firewall device drops packets sent from blacklisted devices early in the packet evaluation process, enabling the firewall to handle greater amounts of these packets, providing a defense against attacks originating on local networks while also providing second-tier protection for WAN networks. Threshold for SYN/RST/FIN flood blacklisting (SYNs / Sec) - The maximum number of SYN, RST, and FIN packets allowed per second. The default is 1,000. This value should be larger than the SYN Proxy threshold value because blacklisting attempts to thwart more vigorous local attacks or severe attacks from a WAN network."
  solution    : "Navigate to Firewall Settings->Flood Protection->Layer 2 SYN/RST/FIN Flood Protection - MAC Blacklisting and set 'Threshold for SYN/RST/FIN flood blacklisting (Packets / Sec)' to a value of 1000 (default) or less."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  regex       : "^[\s]*blacklist-threshold[\s]*"
  expect      : "^[\s]*blacklist-threshold[\s]+([1-9]|[1-9][0-9]|[1-9][0-9][0-9]|1000)[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - Layer 2 - All Interfaces"
  info        : "The SYN/RST/FIN Blacklisting feature is a list that contains devices that exceeded the SYN, RST, and FIN Blacklist attack threshold. The firewall device drops packets sent from blacklisted devices early in the packet evaluation process, enabling the firewall to handle greater amounts of these packets, providing a defense against attacks originating on local networks while also providing second-tier protection for WAN networks."
  solution    : "Navigate to Firewall Settings->Flood Protection->Layer 2 SYN/RST/FIN Flood Protection - MAC Blacklisting and set 'Enable SYN/RST/FIN flood blacklisting on all interfaces' to true."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  expect      : "^[\s]*syn-flood-blacklisting[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Flood Protection - Layer 2 - WAN machines"
  info        : "This checkbox ensures that systems on the WAN are never added to the SYN Blacklist. This option is recommended as leaving it unchecked may interrupt traffic to and from the firewall's WAN ports."
  solution    : "Navigate to Firewall Settings->Flood Protection->Layer 2 SYN/RST/FIN Flood Protection - MAC Blacklisting and set 'Enable SYN/RST/FIN flood blacklisting on all interfaces' to true and 'Never blacklist WAN machines' to true."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,SANS-CSC|10,SANS-CSC|19"
  context     : "tcp"
  expect      : "^[\s]*never-blacklist-wan[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Enable SSL Control"
  info        : "Enable SSL Control - The global setting for SSL Control. This must be enabled for SSL Control applied to zones to be effective."
  solution    : "Navigate to Firewall Settings->SSL Control->General Settings and set 'Enable SSL Control' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,SANS-CSC|10"
  not_expect  : "^[\s]*no[\s]+ssl-control[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Block the conn. and log the event"
  info        : "In the event of a policy violation, the connection will be blocked and the event will be logged."
  solution    : "Navigate to Firewall Settings->SSL Control->Action and set 'If an SSL policy violation is detected' to 'Block the connection and log the event'."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SANS-CSC|10,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  context     : "ssl-control"
  expect      : "^[\s]*action[\s]+log[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Enable Blacklist"
  info        : "Controls detection of the entries in the blacklist. SSL Blacklisting allows the administrator to define strings for matching common names in SSL certificates."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Enable Blacklist' to true. Configure string matching details under 'Configure Blacklist and Whitelist'"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*blacklist[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Enable Whitelist"
  info        : "Controls detection of the entries in the whitelist. SSL Whitelisting allows the administrator to define strings for matching common names in SSL certificates."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Enable Whitelist' to true. Configure string matching details under 'Configure Blacklist and Whitelist'"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*whitelist[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Detect Expired Certificates"
  info        : "Controls detection of certificates whose start date is before the current system time, or whose end date is beyond the current system time. Date validation depends on the SonicWALL's System Time. Make sure your System Time is set correctly, preferably synchronized with NTP, on the System > Time page."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect Expired Certificates' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*detect-expired[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Detect SSLv2"
  info        : "Controls detection of SSLv2 exchanges. SSLv2 is known to be susceptible to cipher downgrade attacks because it does not perform integrity checking on the handshake. Best practices recommend using SSLv3 or TLS in its place."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect SSLv2' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*detect-sslv2[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Detect Self-signed certs"
  info        : "Controls the detection of certificates where both the issuer and the subject have the same common name."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect Self-Signed Certificates' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*detect-self-signed[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Certs - Untrusted CA"
  info        : "Controls the detection of certificates where the issuer's certificate is not in the SonicWALL's System > Certificates trusted store."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect Certificate signed by an Untrusted CA' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*untrusted-ca[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Detect Weak Ciphers (<64 bits)"
  info        : "Controls the detection of SSL sessions negotiated with symmetric ciphers less than 64 bits, commonly indicating export cipher usage."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect Weak Ciphers(<64bits)' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*detect-weak-ciphers[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control - Detect MD5 Digest"
  info        : "Controls the detection of certificates that were created using an MD5 Hash."
  solution    : "Navigate to Firewall Settings->SSL Control->Configuration and set 'Detect MD5 Digest' to true."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "ssl-control"
  expect      : "^[\s]*detect-md5-digest[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Settings - Max Security"
  info        : "This option specifies whether SonicWALL UTM security services are applied to maximize security or to maximize performance.

  Maximum Security (Recommended) - Inspect all content with any threat probability (high/medium/low). For additional performance capacity in this maximum security setting, utilize SonicOS UTM Clustering."
  solution    : "Navigate to Security Services->Summary. Set the dropdown for Security Services Settings->Security Service Setting to 'Maximum Security (Recommended)'"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  cmd         : "show tech-support-report intrusion-detection-prevention"
  regex       : "Security[\s]Services[\s]Settings[\s]+:"
  expect      : "Security[\s]Services[\s]Settings[\s]+:[\s]+Maximum[\s]Security"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Client AV - Enabled"
  info        : "By their nature, anti-virus products typically require regular, active maintenance on every PC. When a new virus is discovered, all anti-virus software deployed within an organization must be updated with the latest virus definition files. Users without the most current virus definition files allow these viruses to multiply and infect many other users and networks.

  SonicWALL Client Anti-Virus prevents occurrences like these and offers a new approach to virus protection. SonicWALL security appliance constantly monitors the version of the virus definition file and automatically triggers download and installation of new virus definition files to each user's computer."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  cmd         : "show tech-support-report anti-virus"
  regex       : "avEnable[\s]+:"
  not_expect  : "avEnable[\s]+:[\s]Disabled"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - Activated"
  info        : "SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  cmd         : "show tech-support-report status"
  regex       : "Gateway[\s]Anti-Virus[\s]+:"
  not_expect  : "Gateway[\s]Anti-Virus[\s]+:[\s]*Not Licensed"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - Enabled"
  info        : "SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS - Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. You must select Enable Gateway Anti-Virus check box in the Gateway Anti-Virus Global Settings section to enable SonicWALL GAV on your SonicWALL security appliance.You must specify the zones you want SonicWALL GAV protection on the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  regex       : "enable"
  expect      : "^[\s]*enable[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - SMTP Inbound"
  info        : "Gateway AV - SMTP Inbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'smtp' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+smtp[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - SMTP Outbound"
  info        : "Gateway AV - SMTP Outbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'smtp' in the 'enable outbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*outbound-inspection[\s]+smtp[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - HTTP Inbound"
  info        : "Gateway AV - HTTP Inbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'http' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+http[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - HTTP Outbound"
  info        : "Gateway AV - HTTP Outbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'http' in the 'enable outbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*outbound-inspection[\s]+http[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - POP3"
  info        : "Gateway AV - POP3. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses.Navigate to security services-> Gateway antivirus and check off 'POP3' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+pop3[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - IMAP"
  info        : "Gateway AV - IMAP. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'imap' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+imap[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - FTP Inbound"
  info        : "Gateway AV - FTP Inbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'ftp' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+ftp[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - FTP Outbound"
  info        : "Gateway AV - FTP Outbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'ftp' in the 'enable outbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*outbound-inspection[\s]+ftp[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - TCP Stream Inbound"
  info        : "Gateway AV - TCP Stream Inbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'tcp stream' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+tcp-stream[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - TCP Stream Outbound"
  info        : "Gateway AV - TCP Stream Outbound. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'tcp stream' in the 'enable outbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*outbound-inspection[\s]+tcp-stream[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - CIFS/Netbios"
  info        : "Gateway AV - CIFS/Netbios. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and check off 'CIFS/Netbios' in the 'enable inbound inspection' row."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|10,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "gateway-antivirus"
  expect      : "^[\s]*inbound-inspection[\s]+cifs-netbios[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - Gateway AV - Signature Timestamp"
  info        : "Gateway AV - Signature Timestamp. SonicWALL GAV delivers real-time virus protection directly on the SonicWALL security appliance by using SonicWALL's IPS-Deep Packet Inspection v2.0 engine to inspect all traffic that traverses the SonicWALL gateway.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Gateway antivirus and update the signature db."
  reference   : "800-171|3.3.7,800-53|AU-8,CN-L3|8.1.4.3(b),CSF|PR.PT-1,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|AU-8,NESA|T3.6.2,SANS-CSC|10,TBA-FIISB|37.4"
  cmd         : "show tech-support-report gateway-anti-virus"
  regex       : "Signature[\s]Database[\s]Timestamp[\s]+:"
  expect      : "Manual Review"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - IDP - Signature Timestamp"
  info        : "IDP - Signature Timestamp.

  SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses. Navigate to security services-> Intrusion Prevention and update the signature db."
  reference   : "800-171|3.3.7,800-53|AU-8,CN-L3|8.1.4.3(b),CSF|PR.PT-1,ITSG-33|AU-8,NESA|T3.6.2,SANS-CSC|10,TBA-FIISB|37.4"
  cmd         : "show tech-support-report intrusion-detection-prevention"
  regex       : "Signature[\s]Database[\s]Timestamp[\s]*:"
  expect      : "Manual Review"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - IDP - Activated"
  info        : "IDP - Activated. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  cmd         : "show tech-support-report intrusion-detection-prevention"
  regex       : "IPS[\s]Activation[\s]+:"
  expect      : "IPS[\s]Activation[\s]+:[\s]*Activated"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - IDP - Enabled"
  info        : "IDP - Enabled. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  context     : "intrusion-prevention"
  regex       : "enable"
  expect      : "^[\s]*enable[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Security Services - IDP - Signature DB Present"
  info        : "IDP - Signature DB Present. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "The System > Licenses page provides links to activate, upgrade, or renew SonicWALL Security Services licenses."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|10"
  cmd         : "show tech-support-report intrusion-detection-prevention"
  regex       : "Signature[\s]Database[\s]*:"
  expect      : "Signature[\s]Database[\s]*:[\s]*Downloaded"
</custom_item>

<custom_item>
  description : "SonicWALL - Content Filtering On - LAN"
  info        : "Content Filtering On - LAN. Internet Content Filtering equips the SonicWALL to monitor usage and control access to objectionable Web content according to established Acceptable Use Policies."
  solution    : "Enforce the Content Filtering Service per zone from the Network > Zones page."
  reference   : "800-171|3.1.3,800-53|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,SANS-CSC|5,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "zone[\s]+LAN"
  expect      : "^[\s]*content-filtering[\s]+policy[\s].+[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Client AV Enforcement On - LAN"
  info        : "Client AV Enforcement On - LAN. Client Anti-Virus provides continuous protection against viruses, Web attacks and E-Mail intrusions. By introducing alerts and managed reports, Client Anti-Virus increases administrators' awareness of viruses and malicious activity. Most importantly, Client Anti-Virus offloads the costly and time-consuming burden of maintaining and updating anti-virus software."
  solution    : "Enforce the Client AV Enforcement per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+LAN"
  regex       : "client[\s]+anti-virus"
  expect      : "^[\s]*client[\s]+anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - GAV ON - LAN"
  info        : "GAV ON - LAN. Gateway Anti-Virus provides continuous protection against viruses by integrating high performance Real-Time Virus Scanning Engine together with dynamically updated database of Anti-Virus signatures. By stopping viruses at the network perimeter, Gateway Anti-Virus increases administrator's awareness of malicious virus activity. Most importantly, Gateway Anti-Virus offloads the costly and time-consuming burden of protecting internal network from new virus attacks."
  solution    : "Enforce the Gateway AV per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+LAN"
  regex       : "gateway-anti-virus"
  expect      : "^[\s]*gateway-anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control ON - LAN"
  info        : "SSL Control ON - LAN. SSL Control is a system for providing visibility into the handshake of SSL sessions, and a method for constructing policies to control the establishment of SSL connections."
  solution    : "Enforce the SSL Control per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+LAN"
  regex       : "ssl-control"
  expect      : "^[\s]*ssl-control[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - IDP ON - LAN"
  info        : "IDP ON - LAN. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "Enforce Intrusion Prevention per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+LAN"
  regex       : "intrusion-prevention"
  expect      : "^[\s]*intrusion-prevention[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Anti-Spyware - LAN"
  info        : "SonicWALL Anti-Spyware is part of the SonicWALL Gateway Anti-Virus, Anti-Virus and Intrusion Prevention Service solution that provides comprehensive, real-time protection against viruses, worms, Trojans, spyware, and software vulnerabilities."
  solution    : "Enforce Anti-Spyware per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+LAN"
  regex       : "anti-spyware"
  expect      : "^[\s]*anti-spyware[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - GAV ON - WAN"
  info        : "GAV ON - WAN. Gateway Anti-Virus provides continuous protection against viruses by integrating high performance Real-Time Virus Scanning Engine together with dynamically updated database of Anti-Virus signatures. By stopping viruses at the network perimeter, Gateway Anti-Virus increases administrator's awareness of malicious virus activity. Most importantly, Gateway Anti-Virus offloads the costly and time-consuming burden of protecting internal network from new virus attacks."
  solution    : "Enforce the Gateway AV per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+WAN"
  regex       : "gateway-anti-virus"
  expect      : "^[\s]*gateway-anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control ON - WAN"
  info        : "SSL Control ON - WAN. SSL Control is a system for providing visibility into the handshake of SSL sessions, and a method for constructing policies to control the establishment of SSL connections."
  solution    : "Enforce the SSL Control per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+WAN"
  regex       : "ssl-control"
  expect      : "^[\s]*ssl-control[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - IDP ON - WAN"
  info        : "IDP ON - WAN. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "Enforce Intrusion Prevention per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+WAN"
  regex       : "intrusion-prevention"
  expect      : "^[\s]*intrusion-prevention[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Anti-Spyware - WAN"
  info        : "SonicWALL Anti-Spyware is part of the SonicWALL Gateway Anti-Virus, Anti-Virus and Intrusion Prevention Service solution that provides comprehensive, real-time protection against viruses, worms, Trojans, spyware, and software vulnerabilities."
  solution    : "Enforce Anti-Spyware per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+WAN"
  regex       : "anti-spyware"
  expect      : "^[\s]*anti-spyware[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Content Filtering On - DMZ"
  info        : "Content Filtering On - DMZ. Internet Content Filtering equips the SonicWALL to monitor usage and control access to objectionable Web content according to established Acceptable Use Policies."
  solution    : "Enforce the Content Filtering Service per zone from the Network > Zones page."
  reference   : "800-171|3.1.3,800-53|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,SANS-CSC|5,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "zone[\s]+DMZ"
  regex       : "content-filtering[\s]+policy"
  expect      : "^[\s]*content-filtering[\s]+policy[\s].+[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Client AV Enforcement On - DMZ"
  info        : "Client AV Enforcement On - DMZ. Client Anti-Virus provides continuous protection against viruses, Web attacks and E-Mail intrusions. By introducing alerts and managed reports, Client Anti-Virus increases administrators' awareness of viruses and malicious activity. Most importantly, Client Anti-Virus offloads the costly and time-consuming burden of maintaining and updating anti-virus software."
  solution    : "Enforce the Client AV Enforcement per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+DMZ"
  regex       : "client[\s]+anti-virus"
  expect      : "^[\s]*client[\s]+anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - GAV ON - DMZ"
  info        : "GAV ON - DMZ. Gateway Anti-Virus provides continuous protection against viruses by integrating high performance Real-Time Virus Scanning Engine together with dynamically updated database of Anti-Virus signatures. By stopping viruses at the network perimeter, Gateway Anti-Virus increases administrator's awareness of malicious virus activity. Most importantly, Gateway Anti-Virus offloads the costly and time-consuming burden of protecting internal network from new virus attacks."
  solution    : "Enforce the Gateway AV per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+DMZ"
  regex       : "gateway-anti-virus"
  expect      : "^[\s]*gateway-anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control ON - DMZ"
  info        : "SSL Control ON - DMZ. SSL Control is a system for providing visibility into the handshake of SSL sessions, and a method for constructing policies to control the establishment of SSL connections."
  solution    : "Enforce the SSL Control per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+DMZ"
  regex       : "ssl-control"
  expect      : "^[\s]*ssl-control[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - IDP ON - DMZ"
  info        : "IDP ON - DMZ. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "Enforce Intrusion Prevention per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+DMZ"
  regex       : "intrusion-prevention"
  expect      : "^[\s]*intrusion-prevention[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Anti-Spyware - DMZ"
  info        : "SonicWALL Anti-Spyware is part of the SonicWALL Gateway Anti-Virus, Anti-Virus and Intrusion Prevention Service solution that provides comprehensive, real-time protection against viruses, worms, Trojans, spyware, and software vulnerabilities."
  solution    : "Enforce Anti-Spyware per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+DMZ"
  regex       : "anti-spyware"
  expect      : "^[\s]*anti-spyware[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Content Filtering On - WLAN"
  info        : "Content Filtering On - WLAN. Internet Content Filtering equips the SonicWALL to monitor usage and control access to objectionable Web content according to established Acceptable Use Policies."
  solution    : "Enforce the Content Filtering Service per zone from the Network > Zones page."
  reference   : "800-171|3.1.3,800-53|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,SANS-CSC|5,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
  context     : "zone[\s]+WLAN"
  regex       : "content-filtering[\s]+policy"
  expect      : "^[\s]*content-filtering[\s]+policy[\s].+[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Client AV Enforcement On - WLAN"
  info        : "Client AV Enforcement On - WLAN. Client Anti-Virus provides continuous protection against viruses, Web attacks and E-Mail intrusions. By introducing alerts and managed reports, Client Anti-Virus increases administrators' awareness of viruses and malicious activity. Most importantly, Client Anti-Virus offloads the costly and time-consuming burden of maintaining and updating anti-virus software."
  solution    : "Enforce the Client AV Enforcement per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+WLAN"
  regex       : "client[\s]+anti-virus"
  expect      : "^[\s]*client[\s]+anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - GAV ON - WLAN"
  info        : "GAV ON - WLAN. Gateway Anti-Virus provides continuous protection against viruses by integrating high performance Real-Time Virus Scanning Engine together with dynamically updated database of Anti-Virus signatures. By stopping viruses at the network perimeter, Gateway Anti-Virus increases administrator's awareness of malicious virus activity. Most importantly, Gateway Anti-Virus offloads the costly and time-consuming burden of protecting internal network from new virus attacks."
  solution    : "Enforce the Gateway AV per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+WLAN"
  regex       : "gateway-anti-virus"
  expect      : "^[\s]*gateway-anti-virus[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - SSL Control ON - WLAN"
  info        : "SSL Control ON - WLAN. SSL Control is a system for providing visibility into the handshake of SSL sessions, and a method for constructing policies to control the establishment of SSL connections."
  solution    : "Enforce the SSL Control per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+WLAN"
  regex       : "ssl-control"
  expect      : "^[\s]*ssl-control[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - IDP ON - WLAN"
  info        : "IDP ON - WLAN. SonicWALL Intrusion Prevention Service (SonicWALL IPS) delivers a configurable, high performance Deep Packet Inspection engine for extended protection of key network services such as Web, e-mail, file transfer, Windows services and DNS. SonicWALL IPS is designed to protect against application vulnerabilities as well as worms, Trojans, and peer-to-peer, spyware and backdoor exploits."
  solution    : "Enforce Intrusion Prevention per zone from the Network > Zones page."
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,HIPAA|164.308(a)(5)(ii)(B),ITSG-33|SI-4,NESA|M1.2.2,SANS-CSC|5"
  context     : "zone[\s]+WLAN"
  regex       : "intrusion-prevention"
  expect      : "^[\s]*intrusion-prevention[\s]*$"
</custom_item>

<custom_item>
  description : "SonicWALL - Anti-Spyware - WLAN"
  info        : "SonicWALL Anti-Spyware is part of the SonicWALL Gateway Anti-Virus, Anti-Virus and Intrusion Prevention Service solution that provides comprehensive, real-time protection against viruses, worms, Trojans, spyware, and software vulnerabilities."
  solution    : "Enforce Anti-Spyware per zone from the Network > Zones page."
  reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,SANS-CSC|5,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
  context     : "zone[\s]+WLAN"
  regex       : "anti-spyware"
  expect      : "^[\s]*anti-spyware[\s]*$"
</custom_item>

</check_type>
