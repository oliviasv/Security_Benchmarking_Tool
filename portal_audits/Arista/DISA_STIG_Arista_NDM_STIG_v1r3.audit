#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2020/04/20 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Arista MLS DCS-7000 Series NDM v1r3 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Arista MLS DCS-7000 Series NDM v1r3</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Arista MLS DCS-7000 Series NDM</name>
#  <version>1.3.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip</link>
#</spec>
#<labels>arista,disa,eos,ndm</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>NTP_SERVER_1</name>
#    <default>192.168.1.10</default>
#    <description>NTP Server 1</description>
#    <info>The primary NTP server.</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_2</name>
#    <default>192.168.2.10</default>
#    <description>NTP Server 2</description>
#    <info>The secondary NTP server.</info>
#  </variable>
#  <variable>
#    <name>BANNER_LOGIN</name>
#    <default>You are accessing a U.S. Government \\(USG\\) Information System \\(IS\\) that is provided for USG-authorized use only\.</default>
#    <description>Banner login</description>
#    <info>The standard DoD-approved use notification and access banner.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Arista">

<custom_item>
  description : "AMLS-NM-000100 - The Arista Multilayer Switch must have a local infrequently used account to be used as an account of last resort with full access to the network device."
  info        : "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that needs to be tested before the password is compromised.

Typically, the account of last resort is a built-in account with full privileges to the network device. This account should only be used when the authentication mechanism is unreachable and configuration or maintenance actions must be taken."
  solution    : "Configure the Arista Multilayer Switch with a local infrequently used account to be used as an account of last resort with full access to the network device."
  reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|I,CCI|CCI-000366,CSF|PR.AC-4,Group-ID|V-60815,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-75271r1_rule,STIG-ID|AMLS-NM-000100,SWIFT-CSCv1|5.1,Vuln-ID|V-60815"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "username admin"
  expect      : "^[\s]*username admin .* role .+ secret (0|5|sha512) .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000110 - The Arista Multilayer Switch account of last resort must have a password with a length of 15 characters."
  info        : "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that needs to be tested before the password is compromised.

Typically, the account of last resort is a built-in account with full privileges to the network device. This account should only be used when the authentication mechanism is unreachable and configuration or maintenance actions must be taken."
  solution    : "Configure the Arista Multilayer Switch account of last resort with a password with a length of at least 15 characters.

To configure the password minimum length, enter the following commands:

configure
management security
password minimum length 15"
  reference   : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,Group-ID|V-60833,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-75289r1_rule,STIG-ID|AMLS-NM-000110,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-60833"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management security"
  regex       : "password minimum length"
  expect      : "^[\s]*password minimum length (1[5-9]|2[0-9]|3[1-2])"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      description : "Check for logging host"
      regex       : "logging host"
      expect      : "^[\s]*logging host .+"
    </custom_item>

    <custom_item>
      description : "Check for logging trap"
      cmd         : "show logging"
      regex       : "^[\s]*Trap logging:"
      expect      : "informational"
    </custom_item>

    <custom_item>
      description : "Check for aaa accounting logging"
      regex       : "aaa accounting commands all default start-stop logging"
      expect      : "^[\s]*aaa accounting commands all default start-stop logging .+"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "AMLS-NM-000120 - The Arista Multilayer Switch must automatically audit account creation."
      info        : "Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-000018,Group-ID|V-60835,Rule-ID|SV-75291r1_rule,STIG-ID|AMLS-NM-000120,Vuln-ID|V-60835"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000130 - The Arista Multilayer Switch must automatically audit account modification."
      info        : "Since the accounts in the network device are privileged or system-level accounts, account management is vital to the security of the network device. Account management by a designated authority ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel with the appropriate and necessary privileges. Auditing account modification along with an automatic notification to appropriate individuals will provide the necessary reconciliation that account management procedures are being followed. If modifications to management accounts are not audited, reconciliation of account management procedures cannot be tracked."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001403,Group-ID|V-60837,Rule-ID|SV-75293r1_rule,STIG-ID|AMLS-NM-000130,Vuln-ID|V-60837"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000140 - The Arista Multilayer Switch must automatically audit account disabling actions."
      info        : "Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account disabling actions will support account management procedures. When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001404,Group-ID|V-60839,Rule-ID|SV-75295r1_rule,STIG-ID|AMLS-NM-000140,Vuln-ID|V-60839"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000150 - The Arista Multilayer Switch must automatically audit account removal actions."
      info        : "Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001405,Group-ID|V-60841,Rule-ID|SV-75297r1_rule,STIG-ID|AMLS-NM-000150,Vuln-ID|V-60841"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000170 - The Arista Multilayer Switch must protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by non-repudiation."
      info        : "This requirement supports non-repudiation of actions taken by an administrator and is required in order to maintain the integrity of the configuration management process. All configuration changes to the network device are logged, and administrators authenticate with two-factor authentication before gaining administrative access. Together, these processes will ensure the administrators can be held accountable for the configuration changes they implement.

To meet this requirement, the network device must log administrator access and activity."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000166,Group-ID|V-60845,Rule-ID|SV-75301r1_rule,STIG-ID|AMLS-NM-000170,Vuln-ID|V-60845"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000180 - The Arista Multilayer Switch must generate audit records when successful/unsuccessful attempts to access privileges occur."
      info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000172,Group-ID|V-60847,Rule-ID|SV-75303r1_rule,STIG-ID|AMLS-NM-000180,Vuln-ID|V-60847"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000190 - The Arista Multilayer Switch must produce audit log records containing sufficient information to establish what type of event occurred."
      info        : "It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done in order to compile an accurate risk assessment. Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. Without this capability, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack."
      solution    : "Enable logging on the switch with sufficient detail to establish what type of event occurred.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational"
      reference   : "CAT|III,CCI|CCI-000130,Group-ID|V-60849,Rule-ID|SV-75305r1_rule,STIG-ID|AMLS-NM-000190,Vuln-ID|V-60849"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "AMLS-NM-000200 - The Arista Multilayer Switch must generate audit records containing the full-text recording of privileged commands."
      info        : "Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.

Organizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recordings of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000135,Group-ID|V-60851,Rule-ID|SV-75307r1_rule,STIG-ID|AMLS-NM-000200,Vuln-ID|V-60851"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"FAILED">
      description : "AMLS-NM-000120 - The Arista Multilayer Switch must automatically audit account creation."
      info        : "Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-000018,Group-ID|V-60835,Rule-ID|SV-75291r1_rule,STIG-ID|AMLS-NM-000120,Vuln-ID|V-60835"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000130 - The Arista Multilayer Switch must automatically audit account modification."
      info        : "Since the accounts in the network device are privileged or system-level accounts, account management is vital to the security of the network device. Account management by a designated authority ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel with the appropriate and necessary privileges. Auditing account modification along with an automatic notification to appropriate individuals will provide the necessary reconciliation that account management procedures are being followed. If modifications to management accounts are not audited, reconciliation of account management procedures cannot be tracked."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001403,Group-ID|V-60837,Rule-ID|SV-75293r1_rule,STIG-ID|AMLS-NM-000130,Vuln-ID|V-60837"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000140 - The Arista Multilayer Switch must automatically audit account disabling actions."
      info        : "Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account disabling actions will support account management procedures. When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001404,Group-ID|V-60839,Rule-ID|SV-75295r1_rule,STIG-ID|AMLS-NM-000140,Vuln-ID|V-60839"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000150 - The Arista Multilayer Switch must automatically audit account removal actions."
      info        : "Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|II,CCI|CCI-001405,Group-ID|V-60841,Rule-ID|SV-75297r1_rule,STIG-ID|AMLS-NM-000150,Vuln-ID|V-60841"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000170 - The Arista Multilayer Switch must protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by non-repudiation."
      info        : "This requirement supports non-repudiation of actions taken by an administrator and is required in order to maintain the integrity of the configuration management process. All configuration changes to the network device are logged, and administrators authenticate with two-factor authentication before gaining administrative access. Together, these processes will ensure the administrators can be held accountable for the configuration changes they implement.

To meet this requirement, the network device must log administrator access and activity."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000166,Group-ID|V-60845,Rule-ID|SV-75301r1_rule,STIG-ID|AMLS-NM-000170,Vuln-ID|V-60845"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000180 - The Arista Multilayer Switch must generate audit records when successful/unsuccessful attempts to access privileges occur."
      info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000172,Group-ID|V-60847,Rule-ID|SV-75303r1_rule,STIG-ID|AMLS-NM-000180,Vuln-ID|V-60847"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000190 - The Arista Multilayer Switch must produce audit log records containing sufficient information to establish what type of event occurred."
      info        : "It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done in order to compile an accurate risk assessment. Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. Without this capability, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack."
      solution    : "Enable logging on the switch with sufficient detail to establish what type of event occurred.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational"
      reference   : "CAT|III,CCI|CCI-000130,Group-ID|V-60849,Rule-ID|SV-75305r1_rule,STIG-ID|AMLS-NM-000190,Vuln-ID|V-60849"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "AMLS-NM-000200 - The Arista Multilayer Switch must generate audit records containing the full-text recording of privileged commands."
      info        : "Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.

Organizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recordings of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise."
      solution    : "Enable logging on the switch with sufficient detail to fulfill the specifications set forth in the VulDiscussion.

To configure logging to a remote syslog server at the informational level, enter:

switch#config
switch(config)#logging host [ip address]
switch(config)#logging trap informational

Then configure the following AAA:

aaa accounting commands all default start-stop logging [group radius]"
      reference   : "CAT|III,CCI|CCI-000135,Group-ID|V-60851,Rule-ID|SV-75307r1_rule,STIG-ID|AMLS-NM-000200,Vuln-ID|V-60851"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  description : "AMLS-NM-000160 - The Arista Multilayer Switch must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device."
  info        : "Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via logon interfaces with human users."
  solution    : "Configure the switch to display the Standard DoD Notice and Consent banner.

To configure the banner, enter the following commands from the configuration mode interface. Replace the bracketed data with the DoD Banner.

switch(config)#banner login
[DoD Banner]
EOF"
  reference   : "800-171|3.1.9,800-53|AC-8,CAT|II,CCI|CCI-000048,Group-ID|V-60843,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-75299r1_rule,STIG-ID|AMLS-NM-000160,TBA-FIISB|45.2.4,Vuln-ID|V-60843"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "banner login"
# Note: Variable @BANNER_LOGIN@ replaced with "You are accessing a U.S. Government \\\\(USG\\\\) Information System \\\\(IS\\\\) that is provided for USG-authorized use only\\." in field "expect".
  expect      : "^[\s]*banner login You are accessing a U.S. Government \\\\(USG\\\\) Information System \\\\(IS\\\\) that is provided for USG-authorized use only\\. EOF"
</custom_item>

<custom_item>
  description : "AMLS-NM-000210 - The Arista Multilayer Switch must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments."
  info        : "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.

Network devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.

To support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.

To configure an access control list, use the following commands:

configure
ip access-list [name]
10 deny [protocol] [src port] [src mask] [dst port] [dst mask] [options]
exit

To apply an access control list to an interface, use the following commands from the interface configuration mode:

ip access-group [name] [direction]"
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CCI|CCI-000382,CSF|PR.AC-5,CSF|PR.PT-4,Group-ID|V-60853,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,Rule-ID|SV-75309r1_rule,STIG-ID|AMLS-NM-000210,Vuln-ID|V-60853"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show ip access-lists"
  regex       : ""
  expect      : "ip access-lists command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000220 - The Arista Multilayer Switch must use multifactor authentication for local access to privileged accounts."
  info        : "Multifactor authentication is defined as: using two or more factors to achieve authentication.

Factors include:
(i) Something a user knows (e.g., password/PIN);
(ii) Something a user has (e.g., cryptographic identification device, token); or
(iii) Something a user is (e.g., biometric).

To assure accountability and prevent unauthenticated access, privileged users must utilize multifactor authentication to prevent potential misuse and compromise of the system.

Local access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.

Applications integrating with the DoD Active Directory and utilizing the DoD CAC are examples of compliant multifactor authentication solutions."
  solution    : "Configure the network device or its associated authentication server to use multifactor authentication for local access to privileged accounts.

To configure the local device to authenticate via its authentication server, enter the following command from the configuration mode interface. Replace the bracketed value with the configured server group name or the name of the server type to validate against all configured servers of that type.

switch(config)#aaa authentication login console group [radius] local"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CCI|CCI-000767,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60855,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75311r1_rule,STIG-ID|AMLS-NM-000220,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60855"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication login"
  expect      : "^[\s]*aaa authentication login console group .+ local"
</custom_item>

<custom_item>
  description : "AMLS-NM-000240 - The Arista Multilayer Switch must terminate all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill documented and validated mission requirements."
  info        : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.

Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session."
  solution    : "Configure the network device to terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity.

Arista switches have a configurable timeout function that automatically closes connections to the switch upon reaching an organization-defined period of time.

Configuration Example:

switch(config)#management ssh
switch(config-mgmt-ssh)#idle-timeout 10

Configure the switch to terminate an idle ssh connection after 10 minutes of inactivity."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),Group-ID|V-60857,ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-75315r1_rule,STIG-ID|AMLS-NM-000240,Vuln-ID|V-60857"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management ssh"
  regex       : "idle-timeout"
  expect      : "^[\s]*idle-timeout ([1-9]|10)"
</custom_item>

<custom_item>
  description : "AMLS-NM-000250 - The Arista Multilayer Switch must reveal error messages only to authorized individuals (ISSO, ISSM, and SA) - ISSO, ISSM, and SA."
  info        : "Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state. Additionally, sensitive account information must not be revealed through error messages to unauthorized personnel or their designated representatives.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device or its associated audit server to reveal error messages only to authorized individuals.

SNMP is used to fulfill this function. An example SNMP configuration is provided below. To configure SNMP according to site-specific policies and procedures, refer to the Arista Configuration Guide Chapter 37

snmp-server engineID local
snmp-server view snmpview system included
snmp-server group ROgroup v3 priv read snmpview
snmp-server group RWgroup v3 priv write snmpview
snmp-server user disa ROgroup v3
snmp-server user disaRW RWgroup v3
snmp-server host 10.1.1.1 version 3 priv disaRW
snmp-server host 10.2.2.2 version 3 noauth disaRW
snmp-server host 10.3.3.3 version 3 noauth disaRW
snmp-server host 127.0.0.1 version 3 noauth auth
snmp-server host 172.22.29.82 version 3 noauth disaRW
snmp-server enable traps"
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001314,Group-ID|V-60859,ITSG-33|SI-11,Rule-ID|SV-75317r1_rule,STIG-ID|AMLS-NM-000250,Vuln-ID|V-60859"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show snmp"
  regex       : ""
  expect      : "snmp command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000260 - The Arista Multilayer Switch must activate a system alert message, send an alarm, and/or automatically shut down when a component failure is detected."
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur that could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message, send an alarm, or shut down.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to activate a system alert message, send an alarm, and/or automatically shut down when a component failure is detected.

SNMP is used to fulfill this function. An example SNMP configuration is provided below. To configure SNMP according to site-specific policies and procedures, refer to the Arista Configuration Guide, Chapter 37.

snmp-server engineID local
snmp-server view snmpview system included
snmp-server group ROgroup v3 priv read snmpview
snmp-server group RWgroup v3 priv write snmpview
snmp-server user disa ROgroup v3
snmp-server user disaRW RWgroup v3
snmp-server host 10.1.1.1 version 3 priv disaRW
snmp-server host 10.2.2.2 version 3 noauth disaRW
snmp-server host 10.3.3.3 version 3 noauth disaRW
snmp-server host 127.0.0.1 version 3 noauth auth
snmp-server host 172.22.29.82 version 3 noauth disaRW
snmp-server enable traps"
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-000366,CCI|CCI-001328,Group-ID|V-60861,ITSG-33|SI-11,Rule-ID|SV-75319r1_rule,STIG-ID|AMLS-NM-000260,Vuln-ID|V-60861"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show snmp"
  regex       : ""
  expect      : "snmp command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000270 - The Arista Multilayer Switch must synchronize internal information system clocks to the authoritative time source when the time difference is greater than the organization-defined time period."
  info        : "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events.

Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. Organizations should consider setting time periods for different types of systems (e.g., financial, legal, or mission-critical systems). Organizations should also consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints). This requirement is related to the comparison done every 24 hours in CCI-001891 because a comparison must be done in order to determine the time difference.

The organization-defined time period will depend on multiple factors, most notably the granularity of time stamps in audit logs. For example, if time stamps only show to the nearest second, there is no need to have accuracy of a tenth of a second in clocks."
  solution    : "Configure the network device to synchronize internal information system clocks to the authoritative time source when the time difference is greater than the organization-defined time period.

Configuration Example:
switch(config)#ntp server HOST
switch(config)#ntp server HOST prefer"
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CCI|CCI-002046,CSF|PR.PT-1,Group-ID|V-60863,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-75321r1_rule,STIG-ID|AMLS-NM-000270,Vuln-ID|V-60863"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
# Note: Variable @NTP_SERVER_1@ replaced with "192.168.1.10" in field "regex".
  regex       : "ntp server 192.168.1.10"
# Note: Variable @NTP_SERVER_1@ replaced with "192.168.1.10" in field "expect".
  expect      : "^[\s]*ntp server 192.168.1.10 (prefer)?"
</custom_item>

<custom_item>
  description : "AMLS-NM-000280 - The Arista Multilayer Switch must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources - NTP Server 1"
  info        : "The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.

Multiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.

DoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source."
  solution    : "Configure the network device to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources.

Configuration Example:

switch(config)#ntp server HOST
switch(config)#ntp server HOST prefer"
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CCI|CCI-000366,CCI|CCI-001893,CSF|PR.PT-1,Group-ID|V-60865,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-75323r1_rule,STIG-ID|AMLS-NM-000280,Vuln-ID|V-60865"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
# Note: Variable @NTP_SERVER_1@ replaced with "192.168.1.10" in field "regex".
  regex       : "ntp server 192.168.1.10"
# Note: Variable @NTP_SERVER_1@ replaced with "192.168.1.10" in field "expect".
  expect      : "^[\s]*ntp server 192.168.1.10 (prefer)?"
</custom_item>

<custom_item>
  description : "AMLS-NM-000280 - The Arista Multilayer Switch must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources - NTP Server 2"
  info        : "The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.

Multiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.

DoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source."
  solution    : "Configure the network device to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources.

Configuration Example:

switch(config)#ntp server HOST
switch(config)#ntp server HOST prefer"
  reference   : "800-53|AU-8(2),CAT|II,CCI|CCI-000366,CCI|CCI-001893,CSF|PR.PT-1,Group-ID|V-60865,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,Rule-ID|SV-75323r1_rule,STIG-ID|AMLS-NM-000280,Vuln-ID|V-60865"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
# Note: Variable @NTP_SERVER_2@ replaced with "192.168.2.10" in field "regex".
  regex       : "ntp server 192.168.2.10"
# Note: Variable @NTP_SERVER_2@ replaced with "192.168.2.10" in field "expect".
  expect      : "^[\s]*ntp server 192.168.2.10 (prefer)?"
</custom_item>

<custom_item>
  description : "AMLS-NM-000290 - The Arista Multilayer Switch must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT)."
  info        : "If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC."
  solution    : "Configure the network device to record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).

This can be configured with the following command:

clock timezone GMT"
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001890,CN-L3|8.1.10.6(d),CSF|PR.IP-1,Group-ID|V-60867,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-75325r1_rule,STIG-ID|AMLS-NM-000290,SWIFT-CSCv1|2.3,Vuln-ID|V-60867"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "clock timezone GMT"
  expect      : "^[\s]*clock timezone GMT"
</custom_item>

<custom_item>
  description : "AMLS-NM-000340 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the integrity of nonlocal maintenance and diagnostic communications - telnet"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002890,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,Group-ID|V-60869,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-75327r1_rule,STIG-ID|AMLS-NM-000340,SWIFT-CSCv1|2.3,Vuln-ID|V-60869"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management telnet"
  expect      : "shutdown"
</custom_item>

<custom_item>
  description : "AMLS-NM-000340 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the integrity of nonlocal maintenance and diagnostic communications - api http"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002890,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,Group-ID|V-60869,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-75327r1_rule,STIG-ID|AMLS-NM-000340,SWIFT-CSCv1|2.3,Vuln-ID|V-60869"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management api http-commands"
  not_expect  : "protocol http"
</custom_item>

<custom_item>
  description : "AMLS-NM-000340 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the integrity of nonlocal maintenance and diagnostic communications - api https"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-002890,CSF|PR.DS-5,Group-ID|V-60869,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-75327r1_rule,STIG-ID|AMLS-NM-000340,Vuln-ID|V-60869"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management api http-commands"
  expect      : "protocol https"
</custom_item>

<custom_item>
  description : "AMLS-NM-000350 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the confidentiality of nonlocal maintenance and diagnostic communications - telnet"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-003123,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,Group-ID|V-60871,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-75329r1_rule,STIG-ID|AMLS-NM-000350,SWIFT-CSCv1|2.3,Vuln-ID|V-60871"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management telnet"
  expect      : "shutdown"
</custom_item>

<custom_item>
  description : "AMLS-NM-000350 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the confidentiality of nonlocal maintenance and diagnostic communications - api http"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-003123,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,Group-ID|V-60871,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-75329r1_rule,STIG-ID|AMLS-NM-000350,SWIFT-CSCv1|2.3,Vuln-ID|V-60871"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management api http-commands"
  not_expect  : "protocol http"
</custom_item>

<custom_item>
  description : "AMLS-NM-000350 - Arista Multilayer Switches used for nonlocal maintenance sessions must implement cryptographic mechanisms to protect the confidentiality of nonlocal maintenance and diagnostic communications - api https"
  info        : "This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP."
  solution    : "Configure the network device to use secure protocols instead of their unsecured counterparts.

Configuration Example:

Disable unsecure protocols.
configure
management telnet
shutdown
exit
management api http-commands
no protocol http
protocol https
exit

Other protocols (FTP) can be denied using AAA and RBAC. For connections that require use of these maintenance protocols, creation of SSH tunnels can fulfill this security requirement. This is summarized here and available at length in the Common Criteria guidance document.

Configuration Example:

management ssh
tunnel NEW
local port 514
ssh-server syslogServer user authuser port 22
remote host localhost port 514
no shutdown"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-003123,CSF|PR.DS-5,Group-ID|V-60871,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-75329r1_rule,STIG-ID|AMLS-NM-000350,Vuln-ID|V-60871"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management api http-commands"
  expect      : "protocol https"
</custom_item>

<custom_item>
  description : "AMLS-NM-000360 - The Arista Multilayer Switch must generate audit records for privileged activities or other system-level access - aaa commands"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records for privileged activities or other system-level access.

aaa accounting commands all default start-stop
aaa accounting exec default start-stop
aaa accounting system default start-stop"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60873,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75331r1_rule,STIG-ID|AMLS-NM-000360,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60873"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting commands all default start-stop"
  expect      : "^[\s]*aaa accounting commands all default start-stop.+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000360 - The Arista Multilayer Switch must generate audit records for privileged activities or other system-level access - aaa exec"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records for privileged activities or other system-level access.

aaa accounting commands all default start-stop
aaa accounting exec default start-stop
aaa accounting system default start-stop"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60873,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75331r1_rule,STIG-ID|AMLS-NM-000360,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60873"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting exec default start-stop"
  expect      : "^[\s]*aaa accounting exec default start-stop.+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000360 - The Arista Multilayer Switch must generate audit records for privileged activities or other system-level access - aaa system"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records for privileged activities or other system-level access.

aaa accounting commands all default start-stop
aaa accounting exec default start-stop
aaa accounting system default start-stop"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60873,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75331r1_rule,STIG-ID|AMLS-NM-000360,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60873"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting system default start-stop"
  expect      : "^[\s]*aaa accounting system default start-stop.+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000370 - The Arista Multilayer Switch must generate audit records showing starting and ending time for administrator access to the system - trap logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records showing starting and ending time for administrator access to the system.

Enable logging level 6 to ensure this event is captured.

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60875,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75333r1_rule,STIG-ID|AMLS-NM-000370,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60875"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : "Trap logging:"
  expect      : "informational"
</custom_item>

<custom_item>
  description : "AMLS-NM-000370 - The Arista Multilayer Switch must generate audit records showing starting and ending time for administrator access to the system - all logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to generate audit records showing starting and ending time for administrator access to the system.

Enable logging level 6 to ensure this event is captured.

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60875,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75333r1_rule,STIG-ID|AMLS-NM-000370,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60875"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : ""
  expect      : "show logging command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000380 - The Arista Multilayer Switch must generate audit records when concurrent logons from different workstations occur - trap logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records when concurrent logons from different workstations occur.

Enable logging level 6 to ensure this event is captured.

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60877,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75335r1_rule,STIG-ID|AMLS-NM-000380,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60877"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : "Trap logging:"
  expect      : "informational"
</custom_item>

<custom_item>
  description : "AMLS-NM-000380 - The Arista Multilayer Switch must generate audit records when concurrent logons from different workstations occur - show logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to generate audit records when concurrent logons from different workstations occur.

Enable logging level 6 to ensure this event is captured.

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60877,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75335r1_rule,STIG-ID|AMLS-NM-000380,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60877"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : ""
  expect      : "show logging command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000390 - The Arista Multilayer Switch must generate audit records for all account creations, modifications, disabling, and termination events - trap logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter)."
  solution    : "Configure the network device to generate audit records for all account creations, modifications, disabling, and termination events.

Enable logging level 6 to ensure this event is captured:

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60879,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75337r1_rule,STIG-ID|AMLS-NM-000390,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60879"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : "Trap logging:"
  expect      : "informational"
</custom_item>

<custom_item>
  description : "AMLS-NM-000390 - The Arista Multilayer Switch must generate audit records for all account creations, modifications, disabling, and termination events - show logging"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to generate audit records for all account creations, modifications, disabling, and termination events.

Enable logging level 6 to ensure this event is captured:

Switch(config)#logging trap 6
switch(config)#logging level all 6"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60879,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75337r1_rule,STIG-ID|AMLS-NM-000390,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60879"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : ""
  expect      : "show logging command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000400 - The Arista Multilayer Switch must, at a minimum, off-load audit records for interconnected systems in real time - trap logging"
  info        : "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.

Off-loading is a common process in information systems with limited audit storage capacity."
  solution    : "Configure the network device to off-load interconnected systems in real time and off-load standalone systems weekly.

Arista EOS logs can be exported to, including by a regular syslog server.

Configuration Example:

switch(config)#logging host[ a.b.c.d]
switch(config)#logging trap informational"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001851,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60881,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75339r1_rule,STIG-ID|AMLS-NM-000400,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60881"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : "Trap logging:"
  expect      : "informational"
</custom_item>

<custom_item>
  description : "AMLS-NM-000400 - The Arista Multilayer Switch must, at a minimum, off-load audit records for interconnected systems in real time - logging host"
  info        : "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.

Off-loading is a common process in information systems with limited audit storage capacity."
  solution    : "Configure the network device to off-load interconnected systems in real time and off-load standalone systems weekly.

Arista EOS logs can be exported to, including by a regular syslog server.

Configuration Example:

switch(config)#logging host[ a.b.c.d]
switch(config)#logging trap informational"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001851,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60881,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75339r1_rule,STIG-ID|AMLS-NM-000400,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60881"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "logging host"
  expect      : "^[\s]*logging host .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000420 - The Arista Multilayer Switch must protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions - trap logging"
  info        : "Auditing may not be reliable when performed by the network device to which the user being audited has privileged access. The privileged user may inhibit auditing or modify audit records. This control enhancement helps mitigate this risk by requiring that privileged access be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges. Reducing the risk of audit compromises by privileged users can also be achieved by performing audit activity on a separate information system or by using storage media that cannot be modified (e.g., write-once recording devices)."
  solution    : "Configure the system to protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions.

Enable remote logging with:

config
logging host a.b.c.d
logging trap informational

To assign a user to a role, use the command:

username [name] role [role name]

To deny access to logging functions via RBAC:

role [name]
deny command logging [all]"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60883,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75341r1_rule,STIG-ID|AMLS-NM-000420,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60883"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show logging"
  regex       : "Trap logging:"
  expect      : "informational"
</custom_item>

<custom_item>
  description : "AMLS-NM-000420 - The Arista Multilayer Switch must protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions - logging host"
  info        : "Auditing may not be reliable when performed by the network device to which the user being audited has privileged access. The privileged user may inhibit auditing or modify audit records. This control enhancement helps mitigate this risk by requiring that privileged access be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges. Reducing the risk of audit compromises by privileged users can also be achieved by performing audit activity on a separate information system or by using storage media that cannot be modified (e.g., write-once recording devices)."
  solution    : "Configure the system to protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions.

Enable remote logging with:

config
logging host a.b.c.d
logging trap informational

To assign a user to a role, use the command:

username [name] role [role name]

To deny access to logging functions via RBAC:

role [name]
deny command logging [all]"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60883,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75341r1_rule,STIG-ID|AMLS-NM-000420,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60883"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "logging host"
  expect      : "^[\s]*logging host .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000420 - The Arista Multilayer Switch must protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions - show user-account"
  info        : "Auditing may not be reliable when performed by the network device to which the user being audited has privileged access. The privileged user may inhibit auditing or modify audit records. This control enhancement helps mitigate this risk by requiring that privileged access be further defined between audit-related privileges and other privileges, thus limiting the users with audit-related privileges. Reducing the risk of audit compromises by privileged users can also be achieved by performing audit activity on a separate information system or by using storage media that cannot be modified (e.g., write-once recording devices).

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the system to protect the audit records of nonlocal accesses to privileged accounts and the execution of privileged functions.

Enable remote logging with:

config
logging host a.b.c.d
logging trap informational

To assign a user to a role, use the command:

username [name] role [role name]

To deny access to logging functions via RBAC:

role [name]
deny command logging [all]"
  reference   : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CAT|II,CCI|CCI-000366,CN-L3|8.1.4.3(d),CSF|PR.PT-1,Group-ID|V-60883,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-75341r1_rule,STIG-ID|AMLS-NM-000420,SWIFT-CSCv1|5.1,Vuln-ID|V-60883"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show user-account"
  regex       : ""
  expect      : "show user-account command information"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa group server"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa group server"
  expect      : "^[\s]*aaa group server (radius|tacacs\+) .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - radius/tacacs-server host"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "(radius|tacacs)-server"
  expect      : "^[\s]*(radius|tacacs)-server host .+ (vrf .+)? key 7 .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa login default group"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication login default group"
  expect      : "^[\s]*aaa authentication login default group .+ (local)?"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa login console group"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication login console group"
  expect      : "^[\s]*aaa authentication login console (group|.+) .+ (local)?"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa dot1x default group"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication dot1x"
  expect      : "^[\s]*aaa authentication dot1x default group .+"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa policy on-success"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60885,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication policy on-success log"
  expect      : "^[\s]*aaa authentication policy on-success log"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa policy on-failure"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60885,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authentication policy on-failure log"
  expect      : "^[\s]*aaa authentication policy on-failure log"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa console"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authorization console"
  expect      : "^[\s]*aaa authorization console"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa exec default"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authorization exec default"
  expect      : "^[\s]*aaa authorization exec default[\s]*(radius|tacacs)?[\s]*local"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa commands all default"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa authorization commands all default local"
  expect      : "^[\s]*aaa authorization commands all default local"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa exec default start-stop"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60885,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting exec default start-stop logging"
  expect      : "^[\s]*aaa accounting exec default start-stop logging"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa system default start-stop"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60885,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting system default start-stop logging"
  expect      : "^[\s]*aaa accounting system default start-stop logging"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - aaa commands all start-stop"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,Group-ID|V-60885,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "aaa accounting commands all default start-stop logging"
  expect      : "^[\s]*aaa accounting commands all default start-stop logging"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - no aaa root"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.1.6,800-53|AC-6(2),CAT|I,CCI|CCI-000366,CCI|CCI-000370,CSF|PR.AC-4,Group-ID|V-60885,ITSG-33|AC-6(2),NESA|T5.1.1,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  regex       : "no aaa root"
  expect      : "^[\s]*no aaa root"
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - show aaa sessions"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,Group-ID|V-60885,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show aaa sessions"
  regex       : ".*"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "AMLS-NM-000430 - The Arista Multilayer Switch must employ AAA service to centrally manage authentication settings - show roles"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure AAA services via a remote AAA server for all nonlocal accounts.

Configuration:
aaa group server [radius/tacacs] [name]
[radius/tacacs]-server host [IP Address] vrf [name] key [key]
aaa authentication login default group [group name] [radius/tacacs] [local]
aaa authentication login console [group] [group name/radius/tacacs+] [local]
aaa authentication dot1x default group [group] [radius]
aaa authentication policy on-success log
aaa authentication policy on-failure log
aaa authorization console
aaa authorization exec default [radius/tacacs] local
aaa authorization commands all default local
aaa accounting exec default start-stop logging
aaa accounting system default start-stop logging
aaa accounting commands all default start-stop logging
no aaa root

Example RBAC roles:

role administrator
 10 permit command .*

 role operator
 10 permit command show running-config [all|detail] sanitized
 20 deny command >|>>|extension|\||session|do|delete|copy|rmdir|mkdir|python-shell|bash|platform|scp|append|redirect|tee|more|less|who|show run.*
 25 deny command bash
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*
 30 deny mode config command (no |default ) (username|role|aaa|tcpdump|schedule|event.*)
 40 permit command .*"
  reference   : "800-171|3.1.1,800-53|AC-3(7),CAT|I,CCI|CCI-000366,CCI|CCI-000370,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,Group-ID|V-60885,ITSG-33|AC-6,NESA|T5.1.1,Rule-ID|SV-75343r2_rule,STIG-ID|AMLS-NM-000430,Vuln-ID|V-60885"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show role"
  regex       : ".*"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "AMLS-NM-000440 - The Arista Multilayer Switch must support organizational requirements to conduct backups of system-level information contained in the information system when changes occur or weekly, whichever is sooner."
  info        : "System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.

This control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the network device to conduct backups of system-level information contained in the information system when changes occur or weekly, whichever is sooner.

For weekly backups, the following chronologically scheduled command will back up the switch information one per day at noon:

switch(config)#schedule [name] at [hh:mm:ss] interval 1440 max-log-files 100 command bash FastCli -p 15 -c $'enable\nshow tech-support > scp:[remote destination/filename]\n'

The following event-handler will schedule backups any time the configuration is changed and written to memory:

event-handler Copy-Config
trigger on-startup-config
action bash sudo ip netns exec ns-DATA scp /mnt/flash/startup-config [user@IPaddress/filepath/filename]
delay 5"
  reference   : "CAT|III,CCI|CCI-000366,CCI|CCI-000537,Group-ID|V-60887,Rule-ID|SV-75345r1_rule,STIG-ID|AMLS-NM-000440,Vuln-ID|V-60887"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
</report>

<custom_item>
  description : "AMLS-NM-000500 - The Arista Multilayer Switch must be updated to one of the minimum approved versions of EOS."
  info        : "The Arista Multilayer Switch uses the EOS operating system. Updates to EOS contain new security-related features and security patches that address known vulnerabilities. Running a current DoD-approved software version improves the security posture of the network device."
  solution    : "Configure the Arista Multilayer Switch to use an approved software version. Download the approved version from www.arista.com/support, copy the .swi file to flash via an approved file transfer mechanism, and then enter:

Enable
Configure
Boot system flash:<your_image.swi>
Write memory
reload"
  reference   : "800-171|3.4.1,800-53|CM-8,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,Group-ID|V-67195,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,Rule-ID|SV-81685r1_rule,STIG-ID|AMLS-NM-000500,Vuln-ID|V-67195"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  cmd         : "show version"
  regex       : "Software image version:"
  expect      : "((4.14.1[1-9]|4.15.[3-9]|4.16.[0-9])(F|M))"
</custom_item>

<custom_item>
  description : "AMLS-NM-200825 - The Arista Multilayer Switch must use FIPS-compliant mechanisms for authentication to a cryptographic module - SSH FIPS"
  info        : "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.

Network devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.

FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements."
  solution    : "Enable FIPS restrictions via the following commands:
Enable
Configure
Management ssh
Fips restrictions
Exit

Additionally, the switch should be configured to use its Hardware Random Number Generator as a source of entropy for the SSH protocol. To enable this, configure:

Enable
Configure
Management security
Entropy source hardware

Once this has been changed, regenerate the SSH RSA Keys with:

Reset ssh hostkey rsa"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,Group-ID|V-67197,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-81687r1_rule,STIG-ID|AMLS-NM-200825,Vuln-ID|V-67197"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management ssh"
  regex       : "fips restrictions"
  expect      : "^[\s]*fips restrictions"
</custom_item>

<custom_item>
  description : "AMLS-NM-200825 - The Arista Multilayer Switch must use FIPS-compliant mechanisms for authentication to a cryptographic module - entropy source"
  info        : "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.

Network devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.

FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements."
  solution    : "Enable FIPS restrictions via the following commands:
Enable
Configure
Management ssh
Fips restrictions
Exit

Additionally, the switch should be configured to use its Hardware Random Number Generator as a source of entropy for the SSH protocol. To enable this, configure:

Enable
Configure
Management security
Entropy source hardware

Once this has been changed, regenerate the SSH RSA Keys with:

Reset ssh hostkey rsa"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,Group-ID|V-67197,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-81687r1_rule,STIG-ID|AMLS-NM-200825,Vuln-ID|V-67197"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Arista_MLS_DCS-7000_Series_STIG.zip"
  context     : "management security"
  regex       : "entropy source hardware"
  expect      : "^[\s]*entropy source hardware"
</custom_item>

</check_type>
