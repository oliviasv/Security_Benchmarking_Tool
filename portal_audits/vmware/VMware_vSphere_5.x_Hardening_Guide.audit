#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.27 $
# $Date: 2020/04/22 $
#
# Description	: This .audit is designed to the VM configurations from either a vCenter or vSphere server
# 			and validate their settings against the settings defined in the vSphere 5.0, 5.1 and 5.5 Security Hardening Guide
# 	  		http://vmware.com/go/securityguides
# 			http://communities.vmware.com/docs/DOC-19605
# 			http://communities.vmware.com/docs/DOC-22981
#                               https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx
#
# NOTE   		: Some queries in this .audit require site-specific data to be known to the query in order to function properly.
#     			Please note the following queries and edit their values accordingly.
#
# 			VM : verify-vmsafe-cpumem-agentaddress
# 			VM : verify-vmsafe-cpumem-agentport
# 			ESXi : config-ntp
# 			ESXi : config-persistent-logs
# 			ESXi : enable-remote-syslog
# 			ESXi : set-shell-interactive-timeout
# 			ESXi : set-shell-timeout
# 			vCenter : config-ntp
#
#<ui_metadata>
#<display_name>VMWare vSphere 5.X Hardening Guide</display_name>
#<spec>
#  <type>VMWare</type>
#  <name>vSphere 5.X Hardening Guide</name>
#  <version>1.0.0</version>
#  <link>https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx</link>
#</spec>
#<labels>vmware,vsphere,hardening</labels>
#<variables>
#  <variable>
#    <name>AGENT_ADDRESS</name>
#    <default>192\.168\.0\.1</default>
#    <description>VMSafe agent address</description>
#    <info>The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.</info>
#  </variable>
#  <variable>
#    <name>AGENT_PORT</name>
#    <default>10000</default>
#    <description>VMSafe agent port number</description>
#    <info>The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>0\.us\.pool\.ntp\.org</default>
#    <description>NTP server address</description>
#    <info>The name or IP address of the NTP server for your organization.</info>
#  </variable>
#  <variable>
#    <name>LOG_DIR</name>
#    <default>\\[\\] \/scratch\/log1</default>
#    <description>System log directory</description>
#    <info>The path to the system log directory.</info>
#  </variable>
#  <variable>
#    <name>LOG_HOST</name>
#    <default>192\.168\.0\.1</default>
#    <description>Remote syslog address</description>
#    <info>The IP address of the centralized syslog server for your organization.</info>
#  </variable>
#  <variable>
#    <name>SHELL_SESSION_TIMEOUT</name>
#    <default>(300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])</default>
#    <description>SSH session timeout</description>
#    <info>The number of minutes before an idle SSH session will be disconnected.</info>
#  </variable>
#  <variable>
#    <name>SHELL_TIMEOUT</name>
#    <default>(300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])</default>
#    <description>SSH service timeout</description>
#    <info>The number of minutes that can elapse before you must log in after the ESXi Shell is enabled. After the timeout period if you have not logged in the shell is disabled.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"VMware">

<report type:"PASSED">
  description : "VMWare vCenter and vSphere 5.x Hardening Guide"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# VM Checks

<report type:"WARNING">
  description : "VM : control-resource-usage"
  info        : "By default, all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi, such as shares and limits, you can control the server resources that a virtual machine consumes.  You can use this mechanism to prevent a denial of service that causes one virtual machine to consume so much of the host's resources that other virtual machines on the same host cannot perform their intended functions."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|control-resource-usage,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-autoinstall"
  info        : "Tools auto install can initiate an automatic reboot, disabling this option will prevent tools from being installed automatically and prevent automatic machine reboots."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,PCI-DSS|2.2.4,PCI-DSS|6.4.5,SWIFT-CSCv1|2.3,VMWare-ID|disable-autoinstall,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.autoInstall.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.autoInstall.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.autoInstall.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.autoInstall.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.autoInstall.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.autoInstall.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.autoInstall.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.autoInstall.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.autoInstall\.disable : "
  expect      : "isolation\.tools.autoInstall\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-console-copy"
  info        : "Copy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-console-copy,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.copy.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.copy.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.copy.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.copy.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.copy.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.copy.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.copy.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.copy.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.copy\.disable : "
  expect      : "isolation\.tools\.copy\.disable : (True|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-console-dnd"
  info        : "Copy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-console-dnd,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.dnd.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dnd.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.dnd.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dnd.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.dnd.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dnd.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.dnd.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.dnd.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.dnd\.disable : "
  expect      : "isolation\.tools\.dnd\.disable : (True|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-console-gui-options"
  info        : "Copy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-console-gui-options,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.setGUIOptions.enable to false in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.setGUIOptions.enable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.setGUIOptions.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.setGUIOptions.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.setGUIOptions.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.setGUIOptions.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.setGUIOptions.enable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.setGUIOptions.enable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.setGUIOptions\.enable : "
  expect      : "isolation\.tools\.setGUIOptions\.enable : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-console-paste"
  info        : "Copy and paste operations are disabled by default however by explicitly disabling this feature it will enable audit controls to check that this setting is correct."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-console-paste,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.paste.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.paste.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.paste.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.paste.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.paste.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.paste.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.paste.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.paste.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.paste\.disable : "
  expect      : "isolation\.tools\.paste\.disable : (True|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-disk-shrinking-shrink"
  info        : "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes-that is, users and processes without root or administrator privileges-within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature by setting the parameters listed in Table 9. Repeated disk shrinking can make a virtual disk unavailable. Capability is available to nonadministrative users in the guest."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-disk-shrinking-shrink,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.diskShrink.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskShrink.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.diskShrink.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskShrink.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.diskShrink.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskShrink.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.diskShrink.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.diskShrink.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.diskShrink\.disable : "
  expect      : "isolation\.tools\.diskShrink\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-disk-shrinking-wiper"
  info        : "Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk, this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes-that is, users and processes without root or administrator privileges-within virtual machines have the capability to invoke this procedure. However, if this is done repeatedly, the virtual disk can become unavailable while this shrinking is being performed, effectively causing a denial of service. In most datacenter environments, disk shrinking is not done, so you should disable this feature by setting the parameters listed in Table 9. Repeated disk shrinking can make a virtual disk unavailable. Capability is available to nonadministrative users in the guest."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-disk-shrinking-wiper,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.diskWiper.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskWiper.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.diskWiper.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskWiper.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.diskWiper.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.diskWiper.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.diskWiper.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.diskWiper.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.diskWiper\.disable : "
  expect      : "isolation\.tools\.diskWiper\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-hgfs"
  info        : "Certain automated operations such as automated tools upgrades use a component into the hypervisor called 'Host Guest File System' and an attacker could potentially use this to transfer files inside the guest OS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,PCI-DSS|2.2.3,SWIFT-CSCv1|2.3,VMWare-ID|disable-hgfs,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.hgfsServerSet.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.hgfsServerSet.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.hgfsServerSet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.hgfsServerSet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.hgfsServerSet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.hgfsServerSet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.hgfsServerSet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.hgfsServerSet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.hgfsServerSet\.disable : "
  expect      : "isolation\.tools\.hgfsServerSet\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-independent-nonpersistent"
  info        : "The security issue with nonpersistent disk mode is that successful attackers, with a simple shutdown or reboot, might undo or remove any traces that they were ever on the machine. To safeguard against this risk, you should set production virtual machines to use either persistent disk mode or nonpersistent disk mode; additionally, make sure that activity within the VM is logged remotely on a separate server, such as a syslog server or equivalent Windows-based event collector. Without a persistent record of activity on a VM, administrators might never know whether they have been attacked or hacked."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.3,SWIFT-CSCv1|2.3,VMWare-ID|disable-independent-nonpersistent,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set scsiX:Y.mode to a value other than 'independent nonpersistent' in the virtual machine configuration file or remove the scsi disk from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'scsi') and contains (audit:key,'.mode')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'scsi') and contains (audit:key,'.mode')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - scsiX:Y.mode : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - scsiX:Y.mode : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "scsi([Xx]|[0-9]+):([Yy]|[0-9]+)\.mode :"
  not_expect  : "scsi([Xx]|[0-9]+):([Yy]|[0-9]+)\.mode : NOT found$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-intervm-vmci"
  info        : "If the interface is not restricted, a VM can detect and be detected by all other VMs with the same option enabled within the same host. This might be the intended behavior, but custom-built software can have unexpected vulnerabilities that might potentially lead to an exploit. Additionally, it is possible for a VM to detect how many other VMs are within the same ESXI system by simply registering the VM. This information might also be used for a potentially malicious objective. By default, the setting is FALSE. The VM can be exposed to other VMs within the same system as long as there is at least one program connected to the VMCI socket interface. THIS CONTROL HAS NO EFFECT IN 5.1. WHETHER SET TO ENABLED OR DISABLED, THE COMMUNICATION IS DISABLED."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(21),CSF|PR.AC-5,CSF|PR.DS-5,NESA|T4.5.3,NIAv2|VL6,PCI-DSS|1.1.1,PCI-DSS|2.2.2,PCI-DSS|2.2.3,VMWare-ID|disable-intervm-vmci,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set vmci0.unrestricted to FALSE in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualMachineVMCIDevice']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmci0.unrestricted : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualMachineVMCIDevice']/audit:allowUnrestrictedCommunication\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmci0.unrestricted : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualMachineVMCIDevice']/audit:allowUnrestrictedCommunication\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmci0.unrestricted : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmci0.unrestricted : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vmci0\.unrestricted : "
  expect      : "vmci0\.unrestricted : False$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-logging"
  info        : "You can use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,VMWare-ID|disable-logging,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set logging to false in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='logging']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - logging : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='logging']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - logging : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='logging']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - logging : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - logging : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "logging : "
  expect      : "logging : False$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-monitor-control"
  info        : "When Virtual Machines are running on a hypervisor they are 'aware' that they are running in a virtual environment and this and this information is available to tools inside the guest OS.  This can give attackers information about the platform that they are running on that they may not get from a normal physical server.  This option completely disables all hooks for a virtual machine and the guest OS will not be aware that it is running in a virtual environment at all."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,VMWare-ID|disable-monitor-control,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.monitor.control.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.monitor.control.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.monitor.control.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.monitor.control.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.monitor.control.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.monitor.control.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.monitor.control.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.monitor.control.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.monitor\.control\.disable : "
  expect      : "isolation\.monitor\.control\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-autologon"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-53|AC-14,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|AC-14,NESA|T5.6.1,PCI-DSS|2.2.4,VMWare-ID|disable-unexposed-features-autologon,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.ghi.autologon.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.autologon.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.autologon.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.autologon.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.autologon.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.autologon.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.autologon.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.autologon.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.ghi\.autologon\.disable : "
  expect      : "isolation\.tools\.ghi\.autologon\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-biosbbs"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-biosbbs,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.bios.bbs.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.bios.bbs.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.bios.bbs.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.bios.bbs.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.bios.bbs.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.bios.bbs.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.bios.bbs.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.bios.bbs.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.bios\.bbs\.disable : "
  expect      : "isolation\.bios\.bbs\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-getcreds"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-getcreds,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.getCreds.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.getCreds.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.getCreds.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.getCreds.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.getCreds.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.getCreds.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.getCreds.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.getCreds.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.getCreds\.disable : "
  expect      : "isolation\.tools\.getCreds\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-launchmenu"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-launchmenu,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.ghi.launchmenu.change to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.launchmenu.change']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.launchmenu.change : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.launchmenu.change']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.launchmenu.change : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.launchmenu.change']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.launchmenu.change : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.launchmenu.change : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.ghi\.launchmenu\.change : "
  expect      : "isolation\.tools\.ghi\.launchmenu\.change : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-memsfss"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-memsfss,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.memSchedFakeSampleStats.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.memSchedFakeSampleStats.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.memSchedFakeSampleStats.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.memSchedFakeSampleStats.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.memSchedFakeSampleStats.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.memSchedFakeSampleStats.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.memSchedFakeSampleStats.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.memSchedFakeSampleStats.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.memSchedFakeSampleStats\.disable : "
  expect      : "isolation\.tools\.memSchedFakeSampleStats\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-protocolhandler"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-protocolhandler,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.ghi.protocolhandler.info.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.protocolhandler.info.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.protocolhandler.info.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.protocolhandler.info.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.protocolhandler.info.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.protocolhandler.info.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.protocolhandler.info.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.protocolhandler.info.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.ghi\.protocolhandler\.info\.disable : "
  expect      : "isolation\.tools\.ghi\.protocolhandler\.info\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-shellaction"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-shellaction,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.ghi.host.shellAction.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.ghi.host.shellAction.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.ghi.host.shellAction.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.ghi.host.shellAction.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.ghi.host.shellAction.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.ghi.host.shellAction.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.ghi.host.shellAction.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.ghi.host.shellAction.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.ghi\.host\.shellAction\.disable : "
  expect      : "isolation\.ghi\.host\.shellAction\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-toporequest"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-toporequest,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.dispTopoRequest.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dispTopoRequest.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.dispTopoRequest.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dispTopoRequest.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.dispTopoRequest.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.dispTopoRequest.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.dispTopoRequest.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.dispTopoRequest.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.dispTopoRequest\.disable : "
  expect      : "isolation\.tools\.dispTopoRequest\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-trashfolderstate"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-trashfolderstate,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.trashFolderState.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.trashFolderState.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.trashFolderState.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.trashFolderState.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.trashFolderState.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.trashFolderState.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.trashFolderState.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.trashFolderState.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.trashFolderState\.disable : "
  expect      : "isolation\.tools\.trashFolderState\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-trayicon"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-trayicon,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.ghi.trayicon.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.trayicon.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.trayicon.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.trayicon.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.trayicon.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.ghi.trayicon.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.ghi.trayicon.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.ghi.trayicon.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.ghi\.trayicon\.disable : "
  expect      : "isolation\.tools\.ghi\.trayicon\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unity"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unity,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unity.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unity\.disable : "
  expect      : "isolation\.tools\.unity\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unity-interlock"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unity-interlock,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unityInterlockOperation.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityInterlockOperation.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unityInterlockOperation.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityInterlockOperation.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unityInterlockOperation.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityInterlockOperation.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unityInterlockOperation.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unityInterlockOperation.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unityInterlockOperation\.disable : "
  expect      : "isolation\.tools\.unityInterlockOperation\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unity-taskbar"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unity-taskbar,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unity.taskbar.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.taskbar.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.taskbar.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.taskbar.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.taskbar.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.taskbar.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.taskbar.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.taskbar.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unity\.taskbar\.disable : "
  expect      : "isolation\.tools\.unity\.taskbar\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unity-unityactive"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unity-unityactive,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unityActive.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityActive.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unityActive.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityActive.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unityActive.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unityActive.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unityActive.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unityActive.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unityActive\.disable : "
  expect      : "isolation\.tools\.unityActive\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unity-windowcontents"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unity-windowcontents,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unity.windowContents.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.windowContents.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.windowContents.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.windowContents.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.windowContents.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.windowContents.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.windowContents.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.windowContents.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unity\.windowContents\.disable : "
  expect      : "isolation\.tools\.unity\.windowContents\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-unitypush"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-unitypush,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.unity.push.update.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.push.update.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.push.update.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.push.update.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.push.update.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.unity.push.update.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.unity.push.update.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.unity.push.update.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.unity\.push\.update\.disable : "
  expect      : "isolation\.tools\.unity\.push\.update\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-versionget"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-versionget,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.vmxDnDVersionGet.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vmxDnDVersionGet.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.vmxDnDVersionGet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vmxDnDVersionGet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.vmxDnDVersionGet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vmxDnDVersionGet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.vmxDnDVersionGet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.vmxDnDVersionGet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.vmxDnDVersionGet\.disable : "
  expect      : "isolation\.tools\.vmxDnDVersionGet\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-unexposed-features-versionset"
  info        : "Because VMware virtual machines are designed to work on both vSphere as well as hosted virtualization platforms such as Workstation and Fusion, there are some VMX parameters that don't apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX, explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host, and thus may help prevent successful exploits."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disable-unexposed-features-versionset,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.guestDnDVersionSet.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.guestDnDVersionSet.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.guestDnDVersionSet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.guestDnDVersionSet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.guestDnDVersionSet.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.guestDnDVersionSet.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.guestDnDVersionSet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.guestDnDVersionSet.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.guestDnDVersionSet\.disable : "
  expect      : "isolation\.tools\.guestDnDVersionSet\.disable : True$"
</custom_item>

<report type:"WARNING">
  description : "VM : disable-unnecessary-functions"
  info        : "By disabling unnecessary system components that are not needed to support the application or service running on the system, you reduce the number of parts that can be attacked. VMs often don't require as many services or functions as ordinary physical servers; so when virtualizing, you should evaluate whether a particular service or function is truly needed. Any service running in a VM provides a potential avenue of attack."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.1,PCI-DSS|2.2.2,PCI-DSS|2.2.4,VMWare-ID|disable-unnecessary-functions,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disable-vix-messages"
  info        : "The VIX API is a library for writing scripts and programs to manipulate virtual machines. If you do not make use of custom VIX programming in your environment, then you should consider disabling certain features to reduce the potential for vulnerabilities.  The ability to send messages from the VM to the host is one of these features.  Note that disabling this feature does NOT adversely affect the functioning of VIX operations that originate outside the guest, so certain VMware and 3rd party solutions that rely upon this capability should continue to work."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.3,SWIFT-CSCv1|2.3,VMWare-ID|disable-vix-messages,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.tools.vixMessage.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vixMessage.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.vixMessage.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vixMessage.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.vixMessage.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.tools.vixMessage.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.tools.vixMessage.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.tools.vixMessage.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.tools\.vixMessage\.disable : "
  expect      : "isolation\.tools\.vixMessage\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disconnect-devices-floppy"
  info        : "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated.  Any enabled or connected device represents another potential attack channel."
  reference   : "800-171|3.8.7,800-53|MP-7,CN-L3|8.5.4.1(c),CSF|PR.PT-2,ISO/IEC-27001|A.8.3.1,ISO/IEC-27001|A.8.3.3,NESA|T1.4.1,PCI-DSS|2.2.4,VMWare-ID|disconnect-devices-floppy,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set floppyX.present to false in the virtual machine configuration file or remove the floppy drive from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'floppy') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'floppy') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - floppyX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - floppyX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "floppy([Xx]|[0-9]+)\.present :"
  not_expect  : "floppy[a-zA-Z0-9]\.present : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disconnect-devices-ide"
  info        : "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated.  Any enabled or connected device represents another potential attack channel."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disconnect-devices-ide,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set ideX:Y.present to false in the virtual machine configuration file or remove the IDE device from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'ide') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'ide') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - ideX:Y.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - ideX:Y.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "ide([Xx]|[0-9]+):([Yy]|[0-9]+)\.present :"
  expect      : "ide([Xx]|[0-9]+):([Yy]|[0-9]+)\.present : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disconnect-devices-parallel"
  info        : "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated.  Any enabled or connected device represents another potential attack channel."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disconnect-devices-parallel,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set parallelX.present to false in the virtual machine configuration file or remove the parallel port from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'parallel') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'parallel') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - parallelX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - parallelX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "parallel([Xx]|[0-9]+)\.present :"
  expect      : "parallel([Xx]|[0-9]+)\.present : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disconnect-devices-serial"
  info        : "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated.  Any enabled or connected device represents another potential attack channel."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,VMWare-ID|disconnect-devices-serial,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set serialX.present to false in the virtual machine configuration file or remove the serial port from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'serial') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'serial') and contains (audit:key,'.present')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - serialX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - serialX.present : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "serial([Xx]|[0-9]+)\.present :"
  expect      : "serial([Xx]|[0-9]+)\.present : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : disconnect-devices-usb"
  info        : "Besides disabling unnecessary virtual devices from within the virtual machine, you should ensure that no device is connected to a virtual machine if it is not required to be there. For example, serial and parallel ports are rarely used for virtual machines in a datacenter environment, and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required, either the parameter should not be present or its value must be FALSE.  NOTE: The parameters listed are not sufficient to ensure that a device is usable; other parameters are required to indicate specifically how each device is instantiated.  Any enabled or connected device represents another potential attack channel."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.4,PCI-DSS|9.7,SWIFT-CSCv1|2.3,VMWare-ID|disconnect-devices-usb,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set usb:X.present to false in the virtual machine configuration file or remove the USB device from the virtual machine."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualUSBController']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - Virtual USB Controller : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualUSBController']/audit:deviceInfo/audit:label\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - Virtual USB Controller : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:hardware/audit:device[@xsi:type='VirtualUSBController']/audit:deviceInfo/audit:label\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - Virtual USB Controller : NOT configured<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - Virtual USB Controller : NOT configured<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Virtual USB Controller :"
  expect      : "Virtual USB Controller : (False|NOT found)$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : limit-console-connections-one"
  info        : "By default, remote console sessions can be connected to by more than one user at a time.  When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a nonadministrator in the VM might connect to the console and observe the administrator's actions.  Also, this could result in an administrator losing console access to a virtual machine. For example if a jump box is being used for an open console session, and the admin loses connection to that box, then the console session remains open.  Allowing two console sessions permits debugging via a shared session.  For highest security, only one remote console session at a time should be allowed."
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSS|2.2.3,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,VMWare-ID|limit-console-connections-one,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set RemoteDisplay.maxConnections to 1 in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - RemoteDisplay.maxConnections : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - RemoteDisplay.maxConnections : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - RemoteDisplay.maxConnections : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - RemoteDisplay.maxConnections : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "RemoteDisplay\.maxConnections : "
  expect      : "RemoteDisplay\.maxConnections : 1$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : limit-console-connections-two"
  info        : "By default, remote console sessions can be connected to by more than one user at a time.  When multiple sessions are activated, each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session, a nonadministrator in the VM might connect to the console and observe the administrator's actions.  Also, this could result in an administrator losing console access to a virtual machine. For example if a jump box is being used for an open console session, and the admin loses connection to that box, then the console session remains open.  Allowing two console sessions permits debugging via a shared session.  For highest security, only one remote console session at a time should be allowed."
  reference   : "800-53|AC-10,ITSG-33|AC-10,PCI-DSS|2.2.3,VMWare-ID|limit-console-connections-two,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set RemoteDisplay.maxConnections to 2 in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - RemoteDisplay.maxConnections : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - RemoteDisplay.maxConnections : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='RemoteDisplay.maxConnections']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - RemoteDisplay.maxConnections : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - RemoteDisplay.maxConnections : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "RemoteDisplay\.maxConnections : "
  expect      : "RemoteDisplay\.maxConnections : 2$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : limit-log-number"
  info        : "You can use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled."
  reference   : "800-53|AU-4,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,PCI-DSS|10.5.2,VMWare-ID|limit-log-number,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set log.keepOld to a value greater than 10 in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.keepOld']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - log.keepOld : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.keepOld']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - log.keepOld : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.keepOld']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - log.keepOld : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - log.keepOld : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "log\.keepOld : "
  expect      : "log\.keepOld : [1-9][0-9]+$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : limit-log-size"
  info        : "You can use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted, so the file can grow to be quite large. You can ensure that new log files are created more frequently by limiting the maximum size of the log files. If you want to restrict the total size of logging data, VMware recommends saving 10 log files, each one limited to 1,000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB, so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log, the size of the log is checked; if it is over the limit, the next entry is written to a new log. If the maximum number of log files already exists, when a new one is created, the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB, so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. You should not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial of service due to the datastore's being filled."
  reference   : "800-53|AU-4,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,PCI-DSS|10.5.2,VMWare-ID|limit-log-size,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set log.keepOld to a value greater than 100000 in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.rotateSize']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - log.rotateSize : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.rotateSize']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - log.rotateSize : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='log.rotateSize']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - log.rotateSize : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - log.rotateSize : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "log\.rotateSize : "
  expect      : "log\.rotateSize : [1-9][0-9][0-9][0-9][0-9][0-9]+$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : limit-setinfo-size"
  info        : "The configuration file containing these name-value pairs is limited to a size of 1MB. This 1MB capacity should be sufficient for most cases, but you can change this value if necessary. You might increase this value if large amounts of custom information are being stored in the configuration file. The default limit is 1MB; this limit is applied even when the sizeLimit parameter is not listed in the .vmx file.  Uncontrolled size for the VMX file can lead to denial of service if the datastore is filled."
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SWIFT-CSCv1|2.3,VMWare-ID|limit-setinfo-size,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set tools.setInfo.sizeLimit to 1048576 or less in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.setInfo.sizeLimit']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - tools.setInfo.sizeLimit : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.setInfo.sizeLimit']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - tools.setInfo.sizeLimit : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.setInfo.sizeLimit']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - tools.setInfo.sizeLimit : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - tools.setInfo.sizeLimit : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "tools\.setInfo\.sizeLimit : "
  expect      : "tools\.setInfo\.sizeLimit : (104857[0-6]|10485[0-6][0-9]|1048[0-4][0-9][0-9]|104[0-7][0-9][0-9][0-9]|10[0-3][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9][0-9]|[0-9][0-9][0-9][0-9]|[0-9][0-9][0-9]|[0-9][0-9]|[0-9])$"
</custom_item>

<report type:"WARNING">
  description : "VM : minimize-console-use"
  info        : "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls, which might potentially allow a malicious user to bring down a virtual machine. In addition, it also has a performance impact on the service console, especially if many VM console sessions are open simultaneously."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|minimize-console-use,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VM
  description : "VM : prevent-device-interaction-connect"
  info        : "Normal users and processes, that is users and processes without root or administrator privileges, within virtual machines have the capability to connect or disconnect devices, such as network adaptors and CD-ROM drives, as well as the ability to modify device settings. In general, you should use the virtual machine settings editor or configuration editor to remove any unneeded or unused hardware devices. However, you might want to use the device again, so removing it is not always a good solution. In that case, you can prevent a user or running process in the virtual machine from connecting or disconnecting a device from within the guest operating system, as well as modifying devices."
  reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,PCI-DSS|1.1.1,VMWare-ID|prevent-device-interaction-connect,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.device.edit.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.connectable.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.device.connectable.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.connectable.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.device.connectable.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.connectable.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.device.connectable.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.device.connectable.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.device\.connectable\.disable : "
  expect      : "isolation\.device\.connectable\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : prevent-device-interaction-edit"
  info        : "Normal users and processes, that is users and processes without root or administrator privileges, within virtual machines have the capability to connect or disconnect devices, such as network adaptors and CD-ROM drives, as well as the ability to modify device settings. In general, you should use the virtual machine settings editor or configuration editor to remove any unneeded or unused hardware devices. However, you might want to use the device again, so removing it is not always a good solution. In that case, you can prevent a user or running process in the virtual machine from connecting or disconnecting a device from within the guest operating system, as well as modifying devices."
  reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,PCI-DSS|1.1.1,VMWare-ID|prevent-device-interaction-edit,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set isolation.device.edit.disable to true in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.edit.disable']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.device.edit.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.edit.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.device.edit.disable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='isolation.device.edit.disable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - isolation.device.edit.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - isolation.device.edit.disable : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "isolation\.device\.edit\.disable : "
  expect      : "isolation\.device\.edit\.disable : True$"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : restrict-host-info"
  info        : "If set to TRUE a VM can obtain detailed information about the physical host. The default value for the parameter is FALSE. This setting should not be TRUE unless a particular VM requires this information for performance monitoring. An adversary potentially can use this information to inform further attacks on the host."
  reference   : "800-171|3.13.4,800-53|SC-4,ITSG-33|SC-4,PCI-DSS|2.2.3,VMWare-ID|restrict-host-info,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Set tools.guestlib.enableHostInfo to false in the virtual machine configuration file."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.guestlib.enableHostInfo']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - tools.guestlib.enableHostInfo : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.guestlib.enableHostInfo']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - tools.guestlib.enableHostInfo : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='tools.guestlib.enableHostInfo']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - tools.guestlib.enableHostInfo : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - tools.guestlib.enableHostInfo : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "tools\.guestlib\.enableHostInfo : "
  expect      : "tools\.guestlib\.enableHostInfo : False$"
</custom_item>

<report type:"WARNING">
  description : "VM : secure-guest-os"
  info        : "A key to understanding the security requirements of a virtualized environment is the recognition that a virtual machine is, in most respects, the equivalent of a physical server. Therefore, it is critical that you employ the same security measures in virtual machines that you would for physical servers.  The guest operating system that runs in the virtual machine is subject to the same security risks as a physical system."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2,VMWare-ID|secure-guest-os,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VM : use-secure-serial-communication"
  info        : "Serial ports are interfaces for connecting peripherals to the virtual machine. They are often used on physical systems to provide a direct, low-level connection to the console of a server, and a virtual serial port allows for the same access to a virtual machine. Serial ports allow for low-level access, which often does not have strong controls like logging or privileges."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.4,VMWare-ID|use-secure-serial-communication,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VM
  description : "VM : use-vm-templates"
  info        : "By capturing a hardened base operating system image (with no applications installed) in a template, you can ensure that all your virtual machines are created with a known baseline level of security. You can then use this template to create other, application-specific templates, or you can use the application template to deploy virtual machines.  Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error."
  reference   : "800-171|3.4.1,800-53|CM-2,CSF|DE.AE-1,CSF|PR.DS-7,CSF|PR.IP-1,ITSG-33|CM-2,PCI-DSS|2.2,VMWare-ID|use-vm-templates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "Review the list of VMs."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:val[@xsi:type='VirtualMachineConfigInfo']\">"
  xsl_stmt    : "VM: <xsl:value-of select=\"audit:name\"/> - Template : <xsl:value-of select=\"audit:template\"/>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
</custom_item>

<custom_item>
  type        : AUDIT_VM
  description : "VM : verify-network-filter"
  info        : "A VM must be configured explicitly to accept access by the dvfilter network API. This should be done only for VMs for which you want this to be done. An attacker might compromise the VM by making use of this introspection channel."
  reference   : "800-171|3.1.1,800-53|AC-3,CN-L3|8.1.10.2(c),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSS|2.2.3,TBA-FIISB|31.1,VMWare-ID|verify-network-filter,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  solution    : "If a VM is not supposed to be protected by a product using the dvfilter API, ensure ethernetn.filtern.name = dv-filterX is not present in its VMX file. If the VM is supposed to be protected, ensure that the name of the data path kernel is set correctly."
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'ethernet') and contains (audit:key,'.filter') and contains (audit:key,'.name')]\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[contains (audit:key,'ethernet') and contains (audit:key,'.filter') and contains (audit:key,'.name')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"../../../audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - ethernetn.filtern.name : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - ethernetn.filtern.name : NOT found<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "ethernet[0-9]+\.filter[0-9]+\.name :"
  expect      : "ethernet[0-9]+\.filter[0-9]+\.name : NOT found$"
</custom_item>

# If a VMsafe CPU/memory product is not in use comment out this check and enable the check for vmsafe.enable = false below

<if>
  <condition type:"AND">
    <custom_item>
      type        : AUDIT_VM
      description : "VM : verify-vmsafe-cpumem-enable"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "vmsafe\.enable : "
      expect      : "vmsafe\.enable : True$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : AUDIT_VM
      description : "VM : verify-vmsafe-cpumem-agentaddress"
      info        : "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.  However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API.  A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API, one to set the IP address used by the security virtual appliance on the introspection vSwitch, and one to set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which you want this protection."
      info        : "NOTE: Update AGENT_ADDRESS with the appropriate value for the local environment."
      reference   : "800-171|3.14.5,800-53|SI-3(10),CSF|DE.CM-4,NIAv2|GS17,PCI-DSS|2.2.3,SWIFT-CSCv1|6.1,VMWare-ID|verify-vmsafe-cpumem-agentaddress,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
      see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
      solution    : "If the VM is being protected by VMsafe, make sure vmsafe.agentAddress is set to the correct value."
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentAddress']\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.agentAddress : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentAddress']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.agentAddress : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentAddress']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.agentAddress : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.agentAddress : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "vmsafe\.agentAddress : "
# Note: Variable @AGENT_ADDRESS@ replaced with "192\\.168\\.0\\.1" in field "expect".
      expect      : "vmsafe\.agentAddress : 192\\.168\\.0\\.1$"
    </custom_item>

    <custom_item>
      type        : AUDIT_VM
      description : "VM : verify-vmsafe-cpumem-agentport"
      info        : "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.  However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API.  A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API, one to set the IP address used by the security virtual appliance on the introspection vSwitch, and one to set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which you want this protection."
      info        : "NOTE: Update AGENT_PORT with the appropriate value for the local environment."
      reference   : "800-171|3.14.5,800-53|SI-3(10),CSF|DE.CM-4,NIAv2|GS17,PCI-DSS|2.2.3,SWIFT-CSCv1|6.1,VMWare-ID|verify-vmsafe-cpumem-agentport,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
      see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
      solution    : "If the VM is being protected by VMsafe, make sure vmsafe.agentPort is set to the correct value."
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentPort']\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.agentPort : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentPort']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.agentPort : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.agentPort']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.agentPort : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.agentPort : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "vmsafe\.agentPort : "
# Note: Variable @AGENT_PORT@ replaced with "10000" in field "expect".
      expect      : "vmsafe\.agentPort : 10000$"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : AUDIT_VM
      description : "VM : verify-vmsafe-cpumem-enable"
      info        : "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.  However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API.  A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API, one to set the IP address used by the security virtual appliance on the introspection vSwitch, and one to set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which you want this protection."
      reference   : "800-171|3.14.5,800-53|SI-3(10),CSF|DE.CM-4,NIAv2|GS17,PCI-DSS|2.2.3,SWIFT-CSCv1|6.1,VMWare-ID|verify-vmsafe-cpumem-enable,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
      see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
      solution    : "If the VM is being protected by VMsafe, make sure vmsafe.enable is set to true."
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "vmsafe\.enable : "
      expect      : "vmsafe\.enable : True$"
    </custom_item>
  </else>
</if>

## If a VMsafe CPU/memory product is in use leave this check commented out.
## The VMsafe settings will be validated by the check above.
#<custom_item>
# type			: AUDIT_VM
# description	: "VM : verify-vmsafe-cpumem-enable"
# info			: "The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs, for the purpose of detecting and preventing malware attacks.  However, an attacker might compromise the VM by making use of this introspection channel; therefore you should monitor for unauthorized usage of this API.  A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API, one to set the IP address used by the security virtual appliance on the introspection vSwitch, and one to set the port number for that IP address. If the VM is being protected by such a product, then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which you want this protection."
# reference		: "VMWare-ID|verify-vmsafe-cpumem-enable,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3,PCI-DSS|2.2.3"
# see_also          : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
# solution		: "If the VM is not being protected by VMsafe, make sure vmsafe.enable is set to false."
# xsl_stmt   	: "<xsl:template match=\"/\">"
# xsl_stmt   	: "<xsl:for-each select=\"//audit:returnval\">"
# xsl_stmt   	: "<xsl:choose>"
# xsl_stmt   	: "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']\">"
# xsl_stmt   	: "<xsl:choose>"
# xsl_stmt   	: "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
# xsl_stmt   	: "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
# xsl_stmt   	: "</xsl:when>"
# xsl_stmt   	: "<xsl:otherwise>"
# xsl_stmt   	: "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:extraConfig[audit:key='vmsafe.enable']/audit:value\"/><xsl:text>&#10;</xsl:text>"
# xsl_stmt   	: "</xsl:otherwise>"
# xsl_stmt   	: "</xsl:choose>"
# xsl_stmt   	: "</xsl:when>"
# xsl_stmt   	: "<xsl:otherwise>"
# xsl_stmt   	: "<xsl:choose>"
# xsl_stmt   	: "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\">"
# xsl_stmt   	: "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:ipAddress\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
# xsl_stmt   	: "</xsl:when>"
# xsl_stmt   	: "<xsl:otherwise>"
# xsl_stmt   	: "<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineConfigInfo']/audit:name\"/> (<xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='VirtualMachineSummary']/audit:guest/audit:toolsStatus\"/>) - vmsafe.enable : NOT found<xsl:text>&#10;</xsl:text>"
# xsl_stmt   	: "</xsl:otherwise>"
# xsl_stmt   	: "</xsl:choose>"
# xsl_stmt   	: "</xsl:otherwise>"
# xsl_stmt   	: "</xsl:choose>"
# xsl_stmt   	: "</xsl:for-each>"
# xsl_stmt   	: "</xsl:template>"
# regex			: "vmsafe\.enable : "
# expect			: "vmsafe\.enable : False$"
#</custom_item>

<report type:"WARNING">
  description : "VM : minimize-console-VNC-use"
  info        : "The VM console enables you to connect to the console of a virtual machine, in effect seeing what a monitor on a physical server would show. This console is also availabe via the VNC protocol. Setting up this access also involves setting up firewall rules on each ESXi server the virtual machine will run on. Instead of opening up access to a VNC session, use native remote management services, such as terminal services and ssh, to interact with virtual machines. Grant VNC access only when necessary."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "VMWare-ID|minimize-console-VNC-use,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# ESXi Checks

<report type:"WARNING">
  description : "ESXi : apply-patches"
  info        : "By staying up to date on ESXi patches, vulnerabilities in the hypervisor can be mitigated. An educated attacker can exploit known vulnerabilities when attempting to attain access or elevate privileges on an ESXi host."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|apply-patches,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'CIM Server allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpServer']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpServer']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpServer']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>CIM Server : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "CIM Server : enabled ="
  expect      : "CIM Server : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'CIM Secure Server allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpsServer']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpsServer']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMHttpsServer']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>CIM Secure Server : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "CIM Secure Server : enabled ="
  expect      : "CIM Secure Server : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'CIM SLP allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMSLP']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMSLP']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='CIMSLP']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>CIM SLP : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "CIM SLP : enabled ="
  expect      : "CIM SLP : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'DHCPv6 blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DHCPv6']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DHCPv6']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DHCPv6']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>DHCPv6 : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DHCPv6 : enabled ="
  expect      : "DHCPv6 : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'DVFilter blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVFilter']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVFilter']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVFilter']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>DVFilter : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DVFilter : enabled ="
  expect      : "DVFilter : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'DVSSync blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVSSync']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVSSync']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='DVSSync']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>DVSSync : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DVSSync : enabled ="
  expect      : "DVSSync : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'HBR allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='HBR']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='HBR']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='HBR']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>HBR : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "HBR : enabled ="
  expect      : "HBR : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'IKED blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='IKED']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='IKED']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='IKED']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>IKED : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "IKED : enabled ="
  expect      : "IKED : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'NFC allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='NFC']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='NFC']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='NFC']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>NFC : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "NFC : enabled ="
  expect      : "NFC : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'WOL allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='WOL']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='WOL']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='WOL']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>WOL : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "WOL : enabled ="
  expect      : "WOL : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'Active Directory All blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='activeDirectoryAll']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='activeDirectoryAll']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='activeDirectoryAll']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Active Directory All : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Active Directory All : enabled ="
  expect      : "Active Directory All : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'DHCP Client allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dhcp']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dhcp']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dhcp']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>DHCP Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DHCP Client : enabled ="
  expect      : "DHCP Client : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'DNS Client allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dns']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dns']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='dns']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>DNS Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DNS Client : enabled ="
  expect      : "DNS Client : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'Fault Tolerance blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='faultTolerance']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='faultTolerance']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='faultTolerance']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Fault Tolerance : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Fault Tolerance : enabled ="
  expect      : "Fault Tolerance : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'vSphere High Availability Agent blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='fdm']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='fdm']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='fdm']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>vSphere High Availability Agent : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vSphere High Availability Agent : enabled ="
  expect      : "vSphere High Availability Agent : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'FTP Client blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ftpClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ftpClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ftpClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>FTP Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "FTP Client : enabled ="
  expect      : "FTP Client : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'gdbserver blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='gdbserver']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='gdbserver']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='gdbserver']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>gdbserver : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "gdbserver : enabled ="
  expect      : "gdbserver : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'httpClient blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='httpClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='httpClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='httpClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>httpClient : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "httpClient : enabled ="
  expect      : "httpClient : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'Software iSCSI Client blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='iSCSI']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='iSCSI']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='iSCSI']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Software iSCSI Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Software iSCSI Client : enabled ="
  expect      : "Software iSCSI Client : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'NFS Client blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='nfsClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='nfsClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='nfsClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>NFS Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "NFS Client : enabled ="
  expect      : "NFS Client : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'NTP Client blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ntpClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ntpClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='ntpClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>NTP Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "NTP Client : enabled ="
  expect      : "NTP Client : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'VM serial port connected over network blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='remoteSerialPort']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='remoteSerialPort']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='remoteSerialPort']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>VM serial port connected over network : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "VM serial port connected over network : enabled ="
  expect      : "VM serial port connected over network : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'SNMP Server allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='snmp']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='snmp']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='snmp']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>SNMP Server : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "SNMP Server : enabled ="
  expect      : "SNMP Server : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'SSH Client blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>SSH Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "SSH Client : enabled ="
  expect      : "SSH Client : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'SSH Server allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshServer']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshServer']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='sshServer']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>SSH Server : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "SSH Server : enabled ="
  expect      : "SSH Server : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'syslog blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='syslog']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='syslog']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='syslog']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>syslog : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "syslog : enabled ="
  expect      : "syslog : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'vCenter Update Manager blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='updateManager']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='updateManager']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='updateManager']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>vCenter Update Manager : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vCenter Update Manager : enabled ="
  expect      : "vCenter Update Manager : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'vMotion allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vMotion']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vMotion']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vMotion']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>vMotion : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vMotion : enabled ="
  expect      : "vMotion : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'VM serial port connected to vSPC blocked'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSPC']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSPC']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSPC']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>VM serial port connected to vSPC : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "VM serial port connected to vSPC : enabled ="
  expect      : "VM serial port connected to vSPC : enabled = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'vSphere Client allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSphereClient']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSphereClient']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vSphereClient']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>vSphere Client : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vSphere Client : enabled ="
  expect      : "vSphere Client : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'VMware vCenter Agent allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vpxHeartbeats']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vpxHeartbeats']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='vpxHeartbeats']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>VMware vCenter Agent : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "VMware vCenter Agent : enabled ="
  expect      : "VMware vCenter Agent : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-firewall-access - 'vSphere Web Access allowed'"
  info        : "Unrestricted access to services running on an ESXi host can expose a host to outside attacks and unauthorized access.  Reduce the risk by configuring the ESXi firewall to only allow access from authorized networks."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,PCI-DSS|1.1.3,PCI-DSS|2.2.2,VMWare-ID|config-firewall-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='webAccess']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='webAccess']/audit:label\"/> : enabled = <xsl:value-of select=\"audit:propSet/audit:val/audit:firewall/audit:ruleset[audit:key='webAccess']/audit:enabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>vSphere Web Access : enabled = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vSphere Web Access : enabled ="
  expect      : "vSphere Web Access : enabled = True$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-ntp"
  info        : "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal Time-UTC), you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files.  Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate."
  info        : "NOTE: Update NTP_SERVER to the appropriate value for the local environment."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4.1,PCI-DSS|10.4.3,VMWare-ID|config-ntp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:dateTimeInfo/audit:ntpConfig/audit:server\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - NTP Server : <xsl:value-of select=\"audit:propSet/audit:val/audit:dateTimeInfo/audit:ntpConfig/audit:server\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>NTP Server : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "NTP Server : "
# Note: Variable @NTP_SERVER@ replaced with "0\\.us\\.pool\\.ntp\\.org" in field "expect".
  expect      : "NTP Server : 0\\.us\\.pool\\.ntp\\.org$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : config-persistent-logs"
  info        : "ESXi can be configured to store log files on an in-memory file system.  This occurs when the host's '/scratch' directory is linked to '/tmp/scratch'. When this is done only a single day's worth of logs are stored at any time, in addition log files will be reinitialized upon each reboot.  This presents a security risk as user activity logged on the host is only stored temporarily and will not persistent across reboots.  This can also complicate auditing and make it harder to monitor events and diagnose issues.  ESXi host logging should always be configured to a persistent datastore."
  info        : "NOTE: Update LOG_DIR to the appropriate value for the local environment"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,PCI-DSS|10.5.4,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,VMWare-ID|config-persistent-logs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logDir']/audit:value/text()\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logDir']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logDir']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Syslog.global.logDir : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Syslog\.global\.logDir : "
# Note: Variable @LOG_DIR@ replaced with "\\\\[\\\\] \\/scratch\\/log1" in field "expect".
  expect      : "Syslog\.global\.logDir : \\\\[\\\\] \\/scratch\\/log1$"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : AUDIT_VCENTER
      description : "ESXi : config-snmp - 'snmp.receiver.X.enabled'"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.enabled') and contains (audit:value,'true')]\">"
      xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.enabled') and contains (audit:value,'true')]\">"
      xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val/audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "snmp\.receiver\.([Xx]|[0-9]+)\.enabled : "
      expect      : "snmp\.receiver\.([Xx]|[0-9]+)\.enabled : True$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : AUDIT_VCENTER
      description : "ESXi : config-snmp - 'snmp.receiver.X.community'"
      info        : "If SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.  Note:  ESXi 5.1 supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption."
      reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSS|2.1,VMWare-ID|config-snmp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
      see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.community') and contains (audit:value,'public')]\">"
      xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.community') and contains (audit:value,'public')]\">"
      xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val/audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "snmp\.receiver\.[0-9]+\.community : "
      not_expect  : "snmp\.receiver\.[0-9]+\.community : [Pp][Uu][Bb][Ll][Ii][Cc]$"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : AUDIT_VCENTER
      description : "ESXi : config-snmp - 'snmp.receiver.X.enabled'"
      info        : "If SNMP is not being used, it should remain disabled. If it is being used, the proper trap destination should be configured. If SNMP is not properly configured, monitoring information can be sent to a malicious host that can then use this information to plan an attack.  Note:  ESXi 5.1 supports SNMPv3 which provides stronger security than SNMPv1 or SNMPv2, including key authentication and encryption."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSCv6|3.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.1,SWIFT-CSCv1|2.3,VMWare-ID|config-snmp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
      see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
      xsl_stmt    : "<xsl:template match=\"/\">"
      xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.enabled')]\">"
      xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val/audit:OptionValue[contains (audit:key,'snmp.receiver') and contains (audit:key,'.enabled')]\">"
      xsl_stmt    : "<xsl:value-of select=\"../../../audit:propSet/audit:val/audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:value-of select=\"audit:key\"/> : <xsl:value-of select=\"audit:value\"/><xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:value-of select=\"audit:propSet/audit:val/audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - snmp.receiver.X.enabled : NOT found<xsl:text>&#10;</xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:for-each>"
      xsl_stmt    : "</xsl:template>"
      regex       : "snmp\.receiver\.([Xx]|[0-9]+)\.enabled : "
      not_expect  : "snmp\.receiver\.([Xx]|[0-9]+)\.enabled : True$"
    </custom_item>
  </else>
</if>

<report type:"WARNING">
  description : "ESXi : create-local-admin"
  info        : "By default each ESXi host has a single 'root' admin account that is used for local administration and to connect the host to vCenter Server.  To avoid sharing a common root account it is recommended on each host to create at least one named user account and assign it full admin privileges and to use  this account in lieu of a shared 'root' account.  Set a highly complex password for the 'root' account and secure it in a safe location.  Limit the sue of 'root'."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|8.5.1,VMWare-ID|create-local-admin,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : disable-dcui"
  info        : "The DCUI allows for low-level host configuration such as configuring IP address, hostname and root password as well as diagnostic capabilities such as enabling the ESXi shell, viewing log files, restarting agents, and resetting configurations.  Actions performed from the DCUI are not tracked by vCenter Server.  Even if Lockdown Mode is enabled, users who are members of the DCUI.Access list can perform administrative tasks in the DCUI bypassing RBAC and auditing controls provided through vCenter.  DCUI access can be disabled.  Disabling it prevents all local activity and thus forces actions to be performed in vCenter Server where they can be centrally audited and monitored."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|8.5.16,SWIFT-CSCv1|2.3,VMWare-ID|disable-dcui,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='DCUI']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='DCUI']/audit:label\"/> : running = <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='DCUI']/audit:running\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Direct Console UI : running = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Direct Console UI : running ="
  expect      : "Direct Console UI : running = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : disable-esxi-shell"
  info        : "ESXi Shell is an interactive command line environment available from the DCUI or remotely via SSH.  Access to this mode requires the root password of the server.  The ESXi Shell can be turned on and off for individual hosts.  Activities performed from the ESXi Shell bypass vCenter RBAC and audit controls.  The ESXi shell should only be turned on when needed to troubleshoot/resolve problems that cannot be fixed through the vSphere client or vCLI/PowerCLI."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,VMWare-ID|disable-esxi-shell,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM']/audit:label\"/> : running = <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM']/audit:running\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>ESXi Shell : running = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "ESXi Shell : running = "
  expect      : "ESXi Shell : running = False$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : disable-mob"
  info        : "The managed object browser (MOB) provides a way to explore the object model used by the VMkernel to manage the host; it enables configurations to be changed as well. This interface is meant to be used primarily for debugging the vSphere SDK but because there are no access controls it could also be used as a method obtain information about a host being targeted for unauthorized access."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|disable-mob,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : disable-ssh"
  info        : "The ESXi shell, when enabled, can be accessed directly from the host console through the DCUI or remotely using SSH.  Remote access to the host should be limited to the vSphere Client, remote command-line tools (vCLI/PowerCLI), and through the published APIs.  Under normal circumstances remote access to the host using SSH should be disabled."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,VMWare-ID|disable-ssh,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM-SSH']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM-SSH']/audit:label\"/> : running = <xsl:value-of select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:service/audit:service[audit:key='TSM-SSH']/audit:running\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>SSH : running = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "SSH : running = "
  expect      : "SSH : running = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : enable-ad-auth"
  info        : "Join ESXi hosts to an Active Directory (AD) domain to eliminate the need to create and maintain multiple local user accounts. Using AD for user authentication simplifies the ESXi host configuration, ensures password complexity and reuse policies are enforced and reduces the risk of security breaches and unauthorized access.  Note: if the AD group 'ESX Admins' (default) is created all users and groups that are assigned as members to this group will have full administrative access to all ESXi hosts the domain.  Refer to the 'verify-admin-group' recommendation for more information."
  reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|7.1.4,TBA-FIISB|35.1,TBA-FIISB|36.1,VMWare-ID|enable-ad-auth,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ActiveDirectoryPreferredDomainControllers']/audit:value/text()\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ActiveDirectoryPreferredDomainControllers']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ActiveDirectoryPreferredDomainControllers']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>UserVars.ActiveDirectoryPreferredDomainControllers : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "UserVars\.ActiveDirectoryPreferredDomainControllers : "
  expect      : ""
</custom_item>

<report type:"WARNING">
  description : "ESXi : enable-auth-proxy"
  info        : "If you configure your host to join an Active Directory domain using Host Profiles the active directory credentials are saved in the host profile and are transmitted over the network.  To avoid having to save active directory credentials in the Host Profile and to avoid transmitting active directory credentials over the network  use the vSphere Authentication Proxy."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.4,VMWare-ID|enable-auth-proxy,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : enable-chap-auth"
  info        : "vSphere allows for the use of bidirectional authentication of both the iSCSI target and host. Choosing not to enforce more stringent authentication can make sense if you create a dedicated network or VLAN to service all your iSCSI devices. By not authenticating both the iSCSI target and host, there is a potential for a MiTM attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication can mitigate this risk. If the iSCSI facility is isolated from general network traffic, it is less vulnerable to exploitation."
  reference   : "800-53|IA-3(1),CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,PCI-DSS|4.1,TBA-FIISB|27.1,VMWare-ID|enable-chap-auth,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"//audit:returnval/audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:storageDevice/audit:hostBusAdapter[contains (@xsi:type,'InternetScsi')]\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval/audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:storageDevice/audit:hostBusAdapter[contains (@xsi:type,'InternetScsi')]\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:device\"/>) - chapAuthEnabled : <xsl:value-of select=\"audit:authenticationProperties/audit:chapAuthEnabled\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"//audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>No iSCSI devices found</xsl:text><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "chapAuthEnabled : "
  not_expect  : "chapAuthEnabled : False$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : enable-host-profiles"
  info        : "Monitoring for configuration drift and unauthorized changes is critical to ensuring the security of an ESXi hosts.  Host Profiles provide an automated method for monitoring host configurations against an established template and for providing notification in the event deviations are detected."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|enable-host-profiles,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : enable-lockdown-mode"
  info        : "Enabling lockdown mode disables all remote access to ESXi 5.0 machines. Any subsequent local changes to the host must be made-Using the DCUI or In a vSphere Client session or using vCLI commands to vCenter Server."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|enable-lockdown-mode,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VCENTER
  description : "ESXi : enable-nfc-ssl"
  info        : "NFC (Network File Copy) is the name of the mechanism used to migrate or clone a VM between two ESXi hosts over the network.  By default, SSL is used only for the authentication of the transfer, but If desired, SSL can also be enabled on the data transfer.  Without this setting VM contents could potentially be sniffed if the management network is not adequately isolated and secured."
  reference   : "800-171|3.13.8,800-53|SC-8,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,PCI-DSS|4.1,TBA-FIISB|29.1,VMWare-ID|enable-nfc-ssl,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:val[@xsi:type='ArrayOfOptionValue']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:OptionValue[audit:key='config.nfc.useSSL']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:value-of select=\"audit:OptionValue[audit:key='config.nfc.useSSL']/audit:key\"/> : <xsl:value-of select=\"audit:OptionValue[audit:key='config.nfc.useSSL']/audit:value\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:text>config.nfc.useSSL : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "config\.nfc\.useSSL : "
  expect      : "config\.nfc\.useSSL : True$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : enable-remote-dump"
  info        : "When a host crashes, an analysis of the resultant core dump is essential to being able to identify the cause of the crash to identify a resolution.  Installing a centralized dump collector helps ensure that core files are successfully saved and made available in the event an ESXi host should ever panic."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|10.5.3,VMWare-ID|enable-remote-dump,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : enable-remote-syslog"
  info        : "Remote logging to a central log host provides a secure, centralized store for ESXi logs. By gathering host log files onto a central host you can more easily monitor all hosts with a single tool. You can also do aggregate analysis and searching to look for such things as coordinated attacks on multiple hosts. Logging to a secure, centralized log server also helps prevent log tampering and also provides a long-term audit record. To facilitate remote logging provides the vSphere Syslog Collector."
  info        : "NOTE: Update LOG_HOST to the appropriate value for the local environment"
  reference   : "800-171|3.3.8,800-53|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,PCI-DSS|10.5.3,VMWare-ID|enable-remote-syslog,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logHost']/audit:value/text()\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logHost']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Syslog.global.logHost']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Syslog.global.logHost : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Syslog\.global\.logHost : "
# Note: Variable @LOG_HOST@ replaced with "192\\.168\\.0\\.1" in field "expect".
  expect      : "Syslog\.global\.logHost : 192\\.168\\.0\\.1$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : esxi-no-self-signed-certs"
  info        : "Using the default self-signed certificates leaves the SSL connection open to Man-in-The-Middle (MiTM) attacks.  Replace default self-signed certificates with those from a trusted CA, either commercial or organizational."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.7,VMWare-ID|esxi-no-self-signed-certs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : limit-cim-access"
  info        : "The CIM system provides an interface that enables hardware-level management from remote applications via a set of standard APIs. To ensure that the CIM interface remains secure only provide the minimum access necessary to these applications. Do not provision CIM and other 3rd party tools to run as root or another administrator account.  Instead, use a dedicated service account with a limited privilege set  If CIM or other 3rd party are granted unneeded administrator level access they could potentially become a back door and compromise security of the host."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.1,VMWare-ID|limit-cim-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : mask-zone-san"
  info        : "You should use zoning and LUN masking to segregate SAN activity. For example, you manage zones defined for testing independently within the SAN so they do not interfere with activity in the production zones. Similarly, you can set up different zones for different departments. Zoning must take into account any host groups that have been set up on the SAN device."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|mask-zone-san,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : remove-authorized-keys"
  info        : "ESXi hosts come with SSH which can be enabled to allow remote access without requiring user authentication.  To enable password free access copy the remote users public key into the '/etc/ssh/keys-root/authorized_keys' file on the ESXi host.  The presence of the remote user's public key in the 'authorized_keys' file identifies the user as trusted, meaning the user is granted access to the host without providing a password.  Note:  Lockdown mode does not apply to root users who log in using authorized keys. When you use an authorized key file for root user authentication, root users are not prevented from accessing a host with SSH even when the host is in lockdown mode."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.5.2,VMWare-ID|remove-authorized-keys,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : remove-revoked-certificates"
  info        : "By default, each ESXi host does not have CRL checking available. Revoked certificates must be checked and removed manually. These are typically custom generated certificates from a corporate certificate authority or 3rd party authority."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "VMWare-ID|remove-revoked-certificates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : set-dcui-access"
  info        : "Lockdown disables direct host access requiring admins manage hosts from vCenter.  However, if a host becomes isolated from vCenter the admin would become locked out and would be unable to manage the host.  To avoid potentially becoming locked out of an ESXi hosts that is running in locked down mode set the DCUI.Access to a list of highly trusted users that are allowed to override the lockdown mode and access the DCUI."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|set-dcui-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : set-password-complexity"
  info        : "ESXi uses the pam_passwdqc.so plug-in to set password strength and complexity.  It is important to use passwords that are not easily guessed and that are difficult for password generators to determine.  Note, ESXi imposes no restrictions on the root password.  Password strength and complexity rules only apply to non-root users."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|8.5.11,VMWare-ID|set-password-complexity,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : set-shell-interactive-timeout"
  info        : "If a user forgets to logout of their SSH session the idle connection will remain indefinitely increasing the potential for someone to gain privileged access to the host.  The ESXiShellInteractiveTimeOut allows you to automatically terminate idle shell sessions."
  info        : "NOTE: Update SHELL_SESSION_TIMEOUT to the appropriate value for the local environment"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|8.5.15,VMWare-ID|set-shell-interactive-timeout,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellInteractiveTimeOut']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellInteractiveTimeOut']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellInteractiveTimeOut']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>UserVars.ESXiShellInteractiveTimeOut : NOT configured</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "UserVars\.ESXiShellInteractiveTimeout : "
# Note: Variable @SHELL_SESSION_TIMEOUT@ replaced with "(300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])" in field "expect".
  expect      : "UserVars\.ESXiShellInteractiveTimeout : (300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : set-shell-timeout"
  info        : "When the ESXi Shell or SSH services are enabled on a host they will run indefinitely.  To avoid having these services left running set the ESXiShellTimeOut.  The ESXiShellTimeOut defines a window of time after which the ESXi Shell and SSH services will automatically be terminated."
  info        : "NOTE: Update SHELL_TIMEOUT to the appropriate value for the local environment"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|8.5.15,VMWare-ID|set-shell-timeout,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellTimeOut']\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellTimeOut']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='UserVars.ESXiShellTimeOut']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>UserVars.ESXiShellTimeout : NOT Found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "UserVars\.ESXiShellTimeout : "
# Note: Variable @SHELL_TIMEOUT@ replaced with "(300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])" in field "expect".
  expect      : "UserVars\.ESXiShellTimeout : (300|[1-2][0-9][0-9]|[1-9][0-9]|[1-9])$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : unique-chap-secrets"
  info        : "The mutual authentication secret for each host should be different; if possible, the secret should be different for each client authenticating to the server as well. This ensures that if a single host is compromised, an attacker cannot create another arbitrary host and authenticate to the storage device.  With a single shared secret, compromise of one host can allow an attacker to authenticate to the storage device."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.3,VMWare-ID|unique-chap-secrets,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : verify-acceptance-level-accepted"
  info        : "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned VIB represents untested code installed on an ESXi host.  The ESXi Image profile supports four acceptance levels:  (1) VMwareCertified - VIBs created, tested and signed by VMware, (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware, (3) PartnerSupported - VIBs created, tested and signed by a certified VMware partner, and (4) CommunitySupported - VIBs that have not been tested by VMware or a VMware partner.  Community Supported VIBs are not supported and do not have a digital signature.  To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|verify-acceptance-level-accepted,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : verify-acceptance-level-certified"
  info        : "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned VIB represents untested code installed on an ESXi host.  The ESXi Image profile supports four acceptance levels:  (1) VMwareCertified - VIBs created, tested and signed by VMware, (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware, (3) PartnerSupported - VIBs created, tested and signed by a certified VMware partner, and (4) CommunitySupported - VIBs that have not been tested by VMware or a VMware partner.  Community Supported VIBs are not supported and do not have a digital signature.  To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|verify-acceptance-level-certified,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : verify-acceptance-level-supported"
  info        : "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned VIB represents untested code installed on an ESXi host.  The ESXi Image profile supports four acceptance levels:  (1) VMwareCertified - VIBs created, tested and signed by VMware, (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware, (3) PartnerSupported - VIBs created, tested and signed by a certified VMware partner, and (4) CommunitySupported - VIBs that have not been tested by VMware or a VMware partner.  Community Supported VIBs are not supported and do not have a digital signature.  To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|verify-acceptance-level-supported,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : verify-admin-group"
  info        : "The AD group used by vSphere is defined by the 'esxAdminsGroup' attribute, by default this attribute is set to 'ESX Admins'.  All members of the 'ESX Admins' group are granted full administrative access to all ESXi hosts in the domain.  Monitor AD for the creation of this group and limit membership to highly trusted users and groups."
  reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSCv6|5.1,CSF|PR.AC-4,CSF|PR.DS-5,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSS|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,VMWare-ID|verify-admin-group,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='Config.HostAgent.plugins.hostsvc.esxAdminsGroup']/audit:value/text()\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Config.HostAgent.plugins.hostsvc.esxAdminsGroup']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Config.HostAgent.plugins.hostsvc.esxAdminsGroup']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Config.HostAgent.plugins.hostsvc.esxAdminsGroup : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Config\.HostAgent\.plugins\.hostsvc\.esxAdminsGroup : "
  expect      : ""
</custom_item>

<report type:"WARNING">
  description : "ESXi : verify-config-files"
  info        : "Although most configurations on ESXi are controlled via an API, there are a limited set of configuration files that are used directly to govern host behavior.  These specific files are exposed via the vSphere HTTPS-based file transfer API.  Any changes to these files should be correlated with an approved administrative action, such as an authorized configuration change.  Tampering with these files has the potential to enable unauthorized access to the host configuration and virtual machines.  WARNING: do not attempt to monitor files that are NOT exposed via this file-transfer API, since this can result in a destabilized system."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.2.1,VMWare-ID|verify-config-files,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "ESXi : verify-dvfilter-bind"
  info        : "If you are not using products that make use of the dvfilter network API (e.g. VMSafe), the host should not be configured to send network information to a VM. If the API is enabled, an attacker might attempt to connect a VM to it, thereby potentially providing access to the network of other VMs on the host.  If you are using a product that makes use o this API then verify that the host has been configured correctly."
  reference   : "800-171|3.1.1,800-53|AC-3,CN-L3|8.1.10.2(c),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSS|2.2.3,TBA-FIISB|31.1,VMWare-ID|verify-dvfilter-bind,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:option[audit:key='Net.DVFilterBindIpAddress']/audit:value/text()\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Net.DVFilterBindIpAddress']/audit:key\"/> : <xsl:value-of select=\"audit:propSet/audit:val/audit:option[audit:key='Net.DVFilterBindIpAddress']/audit:value\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>Net.DVFilterBindIpAddress : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Net\.DVFilterBindIpAddress : "
  expect      : "Net\.DVFilterBindIpAddress : NOT found$"
</custom_item>

<report type:"WARNING">
  description : "ESXi : verify-install-media"
  info        : "Verify the ESXi Image Profile to only allow signed VIBs.  An unsigned VIB represents untested code installed on an ESXi host.  The ESXi Image profile supports four acceptance levels:  (1) VMwareCertified - VIBs created, tested and signed by VMware, (2) VMwareAccepted - VIBs created by a VMware partner but tested and signed by VMware, (3) PartnerSupported - VIBs created, tested and signed by a certified VMware partner, and (4) CommunitySupported - VIBs that have not been tested by VMware or a VMware partner.  Community Supported VIBs are not supported and do not have a digital signature.  To protect the security and integrity of your ESXi hosts do not allow unsigned (CommunitySupported) VIBs to be installed on your hosts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|9.6,VMWare-ID|verify-install-media,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : verify-kernel-modules"
  info        : "VMware provides digital signatures for kernel modules.  By default the ESXi host does not permit loading of kernel modules that lack a valid digital signature.  However, this behavior can be overridden allowing unauthorized kernel modules to be loaded.  Untested or  malicious kernel modules loaded on the ESXi host can put the host at risk for instability and/or exploitation."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|verify-kernel-modules,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "ESXi : vmdk-zero-out"
  info        : "To help prevent sensitive data in VMDK files from being read off the physical disk after it is deleted, the virtual disk should be zeroed out prior to deletion.  This will make it more difficult for someone to reconstruct the contents of the VMDK file.  The CLI command 'vmkfstools -writezeroes' can be used to write zeros to the entire contents of a VMDK file prior to its deletion."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|9.10.2,VMWare-ID|vmdk-zero-out,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_VCENTER
  description : "ESXi : vpxuser-password-age"
  info        : "By default, the vpxuser password will be automatically changed by vCenter every 30 days. Ensure that this setting meets your policies; if not, configure to meet password aging policies. NOTE: It is very important that the password aging policy not be shorter than the interval that is set to automatically change the vpxuser password, to preclude the possibility that vCenter might get locked out of an ESXi host. If an attacker obtains the vpxuser password, the password can be used only for a limited amount of time."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,PCI-DSS|8.5.5,TBA-FIISB|26.2.2,VMWare-ID|vpxuser-password-age,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:val[@xsi:type='ArrayOfOptionValue']\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:OptionValue[audit:key['VirtualCenter.VimPasswordExpirationInDays']]/audit:value\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - VirtualCenter.VimPasswordExpirationInDays : <xsl:value-of select=\"audit:OptionValue[audit:key[text()='VirtualCenter.VimPasswordExpirationInDays']]/audit:value\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:OptionValue[audit:key='VirtualCenter.InstanceName']/audit:value\"/> - <xsl:text>VirtualCenter.VimPasswordExpirationInDays : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "VirtualCenter\.VimPasswordExpirationInDays : "
  expect      : "VirtualCenter\.VimPasswordExpirationInDays : (30|[1-2][0-9]|[0-9])$"
</custom_item>

# vNetwork

<report type:"WARNING">
  description : "vNetwork : disable-dvportgroup-autoexpand"
  info        : "If the 'no-unused-dvports' guideline is followed, there should be only the amount of ports on a VDS that are actually needed. The Autoexpand feature on VDS dvPortgroups can override that limit. The feature allows dvPortgroups to automatically add 10 virtual distributed switch ports to a dvPortgroup that has run out of available ports. The risk is that maliciously or inadvertently, a virtual machine that is not supposed to be part of that portgroup is able to affect confidentiality, integrity or authenticity of data of other virtual machines on that portgroup. To reduce the risk of inappropriate dvPortgroup access, the autoexpand option on VDS should be disabled. By default the option is disabled, but regular monitoring should be implemented to verify this has not been changed."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|disable-dvportgroup-autoexpand,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : document-pvlans"
  info        : "dvSwitch Private VLANs (PVLANs) require primary and secondary VLAN ID's. These need to correspond to the ID's on external PVLAN-aware upstream switches if any. If VLAN ID's are not tracked completely, mistaken re-use of ID's could allow for traffic to be allowed between inappropriate physical and virtual machines. Similarly, wrong or missing PVLAN ID's may lead to traffic not passing between appropriate physical and virtual machines."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|document-pvlans,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : document-vlans"
  info        : "If you are using VLAN tagging on a vSwitch, these need to correspond to the ID's on external VLAN-aware upstream switches if any. If VLAN ID's are not tracked completely, mistaken re-use of ID's could allow for traffic to be allowed between inappropriate physical and virtual machines. Similarly, wrong or missing VLAN ID's may lead to traffic not passing between appropriate physical and virtual machines."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|verify-vlan-id,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : document-vlans-vds"
  info        : "If you are using VLAN tagging on a dvPortgroup these need to correspond to the ID's on external VLAN-aware upstream switches if any. If VLAN ID's are not tracked completely, mistaken re-use of ID's could allow for traffic to be allowed between inappropriate physical and virtual machines. Similarly, wrong or missing VLAN ID's may lead to traffic not passing between appropriate physical and virtual machines."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|document-vlans-vds,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : enable-bpdu-filter"
  info        : "BPDU Guard and Portfast are commonly enabled on the physical switch the ESXi host is directly connected to to reduce the STP convergence delay. If a BPDU packet is sent from a virtual machine on the ESXi host to the physical switch so configured, a cascading lockout of all the uplink interfaces from the ESXi host can occur. To prevent this type of lockout, BPDU Filter can be enabled on the ESXi host to drop any BPDU packets being sent to the physical switch. The caveat is that certain SSL VPN which use Windows bridging capability can legitimately generate BPDU packets. The administrator should verify that there are no legitimate BPDU packets generated by virtual machines on the ESXi host prior to enabling BPDU Filter.  If BPDU Filter is enabled in this situation, enabling Reject Forged Transmits on the virtual switch port group adds protection against Spanning Tree loops."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|enable-bpdu-filter,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : enable-portfast"
  info        : "Since VMware virtual switches do not support STP, the ESXi host-connected physical switch ports must have portfast configured if spanning tree is enabled to avoid loops within the physical switch network. If these are not set, potential performance and connectivity issues might arise."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|enable-portfast,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-mgmt-network-airgap"
  info        : "The vSphere management network provides access to the vSphere management interface of each vSphere component. Services running on the management interface provide an opportunity for an attacker to gain privileged access to virtual machines data running in vSphere. Remote attacks would prioritize getting access to this network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.3.1,VMWare-ID|isolate-mgmt-network-airgap,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-mgmt-network-vlan"
  info        : "The vSphere management network provides access to the vSphere management interface on each component. Services running on the management interface provide an opportunity for an attacker to gain privileged access to the systems. Any remote attack most likely would begin with gaining entry to this network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.3.1,VMWare-ID|isolate-mgmt-network-vlan,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-storage-network-airgap"
  info        : "Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes iSCSI and NFS.  This type of configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. To restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network should be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from the VMkernel management and service console network will limit unauthorized users from viewing the traffic."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-storage-network-airgap,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-storage-network-vlan"
  info        : "Virtual machines might share virtual switches and VLANs with the IP-based storage configurations. IP-based storage includes iSCSI and NFS.  This type of configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network. To restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network should be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from the VMkernel management and service console network will limit unauthorized users from viewing the traffic."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-storage-network-vlan,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-vmotion-network-airgap"
  info        : "The security issue with vMotion migrations is that information is transmitted in plain text, and anyone with access to the network over which this information flows can view it. Potential attackers can intercept vMotion traffic to obtain memory contents of a virtual machine. They might also potentially stage a MiTM attack in which the contents are modified during migration. Ensure that vMotion traffic is separate from production traffic on an isolated network. This network should be nonroutable (no layer-3 router spanning this and other networks), which will prevent any outside access to the network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-vmotion-network-airgap,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : isolate-vmotion-network-vlan"
  info        : "The security issue with vMotion migrations is that information is transmitted in plain text, and anyone with access to the network over which this information flows can view it. Potential attackers can intercept vMotion traffic to obtain memory contents of a virtual machine. They might also potentially stage a MiTM attack in which the contents are modified during migration. Ensure that vMotion traffic is separate from production traffic on an isolated network. This network should be nonroutable (no layer-3 router spanning this and other networks), which will prevent any outside access to the network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-vmotion-network-vlan,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : label-portgroups"
  info        : "A network label identifies each port group with a name. These names are important because they serve as a functional descriptor for the port group. Without these descriptions, identifying port groups and their functions becomes difficult as the network becomes more complex."
  reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|1.1.2,VMWare-ID|label-portgroups,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:spec/audit:name\"/>)<xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> (portgroup name NOT found)</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : ".+ \\("
  not_expect  : "(portgroup name NOT found)"
</custom_item>

<report type:"WARNING">
  description : "vNetwork : label-vswitches"
  info        : "Virtual switches within the ESXi Server require a field for the name of the switch. This label is important because it serves as a functional descriptor for the switch, just as physical switches require a host name. Labeling virtual switches will indicate the function or the IP subnet of the virtual switch."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|label-vswitches,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : limit-administrator-scope"
  info        : "This control mitigates the risk of misconfiguration, whether accidental or malicious, and enforces key security concepts of separation of duties and least privilege. It is important to leverage the role-based access controls within vSphere to ensure that only authorized administrators have access to the different virtual networking components. For example, VM administrators should have access only to port groups in which their VMs reside. Network administrators should have permissions to all virtual networking components but not have access to VMs. These controls will depend very much on the organization's policy on separation of duties, least privilege, and the responsibilities of the administrators within the organization."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|limit-administrator-scope,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : limit-network-healthcheck"
  info        : "Network Healthcheck is disabled by default. Once enabled, the healthcheck packets contain information on host#, vds# port#, which an attacker would find useful. It is recommended that network healthcheck be used for troubleshooting, and turned off when troubleshooting is finished."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|limit-network-healthcheck,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : no-native-vlan-1"
  info        : "ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up as belonging to native VLAN of the physical switch. For example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a '1'; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a '1' instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged). If the ESXi virtual switch port group uses the native VLAN ID, traffic from those VMs will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|no-native-vlan-1,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : no-reserved-vlans"
  info        : "Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001-1024 and 4094, while Nexus switches typically reserve 3968-4047 and 4094. Check with the documentation for your specific switch. Using a reserved VLAN might result in a denial of service on the network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|no-reserved-vlans,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : no-unused-dvports"
  info        : "The number of ports available on a vdSwitch distributed port group can be adjusted to exactly match the number of virtual machine vNICs that need to be assigned to that dvPortgroup. Limiting the number of ports to just what is needed limits the potential for an administrator, either accidentally or maliciously, to move a virtual machine to an unauthorized network. This is especially relevant if the management network is on a dvPortgroup, because it could help prevent someone from putting a rogue virtual machine on this network."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|no-unused-dvports,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : no-vgt-vlan-4095"
  info        : "When a port group is set to VLAN 4095, this activates VGT mode. In this mode, the vSwitch passes all network frames to the guest VM without modifying the VLAN tags, leaving it up to the guest to deal with them. VLAN 4095 should be used only if the guest has been specifically configured to manage VLAN tags itself."
#reference		: "VMWare-ID|no-vgt-vlan-4095,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3,PCI-DSS|2.2.3"
#see_also          : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:spec/audit:name\"/>) - vlanId = <xsl:value-of select=\"audit:spec/audit:vlanId\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - vlanId = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "vlanId ="
  not_expect  : "vlanId = 4095$"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,SWIFT-CSCv1|2.3"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-forged-transmit - 'vSwitch'"
  info        : "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-forged-transmit,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:name\"/>) - forgedTransmits = <xsl:value-of select=\"audit:spec/audit:policy/audit:security/audit:forgedTransmits\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - forgedTransmits = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "forgedTransmits ="
  expect      : "forgedTransmits = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-forged-transmit - 'PortGroup'"
  info        : "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the virtual switch does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-forged-transmit,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:spec/audit:name\"/>) - forgedTransmits = <xsl:value-of select=\"audit:computedPolicy/audit:security/audit:forgedTransmits\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - forgedTransmits = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "forgedTransmits ="
  expect      : "forgedTransmits = False$"
</custom_item>

<report type:"WARNING">
  description : "vNetwork : reject-forged-transmit-dvportgroup"
  info        : "If the virtual machine operating system changes the MAC address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. Forged transmissions should be set to accept by default. This means the  dvPortgroup does not compare the source and effective MAC addresses. To protect against MAC address impersonation, all virtual switches should have forged transmissions set to reject."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|reject-forged-transmit-dvportgroup,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : reject-mac-change-dvportgroup"
  info        : "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address. It will affect applications that require this functionality. An example of an application like this is Microsoft Clustering, which requires systems to effectively share a MAC address. This will also affect how a layer 2 bridge will operate. This will also affect applications that require a specific MAC address for licensing. An exception should be made for the  dvPortgroups that these applications are connected to."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|reject-mac-change-dvportgroup,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-mac-changes - 'vSwitch'"
  info        : "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-mac-changes,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:name\"/>) - macChanges = <xsl:value-of select=\"audit:spec/audit:policy/audit:security/audit:macChanges\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - macChanges = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "macChanges ="
  expect      : "macChanges = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-mac-changes - 'PortGroup'"
  info        : "If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network. This will prevent VMs from changing their effective MAC address."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-mac-changes,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:spec/audit:name\"/>) - macChanges = <xsl:value-of select=\"audit:computedPolicy/audit:security/audit:macChanges\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - macChanges = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "macChanges ="
  expect      : "macChanges = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-promiscuous-mode - 'vSwitch'"
  info        : "When promiscuous mode is enabled for a virtual switch all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that dvPort group. Promiscuous mode is disabled by default on the ESX Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-promiscuous-mode,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:vswitch\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:name\"/>) - allowPromiscuous = <xsl:value-of select=\"audit:spec/audit:policy/audit:security/audit:allowPromiscuous\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - allowPromiscuous = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "allowPromiscuous ="
  expect      : "allowPromiscuous = False$"
</custom_item>

<custom_item>
  type        : AUDIT_ESX
  description : "vNetwork : reject-promiscuous-mode - 'PortGroup'"
  info        : "When promiscuous mode is enabled for a virtual switch all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that dvPort group. Promiscuous mode is disabled by default on the ESX Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons."
  reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.3,VMWare-ID|reject-promiscuous-mode,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:for-each select=\"audit:propSet/audit:val[@xsi:type='HostConfigInfo']/audit:network/audit:portgroup\">"
  xsl_stmt    : "<xsl:value-of select=\"../../../../audit:propSet[audit:name='name']/audit:val\"/> (<xsl:value-of select=\"audit:spec/audit:name\"/>) - allowPromiscuous = <xsl:value-of select=\"audit:computedPolicy/audit:security/audit:allowPromiscuous\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/><xsl:text> - allowPromiscuous = NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "allowPromiscuous ="
  expect      : "allowPromiscuous = False$"
</custom_item>

<report type:"WARNING">
  description : "vNetwork : reject-promiscuous-mode-dvportgroup"
  info        : "When promiscuous mode is enabled for a dvPortgroup, all virtual machines connected to the dvPortgroup have the potential of reading all packets across that network, meaning only the virtual machines connected to that  dvPortgroup. Promiscuous mode is disabled by default on the ESXI Server, and this is the recommended setting. However, there might be a legitimate reason to enable it for debugging, monitoring or troubleshooting reasons. Security devices might require the ability to see all packets on a vSwitch.  An exception should be made for the dvPortgroups that these applications are connected to, in order to allow for full-time visibility to the traffic on that dvPortgroup."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|reject-promiscuous-mode-dvportgroup,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : restrict-mgmt-network-access-gateway"
  info        : "The management network should be protected at the security level of the most secure virtual machine running on a host/cluster. If an attacker gains access to the management network, it provides the staging ground for further attack. No matter how the management network is restricted, there will always be a need for administrators to access this network to configure VMware vCenter Server and the VMware ESX/ESXi hosts. Instead of allowing client systems on this network, there are ways to enable access to management functionality in a strictly controlled manner."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|restrict-mgmt-network-access-gateway,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : restrict-mgmt-network-access-jumpbox"
  info        : "The management network should be protected at the security level of the most secure virtual machine running on a host/cluster. If an attacker gains access to the management network, it provides the staging ground for further attack. No matter how the management network is restricted, there will always be a need for administrators to access this network to configure VMware vCenter Server and the VMware ESX/ESXi hosts. Instead of allowing client systems on this network, there are ways to enable access to management functionality in a strictly controlled manner."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|restrict-mgmt-network-access-jumpbox,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : restrict-netflow-usage"
  info        : "The vSphere VDS can export Netflow information about traffic crossing the VDS. Netflow exports are not encrypted and can contain information about the virtual network making it easier for  a MITM attack to be executed succesfully.  If Netflow export is required, verify that all VDS Netflow target IP's are correct."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|restrict-netflow-usage,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : restrict-port-level-overrides"
  info        : "Port-level configuration over-rides are disabled by default. Once enabled, this allows for different security settings to be set from what is established at the Port-Group level. There are cases where particular VM's require unique configurations, but this should be monitored so it is only used when authorized.  If over-rides are not monitored, anyone who gains access to  a VM with a less secure VDS configuration could surreptiously exploit that broader access."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|restrict-port-level-overrides,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : restrict-portmirror-usage"
  info        : "The vSphere VDS can mirror traffic from one port to another in order to allow for packet capture devices to collect specific traffic flows. Port mirroring will send a copy of all traffic specified in un-encrypted format. This mirrored traffic contains the full data in the packets captured and can result in total compromise of that data if misdirected.  If Port Mirroring is required, verify that all Port Mirror Destination VLAN, Port and Uplink ID's are correct."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|restrict-portmirror-usage,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : set-non-negotiate"
  info        : "In order to communicate with virtual switches in VST mode, external switch ports must be configured as trunk ports. VST mode does not support Dynamic Trunking Protocol (DTP), so the trunk must be static and unconditional. The auto or desirable physical switch settings do not work with the ESXi Server because the physical switch communicates with the ESXi Server using DTP. The non-negotiate and on options unconditionally enable VLAN trunking on the physical switch and create a VLAN trunk link between the ESXi Server and the physical switch. The difference between non-negotiate and on options is that on mode still sends out DTP frames, whereas the non-negotiate option does not.  The non-negotiate option should be used for all VLAN trunks, to minimize unnecessary network traffic for virtual switches in VST mode."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|set-non-negotiate,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : upstream-bpdu-stp"
  info        : "In the scenario where the ESXi host has a guest VM that is configured to perform bridging function, the VM will generate BPDU frames and send out to the VDS. The VDS then forwards the BPDU frames through the network adapter to the physical switch port. When the switch port configured with 'BPDU guard' receives the BPDU frame, the switch disables the port and the VM loses connectivity. To avoid this network failure scenario while running software-bridging function on an ESXI host, customers should disable the 'portfast' and 'BPDU guard' configuration on the port and run the spanning tree protocol."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|upstream-bpdu-stp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : verify-vlan-id"
  info        : "When defining a physical switch port for trunk mode, care must be taken to ensure that only specified VLANs are configured. It is considered best practice to restrict only those VLANs required on the VLAN trunk link. The risk with not fully documenting all VLANs on the vSwitch is that it is possible that a physical trunk port might be configured without needed VLANs, or with unneeded VLANs, potentially enabling an administrator to either accidentally or maliciously connect a VM to an unauthorized VLAN."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|verify-vlan-id,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vNetwork : verify-vlan-trunk"
  info        : "When connecting a virtual switch to a VLAN trunk port, you must be careful to properly configure both the virtual switch and the physical switch at the uplink port. If the physical switch is not properly configured, frames with the VLAN 802.1q header would be forwarded to a switch not expecting their arrival. The vSphere administrator should always ensure that virtual switch uplinks, acting as VLAN trunk links, are connected only to physical switch ports that function as trunk links. Misconfiguration of the physical switch ports might lead to undesirable performance, including frames being dropped or misdirected."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.2,VMWare-ID|verify-vlan-trunk,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# vCenter Server

<report type:"WARNING">
  description : "vCenter : apply-os-patches"
  info        : "By staying up to date on Windows patches, vulnerabilities in the OS can be mitigated. If an attacker can obtain access and elevate privileges on the vCenter Server system, they can then take over the entire vSphere deployment."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|apply-os-patches,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : block-unused-ports"
  info        : "Blocking unneeded ports can militate against general attacks on the Windows system.  A local firewall on the Windows system of vCenter, or a network firewall, can be used to block access to ports not specifically being used by vCenter. Here is a partial list of examples of where ports might be blocked: (636/TCP) If the vCenter will not be part of a linked-mode vCenter group; (1521/TCP) If the vCenter DB is not Oracle."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|block-unused-ports,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : change-default-password"
  info        : "During installation of the VCSA, the default password is not changed. This must be done manually."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.1,VMWare-ID|change-default-password,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : check-privilege-reassignment"
  info        : "During a restart of vCenter Server, if the user or user group that is assigned Administrator Role on the root folder could not be verified as a valid user/group during the restart, the user/group's permission as Administrator will be removed.  In its place, vCenter Server grants the Administrator role to the local Windows administrators group, to act as a new vCenter Server administrator. Since it is not recommended to grant vCenter Server Administrator rights to Windows Administrators, this results in a situation that should be rectified by re-establishing a legitimate administrator account."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,PCI-DSS|7.2.2,VMWare-ID|check-privilege-reassignment,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<custom_item>
  type        : AUDIT_ESX
  description : "vCenter : config-ntp"
  info        : "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal Time-UTC), you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files.  Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate. In addition incorrect time settings can introduce login issues with SSO as all SSO component rely on coordinated time."
  info        : "NOTE: Update NTP_SERVER to the appropriate value for the local environment."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4.1,PCI-DSS|10.4.3,VMWare-ID|config-ntp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//audit:returnval\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"audit:propSet/audit:val/audit:dateTimeInfo/audit:ntpConfig/audit:server\">"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - NTP Server : <xsl:value-of select=\"audit:propSet/audit:val/audit:dateTimeInfo/audit:ntpConfig/audit:server\"/><xsl:text>&#10;</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:value-of select=\"audit:propSet[audit:name='name']/audit:val\"/> - <xsl:text>NTP Server : NOT found</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "NTP Server : "
# Note: Variable @NTP_SERVER@ replaced with "0\\.us\\.pool\\.ntp\\.org" in field "expect".
  expect      : "NTP Server : 0\\.us\\.pool\\.ntp\\.org$"
</custom_item>

<report type:"WARNING">
  description : "vCenter : disable-datastore-web"
  info        : "The datastore Web browser enables you to view all the datastores associated with the vSphere deployment, including all folders and files contained in them, such as VM files. This is governed by the users permissions on vCenter Server. In some cases, you might want to disable the datastore browser to eliminate the risk of having an open interface that is not being used."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|disable-datastore-web,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : disable-mob"
  info        : "The managed object browser provides a way to explore the object model used by the vCenter to manage the vSphere environment; it enables configurations to be changed as well. This interface is used primarily for debugging the vSphere SDK. This interface might potentially be used to perform malicious configuration changes or actions."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|disable-mob,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : install-with-service-account"
  info        : "You can use the Microsoft Windows built-in system account or a domain user account to run vCenter Server.  The Microsoft Windows built-in system account has more permissions and rights on the server than the vCenter Server system requires, which can contribute to security problems. With a domain user account, you can enable Windows authentication for SQL Server; it also allows more granular security and logging. The installing account only needs to be a member of the Administrators group, and have permission to act as part of the operating system and log on as a service. If you are using SQL Server for the vCenter database, you must configure the SQL Server database to allow the domain account access to SQL Server."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|install-with-service-account,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : limit-user-login"
  info        : "After someone has logged in to the vCenter Server system, it becomes more difficult to prevent what they can do. In general, logging in to the vCenter Server system should be limited to very privileged administrators, and then only for the purpose of administering vCenter Server or the host OS. Anyone logged in to the vCenter Server can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes. They also have potential access to vCenter credentials, such as the SSL certificate."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.4,VMWare-ID|limit-user-login,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : monitor-admin-assignment"
  info        : "Monitor that administrative users are only assigned privileges they require. Least Privilege requires that these privileges should only be assigned if needed, to reduce risk of confidentiality, availability or integrity loss. At an interval suitable to industry best practices or your organization's standards, verify in vCenter Server using the vSphere Client: 1. That a non-guest access role was created without these privileges. 2. This role is assigned to users who need administrator privileges excluding those allowing file and program interaction within the guests."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.1,VMWare-ID|monitor-admin-assignment,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : monitor-certificate-access"
  info        : "The directory that contains the SSL certificates only needs to be accessed by the service account user on a regular basis. Occasionally, the vCenter Server system administrator might need to access it for support purposes.  The SSL certificate can be used to impersonate vCenter and decrypt the vCenter database password."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.3,VMWare-ID|monitor-certificate-access,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : no-self-signed-certs"
  info        : "Self-signed certificates are automatically generated by vCenter Server during the installation process, are not signed by a commercial CA, and might not provide strong security. Replace default self-signed certificates with those from a trusted certification authority, either a commercial CA or an organizational CA. The use of default certificates leaves the SSL connection open to MiTM attacks. Changing the default certificates to trusted CA-signed certificates mitigates the potential for MiTM attacks."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.1,VMWare-ID|no-self-signed-certs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : remove-expired-certificates"
  info        : "If expired certificates are not removed from the vCenter Server, the user can be subject to a MiTM attack, which potentially might enable compromise through impersonation with the user's credentials to the vCenter Server system."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.5,VMWare-ID|remove-expired-certificates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : remove-failed-install-logs"
  info        : "In certain cases, if the vCenter installation fails, a log file (with a name of the form 'hs_err_pidXXXX') is created that contains the database password in plain text. An attacker who breaks into the vCenter Server  could potentially steal this password and access the vCenter Database."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|10.5.2,VMWare-ID|remove-failed-install-logs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : remove-revoked-certificates"
  info        : "If revoked certificates are not removed from the vCenter Server, the user can be subject to a MiTM attack, which potentially might enable compromise through impersonation with the user's credentials to the vCenter Server system."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.5,VMWare-ID|remove-revoked-certificates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-admin-privilege"
  info        : "By default, vCenter Server grants full administrative rights to the local administrator's account, which can be accessed by domain administrators. Separation of duties dictates that full vSphere administrative rights should be granted only to those administrators who are required to have it. This privilege should not be granted to any group whose membership is not strictly controlled. Therefore, administrative rights should be removed from the local Windows administrator account and instead be given to a special-purpose local vSphere administrator account. This account should be used to create individual user accounts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|restrict-admin-privilege,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-admin-role"
  info        : "By default, vCenter Server grants full administrative rights to the local administrator's account, which can be accessed by domain administrators. Separation of duties dictates that full vSphere administrative rights should be granted only to those administrators who are required to have it. This privilege should not be granted to any group whose membership is not strictly controlled. Therefore, administrative rights should be removed from the local Windows administrator account and instead be given to a special-purpose local vSphere administrator account. This account should be used to create individual user accounts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|restrict-admin-role,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-certificate-access"
  info        : "The SSL certificate can be used to impersonate vCenter and decrypt the vCenter database password. By default, only the service user account and the vCenter Server administrators can access the directory containing the SSL certificates. The directory that contains the SSL certificates only needs to be accessed by the service account user on a regular basis. Occasionally, when collecting data for support purposes, the vCenter Server system administrator might need to access it. The permissions should be checked on a regular basis to ensure they have not been changed to add unauthorized users."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.3,VMWare-ID|restrict-certificate-access,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-datastore-web"
  info        : "The datastore browser functionality either through the Web browser or the Client UI's  allows users with proper permissionsview/upload/download access to all the files on datastores associated with the vSphere deployment. Folders and files such as virtual disk files can contain sensitive data. This is governed by the users permissions on vCenter Server.To prevent data from being accessed by the wrong users, verify that all users permissions in vCenter only allow access to those datastore objects they are authorized to view."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|restrict-datastore-web,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-guest-control"
  info        : "By default, vCenter Server 'Administrator' role allows users to interact with files and programs inside a virtual machine's guest operating system, which can lessen Guest data confidentiality, availability or integrity. Least Privilege requires that this privilege should not be granted to any users who are not authorized. A non-guest access administrator role should be created with these privileges removed. This role would allow administrator privileges excluding those allowing file and program interaction within the guests."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.2.2,VMWare-ID|restrict-guest-control,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-Linux-clients"
  info        : "Although SSL-based encryption is used to protect communication between client components and vCenter Server or ESXi, the Linux versions of these components do not perform certificate validation. Even if you have replaced the self-signed certificates on vCenter and ESXi with legitimate certificates signed by your local root certificate authority or a third party, communications with Linux clients are still vulnerable to MiTM attacks. With proper controls, this restriction can be relaxed if deemed appropriate."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|restrict-Linux-clients,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-network-access"
  info        : "Restrict access to only those essential components required to communicate with vCenter. Blocking access by unnecessary systems reduces the potential for general attacks on the operating system. Restricting access to only those essential components required to communicate with vCenter, minimizes risk."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|restrict-network-access,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : restrict-vcs-db-user"
  info        : "vCenter requires only certain specific privileges on the database. Furthermore, certain privileges are required only for installation and upgrade, and can be removed during normal operation. These privileges should be added again if another upgrade must be performed. Least privileges mitigates attacks if the vCenter database account is compromised."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|restrict-vcs-db-user,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : secure-vcenter-os"
  info        : "By providing OS-level protection, vulnerabilities in the OS can be mitigated. This protection includes antivirus, antimalware, and similar measures. If an attacker can obtain access and elevate privileges on the vCenter Server system, they can then take over the entire vSphere deployment."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|secure-vcenter-os,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : secure-vco-file-access"
  info        : "VCO installation directories on the vCenter Server contain authentication information for plugins. If compromised, these can be used in a spoofing attack getting access to the plug-in functionality."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.1,VMWare-ID|secure-vco-file-access,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : thick-client-timeout"
  info        : "You can set an inactivity timeout for the vSphere Client (Thick client).  This client-side setting can be changed by the user, so this must be set by default and re-audited for.  Closing sessions automatically reduces the potential for unauthorized access to vCenter, minimizing risk."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|thick-client-timeout,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : use-supported-system"
  info        : "vCenter Server resides on a Windows-based operating system and therefore requires a supported version of Windows. If vCenter is not running on a supported OS, it might not run properly. An attacker might be able to take advantage of this to perform a DoS attack or worse."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|use-supported-system,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : verify-client-plugins"
  info        : "vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, Web-based functionality. vSphere Client plugins or extensions run at the same privilege level as the user logged in. A malicious extension might masquerade as something useful but then do harmful things such as stealing credentials or misconfiguring the system."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|verify-client-plugins,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : Verify-RDP-encryption"
  info        : "When using RDP to connect to a Windows host, there are a number of different encryption levels that can be used. The default settings of 'Client Compatible' may not be strong enough."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|Verify-RDP-encryption,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : verify-ssl-certificates"
  info        : "Without certificate verification, the user can be subject to a MiTM attack, which potentially might enable compromise through impersonation with the user's credentials to the vCenter Server system. When connecting to vCenter Server using vSphere Client, the client checks to see if the certificate being presented can be verified by a trusted third party. If it cannot be, the user is presented with a warning and the option to ignore this check. This warning should not be ignored; if an administrator is presented with this warning, they should inquire further about it before proceeding."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.7,VMWare-ID|verify-ssl-certificates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "vCenter : use-service-accounts"
  info        : " In order to not violate non-repudiation (ie: deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they should use unique service acccounts."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "VMWare-ID|use-service-accounts,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# VUM Checks

<report type:"WARNING">
  description : "VUM : audit-vum-login"
  info        : "After someone has logged in to the Update Manager system, it becomes more difficult to prevent what they can do. In general, logging in to the Update Manager system should be limited to very privileged administrators, and then only for the purpose of administering Update Manager or the host OS. Anyone logged in to the Update Manager can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|10.6,VMWare-ID|audit-vum-login,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : isolate-vum-airgap"
  info        : "In a typical deployment, Update Manager connects to public patch repositories on the Internet to download patches. This connection should be limited as much as possible to prevent access from the outside to the Update Manager system. Any channel to the Internet represents a threat."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-vum-airgap,VMWare-Profile|1"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : isolate-vum-proxy"
  info        : "In a typical deployment, Update Manager connects to public patch repositories on the Internet to download patches. This connection should be limited as much as possible to prevent access from the outside to the Update Manager system. Any channel to the Internet represents a threat."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-vum-proxy,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : isolate-vum-webserver"
  info        : "In a typical deployment, Update Manager connects to public patch repositories on the Internet to download patches. This connection should be limited as much as possible to prevent access from the outside to the Update Manager system. Any channel to the Internet represents a threat."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.3,VMWare-ID|isolate-vum-webserver,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : limit-vum-users"
  info        : "After someone has logged in to the Update Manager system, it becomes more difficult to prevent what they can do. In general, logging in to the Update Manager system should be limited to very privileged administrators, and then only for the purpose of administering Update Manager or the host OS. Anyone logged in to the Update Manager can potentially cause harm, either intentionally or unintentionally, by altering settings and modifying processes."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|8.1,VMWare-ID|limit-vum-users,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : no-vum-self-management"
  info        : "Although you can install both Update Manager and vCenter Server on VMs and place them on the same ESXi host, you should not configure Update Manager to manage the updates on those VMs. Upon scanning and remediation, the virtual machine on which Update Manager and vCenter Server are installed can reboot and the whole deployment system will shut down."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.2,VMWare-ID|no-vum-self-management,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : no-vum-self-signed-certs"
  info        : "Self-signed certificates are automatically generated by Update Manager during the installation process, are not signed by a commercial CA, and might not provide strong security. Replace default self-signed certificates with those from a trusted certification authority, either a commercial CA or an organizational CA. The use of default certificates leaves the SSL connection open to MiTM attacks. Changing the default certificates to trusted CA-signed certificates mitigates the potential for MiTM attacks."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.1,VMWare-ID|no-vum-self-signed-certs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : patch-vum-os"
  info        : "By staying up to date on Windows patches, vulnerabilities in the OS can be mitigated. If an attacker can obtain access and elevate privileges on the Update Manager system, it can compromise the patching process."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|patch-vum-os,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : restrict-vum-db-user"
  info        : "Update Manager requires certain privileges on its database user in order to install, and the installer automatically checks for these. These are documented in the VMware Update Manager Administration Guide. However, after installation, only a small number of privileges are required for operation. The privileges on the VUM database user can be reduced during normal operation. These privileges should be added again if an upgrade or uninstall must be performed. Least privileges mitigates attacks if the Update Manager database account is compromised."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|restrict-vum-db-user,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VUM : secure-vum-os"
  info        : "By providing OS-level protection, vulnerabilities in the OS can be mitigated. This protection includes antivirus, antimalware, and similar measures. If an attacker can obtain access and elevate privileges on the vCenter Server system, they can then take over the entire vSphere deployment."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.1,VMWare-ID|secure-vum-os,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# SSO

<report type:"WARNING">
  description : "SSO : check-SSO-Password-expiration"
  info        : "The default SSO password policy has a password lifetime of 365 days. After 365 days, the password is expired and the ability to log is compromised. The applies to ALL SSO accounts, both Administrative and User. (there is not separate policy for both groups). Ensure the admin accounts are not about to expire."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|8.5.9,VMWare-ID|check-SSO-Password-expiration,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "SSO : check-SSO-Password-policy"
  info        : "The default SSO password policy has a password lifetime of 365 days. After 365 days, the password is expired and the ability to log is compromised. The applies to ALL SSO accounts, both Administrative and User. (there is not separate policy for both groups). Ensure the policies in SSO match local policies for password management and complexity."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|check-SSO-Password-policy,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "SSO : config-ntp"
  info        : "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal Time-UTC), you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files.  Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate. In addition incorrect time settings can introduce login issues with SSO as all SSO component rely on coordinated time."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|10.4.1,PCI-DSS|10.4.3,VMWare-ID|config-ntp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "SSO : no-SSO-self-signed-certs"
  info        : "Self-signed certificates are automatically generated by SSO during the installation process, are not signed by a commercial CA, and might not provide strong security. Replace default self-signed certificates with those from a trusted certification authority, either a commercial CA or an organizational CA. The use of default certificates leaves the SSL connection open to MiTM attacks. Changing the default certificates to trusted CA-signed certificates mitigates the potential for MiTM attacks."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.1,VMWare-ID|no-SSO-self-signed-certs,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "SSO : restrict-sso-db-user"
  info        : "SSO requires certain privileges on its database user in order to install, and the installer automatically checks for these. These are documented in the VMware Update Manager Administration Guide. However, after installation, only a small number of privileges are required for operation. The privileges on the SSO database user can be reduced during normal operation. These privileges should be added again if an upgrade or uninstall must be performed. Least privileges mitigates attacks if the SSO database account is compromised. There is currently no way to restrict AD users from logging in, even if they can't do anything."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|7.1.2,VMWare-ID|restrict-sso-db-user,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "SSO : SSO-DB-password-recorded"
  info        : "If the SSO DB password is not recorded during installation, the ability to recover the SSO database is compromised."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|8.2,VMWare-ID|SSO-DB-password-recorded,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# WebClient

<report type:"WARNING">
  description : "WebClient : verify-ssl-certificates"
  info        : "Without certificate verification, the user can be subject to a MiTM attack, which potentially might enable compromise through impersonation with the user's credentials to the vCenter Server system. When connecting to vCenter Server using vSphere Client, the client checks to see if the certificate being presented can be verified by a trusted third party. If it cannot be, the user is presented with a warning and the option to ignore this check. This warning should not be ignored; if an administrator is presented with this warning, they should inquire further about it before proceeding."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|3.6.7,VMWare-ID|verify-ssl-certificates,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "WebClient : web-client-timeout"
  info        : "You can set an inactivity timeout for the vSphere Client (web client).  This server-side setting can be changed by the admin.  Closing sessions automatically reduces the potential for unauthorized access to vCenter, minimizing risk."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|2.2.3,VMWare-ID|web-client-timeout,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

# VCSA

<report type:"WARNING">
  description : "VCSA : change-default-password"
  info        : "During installation of the VCSA, the default password is not changed. This must be done manually."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|6.3.1,VMWare-ID|change-default-password,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VCSA : config-ntp"
  info        : "By ensuring that all systems use the same relative time source (including the relevant localization offset), and that the relative time source can be correlated to an agreed-upon time standard (such as Coordinated Universal Time-UTC), you can make it simpler to track and correlate an intruder's actions when reviewing the relevant log files.  Incorrect time settings can make it difficult to inspect and correlate log files to detect attacks, and can make auditing inaccurate. In addition incorrect time settings can introduce login issues with SSO as all SSO component rely on coordinated time."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|10.4.3,VMWare-ID|config-ntp,VMWare-Profile|1,VMWare-Profile|2,VMWare-Profile|3"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

<report type:"WARNING">
  description : "VCSA : restrict-network-access"
  info        : "Restrict access to only those essential components required to communicate with vCenter. Blocking access by unnecessary systems reduces the potential for general attacks on the operating system. Restricting access to only those essential components required to communicate with vCenter, minimizes risk."
  info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "PCI-DSS|1.1.1,VMWare-ID|restrict-network-access,VMWare-Profile|1,VMWare-Profile|2"
  see_also    : "https://www.vmware.com/files/xls/hardeningguide-vsphere5-5-ga-released.xlsx"
</report>

</check_type>
