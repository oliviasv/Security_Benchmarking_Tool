#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.25 $
# $Date: 2020/04/22 $
# #
# Description: This  document consists of a list of checks
#              required by Payment Card Industry Data
#        Security Standard (PCI DSS) Version 3.0. Tenable has made
#        a best effort to map the settings specified in
#        the standard to a proprietary .audit format that
#        will be used by the Windows compliance module to
#        perform the audit.
#
# See Also :
# https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf
#
#<ui_metadata>
#<display_name>PCI DSS 3.0 - Microsoft Windows</display_name>
#<spec>
#  <type>PCI DSS</type>
#  <name>Windows Windows</name>
#  <version>3.0.0</version>
#  <link>https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf</link>
#</spec>
#<labels>windows,pci_3,pci_3.0</labels>
#<variables>
#  <variable>
#    <name>ADMIN_ACCT</name>
#    <default>myadmin</default>
#    <description>Rename Administrator Account</description>
#    <info>The administrator account should be renamed to a less well known value</info>
#  </variable>
#  <variable>
#    <name>GUEST_ACCT</name>
#    <default>myguest</default>
#    <description>Rename Guest Account</description>
#    <info>The guest account should be renamed to a less well known value</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Tenable PCI Windows Audit file">

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 1.4 Installing personal firewall software on any mobile and employee-owned computers with direct connectivity to the Internet - Firewall"
  info        : "Check if Windows firewall is enabled. Portable computing devices that are allowed to connect to the Internet from outside the corporate firewall are more vulnerable to Internet-based threats. Use of a personal firewall helps to protect devices from Internet-based attacks, which could use the device to gain access the organization's systems and data once the device is re-connected to the network. The specific firewall configuration settings are determined by the organization.

  NOTE: The intent of this requirement applies to employee-owned and company-owned computers. Systems that cannot be managed by corporate policy introduce weaknesses to the perimeter and provide opportunities that malicious individuals may exploit. Allowing untrusted systems to connect to an organization's network could result in access being granted to attackers and other malicious users."
  reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS-3.0|1.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile"
  reg_item    : "EnableFirewall"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Alerter Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Alerter"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service AppMgr Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "AppMgr"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Appmon Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Appmon"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service BINLSVC Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "BINLSVC"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service CiSvc Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "CiSvc"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service ClipSrv Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "ClipSrv"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service FAX Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "FAX"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service helpsvc Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "helpsvc"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service HTTPFilter Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "HTTPFilter"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service IISADMIN Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "IISADMIN"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service LicenseService Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "LicenseService"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service MacFile Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "MacFile"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service MacPrint Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "MacPrint"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Messenger Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Messenger"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service mnmsrvc Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "mnmsrvc"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service MSFtpsvc Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "MSFtpsvc"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Netman Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Netman"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Ntfrs Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Ntfrs"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service NWCWorkstation Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "NWCWorkstation"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Pop3Svc Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Pop3Svc"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service RasAuto Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "RasAuto"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service RasMan Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "RasMan"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service RDSessMgr Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "RDSessMgr"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service RemoteRegistry Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "RemoteRegistry"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Remote_Storage_Server Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Remote_Storage_Server"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Remote_Storage_User_Link Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Remote_Storage_User_Link"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service RpcLocator Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "RpcLocator"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service SMTPSVC Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "SMTPSVC"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service SNMP Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "SNMP"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service SNMPTRAP Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "SNMPTRAP"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service Spooler Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "Spooler"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service srvcsurg Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "srvcsurg"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service TapiSrv Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "TapiSrv"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service TermService Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "TermService"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service TFTPD Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "TFTPD"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service TlntSvr Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "TlntSvr"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service W3SVC Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "W3SVC"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type         : SERVICE_POLICY
  description  : "PCI 2.2.2 Disable all unnecessary and insecure services and protocols, Service WZCSVC Disabled"
  info         : "As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled."
  reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS-3.0|2.2.2,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : SERVICE_SET
  value_data   : "Disabled"
  service_name : "WZCSVC"
  svc_option   : CAN_BE_NULL
</custom_item>

<custom_item>
  type            : PASSWORD_POLICY
  description     : "PCI 2.2.4 Configure system security parameters to prevent misuse - Minimum Password Age: 1 day"
  info            : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference       : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSS-3.0|2.2.4,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also        : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type      : TIME_DAY
  value_data      : [1..MAX]
  password_policy : MINIMUM_PASSWORD_AGE
</custom_item>

<custom_item>
  type        : ANONYMOUS_SID_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Network Access: Allow Anonymous SID/Name Translation: Disabled"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.1.7,800-171|3.5.3,800-53|AC-6,800-53|IA-2,CSCv6|13,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|IA-2,NESA|T5.4.2,PCI-DSS-3.0|2.2.4,SWIFT-CSCv1|1.2"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Disabled"
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Network Access: Do not allow Anonymous Enumeration of SAM Accounts"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.1.7,800-53|AC-6,CSCv6|16,CSF|PR.AC-4,PCI-DSS-3.0|2.2.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Control\Lsa"
  reg_item    : "RestrictAnonymousSAM"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Network Access: Do not allow Anonymous Enumeration of Accounts and Shares"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each ty0pe of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.1.7,800-53|AC-6,CSCv6|16,CSF|PR.AC-4,PCI-DSS-3.0|2.2.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Control\Lsa"
  reg_item    : "RestrictAnonymous"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type         : CHECK_ACCOUNT
  description  : "PCI 2.2.4 Configure system security parameters to prevent misuse - Accounts: Guest Account Status: Disabled"
  info         : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference    : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS-3.0|2.2.4"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : POLICY_SET
  value_data   : "Disabled"
  account_type : GUEST_ACCOUNT
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Accounts: Limit local account use of blank passwords to console logon"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,CSCv6|16,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSS-3.0|2.2.4,SWIFT-CSCv1|4.1"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Control\Lsa"
  reg_item    : "LimitBlankPasswordUse"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type         : CHECK_ACCOUNT
  description  : "PCI 2.2.4 Configure system security parameters to prevent misuse - Accounts: Rename Administrator Account: non-standard"
  info         : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference    : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS-3.0|2.2.4"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : POLICY_TEXT
# Note: Variable @ADMIN_ACCT@ replaced with "myadmin" in field "value_data".
  value_data   : "myadmin"
  account_type : ADMINISTRATOR_ACCOUNT
</custom_item>

<custom_item>
  type         : CHECK_ACCOUNT
  description  : "PCI 2.2.4 Configure system security parameters to prevent misuse - Accounts: Rename Guest Account: non-standard"
  info         : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference    : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS-3.0|2.2.4"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : POLICY_TEXT
# Note: Variable @GUEST_ACCT@ replaced with "myguest" in field "value_data".
  value_data   : "myguest"
  account_type : GUEST_ACCOUNT
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Audit: Shut Down system immediately if unable to log security alerts"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-53|AU-5,CSCv6|6,CSF|PR.PT-1,ITSG-33|AU-5,PCI-DSS-3.0|2.2.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Control\Lsa"
  reg_item    : "CrashOnAuditFail"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Devices: Allowed to format and eject removable media: Administrators"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|MP-2,CSCv6|8.3,CSF|PR.PT-2,ITSG-33|MP-2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,PCI-DSS-3.0|2.2.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : DASD_SET
  value_data  : "Administrators"
  reg_key     : "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
  reg_item    : "AllocateDasd"
  reg_type    : REG_SZ_DECIMAL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 2.2.4 Configure system security parameters to prevent misuse - Devices: Prevent users from installing printer drivers: Enabled"
  info        : "System configuration standards and related processes should specifically address security settings and parameters that have known security implications for each type of system in use. In order for systems to be configured securely, personnel responsible for configuration and/or administering systems must be knowledgeable in the specific security parameters and settings that apply to the system."
  reference   : "800-171|3.1.7,800-53|AC-6,CSCv6|5.1,CSF|PR.AC-4,PCI-DSS-3.0|2.2.4"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers"
  reg_item    : "AddPrinterDrivers"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type         : AUDIT_POLICY
  description  : "PCI 8.1.2 Control addition, deletion, and modification of user IDs, credentials, and other identifier objects - Audit Account Management"
  info         : "To ensure that user accounts granted access to systems are all valid and recognized users, strong processes must manage all changes to user IDs and other authentication credentials, including adding new ones and modifying or deleting existing ones."
  reference    : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS-3.0|8.1.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : AUDIT_SET
  value_data   : "Success, Failure"
  audit_policy : AUDIT_ACCOUNT_MANAGER
</custom_item>

<custom_item>
  type        : AUDIT_USER_TIMESTAMPS
  description : "PCI 8.1.4 Users not logged in past 7 or more days."
  reference   : "800-53|AC-2,CIP|004-6-R5,CN-L3|7.1.3.2(e),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2,NIAv2|AM26,PCI-DSS-3.0|8.1.4,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4"
  value_type  : POLICY_DAY
  value_data  : "7"
  timestamp   : "LogonTime"
  check_type  : CHECK_GREATER_THAN_OR_EQUAL
</custom_item>

<custom_item>
  type        : AUDIT_USER_TIMESTAMPS
  description : "PCI 8.1.4 Users logged off 30 days ago."
  reference   : "800-53|AC-2,CIP|004-6-R5,CN-L3|7.1.3.2(e),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2,NIAv2|AM26,PCI-DSS-3.0|8.1.4,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4"
  value_type  : POLICY_DAY
  value_data  : "30"
  timestamp   : "LogoffTime"
  check_type  : CHECK_GREATER_THAN_OR_EQUAL
</custom_item>

<custom_item>
  type          : AUDIT_USER_TIMESTAMPS
  description   : "PCI 8.1.4 Users KickedOff more than a week ago"
  reference     : "800-53|AC-2,CIP|004-6-R5,CN-L3|7.1.3.2(e),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2,NIAv2|AM26,PCI-DSS-3.0|8.1.4,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4"
  value_type    : POLICY_DAY
  value_data    : "7"
  include_users : "password never expires" || "cannot change password" || "Disabled"
  timestamp     : "KickoffTime"
  check_type    : CHECK_GREATER_THAN_OR_EQUAL
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "Test the Lockout Threshold"
      value_type      : POLICY_TEXT
      value_data      : "[Ll]ockout threshold:[\s]*[1-9][\d]*"
      powershell_args : "net accounts | findstr /c:'Lockout threshold'"
      check_type      : CHECK_REGEX
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type           : LOCKOUT_POLICY
      description    : "PCI 8.1.6 Limit repeated access attempts by locking out the user ID after not more than six attempts"
      info           : "Without account-lockout mechanisms in place, an attacker can continually attempt to guess a password through manual or automated tools (for example, password cracking), until they achieve success and gain access to a user's account."
      reference      : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,PCI-DSS-3.0|8.1.6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also       : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
      value_type     : POLICY_DWORD
      value_data     : [1..6]
      lockout_policy : LOCKOUT_THRESHOLD
    </custom_item>

    <custom_item>
      type           : LOCKOUT_POLICY
      description    : "PCI 8.1.7 Set the lockout duration to thirty minutes"
      info           : "If an account is locked out due to someone continually trying to guess a password, controls to delay reactivation of these locked accounts stops the malicious individual from continually guessing the password (they will have to stop for a minimum of 30 minutes until the account is reactivated). Additionally, if reactivation must be requested, the admin or help desk can validate that it is the actual account owner requesting reactivation."
      reference      : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,PCI-DSS-3.0|8.1.7,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also       : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
      value_type     : TIME_MINUTE
      value_data     : [30..MAX]
      lockout_policy : LOCKOUT_DURATION
    </custom_item>
  </then>

  <else>
    <report type:"FAILED">
      description : "PCI 8.1.6 Limit repeated access attempts by locking out the user ID after not more than six attempts"
      info        : "The Lockout threshold is set to 'Never' which also sets the 'Lockout duration (minutes)' & 'Lockout observation window (minutes)' to a default value of 30. Both the checks for the Lockout threshold (8.1.6) and Lockout duration (8.1.7) a marked as failed.

      Review the password policies and set to appropriate levels.
      PCI recommends 'Lockout threshold' to be set to a value between 1 - 6.

      Without account-lockout mechanisms in place, an attacker can continually attempt to guess a password through manual or automated tools (for example, password cracking), until they achieve success and gain access to a user's account."
      reference   : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,PCI-DSS-3.0|8.1.6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
    </report>

    <report type:"FAILED">
      description : "PCI 8.1.7 Set the lockout duration to thirty minutes"
      info        : "The Lockout threshold is set to 'Never' which also sets the 'Lockout duration (minutes)' & 'Lockout observation window (minutes)' to a default value of 30. Both the checks for the Lockout threshold (8.1.6) and Lockout duration (8.1.7) a marked as failed.

      Review the password policies and set to appropriate levels.
      PCI recommends 'Lockout duration' to be set to a value greater than 29.

      If an account is locked out due to someone continually trying to guess a password, controls to delay reactivation of these locked accounts stops the malicious individual from continually guessing the password (they will have to stop for a minimum of 30 minutes until the account is reactivated). Additionally, if reactivation must be requested, the admin or help desk can validate that it is the actual account owner requesting reactivation."
      reference   : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,PCI-DSS-3.0|8.1.7,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
    </report>
  </else>
</if>

<custom_item>
  type            : PASSWORD_POLICY
  description     : "PCI 8.2.3 Require a minimum password length of at least seven characters"
  info            : "This requirement specifies that a minimum of seven characters and both numeric and alphabetic characters should be used for passwords/phrases. For cases where this minimum cannot be met due to technical limitations, entities can use 'equivalent strength' to evaluate their alternative. NIST SP 800-63-1 defines 'entropy' as 'a measure of the difficulty of guessing or determining a password or key.' This document and others that discuss 'password entropy' can be referred to for more information on applicable entropy value and for understanding equivalent password strength variability for passwords/phrases of different formats."
  reference       : "800-171|3.5.7,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),COBIT5|APO07.01,COBIT5|APO07.02,COBIT5|APO07.03,COBIT5|APO07.04,COBIT5|APO07.05,CSCv6|16.2,CSCv6|16.5,CSCv6|5.7,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSS-3.0|8.2.3,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
  see_also        : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type      : POLICY_DWORD
  value_data      : [7..MAX]
  password_policy : MINIMUM_PASSWORD_LENGTH
</custom_item>

<custom_item>
  type            : PASSWORD_POLICY
  description     : "PCI 8.2.4 Change user passwords at least every 90 days"
  info            : "Passwords/phrases that are valid for a long time without a change provide malicious individuals with more time to work on breaking the password/phrase."
  reference       : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSS-3.0|8.2.4,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
  see_also        : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type      : TIME_DAY
  value_data      : [MIN..90]
  password_policy : MAXIMUM_PASSWORD_AGE
</custom_item>

<custom_item>
  type            : PASSWORD_POLICY
  description     : "PCI 8.2.5 Configure system security parameters to prevent misuse - Password History: 4 passwords remembered"
  info            : "If password history isn't maintained, the effectiveness of changing passwords is reduced, as previous passwords can be reused over and over. Requiring that passwords cannot be reused for a period of time reduces the likelihood that passwords that have been guessed or brute-forced will be used in the future."
  reference       : "800-171|3.5.8,800-53|IA-5,CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM22c,PCI-DSS-3.0|8.2.5,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
  see_also        : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type      : POLICY_DWORD
  value_data      : [4..MAX]
  password_policy : ENFORCE_PASSWORD_HISTORY
</custom_item>

<custom_item>
  type         : AUDIT_POLICY
  description  : "PCI 10.2.2 All actions taken by any individual with root or administrative privileges - Audit Logon Events: Success and Failure"
  info         : "Accounts with increased privileges, such as the 'administrator' or 'root' account, have the potential to greatly impact the security or operational functionality of a system. Without a log of the activities performed, an organization is unable to trace any issues resulting from an administrative mistake or misuse of privilege back to the specific action and individual."
  reference    : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS-3.0|10.2.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : AUDIT_SET
  value_data   : "Success, Failure"
  audit_policy : AUDIT_LOGON
</custom_item>

<custom_item>
  type         : AUDIT_POLICY
  description  : "PCI 10.2.2 All actions taken by any individual with root or administrative privileges - Audit Account Logon Events: Success and Failure"
  info         : "Accounts with increased privileges, such as the 'administrator' or 'root' account, have the potential to greatly impact the security or operational functionality of a system. Without a log of the activities performed, an organization is unable to trace any issues resulting from an administrative mistake or misuse of privilege back to the specific action and individual."
  reference    : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS-3.0|10.2.2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : AUDIT_SET
  value_data   : "Success, Failure"
  audit_policy : AUDIT_ACCOUNT_LOGON
</custom_item>

<custom_item>
  type         : AUDIT_POLICY
  description  : "PCI 10.2.7 Creation and deletion of system-level objects - Audit Object Access: Success and Failure"
  info         : "Malicious software, such as malware, often creates or replaces system level objects on the target system in order to control a particular function or operation on that system. By logging when system-level objects, such as database tables or stored procedures, are created or deleted, it will be easier to determine whether such modifications were authorized."
  reference    : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS-3.0|10.2.7,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  see_also     : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type   : AUDIT_SET
  value_data   : "Success, Failure"
  audit_policy : AUDIT_OBJECT_ACCESS
</custom_item>

<custom_item>
  type            : KERBEROS_POLICY
  description     : "PCI 10.4 Synchronize all critical system clocks and times - Maximum tolerance for computer clock synchronization"
  info            : "Time synchronization technology is used to synchronize clocks on multiple systems. When clocks are not properly synchronized, it can be difficult, if not impossible, to compare log files from different systems and establish an exact sequence of event (crucial for forensic analysis in the event of a breach). For post-incident forensics teams, the accuracy and consistency of time across all systems and the time of each activity is critical in determining how the systems were compromised."
  reference       : "800-171|3.3.7,800-53|AU-8,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSS-3.0|10.4,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4"
  see_also        : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type      : TIME_MINUTE
  value_data      : [1..5]
  kerberos_policy : CLOCK_SYNCHRONIZATION_TOLERANCE
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.5.1 Limit viewing of audit trails to those with a job-related need - Application Log Restrict Guest Access: Enabled"
  info        : "Adequate protection of the audit logs includes strong access control (limit access to logs based on 'need to know' only), and use of physical or network segregation to make the logs harder to find and modify. Promptly backing up the logs to a centralized log server or media that is difficult to alter keeps the logs protected even if the system generating the logs becomes compromised."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,PCI-DSS-3.0|10.5.1,SWIFT-CSCv1|5.1"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application"
  reg_item    : "RestrictGuestAccess"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.5.1 Limit viewing of audit trails to those with a job-related need - Security Log Restrict Guest Access: Enabled"
  info        : "Adequate protection of the audit logs includes strong access control (limit access to logs based on 'need to know' only), and use of physical or network segregation to make the logs harder to find and modify. Promptly backing up the logs to a centralized log server or media that is difficult to alter keeps the logs protected even if the system generating the logs becomes compromised."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,PCI-DSS-3.0|10.5.1,SWIFT-CSCv1|5.1"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security"
  reg_item    : "RestrictGuestAccess"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.5.1 Limit viewing of audit trails to those with a job-related need -  System Log Restrict Guest Access: Enabled"
  info        : "Adequate protection of the audit logs includes strong access control (limit access to logs based on 'need to know' only), and use of physical or network segregation to make the logs harder to find and modify. Promptly backing up the logs to a centralized log server or media that is difficult to alter keeps the logs protected even if the system generating the logs becomes compromised."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,PCI-DSS-3.0|10.5.1,SWIFT-CSCv1|5.1"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_SET
  value_data  : "Enabled"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System"
  reg_item    : "RestrictGuestAccess"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retain application log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_DAY
  value_data  : [365..MAX]
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retain security log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_DAY
  value_data  : [365..MAX]
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retain system log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : POLICY_DAY
  value_data  : [365..MAX]
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retention method for application log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : EVENT_METHOD
  value_data  : "By days"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Application"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retention method for security log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : EVENT_METHOD
  value_data  : "By days"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\Security"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "PCI 10.7 Retain audit trail history for at least one year - Retention method for system log"
  info        : "Retaining logs for at least a year allows for the fact that it often takes a while to notice that a compromise has occurred or is occurring, and allows investigators sufficient log history to better determine the length of time of a potential breach and potential system(s) impacted. By having three months of logs immediately available, an entity can quickly identify and minimize impact of a data breach. Storing logs in off-line locations could prevent them from being readily available, resulting in longer time frames to restore log data, perform analysis, and identify impacted systems or data."
  reference   : "800-53|AU-11,CIP|007-6-R4,CSCv6|6.3,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSS-3.0|10.7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
  see_also    : "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3.pdf"
  value_type  : EVENT_METHOD
  value_data  : "By days"
  reg_key     : "HKLM\SYSTEM\CurrentControlSet\Services\Eventlog\System"
  reg_item    : "Retention"
  reg_type    : REG_DWORD
</custom_item>

</group_policy>
</check_type>
