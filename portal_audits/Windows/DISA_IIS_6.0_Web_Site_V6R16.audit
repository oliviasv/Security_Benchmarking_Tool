#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.4 $
# $Date: 2020/04/22 $
#
# Description	: This .audit is designed against the DISA Web IIS6 Site Checklist V6R16, 24 Jul 2015.
# 	  http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip
#
#<ui_metadata>
#<display_name>DISA STIG IIS 6.0 Site Checklist v6r16</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>IIS 6.0 Site Checklist</name>
#  <version>6.16.0</version>
#  <link>http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip</link>
#</spec>
#<labels>windows,disa,internet,information,server,iis,iis_6,site</labels>
#<variables>
#  <variable>
#    <name>SITE_LOG_DIR</name>
#    <default>C:\inetpub\logs\LogFiles</default>
#    <description>Site Log Directory</description>
#    <info>The full path to the directory for the site's log files</info>
#  </variable>
#  <variable>
#    <name>LOG_DIR</name>
#    <default>C:\inetpub\logs\LogFiles</default>
#    <description>IIS Server Log Directory</description>
#    <info>The full path to the directory for IIS log files.</info>
#  </variable>
#  <variable>
#    <name>ANONYMOUS_ACCOUNT</name>
#    <default>IUSR</default>
#    <description>Anonymous account</description>
#    <info>The name of the account used for anonymous access.</info>
#  </variable>
#  <variable>
#    <name>CONTENT_DIR</name>
#    <default>C:\inetpub\wwwroot</default>
#    <description>Content directory</description>
#    <info>The full path to the directory for site web content.</info>
#  </variable>
#  <variable>
#    <name>CGI_DIR</name>
#    <default>C:\inetpub\wwwroot\cgi-bin</default>
#    <description>CGI directory</description>
#    <info>The full path to the directory for CGI web content.</info>
#  </variable>
#  <variable>
#    <name>PERL_SCRIPT</name>
#    <default>C:\inetpub\wwwroot\scripts\file.pl</default>
#    <description>PERL Script Location</description>
#    <info>The full path to the perl script to be tested</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"DISA Web IIS 6 Site Checklist">

<file_acl:"WG410">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read & execute" | "read" | "list folder contents"
  </user>
</file_acl>

<file_acl:"WG250">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "list folder contents"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read & execute" | "read" | "list folder contents"
  </user>

  <user:"Auditors">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG290">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

# Note: Variable @ANONYMOUS_ACCOUNT@ replaced with "IUSR" in field "<user".
  <user:"IUSR">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read & execute" | "read" | "list folder contents"
  </user>
</file_acl>

<file_acl:"WG430">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read & execute" | "read" | "list folder contents"
  </user>

  <user:"AnonymousFTPUsers">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG255">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "list folder contents"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read & execute" | "read" | "list folder contents"
  </user>

  <user:"Auditors">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<report type:"PASSED">
  description : "DISA Web IIS 6 Site Checklist Version 6 Release 16"
</report>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG210 IIS6 - Web content directories must not be anonymously shared."
  info                 : "Anonymously shared directories are exposed to unnecessary risk. Any unnecessary exposure increases the risk that an intruder could exploit the access and compromise the web content or cause web server performance problems.

  NOTE: Review the found shares and ensure the web content directories are not being shared.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "Remove the shares from the applicable directories."
  reference            : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38048r2_rule,STIG-ID|WG210_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2226"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : '(get-wmiobject -namespace root\\cimv2 -class Win32_Share) | Where {$_.path -ne \\"IPC$\\" -and $_.path -ne \\"ADMIN$\\"} | select Name,Path | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'Execute Permissions set 'Script only'"
  info        : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference   : "8500.2|ECLP-1,CAT|II,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'Enable Parent Paths set to False'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.13.13,800-53|SC-18,8500.2|ECLP-1,CAT|II,CSF|DE.CM-5,ITSG-33|SC-18,NIAv2|NS26a,NIAv2|NS26d,NIAv2|SU3,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 0
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name, AspEnableParentPaths FROM IIsWebServerSetting"
  wmi_attribute : "AspEnableParentPaths"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'ASP Default Language set to VBScript'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.13.13,800-53|SC-18,8500.2|ECLP-1,CAT|II,CSF|DE.CM-5,ITSG-33|SC-18,NIAv2|NS26a,NIAv2|NS26d,NIAv2|SU3,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_TEXT
  value_data    : "VBScript"
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AspScriptLanguage FROM IisWebServerSetting"
  wmi_attribute : "AspScriptLanguage"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'AspScriptTimeout set to 90 or less'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.1.11,800-53|AC-12,800-53|SC-5,8500.2|ECLP-1,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,CSF|DE.CM-1,CSF|PR.DS-4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [MIN..90]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AspScriptTimeout FROM IisWebServerSetting"
  wmi_attribute : "AspScriptTimeout"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'Virtual Directories - Enable Parent Paths set to False'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.13.13,800-53|SC-18,8500.2|ECLP-1,CAT|II,CSF|DE.CM-5,ITSG-33|SC-18,NIAv2|NS26a,NIAv2|NS26d,NIAv2|SU3,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 0
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name, AspEnableParentPaths FROM IIsWebVirtualDirSetting"
  wmi_attribute : "AspEnableParentPaths"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'Virtual Directories - ASP Default Language set to VBScript'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.13.13,800-53|SC-18,8500.2|ECLP-1,CAT|II,CSF|DE.CM-5,ITSG-33|SC-18,NIAv2|NS26a,NIAv2|NS26d,NIAv2|SU3,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_TEXT
  value_data    : "VBScript"
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AspScriptLanguage FROM IIsWebVirtualDirSetting"
  wmi_attribute : "AspScriptLanguage"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'Virtual Directories - AspScriptTimeout set to 90 or less'"
  info          : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info          : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  solution      : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference     : "800-171|3.1.11,800-53|AC-12,800-53|SC-5,8500.2|ECLP-1,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,CSF|DE.CM-1,CSF|PR.DS-4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,Vuln-ID|V-2229"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [MIN..90]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AspScriptTimeout FROM IIsWebVirtualDirSetting"
  wmi_attribute : "AspScriptTimeout"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG410 IIS6 - Interactive scripts must have proper access controls. - 'CGI Directory Permissions'"
  info        : "CGI is a 'programming standard' for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and Javascript), each having their own unique file extension.

The use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network."
  info        : "NOTE: Manual verification is required in order to determine if the system's Application Setting 'Execute Permission' is set to 'Script Only'."
  info        : "NOTE: Update CGI_DIR to the appropriate value for the local environment"
  info        : "NOTE: This check should be duplicated if multiple files exist."
  solution    : "1. Set the ownership of the CGI scripts to system, the service account running the web service, the web author, and/or the SA.
2. Set the CGI script permissions for the anonymous web user account to Read or Read/Execute.
3. Set the Application settings sections Execute permissions to Scripts only.
4. Uncheck the Enable parent paths check box."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-28848r1_rule,STIG-ID|WG410_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2229"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG410"
# Note: Variable @CGI_DIR@ replaced with "C:\\inetpub\\wwwroot\\cgi-bin" in field "file".
  file        : "C:\\inetpub\\wwwroot\\cgi-bin"
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG420 IIS6 - Backup interactive scripts must be removed from the web site."
  info              : "Copies of backup files will not execute on the server, but they can be read by the anonymous user if special precautions are not taken. Such backup copies contain the same sensitive information as the actual script being executed and, as such, are useful to malicious users. Techniques and systems exist today that search web servers for such files and are able to exploit the information contained in them."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  info              : "NOTE: If there is nothing reported in the plugin output then Nessus did not find any backup files on the system."
  solution          : "Remove the backup scripts from the web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|III,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38084r1_rule,STIG-ID|WG420_IIS6,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2230"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : 'get-childitem -recurse c:\\ -include *.bak,*.old,.*.temp,*.tmp,*.backup,\\"copy of*\\" -erroraction silentlycontinue|select FullName | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG110 IIS6 - Web sites must limit the number of simultaneous requests."
  info          : "Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a web site, which can facilitate a Denial of Service attack. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests per IP address and may include, where feasible, limiting parameter values associated with keepalive."
  solution      : "1. Open the Internet Information Services Manager.
2. Right click on the web site for review > Select properties > Select the performance tab.
3. Under web site connections select the Connections limited to radio button and enter the desired number of simultaneous connections."
  reference     : "800-53|AC-10,8500.2|ECSC-1,CAT|II,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-29997r1_rule,STIG-ID|WG110_IIS6,Vuln-ID|V-2240"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : -1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxConnections FROM IisWebServerSetting"
  wmi_attribute : "MaxConnections"
  wmi_key       : "Name"
  check_type    : CHECK_NOT_EQUAL
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG170 IIS6 - Each readable web document directory must contain a default, home, index or equivalent file. - 'EnableDefaultDoc set to True'"
  info          : "The goal is to control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server's directory structure by locating directories with default pages. This practice helps ensure the anonymous web user will not obtain directory browsing information or an error message revealing the server type and version."
  solution      : "Add a default document to the applicable directories or disable directory browsing."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECAN-1,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30002r1_rule,STIG-ID|WG170_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2245"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,EnableDefaultDoc FROM IisWebServerSetting"
  wmi_attribute : "EnableDefaultDoc"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG170 IIS6 - Each readable web document directory must contain a default, home, index or equivalent file. - 'DefaultDoc'"
  info                 : "The goal is to control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server's directory structure by locating directories with default pages. This practice helps ensure the anonymous web user will not obtain directory browsing information or an error message revealing the server type and version.

  NOTE: Review each website's default documents list to ensure each site contains a default document.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "Add a default document to the applicable directories or disable directory browsing."
  reference            : "800-171|3.4.2,800-53|CM-6,8500.2|ECAN-1,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30002r1_rule,STIG-ID|WG170_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2245"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IisWebServerSetting | select Name,DefaultDoc | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "WG240 IIS6 - Logs of web server access and errors must be established and maintained."
  info        : "A major tool in exploring the web site use, attempted use, unusual conditions, and problems are reported in the access and error logs. In the event of a security incident, these logs can provide the SA and the Web Manager with valuable information.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Open the Internet Information Services Manager.
2. Right click on the web site being reviewed > Select properties > Select the Web Site tab.
3. Check the Enable logging check box.
4. Select the Home Directory Tab.
5. Check the Log visits check box.
6. Select OK."
  reference   : "8500.2|ECAT-1,8500.2|ECAT-2,CAT|II,Rule-ID|SV-38065r1_rule,STIG-ID|WG240_IIS6,Vuln-ID|V-2250"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG250 IIS6 - Users other than Auditors group must not have greater than read access to log files."
  info        : "A major tool in exploring the web site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the Web Manager with valuable information. To ensure the integrity of the log files and protect the SA and Web Manager from a conflict of interest related to the maintenance of these files, only the members of the Auditors group will be granted permissions to move, copy, and delete these files in the course of their duties related to the archiving of these files."
  info        : "NOTE: Update SITE_LOG_DIR to the appropriate value for the local environment"
  solution    : "Ensure only the System, Administrators, and Auditors group has greater than read permission to the log files."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECTP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30017r1_rule,STIG-ID|WG250_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2252"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG250"
# Note: Variable @SITE_LOG_DIR@ replaced with "C:\\inetpub\\logs\\LogFiles" in field "file".
  file        : "C:\\inetpub\\logs\\LogFiles"
</custom_item>

<report type:"WARNING">
  description : "WG260 IIS6 - Only fully reviewed and tested web sites must exist on a production web server."
  info        : "In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development web site. The process of developing on a functional production web site entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files revealing business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security, which is totally avoidable.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure any pages in development are not installed on a production web server."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-38069r2_rule,STIG-ID|WG260_IIS6,Vuln-ID|V-2254"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG290 IIS6 - The web client account access to the content and scripts directories must be limited to read and execute."
  info        : "Excessive permissions for the anonymous web user account are one of the most common faults contributing to the compromise of a web server. If this user is able to upload and execute files on the web server, the organization or owner of the server will no longer have control of the asset."
  info        : "NOTE: Update ANONYMOUS_ACCOUNT and CONTENT_DIR with the appropriate values for the local environment."
  solution    : "Disable Script source access, Write, and Directory browsing permissions on the web site, its sub-directories (including virtual directories), and files.

Limit the anonymous account permissions to read & execute or less for the local paths (including their content)."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECLP-1,CAT|I,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30020r1_rule,STIG-ID|WG290_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2258"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG290"
# Note: Variable @CONTENT_DIR@ replaced with "C:\\inetpub\\wwwroot" in field "file".
  file        : "C:\\inetpub\\wwwroot"
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WG310 IIS6 - A web site must not contain a robots.txt file."
  info            : "Search engines are constantly at work on the Internet.  Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web-site content.  In turn, these search engines make the content they obtain and catalog available to any public web user.

To request that a well behaved search engine not crawl and catalog a site, the web site may contain a file called robots.txt.  This file contains directories and files that the web server SA desires not be crawled or cataloged, but this file can also be used, by an attacker or poorly coded search engine, as a directory and file index to a site.  This information may be used to reduce an attacker's time searching and traversing the web site to find files that might be relevant.  If information on the web site needs to be protected from search engines and public view, other methods must be used."
  solution        : "1. Open the IIS Manager > click on the web site being reviewed.
2. In the right hand pane look for a file named robots.txt.
3. Delete the robots.txt file.

NOTE: If there is information on the web site that needs protection from search engines and public view, then other methods must be used to safeguard the data."
  reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-28797r2_rule,STIG-ID|WG310_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2260"
  see_also        : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "WARNING"
  powershell_args : '& $Env:SystemRoot/System32/InetSrv/appcmd.exe list vdirs /text:physicalPath | Foreach { if (Test-Path ($_+\\"\\robots.txt\\") ) { \\"WARNING: robots.txt exist in \\" + $_ } else { \\"No robots.txt in \\" + $_ } }'
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'SSL Enabled'"
  info          : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution      : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSL FROM IisWebServerSetting"
  wmi_attribute : "AccessSSL"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG340 IIS6 - A private web server must utilize an approved TLS version. - '128-Bit Encryption Enabled'"
  info          : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution      : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSL128 FROM IisWebServerSetting"
  wmi_attribute : "AccessSSL128"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'PCT 1.0\Client'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECSC-1,CAT|II,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Pct 1.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'PCT 1.0\Server'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Pct 1.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'SSL 2.0\Client'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 2.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'SSL 2.0\Server'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 2.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'SSL 3.0\Client'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 3.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'SSL 3.0\Server'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 3.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'TLS 1.0\Client'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Tls 1.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG340 IIS6 - A private web server must utilize an approved TLS version. - 'TLS 1.0\Server'"
  info        : "Transport Layer Security (TLS) encryption is a required security setting for a private web server.  Encryption of private information is essential to ensuring data confidentiality.  If private information is not encrypted, it can be intercepted and easily read by an unauthorized party.  A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > right click on the website to be examined > select properties > select the Directory Security tab > select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28468r2_rule,STIG-ID|WG340_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-2262"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Tls 1.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_BE_NULL
</custom_item>

<report type:"WARNING">
  description : "WG350 IIS6 - A private web server must have a valid server certificate."
  info        : "This check verifies the server certificate is actually a DoD-issued certificate used by the organization being reviewed. This is used to verify the authenticity of the web site to the user. If the certificate is not issued by the DoD or if the certificate has expired, then there is no assurance that the use of the certificate is valid. The entire purpose of using a certificate is, therefore, compromised.

  NOTE: Nessus Plugin 'SSL Certificate Information' (ID 10863) will output the certificate information if the plugin is enabled in the policy.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the private web site to use a valid DoD certificate."
  reference   : "8500.2|IATS-1,8500.2|IATS-2,CAT|II,Rule-ID|SV-38080r1_rule,STIG-ID|WG350_IIS6,Vuln-ID|V-2263"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG490 IIS6 - Java software installed on the web server must be limited to class files and the JAVA virtual machine."
  info              : "From the source code in a .java or a .jpp file, the Java compiler produces a binary file with an extension of .class. The .java or .jpp file would, therefore, reveal sensitive information regarding an application's logic and permissions to resources on the server. By contrast, the .class file, because it is intended to be machine independent, is referred to as bytecode. Bytecodes are run by the Java Virtual Machine (JVM), or the Java Runtime Environment (JRE), via a browser configured to permit Java code."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  info              : "NOTE: If there is nothing reported in the plugin output then Nessus did not find any backup files on the system."
  solution          : "Remove all files from the web server with the following extensions: .java and .jpp."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|III,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38118r1_rule,STIG-ID|WG490_IIS6,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2265"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include *.java,*.jpp -erroraction silentlycontinue|select FullName | format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - 'Server Side Includes Disallowed'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(get-wmiobject -namespace "root\\microsoftiisv2" -class iiswebservicesetting).websvcextrestrictionlist | where {$_.description -eq \\"Server Side Includes\\" } | select access | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - 'Internet Data Connector Disallowed'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(get-wmiobject -namespace "root\\microsoftiisv2" -class iiswebservicesetting).websvcextrestrictionlist | where {$_.description -eq \\"Internet Data Connector\\" } | select access | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - 'Index Server Web Interface Disallowed'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(get-wmiobject -namespace "root\\microsoftiisv2" -class iiswebservicesetting).websvcextrestrictionlist | where {$_.description -eq \\"Index Server Web Interface\\"} | select access | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - '.HTR scripting Disallowed'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(get-wmiobject -namespace "root\\microsoftiisv2" -class iiswebservicesetting).websvcextrestrictionlist | where {$_.description -eq \\".HTR scripting\\" } | select access | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - '.bat mappings'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|I,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServiceSetting).scriptmaps | where {$_.extensions -eq \\".bat\\"} | select ScriptProcessor | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - '.cmd mappings'"
  info              : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll."
  solution          : "Remove unused and vulnerable script mappings."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|I,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2267"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "Access : 0"
  powershell_args   : '(Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServiceSetting).scriptmaps | where {$_.extensions -eq \\".cmd\\"}| select ScriptProcessor | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WA000-WI050 IIS6 - Unused and vulnerable script mappings in IIS 6 must be removed. - 'Allowed Web Service Extensions'"
  info                 : "IIS file extensions which require server-side processing, but which have been deemed vulnerable, include .htr, .htw, .ida, .idc, .idq, .printer, .shtml, .shtm, .bat, .cmd and .stm. Requests to these file types can exploit a stack buffer overflow weakness in the ism.dll, httpodbc.dll, and ssinc.dll.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "Remove unused and vulnerable script mappings."
  reference            : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16145r2_rule,STIG-ID|WA000-WI050_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2267"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : '(get-wmiobject -namespace "root\\microsoftiisv2" -class iiswebservicesetting).websvcextrestrictionlist | where {$_.access -eq \\"1\\" } | select description,filepath | format-list'
  only_show_cmd_output : YES
  powershell_option    : CAN_BE_NULL
  severity             : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - '.asa'"
  info            : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  solution        : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference       : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also        : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "ScriptProcessor : C:\WINDOWS\system32\inetsrv\asp.dll"
  powershell_args : '(Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServiceSetting).scriptmaps | where {$_.extensions -eq \\".asa\\"}| select ScriptProcessor | format-list'
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - '.asax'"
  info            : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  solution        : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference       : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also        : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "ScriptProcessor : C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\aspnet_isapi.dll"
  powershell_args : '(Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServiceSetting).scriptmaps | where {$_.extensions -eq \\".asax\\"}| select ScriptProcessor | format-list'
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - '.inc'"
  info              : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  solution          : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference         : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "ScriptProcessor : C:\WINDOWS\system32\inetsrv\asp.dll"
  powershell_args   : '(Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServiceSetting).scriptmaps | where {$_.extensions -eq \\".inc\\"}| select ScriptProcessor | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - 'global.asa'"
  info              : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  info              : "NOTE: If there is nothing reported in the plugin output then Nessus did not find any files named global.asa."
  info              : "NOTE: If the global.asa was found, review the permissions to ensure IUSR_machinename does not have read access and these extensions are mapped to the asp.dll."
  solution          : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference         : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : 'get-childitem -recurse c:\\ -include global.asa -erroraction silentlycontinue|get-acl | %{$_.access}| where {$_.FileSystemRights -match \\"read\\" -and $_.IdentityReference -match \\"IUSR_*\\"} | select IdentityReference,FileSystemRights | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - 'global.asax'"
  info              : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  info              : "NOTE: If there is nothing reported in the plugin output then Nessus did not find any files named global.asa."
  info              : "NOTE: If the global.asax was found, review the permissions to ensure IUSR_machinename does not have read access and these extensions are mapped to the asp.dll."
  solution          : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference         : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : 'get-childitem -recurse c:\\ -include global.asax -erroraction silentlycontinue|get-acl | %{$_.access} | where {$_.FileSystemRights -match \\"read\\" -and $_.IdentityReference -match \\"IUSR_*\\"} |select IdentityReference,FileSystemRights | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI030 IIS6 - The IUSR_machinename account must not have read access to the .inc files or their equivalent. - '.inc file permissions'"
  info              : "Owing to the nature of .inc files, which may contain sensitive logic and potentially reveal sensitive information about the architecture of the web server, it is vital that the end user not be able to access and examine code that is included in .inc files. When server side scripting is the preferred method, this is normally not a problem. Nonetheless, there are key files inherent to the process, which can contain information key to the logic, server structure and configuration of the entire application. The include files for many .asp script files are .inc files. If the correct file name is guessed or derived, their contents will be displayed by a browser. The file must be guarded from prying eyes of the anonymous web user. If the site has named their include files with the .asp extension, then the files will be processed as an .asp file, which by the nature of .asp, will prevent that code from being presented. If the files are named with the .inc extension, or equivalent, SAs do not have this advantage.

Java Server Pages, jsp, is another example of a competing technology which the reviewer will also encounter, that are impacted by this issue. The sample principles outlined here will apply to inlcude files used with Java Server Pages.

In addition, there are some additional files that need to be protected, which include the global.asa and global.asax files."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  info              : "NOTE: If there is nothing reported in the plugin output then Nessus did not find any files named global.asa."
  info              : "NOTE: If any .inc files were found review the permissions to ensure IUSR_machinename does not have read access and these extensions are mapped to the asp.dll."
  solution          : "Remove read permissions for the IUSR_machinename account from the .inc files and their equivalent."
  reference         : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38009r1_rule,STIG-ID|WA000-WI030_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-2268"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : 'get-childitem -recurse c:\\ -include *.inc -erroraction silentlycontinue|get-acl | %{$_.access}| where {$_.FileSystemRights -match \\"read\\" -and $_.IdentityReference -match \\"IUSR_*\\"} |select IdentityReference,FileSystemRights | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG430 IIS6 - Anonymous FTP users must not have access to interactive scripts."
  info        : "The directories containing the CGI scripts, such as PERL, must not be accessible to anonymous users via FTP. This applies to all directories containing scripts that can dynamically produce web pages in an interactive manner (i.e., scripts based upon user-provided input). Such scripts contain information that could be used to compromise a web service, access system resources, or deface a web site."
  info        : "NOTE: This check should be duplicated if multiple files/directories exist."
  solution    : "Remove anonymous FTP access from directories where CGI, PERL, ASP, JS, or JSP scripts are located."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38111r1_rule,STIG-ID|WG430_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-2270"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG430"
# Note: Variable @CGI_DIR@ replaced with "C:\\inetpub\\wwwroot\\cgi-bin" in field "file".
  file        : "C:\\inetpub\\wwwroot\\cgi-bin"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WG460 IIS6 - PERL scripts must use the TAINT option."
  info        : "PERL (Practical Extraction and Report Language) is an interpreted language optimized for scanning arbitrary text files, extracting information from those text files, and printing reports based on that information. The language is often used in shell scripting and is intended to be practical, easy to use, and efficient means of generating interactive web pages for the user. Unfortunately, many widely available freeware PERL programs (scripts) are extremely insecure. This is most readily accomplished by a malicious user substituting input to a PERL script during a POST or a GET operation.

Consequently, the founders of PERL have developed a mechanism named TAINT that protects the system from malicious input sent from outside the program. When the data is tainted, it cannot be used in programs or functions such as eval(), system(), exec(), pipes, or popen(). The script will exit with a warning message."
  solution    : "Adjust the PERL scripts to include the appropriate comments enabling the TAINT option."
  reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38114r1_rule,STIG-ID|WG460_IIS6,Vuln-ID|V-2272"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @PERL_SCRIPT@ replaced with "C:\\inetpub\\wwwroot\\scripts\\file.pl" in field "value_data".
  value_data  : "C:\\inetpub\\wwwroot\\scripts\\file.pl"
  regex       : "^([\s\t]*)\#!\/[Uu][Ss][Rr]\/[Ll][Oo][Cc][Aa][Ll]\/[Bb][Ii][Nn]\/[Pp][Ee][Rr][Ll] *\-[Tt] *$"
  expect      : "^([\s\t]*)\#!\/[Uu][Ss][Rr]\/[Ll][Oo][Cc][Aa][Ll]\/[Bb][Ii][Nn]\/[Pp][Ee][Rr][Ll] *\-[Tt] *$"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG205 IIS6 - The web document (home) directory must be on a separate partition from the web servers system files."
  info                 : "Web content is accessible to the anonymous web user. For such an account to have access to system files of any type is a major security risk that is entirely avoidable. To obtain such access is the goal of directory traversal and URL manipulation vulnerabilities. To facilitate such access by mis-configuring the web document (home) directory is a serious error. In addition, having the path on the same drive as the system folder compounds potential attacks such as drive space exhaustion.

  NOTE: Review each site's path to ensure it is not on the same partition as the system files or a child of the web application's directory.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "Change the home directory to a partition other than the partition containing the web server system files."
  reference            : "800-171|3.4.2,800-53|CM-6,8500.2|DCPA-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30041r1_rule,STIG-ID|WG205_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-3333"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IisWebVirtualDirSetting | select Name,Path | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WA000-WI070 IIS6 - Indexing Services must only index web content."
  info              : "The indexing service can be used to facilitate a search function for web sites. Enabling indexing may facilitate a directory traversal exploit and reveal unwanted information to a malicious user. Indexing must be limited to web document directories only."
  info              : "NOTE: If Indexing Service is running, verify only web content directories are being indexed."
  solution          : "Assure that only the web document directories are indexed."
  reference         : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38011r1_rule,STIG-ID|WA000-WI070_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-3963"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : "state : stopped"
  powershell_args   : 'Get-WmiObject -namespace "root\\cimv2" -Class win32_service | where {$_.name -eq \\"cisvc\\"}| select state | format-list'
  powershell_option : CAN_BE_NULL
</custom_item>

<report type:"WARNING">
  description : "WG265 IIS6 - The required DoD banner page must be displayed to authenticated users accessing a DoD private website."
  info        : "A consent banner will be in place to make prospective entrants aware that the website they are about to enter is a DoD web site and their activity is subject to monitoring. The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. The requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present. A manual check of the document root directory for a banner page file (such as banner.html) or navigation to the website via a browser can be used to confirm the information provided from interviewing the web staff.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure a DoD private website to display the required DoD banner page when authentication is required for user access."
  reference   : "8500.2|ECWM-1,CAT|III,Rule-ID|SV-40022r2_rule,STIG-ID|WG265_IIS6,Vuln-ID|V-6373"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type          : WMI_POLICY
  description   : "WG140 IIS6 - A private web sites authentication mechanism must use client certificates. - 'AccessSSL Enabled'"
  info          : "A DoD private web site must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity shall use the identity provided by certificate-based authentication to support access control decisions. Not using client certificates allows an attacker unauthenticated access to private web sites."
  solution      : "1. Open the IIS Manager > Right click on the website being reviewed > Select Properties > Select the Directory Security tab.
2. Under the Secure communications area select the Edit button.
3. Select Require secure channel (SSL) and Require client certificates > Press OK."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|IATS-1,8500.2|IATS-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-30046r1_rule,STIG-ID|WG140_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-6531"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSL FROM IisWebServerSetting"
  wmi_attribute : "AccessSSL"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG140 IIS6 - A private web sites authentication mechanism must use client certificates. - 'AccessSSLRequireCert Enabled'"
  info          : "A DoD private web site must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity shall use the identity provided by certificate-based authentication to support access control decisions. Not using client certificates allows an attacker unauthenticated access to private web sites."
  solution      : "1. Open the IIS Manager > Right click on the website being reviewed > Select Properties > Select the Directory Security tab.
2. Under the Secure communications area select the Edit button.
3. Select Require secure channel (SSL) and Require client certificates > Press OK."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|IATS-1,8500.2|IATS-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-30046r1_rule,STIG-ID|WG140_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-6531"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSLRequireCert FROM IisWebServerSetting"
  wmi_attribute : "AccessSSLRequireCert"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI090 IIS6 - Directory browsing must be disabled."
  info          : "This ensures the directory structure, filenames, and web publishing features are not accessible. Such information and the contents of files listed are normally readable by the anonymous web user, yet are not intended to be viewed as they often contain information relevant to the configuration and security of the web service. The Directory Browsing feature can be used to facilitate a directory traversal and subsequent directory traversal exploits."
  solution      : "1. Open the IIS Manager > Right click on the website under review > Select properties > Select the Home Directory tab.
2. Uncheck the Directory browsing check box.

NOTE:  This procedure should be complete on all Directories (including Sub-Directories) and Virtual Directories within the site."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38016r1_rule,STIG-ID|WA000-WI090_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-6755"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 0
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,EnableDirBrowsing FROM IIsWebServerSetting"
  wmi_attribute : "EnableDirBrowsing"
  wmi_key       : "Name"
</custom_item>

<report type:"WARNING">
  description : "WG355 IIS6 - A private web site must utilize certificates from a trusted DoD CA."
  info        : "The use of a DoD PKI certificate ensures clients that the private web site they are connecting to is legitimate, and is an essential part of the DoD defense-in-depth strategy.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the certificate trust list to trust only DoD-approved PKIs (e.g., DoD PKI, DoD ECA, and DoD-approved external partners)."
  reference   : "8500.2|IATS-1,8500.2|IATS-2,CAT|II,Rule-ID|SV-14206r1_rule,STIG-ID|WG355_IIS6,Vuln-ID|V-13620"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<if>
  <condition type:"OR">
    <custom_item>
      type          : WMI_POLICY
      description   : "WG145 IIS6 - The private web server must use an approved DoD certificate validation process. - 'Check W3SVC/WEBSITES CertCheckMode'"
      value_type    : POLICY_DWORD
      value_data    : 1
      wmi_namespace : "root/MicrosoftIISv2"
      wmi_request   : "SELECT Name,CertCheckMode FROM IisWebServerSetting"
      wmi_attribute : "CertCheckMode"
      wmi_key       : "Name"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "WG145 IIS6 - The private web server must use an approved DoD certificate validation process. - 'Check W3SVC/WEBSITES CertCheckMode'"
      info        : "Without the use of a certificate validation process, the site is vulnerable to accepting expired or revoked certificates.  This would allow unauthorized individuals access to the web server. This also defeats the purpose of the multi-factor authentication provided by the PKI process."
      solution    : "Configure the DoD Private Web Server to conduct certificate revocation checking."
      reference   : "8500.2|IATS-1,8500.2|IATS-2,CAT|II,Rule-ID|SV-28796r1_rule,STIG-ID|WG145_IIS6,Vuln-ID|V-13672"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
    </report>
  </then>

  <else>
    <custom_item>
      type          : WMI_POLICY
      description   : "WG145 IIS6 - The private web server must use an approved DoD certificate validation process. - 'Check W3SVC CertCheckMode'"
      info          : "Without the use of a certificate validation process, the site is vulnerable to accepting expired or revoked certificates.  This would allow unauthorized individuals access to the web server. This also defeats the purpose of the multi-factor authentication provided by the PKI process."
      info          : "NOTE: This check reviews the web service as the web sites do not have 'CertCheckMode' enabled."
      solution      : "Configure the DoD Private Web Server to conduct certificate revocation checking."
      reference     : "800-53|IA-5(2),8500.2|IATS-1,8500.2|IATS-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-28796r1_rule,STIG-ID|WG145_IIS6,Vuln-ID|V-13672"
      see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
      value_type    : POLICY_DWORD
      value_data    : 1
      wmi_namespace : "root/MicrosoftIISv2"
      wmi_request   : "SELECT Name,CertCheckMode FROM IisWebServiceSetting"
      wmi_attribute : "CertCheckMode"
      wmi_key       : "Name"
    </custom_item>
  </else>
</if>

<report type:"WARNING">
  description : "WG235 IIS6 - Web Administrators must secure encrypted connections for Document Root directory uploads."
  info        : "Logging in to a web server via a telnet session or using HTTP or FTP in order to upload documents to the web site is a risk if proper encryption is not utilized to protect the data being transmitted. A secure shell service or HTTPS needs to be installed and in use for these purposes.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Use only secure encrypted logons and connections for uploading files to the web site."
  reference   : "8500.2|EBRP-1,8500.2|EBRU-1,CAT|I,Rule-ID|SV-40028r1_rule,STIG-ID|WG235_IIS6,Vuln-ID|V-13686"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type          : WMI_POLICY
  description   : "WG242 IIS6 - Log file data must contain required data elements. - 'Logging Enabled'"
  info          : "The use of log files is a critical component of the operation of the Information Systems (IS) used within the DoD, and they can provide invaluable assistance with regard to damage assessment, causation, and the recovery of both affected components and data. They may be used to monitor accidental or intentional misuse of the (IS) and may be used by law enforcement for criminal prosecutions. The use of log files is a requirement within the DoD."
  solution      : "1. Open the IIS Manager > Right click on the website being reviewed > Select Properties > Select the Web Site tab.
2. Ensure Enable logging is selected.
3. Select the Properties button > Select the Advance tab.
4. Under the Extended logging options check the following:

Date, Time, Client IP Address, User Name, Method, URI Query, Http Protocol Status and Referrer

5. Select OK."
  reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv6|6.2,CSF|PR.PT-1,ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.1|10.3,PCI-DSSv3.2|10.3,Rule-ID|SV-28653r1_rule,STIG-ID|WG242_IIS6,SWIFT-CSCv1|6.4,Vuln-ID|V-13688"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,LogType FROM IisWebServerSetting"
  wmi_attribute : "LogType"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG242 IIS6 - Log file data must contain required data elements. - 'Logging Properties Set Correctly'"
  info              : "The use of log files is a critical component of the operation of the Information Systems (IS) used within the DoD, and they can provide invaluable assistance with regard to damage assessment, causation, and the recovery of both affected components and data. They may be used to monitor accidental or intentional misuse of the (IS) and may be used by law enforcement for criminal prosecutions. The use of log files is a requirement within the DoD.

  NOTE: Review the found shares and ensure the web content directories are not being shared.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution          : "1. Open the IIS Manager > Right click on the website being reviewed > Select Properties > Select the Web Site tab.
2. Ensure Enable logging is selected.
3. Select the Properties button > Select the Advance tab.
4. Under the Extended logging options check the following:

Date, Time, Client IP Address, User Name, Method, URI Query, Http Protocol Status and Referrer

5. Select OK."
  reference         : "800-171|3.3.1,800-171|3.3.2,800-53|AU-3,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.2.3(a),CN-L3|7.1.2.3(b),CN-L3|7.1.3.3(a),CN-L3|8.1.4.3(b),CSCv6|6.2,CSF|PR.PT-1,ITSG-33|AU-3,NESA|T3.6.2,NIAv2|AM34a,NIAv2|AM34b,NIAv2|AM34c,NIAv2|AM34d,NIAv2|AM34e,NIAv2|AM34f,NIAv2|AM34g,PCI-DSSv3.1|10.3,PCI-DSSv3.2|10.3,Rule-ID|SV-28653r1_rule,STIG-ID|WG242_IIS6,SWIFT-CSCv1|6.4,Vuln-ID|V-13688"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-wmiobject -namespace root\microsoftiisv2 -class iiswebserversetting |where {$_.LogExtFileDate -eq 0 -or $_.LogExtFileClientIp -eq 0 -or $_.LogExtFileUserName -eq 0 -or $_.LogExtFileMethod -eq 0 -or $_.LogExtFileUriQuery -eq 0 -or $_.LogExtFileHttpStatus -eq 0 -or $_.LogExtFileReferer -eq 0} | select Name | format-list"
  powershell_option : CAN_BE_NULL
  severity          : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG255 IIS6 - Access to the web site log files must be restricted."
  info        : "A major tool in exploring the web site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. Failure to protect log files could enable an attacker to modify the log file data or falsify events to mask an attacker's activity."
  solution    : "1. Open the IIS Manager > Right click the website being reviewed > Select Properties > Select the Web Site tab > In the Enable logging box select Properties.
2. Note the path listed under the text Log file directory and the name of the log file beside the text Log file name.
3. Use Explorer to navigate to the log files based on the path and name found in step 2.
4. Right-click on the log file > Select Security.
5. Set the permissions as follows-

- Auditors & System = Full Control
- Administrators & Web Administrators = Read"
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECTP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29398r1_rule,STIG-ID|WG255_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13689"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG255"
# Note: Variable @LOG_DIR@ replaced with "C:\\inetpub\\logs\\LogFiles" in field "file".
  file        : "C:\\inetpub\\logs\\LogFiles"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'SSL Enabled'"
  info          : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution      : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSL FROM IisWebServerSetting"
  wmi_attribute : "AccessSSL"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - '128-Bit Encryption Enabled'"
  info          : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution      : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference     : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSSL128 FROM IisWebServerSetting"
  wmi_attribute : "AccessSSL128"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'PCT 1.0 Client'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Pct 1.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'PCT 1.0 Server'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Pct 1.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'SSL 2.0 Client'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 2.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'SSL 2.0 Server'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 2.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'SSL 3.0 Client'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 3.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'SSL 3.0 Server'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Ssl 3.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'TLS 1.0 Client'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Tls 1.0\Client"
  reg_item    : "Enabled"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG342 IIS6 - Public web servers must use TLS if authentication is required. - 'TLS 1.0 Server'"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Obtain and install a server certificate from a .mil Certificate Authority or approved DoD ECA.
2. Open the IIS Manager > Right click on the website to be examined > Select properties > select the Directory Security tab > Select the Edit button in the Secure communications section.
3. Select Require secure channel (SSL) and Require 128-bit encryption check boxes.
4. Set the version SSL\TLS by creating and setting the following registry to not allow anything lower than TLS.  Ensure the following value exists in each of the keys:

Enabled REG_DWORD 0

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\PCT 1.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 2.0\Server

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Client

HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders \SCHANNEL\Protocols\SSL 3.0\Server

The keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-28566r2_rule,STIG-ID|WG342_IIS6,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-13694"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\System\Currentcontrolset\Control\Securityproviders\Schannel\Protocols\Tls 1.0\Server"
  reg_item    : "Enabled"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI092 IIS6 - The IIS web site permissions 'Write' or 'Script Source' must not be selected. - 'Write permission check'"
  info          : "Web site permissions to include Read, Write, and Script Source Access can be set within the IIS Administration tool. Configuration settings made at the Web Server level are inherited by all of the web sites on the server.  It can override inheritance by configuring the individual site or site element.  These permissions control what users can access from the web site. If Read is selected, then source of the pages can be read, if Write is selected, then pages can be written to or updated. If the Script Source Access is checked, source code for scripts can be viewed. This option is not available if neither Read nor Write is selected.  Allowing users' access to the source of the web pages, may provide the user with more information than they are authorized to see. This is especially an issue for the source code for scripts on the web server."
  solution      : "1. Open the IIS Manager > Right click on the website (including directories, sub-directories, virtual directories, and files) being reviewed > Select Properties > Select the Home Directory (Directory, Virtual Directory, or File) tab.
2. Uncheck the Write and/or the Script source access permissions."
  reference     : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38020r1_rule,STIG-ID|WA000-WI092_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-13699"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 0
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessRead FROM IIsWebServerSetting"
  wmi_attribute : "AccessRead"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI092 IIS6 - The IIS web site permissions 'Write' or 'Script Source' must not be selected. - 'Script Source permission check'"
  info          : "Web site permissions to include Read, Write, and Script Source Access can be set within the IIS Administration tool. Configuration settings made at the Web Server level are inherited by all of the web sites on the server.  It can override inheritance by configuring the individual site or site element.  These permissions control what users can access from the web site. If Read is selected, then source of the pages can be read, if Write is selected, then pages can be written to or updated. If the Script Source Access is checked, source code for scripts can be viewed. This option is not available if neither Read nor Write is selected.  Allowing users' access to the source of the web pages, may provide the user with more information than they are authorized to see. This is especially an issue for the source code for scripts on the web server."
  solution      : "1. Open the IIS Manager > Right click on the website (including directories, sub-directories, virtual directories, and files) being reviewed > Select Properties > Select the Home Directory (Directory, Virtual Directory, or File) tab.
2. Uncheck the Write and/or the Script source access permissions."
  reference     : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38020r1_rule,STIG-ID|WA000-WI092_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-13699"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 0
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AccessSource FROM IIsWebServerSetting"
  wmi_attribute : "AccessSource"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WA000-WI120 IIS6 - The Content Location header must not contain proprietary IP addresses."
  info                 : "When using static HTML pages, a Content-Location header is added to the response.  By default, Internet Information Server (IIS) 4.0 Content-Location references the IP address of the server rather than the FQDN or Hostname. This header may expose internal IP addresses that are usually hidden or masked behind a Network Address Translation (NAT) firewall or proxy server. There is a value that can be modified in the IIS metabase to change the default behavior from exposing IP addresses to sending the FQDN instead.

The value that needs to be set is the w3svc/UseHostName, and it needs to be set to True.

The other option to prevent this from occurring is to use Active Server Pages instead of static HTML pages and create a custom header that sends back a specific Content-Location.  For complete instructions on this issue, please refer to Microsoft Knowledge Base article Q218180.

NOTE: Review each websites UseHostName value to ensure it is set to True.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "1. Open the metabase.xml file for the web server with notepad or Internet Explorer (default path is %systemroot%\System32\inetsrv).
2. Press CNTRL+F > enter 'servercomment' > Select the Find Next button to find the attribute ServerComment=the name of the website being reviewed.
3. Go to the beginning of the IIsWebServer key for the web site being reviewed (a few lines prior to the servercomment attribute found in step 2).
4. Note the number after W3SVC as it will be used next.
5. From the CLI navigate to the location of the adsutil.vbs script.
6. Enter the following adsutil.vbs set w3svc/number from step 3/UseHostName true.

NOTE:  The command in step 6 could be substituted with the following:  adsutil.vbs set w3svc/number from step 3/SetHostName 'name other than your private IP address'
NOTE:  cscript may have to be input in front of the command adsutil.vbs (i.e., cscript adsutil.vbs set w3svc/1/UseHostName)."
  reference            : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38025r1_rule,STIG-ID|WA000-WI120_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13702"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServerSetting | select Name,UseHostNameScript | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WA000-WI6010 IIS6 - The web site must have a unique application pool."
  info                 : "Application pools isolate sites and applications to address reliability, availability, and security issues. Sites and applications may be grouped according to configurations, although each site will be associated with a unique application pool.

  NOTE: Review each Web Applications to ensure each utilizes a separate Application Pool.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "1. Open the IIS Manager > Right click on the website being reviewed > Select the Home Directory tab.
2. Go to the Application settings area > Select the Application pool drop down > Select the unique Application pool for the web site.
3. Press OK."
  reference            : "800-53|SC-39,8500.2|ECSC-1,CAT|II,Rule-ID|SV-38137r1_rule,STIG-ID|WA000-WI6010_IIS6,Vuln-ID|V-13703"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IIsWebServerSetting | select Name,AppPoolID | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6020 IIS6 - The Recycle Worker processes in minutes monitor must be set properly."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Recycling tab.
2. Ensure the Recycle worker processes (in minutes) check box is checked and set the value to 1740 or less.
3. Press OK."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38134r2_rule,STIG-ID|WA000-WI6020_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13704"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [MIN..1740]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PeriodicRestartTime FROM IisApplicationPoolSetting"
  wmi_attribute : "PeriodicRestartTime"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6022 IIS6 - The maximum number of requests an application pool can process must be set."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Recycling tab.
2. Ensure the Recycle worker processes (number of requests) is enabled and the value is set to 35000 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38132r2_rule,STIG-ID|WA000-WI6022_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13705"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..35000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PeriodicRestartRequests FROM IisApplicationPoolSetting"
  wmi_attribute : "PeriodicRestartRequests"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6024 IIS6 - The maximum virtual memory monitor must be enabled."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Recycling tab.
2. Ensure the maximum virtual memory monitor is enabled and the value is set to 792 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38033r2_rule,STIG-ID|WA000-WI6024_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13706"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..811008]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PeriodicRestartMemory FROM IisApplicationPoolSetting"
  wmi_attribute : "PeriodicRestartMemory"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6026 IIS6 - The maximum used memory monitor must be enabled."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Recycling tab.
2. Ensure the maximum used memory is enabled and the value is set to 192 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38130r2_rule,STIG-ID|WA000-WI6026_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13707"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..196608]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PeriodicRestartPrivateMemory FROM IisApplicationPoolSetting"
  wmi_attribute : "PeriodicRestartPrivateMemory"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6028 IIS6 - The Shutdown worker processes Idle Timeout monitor must be enabled."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Performance tab.
2. Ensure the Shutdown worker process idle timeout monitor is enabled and the value is set to 20 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38041r2_rule,STIG-ID|WA000-WI6028_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13708"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..20]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,IdleTimeout FROM IisApplicationPoolSetting"
  wmi_attribute : "IdleTimeout"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6030 IIS6 - The Limit the kernel request queue monitor must be enabled"
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Performance tab.
2. Ensure the Limit the kernel request queue monitor is enabled and the value is set to 4000 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38123r2_rule,STIG-ID|WA000-WI6030_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13709"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..4000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,AppPoolQueueLength FROM IisApplicationPoolSetting"
  wmi_attribute : "AppPoolQueueLength"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6032 IIS6 - The Enable pinging monitor must be enabled. - 'PingingEnabled set to True'"
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Health tab.
2. Ensure the Enable pinging monitor is enabled and the value is set to 30 or more."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38043r2_rule,STIG-ID|WA000-WI6032_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13710"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PingingEnabled FROM IisApplicationPoolSetting"
  wmi_attribute : "PingingEnabled"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6032 IIS6 - The Enable pinging monitor must be enabled. - 'PingInterval set to 30 or more'"
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Health tab.
2. Ensure the Enable pinging monitor is enabled and the value is set to 30 or more."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38043r2_rule,STIG-ID|WA000-WI6032_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13710"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [30..MAX]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,PingInterval FROM IisApplicationPoolSetting"
  wmi_attribute : "PingInterval"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6034 IIS6 - The Enable rapid-fail protection monitor must be enabled."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Health tab.
2. Ensure the Enable rapid-fail protection monitor is enabled and the value is set to 5 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38044r2_rule,STIG-ID|WA000-WI6034_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13711"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : 1
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,RapidFailProtection FROM IisApplicationPoolSetting"
  wmi_attribute : "RapidFailProtection"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6036 IIS6 - The Enable rapid-fail time period monitor must be enabled."
  info          : "A worker process handles all application execution, including authentication and authorization, as well as, ISAPI filter and extension loading. This executable process is called W3WP.exe. When acting as the worker process manager, the www service is responsible for controlling the lifetime of all worker processes that are processing requests. The management console allows it to configure options, such as when to start or recycle a worker process, how many requests to serve before recycling, and what to do if the worker becomes blocked or unable to continue processing requests."
  solution      : "1. Open the IIS Manager > Right click on the desired Application Pool > Select Properties > Select the Health tab.
2. Ensure the Enable rapid-fail time period monitor is enabled and the value is set to 5 or less."
  reference     : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38045r2_rule,STIG-ID|WA000-WI6036_IIS6,SWIFT-CSCv1|2.3,Vuln-ID|V-13712"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..5]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,RapidFailProtectionInterval FROM IisApplicationPoolSetting"
  wmi_attribute : "RapidFailProtectionInterval"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WA000-WI6040 IIS6 - A unique non-privileged account must be used to run Worker Process Identities. - 'AppPoolIdentityType Check'"
  info                 : "The Worker Process Identity is the user defined to run an Application Pool. The IIS 6 worker processes, by default, run under the NetworkService account. Creating a custom identity for each Application Pool better track issues occurring within each web site. When a custom identity is used, the rights and privileges must not exceed those associated with the NetworkService security principal.

  NOTE: Review each website's AppPoolIdentityType to ensure it is a non-privileged account.

  NOTE: AppPoolIdentityType values: 0 - NT AUTHORITY\SYSTEM, 1 - NT AUTHORITY\LOCAL SERVICE, 2 - NT AUTHORITY\NETWORK SERVICE, 3 - Specific user account defined by the WAMUserName.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "1. Open the IIS Manager > Right click on the Application Pool that corresponded to the website being reviewed > Select Properties > Select the Identity tab.
2. Enter the desired account information.
3. Check the privileges on the account found in step 2 by using Computer Management and opening Users and Groups.
4. Ensure the account is a member of the IIS_WPG group and does not have membership to the Administrators group."
  reference            : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38046r1_rule,STIG-ID|WA000-WI6040_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-13713"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IisApplicationPoolSetting | select Name,AppPoolIdentityType | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WA000-WI6040 IIS6 - A unique non-privileged account must be used to run Worker Process Identities. - 'AppPoolIdentityType = 3 - WAMUserName'"
  info                 : "The Worker Process Identity is the user defined to run an Application Pool. The IIS 6 worker processes, by default, run under the NetworkService account. Creating a custom identity for each Application Pool better track issues occurring within each web site. When a custom identity is used, the rights and privileges must not exceed those associated with the NetworkService security principal.

  NOTE: Review each website's AppPoolIdentityType to ensure it is a non-privileged account.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution             : "1. Open the IIS Manager > Right click on the Application Pool that corresponded to the website being reviewed > Select Properties > Select the Identity tab.
2. Enter the desired account information.
3. Check the privileges on the account found in step 2 by using Computer Management and opening Users and Groups.
4. Ensure the account is a member of the IIS_WPG group and does not have membership to the Administrators group."
  reference            : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38046r1_rule,STIG-ID|WA000-WI6040_IIS6,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-13713"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'Get-WmiObject -namespace "root\\MicrosoftIISv2" -Class IisApplicationPoolSetting | where {$_.apppoolidentitytype -eq \\"3\\"} | select Name,WAMUserName | format-list'
  only_show_cmd_output : YES
  severity             : MEDIUM
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6098 IIS6 - The MaxRequestEntityAllowed metabase value must be defined. - 'IisWebDirectorySetting'"
  info          : "IIS 6.0 limits the size of requests directly from the settings in the metabase with the metabase entry MaxRequestEntityAllowed. This entry is similar to the MaxRequest EntityAllowed and MaxAllowedContentLength settings configured in the UrlScan tool.

The MaxRequestEntityAllowed property specifies the maximum number of bytes allowed in the entity body of a request. If a Content-Length header is present and specifies an amount of data greater than the value of MaxRequestEntityAllowed, IIS sends a 403 error response."
  solution      : "1. From the CLI navigate to the location of the adsutil.vbs script.
2. Enter the following:  adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000
3. Press Enter.
4. Restart IIS.

NOTE:  You may have to put cscript in front of the command adsutil.vbs (i.e. cscript adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000)."
  reference     : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38047r2_rule,STIG-ID|WA000-WI6098_IIS6,Vuln-ID|V-13723"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..30000000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxRequestEntityAllowed FROM IisWebDirectorySetting"
  wmi_attribute : "MaxRequestEntityAllowed"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6098 IIS6 - The MaxRequestEntityAllowed metabase value must be defined. - 'IisWebFileSetting'"
  info          : "IIS 6.0 limits the size of requests directly from the settings in the metabase with the metabase entry MaxRequestEntityAllowed. This entry is similar to the MaxRequest EntityAllowed and MaxAllowedContentLength settings configured in the UrlScan tool.

The MaxRequestEntityAllowed property specifies the maximum number of bytes allowed in the entity body of a request. If a Content-Length header is present and specifies an amount of data greater than the value of MaxRequestEntityAllowed, IIS sends a 403 error response."
  solution      : "1. From the CLI navigate to the location of the adsutil.vbs script.
2. Enter the following:  adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000
3. Press Enter.
4. Restart IIS.

NOTE:  You may have to put cscript in front of the command adsutil.vbs (i.e. cscript adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000)."
  reference     : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38047r2_rule,STIG-ID|WA000-WI6098_IIS6,Vuln-ID|V-13723"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..30000000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxRequestEntityAllowed FROM IisWebFileSetting"
  wmi_attribute : "MaxRequestEntityAllowed"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6098 IIS6 - The MaxRequestEntityAllowed metabase value must be defined. - 'IisWebServerSetting'"
  info          : "IIS 6.0 limits the size of requests directly from the settings in the metabase with the metabase entry MaxRequestEntityAllowed. This entry is similar to the MaxRequest EntityAllowed and MaxAllowedContentLength settings configured in the UrlScan tool.

The MaxRequestEntityAllowed property specifies the maximum number of bytes allowed in the entity body of a request. If a Content-Length header is present and specifies an amount of data greater than the value of MaxRequestEntityAllowed, IIS sends a 403 error response."
  solution      : "1. From the CLI navigate to the location of the adsutil.vbs script.
2. Enter the following:  adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000
3. Press Enter.
4. Restart IIS.

NOTE:  You may have to put cscript in front of the command adsutil.vbs (i.e. cscript adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000)."
  reference     : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38047r2_rule,STIG-ID|WA000-WI6098_IIS6,Vuln-ID|V-13723"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..30000000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxRequestEntityAllowed FROM IisWebServerSetting"
  wmi_attribute : "MaxRequestEntityAllowed"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6098 IIS6 - The MaxRequestEntityAllowed metabase value must be defined. - 'IisWebServiceSetting'"
  info          : "IIS 6.0 limits the size of requests directly from the settings in the metabase with the metabase entry MaxRequestEntityAllowed. This entry is similar to the MaxRequest EntityAllowed and MaxAllowedContentLength settings configured in the UrlScan tool.

The MaxRequestEntityAllowed property specifies the maximum number of bytes allowed in the entity body of a request. If a Content-Length header is present and specifies an amount of data greater than the value of MaxRequestEntityAllowed, IIS sends a 403 error response."
  solution      : "1. From the CLI navigate to the location of the adsutil.vbs script.
2. Enter the following:  adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000
3. Press Enter.
4. Restart IIS.

NOTE:  You may have to put cscript in front of the command adsutil.vbs (i.e. cscript adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000)."
  reference     : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38047r2_rule,STIG-ID|WA000-WI6098_IIS6,Vuln-ID|V-13723"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..30000000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxRequestEntityAllowed FROM IisWebServiceSetting"
  wmi_attribute : "MaxRequestEntityAllowed"
  wmi_key       : "Name"
</custom_item>

<custom_item>
  type          : WMI_POLICY
  description   : "WA000-WI6098 IIS6 - The MaxRequestEntityAllowed metabase value must be defined. - 'IisWebVirtualDirSetting'"
  info          : "IIS 6.0 limits the size of requests directly from the settings in the metabase with the metabase entry MaxRequestEntityAllowed. This entry is similar to the MaxRequest EntityAllowed and MaxAllowedContentLength settings configured in the UrlScan tool.

The MaxRequestEntityAllowed property specifies the maximum number of bytes allowed in the entity body of a request. If a Content-Length header is present and specifies an amount of data greater than the value of MaxRequestEntityAllowed, IIS sends a 403 error response."
  solution      : "1. From the CLI navigate to the location of the adsutil.vbs script.
2. Enter the following:  adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000
3. Press Enter.
4. Restart IIS.

NOTE:  You may have to put cscript in front of the command adsutil.vbs (i.e. cscript adsutil.vbs set w3svc/MaxRequestEntityAllowed 30000000)."
  reference     : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38047r2_rule,STIG-ID|WA000-WI6098_IIS6,Vuln-ID|V-13723"
  see_also      : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type    : POLICY_DWORD
  value_data    : [1..30000000]
  wmi_namespace : "root/MicrosoftIISv2"
  wmi_request   : "SELECT Name,MaxRequestEntityAllowed FROM IIsWebVirtualDirSetting"
  wmi_attribute : "MaxRequestEntityAllowed"
  wmi_key       : "Name"
</custom_item>

</group_policy>
</check_type>
