#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.5 $
# $Date: 2020/04/23 $
#
# Description : This .audit is designed against the CIS Mozilla Firefox 38 ESR Benchmark v1.0.0 - 12-31-2015.
#
#<ui_metadata>
#<display_name>CIS Mozilla Firefox 38 ESR Windows L1 v1.0.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Mozilla Firefox 38 ESR Windows L1</name>
#  <version>1.0.0</version>
#  <link>https://workbench.cisecurity.org/files/1158</link>
#</spec>
#<labels>windows,cis,mozilla,firefox</labels>
#<benchmark_refs>LEVEL,CSCv6</benchmark_refs>
#<variables>
#  <variable>
#    <name>MOZILLA_CONFIG</name>
#    <default>C:\Program Files (X86)\Mozilla Firefox\mozilla.cfg</default>
#    <description>Mozilla configuration file</description>
#    <info>This is the location where the mozilla configuration file can be found.</info>
#  </variable>
#  <variable>
#    <name>LOCKING_FILE</name>
#    <default>C:\Program Files (x86)\Mozilla Firefox\defaults\pref\local-settings.js</default>
#    <description>Locking File</description>
#    <info>This is the location where the file that loads and locks the setting in the configuration file.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Firefox">

<if>
  <condition type:"AND">
    <custom_item>
      type        : REG_CHECK
      description : "Firefox is installed"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\Software\Mozilla\Mozilla Firefox"
      reg_option  : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Mozilla_Firefox_38_ESR_v1.0.0_Windows_Level1.audit for CIS Mozilla Firefox 38 ESR v1.0.0"
    </report>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "1.1 Create local-settings.js file - general.config.filename"
      info        : "The local-settings.js file is used by Firefox to reference and load the mozilla.cfg file which contains all the locked preferences.
Loading a custom configuration file is a primary mechanism for setting and enforcing security requirements within Firefox."
      solution    : 'Perform the following procedure:

* Navigate to the defaults/pref directory inside the Firefox installation directory and create a file called local-settings.js.

* Include the following lines in local-settings.js:

   pref("general.config.obscure_value", 0);
 pref("general.config.filename", "mozilla.cfg");'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @LOCKING_FILE@ replaced with "C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js" in field "value_data".
      value_data  : "C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js"
      regex       : '^[\\s]*pref\\("general.config.filename",[\\s]*'
      expect      : '^[\\s]*pref\\("general.config.filename",[\\s]*"mozilla.cfg"\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "1.1 Create local-settings.js file - general.config.obscure"
      info        : "The local-settings.js file is used by Firefox to reference and load the mozilla.cfg file which contains all the locked preferences.
Loading a custom configuration file is a primary mechanism for setting and enforcing security requirements within Firefox."
      solution    : 'Perform the following procedure:

* Navigate to the defaults/pref directory inside the Firefox installation directory and create a file called local-settings.js.

* Include the following lines in local-settings.js:

   pref("general.config.obscure_value", 0);
 pref("general.config.filename", "mozilla.cfg");'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @LOCKING_FILE@ replaced with "C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js" in field "value_data".
      value_data  : "C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js"
      regex       : '^[\\s]*pref\\("general.config.obscure_value",[\\s]*'
      expect      : '^[\\s]*pref\\("general.config.obscure_value",[\\s]*0\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "1.2 Set permissions on local-settings.js"
      info            : "Set permissions on local-settings.js so that it can only be modified or deleted by an Administrator.
Any users with the ability to modify the local-settings.js file can bypass all security configurations by changing the file or deleting it."
      solution        : "Deny non-administrators the ability to write to local-settings.js."
      reference       : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,LEVEL|1S,NESA|M1.1.3,NESA|T5.1.1"
      see_also        : "https://workbench.cisecurity.org/files/1158"
      value_type      : POLICY_TEXT
      value_data      : ".*\\Administrators:\(I\)\(F\).*"
# Note: Variable @LOCKING_FILE@ replaced with "C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js" in field "powershell_args".
      powershell_args : "$f=$env:SystemRoot + 'C:\\Program Files (x86)\\Mozilla Firefox\\defaults\\pref\\local-settings.js';icacls $f;"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "1.3 Create mozilla.cfg file"
      info        : "The mozilla.cfg file is used by Firefox to configure all the locked preferences.
Loading a custom configuration file is a primary mechanism for setting and enforcing security requirements in Firefox."
      solution    : "Perform the following procedure:

* Navigate to the Firefox installation directory and create a file called mozilla.cfg.

* The first line of the file must be a comment:

  //"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*\/.*'
      expect      : '^[\\s]*\/.*'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "1.4 Set permissions on mozilla.cfg"
      info            : "Set permissions on mozilla.cfg so that it can only be modified or deleted by an Administrator.
Any users with the ability to modify the mozilla.cfg file can bypass all security configurations by changing the file or deleting it."
      solution        : "Deny non-administrators the ability to write to mozilla.cfg."
      reference       : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/1158"
      value_type      : POLICY_TEXT
      value_data      : ".*\\Administrators:\(I\)\(F\).*"
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "powershell_args".
      powershell_args : "$f=$env:SystemRoot + 'C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg';icacls $f;"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "1.5 Protect Firefox Binaries"
      info            : "Ensure that Firefox is installed and owned by an administrative account in order to protect the binaries and to prevent users from circumventing security settings.
When Firefox is installed by an ordinary user, the software in installed into the user's profile / home directory. This avoids the requirement for administrative access during installation and upgrades, but also allows users to circumvent security settings defined in settings.js and mozilla.cfg files. Having the installation owned by an administrative user can also protect binary and configuration files from malware that is executed in an ordinary user's browser.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "Install Firefox into a shared location that can be accessed by users but modified only by Administrators."
      reference       : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/1158"
      value_type      : POLICY_TEXT
      value_data      : ""
      powershell_args : "Get-ChildItem -Path C:\ -Filter firefox.exe -Recurse -ErrorAction SilentlyContinue -Force"
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.1 Enable Automatic Updates - app.update.enabled"
      info        : "This feature configures Firefox to automatically download and install updates as they are made available.
Security updates ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.enabled", true);
lockPref("app.update.auto", true);
lockPref("app.update.staging.enabled", true);'
      reference   : "800-171|3.14.1,800-53|SI-2(5),CSF|ID.RA-1,CSF|PR.IP-12,LEVEL|1S,NIAv2|NS26b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.1 Enable Automatic Updates - app.update.auto"
      info        : "This feature configures Firefox to automatically download and install updates as they are made available.
Security updates ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.enabled", true);
lockPref("app.update.auto", true);
lockPref("app.update.staging.enabled", true);'
      reference   : "800-171|3.14.1,800-53|SI-2(5),CSF|ID.RA-1,CSF|PR.IP-12,LEVEL|1S,NIAv2|NS26b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.auto",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.auto",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.1 Enable Automatic Updates - app.update.staging.enabled"
      info        : "This feature configures Firefox to automatically download and install updates as they are made available.
Security updates ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.enabled", true);
lockPref("app.update.auto", true);
lockPref("app.update.staging.enabled", true);'
      reference   : "800-171|3.14.1,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.staging.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.staging.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.2 Enable Auto-Notification of Outdated Plugins"
      info        : "This feature automatically detects when installed plugins are out of date and notifies the users to update the plugins.
Outdated plugins can be vulnerable or unstable, and can be exploited by malicious websites."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("plugins.update.notifyUser", true);'
      reference   : "800-53|SI-4(5),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),LEVEL|1S,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("plugins.update.notifyUser",[\\s]*'
      expect      : '^[\\s]*lockPref\\("plugins.update.notifyUser",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.3 Enable Information Bar for Outdated Plugins"
      info        : "This feature automatically shows an information bar when installed Plugins are out of date and notifies the users to update the plugins.
Outdated plugins can be vulnerable or unstable, and can be exploited by malicious websites."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("plugins.hide_infobar_for_outdated_plugin", false);'
      reference   : "800-53|SI-4(5),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),LEVEL|1S,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("plugins.hide_infobar_for_outdated_plugin",[\\s]*'
      expect      : '^[\\s]*lockPref\\("plugins.hide_infobar_for_outdated_plugin",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.4 Set Update Interval Time Checks"
      info        : "This configuration sets the amount of time the system waits in between each check for updates.
Frequent checks for updates will mitigate the risk that a system is left vulnerable to known risks for an extended period of time."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.interval", 43200);'
      reference   : "800-171|3.14.1,800-53|SI-2(5),CSF|ID.RA-1,CSF|PR.IP-12,LEVEL|1S,NIAv2|NS26b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.interval",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.interval",[\\s]*43200\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.5 Set Update Wait Time Prompt"
      info        : "This setting determines the amount of time, in seconds, which the system will wait before displaying the Software Update dialogue box (after an unobtrusive alert has already been shown).
Encouraging the user to update software as soon as possible mitigates the risk that a system will be left vulnerable."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.promptWaitTime", 172800);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.promptWaitTime",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.promptWaitTime",[\\s]*172800\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.6 Ensure Update-related UI Components are Displayed"
      info        : "This setting dictates whether the Firefox Update service will notify the user when update related events occur, such as updates being available or downloaded. It is recommended that updated-related notifications be displayed.
Ensuring users are aware of update-related events may reduce the amount of time Firefox remains unpatched."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("app.update.silent", false);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("app.update.silent",[\\s]*'
      expect      : '^[\\s]*lockPref\\("app.update.silent",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "2.7 Set Search Provider Update Behavior"
      info        : "This feature dictates whether Firefox will update installed search providers. Search providers allow the user to search directly from the 'Search bar' which is adjacent to the URL bar.
Software updates help ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.search.update", true);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.search.update",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.search.update",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "3.1 Validate Proxy Settings"
      info        : "Firefox can be configured to use one or more proxy servers. When a proxy server is configured for a given protocol (HTTP, FTP, Gopher, etc), Firefox will send applicable requests to that proxy server for fulfillment. It is recommended that the list of proxy servers configured in Firefox be reviewed to ensure it contains only trusted proxy servers.
Depending on the protocol used, the proxy server will have access to read and/or alter all information communicated between Firefox and the target server, such a web site.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Perform the following procedure:

* Drop down the Firefox menu
* Click on Options
* Select Options from the list
* Click on the Advanced Button in the Options window
* Click on Network Tab
* Click on Settings Button
* Ensure that the proxy listed (if any) is the one configured and approved by the enterprise."
      reference   : "LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/1158"
    </report>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.3 Disable NTLM v1"
      info        : "This feature NT Lan Manager (NTLM) v1 protocol to be used for authentication to resources that request this authentication type.
NTLM v1 contains cryptographic weaknesses that can be easily exploited to obtain user credentials."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("network.auth.force-generic-ntlm-v1", false);'
      reference   : "800-53|IA-5(6),CSF|PR.AC-1,ITSG-33|IA-5(6),LEVEL|1S,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("network.auth.force-generic-ntlm-v1",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.auth.force-generic-ntlm-v1",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.4 Enable Warning For 'Phishy' URLs"
      info        : "It is possible to disguise a website's true location by making use of username/password syntax within the URL (known as 'phishy URLs'). This setting will display a warning message whenever a user clicks a link to a phishy URL.
This setting will help protect the browser against phishing."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("network.http.phishy-userpass-length", 1);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("network.http.phishy-userpass-length",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.http.phishy-userpass-length",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.6 Set File URI Origin Policy"
      info        : "This feature determines the restrictions placed on the scripts and links loaded into the browser from local HTML files.
Applying the same origin policy to local files will help mitigate the risk of unauthorized access to sensitive information."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.fileuri.strict_origin_policy", true)'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.fileuri.strict_origin_policy",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.fileuri.strict_origin_policy",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.7 Disable Cloud Sync"
      info        : "Firefox allows users to sync preferences and settings, including saved credentials, to cloud-based servers in order to retrieve them from other computers. This setting determines whether cloud sync in enabled.
Disable cloud sync in order to ensure that personal data and credentials are not compromised."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("services.sync.enabled", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("services.sync.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("services.sync.enabled",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.8 Disable WebRTC - media.peerconnection.enabled"
      info        : "These settings determine whether WebRTC (Web Real Time Communications) is allowed. WebRTC is used for peer to peer communication such as file sharing or video calls.
WebRTC can expose private information such as internal IP addresses and computer settings."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("media.peerconnection.enabled", false);
lockPref("media.peerconnection.use_document_iceservers", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("media.peerconnection.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("media.peerconnection.enabled",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "3.8 Disable WebRTC - media.peerconnection.use_document_iceservers"
      info        : "These settings determine whether WebRTC (Web Real Time Communications) is allowed. WebRTC is used for peer to peer communication such as file sharing or video calls.
WebRTC can expose private information such as internal IP addresses and computer settings."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("media.peerconnection.enabled", false);
lockPref("media.peerconnection.use_document_iceservers", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("media.peerconnection.use_document_iceservers",[\\s]*'
      expect      : '^[\\s]*lockPref\\("media.peerconnection.use_document_iceservers",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.2 Set Security TLS Version Maximum"
      info        : "This feature sets the maximum required protocol version.
Setting TLS 1.2 as the maximum authorized protocol version mitigates the risk of using an insecure connection."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.tls.version.max", 3)'
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.tls.version.max",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.tls.version.max",[\\s]*3\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.3 Set Security TLS Version Minimum"
      info        : "This feature sets the minimum protocol version that may be used when negotiating TLS/SSL sessions.
Setting TLS 1.0 as the minimum protocol version mitigates the risk of negotiating an insecure protocol, such as SSL 2.0."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.tls.version.min", 1)'
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.tls.version.min",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.tls.version.min",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "4.5 Block Mixed Active Content"
      info        : "This feature disables the ability to view HTTP content such as JavaScript, CSS, objects, and xhr requests.
Blocking active mixed content minimizes the risk of man-in-the-middle attacks."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.mixed_content.block_active_content", true)'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.mixed_content.block_active_content",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.mixed_content.block_active_content",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.1 Disallow JavaScript's Ability to Change the Status Bar Text"
      info        : "The Status Bar shows the location of the content when a user hovers over a hyperlink, a user visits a link, or when content is being downloaded on a web page.
Some malicious websites can use JavaScript to manipulate the text on the status bar so that a user cannot determine the actual location of the content for hyperlinks and downloads."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("dom.disable_window_status_change", true);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("dom.disable_window_status_change",[\\s]*'
      expect      : '^[\\s]*lockPref\\("dom.disable_window_status_change",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.2 Disable Scripting of Plugins by JavaScript"
      info        : "Javascript can initiate and interact with the Plug-ins installed in Firefox.
This may reduce a malicious script's ability to exploit vulnerabilities in plug-ins or abuse plug-in features."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.xpconnect.plugin.unrestricted", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.xpconnect.plugin.unrestricted",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.xpconnect.plugin.unrestricted",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.3 Disallow JavaScript's Ability to Hide the Address Bar"
      info        : "The Address Bar shows the current URL, which can be used to identify the website.
Some malicious websites can use JavaScript to hide the address bar so that a user cannot determine the URL."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("dom.disable_window_open_feature.location", true);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("dom.disable_window_open_feature.location",[\\s]*'
      expect      : '^[\\s]*lockPref\\("dom.disable_window_open_feature.location",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.4 Disallow JavaScript's Ability to Hide the Status Bar"
      info        : "The Status Bar shows the location of the content when a user visits a link or when content is being downloaded on a web page.
Some malicious websites can use JavaScript to hide the status bar so that a user cannot determine the location of the content for hyperlinks and downloads."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("dom.disable_window_open_feature.status", true);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("dom.disable_window_open_feature.status",[\\s]*'
      expect      : '^[\\s]*lockPref\\("dom.disable_window_open_feature.status",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.5 Disable Closing of Windows via Scripts"
      info        : "Firefox can be configured to prevent scripts from closing browser windows.
Preventing an arbitrary web site from closing the browser window will reduce the probability of a user losing work or state being performed in another tab within the same window."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("dom.allow_scripts_to_close_windows", false);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("dom.allow_scripts_to_close_windows",[\\s]*'
      expect      : '^[\\s]*lockPref\\("dom.allow_scripts_to_close_windows",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.6 Block Pop-up Windows"
      info        : "The Pop-up Blocker is used to block Pop-ups which a website might open with or without any user interaction. These Pop-Ups can be used to open un-trusted malicious content.
By enabling the Pop-up blocker, all Pop-ups will be blocked which will guard a user against any attacks launched using a Pop-up."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.popups.policy", 1);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.popups.policy",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.popups.policy",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "5.7 Disable Displaying JavaScript in History URLs"
      info        : "This will ensure that JavaScript URLs are not displayed in the history bar.
Various browser elements, even a simple link, can embed javascript: URLs and access the javascript: protocol. The JavaScript statement used in a javascript: URL can be used to encapsulate a specially crafted URL that performs a malicious function."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.urlbar.filter.javascript", true);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.urlbar.filter.javascript",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.urlbar.filter.javascript",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.1 Disallow Credential Storage"
      info        : "Firefox allows credentials to be stored for certain websites.
Stored credentials may be harvested by an adversary that gains local privileges equal to or greater than the principal running Firefox, which may increase the scope and impact of a breach. However, preventing Firefox from storing credentials will not prevent such an adversary from harvesting credentials used while compromised."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("signon.rememberSignons", false);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("signon.rememberSignons",[\\s]*'
      expect      : '^[\\s]*lockPref\\("signon.rememberSignons",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.2 Do Not Accept Third Party Cookies"
      info        : "A third-party cookie is a cookie sent by a domain that differs from the domain in the browser's address bar.
Third party cookies are often used for tracking user browsing behaviors, which has privacy implications. However, preventing third-party cookies does not completely mitigate privacy concerns as several other active tracking mechanisms exist[1]."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("network.cookie.cookieBehavior", 1);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("network.cookie.cookieBehavior",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.cookie.cookieBehavior",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.3 Tracking Protection - privacy.donottrackheader.enabled"
      info        : "These settings instruct the browser to communicate the preference not to be tracked to websites to which it connects, and additionally attempt to block tracking.
Enabling Do Not Track instructs the browser to send an optional header in HTTP requests made from the app that indicates a preference not to be tracked by websites. This optional header is voluntary in nature, having no method to enforce adherence and providing no guarantee that web sites will honor the preference. However, a large number of websites do honor it so there is privacy benefit in enabling it."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.donottrackheader.value", 1);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode", true);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.donottrackheader.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.donottrackheader.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.3 Tracking Protection - privacy.donottrackheader.value"
      info        : "These settings instruct the browser to communicate the preference not to be tracked to websites to which it connects, and additionally attempt to block tracking.
Enabling Do Not Track instructs the browser to send an optional header in HTTP requests made from the app that indicates a preference not to be tracked by websites. This optional header is voluntary in nature, having no method to enforce adherence and providing no guarantee that web sites will honor the preference. However, a large number of websites do honor it so there is privacy benefit in enabling it."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.donottrackheader.value", 1);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode", true);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.donottrackheader.value",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.donottrackheader.value",[\\s]*1\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.3 Tracking Protection - privacy.trackingprotection.enabled"
      info        : "These settings instruct the browser to communicate the preference not to be tracked to websites to which it connects, and additionally attempt to block tracking.
Enabling Do Not Track instructs the browser to send an optional header in HTTP requests made from the app that indicates a preference not to be tracked by websites. This optional header is voluntary in nature, having no method to enforce adherence and providing no guarantee that web sites will honor the preference. However, a large number of websites do honor it so there is privacy benefit in enabling it."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.donottrackheader.value", 1);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode", true);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.trackingprotection.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.trackingprotection.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.3 Tracking Protection - privacy.trackingprotection.pbmode"
      info        : "These settings instruct the browser to communicate the preference not to be tracked to websites to which it connects, and additionally attempt to block tracking.
Enabling Do Not Track instructs the browser to send an optional header in HTTP requests made from the app that indicates a preference not to be tracked by websites. This optional header is voluntary in nature, having no method to enforce adherence and providing no guarantee that web sites will honor the preference. However, a large number of websites do honor it so there is privacy benefit in enabling it."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.donottrackheader.value", 1);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode", true);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.trackingprotection.pbmode",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.trackingprotection.pbmode",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.4 Set Delay for Enabling Security Sensitive Dialog Boxes"
      info        : "This feature sets the amount of time in milliseconds that elapse before the buttons on security-sensitive dialog boxes are enabled.
This delay help prevents Firefox users from inadvertently installing malicious software."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("security.dialog_enable_delay", 2000);'
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|1S,NIAv2|GS8a,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("security.dialog_enable_delay",[\\s]*'
      expect      : '^[\\s]*lockPref\\("security.dialog_enable_delay",[\\s]*2000\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "6.5 Disable Geolocation Serivces"
      info        : "This settings determines whether Firefox will provide geographic location information to websites.
Geo-location services can expose private information to remote websites."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("geo.enabled", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("geo.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("geo.enabled",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.1 Secure Application Plug-ins"
      info        : "Some active content such as audio and video can be automatically loaded by Firefox on websites. It is recommended to secure application plug-ins.
Some malicious websites use active content to exploit vulnerabilities in the active content handling application plug-in. It is recommended to always prompt the user when a website is about to load active content."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.helperApps.alwaysAsk.force", true);'
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.helperApps.alwaysAsk.force",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.helperApps.alwaysAsk.force",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.2 Disabling Auto-Install of Add-ons"
      info        : "This configuration will show how to ensure that no website is allowed to automatically install Add-Ons. Also, it will list how to ensure that proper notifications are shown when installing Add-Ons.
Add-Ons are extensions of the browser that add new functionality to Firefox or change its appearance. These run in a user s session allowing them do manipulate data and the behavior of the way Firefox interacts with other application and user commands. If malicious Add-Ons are installed automatically, a user s security could be completely compromised."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("xpinstall.whitelist.required", true);'
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1S,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("xpinstall.whitelist.required",[\\s]*'
      expect      : '^[\\s]*lockPref\\("xpinstall.whitelist.required",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.3 Enable Extension Block List"
      info        : "This feature enables Mozilla to retrieve a list of blocked applications from the server.
Enabling Mozilla to access the list of blocked applications mitigates the risk of installing a known malicious application."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("extensions.blocklist.enabled", true);'
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|1S,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("extensions.blocklist.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("extensions.blocklist.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.4 Set Extension Block List Interval"
      info        : "This feature determines how often Mozilla will attempt to retrieve a list of blocked applications from the server.
An updated list of blocked applications mitigates the risk of installing and using a known malicious application."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("extensions.blocklist.interval", 86400);'
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,ITSG-33|AC-19,LEVEL|1S,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("extensions.blocklist.interval",[\\s]*'
      expect      : '^[\\s]*lockPref\\("extensions.blocklist.interval",[\\s]*86400\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.5 Enable Warning for External Protocol Handler"
      info        : "This feature indicates whether the user is warned before opening an external application for pre-configured protocols were its behavior is undefined.
Enabling a warning to appear before passing data to an external application mitigates the risk that sensitive information will be made vulnerable to outside threats."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("network.protocol-handler.warn-external-default", true);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("network.protocol-handler.warn-external-default",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.protocol-handler.warn-external-default",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.6 Disable Popups Initiated by Plugins"
      info        : "This feature controls popups that are initiated by plugins.
Disabling plugin popups (except from white-listed sites) from being displayed, guard a user against any attacks launched using a Pop-up."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("privacy.popups.disable_from_plugins", 2)'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("privacy.popups.disable_from_plugins",[\\s]*'
      expect      : '^[\\s]*lockPref\\("privacy.popups.disable_from_plugins",[\\s]*2\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.7 Enable Extension Auto Update"
      info        : "This feature configures Firefox to automatically download and install updates as they are made available.
Security updates ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("extensions.update.autoUpdateDefault", true)'
      reference   : "800-171|3.14.1,800-53|SI-2(5),CSF|ID.RA-1,CSF|PR.IP-12,LEVEL|1S,NIAv2|NS26b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("extensions.update.autoUpdateDefault",[\\s]*'
      expect      : '^[\\s]*lockPref\\("extensions.update.autoUpdateDefault",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.8 Enable Extension Update"
      info        : "This feature configures Firefox to prompt when updates are made available.
Security updates ensure that users are safe from known software bugs and vulnerabilities."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("extensions.update.enabled", true)'
      reference   : "800-171|3.14.1,800-53|SI-2(5),CSF|ID.RA-1,CSF|PR.IP-12,LEVEL|1S,NIAv2|NS26b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("extensions.update.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("extensions.update.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "7.9 Set Extension Update Interval Time Checks"
      info        : "This feature sets the amount of time the system waits between checking for updates.
Setting a specific amount of time between automatically checking for updates mitigates the risk that a system will left vulnerable to known risks for an extended period of time."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("extensions.update.interval", 86400)'
      reference   : "800-171|3.14.1,800-53|SI-2(3),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2(3),LEVEL|1S,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("extensions.update.interval",[\\s]*'
      expect      : '^[\\s]*lockPref\\("extensions.update.interval",[\\s]*86400\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "8.1 Enable Virus Scanning for Downloads"
      info        : "This feature configures the browser to scan downloads for viruses.
This will ensure that a downloaded file is scanned for viruses before the user has an opportunity to interact with the download. It will also ensure that Windows Policy for downloaded files is followed properly."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.download.manager.scanWhenDone", true);'
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.download.manager.scanWhenDone",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.download.manager.scanWhenDone",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "8.2 Disable JAR from Opening Unsafe File Types"
      info        : "This feature gives the user the ability to override the restriction on only loading files with application/java-archive or application/x-jar content types.
Enabling the browser to only load application/java-archive or application/x-jar content types mitigates the risk of malware infection and other attack vectors."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("network.jar.open-unsafe-types", false);'
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("network.jar.open-unsafe-types",[\\s]*'
      expect      : '^[\\s]*lockPref\\("network.jar.open-unsafe-types",[\\s]*false\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "8.3 Block Reported Web Forgeries"
      info        : "This feature alerts the user if they are visiting a known phishing website.
Enabling this feature helps mitigate the threat of phishing attacks."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.safebrowsing.enabled", true);'
      reference   : "800-53|SI-4(5),CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),LEVEL|1S,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.safebrowsing.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.safebrowsing.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : FILE_CONTENT_CHECK
      description : "8.4 Block Reported Attack Sites"
      info        : "This feature alerts the user if they are visiting a known malicious website.
Enabling this feature will decrease the probability of a user falling victim to a known malicious web site."
      solution    : 'Perform the following procedure:

* Open the mozilla.cfg file in the installation directory with a text editor

* Add the following lines to mozilla.cfg:

  lockPref("browser.safebrowsing.malware.enabled", true);'
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|1S,NIAv2|GS8a,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/1158"
      value_type  : POLICY_TEXT
# Note: Variable @MOZILLA_CONFIG@ replaced with "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg" in field "value_data".
      value_data  : "C:\\Program Files (X86)\\Mozilla Firefox\\mozilla.cfg"
      regex       : '^[\\s]*lockPref\\("browser.safebrowsing.malware.enabled",[\\s]*'
      expect      : '^[\\s]*lockPref\\("browser.safebrowsing.malware.enabled",[\\s]*true\\);[\\s]*$'
      file_option : CAN_NOT_BE_NULL
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Mozilla_Firefox_38_ESR_v1.0.0_Windows_Level1.audit for CIS Mozilla Firefox 38 ESR v1.0.0"
      info        : "Firefox is not installed or remote registry service is disabled.
      NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</group_policy>
</check_type>
