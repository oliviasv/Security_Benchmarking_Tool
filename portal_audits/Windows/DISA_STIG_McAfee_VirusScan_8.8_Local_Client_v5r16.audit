#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.3 $
# $Date: 2020/04/22 $
#
# description : This file was created using the McAfee VirusScan 8.8 Local Client Security Technical Implementation Guide,
#       Version 5, Release 16.
#
#       The files can be downloaded from the following link :
#
#       https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip
#
#<ui_metadata>
#<display_name>DISA McAfee VirusScan 8.8 Local Client STIG v5r16</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>DISA McAfee VirusScan 8.8 Local Client</name>
#  <version>5.16.0</version>
#  <link>https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip</link>
#</spec>
#<labels>windows,disa,mcafee,virusscan,local_client</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>NOTIFICATION_EMAIL</name>
#    <default>person@service.mil</default>
#    <description>Notification email recipient</description>
#    <info>VSE will send a notification email to the address above when a threatening email message is detected.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"DISA McAfee VirusScan 8.8 STIG Checklist v5r16">

<if>
  <condition type:"OR">
    <custom_item>
      type        : REGISTRY_SETTING
      description : "McAfee VirusScan 8.8 Local Client (x32) is installed."
      value_type  : POLICY_TEXT
      value_data  : "^VSE88.+$"
      reg_key     : "HKLM\SOFTWARE\McAfee\DesktopProtection"
      reg_item    : "CoreRef"
      check_type  : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "McAfee VirusScan 8.8 Local Client (x64) is installed."
      value_type  : POLICY_TEXT
      value_data  : "^VSE88.+$"
      reg_key     : "HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection"
      reg_item    : "CoreRef"
      check_type  : CHECK_REGEX
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_McAfee_VirusScan_8.8_Local_Client_v5r16.audit for Microsoft Windows from DISA STIG McAfee VirusScan 8.8 v5r15"
      info        : "Nessus has identified that McAfee VirusScan Enterprise 8.8 is installed."
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "64-bit Windows check"
          value_type      : POLICY_TEXT
          value_data      : "True"
          powershell_args : "[Environment]::Is64BitOperatingSystem"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM001 - McAfee VirusScan On-Access Scanner General Settings must be configured to enable on-access scanning at system startup."
          info        : "For Antivirus software to be effective, it must be running at all times, beginning from the point of the system's initial startup. Otherwise, the risk is greater for viruses, trojans, and other malware infecting the system during that startup phase."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.

		Under the General tab, locate the 'General:' label. Select the 'Enable on-access scanning at system startup' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|I,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56365r1_rule,STIG-ID|DTAM001,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6453"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bStartDisabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM002 -  McAfee VirusScan On-Access Scanner General Settings must be configured to scan boot sectors."
          info        : "Boot sector viruses will install into the boot sector of a system, ensuring that they will execute when the user boots the system. This risk is mitigated by scanning boot sectors at each startup of the system."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties. Select the General Settings.
		Under the General tab, locate the 'Scan:' label. Select the 'Boot Sectors' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56367r1_rule,STIG-ID|DTAM002,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6467"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bDontScanBootSectors"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM003 - McAfee VirusScan On-Access Scanner General Settings must be configured to scan floppy during shutdown."
          info        : "Computer viruses in the early days of personal computing were almost exclusively passed around by floppy disks. Floppy disks would be used to boot the computer and, if infected, would infect the hard drive files, as well. Although floppy drives have fallen out of use, it is still a good security practice, whenever the antivirus software allows, to enable the scanning software to scan a floppy disk at shutdown."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the General tab, locate the 'Scan:' label. Select the 'Floppy during shutdown' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56368r1_rule,STIG-ID|DTAM003,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6468"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bScanFloppyonShutdown"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM004 -  McAfee VirusScan On-Access Scanner General Settings must be configured to notify local users when detections occur."
          info        : "An effective awareness program explains proper rules of behavior for use of an organization's IT systems and information. Accordingly, awareness programs should include guidance to users on malware incident prevention, which can help reduce the frequency and severity of malware incidents.

		Organizations should also make users aware of policies and procedures that apply to malware incident handling, such as how to identify if a host may be infected, how to report a suspected incident, and what users need to do to assist with incident handling

		Ensuring the antivirus software alerts the users when malware is detected will ensure the user is informed of the incident and be able to more closely relate the incident to action being performed by the user at the time of the detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.
		Under the Messages tab, locate the 'Messages for local users:' label. Select the 'Show the messages dialog box when a threat is detected and display the specified text in the message' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56369r1_rule,STIG-ID|DTAM004,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6469"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "Alert_AutoShowList"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM005 - McAfee VirusScan On-Access Scanner General Settings must be configured to prevent users from removing messages from the list."
          info        : "Good incident response analysis includes reviewing all logs and alerts on the system reporting the infection. If users were permitted to remove alerts from the display, incident response forensic analysis would be inhibited."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click on Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Messages tab, locate the 'Actions available to user:' label. Uncheck the 'Remove messages from the list' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56370r1_rule,STIG-ID|DTAM005,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6470"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "Alert_UsersCanRemove"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM009 - McAfee VirusScan On-Access Scanner General Settings must be configured to log the scan sessions."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56371r1_rule,STIG-ID|DTAM009,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6474"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLogtoFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM010 - McAfee VirusScan On-Access Scanner General Settings log file size must be limited to at least 10MB (bLimitSize)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file size:' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of at least 10MB or more.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56372r1_rule,STIG-ID|DTAM010,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6475"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM010 - McAfee VirusScan On-Access Scanner General Settings log file size must be limited to at least 10MB (dwMaxLogSizeMB)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file size:' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of at least 10MB or more.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56372r1_rule,STIG-ID|DTAM010,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6475"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM012 - McAfee VirusScan On-Access Scanner General Settings must be configured to log the session summary."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Session summary' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56373r1_rule,STIG-ID|DTAM012,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6478"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLogSummary"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM013 - McAfee VirusScan On-Access Scanner General Settings must be configured to log any failure to scan encrypted files."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Failure to scan encrypted files' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56374r1_rule,STIG-ID|DTAM013,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6583"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "ReportEncryptedFiles"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM016 - McAfee VirusScan must be configured to receive DAT and Engine updates (scheduling enabled)."
          info        : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system. The antivirus software product must be configured to receive those updates automatically in order to afford the expected protection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

		Under the Task column, find the AutoUpdate option, right-click, and choose Properties.
		Click the Schedule button.
		On the Task tab, select 'Enable (scheduled task runs at specified time)'.
		On the Schedule tab, the 'Run task:' option must be configured with Daily.

		Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CAT|II,CCI|CCI-001247,CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),Rule-ID|SV-56375r2_rule,STIG-ID|DTAM016,SWIFT-CSCv1|2.2,TBA-FIISB|49.4,Vuln-ID|V-6585"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\DesktopProtection\Tasks\{A14CD6FC-3BA8-4703-87BF-e3247CE382F5}"
          reg_item    : "bSchedEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM016 - McAfee VirusScan must be configured to receive DAT and Engine updates (schedule is daily)."
          info        : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system. The antivirus software product must be configured to receive those updates automatically in order to afford the expected protection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

		Under the Task column, find the AutoUpdate option, right-click, and choose Properties.
		Click the Schedule button.
		On the Task tab, select 'Enable (scheduled task runs at specified time)'.
		On the Schedule tab, the 'Run task:' option must be configured with Daily.

		Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CAT|II,CCI|CCI-001247,CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),Rule-ID|SV-56375r2_rule,STIG-ID|DTAM016,SWIFT-CSCv1|2.2,TBA-FIISB|49.4,Vuln-ID|V-6585"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\DesktopProtection\Tasks\{A14CD6FC-3BA8-4703-87BF-e3247CE382F5}"
          reg_item    : "eScheduleType"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM021 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to enable on-delivery email scanning."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select 'Enable'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56376r2_rule,STIG-ID|DTAM021,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6586"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\GeneralOptions"
          reg_item    : "bEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM022 - McAfee VirusScan On-Delivery Email Scanner must be configured to find unknown program threats and trojans."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown program threats and trojans' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56386r2_rule,STIG-ID|DTAM022,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6587"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "dwProgramHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM023 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to find unknown macro threats."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56387r2_rule,STIG-ID|DTAM023,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6588"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "dwMacroHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM027 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to decode MIME encoded files."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Compressed files:' label. Select the 'Decode MIME encoded files' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56389r2_rule,STIG-ID|DTAM027,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6590"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "ScanMime"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM028 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to scan email message body."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Email message body (Setting for Outlook Scanner Only):' label. Select the 'Scan email message body' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56390r2_rule,STIG-ID|DTAM028,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6591"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "ScanMessageBodies"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM029 - McAfee VirusScan On Delivery Email Scanner: When a threat is found, must be configured to clean attachments as the first action."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean attachments'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56391r2_rule,STIG-ID|DTAM029,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6592"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM035 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to record scanning activity in a log file."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location.' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000130,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56392r2_rule,STIG-ID|DTAM035,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6596"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "bLogToFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM036 - McAfee VirusScan On-Delivery Email Scanner log file size must be restricted (bLimitSize)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label.

		Select the 'Limit the size of log file' option. For the 'Maximum log file size:' select a value of at least 10MB.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56393r2_rule,STIG-ID|DTAM036,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6597"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM036 - McAfee VirusScan On-Delivery Email Scanner log file size must be configured to be at least 10MB (dwMaxLogSizeMB)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label.

		Select the 'Limit the size of log file' option. For the 'Maximum log file size:' select a value of at least 10MB.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56393r2_rule,STIG-ID|DTAM036,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6597"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\Wow6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM045 - McAfee VirusScan On-Demand scan must be configured to scan all fixed or local disks."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, click the 'Add' button and add 'All fixed drives' or 'All local drives' and 'Running processes' options from the drop-down selection.

		Click OK to save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56396r2_rule,STIG-ID|DTAM045,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6599"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : ("FixedDrives" || "LocalDrives")
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { (Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.value -eq 'LocalDrives') -or ($_.value -eq 'FixedDrives') } | Select -exp Value -first 1}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM045 - McAfee VirusScan On-Demand scan must be configured to scan all running processes."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, click the 'Add' button and add 'All fixed drives' or 'All local drives' and 'Running processes' options from the drop-down selection.

		Click OK to save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56396r2_rule,STIG-ID|DTAM045,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6599"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "SpecialMemory"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Value -eq 'SpecialMemory')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM046 - McAfee VirusScan On-Demand scan must be configured to scan all subfolders."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives and folders regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, locate the 'Scan options:' label. Select the 'Include subfolders' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56397r1_rule,STIG-ID|DTAM046,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6600"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bScanSubdirs')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM047 - McAfee VirusScan On-Demand scan must be configured to scan boot sectors."
          info            : "Boot sector viruses will install into the boot sector of a system, ensuring that they will execute when the user boots the system. This risk is mitigated by scanning boot sectors at each startup of the system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, find and select the scheduled task that shows a Status of 'Daily' or 'Weekly' or any frequency other than 'Not Scheduled'.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, locate the 'Scan options:' label. Select the 'Scan boot sectors' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56398r1_rule,STIG-ID|DTAM047,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6601"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 0
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bSkipBootScan')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM048 - McAfee VirusScan On-Demand scan must be configured to scan all files."
          info            : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Item tab, locate the 'File types to scan:' label. Select the 'All files' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56399r1_rule,STIG-ID|DTAM048,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6602"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bScanAllFiles')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM050 - McAfee VirusScan On-Demand scan must be configured so there are no exclusions unless approved by the ISSO/ISSM/DAA."
          info            : "When scanning for malware, excluding specific files will increase the risk of a malware-infected file going undetected. By configuring antivirus software without any exclusions, the scanner has a higher success rate at detecting and eradicating malware."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click on the Task and select Properties.

		Under the Exclusions tab, locate the 'What not to scan:' label, remove any items.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56401r2_rule,STIG-ID|DTAM050,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6604"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 0
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'NumExcludeItems')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM052 - McAfee VirusScan On-Demand scan must be configured to scan inside archives."
          info            : "Malware is often packaged within an archive. In addition, archives might have other archives within. Not scanning archive files introduces the risk of infected files being introduced into the environment."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Options:' label. Select the 'Scan inside archives (e.g. .ZIP)' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56403r2_rule,STIG-ID|DTAM052,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6611"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ScanArchives')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM053 - McAfee VirusScan On-Demand scan must be configured to decode MIME encoded files."
          info            : "Multipurpose Internet Mail Extensions (MIME) encoded files can be crafted to hide a malicious payload. When the MIME encoded file is presented to software that decodes the MIME encoded files, such as an email client, the malware is released. Scanning these files as part of the regularly scheduled scans tasks will mitigate this risk."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Options:' label. Select the 'Decode MIME encoded files' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56404r1_rule,STIG-ID|DTAM053,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6612"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ScanMime')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM054 - McAfee VirusScan On-Demand scan must be configured to find unknown program threats."
          info            : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown program threats' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56419r1_rule,STIG-ID|DTAM054,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6614"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'dwProgramHeuristicsLevel')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM055 - McAfee VirusScan On-Demand scan must be configured to find unknown macro threats."
          info            : "Interpreted viruses are executed by an application. Within this subcategory, macro viruses take advantage of the capabilities of applications' macro programming language to infect application documents and document templates, while scripting viruses infect scripts that are understood by scripting languages processed by services on the OS. Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. The scanning for unknown macro viruses will mitigate zero day attacks."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56409r1_rule,STIG-ID|DTAM055,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6615"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'dwMacroHeuristicsLevel')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM056 - McAfee VirusScan On-Demand scan actions, When a threat is found must be configured to clean files automatically as first action."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option so as to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean'.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56420r1_rule,STIG-ID|DTAM056,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6616"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 5
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'uAction')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM057 - McAfee VirusScan On-Demand scan actions must be configured to delete files automatically if first action fails."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option so as to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete'.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56414r1_rule,STIG-ID|DTAM057,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6617"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 4
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'uSecAction')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM059 - McAfee VirusScan On-Demand scan must be configured to record scanning activity in a log file."
          info            : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56422r1_rule,STIG-ID|DTAM059,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6618"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLogToFile')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM060 - McAfee VirusScan On-Demand scan log file size must be restricted."
          info            : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label.
		Select the 'Limit the size of log file' option.
		Under 'Maximum log file size:', choose a value of at least 10MB.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56425r1_rule,STIG-ID|DTAM060,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6620"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLimitSize')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM060 - McAfee VirusScan On-Demand scan log file size must be configured to at least 10MB."
          info            : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label.
		Select the 'Limit the size of log file' option.
		Under 'Maximum log file size:', choose a value of at least 10MB.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56425r1_rule,STIG-ID|DTAM060,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6620"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "True"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq ' ')} | Select -exp Value -first 1 ) }; if ($results -lt 10240) { write-host 'False'} else { write-host 'True'};"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM063 - McAfee VirusScan On-Demand scan must be configured to log any failure to scan encrypted files."
          info            : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Failure to scan encrypted files' option.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56423r1_rule,STIG-ID|DTAM063,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6625"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLogScanEncryptFail')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type            : AUDIT_POWERSHELL
              description     : "bschedenabled == 1"
              value_type      : POLICY_TEXT
              value_data      : 1
              powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bSchedEnabled')} | Select -exp Value -first 1 ) }; write-host ${results}"
            </custom_item>

            <custom_item>
              type            : AUDIT_POWERSHELL
              description     : "escheduletype == 1 || 0"
              value_type      : POLICY_TEXT
              value_data      : 0 || 1
              powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'eScheduletype')} | Select -exp Value -first 1 ) }; write-host ${results}"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTAM070 - McAfee VirusScan On-Demand scan must be scheduled to be executed at least on a weekly basis."
              info        : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Click on the Schedule button.
				Under the Task tab, select 'Enabled'.
				Under the Schedule tab, find the 'Run Task: ' label and set to at least 'Weekly'.


				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001241,Rule-ID|SV-56426r1_rule,STIG-ID|DTAM070,Vuln-ID|V-6627"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTAM070 - McAfee VirusScan On-Demand scan must be scheduled to be executed at least on a weekly basis."
              info        : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Click on the Schedule button.
				Under the Task tab, select 'Enabled'.
				Under the Schedule tab, find the 'Run Task: ' label and set to at least 'Weekly'.


				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001241,Rule-ID|SV-56426r1_rule,STIG-ID|DTAM070,Vuln-ID|V-6627"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM090 - McAfee VirusScan On-Access Scanner General Settings must be configured to enable scanning of scripts."
          info        : "Interpreted viruses are executed by an application. Within this subcategory, macro viruses take advantage of the capabilities of applications' macro programming language to infect application documents and document templates, while scripting viruses infect scripts that are understood by scripting languages processed by services on the OS. Many attackers use toolkits containing several different types of utilities and script that can be used to probe and attack hosts. (NIST SP 800-83) The scanning of scripts is crucial in preventing these attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the ScriptScan tab, locate the 'ScriptScan:' label. Select the 'Enable scanning of scripts' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,Rule-ID|SV-56400r1_rule,STIG-ID|DTAM090,Vuln-ID|V-14618"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Script Scanner\"
          reg_item    : "ScriptScanEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM091 - McAfee VirusScan On-Access Scanner General Settings must be configured to block connections for threatened files in shared folders"
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Select the 'Block the connection when a threat is detected in a shared folder' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56402r1_rule,STIG-ID|DTAM091,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14619"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlock"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM092 - McAfee VirusScan On-Access Scanner General Settings must be configured to unblock connections after a minimum of 30 minutes."
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Enter a value in 'Unblock connections after (minutes)' where x is set to no less than 30 minutes.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56406r1_rule,STIG-ID|DTAM092,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14620"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 30
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlockTimeout"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM093 - McAfee VirusScan must be configured to block connections when files with potentially unwanted programs are detected."
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Select the 'Block the connection when a file with a potentially unwanted program is detected in a shared folder' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56408r1_rule,STIG-ID|DTAM093,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14621"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlockOnNonVirus"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM100 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to use only one scanning policy for all processes."
          info        : "Organizations should use centrally managed antivirus software that is controlled and monitored regularly by antivirus administrators, who are also typically responsible for acquiring, testing, approving, and delivering antivirus signatures and software updates through the organizations. (FISMA SP 800-83) Some processes are known to be higher risk, while others are low risk. By restricting policy configuration to the Default Processes policy, all processes will be interpreted equally when applying the policy settings and will provide the highest level of protection. Best practice dictates configuring Low Risk and/or High Risk policies only when it is necessary to improve system performance, and will focus the scanning where it is most likely to detect malware. There is risk associated with configuring the Low Risk and/or High Risk policies for the purpose of specifically excluding processes from scanning, and should only be done after evaluating other policy settings and determining risk."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Processes tab, select the 'Configure one scanning policy for all processes' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56410r1_rule,STIG-ID|DTAM100,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14622"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "OnlyUseDefaultConfig"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM101 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan when writing to disk."
          info        : "Antivirus software is the most commonly used technical control for malware threat mitigation. Real-time scanning of files as they are written to disk is a crucial first line of defense from malware attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Scan files:' label. Select the 'When writing to disk' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56413r1_rule,STIG-ID|DTAM101,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14623"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "bScanIncoming"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM102 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan when reading from disk."
          info        : "Antivirus software is the most commonly used technical control for malware threat mitigation. Real-time scanning of files as they are read from disk is a crucial first line of defense from malware attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Scan files:' label. Select the 'When reading from disk' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56429r1_rule,STIG-ID|DTAM102,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14624"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "bScanOutgoing"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "LocalExtensionMode == 1"
              value_type  : POLICY_DWORD
              value_data  : 1
              reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
              reg_item    : "LocalExtensionMode"
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "NetworkExtensionMode == 1"
              value_type  : POLICY_DWORD
              value_data  : 1
              reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
              reg_item    : "NetworkExtensionMode"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTAM103 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan all files."
              info        : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'What to scan:' label. Select the 'All Files' radio button option.

				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-56430r1_rule,STIG-ID|DTAM103,Vuln-ID|V-14625"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTAM103 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan all files."
              info        : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'What to scan:' label. Select the 'All Files' radio button option.

				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-56430r1_rule,STIG-ID|DTAM103,Vuln-ID|V-14625"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM104 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to find unknown unwanted programs and trojans."
          info        : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown unwanted programs and trojans' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56431r1_rule,STIG-ID|DTAM104,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14626"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "dwProgramHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM105 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to find unknown macro viruses."
          info        : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56432r1_rule,STIG-ID|DTAM105,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14627"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "dwMacroHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM106 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan inside archive files."
          info        : "Malware is often packaged within an archive. In addition, archives might have other archives within. Not scanning archive files introduces the risk of infected files being introduced into the environment."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Compressed files:' label. Select the 'Scan inside archives (e.g., .ZIP)' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56433r3_rule,STIG-ID|DTAM106,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14628"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "ScanArchives"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM110 - McAfee VirusScan: When a threat is found, scanner must be configured to clean files automatically as first action."
          info        : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Actions tab, locate the 'When a threat is found:' label. For the 'Perform this action first:' pull down menu, select 'Clean files automatically'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56427r1_rule,STIG-ID|DTAM110,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14630"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM111 - McAfee VirusScan: When a threat is found must be configured to delete files automatically if first action fails."
          info        : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Actions tab, locate the 'When a threat is found:' label. For the 'If the first action fails, then perform this action:' pull down menu, select 'Delete files automatically'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56428r1_rule,STIG-ID|DTAM111,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14631"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uSecAction"
        </custom_item>

        <report type:"PASSED">
          description : "DTAM130 - McAfee VirusScan Buffer Overflow Protection Settings must be configured to enable Buffer Overflow Protection."
          info        : "Buffer overflow is an anomaly where a program, while writing data to a buffer, overruns the buffer's boundary and overwrites adjacent memory. This anomaly has been used maliciously, explicitly to craft exploits. Buffer overflow attacks compose greater than 25% of malware attacks. Without buffer overflow protection enabled, systems are more vulnerable to attacks that attempt to overwrite adjacent memory in the stack frame. Buffer overflow protection is only configurable on non-64-bit systems.

	  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer Overflow settings:' label. Select the 'Enable buffer overflow protection' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56434r1_rule,STIG-ID|DTAM130,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14657"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "DTAM131 - McAfee VirusScan Buffer Overflow Protection Settings must be configured for Protection mode."
          info        : "Buffer overflow is an anomaly where a program, while writing data to a buffer, overruns the buffer's boundary and overwrites adjacent memory. This anomaly has been used maliciously, explicitly to craft exploits. Buffer overflow attacks compose greater than 25% of malware attacks. Without buffer overflow protection enabled, systems are more vulnerable to attacks that attempt to overwrite adjacent memory in the stack frame. Buffer overflow protection is only configurable on non-64-bit systems.

		      NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer Overflow settings:' label. Select the 'Protection mode' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56435r1_rule,STIG-ID|DTAM131,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14658"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "DTAM132 - McAfee VirusScan Buffer Overflow Protection Settings must be configured to display a dialog box when buffer overflow is detected."
          info        : "An effective awareness program explains proper rules of behavior for use of an organization's IT systems and information. Accordingly, awareness programs should include guidance to users on malware incident prevention, which can help reduce the frequency and severity of malware incidents.

		Organizations should also make users aware of policies and procedures that apply to malware incident handling, such as how to identify if a host may be infected, how to report a suspected incident, and what users need to do to assist with incident handling.

		Ensuring the antivirus software alerts the users when a Buffer Overflow is detected will ensure the user is aware of the incident and be able to more closely relate the incident to action being performed by the user at the time of the detection.

	   NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer overflow settings' label. Select the 'Show the messages dialog box when a buffer overflow is detected' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56424r1_rule,STIG-ID|DTAM132,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14659"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "DTAM133 - McAfee VirusScan Buffer Overflow Protection Reports Settings must be configured to log buffer overflow protection scan activity."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems.

	  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56421r1_rule,STIG-ID|DTAM133,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14660"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "DTAM134 - McAfee VirusScan Buffer Overflow Protection Reports Settings log file size must be limited to at least 10MB. (bLimitSize_Ent)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value.

	  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56418r1_rule,STIG-ID|DTAM134,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14661"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "DTAM134 - McAfee VirusScan Buffer Overflow Protection Reports Settings log file size must be limited to at least 10MB. (dwMaxLogSizeMB_Ent)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value.

	   NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56418r1_rule,STIG-ID|DTAM134,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14661"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM039 - McAfee VirusScan On Delivery Email Scanner must be configured to clean attachments as its first action."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Actions tab, locate the 'When an unwanted attachment is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean attachments'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56394r2_rule,STIG-ID|DTAM039,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14652"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uAction_Program"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM058 - McAfee VirusScan On-Demand scan must be configured to detect for unwanted programs."
          info            : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Scan Items tab, locate the 'Options:' label. Select the 'Detect unwanted programs' option.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56416r1_rule,STIG-ID|DTAM058,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14654"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "True"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ApplyNVP')} | Select -exp Value -first 1 ) }; if ($results -eq 0) { write-host 'False'} else { write-host 'True'};"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM135 - McAfee VirusScan Unwanted Programs Policy must be configured to detect spyware."
          info        : "Spyware is software that aids in gathering information about a person or organization without their knowledge, and that may send such information to another entity without the consumer's consent, or that asserts control over a computer without the user's knowledge. Spyware may try to deceive users by bundling itself with desirable software. A spyware infestation can create significant unwanted CPU activity, disk usage, and network traffic. Some types of spyware disable software firewalls and antivirus software. Detecting, blocking, and eradicating malicious spyware or preventing it from being installed will alleviate the negative side effects of the spyware."
          solution    : "Access the local VirusScan console by clicking on Start->All Programs->McAfee->VirusScan Console.

Under the Task column, find the Unwanted Programs Policy, right-click, and choose Properties.
In the Scan Items tab, select the Spyware option.

Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56415r1_rule,STIG-ID|DTAM135,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14662"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\NVP"
          reg_item    : "DetectSpyware"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM136 -  McAfee VirusScan Unwanted Programs Policy must be configured to detect adware."
          info        : "Adware, like spyware, is, at best, an annoyance by presenting unwanted advertisements to the user of a computer, sometimes in the form of a popup. At worst, it redirects the user to malicious websites. Detecting and blocking will mitigate the likelihood of users being tricked into visiting sites with malicious content."
          solution    : "Access the local VirusScan console by clicking on Start->All Programs->McAfee->VirusScan Console.

Under the Task column, find the Unwanted Programs Policy, right-click, and choose Properties.
In the Scan Items tab, select the Adware option.

Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001243,CSF|PR.AC-4,Rule-ID|SV-56411r1_rule,STIG-ID|DTAM136,Vuln-ID|V-14663"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\NVP"
          reg_item    : "DetectAdware"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAG008 - The antivirus signature file age must not exceed 7 days."
          info            : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console. Under the Task column, select the AutoUpdate option, right-click, and select 'Start'."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|I,CCI|CCI-001240,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56366r2_rule,STIG-ID|DTAG008,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-19910"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "False"
          powershell_args : "((get-date -uformat %s) - (get-date -Year (Get-ItemProperty 'HKLM:\SOFTWARE\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateYear) -Month (Get-ItemProperty 'HKLM:\SOFTWARE\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateMonth) -Day (Get-ItemProperty 'HKLM:\SOFTWARE\Wow6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateDay) -UFormat %s)) -gt 604800"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM137 - McAfee VirusScan On-Access Scanner: Artemis Heuristic network check for suspicious files must be enabled. (ArtemisEnabled)"
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the General tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56405r1_rule,STIG-ID|DTAM137,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-35027"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner"
          reg_item    : "ArtemisEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM137 - McAfee VirusScan On-Access Scanner: Artemis Heuristic network check for suspicious files must be enabled. (ArtemisLevel)"
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the General tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56405r1_rule,STIG-ID|DTAM137,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-35027"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [2..4]
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner"
          reg_item    : "ArtemisLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM162 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to delete attachments if the first action fails."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc. from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Actions tab, locate the 'When a threat is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete attachments'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55227r2_rule,STIG-ID|DTAM162,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42514"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uSecAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM163 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to delete attachments if the first action fails."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc. from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Actions tab, locate the 'When an unwanted attachment is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete attachments'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55229r2_rule,STIG-ID|DTAM163,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42515"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uSecAction_Program"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM138 - McAfee VirusScan Access Protection Rules must be configured to prevent McAfee services from being stopped."
          info        : "When the 'Prevent McAfee services from being stopped' check box is selected under Access Protection, VSE will prevent anyone except the System account from terminating McAfee services. This protects VirusScan from being disabled by malicious programs that seek to circumvent virus protection programs by terminating their services."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, select the 'Prevent McAfee services from being stopped' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001242,CSF|PR.AC-4,Rule-ID|SV-55277r2_rule,STIG-ID|DTAM138,Vuln-ID|V-42549"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "PVSPTEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM139 - McAfee VirusScan Access Protection Reports settings must be configured to record scanning activity in a log file."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000130,CSF|PR.AC-4,Rule-ID|SV-55278r2_rule,STIG-ID|DTAM139,Vuln-ID|V-42550"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLogToFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM140 - McAfee VirusScan Access Protection Reports log file size must be restricted."
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log File' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000140,CSF|PR.AC-4,Rule-ID|SV-55279r2_rule,STIG-ID|DTAM140,Vuln-ID|V-42551"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM140 - McAfee VirusScan Access Protection Reports log file size must be configured to at least 10MB."
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log File' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000140,CSF|PR.AC-4,Rule-ID|SV-55279r2_rule,STIG-ID|DTAM140,Vuln-ID|V-42551"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <report type:"WARNING">
          description : "DTAM141 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of McAfee files and settings."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label.
				In the 'Categories' box, select 'Common Standard Protection'.
				Select 'Prevent modification of McAfee files and settings' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55280r2_rule,STIG-ID|DTAM141,Vuln-ID|V-42552"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM142 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of CMA files and settings."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select 'Prevent modification of McAfee Common Management Agent files and settings' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55281r2_rule,STIG-ID|DTAM142,Vuln-ID|V-42553"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM143 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of McAfee Scan Engine files."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label.
				In the 'Categories' box, select 'Common Standard Protection'.
				Select 'Prevent modification of McAfee Scan Engine files and settings' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55282r2_rule,STIG-ID|DTAM143,Vuln-ID|V-42554"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM144 - McAfee VirusScan Access Protection Rules Common Standard Protection must be set to prevent termination of McAfee processes."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select 'Prevent termination of McAfee processes' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-000213,Rule-ID|SV-55283r2_rule,STIG-ID|DTAM144,Vuln-ID|V-42555"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM145 - McAfee VirusScan Access Protection Rules CSP must be set to block/report when programs are run from Temp folder."
          info        : "This rule will block any common programs from running from the Temp directory; however, this rule is much more restrictive in that it stops nearly all processes from launching in the Temp folder. Most viruses need to be run once by a person before infecting a computer. This can be done in many ways, such as opening an executable attachment in an email or downloading a program from the Internet. An executable needs to exist on the disk before Windows can run it. A common way for applications to achieve this is to save the file in the user's or system's Temp directory and then run it. One purpose of this rule is to enforce advice that is frequently given to users: 'do not open attachments from email.' The other purpose of this rule is to close security holes introduced by application bugs. Older versions of Outlook and Internet Explorer are notorious for automatically executing code without the user needing to do anything but preview an email or view a website.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select the 'Prevent common programs from running files from the temp folder' (Block and Report) option.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55284r5_rule,STIG-ID|DTAM145,Vuln-ID|V-42556"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM146 - McAfee VirusScan Access Protection Rules Common Standard Protection must be set to prevent hooking of McAfee processes."
          info        : "Hooking covers a range of techniques used to alter or augment the behavior of an operating system, of applications, or of other software components by intercepting function calls or messages or events passed between software components. Code that handles such intercepted function calls, events, or messages is called a 'hook'. Hooking can also be used by malicious code. For example, rootkits, pieces of software that try to make themselves invisible by faking the output of API calls that would otherwise reveal their existence, often use hooking techniques. This rule prevents other processes from hooking of McAfee processes.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select both 'Prevent hooking of McAfee processes' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55285r2_rule,STIG-ID|DTAM146,Vuln-ID|V-42557"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM147 - McAfee VirusScan Access Protection Rules CMP must be set to detect and log files launched from Downloaded Programs Files folder."
          info        : "A common distribution method for adware and spyware is to have the user download an executable file and run it automatically from the Downloaded Program Files folder. This rule is specific to Microsoft Internet Explorer and prevents software installations through the web browser. Internet Explorer runs code from the Downloaded Program Files directory, notably ActiveX controls. Some vulnerabilities in Internet Explorer and viruses place an .exe file into this directory and run it. This rule closes that attack vector.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Maximum Protection'. Select the 'Prevent launching of files from the Downloaded Program Files folder' (Report) option.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001169,Rule-ID|SV-55286r2_rule,STIG-ID|DTAM147,Vuln-ID|V-42558"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM148 - McAfee VirusScan Access Protection: Anti-Spyware Maximum Protection must be set to block and log scripts from the Temp folder."
          info        : "This rule prevents the Windows scripting host from running VBScript and JavaScript scripts from the Temp directory. This would protect against a large number of trojans and questionable web installation mechanisms that are used by many adware and spyware applications.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Spyware Maximum Protection'. Select the 'Prevent execution of scripts from the Temp folder' (Block and Report) option.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55287r6_rule,STIG-ID|DTAM148,Vuln-ID|V-42559"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM149 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must be set to prevent remote creation of autorun files."
          info        : "Autorun files are used to automatically launch program files, typically setup files from CDs. Preventing other computers from making a connection and creating or altering autorun.inf files can prevent spyware and adware from being executed. There are many spyware and virus programs distributed on CDs.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'.
				Select 'Prevent remote creation of autorun files' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-55288r2_rule,STIG-ID|DTAM149,Vuln-ID|V-42560"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM150 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must prevent mass mailing worms from sending mail."
          info        : "Many viruses and worms find email addresses on the infected system and send themselves to these addresses. They do this by connecting directly to the email servers whose names they have harvested from the local system. This rule prevents any process from talking to a foreign email server using SMTP. By blocking this communication, a machine may become infected with a new mass-mailing virus, but that virus will be unable to spread further by email. It prevents outbound access to SMTP ports 25 and 587 on all programs except known email clients listed as an exclusion.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'. Select both 'Prevent mass mailing worms from sending email' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001170,Rule-ID|SV-55289r2_rule,STIG-ID|DTAM150,Vuln-ID|V-42561"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM151 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must be set to prevent IRC communication."
          info        : "Internet Relay Chat (IRC) is the preferred communication method used by botnet herders and remote-access trojans to control botnets (a set of scripts or an independent program that connects to IRC). IRC allows an attacker to control infected machines that are sitting behind network address translation (NAT), and the bot can be configured to connect back to the command and control server listening on any port.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'. Select both 'Prevent IRC communication' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001170,Rule-ID|SV-55290r3_rule,STIG-ID|DTAM151,Vuln-ID|V-42562"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM152 - McAfee VirusScan On-Access Scanner General Settings must be configured to not exclude any script processes from being scanned."
          info        : "Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. All scripts should be scanned and none should be excluded from scanning."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the ScriptScan tab, locate the 'ScriptScan process exclusions' label. Remove any exclusions listed in the Process field."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55291r2_rule,STIG-ID|DTAM152,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42563"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_MULTI_TEXT
          value_data  : ""
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Script Scanner"
          reg_item    : "ExcludedProcesses"
          reg_option  : CAN_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM153 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to not exclude any files from being scanned."
          info        : "When scanning for malware, excluding specific files will increase the risk of a malware-infected file going undetected. By configuring antivirus software without any exclusions, the scanner has a higher success rate at detecting and eradicating malware."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Exclusions tab, locate the 'What not to scan:' label. Remove any exclusions listed."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55292r3_rule,STIG-ID|DTAM153,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42564"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "NumExcludeItems"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM154 - McAfee VirusScan On-Demand scan must be configured to scan memory for rootkits."
          info            : "A rootkit is a stealthy type of software, usually malicious, and is designed to mask the existence of processes or programs from normal methods of detection. Rootkits will often enable continued privileged access to a computer. Scanning and handling detection of rootkits will mitigate the likelihood of rootkits being installed and used maliciously on the system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, select 'Memory for rootkits' from the drop-down selection box.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55293r1_rule,STIG-ID|DTAM154,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42565"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "SpecialScanForRootkits"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'szScanItem*') -and ($_.Value -eq 'SpecialScanForRootkits') } | Select -exp Value) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM155 - McAfee VirusScan On-Demand scan actions: unwanted programs must be cleaned automatically as first action."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task,  with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Actions tab, locate the 'When an unwanted program is found:' label. For the 'Perform this action first:' pull down menu, select 'Clean'.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55294r1_rule,STIG-ID|DTAM155,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42566"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 5
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'uAction_Program') } | Select -exp Value -first 1) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM164 - McAfee VirusScan On-Demand scan actions, must be configured to delete unwanted programs automatically if first action fails."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Actions tab, locate the 'When an unwanted program is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete'.

				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55295r1_rule,STIG-ID|DTAM164,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42567"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 4
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\WOW6432Node\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'uSecAction_Program') } | Select -exp Value -first 1) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM157 - McAfee VirusScan On-Delivery Email Scanner Artemis must be enabled."
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Scan Items tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55297r2_rule,STIG-ID|DTAM157,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42569"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner"
          reg_item    : "ArtemisEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM157 - McAfee VirusScan On-Delivery Email Scanner Artemis sensitivity level must be configured to Medium or higher."
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Scan Items tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55297r2_rule,STIG-ID|DTAM157,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42569"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [2..4]
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner"
          reg_item    : "ArtemisLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM158 - McAfee VirusScan On-Delivery Email Scanner must send a notification email when a threatening email message is detected."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Alerts tab, locate the 'Email alert:' label.
				Click on Configure. Select the 'Send alert to mail user:' option. Enter the email recipient information for the notification email to be sent to the ISSO, ISSM,ePO administrator, or System Administrator.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55298r2_rule,STIG-ID|DTAM158,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42570"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\AlertOptions"
          reg_item    : "bSendMailToUser"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM158 - McAfee VirusScan On-Delivery Email Scanner must send a notification email to the IAO when a threatening email message is detected."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Alerts tab, locate the 'Email alert:' label.
				Click on Configure. Select the 'Send alert to mail user:' option. Enter the email recipient information for the notification email to be sent to the ISSO, ISSM,ePO administrator, or System Administrator.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55298r2_rule,STIG-ID|DTAM158,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42570"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_TEXT
# Note: Variable @NOTIFICATION_EMAIL@ replaced with "person@service.mil" in field "value_data".
          value_data  : "person@service.mil"
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\AlertOptions"
          reg_item    : "szSendTo"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM159 - McAfee VirusScan On-Delivery Email Scanner must be configured to log session summary and failure to scan encrypted files."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Session summary' and 'Failure to scan encrypted files' options.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000130,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55299r3_rule,STIG-ID|DTAM159,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42571"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 416
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "dwLogEvent"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM160 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to not exclude any script URLs from being scanned."
          info        : "Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. All scripts should be scanned and none should be excluded from scanning."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the ScriptScan tab, locate the 'ScriptScan exclusions' label. Ensure there are no exclusions listed in the URL field."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55300r2_rule,STIG-ID|DTAM160,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42572"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_MULTI_TEXT
          value_data  : ""
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\Script Scanner"
          reg_item    : "ExcludedURLs"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM161 - McAfee VirusScan Access Protection Properties must be configured to enable access protection."
          info        : "Access Protection prevents unwanted changes to a computer by restricting access to specified ports, files and folders, shares, and registry keys and values. It prevents users from stopping McAfee processes and services, which are critical before and during outbreaks. Access Protection for VSE uses predefined and user-defined rules to strengthen systems against virus attacks. For instance, rules are used to specify which items can and cannot be accessed. Each rule can be configured to block and/or report access violations when they occur, and rules can also be disabled."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, select the 'Enable Access Protection' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001243,CSF|PR.AC-4,Rule-ID|SV-55301r3_rule,STIG-ID|DTAM161,Vuln-ID|V-42573"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "APEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM165 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to detect unwanted programs."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'Unwanted programs detection:' label.

				Place a check in the 'Detect unwanted programs' checkbox.

				Click OK."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55302r1_rule,STIG-ID|DTAM165,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42574"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "ApplyNVP"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM166 - McAfee VirusScan On-Access Scanner must be configured to clean unwanted programs automatically as first action."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Actions tab, locate the  'When an unwanted program is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean files automatically'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55303r1_rule,STIG-ID|DTAM166,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42575"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uAction_Program"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM167 - McAfee VirusScan On-Access Scanner must be configured to delete unwanted programs automatically if first action fails."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Actions tab, locate the  'When an unwanted program is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete files automatically'.
				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55304r1_rule,STIG-ID|DTAM167,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42576"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\WOW6432Node\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uSecAction_Program"
        </custom_item>

        <report type:"WARNING">
          description : "DTAM170 - Anti-spyware Maximum Protection must be set to block and report when block execution of all programs from temp folder"
          info        : "DTAM170 - McAfee VirusScan Access Protection Rules Anti-spyware Maximum Protection must be set to block and report when block execution of all programs from temp folder
          This rule will block any executable from running from the Temp directory; however, this rule is much more restrictive in that it stops nearly all processes from launching in the Temp folder. This provides the most protection, but also has a higher chance of blocking a legitimate application from being installed.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Spyware Maximum Protection'. Select both 'Prevent all programs from running files from the Temp folder' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-73795r3_rule,STIG-ID|DTAM170,Vuln-ID|V-59365"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>
      </then>

      <else>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM001 - McAfee VirusScan On-Access Scanner General Settings must be configured to enable on-access scanning at system startup."
          info        : "For Antivirus software to be effective, it must be running at all times, beginning from the point of the system's initial startup. Otherwise, the risk is greater for viruses, trojans, and other malware infecting the system during that startup phase."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.

		Under the General tab, locate the 'General:' label. Select the 'Enable on-access scanning at system startup' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|I,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56365r1_rule,STIG-ID|DTAM001,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6453"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bStartDisabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM002 -  McAfee VirusScan On-Access Scanner General Settings must be configured to scan boot sectors."
          info        : "Boot sector viruses will install into the boot sector of a system, ensuring that they will execute when the user boots the system. This risk is mitigated by scanning boot sectors at each startup of the system."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties. Select the General Settings.
		Under the General tab, locate the 'Scan:' label. Select the 'Boot Sectors' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56367r1_rule,STIG-ID|DTAM002,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6467"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bDontScanBootSectors"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM003 - McAfee VirusScan On-Access Scanner General Settings must be configured to scan floppy during shutdown."
          info        : "Computer viruses in the early days of personal computing were almost exclusively passed around by floppy disks. Floppy disks would be used to boot the computer and, if infected, would infect the hard drive files, as well. Although floppy drives have fallen out of use, it is still a good security practice, whenever the antivirus software allows, to enable the scanning software to scan a floppy disk at shutdown."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the General tab, locate the 'Scan:' label. Select the 'Floppy during shutdown' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56368r1_rule,STIG-ID|DTAM003,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6468"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bScanFloppyonShutdown"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM004 -  McAfee VirusScan On-Access Scanner General Settings must be configured to notify local users when detections occur."
          info        : "An effective awareness program explains proper rules of behavior for use of an organization's IT systems and information. Accordingly, awareness programs should include guidance to users on malware incident prevention, which can help reduce the frequency and severity of malware incidents.

		Organizations should also make users aware of policies and procedures that apply to malware incident handling, such as how to identify if a host may be infected, how to report a suspected incident, and what users need to do to assist with incident handling

		Ensuring the antivirus software alerts the users when malware is detected will ensure the user is informed of the incident and be able to more closely relate the incident to action being performed by the user at the time of the detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.
		Under the Messages tab, locate the 'Messages for local users:' label. Select the 'Show the messages dialog box when a threat is detected and display the specified text in the message' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56369r1_rule,STIG-ID|DTAM004,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6469"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "Alert_AutoShowList"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM005 - McAfee VirusScan On-Access Scanner General Settings must be configured to prevent users from removing messages from the list."
          info        : "Good incident response analysis includes reviewing all logs and alerts on the system reporting the infection. If users were permitted to remove alerts from the display, incident response forensic analysis would be inhibited."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click on Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Messages tab, locate the 'Actions available to user:' label. Uncheck the 'Remove messages from the list' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56370r1_rule,STIG-ID|DTAM005,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6470"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "Alert_UsersCanRemove"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM009 - McAfee VirusScan On-Access Scanner General Settings must be configured to log the scan sessions."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56371r1_rule,STIG-ID|DTAM009,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6474"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLogtoFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM010 - McAfee VirusScan On-Access Scanner General Settings log file size must be limited to at least 10MB (bLimitSize)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file size:' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of at least 10MB or more.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56372r1_rule,STIG-ID|DTAM010,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6475"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM010 - McAfee VirusScan On-Access Scanner General Settings log file size must be limited to at least 10MB (dwMaxLogSizeMB)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'Log file size:' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of at least 10MB or more.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56372r1_rule,STIG-ID|DTAM010,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6475"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM012 - McAfee VirusScan On-Access Scanner General Settings must be configured to log the session summary."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Session summary' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56373r1_rule,STIG-ID|DTAM012,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6478"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "bLogSummary"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM013 - McAfee VirusScan On-Access Scanner General Settings must be configured to log any failure to scan encrypted files."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Failure to scan encrypted files' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56374r1_rule,STIG-ID|DTAM013,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6583"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "ReportEncryptedFiles"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM016 - McAfee VirusScan must be configured to receive DAT and Engine updates (scheduling enabled)."
          info        : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system. The antivirus software product must be configured to receive those updates automatically in order to afford the expected protection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

		Under the Task column, find the AutoUpdate option, right-click, and choose Properties.
		Click the Schedule button.
		On the Task tab, select 'Enable (scheduled task runs at specified time)'.
		On the Schedule tab, the 'Run task:' option must be configured with Daily.

		Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CAT|II,CCI|CCI-001247,CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),Rule-ID|SV-56375r2_rule,STIG-ID|DTAM016,SWIFT-CSCv1|2.2,TBA-FIISB|49.4,Vuln-ID|V-6585"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\DesktopProtection\Tasks\{A14CD6FC-3BA8-4703-87BF-e3247CE382F5}"
          reg_item    : "bSchedEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM016 - McAfee VirusScan must be configured to receive DAT and Engine updates (schedule is daily)."
          info        : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system. The antivirus software product must be configured to receive those updates automatically in order to afford the expected protection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

		Under the Task column, find the AutoUpdate option, right-click, and choose Properties.
		Click the Schedule button.
		On the Task tab, select 'Enable (scheduled task runs at specified time)'.
		On the Schedule tab, the 'Run task:' option must be configured with Daily.

		Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CAT|II,CCI|CCI-001247,CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),Rule-ID|SV-56375r2_rule,STIG-ID|DTAM016,SWIFT-CSCv1|2.2,TBA-FIISB|49.4,Vuln-ID|V-6585"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\McAfee\DesktopProtection\Tasks\{A14CD6FC-3BA8-4703-87BF-e3247CE382F5}"
          reg_item    : "eScheduleType"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM021 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to enable on-delivery email scanning."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select 'Enable'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56376r2_rule,STIG-ID|DTAM021,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6586"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\GeneralOptions"
          reg_item    : "bEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM022 - McAfee VirusScan On-Delivery Email Scanner must be configured to find unknown program threats and trojans."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown program threats and trojans' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56386r2_rule,STIG-ID|DTAM022,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6587"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "dwProgramHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM023 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to find unknown macro threats."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001662,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56387r2_rule,STIG-ID|DTAM023,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6588"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "dwMacroHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM027 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to decode MIME encoded files."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Compressed files:' label. Select the 'Decode MIME encoded files' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56389r2_rule,STIG-ID|DTAM027,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6590"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "ScanMime"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM028 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to scan email message body."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Scan Items tab, locate the 'Email message body (Setting for Outlook Scanner Only):' label. Select the 'Scan email message body' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001170,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56390r2_rule,STIG-ID|DTAM028,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6591"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\DetectionOptions"
          reg_item    : "ScanMessageBodies"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM029 - McAfee VirusScan On Delivery Email Scanner: When a threat is found, must be configured to clean attachments as the first action."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean attachments'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56391r2_rule,STIG-ID|DTAM029,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6592"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM035 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to record scanning activity in a log file."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location.' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000130,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56392r2_rule,STIG-ID|DTAM035,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6596"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "bLogToFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM036 - McAfee VirusScan On-Delivery Email Scanner log file size must be restricted (bLimitSize)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label.

		Select the 'Limit the size of log file' option. For the 'Maximum log file size:' select a value of at least 10MB.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56393r2_rule,STIG-ID|DTAM036,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6597"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM036 - McAfee VirusScan On-Delivery Email Scanner log file size must be configured to be at least 10MB (dwMaxLogSizeMB)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted. If the data in the log file exceeds the file size set, the oldest 20 percent of the entries are deleted and new data is appended to the file, so although the file size is restricted, it must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label.

		Select the 'Limit the size of log file' option. For the 'Maximum log file size:' select a value of at least 10MB.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000140,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56393r2_rule,STIG-ID|DTAM036,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6597"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM045 - McAfee VirusScan On-Demand scan must be configured to scan all fixed or local disks."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, click the 'Add' button and add 'All fixed drives' or 'All local drives' and 'Running processes' options from the drop-down selection.

		Click OK to save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56396r2_rule,STIG-ID|DTAM045,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6599"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : ("FixedDrives" || "LocalDrives")
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { (Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.value -eq 'LocalDrives') -or ($_.value -eq 'FixedDrives') } | Select -exp Value -first 1}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM045 - McAfee VirusScan On-Demand scan must be configured to scan all running processes."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, click the 'Add' button and add 'All fixed drives' or 'All local drives' and 'Running processes' options from the drop-down selection.

		Click OK to save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56396r2_rule,STIG-ID|DTAM045,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6599"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "SpecialMemory"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Value -eq 'SpecialMemory')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM046 - McAfee VirusScan On-Demand scan must be configured to scan all subfolders."
          info            : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives and folders regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, locate the 'Scan options:' label. Select the 'Include subfolders' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56397r1_rule,STIG-ID|DTAM046,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6600"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bScanSubdirs')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM047 - McAfee VirusScan On-Demand scan must be configured to scan boot sectors."
          info            : "Boot sector viruses will install into the boot sector of a system, ensuring that they will execute when the user boots the system. This risk is mitigated by scanning boot sectors at each startup of the system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, find and select the scheduled task that shows a Status of 'Daily' or 'Weekly' or any frequency other than 'Not Scheduled'.
		Right-click the Task and select Properties.

		Under the Scan Locations tab, locate the 'Scan options:' label. Select the 'Scan boot sectors' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56398r1_rule,STIG-ID|DTAM047,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6601"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 0
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bSkipBootScan')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM048 - McAfee VirusScan On-Demand scan must be configured to scan all files."
          info            : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Item tab, locate the 'File types to scan:' label. Select the 'All files' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56399r1_rule,STIG-ID|DTAM048,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6602"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bScanAllFiles')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM050 - McAfee VirusScan On-Demand scan must be configured so there are no exclusions unless approved by the ISSO/ISSM/DAA."
          info            : "When scanning for malware, excluding specific files will increase the risk of a malware-infected file going undetected. By configuring antivirus software without any exclusions, the scanner has a higher success rate at detecting and eradicating malware."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click on the Task and select Properties.

		Under the Exclusions tab, locate the 'What not to scan:' label, remove any items.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56401r2_rule,STIG-ID|DTAM050,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6604"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 0
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'NumExcludeItems')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM052 - McAfee VirusScan On-Demand scan must be configured to scan inside archives."
          info            : "Malware is often packaged within an archive. In addition, archives might have other archives within. Not scanning archive files introduces the risk of infected files being introduced into the environment."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Options:' label. Select the 'Scan inside archives (e.g. .ZIP)' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56403r2_rule,STIG-ID|DTAM052,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6611"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ScanArchives')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM053 - McAfee VirusScan On-Demand scan must be configured to decode MIME encoded files."
          info            : "Multipurpose Internet Mail Extensions (MIME) encoded files can be crafted to hide a malicious payload. When the MIME encoded file is presented to software that decodes the MIME encoded files, such as an email client, the malware is released. Scanning these files as part of the regularly scheduled scans tasks will mitigate this risk."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Options:' label. Select the 'Decode MIME encoded files' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56404r1_rule,STIG-ID|DTAM053,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6612"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ScanMime')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM054 - McAfee VirusScan On-Demand scan must be configured to find unknown program threats."
          info            : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown program threats' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56419r1_rule,STIG-ID|DTAM054,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6614"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'dwProgramHeuristicsLevel')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM055 - McAfee VirusScan On-Demand scan must be configured to find unknown macro threats."
          info            : "Interpreted viruses are executed by an application. Within this subcategory, macro viruses take advantage of the capabilities of applications' macro programming language to infect application documents and document templates, while scripting viruses infect scripts that are understood by scripting languages processed by services on the OS. Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. The scanning for unknown macro viruses will mitigate zero day attacks."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56409r1_rule,STIG-ID|DTAM055,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6615"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'dwMacroHeuristicsLevel')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM056 - McAfee VirusScan On-Demand scan actions, When a threat is found must be configured to clean files automatically as first action."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option so as to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean'.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56420r1_rule,STIG-ID|DTAM056,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6616"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 5
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'uAction')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM057 - McAfee VirusScan On-Demand scan actions must be configured to delete files automatically if first action fails."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option so as to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Actions tab, locate the 'When a threat is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete'.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56414r1_rule,STIG-ID|DTAM057,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6617"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 4
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'uSecAction')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM059 - McAfee VirusScan On-Demand scan must be configured to record scanning activity in a log file."
          info            : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.


		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56422r1_rule,STIG-ID|DTAM059,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6618"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLogToFile')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM060 - McAfee VirusScan On-Demand scan log file size must be restricted."
          info            : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label.
		Select the 'Limit the size of log file' option.
		Under 'Maximum log file size:', choose a value of at least 10MB.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56425r1_rule,STIG-ID|DTAM060,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6620"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLimitSize')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM060 - McAfee VirusScan On-Demand scan log file size must be configured to at least 10MB."
          info            : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'Log file' label.
		Select the 'Limit the size of log file' option.
		Under 'Maximum log file size:', choose a value of at least 10MB.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56425r1_rule,STIG-ID|DTAM060,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6620"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "True"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq ' ')} | Select -exp Value -first 1 ) }; if ($results -lt 10240) { write-host 'False'} else { write-host 'True'};"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM063 - McAfee VirusScan On-Demand scan must be configured to log any failure to scan encrypted files."
          info            : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
		Right-click the Task and select Properties.

		Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Failure to scan encrypted files' option.

		Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56423r1_rule,STIG-ID|DTAM063,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-6625"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 1
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bLogScanEncryptFail')} | Select -exp Value -first 1 ) }; write-host ${results}"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type            : AUDIT_POWERSHELL
              description     : "bschedenabled == 1"
              value_type      : POLICY_TEXT
              value_data      : 1
              powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'bSchedEnabled')} | Select -exp Value -first 1 ) }; write-host ${results}"
            </custom_item>

            <custom_item>
              type            : AUDIT_POWERSHELL
              description     : "escheduletype == 1 || 0"
              value_type      : POLICY_TEXT
              value_data      : 0 || 1
              powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'eScheduletype')} | Select -exp Value -first 1 ) }; write-host ${results}"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTAM070 - McAfee VirusScan On-Demand scan must be scheduled to be executed at least on a weekly basis."
              info        : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Click on the Schedule button.
				Under the Task tab, select 'Enabled'.
				Under the Schedule tab, find the 'Run Task: ' label and set to at least 'Weekly'.


				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001241,Rule-ID|SV-56426r1_rule,STIG-ID|DTAM070,Vuln-ID|V-6627"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTAM070 - McAfee VirusScan On-Demand scan must be scheduled to be executed at least on a weekly basis."
              info        : "Antivirus software is the mostly commonly used technical control for malware threat mitigation. Antivirus software on hosts should be configured to scan all hard drives regularly to identify any file system infections and to scan any removable media, if applicable, before media is inserted into the system. Not scheduling a regular scan of the hard drives of a system and/or not configuring the scan to scan all files and running processes, introduces a higher risk of threats going undetected."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Click on the Schedule button.
				Under the Task tab, select 'Enabled'.
				Under the Schedule tab, find the 'Run Task: ' label and set to at least 'Weekly'.


				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001241,Rule-ID|SV-56426r1_rule,STIG-ID|DTAM070,Vuln-ID|V-6627"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM090 - McAfee VirusScan On-Access Scanner General Settings must be configured to enable scanning of scripts."
          info        : "Interpreted viruses are executed by an application. Within this subcategory, macro viruses take advantage of the capabilities of applications' macro programming language to infect application documents and document templates, while scripting viruses infect scripts that are understood by scripting languages processed by services on the OS. Many attackers use toolkits containing several different types of utilities and script that can be used to probe and attack hosts. (NIST SP 800-83) The scanning of scripts is crucial in preventing these attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the ScriptScan tab, locate the 'ScriptScan:' label. Select the 'Enable scanning of scripts' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,Rule-ID|SV-56400r1_rule,STIG-ID|DTAM090,Vuln-ID|V-14618"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Script Scanner\"
          reg_item    : "ScriptScanEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM091 - McAfee VirusScan On-Access Scanner General Settings must be configured to block connections for threatened files in shared folders"
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Select the 'Block the connection when a threat is detected in a shared folder' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56402r1_rule,STIG-ID|DTAM091,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14619"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlock"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM092 - McAfee VirusScan On-Access Scanner General Settings must be configured to unblock connections after a minimum of 30 minutes."
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Enter a value in 'Unblock connections after (minutes)' where x is set to no less than 30 minutes.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56406r1_rule,STIG-ID|DTAM092,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14620"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 30
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlockTimeout"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM093 - McAfee VirusScan must be configured to block connections when files with potentially unwanted programs are detected."
          info        : "Containment during a virus outbreak is crucial. Infected hosts may attempt to spread malware and will use every network path available to them when spreading that infection. By containing the system when a detection is found, the malware will be restricted to that one system. Likewise, if malware is detected in a shared folder, maintaining the connection between a system and the shared folder would allow the malware to spread. Placing temporary restrictions on network connectivity is an effective mitigation mechanism.

		These block connection settings will most often be used on a server housing shared folders and files, and will block the connection from any network user on a remote computer who attempts to read from, or write to, a threatened file in the shared folder. In addition, it will block the connection from any user on a remote computer who attempts to write an unwanted program to the computer. The connection will be unblocked after the specified amount of time, re-allowing access to the other shared files and folders, but will be re-blocked should those same file accesses be attempted."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select the General Settings.

		Under the Blocking tab, locate the 'Block' label. Select the 'Block the connection when a file with a potentially unwanted program is detected in a shared folder' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56408r1_rule,STIG-ID|DTAM093,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14621"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "VSIDBlockOnNonVirus"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM100 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to use only one scanning policy for all processes."
          info        : "Organizations should use centrally managed antivirus software that is controlled and monitored regularly by antivirus administrators, who are also typically responsible for acquiring, testing, approving, and delivering antivirus signatures and software updates through the organizations. (FISMA SP 800-83) Some processes are known to be higher risk, while others are low risk. By restricting policy configuration to the Default Processes policy, all processes will be interpreted equally when applying the policy settings and will provide the highest level of protection. Best practice dictates configuring Low Risk and/or High Risk policies only when it is necessary to improve system performance, and will focus the scanning where it is most likely to detect malware. There is risk associated with configuring the Low Risk and/or High Risk policies for the purpose of specifically excluding processes from scanning, and should only be done after evaluating other policy settings and determining risk."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Processes tab, select the 'Configure one scanning policy for all processes' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56410r1_rule,STIG-ID|DTAM100,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14622"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration"
          reg_item    : "OnlyUseDefaultConfig"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM101 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan when writing to disk."
          info        : "Antivirus software is the most commonly used technical control for malware threat mitigation. Real-time scanning of files as they are written to disk is a crucial first line of defense from malware attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Scan files:' label. Select the 'When writing to disk' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56413r1_rule,STIG-ID|DTAM101,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14623"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "bScanIncoming"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM102 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan when reading from disk."
          info        : "Antivirus software is the most commonly used technical control for malware threat mitigation. Real-time scanning of files as they are read from disk is a crucial first line of defense from malware attacks."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Scan files:' label. Select the 'When reading from disk' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56429r1_rule,STIG-ID|DTAM102,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14624"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "bScanOutgoing"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "LocalExtensionMode == 1"
              value_type  : POLICY_DWORD
              value_data  : 1
              reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
              reg_item    : "LocalExtensionMode"
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "NetworkExtensionMode == 1"
              value_type  : POLICY_DWORD
              value_data  : 1
              reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
              reg_item    : "NetworkExtensionMode"
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTAM103 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan all files."
              info        : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'What to scan:' label. Select the 'All Files' radio button option.

				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-56430r1_rule,STIG-ID|DTAM103,Vuln-ID|V-14625"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTAM103 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan all files."
              info        : "When scanning for malware, excluding specific file types will increase the risk of a malware-infected file going undetected. By configuring antivirus software to scan all file types, the scanner has a higher success rate at detecting and eradicating malware."
              solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'What to scan:' label. Select the 'All Files' radio button option.

				Click OK to Save."
              reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-56430r1_rule,STIG-ID|DTAM103,Vuln-ID|V-14625"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM104 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to find unknown unwanted programs and trojans."
          info        : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown unwanted programs and trojans' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56431r1_rule,STIG-ID|DTAM104,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14626"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "dwProgramHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM105 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to find unknown macro viruses."
          info        : "Due to the ability of malware to mutate after infection, standard antivirus signatures may not be able to catch new strains or variants of the malware. Typically, these strains and variants will share unique characteristics with others in their virus family. By using a generic signature to detect the shared characteristics, using wildcards where differences lie, the generic signature can detect viruses even if they are padded with extra, meaningless code. This method of detection is Heuristic detection."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Heuristics:' label. Select the 'Find unknown macro threats' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56432r1_rule,STIG-ID|DTAM105,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14627"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "dwMacroHeuristicsLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM106 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to scan inside archive files."
          info        : "Malware is often packaged within an archive. In addition, archives might have other archives within. Not scanning archive files introduces the risk of infected files being introduced into the environment."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Scan Items tab, locate the 'Compressed files:' label. Select the 'Scan inside archives (e.g., .ZIP)' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56433r3_rule,STIG-ID|DTAM106,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14628"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "ScanArchives"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM110 - McAfee VirusScan: When a threat is found, scanner must be configured to clean files automatically as first action."
          info        : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Actions tab, locate the 'When a threat is found:' label. For the 'Perform this action first:' pull down menu, select 'Clean files automatically'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56427r1_rule,STIG-ID|DTAM110,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14630"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM111 - McAfee VirusScan: When a threat is found must be configured to delete files automatically if first action fails."
          info        : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		On the menu bar, click Task->On-Access Scanner Properties.
		Select All Processes.

		Under the Actions tab, locate the 'When a threat is found:' label. For the 'If the first action fails, then perform this action:' pull down menu, select 'Delete files automatically'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56428r1_rule,STIG-ID|DTAM111,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14631"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uSecAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM039 - McAfee VirusScan On Delivery Email Scanner must be configured to clean attachments as its first action."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
		Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

		Under the Actions tab, locate the 'When an unwanted attachment is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean attachments'.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56394r2_rule,STIG-ID|DTAM039,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14652"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uAction_Program"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM058 - McAfee VirusScan On-Demand scan must be configured to detect for unwanted programs."
          info            : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Scan Items tab, locate the 'Options:' label. Select the 'Detect unwanted programs' option.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56416r1_rule,STIG-ID|DTAM058,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14654"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "True"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -eq 'ApplyNVP')} | Select -exp Value -first 1 ) }; if ($results -eq 0) { write-host 'False'} else { write-host 'True'};"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM135 - McAfee VirusScan Unwanted Programs Policy must be configured to detect spyware."
          info        : "Spyware is software that aids in gathering information about a person or organization without their knowledge, and that may send such information to another entity without the consumer's consent, or that asserts control over a computer without the user's knowledge. Spyware may try to deceive users by bundling itself with desirable software. A spyware infestation can create significant unwanted CPU activity, disk usage, and network traffic. Some types of spyware disable software firewalls and antivirus software. Detecting, blocking, and eradicating malicious spyware or preventing it from being installed will alleviate the negative side effects of the spyware."
          solution    : "Access the local VirusScan console by clicking on Start->All Programs->McAfee->VirusScan Console.

Under the Task column, find the Unwanted Programs Policy, right-click, and choose Properties.
In the Scan Items tab, select the Spyware option.

Click OK to save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-56415r1_rule,STIG-ID|DTAM135,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14662"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\NVP"
          reg_item    : "DetectSpyware"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM136 -  McAfee VirusScan Unwanted Programs Policy must be configured to detect adware."
          info        : "Adware, like spyware, is, at best, an annoyance by presenting unwanted advertisements to the user of a computer, sometimes in the form of a popup. At worst, it redirects the user to malicious websites. Detecting and blocking will mitigate the likelihood of users being tricked into visiting sites with malicious content."
          solution    : "Access the local VirusScan console by clicking on Start->All Programs->McAfee->VirusScan Console.

Under the Task column, find the Unwanted Programs Policy, right-click, and choose Properties.
In the Scan Items tab, select the Adware option.

Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001243,CSF|PR.AC-4,Rule-ID|SV-56411r1_rule,STIG-ID|DTAM136,Vuln-ID|V-14663"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\NVP"
          reg_item    : "DetectAdware"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAG008 - The antivirus signature file age must not exceed 7 days."
          info            : "Antivirus signature files are updated almost daily by antivirus software vendors. These files are made available to antivirus clients as they are published. Keeping virus signature files as current as possible is vital to the security of any system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

Under the Task column, select the AutoUpdate option, right-click, and select 'Start'."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|I,CCI|CCI-001240,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56366r2_rule,STIG-ID|DTAG008,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-19910"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "False"
          powershell_args : "((get-date -uformat %s) - (get-date -Year (Get-ItemProperty 'HKLM:\SOFTWARE\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateYear) -Month (Get-ItemProperty 'HKLM:\SOFTWARE\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateMonth) -Day (Get-ItemProperty 'HKLM:\SOFTWARE\McAfee\SystemCore\VSCore\On Access Scanner\McShield' | Select-Object -ExpandProperty AVDatDateDay) -UFormat %s)) -gt 604800"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM137 - McAfee VirusScan On-Access Scanner: Artemis Heuristic network check for suspicious files must be enabled. (ArtemisEnabled)"
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the General tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56405r1_rule,STIG-ID|DTAM137,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-35027"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner"
          reg_item    : "ArtemisEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM137 - McAfee VirusScan On-Access Scanner: Artemis Heuristic network check for suspicious files must be enabled. (ArtemisLevel)"
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the General tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56405r1_rule,STIG-ID|DTAM137,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-35027"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [2..4]
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner"
          reg_item    : "ArtemisLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM162 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to delete attachments if the first action fails."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc. from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Actions tab, locate the 'When a threat is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete attachments'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55227r2_rule,STIG-ID|DTAM162,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42514"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uSecAction"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM163 - McAfee VirusScan On Delivery Email Scanner Properties must be configured to delete attachments if the first action fails."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc. from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Actions tab, locate the 'When an unwanted attachment is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete attachments'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55229r2_rule,STIG-ID|DTAM163,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42515"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ActionOptions"
          reg_item    : "uSecAction_Program"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM138 - McAfee VirusScan Access Protection Rules must be configured to prevent McAfee services from being stopped."
          info        : "When the 'Prevent McAfee services from being stopped' check box is selected under Access Protection, VSE will prevent anyone except the System account from terminating McAfee services. This protects VirusScan from being disabled by malicious programs that seek to circumvent virus protection programs by terminating their services."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, select the 'Prevent McAfee services from being stopped' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001242,CSF|PR.AC-4,Rule-ID|SV-55277r2_rule,STIG-ID|DTAM138,Vuln-ID|V-42549"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "PVSPTEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM139 - McAfee VirusScan Access Protection Reports settings must be configured to record scanning activity in a log file."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000130,CSF|PR.AC-4,Rule-ID|SV-55278r2_rule,STIG-ID|DTAM139,Vuln-ID|V-42550"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLogToFile"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM140 - McAfee VirusScan Access Protection Reports log file size must be restricted."
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log File' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000140,CSF|PR.AC-4,Rule-ID|SV-55279r2_rule,STIG-ID|DTAM140,Vuln-ID|V-42551"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLimitSize"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM140 - McAfee VirusScan Access Protection Reports log file size must be configured to at least 10MB."
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Reports tab, locate the 'Log File' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000140,CSF|PR.AC-4,Rule-ID|SV-55279r2_rule,STIG-ID|DTAM140,Vuln-ID|V-42551"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [10..MAX]
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "dwMaxLogSizeMB"
        </custom_item>

        <report type:"WARNING">
          description : "DTAM141 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of McAfee files and settings."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label.
				In the 'Categories' box, select 'Common Standard Protection'.
				Select 'Prevent modification of McAfee files and settings' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55280r2_rule,STIG-ID|DTAM141,Vuln-ID|V-42552"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM142 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of CMA files and settings."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select 'Prevent modification of McAfee Common Management Agent files and settings' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55281r2_rule,STIG-ID|DTAM142,Vuln-ID|V-42553"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM143 - McAfee VirusScan Access Protection Rules CSP must be set to prevent modification of McAfee Scan Engine files."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label.
				In the 'Categories' box, select 'Common Standard Protection'.
				Select 'Prevent modification of McAfee Scan Engine files and settings' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001813,Rule-ID|SV-55282r2_rule,STIG-ID|DTAM143,Vuln-ID|V-42554"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM144 - McAfee VirusScan Access Protection Rules Common Standard Protection must be set to prevent termination of McAfee processes."
          info        : "Many malicious programs have attempted to disable VirusScan by stopping services and processes and leaving the system vulnerable to attack. Self-protection is an important feature of VSE that prevents malicious programs from disabling VirusScan or any of its services or processes. Many trojans and viruses will attempt to terminate or even delete security products. VSE's self-protection features protect VirusScan registry values and processes from being altered or deleted by malicious code. This rule protects the McAfee security product from modification by any process not listed in the policy's exclusion list.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select 'Prevent termination of McAfee processes' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-000213,Rule-ID|SV-55283r2_rule,STIG-ID|DTAM144,Vuln-ID|V-42555"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM145 - McAfee VirusScan Access Protection Rules CSP must be set to block/report when programs are run from Temp folder."
          info        : "This rule will block any common programs from running from the Temp directory; however, this rule is much more restrictive in that it stops nearly all processes from launching in the Temp folder. Most viruses need to be run once by a person before infecting a computer. This can be done in many ways, such as opening an executable attachment in an email or downloading a program from the Internet. An executable needs to exist on the disk before Windows can run it. A common way for applications to achieve this is to save the file in the user's or system's Temp directory and then run it. One purpose of this rule is to enforce advice that is frequently given to users: 'do not open attachments from email.' The other purpose of this rule is to close security holes introduced by application bugs. Older versions of Outlook and Internet Explorer are notorious for automatically executing code without the user needing to do anything but preview an email or view a website.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.

				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select the 'Prevent common programs from running files from the temp folder' (Block and Report) option.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55284r5_rule,STIG-ID|DTAM145,Vuln-ID|V-42556"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM146 - McAfee VirusScan Access Protection Rules Common Standard Protection must be set to prevent hooking of McAfee processes."
          info        : "Hooking covers a range of techniques used to alter or augment the behavior of an operating system, of applications, or of other software components by intercepting function calls or messages or events passed between software components. Code that handles such intercepted function calls, events, or messages is called a 'hook'. Hooking can also be used by malicious code. For example, rootkits, pieces of software that try to make themselves invisible by faking the output of API calls that would otherwise reveal their existence, often use hooking techniques. This rule prevents other processes from hooking of McAfee processes.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Standard Protection'. Select both 'Prevent hooking of McAfee processes' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55285r2_rule,STIG-ID|DTAM146,Vuln-ID|V-42557"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM147 - McAfee VirusScan Access Protection Rules CMP must be set to detect and log files launched from Downloaded Programs Files folder."
          info        : "A common distribution method for adware and spyware is to have the user download an executable file and run it automatically from the Downloaded Program Files folder. This rule is specific to Microsoft Internet Explorer and prevents software installations through the web browser. Internet Explorer runs code from the Downloaded Program Files directory, notably ActiveX controls. Some vulnerabilities in Internet Explorer and viruses place an .exe file into this directory and run it. This rule closes that attack vector.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Common Maximum Protection'. Select the 'Prevent launching of files from the Downloaded Program Files folder' (Report) option.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001169,Rule-ID|SV-55286r2_rule,STIG-ID|DTAM147,Vuln-ID|V-42558"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM148 - McAfee VirusScan Access Protection: Anti-Spyware Maximum Protection must be set to block and log scripts from the Temp folder."
          info        : "This rule prevents the Windows scripting host from running VBScript and JavaScript scripts from the Temp directory. This would protect against a large number of trojans and questionable web installation mechanisms that are used by many adware and spyware applications.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Spyware Maximum Protection'. Select the 'Prevent execution of scripts from the Temp folder' (Block and Report) option.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-55287r6_rule,STIG-ID|DTAM148,Vuln-ID|V-42559"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM149 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must be set to prevent remote creation of autorun files."
          info        : "Autorun files are used to automatically launch program files, typically setup files from CDs. Preventing other computers from making a connection and creating or altering autorun.inf files can prevent spyware and adware from being executed. There are many spyware and virus programs distributed on CDs.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'.
				Select 'Prevent remote creation of autorun files' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001242,Rule-ID|SV-55288r2_rule,STIG-ID|DTAM149,Vuln-ID|V-42560"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM150 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must prevent mass mailing worms from sending mail."
          info        : "Many viruses and worms find email addresses on the infected system and send themselves to these addresses. They do this by connecting directly to the email servers whose names they have harvested from the local system. This rule prevents any process from talking to a foreign email server using SMTP. By blocking this communication, a machine may become infected with a new mass-mailing virus, but that virus will be unable to spread further by email. It prevents outbound access to SMTP ports 25 and 587 on all programs except known email clients listed as an exclusion.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'. Select both 'Prevent mass mailing worms from sending email' (Block and Report) options.

				Click OK to save."
          reference   : "CAT|II,CCI|CCI-001170,Rule-ID|SV-55289r2_rule,STIG-ID|DTAM150,Vuln-ID|V-42561"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <report type:"WARNING">
          description : "DTAM151 - McAfee VirusScan Access Protection Rules Anti-Virus Standard Protection must be set to prevent IRC communication."
          info        : "Internet Relay Chat (IRC) is the preferred communication method used by botnet herders and remote-access trojans to control botnets (a set of scripts or an independent program that connects to IRC). IRC allows an attacker to control infected machines that are sitting behind network address translation (NAT), and the bot can be configured to connect back to the command and control server listening on any port.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Virus Standard Protection'. Select both 'Prevent IRC communication' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001170,Rule-ID|SV-55290r3_rule,STIG-ID|DTAM151,Vuln-ID|V-42562"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM152 - McAfee VirusScan On-Access Scanner General Settings must be configured to not exclude any script processes from being scanned."
          info        : "Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. All scripts should be scanned and none should be excluded from scanning."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the ScriptScan tab, locate the 'ScriptScan process exclusions' label. Remove any exclusions listed in the Process field."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55291r2_rule,STIG-ID|DTAM152,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42563"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_MULTI_TEXT
          value_data  : ""
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Script Scanner"
          reg_item    : "ExcludedProcesses"
          reg_option  : CAN_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM153 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to not exclude any files from being scanned."
          info        : "When scanning for malware, excluding specific files will increase the risk of a malware-infected file going undetected. By configuring antivirus software without any exclusions, the scanner has a higher success rate at detecting and eradicating malware."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Exclusions tab, locate the 'What not to scan:' label. Remove any exclusions listed."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55292r3_rule,STIG-ID|DTAM153,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42564"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "NumExcludeItems"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM154 - McAfee VirusScan On-Demand scan must be configured to scan memory for rootkits."
          info            : "A rootkit is a stealthy type of software, usually malicious, and is designed to mask the existence of processes or programs from normal methods of detection. Rootkits will often enable continued privileged access to a computer. Scanning and handling detection of rootkits will mitigate the likelihood of rootkits being installed and used maliciously on the system."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Scan Locations tab, in the box under the 'Specify where scanning takes place.' label, select 'Memory for rootkits' from the drop-down selection box.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001241,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55293r1_rule,STIG-ID|DTAM154,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42565"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : "SpecialScanForRootkits"
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'szScanItem*') -and ($_.Value -eq 'SpecialScanForRootkits') } | Select -exp Value) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM155 - McAfee VirusScan On-Demand scan actions: unwanted programs must be cleaned automatically as first action."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task,  with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Actions tab, locate the 'When an unwanted program is found:' label. For the 'Perform this action first:' pull down menu, select 'Clean'.


				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55294r1_rule,STIG-ID|DTAM155,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42566"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 5
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'uAction_Program') } | Select -exp Value -first 1) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type            : AUDIT_POWERSHELL
          description     : "DTAM164 - McAfee VirusScan On-Demand scan actions, must be configured to delete unwanted programs automatically if first action fails."
          info            : "Malware may have infected a file that is necessary to the user. By configuring the antivirus software to first attempt cleaning the infected file, availability to the file is not sacrificed. If a cleaning attempt is not successful, however, deleting the file is the only safe option to ensure the malware is not introduced onto the system or network."
          solution        : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				In the console window, under Task, with the assistance of the System Administrator, identify the weekly on-demand client scan task.
				Right-click the Task and select Properties.

				Under the Actions tab, locate the 'When an unwanted program is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete'.

				Click OK to Save."
          reference       : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55295r1_rule,STIG-ID|DTAM164,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42567"
          see_also        : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type      : POLICY_TEXT
          value_data      : 4
          powershell_args : "$subkeys = @($(get-item HKLM:\SOFTWARE\McAfee\DesktopProtection\Tasks).GetSubKeyNames()); foreach ($guid in $subkeys) { $results = @((Get-ItemProperty Registry::HKLM\SOFTWARE\McAfee\DesktopProtection\Tasks\$guid).psObject.Properties | Where-Object {($_.Name -clike 'uSecAction_Program') } | Select -exp Value -first 1) }; write-host ${results}"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM157 - McAfee VirusScan On-Delivery Email Scanner Artemis must be enabled."
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Scan Items tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55297r2_rule,STIG-ID|DTAM157,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42569"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner"
          reg_item    : "ArtemisEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM157 - McAfee VirusScan On-Delivery Email Scanner Artemis sensitivity level must be configured to Medium or higher."
          info        : "Antivirus software vendors use collective intelligence from sensors and cross-vector intelligence from web, email, and network threats to compile scores that reflect the likelihood of whether a file in question is malware. The collective intelligence is constantly being updated, more frequently than the typical daily antivirus signature files. With File Reputation lookup, a more real-time response to potential malicious code is realized than with the local-running antivirus software, since by querying the cloud-based database when a file appears to be suspicious, up-to-the-minute intelligence is provided. This type of protection reduces the threat protection time period from days to milliseconds, increases malware detection rates, and reduces downtime and remediation costs associated with malware attacks. Using File Reputation lookup is mandated by US CYBERCOM on DoD systems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Scan Items tab, locate the 'Artemis (Heuristic network check for suspicious files):' label. Select the 'Medium' option.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55297r2_rule,STIG-ID|DTAM157,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42569"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : [2..4]
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner"
          reg_item    : "ArtemisLevel"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM158 - McAfee VirusScan On-Delivery Email Scanner must send a notification email when a threatening email message is detected."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Alerts tab, locate the 'Email alert:' label.
				Click on Configure. Select the 'Send alert to mail user:' option. Enter the email recipient information for the notification email to be sent to the ISSO, ISSM,ePO administrator, or System Administrator.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55298r2_rule,STIG-ID|DTAM158,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42570"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\AlertOptions"
          reg_item    : "bSendMailToUser"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM158 - McAfee VirusScan On-Delivery Email Scanner must send a notification email to the IAO when a threatening email message is detected."
          info        : "Email has become one of the most frequently used methods of spreading malware, through embedded HTML code and attachments. User awareness and training, warning users to not open suspicious emails or email attachments and not clicking on hyperlinks, etc., from unknown or known senders, will not fully protect from email-borne malware. Mass mailing worms are similar to an email-borne virus but is self-contained rather than infecting an existing file. Protecting from email-borne viruses and mass mailing worms by scanning email upon delivery mitigates the risk of infection via email."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Alerts tab, locate the 'Email alert:' label.
				Click on Configure. Select the 'Send alert to mail user:' option. Enter the email recipient information for the notification email to be sent to the ISSO, ISSM,ePO administrator, or System Administrator.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001243,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55298r2_rule,STIG-ID|DTAM158,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42570"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_TEXT
# Note: Variable @NOTIFICATION_EMAIL@ replaced with "person@service.mil" in field "value_data".
          value_data  : "person@service.mil"
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\AlertOptions"
          reg_item    : "szSendTo"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM159 - McAfee VirusScan On-Delivery Email Scanner must be configured to log session summary and failure to scan encrypted files."
          info        : "Log management is essential to ensuring that computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems."
          solution    : "Access the local VirusScan console by clicking Start >> All Programs >> McAfee >> VirusScan Console.
				Under the Task column, select the On-Delivery Email Scanner Option, right-click, and select Properties.

				Under the Reports tab, locate the 'What to log in addition to scanning activity:' label. Select the 'Session summary' and 'Failure to scan encrypted files' options.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-000130,CN-L3|7.1.3.6(a),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS10b,NIAv2|GS8a,NIAv2|IE11,NIAv2|SU7,Rule-ID|SV-55299r3_rule,STIG-ID|DTAM159,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42571"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 416
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Email Scanner\Outlook\OnDelivery\ReportOptions"
          reg_item    : "dwLogEvent"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM160 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to not exclude any script URLs from being scanned."
          info        : "Many attackers use toolkits containing several different types of utilities and scripts that can be used to probe and attack hosts. All scripts should be scanned and none should be excluded from scanning."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select the General Settings.

				Under the ScriptScan tab, locate the 'ScriptScan exclusions' label. Ensure there are no exclusions listed in the URL field."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55300r2_rule,STIG-ID|DTAM160,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42572"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_MULTI_TEXT
          value_data  : ""
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\Script Scanner"
          reg_item    : "ExcludedURLs"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM161 - McAfee VirusScan Access Protection Properties must be configured to enable access protection."
          info        : "Access Protection prevents unwanted changes to a computer by restricting access to specified ports, files and folders, shares, and registry keys and values. It prevents users from stopping McAfee processes and services, which are critical before and during outbreaks. Access Protection for VSE uses predefined and user-defined rules to strengthen systems against virus attacks. For instance, rules are used to specify which items can and cannot be accessed. Each rule can be configured to block and/or report access violations when they occur, and rules can also be disabled."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, select the 'Enable Access Protection' option.

				Click OK to save."
          reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001243,CSF|PR.AC-4,Rule-ID|SV-55301r3_rule,STIG-ID|DTAM161,Vuln-ID|V-42573"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "APEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM165 - McAfee VirusScan On-Access Scanner All Processes settings must be configured to detect unwanted programs."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Scan Items tab, locate the 'Unwanted programs detection:' label.

				Place a check in the 'Detect unwanted programs' checkbox.

				Click OK."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55302r1_rule,STIG-ID|DTAM165,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42574"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "ApplyNVP"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM166 - McAfee VirusScan On-Access Scanner must be configured to clean unwanted programs automatically as first action."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Actions tab, locate the  'When an unwanted program is found:' label. From the 'Perform this action first:' pull down menu, select 'Clean files automatically'.

				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55303r1_rule,STIG-ID|DTAM166,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42575"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 5
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uAction_Program"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM167 - McAfee VirusScan On-Access Scanner must be configured to delete unwanted programs automatically if first action fails."
          info        : "Potentially Unwanted Programs (PUPs) include Spyware, Adware, Remote Administration Tools, Dialers, Password Crackers, Jokes, and Key Loggers. While PUPs do not typically have any infections capability on their own, they rely on malware or other attach mechanisms to be installed onto target hosts, after which they will collect and transfer data from the host to an external host and/or will be used as attach mechanisms. Configuring the antivirus software to attempt to clean the file first will allow for the possibility of a false positive. In most cases, however, the secondary action of delete will be used, mitigating the risk of the PUPs being installed and used maliciously."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				On the menu bar, click Task->On-Access Scanner Properties.
				Select All Processes.

				Under the Actions tab, locate the  'When an unwanted program is found:' label. From the 'If the first action fails, then perform this action:' pull down menu, select 'Delete files automatically'.
				Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-55304r1_rule,STIG-ID|DTAM167,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-42576"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 4
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\McShield\Configuration\Default"
          reg_item    : "uSecAction_Program"
        </custom_item>

        <report type:"WARNING">
          description : "DTAM170 - Anti-spyware Maximum Protection must be set to block and report when block execution of all programs from temp folder"
          info        : "DTAM170 - McAfee VirusScan Access Protection Rules Anti-spyware Maximum Protection must be set to block and report when block execution of all programs from temp folder
          This rule will block any executable from running from the Temp directory; however, this rule is much more restrictive in that it stops nearly all processes from launching in the Temp folder. This provides the most protection, but also has a higher chance of blocking a legitimate application from being installed.

				NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
				Under the Task column, select Access Protection, right-click, and select Properties.

				Under the Access Protection tab, locate the 'Access protection rules:' label. In the 'Categories' box, select 'Anti-Spyware Maximum Protection'. Select both 'Prevent all programs from running files from the Temp folder' (Block and Report) options.

				Click OK to Save."
          reference   : "CAT|II,CCI|CCI-001243,Rule-ID|SV-73795r3_rule,STIG-ID|DTAM170,Vuln-ID|V-59365"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
        </report>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM130 - McAfee VirusScan Buffer Overflow Protection Settings must be configured to enable Buffer Overflow Protection."
          info        : "Buffer overflow is an anomaly where a program, while writing data to a buffer, overruns the buffer's boundary and overwrites adjacent memory. This anomaly has been used maliciously, explicitly to craft exploits. Buffer overflow attacks compose greater than 25% of malware attacks. Without buffer overflow protection enabled, systems are more vulnerable to attacks that attempt to overwrite adjacent memory in the stack frame. Buffer overflow protection is only configurable on non-64-bit systems.

	  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer Overflow settings:' label. Select the 'Enable buffer overflow protection' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56434r1_rule,STIG-ID|DTAM130,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14657"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "BOPEnabled"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM131 - McAfee VirusScan Buffer Overflow Protection Settings must be configured for Protection mode."
          info        : "Buffer overflow is an anomaly where a program, while writing data to a buffer, overruns the buffer's boundary and overwrites adjacent memory. This anomaly has been used maliciously, explicitly to craft exploits. Buffer overflow attacks compose greater than 25% of malware attacks. Without buffer overflow protection enabled, systems are more vulnerable to attacks that attempt to overwrite adjacent memory in the stack frame. Buffer overflow protection is only configurable on non-64-bit systems.

		      NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer Overflow settings:' label. Select the 'Protection mode' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56435r1_rule,STIG-ID|DTAM131,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14658"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "BOPMode"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM132 - McAfee VirusScan Buffer Overflow Protection Settings must be configured to display a dialog box when buffer overflow is detected."
          info        : "An effective awareness program explains proper rules of behavior for use of an organization's IT systems and information. Accordingly, awareness programs should include guidance to users on malware incident prevention, which can help reduce the frequency and severity of malware incidents.

		Organizations should also make users aware of policies and procedures that apply to malware incident handling, such as how to identify if a host may be infected, how to report a suspected incident, and what users need to do to assist with incident handling.

		Ensuring the antivirus software alerts the users when a Buffer Overflow is detected will ensure the user is aware of the incident and be able to more closely relate the incident to action being performed by the user at the time of the detection.

			 NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Buffer Overflow Protection tab, locate the 'Buffer overflow settings' label. Select the 'Show the messages dialog box when a buffer overflow is detected' option.

		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56424r1_rule,STIG-ID|DTAM132,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14659"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "BOPShowMessages"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM133 - McAfee VirusScan Buffer Overflow Protection Reports Settings must be configured to log buffer overflow protection scan activity."
          info        : "Log management is essential to ensuring computer security records are stored in sufficient detail for an appropriate period of time. Routine log analysis is beneficial for identifying security incidents, policy violations, fraudulent activity, and operational problems. Logs are also useful when performing auditing and forensic analysis, supporting internal investigations, establishing baselines, and identifying operational trends and long-term problems.

			  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Enable activity logging and accept the default location for the log file or specify a new location' option.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56421r1_rule,STIG-ID|DTAM133,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14660"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLogToFile_Ent"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM134 - McAfee VirusScan Buffer Overflow Protection Reports Settings log file size must be limited to at least 10MB. (bLimitSize_Ent)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value.

			  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56418r1_rule,STIG-ID|DTAM134,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14661"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "bLimitSize_Ent"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "DTAM134 - McAfee VirusScan Buffer Overflow Protection Reports Settings log file size must be limited to at least 10MB. (dwMaxLogSizeMB_Ent)"
          info        : "While logging is imperative to forensic analysis, logs could grow to the point of impacting disk space on the system. In order to avoid the risk of logs growing to the size of impacting the operating system, the log size will be restricted, but must also be large enough to retain forensic value.

			  NOTE: This check is unique to 32-bit installs of McAfee VirusScan."
          solution    : "Access the local VirusScan console by clicking Start->All Programs->McAfee->VirusScan Console.
		In the console window, under Task, click Task->Buffer Overflow Protection, right-click, and select Properties.

		Under the Reports tab, locate the 'Log file' label. Select the 'Limit the size of log file' option. For the 'Maximum log file size:', select a value of 10MB or more.


		Click OK to Save."
          reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CCI|CCI-001242,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-56418r1_rule,STIG-ID|DTAM134,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-14661"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 10
          reg_key     : "HKLM\Software\McAfee\SystemCore\VSCore\On Access Scanner\BehaviourBlocking"
          reg_item    : "dwMaxLogSizeMB_Ent"
        </custom_item>
      </else>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_McAfee_VirusScan_8.8_Local_Client_v5r15.audit for Microsoft Windows from DISA STIG McAfee VirusScan 8.8 v5r16"
      info        : "McAfee VirusScan 8.8 is not installed or remote registry service is disabled.

      NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_McAfee_VirusScan88_Local_Client_V5R16_STIG.zip"
    </report>
  </else>
</if>

</group_policy>
</check_type>
