#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.2 $
# $Date: 2020/04/22 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Oracle WebLogic Server 12c v1r6 STIG.
#
#<ui_metadata>
#<display_name>Oracle WebLogic Server 12c v1r6</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Oracle WebLogic Server 12c</name>
#  <version>1.6.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip</link>
#</spec>
#<labels>windows,disa,oracle,weblogic,weblogic_12c</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>WEBLOGIC_DOMAIN_HOME</name>
#    <default>C:\App\Oracle\Middleware\User_Projects\Domains\Base_domain</default>
#    <description>Domain Home Path</description>
#    <info>The full path to the domain home with no trailing slash.</info>
#  </variable>
#  <variable>
#    <name>WEBLOGIC_HEALTHSTATE_MOD_PATH</name>
#    <default>C:\App\Oracle\Middleware\User_Projects\Domains\Base_domain\config\diagnostics\Module-HealthState-1900.xml</default>
#    <description>Module HealthState Full Path</description>
#    <info>The full path to the Module HealthState XML file</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"Oracle Enterprise Manager 12c">

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000009 - Oracle WebLogic must utilize cryptography to protect the confidentiality of remote access management sessions - Unsecure Listen Port"
  info            : "Remote management access is accomplished by leveraging common communication protocols and establishing a remote connection to the application server via a network for the purposes of managing the application server. If cryptography is not used, then the session data traversing the remote connection could be intercepted and compromised.

Types of management interfaces utilized by an application server include web-based HTTPS interfaces as well as command line-based management interfaces. All application server management interfaces must utilize cryptographic encryption."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000068,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70459r2_rule,STIG-ID|WBLC-01-000009,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56205"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000009 - Oracle WebLogic must utilize cryptography to protect the confidentiality of remote access management sessions - SSL Listen Port"
  info            : "Remote management access is accomplished by leveraging common communication protocols and establishing a remote connection to the application server via a network for the purposes of managing the application server. If cryptography is not used, then the session data traversing the remote connection could be intercepted and compromised.

Types of management interfaces utilized by an application server include web-based HTTPS interfaces as well as command line-based management interfaces. All application server management interfaces must utilize cryptographic encryption."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000068,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70459r2_rule,STIG-ID|WBLC-01-000009,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56205"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000010 - Oracle WebLogic must use cryptography to protect the integrity of the remote access session - Unsecure Listen Port"
  info            : "Encryption is critical for protection of remote access sessions. If encryption is not being used for integrity, malicious users may gain the ability to modify the application server configuration. The use of cryptography for ensuring integrity of remote access sessions mitigates that risk.

Application servers utilize a web management interface and scripted commands when allowing remote access. Web access requires the use of SSL 3.0 or TLS 1.0 and scripted access requires using ssh or some other form of approved cryptography. Application servers must have a capability to enable a secure remote admin capability."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001453,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70461r2_rule,STIG-ID|WBLC-01-000010,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56207"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000010 - Oracle WebLogic must use cryptography to protect the integrity of the remote access session - SSL Listen Port"
  info            : "Encryption is critical for protection of remote access sessions. If encryption is not being used for integrity, malicious users may gain the ability to modify the application server configuration. The use of cryptography for ensuring integrity of remote access sessions mitigates that risk.

Application servers utilize a web management interface and scripted commands when allowing remote access. Web access requires the use of SSL 3.0 or TLS 1.0 and scripted access requires using ssh or some other form of approved cryptography. Application servers must have a capability to enable a secure remote admin capability."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001453,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70461r2_rule,STIG-ID|WBLC-01-000010,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56207"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000011 - Oracle WebLogic must employ automated mechanisms to facilitate the monitoring and control of remote access methods."
  info            : "Remote network access is accomplished by leveraging common communication protocols and establishing a remote connection.

Application servers provide remote management access and need to provide the ability to facilitate the monitoring and control of remote user sessions. This includes the capability to directly trigger actions based on user activity or pass information to a separate application or entity that can then perform automated tasks based on the information.

Examples of automated mechanisms include but are not limited to: automated monitoring of log activity associated with remote access or process monitoring tools.

The application server must employ mechanisms that allow for monitoring and control of web-based and command line-based administrative remote sessions.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Services' -> 'Data Sources'
3. Utilize 'Change Center' to create a new change session
4. Click 'New' data source to create a new data source for the audit data store using schema IAU_APPEND
5. Enter database details and JNDI name, click through wizard
6. Select all servers and clusters available as targets to deploy this data source to
7. Finish creating the data source and record the JNDI name
8. Access EM
9. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Security Provider Configuration'
10. Beneath 'Audit Service' section, click 'Configure' button
11. Set the values for the IAU_APPEND schema and save configuration
12. Repeat steps 2-7 for data source named 'wls-wldf-storeDS' and WLS schema"
  reference       : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,CAT|II,CCI|CCI-000067,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS48,NIAv2|NS51,NIAv2|NS5g,NIAv2|NS5h,Rule-ID|SV-70463r1_rule,STIG-ID|WBLC-01-000011,SWIFT-CSCv1|2.6,Vuln-ID|V-56209"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.'jdbc-system-resource' | Foreach-Object {'JDBC Name: ' + $_.name + ', Target: ' + $_.target }"
  severity        : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "WBLC-01-000013 - Oracle WebLogic must ensure remote sessions for accessing security functions and security-relevant information are audited."
  info        : "Auditing must be utilized in order to track system activity, assist in diagnosing system issues and provide evidence needed for forensic investigations post security incident.

Remote access by administrators requires that the admin activity be audited.

Application servers provide a web- and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Audit Policy'
3. Select 'Oracle Platform Security Services' from the 'Audit Component Name' dropdown
4. Beneath 'Audit Policy Settings' section, select 'Custom' from the 'Audit Level' dropdown
5. Once it is enabled, click the 'Audit All Events' button and ensure every checkbox is selected under the 'Select For Audit' column of the policy category table. Click 'Apply'"
  reference   : "CAT|II,CCI|CCI-001454,Rule-ID|SV-70465r1_rule,STIG-ID|WBLC-01-000013,Vuln-ID|V-56211"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000014 - Oracle WebLogic must support the capability to disable network protocols deemed by the organization to be non-secure except for explicitly identified components in support of specific operational requirements."
  info            : "Some networking protocols may not meet organizational security requirements to protect data and components.

Application servers natively host a number of various features such as management interfaces, httpd servers, and message queues. These features all run on TCPIP ports. This creates the potential that the vendor may choose to utilize port numbers or network services that have been deemed unusable by the organization. The application server must have the capability to both reconfigure and disable the assigned ports without adversely impacting application server operation capabilities. For a list of approved ports and protocols, reference the DoD ports and protocols web site at https://iase.disa.mil/ppsm/Pages/index.aspx.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. To change port or protocol values, from 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which needs modification
4. Utilize 'Change Center' to create a new change session
5. To modify port assignment, from 'Configuration' tab -> 'General' tab, reassign the port for this server by changing the 'SSL Listen Port' field and click 'Save'
6. To modify protocol configuration, select 'Protocols' tab
7. Use the subtabs 'HTTP', 'jCOM', and 'IIOP' to configure these protocols
8. Use the 'Channels' subtab to create/modify channels which configure other protocols
9. Repeat steps 3-8 for all servers requiring modification
10. Review the 'Port Usage' table in EM again to ensure port has been reassigned"
  reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-001436,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-70467r2_rule,STIG-ID|WBLC-01-000014,SWIFT-CSCv1|2.3,Vuln-ID|V-56213"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object { 'SSL Listen Port for ' + $_.name + ': ' + $_.ssl.'listen-port' }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000018 - Oracle WebLogic must automatically audit account creation - Auditing Provider"
  info            : "Application servers require user accounts for server management purposes, and if the creation of new accounts is not logged, there is limited or no capability to track or alarm on account creation. This could result in the circumvention of the normal account creation process and introduce a persistent threat. Therefore, an audit trail that documents the creation of application user accounts must exist.

An application server could possibly provide the capability to utilize either a local or centralized user registry. A centralized, enterprise user registry such as AD or LDAP is more likely to already contain provisions for automated account management, whereas a localized user registry will rely upon either the underlying OS or built-in application server user management capabilities. Either way, application servers must create a log entry when accounts are created."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Auditing' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select an auditing provider type (ex: DefaultAuditor) in the 'Type' dropdown. Click 'OK'.
7. From 'Domain Structure', select the top-level domain link
8. Click 'Advanced' near the bottom of the page
9. Set 'Configuration Audit Type' dropdown to 'Change Log and Audit'
10. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000018,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70469r1_rule,STIG-ID|WBLC-01-000018,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56215"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Audit Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.'security-configuration'.realm.auditor | Foreach-Object { if ($_.name) {'Audit Provider: ' + $_.name } Else { 'Failed: No Audit Providers Found' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000018 - Oracle WebLogic must automatically audit account creation - Configuration Audit Type"
  info            : "Application servers require user accounts for server management purposes, and if the creation of new accounts is not logged, there is limited or no capability to track or alarm on account creation. This could result in the circumvention of the normal account creation process and introduce a persistent threat. Therefore, an audit trail that documents the creation of application user accounts must exist.

An application server could possibly provide the capability to utilize either a local or centralized user registry. A centralized, enterprise user registry such as AD or LDAP is more likely to already contain provisions for automated account management, whereas a localized user registry will rely upon either the underlying OS or built-in application server user management capabilities. Either way, application servers must create a log entry when accounts are created."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Auditing' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select an auditing provider type (ex: DefaultAuditor) in the 'Type' dropdown. Click 'OK'.
7. From 'Domain Structure', select the top-level domain link
8. Click 'Advanced' near the bottom of the page
9. Set 'Configuration Audit Type' dropdown to 'Change Log and Audit'
10. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000018,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70469r1_rule,STIG-ID|WBLC-01-000018,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56215"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain | Foreach-Object { if ($_.'configuration-audit-type' -eq 'logaudit' ) {'Passed: Configuration Audit Type set to Change Log and Audit' } Else { 'Failed: Configuration Audit Type not set to Change Log and Audit' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000019 - Oracle WebLogic must automatically audit account modification - Auditing Provider"
  info            : "Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply modify an existing account.

Application servers have the capability to contain user information in a local user store, or they can leverage a centralized authentication mechanism like LDAP. Either way, the mechanism used by the application server must automatically log when user accounts are modified."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Auditing' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select an auditing provider type (ex: DefaultAuditor) in the 'Type' dropdown. Click 'OK'.
7. From 'Domain Structure', select the top-level domain link
8. Click 'Advanced' near the bottom of the page
9. Set 'Configuration Audit Type' dropdown to 'Change Log and Audit'
10. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001403,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70471r1_rule,STIG-ID|WBLC-01-000019,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56217"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Audit Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.'security-configuration'.realm.auditor | Foreach-Object { if ($_.name) {'Audit Provider: ' + $_.name } Else { 'Failed: No Audit Providers Found' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000019 - Oracle WebLogic must automatically audit account modification - Configuration Audit Type"
  info            : "Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply modify an existing account.

Application servers have the capability to contain user information in a local user store, or they can leverage a centralized authentication mechanism like LDAP. Either way, the mechanism used by the application server must automatically log when user accounts are modified."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Auditing' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select an auditing provider type (ex: DefaultAuditor) in the 'Type' dropdown. Click 'OK'.
7. From 'Domain Structure', select the top-level domain link
8. Click 'Advanced' near the bottom of the page
9. Set 'Configuration Audit Type' dropdown to 'Change Log and Audit'
10. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001403,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70471r1_rule,STIG-ID|WBLC-01-000019,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56217"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain | Foreach-Object { if ($_.'configuration-audit-type' -eq 'logaudit' ) {'Passed: Configuration Audit Type set to Change Log and Audit' } Else { 'Failed: Configuration Audit Type not set to Change Log and Audit' } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-01-000030 - Oracle WebLogic must provide access logging that ensures users who are granted a privileged role (or roles) have their privileged activity logged."
  info        : "In order to be able to provide a forensic history of activity, the application server must ensure users who are granted a privileged role or those who utilize a separate distinct account when accessing privileged functions or data have their actions logged.

If privileged activity is not logged, no forensic logs can be used to establish accountability for privileged actions that occur on the system.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Audit Policy'
3. Select 'Oracle Platform Security Services' from the 'Audit Component Name' dropdown
4. Beneath 'Audit Policy Settings' section, enter the comma-delimited list of privileged users (e.g., WebLogic, etc.) in the 'Users to Always Audit' field. Click 'Apply'"
  reference   : "CAT|II,CCI|CCI-000040,Rule-ID|SV-70473r1_rule,STIG-ID|WBLC-01-000030,Vuln-ID|V-56219"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000032 - Oracle WebLogic must limit the number of failed login attempts to an organization-defined number of consecutive invalid attempts that occur within an organization-defined time period."
  info            : "Anytime an authentication method is exposed so as to allow for the login to an application, there is a risk that attempts will be made to obtain unauthorized access.

By limiting the number of failed login attempts that occur within a particular time period, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account once the number of failed attempts has been exceeded."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Configuration' tab -> 'User Lockout' tab
5. Utilize 'Change Center' to create a new change session
6. Set the following values in the fields as shown:
'Lockout Threshold' = 3
'Lockout Duration' = 15
'Lockout Reset Duration' = 15
7. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-70475r1_rule,STIG-ID|WBLC-01-000032,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-56221"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.'security-configuration' | Foreach-Object { if ($_.realm.'user-lockout-manager'.'lockout-threshold' -eq '3' ) {'Passed: Lockout Threshold = ' +  $_.realm.'user-lockout-manager'.'lockout-threshold' } Else { 'Failed: Lockout Threshold invalid or not set, current Lockout Threshold = ' + $_.realm.'user-lockout-manager'.'lockout-threshold' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000033 - Oracle WebLogic must enforce the organization-defined time period during which the limit of consecutive invalid access attempts by a user is counted."
  info            : "By limiting the number of failed login attempts, the risk of unauthorized system access via automated user password guessing, otherwise known as brute-forcing, is reduced. Best practice requires a time period be applied in which the number of failed attempts is counted (Example: 5 failed attempts within 5 minutes). Limits are imposed by locking the account.

Application servers provide a management capability that allows a user to login via a web interface or a command shell. Application servers also utilize either a local user store or a centralized user store such as an LDAP server. As such, the authentication method employed by the application server must be able to limit the number of consecutive invalid access attempts within the specified time period regardless of access method or user store utilized."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Configuration' tab -> 'User Lockout' tab
5. Utilize 'Change Center' to create a new change session
6. Set the following values in the fields as shown:
'Lockout Threshold' = 3
'Lockout Duration' = 15
'Lockout Reset Duration' = 15
7. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-001452,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-70477r1_rule,STIG-ID|WBLC-01-000033,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-56223"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.'security-configuration' | Foreach-Object { if ($_.realm.'user-lockout-manager'.'lockout-duration' -eq '15' ) {'Passed: Lockout Duration = ' +  $_.realm.'user-lockout-manager'.'lockout-duration' } Else { 'Failed: Lockout Duration invalid or not set, current Lockout Duration = ' + $_.realm.'user-lockout-manager'.'lockout-duration' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-01-000034 - Oracle WebLogic must automatically lock accounts when the maximum number of unsuccessful login attempts is exceeded for an organization-defined time period or until the account is unlocked by an administrator."
  info            : "Anytime an authentication method is exposed so as to allow for the utilization of an application interface, there is a risk that attempts will be made to obtain unauthorized access.

By locking the account when the pre-defined number of failed login attempts has been exceeded, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.

Specifying a time period in which the account is to remain locked serves to obstruct the operation of automated password guessing tools while allowing a valid user to reinitiate login attempts after the expiration of the time period without administrative assistance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Configuration' tab -> 'User Lockout' tab
5. Utilize 'Change Center' to create a new change session
6. Set the following values in the fields as shown:
'Lockout Threshold' = 3
'Lockout Duration' = 15
'Lockout Reset Duration' = 15
7. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000047,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),CN-L3|8.1.4.1(b),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-70479r1_rule,STIG-ID|WBLC-01-000034,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-56225"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.'security-configuration' | Foreach-Object { if ($_.realm.'user-lockout-manager'.'lockout-reset-duration' -eq '15' ) {'Passed: Lockout Reset Duration = ' +  $_.realm.'user-lockout-manager'.'lockout-reset-duration' } Else { 'Failed: Lockout Reset Duration invalid or not set, current Lockout Reset Duration = ' + $_.realm.'user-lockout-manager'.'lockout-reset-duration' } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-02-000062 - Oracle WebLogic must protect against an individual falsely denying having performed a particular action."
  info        : "Non-repudiation of actions taken is required in order to maintain application integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message.

Non-repudiation protects individuals against later claims by an author of not having authored a particular document, a sender of not having transmitted a message, a receiver of not having received a message, or a signatory of not having signed a document.

Typical application server actions requiring non-repudiation will be related to application deployment among developer/users and administrative actions taken by admin personnel.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Audit Policy'
3. Select 'Oracle Platform Security Services' from the 'Audit Component Name' dropdown
4. Beneath 'Audit Policy Settings' section, select 'Custom' from the 'Audit Level' dropdown
5. Once it is enabled, click the 'Audit All Events' button and ensure every checkbox is selected under the 'Select For Audit' column of the policy category table. Click 'Apply'
6. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
7. Access EM
8. Select the server or cluster from the navigation tree
9. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
10. Again, select the server or cluster from the navigation tree
11. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down
12. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|II,CCI|CCI-000166,Rule-ID|SV-70481r1_rule,STIG-ID|WBLC-02-000062,Vuln-ID|V-56227"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000065 - Oracle WebLogic must compile audit records from multiple components within the system into a system-wide (logical or physical) audit trail that is time-correlated to within an organization-defined level of tolerance."
  info            : "Audit generation and audit records can be generated from various components within the application server. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records (e.g., auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked).

The events occurring must be time-correlated in order to conduct accurate forensic analysis. In addition, the correlation must meet a certain tolerance criteria. For instance, DoD may define that the time stamps of different audited events must not differ by any amount greater than ten seconds. It is also acceptable for the application server to utilize an external auditing tool that provides this capability.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Services' -> 'Data Sources'
3. Utilize 'Change Center' to create a new change session
4. Click 'New' data source to create a new data source for the audit data store using schema IAU_APPEND
5. Enter database details and JNDI name, click through wizard
6. Select all servers and clusters available as targets to deploy this data source to
7. Finish creating the data source and record the JNDI name
8. Access EM
9. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Security Provider Configuration'
10. Beneath 'Audit Service' section, click 'Configure' button
11. Set the values for the IAU_APPEND schema and save configuration
12. Repeat steps 2-7 for data source named 'wls-wldf-storeDS' and WLS schema"
  reference       : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,CAT|III,CCI|CCI-000174,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS48,NIAv2|NS51,NIAv2|NS5g,NIAv2|NS5h,Rule-ID|SV-70483r1_rule,STIG-ID|WBLC-02-000065,SWIFT-CSCv1|2.6,Vuln-ID|V-56229"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.'jdbc-system-resource' | Foreach-Object {'JDBC Name: ' + $_.name + ', Target: ' + $_.target }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000069 - Oracle WebLogic must generate audit records for the DoD-selected list of auditable events."
  info            : "Audit records can be generated from various components within the application server. The list of audited events is the set of events for which audits are to be generated.

This set of events is typically a subset of the list of all events for which the system is capable of generating audit records (e.g., auditable events, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked).

The DoD-required auditable events are events that assist in intrusion detection and forensic analysis. Failure to capture them increases the likelihood that an adversary can breach the system without detection."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which needs logging enabled
4. Utilize 'Change Center' to create a new change session
5. From 'Logging' tab -> 'HTTP' tab, select 'HTTP access log file enabled' checkbox. Click 'Save'
6. From 'Logging' tab -> 'General' tab, set the 'Log file name' field to 'logs/<server-name>.log. Click 'Save'
7. From 'Change Center' click 'Activate Changes' to enable configuration changes
8. Access EM
9. Expand the domain from the navigation tree, and select the server which needs JVM logging configured
10. Use the dropdown to select 'WebLogic Server' -> 'Logs' -> 'Log Configuration'
11. Select the 'Log Levels' tab, and within the table, expand 'Root Logger' node
12. Set 'Oracle Diagnostic Logging Level' value to 'WARNING' and click 'Apply'"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70485r1_rule,STIG-ID|WBLC-02-000069,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56231"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Failed.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.server | Foreach-Object { if (($_.'web-server'.'web-server-log'.'logging-enabled' -eq 'true' ) -or (!$_.'web-server'.'web-server-log'.'logging-enabled')) {'Passed - Server: ' +  $_.name + ', HTTP access log enabled' } Else { 'Failed - Server: ' + $_.name + ', HTTP access log not enabled' } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000073 - Oracle WebLogic must produce process events and severity levels to establish what type of HTTPD-related events and severity levels occurred."
  info            : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Application servers must log all relevant log data that pertains to application server functionality. Examples of relevant data include, but are not limited to Java Virtual Machine (JVM) activity, HTTPD/Web server activity and application server-related system process activity."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which needs HTTPD logging enabled
4. Utilize 'Change Center' to create a new change session
5. From 'Logging' tab -> 'HTTP' tab, select 'HTTP access log file enabled' checkbox
6. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|III,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70487r1_rule,STIG-ID|WBLC-02-000073,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56233"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.server | Foreach-Object { if ($_.'web-server'.'web-server-log'.'logging-enabled' -eq 'true') {'Passed - Server: ' +  $_.name + ', HTTP access log enabled' } Else { 'Failed - Server: ' + $_.name + ', HTTP access log not enabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-02-000074 - Oracle WebLogic must produce audit records containing sufficient information to establish what type of JVM-related events and severity levels occurred."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control, includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Application servers must log all relevant log data that pertains to application server functionality. Examples of relevant data include, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD activity and application server-related system process activity.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Expand the domain from the navigation tree, and select the server which needs JVM logging configured
3. Use the dropdown to select 'WebLogic Server' -> 'Logs' -> 'Log Configuration'
4. Select the 'Log Levels' tab, and within the table, expand 'Root Logger' node
5. Set 'Oracle Diagnostic Logging Level' value to 'WARNING' and click 'Apply'"
  reference   : "CAT|III,CCI|CCI-000130,Rule-ID|SV-70489r1_rule,STIG-ID|WBLC-02-000074,Vuln-ID|V-56235"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000075 - Oracle WebLogic must produce process events and security levels to establish what type of Oracle WebLogic process events and severity levels occurred."
  info            : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control, includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Application servers must log all relevant log data that pertains to application server functionality. Examples of relevant data include, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD activity and application server-related system process activity.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which needs AS process logging configured
4. Utilize 'Change Center' to create a new change session
5. From 'Logging' tab -> 'General' tab, set the 'Log file name' field to 'logs/<server-name>.log
6. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes"
  reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|III,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-70491r1_rule,STIG-ID|WBLC-02-000075,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-56237"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\Config.xml)).domain.server | Foreach-Object {  'Server: ' +  $_.name + ', Log file name:' + $_.log.'file-name' }"
  severity        : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "WBLC-02-000076 - Oracle WebLogic must produce audit records containing sufficient information to establish when (date and time) the events occurred."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

In addition to logging event information, application servers must also log the corresponding dates and times of these events. Examples of event data include, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD activity and application server-related system process activity.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
2. Access EM
3. Select the server or cluster from the navigation tree
4. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
5. Again, select the server or cluster from the navigation tree
6. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down.
7. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|III,CCI|CCI-000131,Rule-ID|SV-70493r1_rule,STIG-ID|WBLC-02-000076,Vuln-ID|V-56239"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000077 - Oracle WebLogic must produce audit records containing sufficient information to establish where the events occurred."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Without sufficient information establishing where the audit events occurred, investigation into the cause of events is severely hindered.

In addition to logging relevant data, application servers must also log information to indicate the location of these events. Examples of relevant data include, but are not limited to, Java Virtual Machine (JVM) activity, HTTPD activity and application server-related system process activity.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
2. Access EM
3. Select the server or cluster from the navigation tree
4. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
5. Again, select the server or cluster from the navigation tree
6. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down.
7. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|III,CCI|CCI-000132,Rule-ID|SV-70495r1_rule,STIG-ID|WBLC-02-000077,Vuln-ID|V-56241"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000078 - Oracle WebLogic must produce audit records containing sufficient information to establish the sources of the events."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application specific events, success/fail indications, filenames involved, access control or flow control rules invoked.

Without information establishing the source of activity, the value of audit records from a forensics perspective is questionable.

Examples of activity sources include, but are not limited to, application process sources such as one process affecting another process, user-related activity, and activity resulting from remote network system access (IP addresses).

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
2. Access EM
3. Select the server or cluster from the navigation tree
4. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
5. Again, select the server or cluster from the navigation tree
6. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down.
7. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|III,CCI|CCI-000133,Rule-ID|SV-70497r1_rule,STIG-ID|WBLC-02-000078,Vuln-ID|V-56243"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000079 - Oracle WebLogic must produce audit records that contain sufficient information to establish the outcome (success or failure) of application server and application events."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application specific events, success/fail indications, filenames involved, access control or flow control rules invoked.

Success and failure indicators ascertain the outcome of a particular application server event of function. As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
2. Access EM
3. Select the server or cluster from the navigation tree
4. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
5. Again, select the server or cluster from the navigation tree
6. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down.
7. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|III,CCI|CCI-000134,Rule-ID|SV-70499r1_rule,STIG-ID|WBLC-02-000079,Vuln-ID|V-56245"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000080 - Oracle WebLogic must produce audit records containing sufficient information to establish the identity of any user/subject or process associated with the event."
  info        : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control, includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Application servers have differing levels of logging capabilities which can be specified by setting a verbosity level. The application server must, at a minimum, be capable of establishing the identity of any user or process that is associated with any particular event.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. If managed server or deployments do not appear in the list of log files, the 'JRF Template' must be applied to the server/cluster
2. Access EM
3. Select the server or cluster from the navigation tree
4. If the 'Apply JRF Template' button appears, click this button and wait for the confirmation message that the template has been successfully applied
5. Again, select the server or cluster from the navigation tree
6. Click the 'Shut Down...' button, and click 'Shutdown' in the confirmation popup. Wait for server or cluster to shut down
7. Click the 'Start Up' button for the server or cluster to start up again"
  reference   : "CAT|II,CCI|CCI-001487,Rule-ID|SV-70501r1_rule,STIG-ID|WBLC-02-000080,Vuln-ID|V-56247"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000081 - Oracle WebLogic must provide the ability to write specified audit record content to an audit log server."
  info            : "Information system auditing capability is critical for accurate forensic analysis. Audit record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application specific events, success/fail indications, filenames involved, access control or flow control rules invoked.

Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to be capable of writing logs to centralized audit log servers.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Services' -> 'Data Sources'
3. Utilize 'Change Center' to create a new change session
4. Click 'New' data source to create a new data source for the audit data store using schema IAU_APPEND
5. Enter database details and JNDI name, click through wizard
6. Select all servers and clusters available as targets to deploy this data source to
7. Finish creating the data source and record the JNDI name
8. Access EM
9. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Security Provider Configuration'
10. Beneath 'Audit Service' section, click 'Configure' button
11. Set the values for the IAU_APPEND schema and save configuration
12. Repeat steps 2-7 for data source named 'wls-wldf-storeDS' and WLS schema"
  reference       : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,CAT|II,CCI|CCI-000136,CN-L3|7.1.2.2(h),CN-L3|7.1.3.7(a),CN-L3|8.1.10.6(i),CN-L3|8.1.4.4(c),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.6.2.2,ITSG-33|AC-17,NESA|T4.2.1,NESA|T4.5.1,NESA|T5.1.1,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.7.1,NESA|T5.7.2,NIAv2|AM40,NIAv2|AM41,NIAv2|NS48,NIAv2|NS51,NIAv2|NS5g,NIAv2|NS5h,Rule-ID|SV-70503r1_rule,STIG-ID|WBLC-02-000081,SWIFT-CSCv1|2.6,Vuln-ID|V-56249"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.'jdbc-system-resource' | Foreach-Object {'JDBC Name: ' + $_.name + ', Target: ' + $_.target }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000083 - Oracle WebLogic must provide a real-time alert when organization-defined audit failure events occur - Module-HealthState"
  info            : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Notification of the failure event will allow administrators to take actions so that logs are not lost."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button.
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch' Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000144,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70505r1_rule,STIG-ID|WBLC-02-000083,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56251"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.watch.enabled -eq 'true') { 'Passed - Module-HealthState/ServerHealthWatch is Enabled' } Else { 'Failed - Module-HealthState/ServerHealthWatch is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000083 - Oracle WebLogic must provide a real-time alert when organization-defined audit failure events occur - SMTP Notification"
  info            : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Notification of the failure event will allow administrators to take actions so that logs are not lost."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button.
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch' Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000144,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70505r1_rule,STIG-ID|WBLC-02-000083,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56251"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.'smtp-notification'.enabled -eq 'true') { 'Passed - Module-HealthState/SMTP Notification is Enabled' } Else { 'Failed - Module-HealthState/SMTP Notification is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000084 - Oracle WebLogic must alert designated individual organizational officials in the event of an audit processing failure - Module-HealthState"
  info            : "Audit processing failures include, but are not limited to, failures in the application server log capturing mechanisms or audit storage capacity being reached or exceeded. In some instances, it is preferred to send alarms to individuals rather than to an entire group. Application servers must be able to trigger an alarm and send that alert to designated individuals in the event there is an application server audit processing failure."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000139,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70507r1_rule,STIG-ID|WBLC-02-000084,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56253"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.watch.enabled -eq 'true') { 'Passed - Module-HealthState/ServerHealthWatch is Enabled' } Else { 'Failed - Module-HealthState/ServerHealthWatch is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000084 - Oracle WebLogic must alert designated individual organizational officials in the event of an audit processing failure - SMTP Notification"
  info            : "Audit processing failures include, but are not limited to, failures in the application server log capturing mechanisms or audit storage capacity being reached or exceeded. In some instances, it is preferred to send alarms to individuals rather than to an entire group. Application servers must be able to trigger an alarm and send that alert to designated individuals in the event there is an application server audit processing failure."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000139,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70507r1_rule,STIG-ID|WBLC-02-000084,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56253"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.'smtp-notification'.enabled -eq 'true') { 'Passed - Module-HealthState/SMTP Notification is Enabled' } Else { 'Failed - Module-HealthState/SMTP Notification is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000086 - Oracle WebLogic must notify administrative personnel as a group in the event of audit processing failure - Module-HealthState"
  info            : "Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. To ensure flexibility and ease of use, application servers must be capable of notifying a group of administrative personnel upon detection of an application audit log processing failure."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000140,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70509r1_rule,STIG-ID|WBLC-02-000086,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56255"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.watch.enabled -eq 'true') { 'Passed - Module-HealthState/ServerHealthWatch is Enabled' } Else { 'Failed - Module-HealthState/ServerHealthWatch is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-02-000086 - Oracle WebLogic must notify administrative personnel as a group in the event of audit processing failure - SMTP Notification"
  info            : "Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. To ensure flexibility and ease of use, application servers must be capable of notifying a group of administrative personnel upon detection of an application audit log processing failure."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|III,CCI|CCI-000140,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70509r1_rule,STIG-ID|WBLC-02-000086,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56255"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.'smtp-notification'.enabled -eq 'true') { 'Passed - Module-HealthState/SMTP Notification is Enabled' } Else { 'Failed - Module-HealthState/SMTP Notification is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-02-000093 - Oracle WebLogic must use internal system clocks to generate time stamps for audit records."
  info        : "Without the use of an approved and synchronized time source, configured on the systems, events cannot be accurately correlated and analyzed to determine what is transpiring within the application server.

If an event has been triggered on the network, and the application server is not configured with the correct time, the event may be seen as insignificant, when in reality the events are related and may have a larger impact across the network. Synchronization of system clocks is needed in order to correctly correlate the timing of events that occur across multiple systems. Determining the correct time a particular event occurred on a system, via time stamps, is critical when conducting forensic analysis and investigating system events.
Application servers must utilize the internal system clock when generating time stamps and audit records.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Security Provider Configuration'
3. Beneath 'Audit Service' section, click 'Configure' button
4. Set the 'Timezone Settings' radio button to 'UTC' so audit logs will be time stamped in Coordinated Universal Time regardless of the time zone of the underlying physical or virtual machine
5. The time stamp will be recorded according to the operating system's set time
6. Click 'Apply' and restart the servers in the WebLogic domain"
  reference   : "CAT|III,CCI|CCI-000159,Rule-ID|SV-70511r1_rule,STIG-ID|WBLC-02-000093,Vuln-ID|V-56257"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000094 - Oracle WebLogic must synchronize with internal information system clocks which, in turn, are synchronized on an organization-defined frequency with an organization-defined authoritative time source."
  info        : "Determining the correct time a particular application event occurred on a system is critical when conducting forensic analysis and investigating system events.

Synchronization of system clocks is needed in order to correctly correlate the timing of events that occur across multiple systems. To meet that requirement the organization will define an authoritative time source and frequency to which each system will synchronize its internal clock.

Application servers must defer accurate timekeeping services to the operating system upon which the application server is installed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Security Provider Configuration'
3. Beneath 'Audit Service' section, click 'Configure' button
4. Set the 'Timezone Settings' radio button to 'UTC' so audit logs will be time stamped in Coordinated Universal Time regardless of the time zone of the underlying physical or virtual machine
5. The time stamp will be recorded according to the operating system's set time
6. Click 'Apply' and restart the servers in the WebLogic domain"
  reference   : "CAT|III,CCI|CCI-000160,Rule-ID|SV-70513r1_rule,STIG-ID|WBLC-02-000094,Vuln-ID|V-56259"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000095 - Oracle WebLogic must protect audit information from any type of unauthorized read access."
  info        : "If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.

Application servers contain admin interfaces that allow reading and manipulation of audit records. Therefore, these interfaces should not allow for unfettered access to those records. Application servers also write audit data to log files which are stored on the OS, so appropriate file permissions must also be used to restrict access.

Audit information includes all information (e.g., audit records, audit settings, transaction logs, and audit reports) needed to successfully audit information system activity. Application servers must protect audit information from unauthorized read access.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have audit read access
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove all of the following roles - 'Admin', 'Deployer', 'Monitor', 'Operator'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have audit read access"
  reference   : "CAT|III,CCI|CCI-000162,Rule-ID|SV-70515r1_rule,STIG-ID|WBLC-02-000095,Vuln-ID|V-56261"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000098 - Oracle WebLogic must protect audit tools from unauthorized access."
  info        : "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized access.

Application servers provide a web and/or a command line-based management functionality for managing the application server audit capabilities. In addition, subsets of audit tool components may be stored on the file system as jar or xml configuration files. The application server must ensure that in addition to protecting any web based audit tools, any file system-based tools are protected as well.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have audit tool configuration access
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove the role - 'Admin'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have audit tool configuration access"
  reference   : "CAT|II,CCI|CCI-001493,Rule-ID|SV-70517r1_rule,STIG-ID|WBLC-02-000098,Vuln-ID|V-56263"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000099 - Oracle WebLogic must protect audit tools from unauthorized modification."
  info        : "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized modification. If an attacker were to modify audit tools, he could also manipulate logs to hide evidence of malicious activity.

Application servers provide a web- and/or a command line-based management functionality for managing the application server audit capabilities. In addition, subsets of audit tool components may be stored on the file system as jar or xml configuration files. The application server must ensure that in addition to protecting any web-based audit tools, any file system-based tools are protected as well.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have audit tool configuration access
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove the role - 'Admin'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have audit tool configuration access"
  reference   : "CAT|II,CCI|CCI-001494,Rule-ID|SV-70519r1_rule,STIG-ID|WBLC-02-000099,Vuln-ID|V-56265"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-02-000100 - Oracle WebLogic must protect audit tools from unauthorized deletion."
  info        : "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized modification. If an attacker were to delete audit tools the application server administrators would have no way of managing or viewing the logs.

Application servers provide a web- and/or a command line-based management functionality for managing the application server audit capabilities. In addition, subsets of audit tool components may be stored on the file system as jar, class, or xml configuration files. The application server must ensure that in addition to protecting any web-based audit tools, any file system-based tools are protected from unauthorized deletion as well.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have audit tool configuration access
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove the role - 'Admin'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have audit tool configuration access"
  reference   : "CAT|II,CCI|CCI-001495,Rule-ID|SV-70521r1_rule,STIG-ID|WBLC-02-000100,Vuln-ID|V-56267"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-03-000125 - Oracle WebLogic must limit privileges to change the software resident within software libraries (including privileged programs)."
  info        : "Application servers have the ability to specify that the hosted applications utilize shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that non-privileged users cannot modify any shared library code at all.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have shared library modification access
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove the role - 'Admin', 'Deployer'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have shared library modification access"
  reference   : "CAT|II,CCI|CCI-001499,Rule-ID|SV-70523r1_rule,STIG-ID|WBLC-03-000125,Vuln-ID|V-56269"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-03-000127 - Oracle WebLogic must adhere to the principles of least functionality by providing only essential capabilities."
  info        : "Application servers provide a myriad of differing processes, features and functionalities. Some of these processes may be deemed to be unnecessary or too insecure to run on a production DoD system. Application servers must provide the capability to disable or deactivate functionality and services that are deemed to be non-essential to the server mission or can adversely impact server performance, for example, disabling dynamic JSP reloading on production application servers as a best practice.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Deployments'
3. Select a deployment of type 'Web Application' from list of deployments
4. Select 'Configuration' tab -> 'General' tab
5. Utilize 'Change Center' to create a new change session
6. Set 'JSP Page Check' field value to '-1', which indicates JSP reloading is disabled within this deployment. Click 'Save'. Repeat steps 3-6 for all 'Web Application' type deployments.
7. For every WebLogic resource within the domain, the 'Configuration' tab and associated subtabs provide the ability to disable or deactivate functionality and services that are deemed to be non-essential to the server mission or can adversely impact server performance"
  reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-70525r1_rule,STIG-ID|WBLC-03-000127,Vuln-ID|V-56271"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-03-000128 - Oracle WebLogic must prohibit or restrict the use of unauthorized functions, ports, protocols, and/or services."
  info            : "Application servers provide numerous processes, features, and functionalities that utilize TCP/IP ports. Some of these processes may be deemed to be unnecessary or too insecure to run on a production system. The application server must provide the capability to disable or deactivate network-related services that are deemed to be non-essential to the server mission, for example, disabling a protocol or feature that opens a listening port that is prohibited by DoD ports and protocols. For a list of approved ports and protocols reference the DoD ports and protocols web site at https://iase.disa.mil/ppsm/Pages/index.aspx.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. To change port or protocol values, from 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which needs modification
4. Utilize 'Change Center' to create a new change session
5. To modify port assignment, from 'Configuration' tab -> 'General' tab, reassign the port for this server by changing the 'SSL Listen Port' field and click 'Save'
6. To modify protocol configuration, select 'Protocols' tab
7. Use the subtabs 'HTTP', 'jCOM' and 'IIOP' to configure these protocols
8. Use the 'Channels' subtab to create/modify channels which configure other protocols
9. Repeat steps 3-8 for all servers requiring modification
10. Review the 'Port Usage' table in EM again to ensure port has been reassigned"
  reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-70527r2_rule,STIG-ID|WBLC-03-000128,SWIFT-CSCv1|2.3,Vuln-ID|V-56273"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object { 'SSL Listen Port for ' + $_.name + ': ' + $_.ssl.'listen-port' }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-03-000129 - Oracle WebLogic must utilize automated mechanisms to prevent program execution on the information system."
  info            : "The application server must provide a capability to halt or otherwise disable the automatic execution of deployed applications until such time that the application is considered part of the established application server baseline. Deployment to the application server should not provide a means for automatic application start-up should the application server itself encounter a restart condition."
  solution        : "1. Access AC
2. From 'Domain Structure', select the top-level domain
3. Select 'Configuration' tab -> 'General' tab
4. Check 'Production Mode' checkbox. Click 'Save'
5. Restart all servers"
  reference       : "800-171|3.4.7,800-53|CM-7(2),CAT|III,CCI|CCI-000386,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),Rule-ID|SV-70529r1_rule,STIG-ID|WBLC-03-000129,SWIFT-CSCv1|2.3,Vuln-ID|V-56275"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain | Foreach-Object { if ($_.'production-mode-enabled' -eq 'true') { 'Passed - Production Mode is enabled on domain: ' + $_.name } Else { 'Failed - Production Mode is not enabled on domain: ' + $_.name } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000150 - Oracle WebLogic must uniquely identify and authenticate users (or processes acting on behalf of users)."
  info            : "To assure accountability and prevent unauthorized access, application server users must be uniquely identified and authenticated.

The application server must uniquely identify and authenticate application server users or processes acting on behalf of users. This is typically accomplished via the use of a user store which is either local (OS-based) or centralized (LDAP) in nature."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Authentication' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., LDAPAuthenticator) in the 'Type' dropdown. Click 'OK'
7. From the list, select the newly created authentication provider and select the 'Configuration' tab -> 'Provider Specific' tab
8. Set all provider specific values to configure the new authentication provider. Click 'Save'
9. Continuing from step 4, if the new authentication provider is perimeter-based, click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., SAML2IdentityAsserter) in the 'Type' dropdown. Click 'OK'
10. From the list, select the newly created authentication identity asserter and select the 'Configuration' tab -> 'Provider Specific' tab
11. Set all provider-specific values to configure the new authentication identity asserter. Click 'Save'"
  reference       : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000764,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-70531r1_rule,STIG-ID|WBLC-05-000150,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-56277"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Authentication Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'authentication-provider' | Foreach-Object { if ($_.type -notlike 'wls:default*') {'Authentication Provider: ' + $_.name; $fail = 0; } Else { $fail = 1 }  }; if ($fail -eq '1') { 'Failed: No non-default authentication providers found' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000153 - Oracle WebLogic must authenticate users individually prior to using a group authenticator."
  info            : "To assure individual accountability and prevent unauthorized access, application server users (and any processes acting on behalf of application server users) must be individually identified and authenticated.

A group authenticator is a generic account used by multiple individuals. Use of a group authenticator alone does not uniquely identify individual users.

Application servers must ensure that individual users are authenticated prior to authenticating via role or group authentication. This is to ensure that there is non-repudiation for actions taken."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Authentication' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., LDAPAuthenticator) in the 'Type' dropdown. Click 'OK'
7. From the list, select the newly created authentication provider and select the 'Configuration' tab -> 'Provider Specific' tab
8. Set all provider specific values to configure the new authentication provider. Click 'Save'
9. Continuing from step 4, if the new authentication provider is perimeter-based, click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., SAML2IdentityAsserter) in the 'Type' dropdown. Click 'OK'
10. From the list, select the newly created authentication identity asserter and select the 'Configuration' tab -> 'Provider Specific' tab
11. Set all provider specific values to configure the new authentication identity asserter. Click 'Save'"
  reference       : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000770,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-70533r1_rule,STIG-ID|WBLC-05-000153,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-56279"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Authentication Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'authentication-provider' | Foreach-Object { if ($_.type -notlike 'wls:default*') {'Authentication Provider: ' + $_.name; $fail = 0; } Else { $fail = 1 }  }; if ($fail -eq '1') { 'Failed: No non-default authentication providers found' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000160 - Oracle WebLogic must enforce minimum password length."
  info            : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password length is one of several factors that helps to determine strength and how long it takes to crack a password. The shorter the password is, the lower the number of possible combinations that need to be tested before the password is compromised.

Application servers either provide a local user store, or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must enforce minimum password length."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Password Validation' subtab
5. Select 'SystemPasswordValidator'
6. Select 'Configuration' tab -> 'Provider Specific' subtab
7. Utilize 'Change Center' to create a new change session
8. Set 'Minimum Password Length' field value to '15'. Click 'Save'"
  reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-70535r1_rule,STIG-ID|WBLC-05-000160,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-56281"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Minimum Password Length: (1[5-9]|[2-9][0-9])"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'password-validator' | Foreach-Object { 'Minimum Password Length: ' + $_.'min-password-length' }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000162 - Oracle WebLogic must enforce password complexity by the number of upper-case characters used."
  info            : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Use of a complex password helps to increase the time and resources required to compromise the password.

Application servers either provide a local user store, or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must enforce the organization's password complexity requirements, which includes the requirement to use a specific number of upper-case characters."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Password Validation' subtab
5. Select 'SystemPasswordValidator'
6. Select 'Configuration' tab -> 'Provider Specific' subtab
7. Utilize 'Change Center' to create a new change session
8. Set 'Minimum Number of Upper Case Characters' field value to '1' or higher. Click 'Save'"
  reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000192,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-70537r1_rule,STIG-ID|WBLC-05-000162,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-56283"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Minimum Number of Upper Case Characters: ([1-9]|[1-9][0-9])"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'password-validator' | Foreach-Object { 'Minimum Number of Upper Case Characters: ' + $_.'min-uppercase-characters' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000163 - Oracle WebLogic must enforce password complexity by the number of lower-case characters used."
  info            : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Use of a complex password helps to increase the time and resources required to compromise the password.

Application servers either provide a local user store, or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must enforce the organization's password complexity requirements, which include the requirement to use a specific number of lower-case characters."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Password Validation' subtab
5. Select 'SystemPasswordValidator'
6. Select 'Configuration' tab -> 'Provider Specific' subtab
7. Utilize 'Change Center' to create a new change session
8. Set 'Minimum Number of Lower Case Characters' field value to '1' or higher. Click 'Save'"
  reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000193,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-70539r1_rule,STIG-ID|WBLC-05-000163,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-56285"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Minimum Number of Lower Case Characters: ([1-9]|[1-9][0-9])"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'password-validator' | Foreach-Object { 'Minimum Number of Lower Case Characters: ' + $_.'min-lowercase-characters' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000164 - Oracle WebLogic must enforce password complexity by the number of numeric characters used."
  info            : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Use of a complex password helps to increase the time and resources required to compromise the password.

Application servers provide either a local user store or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must enforce the organization's password complexity requirements that include the requirement to use a specific number of numeric characters when passwords are created or changed."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Password Validation' subtab
5. Select 'SystemPasswordValidator'
6. Select 'Configuration' tab -> 'Provider Specific' subtab
7. Utilize 'Change Center' to create a new change session
8. Set 'Minimum Number of Numeric Characters' field value to '1' or higher. Click 'Save'"
  reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000194,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-70541r1_rule,STIG-ID|WBLC-05-000164,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-56287"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Minimum Number of Numeric Characters: ([1-9]|[1-9][0-9])"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'password-validator' | Foreach-Object { 'Minimum Number of Numeric Characters: ' + $_.'min-numeric-or-special-characters' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000165 - Oracle WebLogic must enforce password complexity by the number of special characters used."
  info            : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Use of a complex password helps to increase the time and resources required to compromise the password.

Application servers either provide a local user store, or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must enforce the organization's password complexity requirements that include the requirement to use a specific number of special characters."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Password Validation' subtab
5. Select 'SystemPasswordValidator'
6. Select 'Configuration' tab -> 'Provider Specific' subtab
7. Utilize 'Change Center' to create a new change session
8. Set 'Minimum Number of Non-Alphanumeric Characters' field value to '1' or higher. Click 'Save'"
  reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-001619,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-70543r1_rule,STIG-ID|WBLC-05-000165,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-56289"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Minimum Number of Non-Alphanumeric Characters: ([1-9]|[1-9][0-9])"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'password-validator' | Foreach-Object { 'Minimum Number of Non-Alphanumeric Characters: ' + $_.'min-non-alphanumeric-characters' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000168 - Oracle WebLogic must encrypt passwords during transmission."
  info            : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.

Application servers have the capability to utilize either certificates (tokens) or user IDs and passwords in order to authenticate. When the application server transmits or receives passwords, the passwords must be encrypted."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Authentication' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., LDAPAuthenticator) in the 'Type' dropdown. Click 'OK'
7. From the list, select the newly created authentication provider and select the 'Configuration' tab -> 'Provider Specific' tab
8. Set all provider-specific values to configure the new authentication provider. Click 'Save'
9. Continuing from step 4, if the new authentication provider is perimeter-based, click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., SAML2IdentityAsserter) in the 'Type' dropdown. Click 'OK'
10. From the list, select the newly created authentication identity asserter and select the 'Configuration' tab -> 'Provider Specific' tab
11. Set all provider-specific values to configure the new authentication identity asserter. Click 'Save'"
  reference       : "800-171|3.5.1,800-53|IA-2,CAT|I,CCI|CCI-000197,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-70545r1_rule,STIG-ID|WBLC-05-000168,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-56291"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Authentication Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'authentication-provider' | Foreach-Object { if ($_.type -notlike 'wls:default*') {'Authentication Provider: ' + $_.name; $fail = 0; } Else { $fail = 1 }  }; if ($fail -eq '1') { 'Failed: No non-default authentication providers found' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000169 - Oracle WebLogic must utilize encryption when using LDAP for authentication."
  info            : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.

Application servers have the capability to utilize LDAP directories for authentication. If LDAP connections are not protected during transmission, sensitive authentication credentials can be stolen. When the application server utilizes LDAP, the LDAP traffic must be encrypted.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which is assigned 'LDAP' protocol
4. Utilize 'Change Center' to create a new change session
5. From 'Configuration' tab -> 'General' tab, deselect the 'Listen Port Enabled' checkbox
6. Select the 'SSL Listen Port Enabled checkbox
7. Enter a valid port value in the 'SSL Listen Port' field and click 'Save'
8. Review the 'Port Usage' table in EM again to ensure the 'Protocol' column does not contain the value 'LDAP'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|I,CCI|CCI-000197,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70547r1_rule,STIG-ID|WBLC-05-000169,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56293"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.server | Foreach-Object { if ($_.'network-access-point'.protocol -eq 'ldap'){ 'LDAP Server: ' + $_.name + ', Listen port: ' + $_.'listen-port-enabled' + ', SSL Listen port: ' + $_.ssl.enabled} Else { 'Warning: No LDAP based servers found for ' + $_.name } } "
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000172 - Oracle WebLogic, when utilizing PKI-based authentication, must validate certificates by constructing a certification path with status information to an accepted trust anchor - Unsecure Listen Port"
  info            : "A trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC.

When there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA.

Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted.

Status information for certification paths includes, certificate revocation lists or online certificate status protocol responses."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000185,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70549r2_rule,STIG-ID|WBLC-05-000172,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56295"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000172 - Oracle WebLogic, when utilizing PKI-based authentication, must validate certificates by constructing a certification path with status information to an accepted trust anchor - Secure Listen Port"
  info            : "A trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC.

When there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA.

Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted.

Status information for certification paths includes, certificate revocation lists or online certificate status protocol responses."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000185,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70549r2_rule,STIG-ID|WBLC-05-000172,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56295"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-05-000174 - Oracle WebLogic must map the PKI-based authentication identity to the user account."
  info            : "The cornerstone of the PKI is the private key used to encrypt or digitally sign information. The key by itself is a cryptographic value that does not contain specific user information.

Application servers must provide the capability to utilize and meet requirements of the DoD Enterprise PKI infrastructure for application authentication."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Providers' tab -> 'Authentication' tab
5. Utilize 'Change Center' to create a new change session
6. Click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., LDAPAuthenticator) in the 'Type' dropdown. Click 'OK'
7. From the list, select the newly created authentication provider and select the 'Configuration' tab -> 'Provider Specific' tab
8. Set all provider specific values to configure the new authentication provider. Click 'Save'
9. Continuing from step 4, if the new authentication provider is perimeter-based, click 'New'. Enter a value in 'Name' field and select a valid authentication provider type (e.g., SAML2IdentityAsserter) in the 'Type' dropdown. Click 'OK'
10. From the list, select the newly created authentication identity asserter and select the 'Configuration' tab -> 'Provider Specific' tab
11. Set all provider specific values to configure the new authentication identity asserter. Click 'Save'"
  reference       : "800-171|3.5.1,800-53|IA-2,CAT|II,CCI|CCI-000187,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-70551r1_rule,STIG-ID|WBLC-05-000174,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-56297"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Authentication Provider:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.'security-configuration'.realm.'authentication-provider' | Foreach-Object { if ($_.type -notlike 'wls:default*') {'Authentication Provider: ' + $_.name; $fail = 0; } Else { $fail = 1 }  }; if ($fail -eq '1') { 'Failed: No non-default authentication providers found' } "
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-05-000176 - Oracle WebLogic must use cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data - JAVA_OPTIONS"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware-based encryption modules.

Application servers must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70553r3_rule,STIG-ID|WBLC-05-000176,Vuln-ID|V-56299"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
  expect      : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-05-000176 - Oracle WebLogic must use cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data - PRE_CLASSPATH"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware-based encryption modules.

Application servers must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70553r3_rule,STIG-ID|WBLC-05-000176,Vuln-ID|V-56299"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
  expect      : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-05-000177 - Oracle WebLogic must utilize FIPS 140-2 approved encryption modules when authenticating users and processes - JAVA_OPTIONS"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware-based encryption modules.

Application servers must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70555r3_rule,STIG-ID|WBLC-05-000177,Vuln-ID|V-56301"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
  expect      : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-05-000177 - Oracle WebLogic must utilize FIPS 140-2 approved encryption modules when authenticating users and processes - PRE_CLASSPATH"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules, and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified hardware-based encryption modules.

Application servers must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70555r3_rule,STIG-ID|WBLC-05-000177,Vuln-ID|V-56301"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
  expect      : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-06-000190 - Oracle WebLogic must employ cryptographic encryption to protect the integrity and confidentiality of nonlocal maintenance and diagnostic communications - Listen Port"
  info            : "Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.

Application servers provide an HTTP-oriented remote management capability that is used for managing the application server as well as uploading and deleting applications that are hosted on the application server. Application servers need to ensure the communication channels used to remotely access the system utilize cryptographic mechanisms such as TLS."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000888,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70557r2_rule,STIG-ID|WBLC-06-000190,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56303"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-06-000190 - Oracle WebLogic must employ cryptographic encryption to protect the integrity and confidentiality of nonlocal maintenance and diagnostic communications - SSL Listen Port"
  info            : "Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.

Application servers provide an HTTP-oriented remote management capability that is used for managing the application server as well as uploading and deleting applications that are hosted on the application server. Application servers need to ensure the communication channels used to remotely access the system utilize cryptographic mechanisms such as TLS."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000888,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70557r2_rule,STIG-ID|WBLC-06-000190,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56303"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-06-000191 - Oracle WebLogic must employ strong identification and authentication techniques when establishing nonlocal maintenance and diagnostic sessions - Listen Port"
  info            : "Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.

Application servers will typically utilize an HTTP interface for providing both local and remote maintenance and diagnostic sessions. In these instances, an acceptable strong identification and authentication technique consists of utilizing two-factor authentication via secured HTTPS connections. If the application server also provides maintenance and diagnostic access via a fat client or other client-based connection, then that client must also utilize two-factor authentication and use FIPS-approved encryption modules for establishing transport connections."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000877,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70559r2_rule,STIG-ID|WBLC-06-000191,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56305"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-06-000191 - Oracle WebLogic must employ strong identification and authentication techniques when establishing nonlocal maintenance and diagnostic sessions - SSL Listen Port"
  info            : "Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.

Application servers will typically utilize an HTTP interface for providing both local and remote maintenance and diagnostic sessions. In these instances, an acceptable strong identification and authentication technique consists of utilizing two-factor authentication via secured HTTPS connections. If the application server also provides maintenance and diagnostic access via a fat client or other client-based connection, then that client must also utilize two-factor authentication and use FIPS-approved encryption modules for establishing transport connections."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-000877,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70559r2_rule,STIG-ID|WBLC-06-000191,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56305"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-08-000210 - Oracle WebLogic must terminate the network connection associated with a communications session at the end of the session or after a DoD-defined time period of inactivity."
  info        : "If communications sessions remain open for extended periods of time even when unused, there is the potential for an adversary to hijack the session and use it to gain access to the device or networks to which it is attached. Terminating sessions after a certain period of inactivity is a method for mitigating the risk of this vulnerability.

The application server must provide a mechanism for timing out or otherwise terminating inactive web sessions.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Deployments'
3. Sort 'Deployments' table by 'Type' by click the column header
4. Select an 'Enterprise Application' or 'Web Application' to check the session timeout setting
5. Select 'Configuration' tab -> 'Application' tab for deployments of 'Enterprise Application' type
Select 'Configuration' tab -> 'General' tab for deployments of 'Web Application' type
6. Utilize 'Change Center' to create a new change session
7. Set value in 'Session Timeout' field value to '900' (seconds). Click 'Save'
8. Repeat steps 4-7 for each 'Enterprise Application' and 'Web Application' deployment"
  reference   : "CAT|III,CCI|CCI-001133,Rule-ID|SV-70561r1_rule,STIG-ID|WBLC-08-000210,Vuln-ID|V-56307"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000211 - Oracle WebLogic must establish a trusted communications path between the user and organization-defined security functions within the information system - Listen Port"
  info            : "Without a trusted communication path, the application server is vulnerable to a man-in-the-middle attack.

Application server user interfaces are used for management of the application server so the communications path between client and server must be trusted or management of the server may be compromised."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <privae_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001135,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70563r2_rule,STIG-ID|WBLC-08-000211,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56309"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000211 - Oracle WebLogic must establish a trusted communications path between the user and organization-defined security functions within the information system - SSL Listen Port"
  info            : "Without a trusted communication path, the application server is vulnerable to a man-in-the-middle attack.

Application server user interfaces are used for management of the application server so the communications path between client and server must be trusted or management of the server may be compromised."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <privae_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001135,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70563r2_rule,STIG-ID|WBLC-08-000211,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56309"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-08-000214 - Oracle WebLogic must utilize NSA-approved cryptography when protecting classified compartmentalized data - JAVA_OPTIONS"
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. Encryption modules/algorithms are the mathematical procedures used for encrypting data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:

'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms. Used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need to know' and are required to be separated from the information in question. The application server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need to know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-001144,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70567r3_rule,STIG-ID|WBLC-08-000214,Vuln-ID|V-56313"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
  expect      : "^[\s]*set[\s]*JAVA_OPTIONS[\s]*=[\s]*.*-Djava\.security\.properties.*java\.security.*"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "WBLC-08-000214 - Oracle WebLogic must utilize NSA-approved cryptography when protecting classified compartmentalized data - PRE_CLASSPATH"
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. Encryption modules/algorithms are the mathematical procedures used for encrypting data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:

'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms. Used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need to know' and are required to be separated from the information in question. The application server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need to know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Shut down any running instances of WebLogic server
2. On disk, navigate to the DOMAIN_HOME directory
3. View the contents of the appropriate WebLogic server start script:
On UNIX operating systems: startWebLogic.sh
On Microsoft Windows operating systems: startWebLogic.cmd
4. Ensure the JAVA_OPTIONS variable is set:
On UNIX operating systems:
JAVA_OPTIONS=' -Djava.security.properties==/<mylocation>/java.security ${JAVA_OPTIONS}'
On Microsoft Windows operating systems:
set JAVA_OPTIONS= -Djava.security.properties==C:\<mylocation>\java.security %JAVA_OPTIONS%
5. Ensure the <mylocation> path specified above contains a valid java.security file (Refer to section 2.2.4 of the Overview document)
6. Ensure the PRE_CLASSPATH variable is set:
On UNIX operating systems:
PRE_CLASSPATH='%MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar ${PRE_CLASSPATH}'
On Microsoft Windows operating systems:
set PRE_CLASSPATH= %MW_HOME%\wlserver\server\lib\jcmFIPS.jar;%MW_HOME%\wlserver\server\lib\sslj.jar;%PRE_CLASSPATH%
7. Refer to section 2.2.4 of the Overview document"
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-001144,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-70567r3_rule,STIG-ID|WBLC-08-000214,Vuln-ID|V-56313"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type  : POLICY_TEXT
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "value_data".
  value_data  : "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\bin\startWebLogic.cmd"
  regex       : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
  expect      : "^[\s]*set[\s]*PRE_CLASSPATH[\s]*=[\s]*.*jcmFIPS\.jar.*sslj\.jar.*"
</custom_item>

<report type:"WARNING">
  description : "WBLC-08-000218 - Oracle WebLogic must protect the integrity and availability of publicly available information and applications."
  info        : "The purpose of this control is to ensure organizations explicitly address the protection needs for public information and applications, with such protection likely being implemented as part of other security controls.

Application servers must protect the integrity of publicly available information.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Deployments'
3. Select a deployed component which contains publicly available information and/or applications
4. Utilize 'Change Center' to create a new change session
5. Select 'Targets' tab
6. Select one or more clusters of managed servers as a target for this deployment. Click 'Save'."
  reference   : "CAT|II,CCI|CCI-001149,Rule-ID|SV-70569r1_rule,STIG-ID|WBLC-08-000218,Vuln-ID|V-56315"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-08-000222 - Oracle WebLogic must separate hosted application functionality from Oracle WebLogic management functionality."
  info        : "Application server management functionality includes functions necessary to administer the application server and requires privileged access via one of the accounts assigned to a management role.

The separation of application server administration functionality from hosted application functionality is either physical or logical and is accomplished by using different computers, different central processing units, different instances of the operating system, network addresses, network ports, or combinations of these methods, as appropriate.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. A single server in the list will be named 'Admin Server' and this is the server which hosts AS management functionality, such as the AdminConsole application
4. All remaining servers in the list are 'Managed Servers' and these are the individual or clustered servers which will host the actual applications
5. Utilize 'Change Center' to create a new change session
6. Undeploy all applications that are not used for AS management from the Admin server, and redeploy onto the Managed servers
7. This can be done from 'Deployments' tab -> 'Targets' tab; select each application which must be redeployed , deselect 'Admin Server' and select one or more of the Managed servers
8. Click 'Save' and restart servers if necessary"
  reference   : "CAT|II,CCI|CCI-001082,Rule-ID|SV-70571r1_rule,STIG-ID|WBLC-08-000222,Vuln-ID|V-56317"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000223 - Oracle WebLogic must ensure authentication of both client and server during the entire session."
  info            : "This control focuses on communications protection at the session, versus packet level.

At the application layer, session IDs are tokens generated by web applications to uniquely identify an application user's session. Web applications utilize session tokens or session IDs in order to establish application user identity. Proper use of session IDs addresses man-in-the-middle attacks, including session hijacking or insertion of false information into a session.

Application servers must provide the capability to perform mutual authentication. Mutual authentication is when both the client and the server authenticate each other."
  solution        : "1. Obtain the certificate(s) for the trusted certificate authority that signed the certificates for the client(s)
2. Access EM
3. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Keystore'
4. Locate the desired keystore in which to load the client certificate(s), select and click 'Manage' button
5. From 'Manage Certificates' page, click 'Import'
6. Complete 'Certificate Type', 'Alias' and 'Certificate Source' fields and click 'OK'. Ensure the imported certificate(s) appears in the list.
7. Access AC
8. Utilize 'Change Center' to create a new change session
9. From 'Domain Structure', select 'Environment' -> 'Servers'
10. From the list of servers, select one which needs Mutual Authentication set up
11. From 'Configuration' tab -> 'SSL' tab, click 'Advanced' link
12. Set 'Two Way Client Cert Behavior' field value is set to 'Client Certs Requested And Enforced'
13. Repeat steps 7-12 for all servers requiring SSL configuration
14. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
15. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-53|IA-3(1),CAT|II,CCI|CCI-001184,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-70575r1_rule,STIG-ID|WBLC-08-000223,Vuln-ID|V-56321"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain.server | Foreach-Object { if (($_.ssl.'client-certificate-enforced' -eq 'true') -and ($_.ssl.'two-way-ssl-enabled' -eq 'true')){ 'Server with Two Way Client Cert enabled: ' + $_.name} Else { 'Server with Two Way Client Cert disabled or not set: ' + $_.name } } "
</custom_item>

<report type:"WARNING">
  description : "WBLC-08-000224 - Oracle WebLogic must terminate user sessions upon user logout or any other organization- or policy-defined session termination events such as idle time limit exceeded."
  info        : "If communications sessions remain open for extended periods of time even when unused, there is the potential for an adversary to hijack the session and use it to gain access to the device or networks to which it is attached. Terminating sessions after a logout event or after a certain period of inactivity is a method for mitigating the risk of this vulnerability. When a user management session becomes idle, or when a user logs out of the management interface, the application server must terminate the session.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Deployments'
3. Sort 'Deployments' table by 'Type' by click the column header
4. Select an 'Enterprise Application' or 'Web Application' to check the session timeout setting
5. Select 'Configuration' tab -> 'Application' tab for deployments of 'Enterprise Application' type
Select 'Configuration' tab -> 'General' tab for deployments of 'Web Application' type
6. Utilize 'Change Center' to create a new change session
7. Set value in 'Session Timeout' field value to organization- or policy-defined session idle time limit. Click 'Save'
8. Repeat steps 4-7 for each 'Enterprise Application' and 'Web Application' deployment"
  reference   : "CAT|II,CCI|CCI-001185,Rule-ID|SV-70577r1_rule,STIG-ID|WBLC-08-000224,Vuln-ID|V-56323"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000229 - Oracle WebLogic must be configured to perform complete application deployments."
  info            : "Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system.

When an application is deployed to the application server, if the deployment process does not complete properly and without errors, there is the potential that some application files may not be deployed or may be corrupted and an application error may occur during runtime.

The application server must be able to perform complete application deployments. A partial deployment can leave the server in an inconsistent state. Application servers may provide a transaction rollback function to address this issue."
  solution        : "1. Access AC
2. From 'Domain Structure', select the top-level domain
3. Select 'Configuration' tab -> 'General' tab
4. Check 'Production Mode' checkbox. Click 'Save'
5. Restart all servers"
  reference       : "800-171|3.4.7,800-53|CM-7(2),CAT|II,CCI|CCI-001190,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),Rule-ID|SV-70581r1_rule,STIG-ID|WBLC-08-000229,SWIFT-CSCv1|2.3,Vuln-ID|V-56327"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain | Foreach-Object { if ($_.'production-mode-enabled' -eq 'true') { 'Passed - Production Mode is enabled on domain: ' + $_.name } Else { 'Failed - Production Mode is not enabled on domain: ' + $_.name } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000231 - Oracle WebLogic must protect the confidentiality of applications and leverage transmission protection mechanisms, such as TLS and SSL VPN, when deploying applications - AdminServer Listen Port"
  info            : "Preventing the disclosure of transmitted information requires that applications take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPSEC tunnel.

If the application server does not protect the application files that are created before and during the application deployment process, there is a risk that the application could be compromised prior to deployment."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001132,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70583r2_rule,STIG-ID|WBLC-08-000231,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56329"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Disabled on AdminServer"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on ' + $_.name } Else { 'Listen Port Enabled on ' + $_.name } }"
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000231 - Oracle WebLogic must protect the confidentiality of applications and leverage transmission protection mechanisms, such as TLS and SSL VPN, when deploying applications - AdminServer SSL Listen Port"
  info            : "Preventing the disclosure of transmitted information requires that applications take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPSEC tunnel.

If the application server does not protect the application files that are created before and during the application deployment process, there is a risk that the application could be compromised prior to deployment."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001132,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70583r2_rule,STIG-ID|WBLC-08-000231,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56329"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen Port Enabled on AdminServer"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'true') { 'SSL Listen Port Enabled on ' + $_.name } Else { 'SSL Listen Port Disabled on ' + $_.name } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000235 - Oracle WebLogic must protect the integrity of applications during the processes of data aggregation, packaging, and transformation in preparation for deployment."
  info            : "Information can be subjected to unauthorized changes (e.g., malicious and/or unintentional modification) at information aggregation or protocol transformation points. It is therefore imperative the application take steps to validate and assure the integrity of data while at these stages of processing.

The application server must ensure the integrity of data that is pending transfer for deployment is maintained. If the application were to simply transmit aggregated, packaged, or transformed data without ensuring the data was not manipulated during these processes, then the integrity of the data and the application itself may be called into question."
  solution        : "1. Access AC
2. From 'Domain Structure', select the top-level domain
3. Select 'Configuration' tab -> 'General' tab
4. Check 'Production Mode' checkbox. Click 'Save'
5. Restart all servers"
  reference       : "800-171|3.4.7,800-53|CM-7(2),CAT|III,CCI|CCI-001209,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),Rule-ID|SV-70587r1_rule,STIG-ID|WBLC-08-000235,SWIFT-CSCv1|2.3,Vuln-ID|V-56333"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\config\config.xml)).domain | Foreach-Object { if ($_.'production-mode-enabled' -eq 'true') { 'Passed - Production Mode is enabled on domain: ' + $_.name } Else { 'Failed - Production Mode is not enabled on domain: ' + $_.name } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-08-000236 - Oracle WebLogic must protect against or limit the effects of HTTP types of Denial of Service (DoS) attacks."
  info        : "Employing increased capacity and bandwidth combined with service redundancy can reduce the susceptibility to some DoS attacks. When utilizing an application server in a high risk environment (such as a DMZ), the amount of access to the system from various sources usually increases, as does the system's risk of becoming more susceptible to DoS attacks.

The application server must be able to be configured to withstand or minimize the risk of DoS attacks. This can be partially achieved if the application server provides configuration options that limit the number of allowed concurrent HTTP connections.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Deployments'
3. Sort 'Deployments' table by 'Type' by click the column header
4. Select an 'Enterprise Application' or 'Web Application' to check the session timeout setting
5. Select 'Configuration' tab -> 'Application' tab for deployments of 'Enterprise Application' type
Select 'Configuration' tab -> 'General' tab for deployments of 'Web Application' type
6. Utilize 'Change Center' to create a new change session
7. Set value in 'Maximum in-memory Session' field value to an integer value at or lower than an acceptable maximum number of HTTP sessions. Click 'Save'
8. Repeat steps 4-7 for each 'Enterprise Application' and 'Web Application' deployment"
  reference   : "CAT|II,CCI|CCI-001092,Rule-ID|SV-70591r1_rule,STIG-ID|WBLC-08-000236,Vuln-ID|V-56337"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000237 - Oracle WebLogic must limit the use of resources by priority and not impede the host from servicing processes designated as a higher-priority."
  info            : "Priority protection helps the application server prevent a lower-priority application process from delaying or interfering with any higher-priority application processes. If the application server is not capable of managing application resource requests, the application server could become overwhelmed by a high volume of low-priority resource requests which can cause an availability issue.

This requirement only applies to Mission Assurance Category 1 systems and does not apply to information systems with a Mission Assurance Category of 2 or 3.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Work Managers'
3. Utilize 'Change Center' to create a new change session
4. Click 'New', select 'Work Manager' radio option, click 'Next'
5. Type a unique name, click 'Next', select server(s) which to apply this work manager to, click 'Finish'
6. Select newly created work manager from table to configure
7. Set thread and capacity constraints for this work manager, target the server(s) to apply these constraints to, click 'Save'
8. Deploy applications requiring prioritization to the server(s) selected as target of the work manager in order to apply the priority conditions specified by the work manager to deployed applications"
  reference       : "800-53|SC-6,CAT|II,CCI|CCI-001096,CN-L3|7.1.3.7(c),CN-L3|7.1.3.7(d),ITSG-33|SC-6,Rule-ID|SV-70595r1_rule,STIG-ID|WBLC-08-000237,Vuln-ID|V-56341"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.'self-tuning'.'work-manager' | Foreach-Object { 'Work Manager Name: ' + $_.name + ',  Target: ' + $_.target }"
  check_type      : CHECK_REGEX
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000238 - Oracle WebLogic must fail securely in the event of an operational failure - Listen Port"
  info            : "Fail secure is a condition achieved by the application server in order to ensure that in the event of an operational failure, the system does not enter into an unsecure state where intended security properties no longer hold.

An example of secure failure is when an application server is configured for secure LDAP (LDAPS) authentication. If the application server fails to make a successful LDAPS connection it does not try to use unencrypted LDAP instead.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which is assigned a protocol which does not end in 's' (secure)
4. Utilize 'Change Center' to create a new change session
5. From 'Configuration' tab -> 'General' tab, deselect the 'Listen Port Enabled' checkbox
6. Select the 'SSL Listen Port Enabled checkbox
7. Enter a valid port value in the 'SSL Listen Port' field and click 'Save'
8. Review the 'Port Usage' table in EM again to ensure all values in the 'Protocol' column end with 's' (secure)"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001126,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70597r1_rule,STIG-ID|WBLC-08-000238,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56343"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000238 - Oracle WebLogic must fail securely in the event of an operational failure - SSL Listen Port"
  info            : "Fail secure is a condition achieved by the application server in order to ensure that in the event of an operational failure, the system does not enter into an unsecure state where intended security properties no longer hold.

An example of secure failure is when an application server is configured for secure LDAP (LDAPS) authentication. If the application server fails to make a successful LDAPS connection it does not try to use unencrypted LDAP instead.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution        : "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers'
3. From the list of servers, select one which is assigned a protocol which does not end in 's' (secure)
4. Utilize 'Change Center' to create a new change session
5. From 'Configuration' tab -> 'General' tab, deselect the 'Listen Port Enabled' checkbox
6. Select the 'SSL Listen Port Enabled checkbox
7. Enter a valid port value in the 'SSL Listen Port' field and click 'Save'
8. Review the 'Port Usage' table in EM again to ensure all values in the 'Protocol' column end with 's' (secure)"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001126,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70597r1_rule,STIG-ID|WBLC-08-000238,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56343"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Manual Review Required"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'true') { 'SSL Listen Port enabled on server: ' + $_.name } Else { 'SSL Listen Port disabled on server: ' + $_.name } }"
  severity        : MEDIUM
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000239 - Oracle WebLogic must employ approved cryptographic mechanisms when transmitting sensitive data - Listen Port"
  info            : "Preventing the disclosure of transmitted information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPSEC tunnel.

If data in transit is unencrypted, it is vulnerable to disclosure. If approved cryptographic algorithms are not used, encryption strength cannot be assured.

The application server must utilize approved encryption when transmitting sensitive data."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001131,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70601r2_rule,STIG-ID|WBLC-08-000239,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56347"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Listen Port Enabled on domain:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.'listen-port-enabled' -eq 'false') { 'Listen Port Disabled on domain: ' + $_.name } Else { 'Listen Port Enabled on domain: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-08-000239 - Oracle WebLogic must employ approved cryptographic mechanisms when transmitting sensitive data - SSL Listen Port"
  info            : "Preventing the disclosure of transmitted information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPSEC tunnel.

If data in transit is unencrypted, it is vulnerable to disclosure. If approved cryptographic algorithms are not used, encryption strength cannot be assured.

The application server must utilize approved encryption when transmitting sensitive data."
  solution        : "1. Obtain an identity (private key and digital certificates) and trust (certificates of trusted certificate authorities) to configure on the server
2. Create Identity keystore and load private key and certificate using ImportPrivateKey java utility, example:
$ java utils.ImportPrivateKey -certfile <cert_file> -keyfile <private_key_file> [-keyfilepass <private_key_password>] -keystore <keystore> -storepass <storepass> [-storetype <storetype>] -alias <alias> [-keypass <keypass>]
3. Access AC
4. Utilize 'Change Center' to create a new change session
5. From 'Domain Structure', select 'Environment' -> 'Servers'
6. From the list of servers, select one which needs SSL set up
7. From 'Configuration' tab -> 'General' tab, deselect 'Listen Port Enabled' checkbox
8. Select 'SSL Listen Port Enabled' checkbox and enter a valid port number in 'SSL Listen Port' field, e.g., 7002
9. From 'Configuration' tab -> 'Keystores' tab, click 'Change' button in 'Keystores' section
10. From dropdown, select 'Custom Identity and Java Standard Trust' and click 'Save'
11. Enter the fully qualified path to Identity keystore, from step 2, in 'Custom Identity Keystore' field
12. Enter 'JKS' in the 'Custom Identity Keystore Type' field
13. Enter the Identity keystore password in 'Custom Identity Keystore Passphrase' and 'Confirm Custom Identity Keystore Passphrase' fields
14. Enter the Java Standard Trust keystore (cacerts) password in 'Java Standard Trust Keystore Passphrase' and 'Confirm Java Standard Trust Keystore Passphrase' fields
15. Leave all other fields blank and click 'Save'
16. From 'Configuration' tab -> 'SSL' tab, enter values from step 2 into corresponding fields, as follows:
- Enter <alias> into 'Private Key Alias'
- Enter <private_key_password> into 'Private Key Passphrase'
- Enter <private_key_password> into 'Confirm Private Key Passphrase'
17. Click 'Save', and from 'Change Center' click 'Activate Changes' to enable configuration changes
18. Repeat steps 4-17 for all servers requiring SSL configuration
19. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
20. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  reference       : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CCI|CCI-001131,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,Rule-ID|SV-70601r2_rule,STIG-ID|WBLC-08-000239,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-56347"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "SSL Listen false:.+"
# Note: Variable @WEBLOGIC_DOMAIN_HOME@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\Config\Config.xml)).domain.server | Foreach-Object {if ($_.ssl.enabled -eq 'false') { 'SSL Listen false: ' + $_.name } Else { 'SSL Listen true: ' + $_.name } }"
  check_type      : CHECK_NOT_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-09-000252 - Oracle WebLogic must identify potentially security-relevant error conditions."
  info        : "The structure and content of error messages need to be carefully considered by the organization and development team. The extent to which the application server is able to identify and handle error conditions is guided by organizational policy and operational requirements. Adequate logging levels and system performance capabilities need to be balanced with data protection requirements.

Application servers must have the capability to log at various levels which can provide log entries for potential security-related error events.

An example is the capability for the application server to assign a criticality level to a failed login attempt error message, a security-related error message being of a higher criticality.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Expand the domain from the navigation tree, and select the AdminServer
3. Use the dropdown to select 'WebLogic Server' -> 'Logs' -> 'Log Configuration'
4. Select the 'Log Levels' tab, and within the table, expand 'Root Logger' node
5. Log levels for system-related events can be set here
6. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Audit Policy'
7. Select 'Oracle Platform Security Services' from the 'Audit Component Name' dropdown
8. Log levels for security-related events can be set here"
  reference   : "CAT|III,CCI|CCI-001311,Rule-ID|SV-70605r1_rule,STIG-ID|WBLC-09-000252,Vuln-ID|V-56351"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-09-000253 - Oracle WebLogic must only generate error messages that provide information necessary for corrective actions without revealing sensitive or potentially harmful information in error logs and administrative messages."
  info        : "Any application providing too much information in error logs and in administrative messages to the screen risks compromising the data and security of the application and system. The structure and content of error messages needs to be carefully considered by the organization and development team.

The application server must not log sensitive information such as passwords, private keys, or other sensitive data. This requirement pertains to logs that are generated by the application server and application server processes, not the applications that may reside on the application server. Those errors are out of the scope of these requirements.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access EM
2. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Logs' -> 'View Log Messages'
3. Within the search criteria, click 'Add Fields' button
4. Notice the list of available fields do not contain sensitive data"
  reference   : "CAT|II,CCI|CCI-001312,Rule-ID|SV-70631r1_rule,STIG-ID|WBLC-09-000253,Vuln-ID|V-56377"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-09-000254 - Oracle WebLogic must restrict error messages so only authorized personnel may view them."
  info        : "If the application provides too much information in error logs and administrative messages to the screen, this could lead to compromise. The structure and content of error messages need to be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Application servers must protect the error messages that are created by the application server. All application server users' accounts are used for the management of the server and the applications residing on the application server. All accounts are assigned to a certain role with corresponding access rights. The application server must restrict access to error messages so only authorized personnel may view them. Error messages are usually written to logs contained on the file system. The application server will usually create new log files as needed and must take steps to ensure that the proper file permissions are utilized when the log files are created.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Access AC
2. From 'Domain Structure', select 'Security Realms'
3. Select realm to configure (default is 'myrealm')
4. Select 'Users and Groups' tab -> 'Users' tab
5. From 'Users' table, select a user that must not have access to view error messages
6. From users settings page, select 'Groups' tab
7. From the 'Chosen' table, use the shuttle buttons to remove all of the following roles - 'Admin', 'Deployer', 'Monitor', 'Operator'
8. Click 'Save'
9. Repeat steps 5-8 for all users that must not have access to view error messages"
  reference   : "CAT|II,CCI|CCI-001314,Rule-ID|SV-70633r1_rule,STIG-ID|WBLC-09-000254,Vuln-ID|V-56379"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-09-000257 - Oracle WebLogic must provide system notifications to a list of response personnel who are identified by name and/or role - Module HealthState"
  info            : "Incident response applications are, by their nature, designed to monitor, detect, and alarm on defined events occurring on the system or on the network. A large part of their functionality is the accurate and timely notification of events.

Application servers can act as a resource for incident responders by providing information and notifications needed for support personnel to respond to application server incidents. Notifications can be made more efficient by the utilization of groups containing the members who would be responding to a particular alarm or event."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|II,CCI|CCI-001265,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70635r1_rule,STIG-ID|WBLC-09-000257,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56381"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.watch.enabled -eq 'true') { 'Passed - Module-HealthState/ServerHealthWatch is Enabled' } Else { 'Failed - Module-HealthState/ServerHealthWatch is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<custom_item>
  type            : AUDIT_POWERSHELL
  description     : "WBLC-09-000257 - Oracle WebLogic must provide system notifications to a list of response personnel who are identified by name and/or role - SMTP Notification"
  info            : "Incident response applications are, by their nature, designed to monitor, detect, and alarm on defined events occurring on the system or on the network. A large part of their functionality is the accurate and timely notification of events.

Application servers can act as a resource for incident responders by providing information and notifications needed for support personnel to respond to application server incidents. Notifications can be made more efficient by the utilization of groups containing the members who would be responding to a particular alarm or event."
  solution        : "1. Access AC
2. Utilize 'Change Center' to create a new change session
3. From 'Domain Structure', select 'Diagnostics' -> 'Diagnostic Modules'
4. If 'Module-HealthState' does not exist, click 'New' button. Enter 'Module-HealthState' in 'Name' field and click 'OK' button
5. Select 'Module-HealthState' from 'Diagnostic System Modules' list
6. Select 'Configuration' tab -> 'Watches and Notifications' tab. Select the 'Watches' tab from the bottom of page
7. Click 'New' button. Set the following values in the fields as shown:
'Watch Name' = 'ServerHealthWatch'
'Watch Type' = 'Collected Metrics'
'Enable Watch' = selected
8. Click 'Next'
9. Click 'Add Expressions'
10. Set 'MBean Server location' dropdown value to 'ServerRuntime'. Click 'Next'
11. Set 'MBean Type' dropdown value to 'weblogic.management.runtime.ServerRuntimeMBean'. Click 'Next'
12. Set 'Instance' dropdown value to a WebLogic Server instance to be monitored. Click 'Next'
13. Select 'Enter an Attribute Expression' radio button, enter following value in 'Attribute Expression' field: HealthState.State
14. Set 'Operator' dropdown value to '>='. Set 'Value' field to '3'. Click 'Finish'
15. Repeat steps 9-14 for all WebLogic Server instances to be monitored. Click 'Finish'
16. Continuing from step 6 above, select the 'Notifications' tab from the bottom of page
17. Click 'New' button. Set 'Type' dropdown value to 'SMTP (E-Mail)'. Click 'Next'. Set the following values in the fields as shown:
'Notification Name' = 'ServerHealthNotification'
'Enable Notification' = selected
18. Click 'Next'
19. Select an existing 'Mail Session Name', or click 'Create a New Mail Session' button to create one (JNDI name and Java mail settings must be known)
20. In 'E-Mail Recipients' text area, add list of administrator email addresses, and customize 'E-Mail Subject' and 'E-Mail Body' fields as needed. Click 'Finish'
21. Return to the 'Watches' tab from the bottom of page. Select 'ServerHealthWatch'. Select 'Notifications' tab
22. Use shuttle list to set 'ServerHealthNotification' into the 'Chosen' table. Click 'Save'"
  reference       : "800-53|SI-4(5),CAT|II,CCI|CCI-001265,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-70635r1_rule,STIG-ID|WBLC-09-000257,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-56381"
  see_also        : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
  value_type      : POLICY_TEXT
  value_data      : "Passed.+"
# Note: Variable @WEBLOGIC_HEALTHSTATE_MOD_PATH@ replaced with "C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml" in field "powershell_args".
  powershell_args : "([xml](Get-Content C:\\App\\Oracle\\Middleware\\User_Projects\\Domains\\Base_domain\\config\\diagnostics\\Module-HealthState-1900.xml)).'wldf-resource' | Foreach-Object { if ($_.'watch-notification'.'smtp-notification'.enabled -eq 'true') { 'Passed - Module-HealthState/SMTP Notification is Enabled' } Else { 'Failed - Module-HealthState/SMTP Notification is Disabled' } }"
  check_type      : CHECK_REGEX
</custom_item>

<report type:"WARNING">
  description : "WBLC-10-000270 - Oracle WebLogic must be integrated with a tool to monitor audit subsystem failure notification information that is sent out (e.g., the recipients of the message and the nature of the failure)."
  info        : "It is critical that, when a system is at risk of failing to process audit logs, it detects and takes action to mitigate the failure. As part of the mitigation, the system must send a notification to designated individuals that auditing is failing, log the notification message and the individuals who received the notification. When the system is not capable of notification and notification logging, an external software package, such as Oracle Diagnostic Framework, must be used.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a tool, such as Oracle Diagnostics Framework, to monitor audit subsystem failure notification information."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-70637r1_rule,STIG-ID|WBLC-10-000270,Vuln-ID|V-56383"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-10-000271 - Oracle WebLogic must be managed through a centralized enterprise tool."
  info        : "The application server can host multiple applications which require different functions to operate successfully but many of the functions are capabilities that are needed for all the hosted applications and should be managed through a common interface. Examples of enterprise wide functions are automated rollback of changes, failover and patching.

These functions are often outside the domain of the application server and so the application server must be integrated with a tool, such as Oracle Enterprise Manager, which is specific built to handle these requirements.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a tool such as Oracle Enterprise Manager, to handle enterprise functionality such as automated failover, rollback and patching of Oracle WebLogic."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-70639r1_rule,STIG-ID|WBLC-10-000271,Vuln-ID|V-56385"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "WBLC-10-000272 - Oracle WebLogic must be integrated with a tool to implement multi-factor user authentication."
  info        : "Multifactor authentication is defined as: using two or more factors to achieve authentication.

Factors include:
(i) something a user knows (e.g., password/PIN);
(ii) something a user has (e.g., cryptographic identification device, token); or
(iii) something a user is (e.g., biometric). A CAC meets this definition.

Implementing a tool, such as Oracle Access Manager, will implement multi-factor authentication to the application server and tie the authenticated user to a user account (i.e. roles and privileges) assigned to the authenticated user.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install a tool, such as Oracle Access Manager, to handle multi-factor authentication of users."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-70641r1_rule,STIG-ID|WBLC-10-000272,Vuln-ID|V-56387"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_WebLogic_Server_12c_V1R6_STIG.zip"
</report>

</group_policy>
</check_type>
