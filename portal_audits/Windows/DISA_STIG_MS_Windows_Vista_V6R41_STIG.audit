#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.14 $
# $Date: 2020/05/06 $
#
# description : This file was created using the Windows Vista Security Technical Implementation Guide,
#       included with DISA STIGs Windows Vista Security checklists Version 6, Release 41 published on 28 October 2016.
#
#       The files can be downloaded from the following links :
#
#       http://iase.disa.mil/stigs/checklist/
#       http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip
#
# NOTE:     Some queries in this .audit require site-specific data to be known to the query in order to function properly.
#         Please note the following queries and edit their values accordingly.
#
#<ui_metadata>
#<display_name>DISA Windows Vista STIG v6r41</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Windows Vista</name>
#  <version>6.41.0</version>
#  <link>http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip</link>
#</spec>
#<labels>windows,disa,microsoft,win_vista</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID,8500.2</benchmark_refs>
#<variables>
#  <variable>
#    <name>CORP_SERVER</name>
#    <default>corp\.server\.com</default>
#    <description>error reporting server name or IP address</description>
#    <info>This is defined as a single blank character to store the data on the system or the name or IP address of the local collection server.</info>
#  </variable>
#  <variable>
#    <name>APP_USERS</name>
#    <default>app_users</default>
#    <description>Application Accounts</description>
#    <info>Application accounts are exempt from this check.</info>
#  </variable>
#  <variable>
#    <name>LOCAL_ADMIN</name>
#    <default>admin</default>
#    <description>Local administrator, not built-in</description>
#    <info>This is any administrator that is not the built-in administrator.</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>time\.windows\.com</default>
#    <description>NTP Server</description>
#    <info>This is the IP address or hostname of your organization's trusted time server</info>
#  </variable>
#  <variable>
#    <name>LEGAL_CAPTION_TEXT</name>
#    <default>DoD Notice and Consent Banner</default>
#    <description>Logon Window Caption</description>
#    <info>This is the window caption text for the login warning a user receives when logging onto the system.</info>
#  </variable>
#  <variable>
#    <name>LEGAL_NOTICE_TEXT</name>
#    <default>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</default>
#    <description>Logon Window Text</description>
#    <info>This is the window text for the login warning a user receives when logging onto the system.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"DISA Microsoft Windows Vista STIG v6r41">

<file_acl:"CDirectory">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This folder, subfolders and files"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"System">
    acl_inheritance : "not inherited"
    acl_apply       : "This folder, subfolders and files"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder only"
    acl_allow       : "create folders / append data" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "files only"
    acl_allow       : "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders only"
    acl_allow       : "create files / write data" | "create folders / append data" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file"
  </user>

  <user:"CREATOR OWNER">
    acl_inheritance : "not inherited"
    acl_apply       : "Subfolders and files only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"CDir">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"system">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder only"
    acl_allow       : "create folders / append data"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "create files / write data" | "create folders / append data" | "delete" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"ProgramFilesOrWindows">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder only"
    acl_allow       : "create files / write data" | "create folders / append data" | "delete" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"system">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"system">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder only"
    acl_allow       : "create files / write data" | "create folders / append data" | "delete" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder, subfolders and files"
    acl_allow       : "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "traverse folder / execute file"
  </user>

  <user:"trustedinstaller">
    acl_inheritance : "not inherited"
    acl_apply       : "this folder and subfolders"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"creator owner">
    acl_inheritance : "not inherited"
    acl_apply       : "subfolders and files only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<registry_acl:"DCOM">
  <user:"Administrators">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"system">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"Creator Owner">
    acl_inheritance : "inherited"
    acl_apply       : "subkeys only"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"Users">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'enumerate subkeys' | 'notify' | 'query value' | 'read control'
  </user>
</registry_acl>

<registry_acl:"Winlogon">
  <user:"Administrators">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"system">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"creator owner">
    acl_inheritance : "inherited"
    acl_apply       : "subkeys only"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"Users">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'enumerate subkeys' | 'notify' | 'query value' | 'read control'
  </user>
</registry_acl>

<registry_acl:"InstalledComponents">
  <user:"Administrators">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"system">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"creator owner">
    acl_inheritance : "inherited"
    acl_apply       : "subkeys only"
    acl_allow       : 'create link' | 'create subkey' | 'delete' | 'enumerate subkeys' | 'full control' | 'notify' | 'query value' | 'read control' | 'set value' | 'write dac' | 'write owner'
  </user>

  <user:"Users">
    acl_inheritance : "inherited"
    acl_apply       : "This key and subkeys"
    acl_allow       : 'enumerate subkeys' | 'notify' | 'query value' | 'read control'
  </user>
</registry_acl>

<if>
  <condition type:"AND">
    <custom_item>
      type        : REGISTRY_SETTING
      description : "Windows Vista is installed"
      value_type  : POLICY_TEXT
      value_data  : "^[a-zA-Z0-9\(\)\s]*[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\s+[Vv][Ii][Ss][Tt][Aa]\s+[a-zA-Z0-9\(\)\s]*$"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
      reg_item    : "ProductName"
      check_type  : CHECK_REGEX
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_MS_Windows_Vista_V6R41_STIG.audit"
    </report>

    <report type:"WARNING">
      description : "1.001 - Physical security of the Automated Information System (AIS) does not meet DISA requirements."
      info        : "Inadequate physical protection can undermine all other security precautions utilized to protect the system. This can jeopardize the confidentiality, availability, and integrity of the system.  Physical security of the AIS is the first line protection of any system.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Relocate equipment to a controlled access area."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29618r1_rule,STIG-ID|1.001,Vuln-ID|V-1070"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "1.008 - Shared user accounts are permitted on the system."
      info                 : "Shared accounts do not provide individual accountability for system access and resource usage."
      solution             : "Remove any shared accounts that do not meet the exception requirements listed."
      reference            : "800-171|3.1.1,800-53|AC-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|M4.4.3,NESA|T5.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14d,NIAv2|SS14e,Rule-ID|SV-29622r1_rule,STIG-ID|1.008,Vuln-ID|V-1072"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-WmiObject -Class Win32_UserAccount | Select-Object PSComputerName,Status,Caption,PasswordExpires,AccountType,Disabled,Domain,LocalAccount,Lockout,Name,PasswordChangeable,PasswordRequired,SID | Format-List"
      only_show_cmd_output : YES
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "2.005 - Systems must be at supported service packs (SP) or releases levels."
      info        : "Systems at unsupported service packs or releases will not receive security updates for new vulnerabilities and leaves them subject to exploitation.   Systems must be maintained at a service pack level supported by the vendor with new security updates."
      solution    : "Update the system to a supported service pack.

Application of new service packs should be thoroughly tested before deploying in a production environment."
      reference   : "800-171|3.14.1,800-53|SI-2,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-29341r1_rule,STIG-ID|2.005,SWIFT-CSCv1|2.2,Vuln-ID|V-1073"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "^Service Pack 2"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion"
      reg_item    : "CSDVersion"
      check_type  : CHECK_REGEX
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "5.007 - An approved, up-to-date, DoD antivirus program must be installed and used."
      info                 : "Antivirus programs are a primary line of defense against the introduction of viruses and malicious code that can destroy data and even render a computer inoperable.  Utilizing an antivirus program provides the ability to detect malicious code before extensive damage occurs.  Updated virus scan data files help to protect a system, since new malware are identified by the software vendors on a continual basis."
      solution             : "Install McAfee VirusScan Enterprise 8.8 or later on the system.  Update the signature file at least every 7 days."
      reference            : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|I,CCI|CCI-000366,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NIAv2|GS8a,Rule-ID|SV-29469r3_rule,STIG-ID|5.007,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-1074"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "displayName.+:[ ]McAfee"
      powershell_args      : "Get-Wmiobject -Namespace root/SecurityCenter2 -Class AntiVirusProduct | select displayName,instanceGuid,pathToSignedProductExe,pathToSignedReportingExe,productState,PSComputerName"
      only_show_cmd_output : NO
      check_type           : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.007 - The system allows shutdown from the logon dialog box."
      info        : "Preventing display of the shutdown button in the logon dialog box may encourage a hard shut down with the power button.  (However, displaying the shutdown button may allow individuals to shut down a system anonymously.)"
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Shutdown- Allow system to be shutdown without having to log on' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-29590r1_rule,STIG-ID|3.007,Vuln-ID|V-1075"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "ShutdownWithoutLogon"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "1.013 - System information backups are not created, updated, and protected according to DISA requirements."
      info        : "Recovery of a damaged or compromised system in a timely basis is difficult without a system information backup.  A system backup will usually include sensitive information such as user accounts that could be used in an attack.  As a valuable system resource, the system backup should be protected and stored in a physically secure location.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Implement data backup procedures that comply with DoD requirements."
      reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-29626r1_rule,STIG-ID|1.013,Vuln-ID|V-1076"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "2.001 - Permissions for event logs must conform to minimum requirements - application.evtx"
      info            : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Event logs may be susceptible to tampering if proper permissions are not applied."
      solution        : "Maintain the permissions on the event logs.  Standard user accounts or groups must not have access.  The default permissions listed below satisfy this requirement.

Navigate to the log file location.  The default location is the '%SystemRoot%\System32\winevt\Logs' directory.
For each log file below, right click the file and select 'Properties'.
Select the 'Security' tab.
Select the 'Advanced' button, then 'Continue', and respond to any UAC prompts.

Log Files-
Application.evtx
Security.evtx
System.evtx

Permissions-
Eventlog - Full Control
SYSTEM - Full Control
Administrators - Full Control

If the organization has an 'Auditors' group from previous requirements, this group may be assigned Full Control.

If the location of the logs has been changed, when adding Eventlog to the permissions, it must be entered as 'NT Service\Eventlog'."
      reference       : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-15087r2_rule,STIG-ID|2.001,SWIFT-CSCv1|5.1,Vuln-ID|V-1077"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "STATUS: PASSED"
      powershell_args : "$file = $env:SystemRoot+'\System32\winevt\Logs\Application.evtx'; $perms = 'NT SERVICE\EventLog:*(F)', 'NT AUTHORITY\SYSTEM:*(F)', 'BUILTIN\Administrators:*(F)'; $required = $false; $status = 'PASSED'; $acls = icacls $file; $file+':'; foreach ($acl in $acls) { $acl = $acl.Replace($file, '').Trim(); if ((!$acl) -or ($acl -like 'Successfully processed*')) { continue } elseif ($perms -contains $acl) { '   '+$acl; $perms = $perms | Where-Object { $_ -ne $acl }; continue } else { $status = 'FAILED'; '   '+$acl+' ** incorrect **' } }; if (($perms.length) -and ($required)) { foreach ($acl in $perms) { $status = 'FAILED'; '   '+$acl+' ** missing **' } }; ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "2.001 - Permissions for event logs must conform to minimum requirements - security.evtx"
      info            : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Event logs may be susceptible to tampering if proper permissions are not applied."
      solution        : "Maintain the permissions on the event logs.  Standard user accounts or groups must not have access.  The default permissions listed below satisfy this requirement.

Navigate to the log file location.  The default location is the '%SystemRoot%\System32\winevt\Logs' directory.
For each log file below, right click the file and select 'Properties'.
Select the 'Security' tab.
Select the 'Advanced' button, then 'Continue', and respond to any UAC prompts.

Log Files-
Application.evtx
Security.evtx
System.evtx

Permissions-
Eventlog - Full Control
SYSTEM - Full Control
Administrators - Full Control

If the organization has an 'Auditors' group from previous requirements, this group may be assigned Full Control.

If the location of the logs has been changed, when adding Eventlog to the permissions, it must be entered as 'NT Service\Eventlog'."
      reference       : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-15087r2_rule,STIG-ID|2.001,SWIFT-CSCv1|5.1,Vuln-ID|V-1077"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "STATUS: PASSED"
      powershell_args : "$file = $env:SystemRoot+'\System32\winevt\Logs\Security.evtx'; $perms = 'NT SERVICE\EventLog:*(F)', 'NT AUTHORITY\SYSTEM:*(F)', 'BUILTIN\Administrators:*(F)'; $required = $false; $status = 'PASSED'; $acls = icacls $file; $file+':'; foreach ($acl in $acls) { $acl = $acl.Replace($file, '').Trim(); if ((!$acl) -or ($acl -like 'Successfully processed*')) { continue } elseif ($perms -contains $acl) { '   '+$acl; $perms = $perms | Where-Object { $_ -ne $acl }; continue } else { $status = 'FAILED'; '   '+$acl+' ** incorrect **' } }; if (($perms.length) -and ($required)) { foreach ($acl in $perms) { $status = 'FAILED'; '   '+$acl+' ** missing **' } }; ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "2.001 - Permissions for event logs must conform to minimum requirements - system.evtx"
      info            : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Event logs may be susceptible to tampering if proper permissions are not applied."
      solution        : "Maintain the permissions on the event logs.  Standard user accounts or groups must not have access.  The default permissions listed below satisfy this requirement.

Navigate to the log file location.  The default location is the '%SystemRoot%\System32\winevt\Logs' directory.
For each log file below, right click the file and select 'Properties'.
Select the 'Security' tab.
Select the 'Advanced' button, then 'Continue', and respond to any UAC prompts.

Log Files-
Application.evtx
Security.evtx
System.evtx

Permissions-
Eventlog - Full Control
SYSTEM - Full Control
Administrators - Full Control

If the organization has an 'Auditors' group from previous requirements, this group may be assigned Full Control.

If the location of the logs has been changed, when adding Eventlog to the permissions, it must be entered as 'NT Service\Eventlog'."
      reference       : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CAT|II,CCI|CCI-000162,CCI|CCI-000163,CCI|CCI-000164,CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-15087r2_rule,STIG-ID|2.001,SWIFT-CSCv1|5.1,Vuln-ID|V-1077"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "STATUS: PASSED"
      powershell_args : "$file = $env:SystemRoot+'\System32\winevt\Logs\System.evtx'; $perms = 'NT SERVICE\EventLog:*(F)', 'NT AUTHORITY\SYSTEM:*(F)', 'BUILTIN\Administrators:*(F)'; $required = $false; $status = 'PASSED'; $acls = icacls $file; $file+':'; foreach ($acl in $acls) { $acl = $acl.Replace($file, '').Trim(); if ((!$acl) -or ($acl -like 'Successfully processed*')) { continue } elseif ($perms -contains $acl) { '   '+$acl; $perms = $perms | Where-Object { $_ -ne $acl }; continue } else { $status = 'FAILED'; '   '+$acl+' ** incorrect **' } }; if (($perms.length) -and ($required)) { foreach ($acl in $perms) { $status = 'FAILED'; '   '+$acl+' ** missing **' } }; ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type          : WMI_POLICY
      description   : "2.008 - Local volumes are not formatted using NTFS."
      info          : "This is a category 1 finding because the ability to set access permissions and audit critical directories and files is only available by using the NTFS file system.  The capability to assign access permissions to file objects is a DOD policy requirement.
The FAT file system only provides the capability to make files read-only and hidden.  The capability to change these attributes is not restricted to any users.  An unauthorized individual could boot the machine from a floppy disk and gain full and unrecorded access to file data."
      solution      : "Format all partitions/drives to use NTFS."
      reference     : "800-171|3.1.1,800-53|AC-3(4),CAT|I,CCI|CCI-000213,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),Rule-ID|SV-29477r1_rule,STIG-ID|2.008,Vuln-ID|V-1081"
      see_also      : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type    : POLICY_TEXT
      value_data    : ""
      wmi_namespace : "root/CIMV2"
      wmi_request   : "Select Name,FileSystem from Win32_LogicalDisk where (MediaType='12' and NOT FileSystem ='NTFS')"
      wmi_attribute : "Name"
      wmi_key       : "FileSystem"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.003 - System pagefile is cleared upon shutdown."
      info        : "This check verifies that Windows is not configured to wipe clean the system page file during a controlled system shutdown."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Shutdown- Clear virtual memory pagefile' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-28975r1_rule,STIG-ID|3.003,SWIFT-CSCv1|2.3,Vuln-ID|V-1084"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Control\Session Manager\Memory Management"
      reg_item    : "ClearPageFileAtShutdown"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.006 - Floppy media devices are not allocated upon user logon."
      info        : "This check verifies that Windows is configured to not limit access to floppy drives when a user is logged on locally per the FDCC."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Devices- Restrict floppy access to locally logged-on user only' to 'Disabled'."
      reference   : "800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|MP-2,CAT|III,CCI|CCI-000366,CSF|PR.PT-2,ITSG-33|MP-2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,Rule-ID|SV-28976r1_rule,STIG-ID|3.006,Vuln-ID|V-1085"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "AllocateFloppies"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : BANNER_CHECK
      description : "3.011 - The required legal notice must be configured to display before console logon."
      info        : "Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options ->'Interactive Logon- Message text for users attempting to log on' as outlined in the check."
      reference   : "800-171|3.1.9,800-53|AC-8,CAT|II,CCI|CCI-000048,CCI|CCI-000050,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,ITSG-33|AC-8,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-29633r3_rule,STIG-ID|3.011,TBA-FIISB|45.2.4,Vuln-ID|V-1089"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
# Note: Variable @LEGAL_NOTICE_TEXT@ replaced with "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." in field "value_data".
      value_data  : "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "LegalNoticeText"
    </custom_item>

    <custom_item>
      type        : BANNER_CHECK
      description : "3.014 - The Windows dialog box title for the legal banner must be configured."
      info        : "Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options 'Interactive Logon- Message title for users attempting to log on' to 'DoD Notice and Consent Banner', 'US Department of Defense Warning Statement', or a site defined equivalent.

If a site defined title is used, it can in no case contravene or modify the language of the banner text required in V-1089."
      reference   : "800-171|3.1.9,800-53|AC-8,CAT|III,CCI|CCI-000048,ITSG-33|AC-8,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-34590r2_rule,STIG-ID|3.014,TBA-FIISB|45.2.4,Vuln-ID|V-26359"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
# Note: Variable @LEGAL_CAPTION_TEXT@ replaced with "DoD Notice and Consent Banner" in field "value_data".
      value_data  : "DoD Notice and Consent Banner"
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "LegalNoticeCaption"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "System is a member of a domain"
          value_type  : POLICY_TEXT
          value_data  : ""
          reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
          reg_item    : "Domain"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000017 - The Deny access to this computer from the network user right on workstations must be configured - guests"
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny access to this computer from the network' right defines the accounts that are prevented from logging on from the network.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

Local administrator accounts on domain-joined systems must also be assigned this right to decrease the risk of lateral movement resulting from credential theft attacks.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny access to this computer from the network' to include the following.

Domain Systems Only-
Enterprise Admins group
Domain Admins group
*All Local Administrator Accounts using the 'DenyNetworkAccess' or 'DeniedNetworkAccess' group (see V-45589).  Do not use the built-in Administrators group.  This group must contain the appropriate accounts/groups responsible for administering the system.

All Systems-
Guests group

*Documentation and scripts supporting the use of this group to restrict local administrative accounts were changed at one point.  The original name, 'DeniedNetworkAccess', was changed to 'DenyNetworkAccess'.  Automated benchmarks will look for either of these groups.  Use of other methods will require manual validation."
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-29598r4_rule,STIG-ID|WINUR-000017,Vuln-ID|V-1155"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Guests"
          right_type  : SeDenyNetworkLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000018 - The Deny log on as a batch job user right must be configured to prevent access from highly privileged accounts."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on as a batch job' right defines accounts that are prevented from logging on to the system as a batch job, such as Task Scheduler.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

The Guests group must be assigned to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on as a batch job' to include the following.

Domain Systems Only-
Enterprise Admins Group
Domain Admins Group

All Systems-
Guests Group"
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47110r1_rule,STIG-ID|WINUR-000018,Vuln-ID|V-26483"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Guests"
          right_type  : SeDenyBatchLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000020 - The Deny log on locally user right must be configured to prevent access from highly privileged accounts."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on locally' right defines accounts that are prevented from logging on interactively.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on locally' to include the following.

Domain Systems Only-
Enterprise Admins Group
Domain Admins Group

All Systems-
Guests Group"
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47103r3_rule,STIG-ID|WINUR-000020,Vuln-ID|V-26485"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Guests"
          right_type  : SeDenyInteractiveLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000021 - The Deny log on through Remote Desktop Services user right on workstations must prevent all access."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on through Remote Desktop Services' right defines the accounts that are prevented from logging on using Remote Desktop Services.

If Remote Desktop Services is not used by the organization, the Everyone group must be assigned this right to prevent all access.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

Local accounts on domain-joined systems must also be assigned this right to decrease the risk of lateral movement resulting from credential theft attacks.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on through Remote Desktop Services' to include the following.

If Remote Desktop Services is not used by the organization, assign the Everyone group this right to prevent all access.

If RDS is used by the organization, assign the following groups.

Domain Systems Only:
Enterprise Admins group
Domain Admins group
Local account (see Note below)

All Systems:
Guests group

Systems dedicated to the management of Active Directory (AD admin platforms, see V-36436 in the Active Directory Domain STIG) are exempt from denying the Enterprise Admins and Domain Admins groups.

Note: Microsoft Security Advisory Patch 2871997 adds new built-in security groups, including 'Local account', to Windows 7 for assigning permissions and rights to all local accounts."
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47136r3_rule,STIG-ID|WINUR-000021,Vuln-ID|V-26486"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Everyone" || "Guests"
          right_type  : SeDenyRemoteInteractiveLogonRight
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.223 - The classic logon screen must be required for user logons."
          info        : "The classic logon screen requires users to enter a logon name and password to access a system.  The simple logon screen or Welcome screen displays usernames for selection, providing part of the necessary logon information."
          solution    : "If the system is a member of a domain, this is NA.
Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Logon -> 'Always use classic logon' to 'Enabled'."
          reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|16.5,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29448r2_rule,STIG-ID|5.223,SWIFT-CSCv1|2.3,Vuln-ID|V-15680"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
          reg_item    : "LogonType"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000017 - The Deny access to this computer from the network user right on workstations must be configured - Domain"
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny access to this computer from the network' right defines the accounts that are prevented from logging on from the network.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

Local administrator accounts on domain-joined systems must also be assigned this right to decrease the risk of lateral movement resulting from credential theft attacks.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny access to this computer from the network' to include the following.

Domain Systems Only-
Enterprise Admins group
Domain Admins group
*All Local Administrator Accounts using the 'DenyNetworkAccess' or 'DeniedNetworkAccess' group (see V-45589).  Do not use the built-in Administrators group.  This group must contain the appropriate accounts/groups responsible for administering the system.

All Systems-
Guests group

*Documentation and scripts supporting the use of this group to restrict local administrative accounts were changed at one point.  The original name, 'DeniedNetworkAccess', was changed to 'DenyNetworkAccess'.  Automated benchmarks will look for either of these groups.  Use of other methods will require manual validation."
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-29598r4_rule,STIG-ID|WINUR-000017,Vuln-ID|V-1155"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
# Note: Variable @LOCAL_ADMIN@ replaced with "admin" in field "value_data".
          value_data  : "admin" && "Domain Admins" && "Enterprise Admins" && "Local account"
          right_type  : SeDenyNetworkLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000018 - The Deny log on as a batch job user right must be configured to prevent access."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on as a batch job' right defines accounts that are prevented from logging on to the system as a batch job, such as Task Scheduler.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

The Guests group must be assigned to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on as a batch job' to include the following.

Domain Systems Only-
Enterprise Admins Group
Domain Admins Group

All Systems-
Guests Group"
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47110r1_rule,STIG-ID|WINUR-000018,Vuln-ID|V-26483"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Domain Admins" && "Enterprise Admins"
          right_type  : SeDenyBatchLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000019 - The Deny log on as a service user right must be configured to prevent access from highly privileged accounts."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on as a service' right defines accounts that are denied log on as a service.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

Incorrect configurations could prevent services from starting and result in a DoS."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on as a service' to include the following for domain joined systems.

Enterprise Admins Group
Domain Admins Group

Configure the 'Deny log on as a service' for non-domain systems to include no entries (blank)."
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47119r1_rule,STIG-ID|WINUR-000019,Vuln-ID|V-26484"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Domain Admins" && "Enterprise Admins"
          right_type  : SeDenyServiceLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000020 - The Deny log on locally user rightmust be configured to prevent access from highly privileged accounts. - Domain"
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on locally' right defines accounts that are prevented from logging on interactively.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on locally' to include the following.

Domain Systems Only-
Enterprise Admins Group
Domain Admins Group

All Systems-
Guests Group"
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47103r3_rule,STIG-ID|WINUR-000020,Vuln-ID|V-26485"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Domain Admins" && "Enterprise Admins"
          right_type  : SeDenyInteractiveLogonRight
        </custom_item>

        <custom_item>
          type        : USER_RIGHTS_POLICY
          description : "WINUR-000021 - The Deny log on through Remote Desktop Services user right on workstations must prevent all access."
          info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities.

The 'Deny log on through Remote Desktop Services' right defines the accounts that are prevented from logging on using Remote Desktop Services.

If Remote Desktop Services is not used by the organization, the Everyone group must be assigned this right to prevent all access.

In an Active Directory Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower trust systems helps mitigate the risk of privilege escalation from credential theft attacks which could lead to the compromise of an entire domain.

Local administrator accounts on domain-joined systems must also be assigned this right to decrease the risk of lateral movement resulting from credential theft attacks.

The Guests group must be assigned this right to prevent unauthenticated access."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> User Rights Assignment -> 'Deny log on through Remote Desktop Services' to include the following.

If Remote Desktop Services is not used by the organization, assign the Everyone group this right to prevent all access.

If RDS is used by the organization, assign the following groups.

Domain Systems Only:
Enterprise Admins group
Domain Admins group
Local account (see Note below)

All Systems:
Guests group

Systems dedicated to the management of Active Directory (AD admin platforms, see V-36436 in the Active Directory Domain STIG) are exempt from denying the Enterprise Admins and Domain Admins groups.

Note: Microsoft Security Advisory Patch 2871997 adds new built-in security groups, including 'Local account', to Windows 7 for assigning permissions and rights to all local accounts."
          reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000213,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-47136r3_rule,STIG-ID|WINUR-000021,Vuln-ID|V-26486"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : USER_RIGHT
          value_data  : "Administrator" && "Domain Admins" && "Enterprise Admins" && "Local account"
          right_type  : SeDenyRemoteInteractiveLogonRight
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.013 - Caching of logon credentials must be limited."
          info        : "The default Windows configuration caches the last logon credentials for users who log on interactively to a system.  This feature is provided for system availability reasons, such as the user's machine being disconnected from the network or domain controllers being unavailable.  Even though the credential cache is well-protected, if a system is attacked, an unauthorized individual may isolate the password to a domain user account using a password-cracking program and gain access to the domain."
          solution    : "If the system is not a member of a domain, this is NA.
Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive Logon- Number of previous logons to cache (in case Domain Controller is not available)' to '2' logons or less."
          reference   : "800-53|IA-5(13),CAT|III,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-1,Rule-ID|SV-28978r3_rule,STIG-ID|3.013,Vuln-ID|V-1090"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_TEXT
          value_data  : "[0-2]"
          reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
          reg_item    : "CachedLogonsCount"
          check_type  : CHECK_REGEX
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.244 - Users must be notified if the logon server was inaccessible and cached credentials were used."
          info        : "Notifying a user whether cached credentials were used may make them aware of connection issues."
          solution    : "If the system is not a member of a domain, this is NA.
Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Logon Options -> 'Report when logon server was not available during user logon' to 'Enabled'."
          reference   : "800-53|AC-9(4),CAT|III,CCI|CCI-000366,Rule-ID|SV-16658r3_rule,STIG-ID|5.244,TBA-FIISB|45.2.4,Vuln-ID|V-15719"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
          reg_item    : "ReportControllerMissing"
        </custom_item>

        <custom_item>
          type                 : AUDIT_POWERSHELL
          description          : "WINGE-000200 - A group must be defined on domain systems to include all local administrator accounts."
          info                 : "Several user rights on domain systems require that local administrator accounts be assigned to them.  This is separate from the built-in Administrators group, which also contains domain administrative accounts/groups.  Defining a consistent group name allows compliance to be more easily determined."
          solution             : "This requirement is NA for non domain-joined systems.

Create a local group with the name 'DenyNetworkAccess' or 'DeniedNetworkAccess' on the system.
Include all local administrator accounts as members of the group, including the built-in Administrator account.  Do not include domain administrative accounts or groups."
          reference            : "800-53|AC-2(9),CAT|III,CCI|CCI-000366,CN-L3|8.1.4.2(c),CSF|PR.AC-1,CSF|PR.AC-4,NIAv2|AM16,Rule-ID|SV-58415r2_rule,STIG-ID|WINGE-000200,Vuln-ID|V-45589"
          see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type           : POLICY_TEXT
          value_data           : "DenyNetworkAccess|DeniedNetworkAccess"
          powershell_args      : "get-wmiobject -Class Win32_Group | Format-Table name"
          only_show_cmd_output : NO
          check_type           : CHECK_REGEX
        </custom_item>
      </else>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.018 - Anonymous shares are not restricted. - RestrictAnonymous"
      info        : "This is a Category 1 finding because it allows anonymous logon users (null session connections) to list all account names and enumerate all shared resources, thus providing a map of potential points to attack the system."
      solution    : "Configure the policy values for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Do not allow anonymous enumeration of SAM accounts' and 'Network access- Do not allow anonymous enumeration of SAM accounts and shares' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001090,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-28982r1_rule,STIG-ID|3.018,Vuln-ID|V-1093"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "RestrictAnonymous"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.018 - Anonymous shares are not restricted. - RestrictAnonymousSAM"
      info        : "This is a Category 1 finding because it allows anonymous logon users (null session connections) to list all account names and enumerate all shared resources, thus providing a map of potential points to attack the system."
      solution    : "Configure the policy values for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Do not allow anonymous enumeration of SAM accounts' and 'Network access- Do not allow anonymous enumeration of SAM accounts and shares' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001090,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-28982r1_rule,STIG-ID|3.018,Vuln-ID|V-1093"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "RestrictAnonymousSAM"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type           : LOCKOUT_POLICY
      description    : "4.002 - Number of allowed bad-logon attempts does not meet minimum requirements."
      info           : "The account lockout feature, when enabled, prevents brute-force password attacks on the system.  The higher this value is, the less effective the account lockout feature will be in protecting the local system.  The number of bad logon attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user logon."
      solution       : "Configure the system to lock out an account after three invalid logon attempts."
      reference      : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-28986r1_rule,STIG-ID|4.002,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-1097"
      see_also       : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type     : TIME_MINUTE
      value_data     : [1..3]
      lockout_policy : LOCKOUT_THRESHOLD
    </custom_item>

    <custom_item>
      type           : LOCKOUT_POLICY
      description    : "4.003 - Time before bad-logon counter is reset does not meet minimum requirements."
      info           : "This parameter specifies the amount of time that must pass between two successive login attempts to ensure that a lockout will occur.  The smaller this value is, the less effective the account lockout feature will be in protecting the local system."
      solution       : "Configure the system to have the lockout counter reset itself after a minimum of 60 minutes."
      reference      : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-29638r1_rule,STIG-ID|4.003,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-1098"
      see_also       : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type     : TIME_MINUTE
      value_data     : [60..MAX]
      lockout_policy : LOCKOUT_RESET
    </custom_item>

    <custom_item>
      type           : LOCKOUT_POLICY
      description    : "4.004 - Lockout duration does not meet minimum requirements."
      info           : "This parameter specifies the amount of time that must pass before a locked-out account is automatically unlocked by the system."
      solution       : "Configure the system so that the bad logon lockout duration conforms to DoD requirements."
      reference      : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-002238,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-29642r1_rule,STIG-ID|4.004,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-1099"
      see_also       : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type     : TIME_MINUTE
      value_data     : 0
      lockout_policy : LOCKOUT_DURATION
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.009 - Unauthorized users are granted right to Act as part of the operating system."
      info        : "This is a Category 1 finding because users and user groups that are assigned this right can bypass all security protective mechanisms that apply to all users, including administrators.  Accounts with this right should have passwords with the maximum length and be kept in a locked container accessible only by the IAO and his designated backup.

Some applications require this right to function.  Any exception needs to be documented with the IAO."
      solution    : "Configure the system to prevent unauthorized users to 'Act as part of the operating system'."
      reference   : "800-53|AC-6(7),CAT|I,CCI|CCI-002235,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-28990r1_rule,STIG-ID|4.009,Vuln-ID|V-1102"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeTcbPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Access this computer from the network"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|9,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeNetworkLogonRight
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Adjust memory quotas for a process"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service" && "Network Service"
      right_type  : SeIncreaseQuotaPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Allow log on locally"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Users"
      right_type  : SeInteractiveLogonRight
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Allow log on through Terminal Services"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeRemoteInteractiveLogonRight
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Backup files and directories"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeBackupPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Bypass traverse checking"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service" && "Network Service" && "Users"
      right_type  : SeChangeNotifyPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Change the system time"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service"
      right_type  : SeSystemTimePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Change the time zone"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service" && "Users"
      right_type  : SeTimeZonePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Create a pagefile"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeCreatePagefilePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Create a token object"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeCreateTokenPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Create global objects"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service" && "Network Service" && "Service"
      right_type  : SeCreateGlobalPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Create permanent shared objects"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeCreatePermanentPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Create symbolic links"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeCreateSymbolicLinkPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Enable computer and user accounts to be trusted for delegation"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeEnableDelegationPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Force shutdown from a remote system"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeRemoteShutdownPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Generate security audits"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Local Service" && "Network Service"
      right_type  : SeAuditPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Impersonate a client after authentication"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service" && "Network Service" && "Service"
      right_type  : SeImpersonatePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Increase a process working set"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Local Service"
      right_type  : SeIncreaseWorkingSetPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Increase scheduling priority"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeIncreaseBasePriorityPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Load and unload device drivers"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeLoadDriverPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Lock pages in memory"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeLockMemoryPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Log on as a batch job"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeBatchLogonRight
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Log on as a service"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeServiceLogonRight
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Manage auditing and security log"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeSecurityPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Modify an object label"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeReLabelPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Modify firmware environment values"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeSystemEnvironmentPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Perform volume maintenance tasks"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeManageVolumePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Profile single process"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeProfileSingleProcessPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Profile system performance"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeSystemProfilePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Remove computer from docking station"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Users"
      right_type  : SeUndockPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Replace a process level token"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Local Service" && "Network Service"
      right_type  : SeAssignPrimaryTokenPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Restore files and directories"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeRestorePrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Shut down the system"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators" && "Users"
      right_type  : SeShutdownPrivilege
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.010 - User rights assignments must meet minimum requirements. - Take ownership of files or other objects"
      info        : "Inappropriate granting of user rights can provide system, administrative, and other high level capabilities not required by the normal user."
      solution    : "Configure the policy values for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> as listed below-

Access this computer from the network - Administrators

Act as part of the operating system - See separate requirement V-1102

Adjust memory quotas for a process - Administrators, Local Service, Network Service

Allow log on locally - Administrators, Users

Allow log on through Terminal Services - (None)

Backup files and directories - Administrators

Bypass traverse checking - Administrators, Users, Local Service, Network Service

Change the system time - Administrators, Local Service

Change the time zone - Administrators, Users, Local Service

Create a pagefile - Administrators

Create a token object - (None)

Create global objects - Administrators, Service, Local Service, Network Service

Create permanent shared objects - (None)

Create symbolic links - Administrators

Debug programs - See separate requirement V-18010

Deny access to this computer from the network - See separate requirement V-1155

Deny log on as a batch job - See separate requirement V-26483

Deny log on as a service - See separate requirement V-26484

Deny log on locally - See separate requirement V-26485

Deny log on through Terminal Services - See separate requirement V-26486

Enable computer and user accounts to be trusted for delegation - (None)

Force shutdown from a remote system - Administrators

Generate security audits - Local Service, Network Service

Impersonate a client after authentication - Administrators, Service, Local Service, Network Service

Increase a process working set - Administrators, Local Service

Increase scheduling priority - Administrators

Load and unload device drivers - Administrators

Lock pages in memory - (None)

Log on as a batch job - (None)

Log on as a service - (None)

Manage auditing and security log - Administrators
If the organization has an 'Auditors' group from previous requirements, the assignment of this group to the user right would not be a finding.

Modify an object label - (None)

Modify firmware environment values - Administrators

Perform volume maintenance tasks - Administrators

Profile single process - Administrators

Profile system performance - Administrators

Remove computer from docking station - Administrators, Users

Replace a process level token - Local Service, Network Service

Restore files and directories - Administrators

Shut down the system - Administrators, Users

Take ownership of files or other objects - Administrators"
      reference   : "800-53|AC-6(7),CAT|II,CCI|CCI-000366,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-18392r3_rule,STIG-ID|4.010,Vuln-ID|V-1103"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : "Administrators"
      right_type  : SeTakeOwnershipPrivilege
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "4.011 - Maximum password age does not meet minimum requirements."
      info            : "The longer a password is in use, the greater the opportunity for someone to gain unauthorized knowledge of the passwords.   Further, scheduled changing of passwords hinders the ability of unauthorized system users to crack passwords and gain access to a system."
      solution        : "Configure the Maximum Password Age so that it is not '0' and doesn't exceed 60 days."
      reference       : "800-53|IA-5(1),CAT|II,CCI|CCI-000199,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-29646r1_rule,STIG-ID|4.011,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-1104"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : TIME_DAY
      value_data      : [MIN..60]
      password_policy : MAXIMUM_PASSWORD_AGE
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "4.012 - Minimum password age does not meet minimum requirements."
      info            : "Permitting passwords to be changed in immediate succession within the same day, allows users to cycle passwords through their history database.  This enables users to effectively negate the purpose of mandating periodic password changes."
      solution        : "Configure the Minimum Password Age so that it is a minimum of '1'."
      reference       : "800-53|IA-5(1),CAT|II,CCI|CCI-000198,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-28994r1_rule,STIG-ID|4.012,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-1105"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : TIME_DAY
      value_data      : [1..MAX]
      password_policy : MINIMUM_PASSWORD_AGE
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "4.014 - The password history must be configured to 24 passwords remembered."
      info            : "A system is more vulnerable to unauthorized access when system users recycle the same password several times without being required to change a password to a unique password on a regularly scheduled basis. This enables users to effectively negate the purpose of mandating periodic password changes. The default value is 24 for Windows domain systems.  DoD has decided this is the appropriate value for all Windows systems."
      solution        : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Account Policies >> Password Policy >> 'Enforce password history' to '24' passwords remembered."
      reference       : "800-171|3.5.8,800-53|IA-5(1),CAT|II,CCI|CCI-000200,CSCv6|16.5,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,Rule-ID|SV-29651r2_rule,STIG-ID|4.014,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-1107"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_DWORD
      value_data      : [24..MAX]
      password_policy : ENFORCE_PASSWORD_HISTORY
    </custom_item>

    <custom_item>
      type         : AUDIT_USER_TIMESTAMPS
      description  : "4.019 - Outdated or unused accounts must be removed from the system."
      info         : "Outdated or unused accounts provide penetration points that may go undetected.  Inactive accounts must be deleted if no longer necessary or, if still required, disable until needed.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution     : "Regularly review accounts to determine if they are still active.  Accounts that have not been used in the last 35 days must be removed or disabled."
      reference    : "800-53|AC-2(3),CAT|III,CCI|CCI-000795,CIP|004-6-R5,CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),NIAv2|AM26,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4,Rule-ID|SV-29481r2_rule,STIG-ID|4.019,TBA-FIISB|36.2.2,Vuln-ID|V-1112"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : POLICY_DAY
      value_data   : 35
# Note: Variable @APP_USERS@ replaced with "app_users" in field "ignore_users".
      ignore_users : "app_users"
      timestamp    : "LogonTime"
      check_type   : CHECK_GREATER_THAN_OR_EQUAL
      severity     : MEDIUM
    </custom_item>

    <custom_item>
      type         : CHECK_ACCOUNT
      description  : "4.020 - The built-in guest account is not disabled."
      info         : "A system faces an increased vulnerability threat if the built-in guest account is not disabled.  This account is a known account that exists on all Windows systems and cannot be deleted.  This account is initialized during the installation of the operating system with no password assigned.  This account is a member of the Everyone user group and has all the rights and permissions associated with that group, which could subsequently provide access to system resources to anonymous users."
      solution     : "Configure the system to disable the built-in guest Account."
      reference    : "800-171|3.1.1,800-53|AC-2,CAT|II,CCI|CCI-000804,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-29656r1_rule,STIG-ID|4.020,Vuln-ID|V-1113"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : POLICY_SET
      value_data   : "Disabled"
      account_type : GUEST_ACCOUNT
    </custom_item>

    <custom_item>
      type         : CHECK_ACCOUNT
      description  : "4.021 - The built-in guest account has not been renamed."
      info         : "A system faces an increased vulnerability threat if the built-in guest account is not renamed or disabled.  The built-in guest account is a known user account on all Windows systems, and as initially installed, does not require a password.  This can allow access to system resources by unauthorized users.  This account is a member of the group Everyone and has all the rights and permissions associated with that group and could provide access to system resources to unauthorized users."
      solution     : "Configure the system to rename the built-in guest account"
      reference    : "800-171|3.1.1,800-53|AC-2,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-29484r1_rule,STIG-ID|4.021,Vuln-ID|V-1114"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : POLICY_TEXT
      value_data   : "Guest"
      account_type : GUEST_ACCOUNT
      check_type   : CHECK_NOT_EQUAL
    </custom_item>

    <custom_item>
      type         : CHECK_ACCOUNT
      description  : "4.022 - The built-in administrator account has not been renamed."
      info         : "The built-in administrator account is a well known account.  Renaming the account to an unidentified name improves the protection of this account and the system."
      solution     : "Configure the system to rename the built-in administrator account."
      reference    : "800-171|3.1.1,800-53|AC-2,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-28997r1_rule,STIG-ID|4.022,Vuln-ID|V-1115"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : POLICY_TEXT
      value_data   : "Administrator"
      account_type : ADMINISTRATOR_ACCOUNT
      check_type   : CHECK_NOT_EQUAL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.002 - Event log sizes do not meet minimum requirements. - Application"
      info        : "Inadequate log size will cause the log to fill up quickly and require frequent clearing by administrative personnel."
      solution    : "Configure the following policy values as listed below-

Computer Configuration -> Administrative Templates -> Windows Components -> Event Log Service ->

Application -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
Security -> 'Maximum Log Size (KB)' will be set to 'Enabled-81920'
Setup -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
System -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'"
      reference   : "800-53|AU-4,CAT|II,CCI|CCI-001849,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-16946r1_rule,STIG-ID|5.002,Vuln-ID|V-1118"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [32768..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Eventlog\Application"
      reg_item    : "MaxSize"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.002 - Event log sizes do not meet minimum requirements. - Security"
      info        : "Inadequate log size will cause the log to fill up quickly and require frequent clearing by administrative personnel."
      solution    : "Configure the following policy values as listed below-

Computer Configuration -> Administrative Templates -> Windows Components -> Event Log Service ->

Application -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
Security -> 'Maximum Log Size (KB)' will be set to 'Enabled-81920'
Setup -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
System -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'"
      reference   : "800-53|AU-4,CAT|II,CCI|CCI-001849,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-16946r1_rule,STIG-ID|5.002,Vuln-ID|V-1118"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [81920..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Eventlog\Security"
      reg_item    : "MaxSize"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.002 - Event log sizes do not meet minimum requirements. - Setup"
      info        : "Inadequate log size will cause the log to fill up quickly and require frequent clearing by administrative personnel."
      solution    : "Configure the following policy values as listed below-

Computer Configuration -> Administrative Templates -> Windows Components -> Event Log Service ->

Application -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
Security -> 'Maximum Log Size (KB)' will be set to 'Enabled-81920'
Setup -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
System -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'"
      reference   : "800-53|AU-4,CAT|II,CCI|CCI-001849,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-16946r1_rule,STIG-ID|5.002,Vuln-ID|V-1118"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [32768..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Eventlog\Setup"
      reg_item    : "MaxSize"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.002 - Event log sizes do not meet minimum requirements. - System"
      info        : "Inadequate log size will cause the log to fill up quickly and require frequent clearing by administrative personnel."
      solution    : "Configure the following policy values as listed below-

Computer Configuration -> Administrative Templates -> Windows Components -> Event Log Service ->

Application -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
Security -> 'Maximum Log Size (KB)' will be set to 'Enabled-81920'
Setup -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'
System -> 'Maximum Log Size (KB)' will be set to 'Enabled-32768'"
      reference   : "800-53|AU-4,CAT|II,CCI|CCI-001849,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-16946r1_rule,STIG-ID|5.002,Vuln-ID|V-1118"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [32768..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Eventlog\System"
      reg_item    : "MaxSize"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "5.003 - Booting into alternate operating systems is permitted."
      info        : "Allowing other operating systems to run on a secure system, can allow users to circumvent security.  If more than one operating system is installed on a computer, each must be configured to be compliant with STIG guidance.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the system to prevent running non-compliant alternate operating systems."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-19250r1_rule,STIG-ID|5.003,Vuln-ID|V-1119"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "5.004 - Installed FTP server is configured to allow prohibited logins."
      info        : "The FTP (File Transfer Protocol) service allows remote users to access shared files and directories.  Allowing anonymous FTP makes user auditing difficult.

Using accounts that have administrator privileges to log on to FTP risks that the user id and password will be captured on the network, and give administrator access to an unauthorized user.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the system to prevent an installed FTP service from allowing prohibited logons."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29492r1_rule,STIG-ID|5.004,Vuln-ID|V-1120"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "5.005 - Installed FTP server is configured to allow access to the system drive."
      info        : "This is a Category 1 finding because the FTP service allows remote users to access shared files and directories which could provide access to system resources and compromise the system, especially if the user can gain access to the root directory of the boot drive."
      solution    : "Configure the system to prevent an FTP Service from allowing access to the system drive."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29496r1_rule,STIG-ID|5.005,SWIFT-CSCv1|2.3,Vuln-ID|V-1121"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : FILE_ACL
      value_data  : "CDirectory"
      file        : "%systemdrive%"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.006 - The system configuration is not set with a password-protected screen saver. - ScreenSaveActive"
      info                 : "The system should be locked when unattended.  Unattended systems are susceptible to unauthorized use.  The screen saver should be set at a maximum of 15 minutes and password protected.  This protects critical and sensitive data from exposure to unauthorized personnel with physical access to the computer."
      solution             : "Configure The policy values for User Configuration -> Administrative Templates -> Control Panel -> Display as follows-

'Screen Saver' will be set to 'Enabled' ('Activate screen saver' on Windows 2000)

'Password protect the screen saver' will be set to 'Enabled'

'Screen Saver timeout' will be set to 'Enabled- 900 seconds' (or less)"
      reference            : "800-171|3.1.10,800-53|AC-11,CAT|II,CCI|CCI-000056,CCI|CCI-000057,CCI|CCI-000060,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,Rule-ID|SV-29500r1_rule,STIG-ID|5.006,Vuln-ID|V-1122"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : 1
      reg_key              : "HKU\Software\Policies\Microsoft\Windows\Control Panel\Desktop"
      reg_item             : "ScreenSaveActive"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.006 - The system configuration is not set with a password-protected screen saver. - ScreenSaverIsSecure"
      info                 : "The system should be locked when unattended.  Unattended systems are susceptible to unauthorized use.  The screen saver should be set at a maximum of 15 minutes and password protected.  This protects critical and sensitive data from exposure to unauthorized personnel with physical access to the computer."
      solution             : "Configure The policy values for User Configuration -> Administrative Templates -> Control Panel -> Display as follows-

'Screen Saver' will be set to 'Enabled' ('Activate screen saver' on Windows 2000)

'Password protect the screen saver' will be set to 'Enabled'

'Screen Saver timeout' will be set to 'Enabled- 900 seconds' (or less)"
      reference            : "800-171|3.1.10,800-53|AC-11,CAT|II,CCI|CCI-000056,CCI|CCI-000057,CCI|CCI-000060,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,Rule-ID|SV-29500r1_rule,STIG-ID|5.006,Vuln-ID|V-1122"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : 1
      reg_key              : "HKU\Software\Policies\Microsoft\Windows\Control Panel\Desktop"
      reg_item             : "ScreenSaverIsSecure"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.006 - The system configuration is not set with a password-protected screen saver. - ScreenSaveTimeOut"
      info                 : "The system should be locked when unattended.  Unattended systems are susceptible to unauthorized use.  The screen saver should be set at a maximum of 15 minutes and password protected.  This protects critical and sensitive data from exposure to unauthorized personnel with physical access to the computer."
      solution             : "Configure The policy values for User Configuration -> Administrative Templates -> Control Panel -> Display as follows-

'Screen Saver' will be set to 'Enabled' ('Activate screen saver' on Windows 2000)

'Password protect the screen saver' will be set to 'Enabled'

'Screen Saver timeout' will be set to 'Enabled- 900 seconds' (or less)"
      reference            : "800-171|3.1.10,800-53|AC-11,CAT|II,CCI|CCI-000056,CCI|CCI-000057,CCI|CCI-000060,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,Rule-ID|SV-29500r1_rule,STIG-ID|5.006,Vuln-ID|V-1122"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "([0-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|900)"
      reg_key              : "HKU\Software\Policies\Microsoft\Windows\Control Panel\Desktop"
      reg_item             : "ScreenSaveTimeOut"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
      check_type           : CHECK_REGEX
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "4.027 - Only administrators responsible for the system must have Administrator rights on the system."
      info                 : "An account that does not have Administrator duties must not have Administrator rights. Such rights would allow the account to bypass or modify required security restrictions on that machine and make it vulnerable to attack.

System administrators must log on to systems only using accounts with the minimum level of authority necessary.

For domain joined workstations, the Domain Admins group must be replaced by a domain workstation administrator group.  Restricting highly privileged accounts from the local Administrators group helps mitigate the risk of privilege escalation resulting from credential theft attacks.

Standard user accounts must not be members of the built-in Administrators group."
      solution             : "Configure the system to include only administrator groups or accounts that are responsible for the system in the local Administrators group.

For domain joined workstations, replace the Domain Admins group with a domain workstation administrator group.

Remove any standard user accounts."
      reference            : "800-171|3.1.1,800-53|AC-2,CAT|I,CCI|CCI-002235,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-29504r2_rule,STIG-ID|4.027,Vuln-ID|V-1127"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "No entries found"
      powershell_args      : '$output=(Get-WmiObject -Query \\"SELECT * FROM Win32_GroupUser WHERE GroupComponent=`\\"Win32_Group.Domain=\'$env:userdomain\',Name=\'administrators\'`\\"\\" | ForEach-Object {[wmi]$_.PartComponent }); foreach-object { if(!$output){ $result=\'No entries found\' } else { $result=$output }; $result };'
      only_show_cmd_output : YES
    </custom_item>

    <report type:"WARNING">
      description : "1.016 - Security configuration tools or equivalent processes must be used to configure and maintain platforms for security compliance."
      info        : "Security configuration tools such as Group Policies and Security Templates allow system administrators to consolidate security-related system settings into a single configuration file.  These settings can then be applied consistently to any number of Windows systems.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Implement a process using security configuration tools or the equivalent to configure Windows systems to meet security requirements."
      reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-29668r2_rule,STIG-ID|1.016,Vuln-ID|V-1128"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.006 - ACLs for system files and directories do not conform to minimum requirements. - 'C:'"
      info        : "Failure to properly configure file and directory permissions (ACLs) allows the possibility of unauthorized and anonymous modification to the operating system and installed applications."
      solution    : "Maintain the default file ACLs, configure the Security Option- 'Network access- Let everyone permissions apply to anonymous users' to 'Disabled' (V-3377) and restrict the Power Users group to include no members."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|II,CCI|CCI-002165,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16968r1_rule,STIG-ID|2.006,SWIFT-CSCv1|2.3,Vuln-ID|V-1130"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : FILE_ACL
      value_data  : "CDir"
      file        : "%SystemDrive%"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.006 - ACLS FOR SYSTEM FILES AND DIRECTORIES DO NOT CONFORM TO MINIMUM REQUIREMENTS. - 'C:\Program Files'"
      info        : "Failure to properly configure file and directory permissions (ACLs) allows the possibility of unauthorized and anonymous modification to the operating system and installed applications."
      solution    : "Maintain the default file ACLs, configure the Security Option- 'Network access- Let everyone permissions apply to anonymous users' to 'Disabled' (V-3377) and restrict the Power Users group to include no members."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|II,CCI|CCI-002165,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16968r1_rule,STIG-ID|2.006,SWIFT-CSCv1|2.3,Vuln-ID|V-1130"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : FILE_ACL
      value_data  : "ProgramFilesOrWindows"
      file        : "%SystemDrive%"
    </custom_item>

    <custom_item>
      type        : FILE_PERMISSIONS
      description : "2.006 - ACLS FOR SYSTEM FILES AND DIRECTORIES DO NOT CONFORM TO MINIMUM REQUIREMENTS. - 'C:\Windows'"
      info        : "Failure to properly configure file and directory permissions (ACLs) allows the possibility of unauthorized and anonymous modification to the operating system and installed applications."
      solution    : "Maintain the default file ACLs, configure the Security Option- 'Network access- Let everyone permissions apply to anonymous users' to 'Disabled' (V-3377) and restrict the Power Users group to include no members."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|II,CCI|CCI-002165,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16968r1_rule,STIG-ID|2.006,SWIFT-CSCv1|2.3,Vuln-ID|V-1130"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : FILE_ACL
      value_data  : "ProgramFilesOrWindows"
      file        : "C:\Windows"
    </custom_item>

    <report type:"WARNING">
      description : "3.027 - Printer share permissions are not configured as recommended."
      info        : "Improperly configured share permissions on printers can permit the addition of unauthorized print devices on the network.  Windows shares are a means by which files, folders, printers, and other resources can be published for network users to remotely access.  Regular users cannot create shares on their local machines; only Administrators and Power Users have that ability.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the permissions on locally shared printers to meet the minimum requirements."
      reference   : "CAT|III,CCI|CCI-000213,Rule-ID|SV-29510r1_rule,STIG-ID|3.027,Vuln-ID|V-1135"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.006 - Users must be forcibly disconnected when their logon hours expire."
      info        : "Users must not be permitted to remain logged on to the network after they have exceeded their permitted logon hours. In many cases, this indicates that a user forgot to log off before leaving for the day.  However, it may also indicate that a user is attempting unauthorized access at a time when the system may be less closely monitored.  Forcibly disconnecting users when logon hours expire protects critical and sensitive network data from exposure to unauthorized personnel with physical access to the computer."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Microsoft Network Server- Disconnect Clients When Logon Hours Expire' to 'Enabled'."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|III,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16,CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-29000r2_rule,STIG-ID|4.006,Vuln-ID|V-1136"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "EnableForcedLogoff"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "1.006 - Users with Administrative privilege are not documented or do not have separate accounts for administrative duties."
      info        : "Using a privileged account to perform routine functions makes the computer vulnerable to attack by any virus or Trojan Horse inadvertently introduced during a session that has been granted full privileges.

The rule of least privilege should always be enforced.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create the necessary documentation that identifies the members of this privileged group.  Ensure each member has a separate account for user duties and one for his privileged duties and the other requirements outlined in the manual check are met."
      reference   : "CAT|I,CCI|CCI-000366,Rule-ID|SV-29680r2_rule,STIG-ID|1.006,Vuln-ID|V-1140"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.034 - Unencrypted passwords must not be sent to third-party SMB Servers."
      info        : "Some non-Microsoft SMB servers only support unencrypted (plain text) password authentication.  Sending plain text passwords across the network, when authenticating to an SMB server, reduces the overall security of the environment.  Check with the Vendor of the SMB server to see if there is a way to support encrypted password authentication."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'Microsoft Network Client- Send unencrypted password to third-party SMB servers' to 'Disabled'."
      reference   : "800-53|SI-5(7),CAT|II,CCI|CCI-000197,CSCv6|13,Rule-ID|SV-29003r2_rule,STIG-ID|3.034,Vuln-ID|V-1141"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanworkstation\Parameters"
      reg_item    : "EnablePlainTextPassword"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.040 - Automatic logons must be disabled."
      info        : "Allowing a system to automatically log on when the machine is booted could give access to any unauthorized individual who restarts the computer.  Automatic logon with administrator privileges would give full access to an unauthorized individual."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (AutoAdminLogon) Enable Automatic Logon (not recommended)' to 'Disabled'.

Ensure no passwords are stored in the 'DefaultPassword' registry value noted below.

Registry Hive- HKEY_LOCAL_MACHINE
Subkey- \Software\Microsoft\Windows NT\CurrentVersion\Winlogon\

Value Name- DefaultPassword"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-29006r2_rule,STIG-ID|3.040,Vuln-ID|V-1145"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "AutoAdminLogon"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "4.024 - Local users must not exist on a system in a domain."
      info                 : "To minimize potential points of attack, local users, other than built-in accounts such as Administrator and Guest accounts, must not exist on a workstation in a domain.  Users must log onto workstations in a domain with their domain accounts."
      solution             : "Limit local user accounts on domain-joined systems.  Remove any unauthorized local accounts."
      reference            : "800-171|3.1.1,800-53|AC-2,CAT|III,CCI|CCI-000366,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|M4.4.3,NESA|T5.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14d,NIAv2|SS14e,Rule-ID|SV-29512r3_rule,STIG-ID|4.024,Vuln-ID|V-1148"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-WmiObject -Class Win32_UserAccount | Where-Object {$_.LocalAccount -match 'True'} | Select-Object PSComputerName,Status,Caption,PasswordExpires,AccountType,Disabled,Domain,LocalAccount,Lockout,Name,PasswordChangeable,PasswordRequired,SID | Format-List"
      only_show_cmd_output : YES
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "3.028 - The built-in Windows password complexity policy must be enabled."
      info            : "The use of complex passwords increases their strength against attack. The built-in Windows password complexity policy requires passwords to contain at least 3 of the 4 types of characters (numbers, upper- and lower-case letters, and special characters), as well as preventing the inclusion of user names or parts of."
      solution        : "Configure the policy value for Computer Configuration -> Windows Settings >> Security Settings >> Account Policies >> Password Policy >> 'Password must meet complexity requirements' to 'Enabled'."
      reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000192,CCI|CCI-000193,CCI|CCI-000194,CCI|CCI-001619,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-29684r2_rule,STIG-ID|3.028,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-1150"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_SET
      value_data      : "Enabled"
      password_policy : COMPLEXITY_REQUIREMENTS
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.029 - Print driver installation privilege is not restricted to administrators."
      info        : "By default, the print spooler allows any user to add and to delete printer drivers on the local system.  This capability should be restricted to authorized personnel."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Devices- Prevent users from installing printer drivers' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-001812,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-29009r1_rule,STIG-ID|3.029,Vuln-ID|V-1151"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Print\Providers\Lanman Print Services\Servers"
      reg_item    : "AddPrinterDrivers"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REG_CHECK
      description : "3.030 - Anonymous access to the registry must be restricted."
      info        : "The registry is integral to the function, security, and stability of the Windows system.  Some processes may require anonymous access to the registry.  This must be limited to properly protect the system."
      solution    : "Maintain the default permissions of the following registry key-

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg\

Administrators - Full
Backup Operators - Special
(Special = Query Value, Enumerate Subkeys, Notify, Read Control (effectively = Read) - This key only)
LOCAL SERVICE - Read"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-002235,CSF|PR.AC-4,Rule-ID|SV-29594r2_rule,STIG-ID|3.030,Vuln-ID|V-1152"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "HKLM\System\Currentcontrolset\Control\Securepipeservers\Winreg"
      reg_option  : MUST_EXIST
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.031 - The Send download LanMan compatible password option is not set to Send NTLMv2 response only\refuse LM."
      info        : "The Kerberos v5 authentication protocol is the default for authentication of users who are logging on to domain accounts.  NTLM is retained in later Windows versions  for compatibility with clients and servers that are running earlier versions of Windows.  It is also used to authenticate logons to stand-alone computers that are running later versions."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network security- LAN Manager authentication level' to at least 'Send NTLMv2 response only\refuse LM'."
      reference   : "800-53|IA-5(6),CAT|I,CCI|CCI-000366,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-5(6),Rule-ID|SV-29012r1_rule,STIG-ID|3.031,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-1153"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 5
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "LMCompatibilityLevel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.032 - Ctrl+Alt+Del security attention sequence is Disabled."
      info        : "Disabling the Ctrl+Alt+Del security attention sequence can compromise system security.  Because only Windows responds to the Ctrl+Alt+Del security sequence, you can be assured that any passwords you enter following that sequence are sent only to Windows.  If you eliminate the sequence requirement, malicious programs can request and receive your Windows password.  Disabling this sequence also suppresses a custom logon banner."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive Logon- Do not require CTRL ALT DEL' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|8,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29015r1_rule,STIG-ID|3.032,SWIFT-CSCv1|2.3,Vuln-ID|V-1154"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "DisableCAD"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.047 - The Smart Card removal option is set to take no action."
      info        : "Determines what should happen when the smart card for a logged-on user is removed from the smart card reader.

The options are-
- No Action
- Lock Workstation
- Force Logoff"
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive logon- Smart card removal behavior' to  'Lock Workstation' or 'Force Logoff'."
      reference   : "800-171|3.1.10,800-53|AC-11,CAT|II,CCI|CCI-000366,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NIAv2|AM23e,Rule-ID|SV-28467r1_rule,STIG-ID|3.047,Vuln-ID|V-1157"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1 || 2
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "SCRemoveOption"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.048 - The Recovery Console SET command must be disabled."
      info        : "The Recovery Console SET command allows environment variables to be set in the Recovery Console.  This permits access to all drives and folders and the copying of files to removable media which could expose sensitive information."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'Recovery Console- Allow floppy copy and access to all drives and all folders' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29019r2_rule,STIG-ID|3.048,SWIFT-CSCv1|2.3,Vuln-ID|V-1158"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Setup\Recoveryconsole"
      reg_item    : "SetCommand"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.049 - The Recovery Console option is set to permit automatic logon to the system."
      info        : "This is a Category 1 finding because if this option is set, the Recovery Console does not require you to provide a password and will automatically log on to the system, giving Administrator access to system files.

By default, the Recovery Console requires you to provide the password for the Administrator account before accessing the system."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Recovery Console- Allow automatic administrative logon' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-29023r1_rule,STIG-ID|3.049,Vuln-ID|V-1159"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Setup\Recoveryconsole"
      reg_item    : "securitylevel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.046 - The Windows SMB server is not enabled to perform SMB packet signing when possible."
      info        : "If this policy is enabled, it causes the Windows Server Message Block (SMB) server to perform SMB packet signing."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Microsoft Network Server- Digitally sign communications (if Client agrees)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29026r1_rule,STIG-ID|3.046,Vuln-ID|V-1162"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "enablesecuritysignature"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.043 - Outgoing secure channel traffic is not encrypted when possible."
      info        : "Requests sent on the secure channel are authenticated, and sensitive information (such as passwords) is encrypted, but not all information is encrypted.  If this policy is enabled, outgoing secure channel traffic should be encrypted."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Digitally encrypt secure channel data (when possible)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CCI|CCI-002421,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29514r1_rule,STIG-ID|3.043,Vuln-ID|V-1163"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "SealSecureChannel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.042 - Outgoing secure channel traffic is not signed when possible."
      info        : "Requests sent on the secure channel are authenticated, and sensitive information (such as passwords) is encrypted, but the channel is not integrity checked.  If this policy is enabled, all outgoing secure channel traffic should be signed."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Digitally sign secure channel data (when possible)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29517r1_rule,STIG-ID|3.042,Vuln-ID|V-1164"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "signsecurechannel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.044 - The computer account password is prevented from being reset."
      info        : "As a part of Windows security, computer account passwords are changed automatically.  Enabling this policy to disable automatic password changes can make the system more vulnerable to malicious access.  Frequent password changes can be a significant safeguard for your system.  If this policy is disabled, a new password for the computer account will be generated every week."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Disable Machine Account Password Changes' to 'Disabled'."
      reference   : "800-171|3.5.2,800-53|IA-5,CAT|III,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,NIAv2|AM22b,Rule-ID|SV-29029r1_rule,STIG-ID|3.044,TBA-FIISB|26.2.5,Vuln-ID|V-1165"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "disablepasswordchange"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.045 - The Windows SMB client is not enabled to perform SMB packet signing when possible."
      info        : "If this policy is enabled, it causes the Windows Server Message Block (SMB) client to perform SMB packet signing when communicating with an SMB server that is enabled or required to perform SMB packet signing."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Microsoft Network Client- Digitally sign communications (if server agrees)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29032r1_rule,STIG-ID|3.045,Vuln-ID|V-1166"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "enablesecuritysignature"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "1.007 - Members of the Backup Operators group must have separate accounts for backup duties and normal operational tasks."
      info                 : "Backup Operators are able to read and write to any file in the system, regardless of the rights assigned to it.  Backup and restore rights permit users to circumvent the file access restrictions present on NTFS disk drives for the purpose of backup and restore.  Members of the Backup Operators group must have separate logon accounts for performing backup duties."
      solution             : "Ensure that each member has separate accounts for user tasks and for backup operator functions.  Create the necessary documentation that identifies the members of the Backup Operators group."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-29521r2_rule,STIG-ID|1.007,SWIFT-CSCv1|2.3,Vuln-ID|V-1168"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "No entries found"
      powershell_args      : '$output=(Get-WmiObject -Query \\"SELECT * FROM Win32_GroupUser WHERE GroupComponent=`\\"Win32_Group.Domain=\'$env:userdomain\',Name=\'backup operators\'`\\"\\" | ForEach-Object {[wmi]$_.PartComponent }); foreach-object { if(!$output){ $result=\'No entries found\' } else { $result=$output }; $result };'
      only_show_cmd_output : YES
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.052 - Ejection of removable NTFS media is not restricted to Administrators."
      info        : "Removable hard drives can be formatted and ejected by others who are not members of the Administrators Group, if they are not properly configured.  Formatting and ejecting removable NTFS media should only be done by administrators."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Devices- Allowed to Format and Eject Removable Media' to 'Administrators'."
      reference   : "800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|MP-2,CAT|II,CCI|CCI-000366,CSCv6|8.3,CSF|PR.PT-2,ITSG-33|MP-2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,Rule-ID|SV-29215r1_rule,STIG-ID|3.052,Vuln-ID|V-1171"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "AllocateDASD"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.054 - Users are not warned in advance that their passwords will expire."
      info        : "This setting configures the system to display a warning to users telling them how many days are left before their password expires.  By giving the user advanced warning, the user has time to construct a sufficiently strong password."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive Logon- Prompt user to change password before expiration' to '14' days or more."
      reference   : "800-53|IA-5(1),CAT|III,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,Rule-ID|SV-29219r1_rule,STIG-ID|3.054,SWIFT-CSCv1|4.1,Vuln-ID|V-1172"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [14..MAX]
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "PasswordExpiryWarning"
      reg_type    : REG_DWORD
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.055 - The default permissions of Global system objects are not increased."
      info        : "Windows system maintains a global list of shared system resources such as DOS device names, mutexes, and semaphores. Each type of object is created with a default DACL that specifies who can access the objects with what permissions. If this policy is enabled, the default DACL is stronger, allowing non-admin users to read shared objects, but not modify shared objects that they did not create."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'System Objects- Strengthen default permissions of internal system objects (e.g. Symbolic links)' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|14.4,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29222r1_rule,STIG-ID|3.055,SWIFT-CSCv1|2.3,Vuln-ID|V-1173"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Session Manager"
      reg_item    : "ProtectionMode"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.028 - The amount of idle time required before suspending a session must be properly set."
      info        : "Open sessions can increase the avenues of attack on a system.  This setting is used to control when a computer disconnects an inactive SMB session.  If client activity resumes, the session is automatically re-established.  This protects critical and sensitive network data from exposure to unauthorized personnel with physical access to the computer."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'Microsoft Network Server- Amount of idle time required before suspending session' to '15' minutes or less."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|III,CCI|CCI-001133,CCI|CCI-002361,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,CSCv6|3,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-29225r2_rule,STIG-ID|4.028,Vuln-ID|V-1174"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [1..15]
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "autodisconnect"
    </custom_item>

    <report type:"WARNING">
      description : "2.014 - ACLs for disabled services do not conform to minimum standards."
      info        : "When configuring either the startup mode or access control list for a service, you must configure the other as well. When a service is explicitly disabled, its ACL should also be secured by changing the default ACL from Everyone Full Control to grant Administrators and SYSTEM Full Control and Interactive Read access."
      solution    : "Create a Custom Security Template using the Security Template MMC Snap-in to set the permissions as required for disabled services.

Import the Custom Template into the Security Configuration and Analysis Snap-In and Select Configure Computer Now

Or import the Custom Template in to a Group Policy for application.

The administrator should have a thorough understanding of these tools before implementing settings with them.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29524r1_rule,STIG-ID|2.014,Vuln-ID|V-2371"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "3.057 - Reversible password encryption is not disabled."
      info            : "Storing passwords using reversible encryption is essentially the same as storing clear-text versions of the passwords. For this reason, this policy should never be enabled."
      solution        : "Configure the system to prevent passwords from being saved using reverse encryption."
      reference       : "800-171|3.5.10,800-53|IA-5(1),CAT|II,CCI|CCI-000196,CSCv6|16.13,CSCv6|16.14,CSCv6|16.5,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-29688r1_rule,STIG-ID|3.057,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-2372"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_SET
      value_data      : "Disabled"
      password_policy : REVERSIBLE_ENCRYPTION
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.059 - The system is configured to autoplay removable media."
      info        : "Autoplay begins reading from a drive as soon as you insert media in the drive.  As a result, the setup file of programs and the music on audio media starts immediately.  By default, Autoplay is disabled on removable drives, such as the floppy disk drive (but not the CD-ROM drive), and on network drives.  If you enable this policy, you can also disable Autoplay on all drives."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> AutoPlay Policies -> 'Turn off AutoPlay' to 'Enabled-All Drives'.

Note-  This was previously configured in the checklist using the Security Option setting 'MSS- (NoDriveTypeAutorun) Disable Autorun on all drives' set to '255, disable Autorun for all drives'.  This updates the same registry value (NoDriveTypeAutorun) as the Administrative Template."
      reference   : "800-171|3.13.13,800-53|SC-18(4),CAT|I,CCI|CCI-001764,CSCv6|8.3,CSF|DE.CM-5,ITSG-33|SC-18(4),Rule-ID|SV-6272r1_rule,STIG-ID|3.059,Vuln-ID|V-2374"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 255
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "NoDriveTypeAutoRun"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.061 - Unencrypted remote access is permitted to system services."
      info        : "This is a category 1 finding because when unencrypted access to system services is permitted, an intruder can intercept user identification and passwords that are being transmitted in clear text.  This could give an intruder unlimited access to the network."
      solution    : "Encryption of userid and password information is required.

Encryption of the user data inside the network firewall is also highly recommended.

Encryption of user data coming from or going outside the network firewall is required.

Encryption for administrator data is always required.

Refer to the Enclave Security STIG section on 'FTP and Telnet,' for detailed information on its use."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CIP|005-5-R2,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-29695r1_rule,STIG-ID|3.061,SWIFT-CSCv1|2.6,Vuln-ID|V-2908"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Terminal Server\Winstations\Rdp-Tcp"
      reg_item    : "UserAuthentication"
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "2.015 - File share ACLs have not been reconfigured to remove the Everyone group."
      info                 : "By default, the Everyone group is given full control to new file shares. When a share is created, permissions should be reconfigured to give the minimum access to those accounts that require it.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Remove permissions from the Everyone group from locally-created file shares and assign them to authorized groups."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001090,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29212r1_rule,STIG-ID|2.015,SWIFT-CSCv1|2.3,Vuln-ID|V-3245"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-WmiObject -Class Win32_Share | Where-Object {$_.Name -notlike '*$'} | Select-Object Name | Format-List"
      only_show_cmd_output : YES
      powershell_option    : CAN_BE_NULL
      severity             : MEDIUM
    </custom_item>

    <custom_item>
      type        : ANONYMOUS_SID_SETTING
      description : "3.062 - Anonymous SID/Name translation is allowed."
      info        : "This is a Category 1 finding because this setting controls the ability of users or process that have authenticated as anonymous users to perform SID/Name translation.  This setting should be disabled, as only authorized users should be able to perform such translations."
      solution    : "Configure the system to disable anonymous SID/Name translation."
      reference   : "800-171|3.1.7,800-171|3.5.3,800-53|AC-6(10),800-53|IA-2(2),CAT|I,CCI|CCI-000366,CSCv6|13,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|IA-2(2),NESA|T5.4.2,Rule-ID|SV-29701r1_rule,STIG-ID|3.062,SWIFT-CSCv1|1.2,Vuln-ID|V-3337"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_SET
      value_data  : "Disabled"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.063 - Unauthorized named pipes are accessible with anonymous credentials."
      info        : "This is a Category 1 finding because the potential for gaining unauthorized system access.  Pipes are internal system communications processes.  They are identified internally by ID numbers that vary between systems.  To make access to these processes easier, these pipes are given names that do not vary between systems.  This setting controls which of these pipes anonymous users may access."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Named pipes that can be accessed anonymously' as defined in the Check section."
      reference   : "800-171|3.5.3,800-53|IA-2(2),CAT|I,CCI|CCI-001090,CSCv6|14.1,CSF|PR.AC-1,ITSG-33|IA-2(2),NESA|T5.4.2,Rule-ID|SV-15089r1_rule,STIG-ID|3.063,SWIFT-CSCv1|1.2,Vuln-ID|V-3338"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_MULTI_TEXT
      value_data  : ""
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "NullSessionPipes"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.064 - Unauthorized registry paths are remotely accessible."
      info        : "This is a Category 1 finding because it could give unauthorized individuals access to the Registry.
It controls which registry paths are accessible from a remote computer."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Remotely accessible registry paths' as defined in the Check section."
      reference   : "800-53|AC-6(7),CAT|I,CCI|CCI-001090,CSCv6|14,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-28587r1_rule,STIG-ID|3.064,Vuln-ID|V-3339"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_MULTI_TEXT
      value_data  : "Software\Microsoft\Windows NT\CurrentVersion" && "System\CurrentControlSet\Control\ProductOptions" && "System\CurrentControlSet\Control\Server Applications"
      reg_key     : "HKLM\System\Currentcontrolset\Control\Securepipeservers\Winreg\Allowedexactpaths"
      reg_item    : "Machine"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.065 - Unauthorized shares can be accessed anonymously."
      info        : "This is a Category 1 finding because the potential for gaining unauthorized system access. Any shares listed can be accessed by any network user.  This could lead to the exposure or corruption of sensitive data.  Enabling this setting is very dangerous."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Shares that can be accessed anonymously' to be defined but containing no entries (Blank)."
      reference   : "800-171|3.5.3,800-53|IA-2(2),CAT|I,CCI|CCI-001090,CSCv6|14,CSCv6|16,CSF|PR.AC-1,ITSG-33|IA-2(2),NESA|T5.4.2,Rule-ID|SV-29703r1_rule,STIG-ID|3.065,SWIFT-CSCv1|1.2,Vuln-ID|V-3340"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_MULTI_TEXT
      value_data  : ""
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "NullSessionShares"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.068 - Solicited Remote Assistance is allowed."
      info        : "This setting controls whether or not solicited remote assistance is allowed from this computer.  Solicited assistance is help that is specifically requested by the user.  This is a Category 1 finding because it may allow unauthorized parties access to the resources on the computer."
      solution    : "Configure the system to disable Remote Assistance by setting the policy value for Computer Configuration -> Administrative Templates -> System -> Remote Assistance 'Solicited Remote Assistance' to 'Disabled'."
      reference   : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17(4),CAT|I,CCI|CCI-001090,CSCv6|5.1,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(4),Rule-ID|SV-29229r1_rule,STIG-ID|3.068,SWIFT-CSCv1|5.1,Vuln-ID|V-3343"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "fAllowToGetHelp"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.036 - The use of local accounts with blank passwords is not restricted to console logons only."
      info        : "This is a Category 1 finding because no accounts with blank passwords should exist on a system.  The password policy should prevent this from occurring.  However, if a local account with a blank password does exist, enabling this setting will limit the account to local console logon only."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Accounts- Limit local account use of blank passwords to console logon only' to 'Enabled'."
      reference   : "800-53|IA-5(1),CAT|I,CCI|CCI-000366,CSCv6|16,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,Rule-ID|SV-29233r1_rule,STIG-ID|4.036,SWIFT-CSCv1|4.1,Vuln-ID|V-3344"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "LimitBlankPasswordUse"
    </custom_item>

    <custom_item>
      type              : AUDIT_POWERSHELL
      description       : "5.016 - Internet Information System (IIS) or its subcomponents are installed on a workstation."
      info              : "This is a Category 1 finding because not removing these services may allow unauthorized internet services to be hosted.  Web sites should only be hosted on servers that have been designed for that purpose and can be adequately secured."
      solution          : "Configure the system to remove 'Internet Information Services'."
      reference         : "800-171|3.4.8,800-53|CM-7(4),CAT|I,CCI|CCI-000381,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-29706r1_rule,STIG-ID|5.016,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-3347"
      see_also          : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type        : POLICY_TEXT
      value_data        : ""
      powershell_args   : "Get-WindowsOptionalFeature -online | where {$_.FeatureName -eq 'IIS-WebServer' -and $_.State -eq 'Enabled'} | format-list"
      powershell_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.017 - The user is allowed to launch Windows Messenger (MSN Messenger, .NET Messenger)."
      info        : "This setting prevents the Windows Messenger client from being run.

Instant Messaging clients must be in compliance of with the Instant Messaging STIG.  Windows Messenger should not be active on Windows unless the instant messaging system is a Managed Enterprise Service for unclassified data for which the DAA has approved."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Messenger 'Do Not Allow Windows Messenger to be Run' to 'Enabled'."
      reference   : "800-171|3.4.8,800-53|CM-7(4),CAT|II,CCI|CCI-000381,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-29238r1_rule,STIG-ID|5.017,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-3348"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Messenger\Client"
      reg_item    : "PreventRun"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.018 - Windows Messenger (MSN Messenger, .NET messenger) is run at system startup."
      info        : "This setting prevents the automatic launch of Windows Messenger at user logon.

Instant Messaging clients must be in compliance of with the Instant Messaging STIG.  Windows Messenger should not be active on Windows unless the instant messaging system is a Managed Enterprise Service for unclassified data for which the DAA has approved."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Messenger 'Do Not Automatically Start Windows Messenger Initially' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-29243r1_rule,STIG-ID|5.018,SWIFT-CSCv1|2.3,Vuln-ID|V-3349"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Messenger\Client"
      reg_item    : "PreventAutoRun"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.043 - The maximum age for machine account passwords is not set to requirements."
      info        : "This setting controls the maximum password age that a machine account may have.  This setting should be set to no more than 30 days, ensuring the machine changes its password monthly."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Maximum Machine Account Password Age' to 30 or less, but not 0."
      reference   : "800-53|IA-5(1),CAT|III,CCI|CCI-000366,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-29246r1_rule,STIG-ID|4.043,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-3373"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [1..30]
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "MaximumPasswordAge"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.044 - The system is not configured to require a strong session key."
      info        : "This setting controls the required strength of a session key."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Require Strong (Windows 2000 or Later) Session Key' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29250r1_rule,STIG-ID|4.044,Vuln-ID|V-3374"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "requirestrongkey"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "4.045 - Domain Controller authentication is not required to unlock the workstation."
      info        : "This setting controls the behavior of the system when you attempt to unlock the workstation.  If this setting is enabled, the system will pass the credentials to the domain controller (if in a domain) for authentication before allowing the system to be unlocked.  This will be set to disabled per the FDCC."
      solution    : "Workstations - Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive logon- Require domain controller authentication to unlock workstation' to 'Disabled'."
      reference   : "800-171|3.1.10,800-53|AC-11,CAT|III,CCI|CCI-000366,CN-L3|8.1.4.1(b),ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NIAv2|AM23e,Rule-ID|SV-29254r1_rule,STIG-ID|4.045,Vuln-ID|V-3375"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "ForceUnlockLogon"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.070 - The system is configured to permit storage of credentials or .NET Passports."
      info        : "This setting controls the storage of authentication credentials or .NET passports on the local system.  Such credentials should never be stored on the local machine as that may lead to account compromise."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Do not allow storage of credentials or .NET passports for network authentication' to 'Enabled'."
      reference   : "800-171|3.5.10,800-53|IA-5(1),CAT|II,CCI|CCI-002038,CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-29258r1_rule,STIG-ID|3.070,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-3376"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "DisableDomainCreds"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.071 - The system is configured to give anonymous users Everyone rights."
      info        : "This setting helps define the permissions that anonymous users have.  If this setting is enabled then anonymous users have the same rights and permissions as the built-in Everyone group.  Anonymous users should not have these permissions or rights."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Let everyone permissions apply to anonymous users' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000366,CSCv6|14,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-29263r1_rule,STIG-ID|3.071,Vuln-ID|V-3377"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "EveryoneIncludesAnonymous"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.072 - The system is not configured to use the Classic security model."
      info        : "Windows includes two network-sharing security models - Classic and Guest only. With the classic model, local accounts must be password protected; otherwise, anyone can use guest user accounts to access shared system resources."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Sharing and security model for local accounts' to 'Classic - local users authenticate as themselves'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001090,CN-L3|8.1.10.6(d),CSCv6|14,CSCv6|16,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29266r1_rule,STIG-ID|3.072,SWIFT-CSCv1|2.3,Vuln-ID|V-3378"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "ForceGuest"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.073 - The system must be configured to prevent the storage of the LAN Manager hash of passwords."
      info        : "The LAN Manager hash uses a weak encryption algorithm.  Account passwords can be retrieved from this hash using available tools.  This setting controls whether or not a LAN Manager hash of the password is stored in the SAM the next time the password is changed."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network security- Do not store LAN Manager hash value on next password change' to 'Enabled'."
      reference   : "800-53|IA-5(6),8500.2|ECSC-1,CAT|I,CCI|CCI-000196,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(6),Rule-ID|SV-29269r2_rule,STIG-ID|3.073,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-3379"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "NoLMHash"
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "3.074 - The system is not configured to force users to log off when their allowed logon hours expire."
      info            : "This setting controls whether or not users are forced to log off when their allowed logon hours expire.  If logon hours are set for users, then this should be enforced."
      solution        : "Configure the system to log off users when their allowed logon hours expire."
      reference       : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16,CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-29528r1_rule,STIG-ID|3.074,Vuln-ID|V-3380"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_SET
      value_data      : "Enabled"
      password_policy : FORCE_LOGOFF
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.075 - The system is not configured to recommended LDAP client signing requirements."
      info        : "This setting controls the signing requirements for LDAP clients.  This setting should be set to Negotiate signing or Require signing depending on the environment and type of LDAP server in use."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network security- LDAP client signing requirements' to 'Negotiate signing' at a minimum."
      reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000366,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-29272r1_rule,STIG-ID|3.075,Vuln-ID|V-3381"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Ldap"
      reg_item    : "LDAPClientIntegrity"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.076 - The system is not configured to meet the minimum requirement for session security for NTLM SSP based Clients."
      info        : "Microsoft has implemented a variety of security support providers for use with RPC sessions.  In a homogenous Windows environment, all of the options should be enabled and testing should be performed in a heterogeneous environment to determine the maximum-security level that provides reliable functionality."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network security- Minimum session security for NTLM SSP based (including secure RPC) clients' to 'Require NTLMv2 session security', 'Require 128-bit encryption' (all options selected)."
      reference   : "800-171|3.13.8,800-53|SC-8,CAT|II,CCI|CCI-000366,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|13,CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE12,NIAv2|IE8,NIAv2|IE9,NIAv2|NS29,NIAv2|SS24,Rule-ID|SV-15980r1_rule,STIG-ID|3.076,Vuln-ID|V-3382"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [537395200..MAX]
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa\Msv1_0"
      reg_item    : "NTLMMinClientSec"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.077 - The system is not configured to use FIPS compliant Algorithms for Encryption, Hashing, and Signing."
      info        : "This setting ensures that the system uses algorithms that are FIPS compliant for encryption, hashing, and signing.  FIPS compliant algorithms meet specific standards established by the U.S. Government and should be the algorithms used for all OS encryption functions."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'System cryptography- Use FIPS compliant algorithms for encryption, hashing, and signing' to 'Enabled'."
      reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-002450,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-29532r1_rule,STIG-ID|3.077,Vuln-ID|V-3383"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa\Fipsalgorithmpolicy"
      reg_item    : "Enabled"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.078 - The system must be configured to require case insensitivity for non-Windows subsystems."
      info        : "This setting controls the behavior of non-Windows subsystems when dealing with the case of arguments or commands.  Case sensitivity could lead to the access of files or commands that must be restricted.  To prevent this from happening, case insensitivity restrictions must be required."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'System Objects- Require case insensitivity for non-Windows subsystems' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29535r2_rule,STIG-ID|3.078,SWIFT-CSCv1|2.3,Vuln-ID|V-3385"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Session Manager\Kernel"
      reg_item    : "ObCaseInsensitive"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.027 - The system is configured to allow remote desktop sharing through NetMeeting."
      info        : "Remote desktop sharing enables several users to interact and control one desktop.  This could allow unauthorized users to control the system.  Remote desktop sharing should be disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> NetMeeting 'Disable remote Desktop Sharing' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-29276r1_rule,STIG-ID|5.027,SWIFT-CSCv1|2.3,Vuln-ID|V-3426"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Conferencing"
      reg_item    : "NoRDS"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.042 - Terminal Services is not configured to always prompt a client for passwords upon connection."
      info        : "This setting controls the ability of users to supply passwords automatically as part of their Remote Desktop Connection.  Disabling this setting would allow anyone to use the stored credentials in a connection item to connect to the terminal server."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Security 'Always Prompt Client for Password upon Connection' to 'Enabled'."
      reference   : "800-171|3.5.1,800-53|AC-17(6),800-53|IA-2,CAT|II,CCI|CCI-002038,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|16.14,CSF|PR.AC-1,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(6),ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-29277r2_rule,STIG-ID|5.042,SWIFT-CSCv1|2.6,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3453"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "fPromptForPassword"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.043 - Terminal Services is not configured with the client connection encryption set to the required level."
      info        : "Remote connections must be encrypted to prevent interception of data or sensitive information.  Selecting 'High Level' will ensure encryption of Terminal Services sessions in both directions."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Security 'Set Client Connection Encryption Level' to 'Enabled' and select 'High Level' for the 'Encryption Level'."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000068,CCI|CCI-002890,CIP|005-5-R2,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSCv6|3.4,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-29280r2_rule,STIG-ID|5.043,SWIFT-CSCv1|2.6,Vuln-ID|V-3454"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 3
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "MinEncryptionLevel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.044 - Terminal Services is configured to use a common temporary folder for all sessions."
      info        : "This setting, which is located under the Temporary Folders section of the Terminal Services configuration option, controls the use of per session temporary folders or of a communal temporary folder.  If this setting is enabled, only one temporary folder is used for all terminal services sessions.  If a communal temporary folder is used, it might be possible for users to access other users temporary folders."
      solution    : "2008/Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Temporary Folders 'Do Not Use Temp Folders per Session' will be set to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|14.4,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16954r1_rule,STIG-ID|5.044,SWIFT-CSCv1|2.3,Vuln-ID|V-3455"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "PerSessionTempDir"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.045 - Terminal Services is not configured to delete temporary folders."
      info        : "This setting, which is located under the Temporary Folders section of the Terminal Services configuration option, controls the deletion of the temporary folders when the session is terminated.  Temporary folders should always be deleted after a session is over to prevent hard disk clutter and potential leakage of information."
      solution    : "2008/Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Temporary Folders 'Do Not Delete Temp Folder upon Exit' will be set to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|14.4,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16955r1_rule,STIG-ID|5.045,SWIFT-CSCv1|2.3,Vuln-ID|V-3456"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "DeleteTempDirsOnExit"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.046 - Terminal Services is not configured to set a time limit for disconnected sessions."
      info        : "This setting controls how long a session will remain open if it is unexpectedly terminated.  Such sessions should be terminated as soon as possible."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Session Time Limits 'Set Time Limit for Disconnected Sessions' to 'Enabled', and the 'End a disconnected session' set to '1 minute'."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,CSCv6|16.5,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-16613r1_rule,STIG-ID|5.046,Vuln-ID|V-3457"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [MIN..60000]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "MaxDisconnectionTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.047 - Terminal Services idle session time limit does not meet the requirement."
      info        : "This setting controls how long a session may be idle before it is automatically disconnected from the server.  Users should disconnect if they plan on being away from their terminals for extended periods of time.  Idle sessions should be disconnected after 15 minutes."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Session Time Limits 'Set time limit for active but idle Terminal Services sessions' to 'Enabled', and the 'Idle session limit' set to 15 minutes or less, excluding 0 which equates to 'Never'."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,CSCv6|16.5,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-16614r1_rule,STIG-ID|5.047,Vuln-ID|V-3458"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : "[1..900000]"
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "MaxIdleTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000029 - Group Policies must be refreshed in the background if the user is logged on."
      info        : "If this setting is enabled, then Group Policy settings are not refreshed while a user is currently logged on. This could lead to instances when a user does not have the latest changes to a policy applied and is therefore operating in an insecure context."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Group Policy -> 'Turn off background refresh of Group Policy' to 'Disabled'."
      reference   : "800-53|CM-3(3),CAT|II,CCI|CCI-000366,CSCv6|3.7,CSF|PR.IP-1,CSF|PR.IP-3,ITSG-33|CM-3(3),NESA|T7.5.1,Rule-ID|SV-51981r1_rule,STIG-ID|WINCC-000029,Vuln-ID|V-3469"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Current Version\Policies\System"
      reg_item    : "DisableBkGndGroupPolicy"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.082 - The system is configured to allow unsolicited remote assistance offers."
      info        : "This setting controls whether unsolicited offers of help to this computer are allowed.  The list of users allowed to offer remote assistance to this system is accessed by pressing the Helpers button."
      solution    : "Configure the system to prevent unsolicited remote assistance offers by setting the policy value for Computer
Configuration -> Administrative Templates -> System -> Remote Assistance 'Offer Remote Assistance' to 'Disabled'."
      reference   : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17(4),CAT|II,CCI|CCI-001090,CSCv6|9.1,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(4),Rule-ID|SV-29282r1_rule,STIG-ID|3.082,SWIFT-CSCv1|5.1,Vuln-ID|V-3470"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "fAllowUnsolicited"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.084 - The system is configured to use an unauthorized time server. - 'Type'"
          value_type  : POLICY_TEXT
          value_data  : "AllSync" || "NTP"
          reg_key     : "HKLM\Software\Policies\Microsoft\W32Time\Parameters"
          reg_item    : "Type"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.084 - The system is configured to use an unauthorized time server. - 'Type' - Domain"
          info        : "The Windows Time Service controls time synchronization settings.  Time synchronization is essential for authentication and auditing purposes.  If the Windows Time Service is used, it should synchronize with a secure, authorized time source.   Domain joined systems are automatically configured to synchronize with domain controllers.  If an NTP server is configured it should synchronize with a secure, authorized time source."
          solution    : "If the system needs to be configured to an NTP server, configure the system to point to an authorized time server by setting the policy value for Computer Configuration -> Administrative Templates -> System -> Windows Time Service -> Time Providers 'Configure Windows NTP Client' to 'Enabled', and configure the 'NtpServer' field to point to an authorized time server."
          reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-001891,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29538r1_rule,STIG-ID|3.084,SWIFT-CSCv1|2.3,Vuln-ID|V-3472"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_TEXT
          value_data  : "AllSync" || "NTP"
          reg_key     : "HKLM\Software\Policies\Microsoft\W32Time\Parameters"
          reg_item    : "Type"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.084 - The system is configured to use an unauthorized time server. - 'NTPServer'"
          info        : "The Windows Time Service controls time synchronization settings.  Time synchronization is essential for authentication and auditing purposes.  If the Windows Time Service is used, it should synchronize with a secure, authorized time source.   Domain joined systems are automatically configured to synchronize with domain controllers.  If an NTP server is configured it should synchronize with a secure, authorized time source."
          solution    : "If the system needs to be configured to an NTP server, configure the system to point to an authorized time server by setting the policy value for Computer Configuration -> Administrative Templates -> System -> Windows Time Service -> Time Providers 'Configure Windows NTP Client' to 'Enabled', and configure the 'NtpServer' field to point to an authorized time server."
          reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|III,CCI|CCI-001891,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-29538r1_rule,STIG-ID|3.084,Vuln-ID|V-3472"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_TEXT
# Note: Variable @NTP_SERVER@ replaced with "time\\.windows\\.com" in field "value_data".
          value_data  : "" || "time\\.windows\\.com"
          reg_key     : "HKLM\Software\Policies\Microsoft\W32Time\Parameters"
          reg_item    : "NTPServer"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </then>

      <else>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.084 - The system is configured to use an unauthorized time server. - 'Type' - Non-domain"
          info        : "The Windows Time Service controls time synchronization settings.  Time synchronization is essential for authentication and auditing purposes.  If the Windows Time Service is used, it should synchronize with a secure, authorized time source.   Domain joined systems are automatically configured to synchronize with domain controllers.  If an NTP server is configured it should synchronize with a secure, authorized time source."
          solution    : "If the system needs to be configured to an NTP server, configure the system to point to an authorized time server by setting the policy value for Computer Configuration -> Administrative Templates -> System -> Windows Time Service -> Time Providers 'Configure Windows NTP Client' to 'Enabled', and configure the 'NtpServer' field to point to an authorized time server."
          reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-001891,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29538r1_rule,STIG-ID|3.084,SWIFT-CSCv1|2.3,Vuln-ID|V-3472"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_TEXT
          value_data  : "NT5DS" || "NoSync"
          reg_key     : "HKLM\Software\Policies\Microsoft\W32Time\Parameters"
          reg_item    : "Type"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </else>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.088 - The system is not configured to use Safe DLL Search Mode."
      info        : "The default search behavior, when an application calls a function in a Dynamic Link Library (DLL), is to search the current directory followed by the directories contained in the systems path environment variable.  An unauthorized DLL inserted into an applications working directory could allow malicious code to be run on the system.  Creating the following registry key and setting the appropriate value forces the system to search the %Systemroot% for the DLL before searching the current directory or the rest of the path."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|8,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29717r1_rule,STIG-ID|3.088,SWIFT-CSCv1|2.3,Vuln-ID|V-3479"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Session Manager"
      reg_item    : "SafeDllSearchMode"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.060 - Media Player must be configured to prevent automatic checking for updates."
      info        : "Uncontrolled system updates can introduce issues to a system. The automatic check for updates performed by Windows Media Player must be disabled to ensure a constant platform and to prevent the introduction of unknown\untested software on the system."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Media Player -> 'Prevent Automatic Updates' to 'Enabled'."
      reference   : "800-171|3.14.1,800-53|SI-2,CAT|II,CCI|CCI-001812,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-40096r2_rule,STIG-ID|5.060,SWIFT-CSCv1|2.2,Vuln-ID|V-3480"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsmediaplayer"
      reg_item    : "DisableAutoupdate"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.089 - The system is not configured to meet the minimum requirement for session security for NTLM SSP based Servers."
      info        : "Microsoft has implemented a variety of security support providers for use with RPC sessions.  In a homogenous Windows environment, all of the options should be enabled and testing should be performed in a heterogeneous environment to determine the maximum-security level that provides reliable functionality."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network security- Minimum session security for NTLM SSP based (including secure RPC) servers' to 'Require NTLMv2 session security', 'Require 128-bit encryption (all options selected)."
      reference   : "800-171|3.13.8,800-53|SC-8,CAT|II,CCI|CCI-000366,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|13,CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE12,NIAv2|IE8,NIAv2|IE9,NIAv2|NS29,NIAv2|SS24,Rule-ID|SV-15981r1_rule,STIG-ID|3.089,Vuln-ID|V-3666"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [537395200..MAX]
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa\Msv1_0"
      reg_item    : "NTLMMinServerSec"
    </custom_item>

    <report type:"WARNING">
      description : "2.019 - Security-related Software Patches are not applied."
      info        : "Major software vendors release security patches and hot fixes to their products when security vulnerabilities are discovered.  It is essential that these updates be applied in a timely manner to prevent unauthorized persons from exploiting identified vulnerabilities.

The Severity code may be elevated to a Category I if patches deemed Critical have not been applied.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Apply all Microsoft security-related patches to the Windows system."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29726r1_rule,STIG-ID|2.019,Vuln-ID|V-3828"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WIN00-000001 - Windows operating systems that are no longer supported by the vendor for security updates must not be installed on a system."
      info        : "Windows operating systems that are no longer supported by Microsoft for security updates are not evaluated or updated for vulnerabilities leaving them open to potential attack. Prior to the end of support, organizations must plan for the transition to a supported operating system to ensure continued support and availability."
      solution    : "Develop a migration plan to move systems to a supported operating system.

Upgrade systems to a supported operating system prior to the end of support on 11 April 2017.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-85299r1_rule,STIG-ID|WIN00-000001,Vuln-ID|V-4107"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.092 - The system must generate an audit event when the audit log reaches a percentage of full threshold."
      info        : "Audit records may be lost if the security log becomes full.  When the audit log reaches a given percent full, an audit event is written to the security log.  An event is recorded as a success audit under the category of System.  This option may be especially useful if the audit logs are set to be cleared manually."
      solution    : "If the system is configured to send audit records directly to an audit server, or automatically archive full logs, this is NA.  This must be documented with the ISSO.
Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' to '90%' or less."
      reference   : "800-53|AU-4,8500.2|ECRR-1,CAT|III,CCI|CCI-000139,CCI|CCI-001855,CCI|CCI-001858,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-29729r2_rule,STIG-ID|3.092,Vuln-ID|V-4108"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [MIN..90]
      reg_key     : "HKLM\System\Currentcontrolset\Services\Eventlog\Security"
      reg_item    : "WarningLevel"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.094 - The system is configured to allow IP source routing."
      info        : "Protects against IP source routing spoofing."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' to 'Highest protection, source routing is completely disabled'."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|III,CCI|CCI-000366,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-29360r1_rule,STIG-ID|3.094,Vuln-ID|V-4110"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
      reg_item    : "DisableIPSourceRouting"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.095 - The system is configured to redirect ICMP."
      info        : "When disabled, forces ICMP to be routed via shortest path first."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' to 'Disabled'."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|III,CCI|CCI-000366,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-29363r1_rule,STIG-ID|3.095,Vuln-ID|V-4111"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
      reg_item    : "EnableICMPRedirect"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.104 - The system is configured to detect and configure default gateway addresses."
      info        : "Enables or disables the Internet Router Discovery Protocol (IRDP) used to detect and configure Default Gateway addresses on the computer."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' to 'Disabled'."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|III,CCI|CCI-002385,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-29366r1_rule,STIG-ID|3.104,Vuln-ID|V-4112"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
      reg_item    : "PerformRouterDiscovery"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.097 - The system is configured for a greater keep-alive time than recommended."
      info        : "Controls how often TCP sends a keep-alive packet in attempting to verify that an idle connection is still intact."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (KeepAliveTime) How often keep-alive packets are sent in milliseconds' to '300000 or 5 minutes (recommended)' or less."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|III,CCI|CCI-002385,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-29609r1_rule,STIG-ID|3.097,Vuln-ID|V-4113"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [MIN..300000]
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
      reg_item    : "KeepAliveTime"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.101 - The system must be configured to ignore NetBIOS name release requests except from WINS servers."
      info        : "Configuring the system to ignore name release requests, except from WINS servers, prevents a denial of service (DoS) attack.  The DoS consists of sending a NetBIOS name release request to the server for each entry in the server's cache, causing a response delay in the normal operation of the servers WINS resolution capability."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'MSS- (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' to 'Enabled'."
      reference   : "800-53|SC-21,CAT|III,CCI|CCI-002385,CSCv6|9,ITSG-33|SC-21,NESA|T4.5.1,Rule-ID|SV-29369r2_rule,STIG-ID|3.101,Vuln-ID|V-4116"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netbt\Parameters"
      reg_item    : "NoNameReleaseOnDemand"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.098 - The system must limit how many times unacknowledged TCP data is retransmitted."
      info        : "In a SYN flood attack, the attacker sends a continuous stream of SYN packets to a server, and the server leaves the half-open connections open until it is overwhelmed and no longer is able to respond to legitimate requests."
      solution    : "Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> 'MSS- (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted (3 recommended, 5 is default)' to '3' or less."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|III,CCI|CCI-002385,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-29372r2_rule,STIG-ID|5.098,Vuln-ID|V-4438"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [MIN..3]
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip\Parameters"
      reg_item    : "tcpmaxdataretransmissions"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.102 - This check verifies that Windows is configured to have password protection take effect within a limited time frame."
      info        : "Allowing more than several seconds makes the computer vulnerable to a potential attack from someone walking up to the console to attempt to log onto the system before the lock takes effect."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' to '5' or less."
      reference   : "800-171|3.1.10,800-53|AC-11,CAT|III,CCI|CCI-000366,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NIAv2|AM23e,Rule-ID|SV-29375r1_rule,STIG-ID|5.102,Vuln-ID|V-4442"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "[0-5]"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "ScreenSaverGracePeriod"
      reg_option  : CAN_NOT_BE_NULL
      check_type  : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.108 - Unauthorized registry paths and sub-paths are remotely accessible."
      info        : "The registry is a database for computer configuration information, much of which is sensitive. An attacker could use this to facilitate unauthorized activities. To reduce the risk of this happening, it is also lowered by the fact that the default ACLs assigned throughout the registry are fairly restrictive and they help to protect it from access by unauthorized users."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Remotely accessible registry paths and sub-paths' as specified in the Check section."
      reference   : "800-53|AC-6(7),CAT|I,CCI|CCI-001090,CSCv6|14,CSCv6|16,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-29731r1_rule,STIG-ID|3.108,Vuln-ID|V-4443"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_MULTI_TEXT
      value_data  : "System\CurrentControlSet\Control\Print\Printers" && "System\CurrentControlSet\Services\Eventlog" && "Software\Microsoft\OLAP Server" && "Software\Microsoft\Windows NT\CurrentVersion\Print" && "Software\Microsoft\Windows NT\CurrentVersion\Windows" && "System\CurrentControlSet\Control\ContentIndex" && "System\CurrentControlSet\Control\Terminal Server" && "System\CurrentControlSet\Control\Terminal Server\UserConfig" && "System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration" && "Software\Microsoft\Windows NT\CurrentVersion\Perflib" && "System\CurrentControlSet\Services\Sysmonlog"
      reg_key     : "HKLM\System\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths"
      reg_item    : "Machine"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.112 - Group Policy objects are not reprocessed if they have not changed."
      info        : "Enabling this setting and then selecting the 'Process even if the Group Policy objects have not changed' option ensures that the policies will be reprocessed even if none have been changed. This way, any unauthorized changes are forced to match the domain-based group policy settings again."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Group Policy 'Registry Policy Processing' to 'Enabled' and select the option 'Process even if the Group Policy objects have not changed'."
      reference   : "800-53|CM-3(3),CAT|II,CCI|CCI-000366,CSCv6|3.7,CSF|PR.IP-1,CSF|PR.IP-3,ITSG-33|CM-3(3),NESA|T7.5.1,Rule-ID|SV-29378r1_rule,STIG-ID|3.112,Vuln-ID|V-4448"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Group Policy\{35378Eac-683F-11D2-A89A-00C04Fbbcfa2}"
      reg_item    : "NoGPOListChanges"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.107 - A Windows system has an incorrect default DCOM authorization level. - None"
      info        : "The DCOM default authentication level has been detected to be below the required setting. If the authentication level is None, then any user can access any object on the system without authentication."
      solution    : "Fortify DCOMs default permissions.  This should be thoroughly tested to verify DCOM objects continue to function under tightened security.
Open a command prompt.
Execute 'Dcomcnfg.exe'.
In the 'Component Services' window, navigate to Component Services -> Computer -> My Computer
Right-click 'My Computer' and select 'Properties'.
Select the 'Default Properties' tab.
 Select a 'Default Authentication Level' other than 'None' or 'Call'.  For sensitive systems, an authentication level of 'Packet Privacy' is recommended.
Click OK."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-29736r2_rule,STIG-ID|5.107,SWIFT-CSCv1|2.3,Vuln-ID|V-6825"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Ole"
      reg_item    : "LegacyAuthenticationLevel"
      check_type  : CHECK_NOT_EQUAL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.107 - A Windows system has an incorrect default DCOM authorization level. - Call"
      info        : "The DCOM default authentication level has been detected to be below the required setting. If the authentication level is None, then any user can access any object on the system without authentication."
      solution    : "Fortify DCOMs default permissions.  This should be thoroughly tested to verify DCOM objects continue to function under tightened security.
Open a command prompt.
Execute 'Dcomcnfg.exe'.
In the 'Component Services' window, navigate to Component Services -> Computer -> My Computer
Right-click 'My Computer' and select 'Properties'.
Select the 'Default Properties' tab.
 Select a 'Default Authentication Level' other than 'None' or 'Call'.  For sensitive systems, an authentication level of 'Packet Privacy' is recommended.
Click OK."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-29736r2_rule,STIG-ID|5.107,SWIFT-CSCv1|2.3,Vuln-ID|V-6825"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 3
      reg_key     : "HKLM\Software\Microsoft\Ole"
      reg_item    : "LegacyAuthenticationLevel"
      check_type  : CHECK_NOT_EQUAL
    </custom_item>

    <custom_item>
      type        : REGISTRY_PERMISSIONS
      description : "5.108 - A Windows system has a writable DCOM configuration."
      info        : "A registry key for a valid DCOM object has access permissions that could allow non-administrator users to change the security settings if inadvertently set to a low level of security.  An attacker could possibly execute code under the context of the console or some other user."
      solution    : "Fortify DCOMs AppId permissions.  Any changes should be thoroughly tested so objects continue to function under tightened security.
- Open the Registry Editor.
- Navigate to HKEY_LOCAL_MACHINE\Software\Classes\Appid.
- Select the application that generated this vulnerability.
- Set the permissions for standard (non-privileged) user accounts or groups to Read only."
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29543r1_rule,STIG-ID|5.108,SWIFT-CSCv1|2.3,Vuln-ID|V-6826"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : REG_ACL
      value_data  : "DCOM"
      reg_key     : "HKLM\Software\Classes\Appid"
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "5.112 - DCOM calls are not executed under the security context of the calling user."
      info                 : "DCOM calls are executed under the security context of the calling user by default.  If the RunAs key has been altered, the DCOM calls can be executed under the user context of the currently logged in user, or as a third user.  If present, the RunAs value tells the COM Service Control Manager (SCM) the name of the account under which the server is to be activated. In addition to the account name, the COM SCM must also have the password of the account. The result of a successful logon is a security context (token) for the named account that is used as the primary token for the new COM server process. Administrators should not use this method in the evaluated configuration if accountability is required, since accountability cannot be enforced.
RunAs values will be removed."
      solution             : "Remove any RunAs values from DCOM objects in the Registry.
 Note: Windows components that have default Runas values such as Interactive User do not need to be changed. Windows components that have had a Runas value added or changed and non-Windows COM objects added to the system with Runas values need to be reviewed."
      reference            : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-29740r1_rule,STIG-ID|5.112,Vuln-ID|V-6830"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-ChildItem -Path hklm:\software\classes\appid | Where-Object {$_.Property -match 'RunAS'} | format-list"
      only_show_cmd_output : YES
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.113 - Outgoing secure channel traffic is not encrypted or signed."
      info        : "Requests sent on the secure channel are authenticated, and sensitive information (such as passwords) is encrypted, but not all information is encrypted.  If this policy is enabled, outgoing secure channel traffic will be encrypted and signed."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Domain Member- Digitally encrypt or sign secure channel data (always)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29381r1_rule,STIG-ID|3.113,Vuln-ID|V-6831"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Netlogon\Parameters"
      reg_item    : "RequireSignOrSeal"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.114 - The Windows Server SMB client is not enabled to always perform SMB packet signing."
      info        : "If this policy is enabled, it causes the Windows Server Message Block (SMB) client to perform SMB packet signing when communicating with an SMB server that is enabled or required to perform SMB packet signing."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Microsoft Network Client- Digitally sign communications (always)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29384r1_rule,STIG-ID|3.114,Vuln-ID|V-6832"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanworkstation\Parameters"
      reg_item    : "RequireSecuritySignature"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.115 - The Windows Server SMB server is not enabled to always perform SMB packet signing."
      info        : "If this policy is enabled, it causes the Windows Server Message Block (SMB) server to always perform SMB packet signing."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Microsoft Network Server- Digitally sign communications (always)' to 'Enabled'."
      reference   : "800-53|IA-3(1),CAT|II,CCI|CCI-002418,CSCv6|13,CSF|PR.AC-1,ITSG-33|IA-3(1),NESA|T5.4.3,Rule-ID|SV-29391r1_rule,STIG-ID|3.115,Vuln-ID|V-6833"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "RequireSecuritySignature"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.116 - Named Pipes and Shares can be accessed anonymously."
      info        : "This is a Category 1 finding because of the potential for gaining unauthorized system access.

Pipes are internal system communications processes.  They are identified internally by ID numbers that vary between systems.  To make access to these processes easier, these pipes are given names that do not vary between systems.

When this setting is disabled, Network shares can be accessed by any network user.  This could lead to the exposure or corruption of sensitive data."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Network access- Restrict anonymous access to Named Pipes and Shares' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001090,CSCv6|14,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-29544r1_rule,STIG-ID|3.116,Vuln-ID|V-6834"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "restrictnullsessaccess"
    </custom_item>

    <custom_item>
      type            : PASSWORD_POLICY
      description     : "4.013 - For systems utilizing a logon ID as the individual identifier, passwords must be a minimum of 14 characters in length."
      info            : "Information systems not protected with strong password schemes including passwords of minimum length provide the opportunity for anyone to crack the password thus gaining access to the system and causing the device, information, or the local network to be compromised or a denial of service."
      solution        : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Account Policies -> Password Policy -> 'Minimum password length' to at least '14' characters."
      reference       : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000205,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSCv6|16.2,CSCv6|16.5,CSCv6|5.7,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-29388r2_rule,STIG-ID|4.013,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-6836"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_DWORD
      value_data      : [14..MAX]
      password_policy : MINIMUM_PASSWORD_LENGTH
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "4.026 - To the extent system capabilities permit, system mechanisms are not implemented to enforce automatic expiration of passwords."
      info                 : "Passwords that do not expire or are reused increase the exposure of a password with greater probability of being discovered or cracked."
      solution             : "Configure all information systems to expire passwords."
      reference            : "800-53|IA-5(1),CAT|II,CCI|CCI-000199,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-29395r1_rule,STIG-ID|4.026,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-6840"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "PasswordExpires.+:.True"
      powershell_args      : "Get-WmiObject -Class Win32_UserAccount | Where-Object {$_.PasswordExpires -match 'False'} |Format-List PSComputerName,Caption,Status,PasswordExpires,Disabled,Domain,FullName,Name,LocalAccount,Lockout,PasswordChangeable,PasswordRequired,SID"
      only_show_cmd_output : NO
      check_type           : CHECK_REGEX
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - System -> Security System Extension'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Security System Extension"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - System -> System Integrity'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "System Integrity"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - System -> IPSec Driver'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|13,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "IPsec Driver"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - System -> Security State Change'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Security State Change"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Logon/Logoff -> Logon'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Logon"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Logon/Logoff -> Logoff' successes."
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success" || "Success, Failure"
      audit_policy_subcategory : "Logoff"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Logon/Logoff -> Special Logon' successes."
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|5.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success" || "Success, Failure"
      audit_policy_subcategory : "Special Logon"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Privilege Use -> Sensitive Privilege Use'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Sensitive Privilege Use"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Detailed Tracking -> Process Creation' successes."
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success" || "Success, Failure"
      audit_policy_subcategory : "Process Creation"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Policy Change -> Audit Policy Change'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|3.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Audit Policy Change"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Policy Change -> Authentication Policy Change' successes."
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|3.5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success" || "Success, Failure"
      audit_policy_subcategory : "Authentication Policy Change"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Account Management -> User Account Management'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16.4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "User Account Management"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Account Management -> Computer Account Management'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Computer Account Management"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Account Management -> Security Group Management'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Security Group Management"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Account Management -> Other Account Management Events'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16.4,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Other Account Management Events"
    </custom_item>

    <custom_item>
      type                     : AUDIT_POLICY_SUBCATEGORY
      description              : "4.008 - Auditing must be configured as required. - 'Account Logon -> Credential Validation'"
      info                     : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  Audit logs are necessary to provide a trail of evidence in case the system or network is compromised.  Collecting this data is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution                 : "Configure the system to audit subcategories as outlined below.

Open a Command Prompt with elevated privileges. (Run as administrator).
Execute the following command for each subcategory.
Auditpol /set /subcategory-'subcategory name' /success-enable(disable) /failure-enable(disable)
(Include the quotes around the subcategory name).

System
Security System Extension - Success and Failure
System Integrity - Success and Failure
IPSec Driver - Success and Failure
Security State Change - Success and Failure

Logon/Logoff
Logon - Success and Failure
Logoff - Success
Special Logon - Success

Privilege Use
Sensitive Privilege Use - Success and Failure

Detailed Tracking
Process Creation - Success

Policy Change
Audit Policy Change - Success and Failure
Authentication Policy Change - Success

Account Management
User Account Management - Success and Failure
Computer Account Management - Success and Failure
Security Group Management - Success and Failure
Other Account Management Events - Success and Failure

Account Logon
Credential Validation - Success and Failure"
      reference                : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|16.4,CSCv6|16.8,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16966r3_rule,STIG-ID|4.008,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-6850"
      see_also                 : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type               : AUDIT_SET
      value_data               : "Success, Failure"
      audit_policy_subcategory : "Credential Validation"
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "4.017 - DOD information system access does not require the use of a password."
      info                 : "The lack of password protection enables anyone to gain access to the information system, which opens a backdoor opportunity for intruders to compromise the system as well as other resources within the same administrative domain."
      solution             : "Configure all DoD information systems to require passwords to gain access.

The password required flag can be set by entering the following on a command line- 'Net user <account_name> /passwordreq-yes'."
      reference            : "800-171|3.5.7,800-53|IA-5(1),CAT|I,CCI|CCI-000764,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-29548r1_rule,STIG-ID|4.017,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-7002"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : "PasswordRequired.+:.True"
      powershell_args      : "Get-WmiObject -Class Win32_UserAccount | Where-Object {$_.PasswordRequired -match 'False'} |Format-List PSComputerName,Caption,Status,PasswordExpires,Disabled,Domain,FullName,Name,LocalAccount,Lockout,PasswordChangeable,PasswordRequired,SID"
      only_show_cmd_output : NO
      check_type           : CHECK_REGEX
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.119 - The system is configured to allow the display of the last user name on the logon screen."
      info        : "The user name of the last user to log onto a system will not be displayed.  This eliminates half of the Userid/Password equation that an unauthorized person would need to log on."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Interactive logon- Do not display last user name' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|13,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29399r1_rule,STIG-ID|3.119,SWIFT-CSCv1|2.3,Vuln-ID|V-11806"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "DontDisplayLastUserName"
    </custom_item>

    <report type:"WARNING">
      description : "3.121 - The system does not have a backup administrator account"
      info        : "The built-in administrator account, as a well known account subject to attack, is disabled by default and per STIG requirements.  Domain Admins on domain joined systems should provide sufficient availability for administering a system.  A site with limited administrators must ensure they have a contingency for administering a non-domain system.

      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create a contingency plan for administering a system in emergency situations."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29745r2_rule,STIG-ID|3.121,Vuln-ID|V-14224"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "3.122 - Administrator Passwords are changed when necessary."
      info        : "This check verifies that the passwords for the default and backup administrator accounts are changed at least annually or when any member of the administrative team leaves the organization.

      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Define a policy for required password changes for the default and backup admin account.
      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-29749r1_rule,STIG-ID|3.122,Vuln-ID|V-14225"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.123 - Auditing Access of Global System Objects must be turned off."
      info        : "This setting prevents the system from setting up a default system access control list for certain system objects, which could create a very large number of security events, filling the security log in Windows and making it difficult to identify actual issues."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Audit- Audit the access of global system objects' to 'Disabled'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|II,CCI|CCI-001095,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-29401r2_rule,STIG-ID|3.123,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14228"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "AuditBaseObjects"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.124 - Audit of Backup and Restore Privileges is not turned off."
      info        : "This policy setting stops the system from generating audit events for every file backed up or restored which could fill the Security log in Windows."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Audit- Audit the use of Backup and Restore privilege' to 'Disabled'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001095,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-29403r1_rule,STIG-ID|3.124,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14229"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_BINARY
      value_data  : 00
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "fullprivilegeauditing"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.125 - Audit policy using subcategories is enabled."
      info        : "This policy setting allows administrators to enable the more precise auditing capabilities present in Windows Vista and later."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Audit- Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings' to 'Enabled'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000169,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|6.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-14841r1_rule,STIG-ID|3.125,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14230"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Control\Lsa"
      reg_item    : "SCENoApplyLegacyAuditPolicy"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.126 - Hide Computer from the browse list."
      info        : "This check verifies Windows Vista is configured to hide the computer from the browse list."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (Hidden) Hide Computer From the Browse List' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-14842r1_rule,STIG-ID|3.126,Vuln-ID|V-14231"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Lanmanserver\Parameters"
      reg_item    : "Hidden"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.127 - IPSec Exemptions are limited."
      info        : "This check verifies that Windows is configured to limit IPSec exemptions."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'MSS- (NoDefaultExempt) Configure IPSec exemptions for various types of network traffic' to 'Multicast, broadcast and ISAKMP exempt (best for Windows XP)'."
      reference   : "800-171|3.13.8,800-53|SC-8,CAT|III,CCI|CCI-000366,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.2,NESA|T7.3.3,NESA|T7.4.1,NIAv2|IE12,NIAv2|IE8,NIAv2|IE9,NIAv2|NS29,NIAv2|SS24,Rule-ID|SV-14843r1_rule,STIG-ID|3.127,Vuln-ID|V-14232"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrolset\Services\Ipsec"
      reg_item    : "NoDefaultExempt"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.129 - User Account Control - Built In Admin Approval Mode - UAC enabled"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
          reg_item    : "EnableLUA"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "3.129 - User Account Control - Built In Admin Approval Mode"
          info        : "This check verifies whether the built-in Administrator account runs in Admin Approval Mode."
          solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Admin Approval Mode for the Built-in Administrator account' to 'Enabled'."
          reference   : "800-171|3.1.5,800-53|AC-6(5),CAT|II,CCI|CCI-002038,CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,Rule-ID|SV-14845r1_rule,STIG-ID|3.129,SWIFT-CSCv1|1.2,Vuln-ID|V-14234"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
          reg_item    : "FilterAdministratorToken"
        </custom_item>
      </then>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.130 - User Account Control - Behavior of elevation prompt for administrators"
      info        : "This check verifies whether logged on administrator is prompted for consent when he attempts to complete a task that requires raised privileges."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Behavior of the elevation prompt for administrators in Admin Approval Mode' to 'Prompt for consent'."
      reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CCI|CCI-001084,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-17457r1_rule,STIG-ID|3.130,SWIFT-CSCv1|5.1,Vuln-ID|V-14235"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "ConsentPromptBehaviorAdmin"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.131 - User Account Control - Behavior of elevation prompt for standard users."
      info        : "This check verifies whether the logged on user is prompted for credentials when attempting to complete a task that requires raised privileges."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Behavior of the elevation prompt for standard users'  to 'Prompt for credentials'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-002038,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-14847r1_rule,STIG-ID|3.131,Vuln-ID|V-14236"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "ConsentPromptBehaviorUser"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.132 - User Account Control - Detect Application Installations"
      info        : "This check verifies whether Windows responds to application installation requests by prompting for credentials."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Detect application installations and prompt for elevation' to 'Enabled'."
      reference   : "800-53|AC-6(8),CAT|II,CCI|CCI-001084,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-14848r1_rule,STIG-ID|3.132,Vuln-ID|V-14237"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "EnableInstallerDetection"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.134 - User Account Control - Elevate UIAccess applications that are in secure locations"
      info        : "This check verifies whether Windows only allows applications installed in a secure location, such as the Program Files or the Windows\System32 folders, on the file system to run with elevated privileges."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Only elevate UIAccess applications that are installed in secure locations' to 'Enabled'."
      reference   : "800-53|AC-6(8),CAT|II,CCI|CCI-001084,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-14850r1_rule,STIG-ID|3.134,Vuln-ID|V-14239"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "EnableSecureUIAPaths"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.137 - User Account Control - Run all admins in Admin Approval Mode"
      info        : "This check verifies that UAC has not been disabled."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Run all administrators in Admin Approval Mode' to 'Enabled'."
      reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CCI|CCI-002038,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-14851r1_rule,STIG-ID|3.137,SWIFT-CSCv1|5.1,Vuln-ID|V-14240"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "EnableLUA"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.135 - User Account Control - Switch to secure desktop"
      info        : "This check verifies that the elevation prompt is only used in secure desktop mode."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Switch to the secure desktop when prompting for elevation' to 'Enabled'."
      reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CCI|CCI-001084,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-14852r1_rule,STIG-ID|3.135,SWIFT-CSCv1|5.1,Vuln-ID|V-14241"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "PromptOnSecureDesktop"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.136 - User Account Control - Non UAC Compliant Application Virtualization"
      info        : "This check verifies that non UAC compliant applications will run in virtualized file and registry entries allowing them to run."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'User Account Control- Virtualize file and registry write failures to per-user locations' to 'Enabled'."
      reference   : "800-53|SC-29(1),CAT|II,CCI|CCI-001084,Rule-ID|SV-14853r1_rule,STIG-ID|3.136,Vuln-ID|V-14242"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "EnableVirtualization"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.132 - Require username and password to elevate a running application."
      info        : "This check verifies that the system is configured to always require users to type in a user name and password to elevate a running application."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Credential User Interface 'Enumerate administrator accounts on elevation' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001084,CSCv6|16,CSF|PR.AC-4,Rule-ID|SV-14854r1_rule,STIG-ID|5.132,Vuln-ID|V-14243"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Credui"
      reg_item    : "EnumerateAdministrators"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.116 - Terminal Services / Remote Desktop Service - Prevent password saving in the Remote Desktop Client"
      info        : "This check verifies that the system is configured to prevent Users from saving passwords in the Remote Desktop Client."
      solution    : "Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services-> Remote Desktop Connection Client 'Do not allow passwords to be saved' to 'Enabled'."
      reference   : "800-53|IA-5(13),CAT|II,CCI|CCI-002038,CSCv6|16.4,CSF|PR.AC-1,Rule-ID|SV-29405r1_rule,STIG-ID|5.116,Vuln-ID|V-14247"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "DisablePasswordSaving"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.117 - Users must be prevented from connecting using Terminal Services."
      info        : "Allowing a Terminal Services session to a workstation enables another avenue of access that could be exploited.  The system must be configured to prevent users from connecting to a computer using Terminal Services."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Connections 'Allow users to connect remotely using Terminal Services' to 'Disabled."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002314,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-14859r2_rule,STIG-ID|5.117,SWIFT-CSCv1|2.3,Vuln-ID|V-14248"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "fDenyTSConnections"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.118 - Terminal Services / Remote Desktop Services - Local drives prevented from sharing with Terminal Servers."
      info        : "This check verifies that the system is configured to prevent users from sharing the local drives on their client computers to Terminal Servers that they access."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Terminal Services -> Terminal Server -> Device and Resource Redirection 'Do not allow drive redirection' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-001090,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|13,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-14860r1_rule,STIG-ID|5.118,SWIFT-CSCv1|2.3,Vuln-ID|V-14249"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "fDisableCdm"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.123 - Restrict unauthenticated RPC clients."
      info        : "This check verifies that the system is configured to restrict unauthenticated RPC clients from connecting to the RPC server."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Remote Procedure Call 'Restrictions for Unauthenticated RPC clients' to 'Enabled' and 'Authenticated'."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CCI|CCI-001967,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|9.1,CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-29408r1_rule,STIG-ID|5.123,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-14253"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Rpc"
      reg_item    : "RestrictRemoteClients"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.124 - Client computers required to authenticate for RPC communication."
      info        : "This check verifies that the system is configured to force client computers to provide authentication before an RPC communication is established."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Remote Procedure Call 'RPC Endpoint Mapper Client Authentication' to 'Enabled."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CCI|CCI-001967,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSCv6|9.1,CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,Rule-ID|SV-29410r1_rule,STIG-ID|5.124,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-14254"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Rpc"
      reg_item    : "EnableAuthEpResolution"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.125 - File and Folder Publish to Web option unavailable."
      info        : "This check verifies that the system is configured to make the options to publish to the web unavailable from File and Folder Tasks in Windows folders."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off the 'Publish to Web' task for files and folders' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|13,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29412r1_rule,STIG-ID|5.125,SWIFT-CSCv1|2.3,Vuln-ID|V-14255"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "NoPublishingWizard"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.126 - Web Publishing and online ordering wizards prevented from downloading list of providers."
      info        : "This check verifies that the system is configured to prevent Windows from downloading a list of providers for the Web publishing and online ordering wizards."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off Internet download for Web publishing and online ordering wizards' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|7,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29415r1_rule,STIG-ID|5.126,SWIFT-CSCv1|2.3,Vuln-ID|V-14256"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "NoWebServices"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.127 - Windows Messenger prevented from collecting anonymous information."
      info        : "This check verifies that the system is configured to prevent Windows Messenger from collecting anonymous information about how the Windows Messenger software and service is used."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off the Windows Messenger Customer Experience Improvement Program' to 'Enabled'."
      reference   : "800-171|3.4.8,800-53|CM-7(5),CAT|II,CCI|CCI-000381,CSCv6|13,CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,Rule-ID|SV-29417r1_rule,STIG-ID|5.127,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-14257"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Policies\Microsoft\Messenger\Client"
      reg_item    : "CEIP"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.128 - Search Companion prevented from automatically downloading content updates."
      info        : "This check verifies that the system is configured to prevent Search Companion from automatically downloading content updates during local and Internet searches."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off Search Companion content file updates' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-001812,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-29419r1_rule,STIG-ID|5.128,SWIFT-CSCv1|2.3,Vuln-ID|V-14258"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Searchcompanion"
      reg_item    : "DisableContentFileUpdates "
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.129 - Prevent printing over HTTP."
      info        : "This check verifies that the system is configured to prevent the client computer's ability to print over HTTP, which allows the computer to print to printers on the intranet as well as the Internet."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off printing over HTTP' to 'Enabled'."
      reference   : "800-171|3.4.8,800-53|CM-7(5),CAT|II,CCI|CCI-000381,CSCv6|13.1,CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,Rule-ID|SV-29421r1_rule,STIG-ID|5.129,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-14259"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Printers"
      reg_item    : "DisableHTTPPrinting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.130 - Computer prevented from downloading print driver packages over HTTP."
      info        : "This check verifies that the system is configured to prevent the computer from downloading print driver packages over HTTP."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off downloading of print drivers over HTTP' to 'Enabled'."
      reference   : "800-171|3.13.1,800-53|SC-7(14),CAT|II,CCI|CCI-000381,CN-L3|8.1.3.1(b),CN-L3|8.1.3.1(c),CSCv6|2,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|SC-7(14),NIAv2|CS1,NIAv2|CS2,NIAv2|CS3,NIAv2|NS5b,NIAv2|PH6,Rule-ID|SV-29423r1_rule,STIG-ID|5.130,SWIFT-CSCv1|2.1,Vuln-ID|V-14260"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Printers"
      reg_item    : "DisableWebPnPDownload"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.131 - Windows is prevented from using Windows Update to search for drivers."
      info        : "This check verifies that the system is configured to prevent Windows from searching Windows Update for device drivers when no local drivers for a device are present."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication setting 'Turn off Windows Update device driver searching' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001812,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29425r1_rule,STIG-ID|5.131,SWIFT-CSCv1|2.3,Vuln-ID|V-14261"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Driversearching"
      reg_item    : "DontSearchWindowsUpdate"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.050 - IPv6 must be disabled until a deliberate transition strategy has been implemented."
      info        : "Any nodes' interface with IPv6 enabled by default presents a potential risk of traffic being transmitted or received without proper risk mitigation strategy and is therefore, a serious security concern."
      solution    : "Add the following registry values to the system.

To disable IPv6 on all interfaces-

Registry Hive-  HKEY_LOCAL_MACHINE
Registry Path-  \SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\

Value Name-  DisabledComponents

Type-  REG_DWORD
Value-  0xff or 0xffffffff

To disable all IPv6 tunneling interfaces-

Registry Hive-  HKEY_LOCAL_MACHINE
Registry Path-  \SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\

Value Name-  DisabledComponents

Type-  REG_DWORD
Value-  0x1

Microsoft updated article 929852 with regard to disabling all IPv6 components, changing the value to 0xff.   A value of 0xffffffff results in a 5-second delay in system startup.  However, either value can be used to disable all IPv6 components."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CAT|II,CCI|CCI-000366,CSCv6|9,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-14873r3_rule,STIG-ID|5.050,Vuln-ID|V-14262"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 255 || 4294967295
      reg_key     : "HKLM\System\Currentcontrolset\Services\Tcpip6\Parameters"
      reg_item    : "DisabledComponents"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.134 - Preserve Zone information when saving attachments."
      info                 : "This check verifies that file attachments are marked with their zone of origin allowing Windows to determine risk."
      solution             : "Configure the policy value for User Configuration -> Administrative Templates -> Windows Components -> Attachment Manager -> 'Do not preserve zone information in file attachments' to 'Disabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29753r1_rule,STIG-ID|5.134,SWIFT-CSCv1|2.3,Vuln-ID|V-14268"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 2
      reg_key              : "HKU\Software\Microsoft\Windows\Currentversion\Policies\Attachments"
      reg_item             : "SaveZoneInformation"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.135 - Hide mechanism for removing Zone information from file attachments."
      info                 : "This check verifies that users cannot manually remove zone information from saved file attachments."
      solution             : "Configure the policy value for User Configuration -> Administrative Templates -> Windows Components -> Attachment Manager -> 'Hide mechanisms to remove zone information' to 'Enabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29755r1_rule,STIG-ID|5.135,SWIFT-CSCv1|2.3,Vuln-ID|V-14269"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 1
      reg_key              : "HKU\Software\Microsoft\Windows\Currentversion\Policies\Attachments"
      reg_item             : "HideZoneInfoOnProperties"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.136 - Notify antivirus when file attachments are opened."
      info                 : "This check verifies that antivirus programs are notified when a user opens a file attachment."
      solution             : "Configure policy value for User Configuration -> Administrative Templates -> Windows Components -> Attachment Manager -> 'Notify antivirus programs when opening attachments' to 'Enabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|7.8,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29757r1_rule,STIG-ID|5.136,SWIFT-CSCv1|2.3,Vuln-ID|V-14270"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 3
      reg_key              : "HKU\Software\Microsoft\Windows\Currentversion\Policies\Attachments"
      reg_item             : "ScanWithAntiVirus"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <report type:"WARNING">
      description : "4.018 - Application account passwords length and change requirement"
      info        : "Setting application accounts to expire may cause applications to stop functioning. The site will have a policy that application account passwords manually generated and entered by a system administrator are changed at least annually or when a system administrator with knowledge of the password leaves the organization. Application/service account passwords will be at least 15 characters and follow complexity requirements for all passwords.

      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create application/service account passwords that are at least 15 characters in length and meet complexity requirements. Change application/service account passwords that are manually generated and entered by a system administrator at least annually or whenever an administrator with knowledge of the password leaves the organization."
      reference   : "CAT|II,CCI|CCI-000205,CCI|CCI-002142,Rule-ID|SV-29336r1_rule,STIG-ID|4.018,Vuln-ID|V-14271"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : FILE_VERSION
      description : "5.140 - The HBSS McAfee Agent is not installed. - FrameworkService"
      info        : ""
      solution    : "Deploy the McAfee Agent as detailed in accordance with the DoD HBSS STIG."
      reference   : "800-171|3.14.1,800-53|SI-2(5),CAT|II,CCI|CCI-000366,CSF|ID.RA-1,CSF|PR.IP-12,NIAv2|NS26b,Rule-ID|SV-29559r2_rule,STIG-ID|5.140,SWIFT-CSCv1|2.2,Vuln-ID|V-15505"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_FILE_VERSION
      value_data  : "4.0.0.0"
      file        : "%programfiles%\McAfee\Common Framework\FrameworkService.exe"
      check_type  : CHECK_GREATER_THAN_OR_EQUAL
    </custom_item>

    <custom_item>
      type        : FILE_VERSION
      description : "5.140 - The HBSS McAfee Agent is not installed. - masvc"
      info        : ""
      solution    : "Deploy the McAfee Agent as detailed in accordance with the DoD HBSS STIG."
      reference   : "800-171|3.14.1,800-53|SI-2(5),CAT|II,CCI|CCI-000366,CSF|ID.RA-1,CSF|PR.IP-12,NIAv2|NS26b,Rule-ID|SV-29559r2_rule,STIG-ID|5.140,SWIFT-CSCv1|2.2,Vuln-ID|V-15505"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_FILE_VERSION
      value_data  : "5.0.0.0"
      file        : "%programfiles%\McAfee\Common Framework\masvc.exe"
      check_type  : CHECK_GREATER_THAN_OR_EQUAL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.202 - Windows Peer to Peer Networking"
      info        : "This check verifies Microsoft Peer-to-Peer Networking Service is turned off."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Microsoft Peer-to-Peer Networking Services 'Turn Off Microsoft Peer-to-Peer Networking Services' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-29427r1_rule,STIG-ID|5.202,SWIFT-CSCv1|2.3,Vuln-ID|V-15666"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Peernet"
      reg_item    : "Disabled"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.203 - Prohibit Network Bridge in Windows"
      info        : "This check verifies the Network Bridge can not be installed and configured."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Network Connections 'Prohibit installation and configuration of Network Bridge on your DNS domain network' to 'Enabled'."
      reference   : "800-171|3.1.3,800-53|AC-4,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.2(c),CSCv6|5.1,CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,Rule-ID|SV-29429r1_rule,STIG-ID|5.203,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-15667"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Network Connections"
      reg_item    : "NC_AllowNetBridge_NLA"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.214 - Event Viewer Events.asp Links"
      info        : "This check verifies that Events.asp hyperlinks in Event Viewer are available."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Event Viewer 'Events.asp' links' to 'Disabled'."
      reference   : "800-171|3.4.7,800-53|CM-7(2),CAT|III,CCI|CCI-000381,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),Rule-ID|SV-29435r1_rule,STIG-ID|5.214,SWIFT-CSCv1|2.3,Vuln-ID|V-15672"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Eventviewer"
      reg_item    : "MicrosoftEventVwrDisableLinks"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.216 - Internet Connection Wizard ISP Downloads"
      info        : "This check verifies that the Internet Connection Wizard cannot download a list of Internet Service Providers (ISPs) from Microsoft."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000381,CSCv6|13,CSF|PR.AC-4,Rule-ID|SV-29436r1_rule,STIG-ID|5.216,Vuln-ID|V-15673"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Internet Connection Wizard"
      reg_item    : "ExitOnMSICW"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.217 - Disable Internet File Association Service"
      info        : "This check verifies that unhandled file associations will not use the Microsoft Web service to find an application."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Internet File Association service' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|7,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29438r1_rule,STIG-ID|5.217,SWIFT-CSCv1|2.3,Vuln-ID|V-15674"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "NoInternetOpenWith"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.218 - Windows Registration Wizard"
      info        : "This check verifies that the Windows Registration Wizard is blocked from online registration."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Registration if URL connection is referring to Microsoft.com' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000381,CSF|PR.AC-4,Rule-ID|SV-29440r1_rule,STIG-ID|5.218,Vuln-ID|V-15675"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Registration Wizard Control"
      reg_item    : "NoRegistration"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.219 - Order Prints Online"
      info        : "This check verifies that the 'Order Prints Online' task is not available in Windows Explorer."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off the 'Order Prints' picture task' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|13,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29613r1_rule,STIG-ID|5.219,SWIFT-CSCv1|2.3,Vuln-ID|V-15676"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "NoOnlinePrintsWizard"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.220 - Windows Movie Maker Codec Downloads"
      info        : "This check verifies that the codecs will not be automatically downloaded for Windows Movie Maker."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Windows Movie Maker automatic codec downloads' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-29442r1_rule,STIG-ID|5.220,SWIFT-CSCv1|2.3,Vuln-ID|V-15677"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsmoviemaker"
      reg_item    : "CodecDownload"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.221 - Windows Movie Maker Web Links"
      info        : "This check verifies that the links to web sites in Windows Movie Maker will not be available."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Windows Movie Maker online Web links' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-29444r1_rule,STIG-ID|5.221,SWIFT-CSCv1|2.3,Vuln-ID|V-15678"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsmoviemaker"
      reg_item    : "Webhelp"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.222 - Windows Movie Maker Online Hosting"
      info        : "This check verifies that movies can not be sent to a video hosting provider on the web."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication settings 'Turn off Windows Movie Maker saving to online video hosting provider' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-29446r1_rule,STIG-ID|5.222,SWIFT-CSCv1|2.3,Vuln-ID|V-15679"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsmoviemaker"
      reg_item    : "WebPublish"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.231 - Attachments must be prevented from being downloaded from RSS feeds."
      info        : "Attachments from RSS feeds may not be secure.  This setting will prevent attachments from being downloaded from RSS feeds."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> RSS Feeds -> 'Turn off downloading of enclosures' to 'Enabled'."
      reference   : "800-171|3.13.13,800-53|SC-18(3),CAT|II,CCI|CCI-000366,CSCv6|13,CSF|DE.CM-5,ITSG-33|SC-18(3),NIAv2|NS26f,Rule-ID|SV-29450r2_rule,STIG-ID|5.231,Vuln-ID|V-15682"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Feeds"
      reg_item    : "DisableEnclosureDownload"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.240 - Windows Explorer - Shell Protocol Protected Mode"
      info        : "This check verifies that the shell protocol is run in protected mode.  (This allows applications to only open limited folders.)"
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Explorer 'Turn off shell protocol protected mode' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|8.4,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29452r1_rule,STIG-ID|5.240,SWIFT-CSCv1|2.3,Vuln-ID|V-15683"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item    : "PreXPSP2ShellProtocolBehavior"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.241 - Windows Installer - IE Security Prompt"
      info        : "This check verifies that users are notified if a web-based program attempts to install software."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Installer 'Disable IE security prompt for Windows Installer scripts' to 'Disabled'."
      reference   : "800-53|CM-11(1),CAT|II,CCI|CCI-000366,CSCv6|7,CSF|DE.CM-3,Rule-ID|SV-29454r1_rule,STIG-ID|5.241,Vuln-ID|V-15684"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Installer"
      reg_item    : "SafeForScripting"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.242 - Windows Installer - User Control"
      info        : "This check verifies that users are prevented from changing installation options."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Installer 'Enable user control over installs' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-001812,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-29456r1_rule,STIG-ID|5.242,Vuln-ID|V-15685"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Installer"
      reg_item    : "EnableUserControl"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.243 - Windows Installer - Vendor Signed Updates"
      info        : "This check verifies that users are prevented applying vendor signed updates."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Installer 'Prohibit non-administrators from applying vendor signed updates' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-001812,CSF|PR.AC-4,Rule-ID|SV-29458r1_rule,STIG-ID|5.243,Vuln-ID|V-15686"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Installer"
      reg_item    : "DisableLUAPatching"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.248 - Media Player - First Use Dialog Boxes"
      info        : "This check verifies that users are not presented with Privacy and Installation options on first use of Windows Media Player."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Media Player 'Do Not Show First Use Dialog Boxes' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-29460r1_rule,STIG-ID|5.248,SWIFT-CSCv1|2.3,Vuln-ID|V-15687"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsmediaplayer"
      reg_item    : "GroupPrivacyAcceptance"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REG_CHECK
          description : "Check for LLTD configuration"
          value_type  : POLICY_TEXT
          value_data  : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
          reg_option  : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.200 - Network - Mapper I/O Driver - AllowLLTDIOOndomain"
          info        : "This check verifies that the Mapper I/O network protocol driver is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Mapper I/O (LLTDIO) driver' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16635r1_rule,STIG-ID|5.200,SWIFT-CSCv1|2.3,Vuln-ID|V-15696"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
          reg_item    : "AllowLLTDIOOndomain"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.200 - Network - Mapper I/O Driver - AllowLLTDIOOnPublicNet"
          info        : "This check verifies that the Mapper I/O network protocol driver is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Mapper I/O (LLTDIO) driver' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16635r1_rule,STIG-ID|5.200,SWIFT-CSCv1|2.3,Vuln-ID|V-15696"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
          reg_item    : "AllowLLTDIOOnPublicNet"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.200 - Network - Mapper I/O Driver - EnableLLTDIO"
          info        : "This check verifies that the Mapper I/O network protocol driver is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Mapper I/O (LLTDIO) driver' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16635r1_rule,STIG-ID|5.200,SWIFT-CSCv1|2.3,Vuln-ID|V-15696"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
          reg_item    : "EnableLLTDIO"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.200 - Network - Mapper I/O Driver - ProhibitLLTDIOOnPrivateNet"
          info        : "This check verifies that the Mapper I/O network protocol driver is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Mapper I/O (LLTDIO) driver' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16635r1_rule,STIG-ID|5.200,SWIFT-CSCv1|2.3,Vuln-ID|V-15696"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
          reg_item    : "ProhibitLLTDIOOnPrivateNet"
        </custom_item>
      </then>

      <else>
        <report type:"FAILED">
          description : "5.200 - Disable the Mapper I/O Driver."
          info        : "This check verifies that the Mapper I/O network protocol driver is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Mapper I/O (LLTDIO) driver' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,Rule-ID|SV-16635r1_rule,STIG-ID|5.200,Vuln-ID|V-15696"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.201 - Network - Responder Driver - AllowRspndrOndomain"
      info        : "This check verifies that the Responder network protocol driver is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Responder (RSPNDR) driver' to 'Disabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16636r1_rule,STIG-ID|5.201,SWIFT-CSCv1|2.3,Vuln-ID|V-15697"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
      reg_item    : "AllowRspndrOndomain"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.201 - Network - Responder Driver - AllowRspndrOnPublicNet"
      info        : "This check verifies that the Responder network protocol driver is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Responder (RSPNDR) driver' to 'Disabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16636r1_rule,STIG-ID|5.201,SWIFT-CSCv1|2.3,Vuln-ID|V-15697"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
      reg_item    : "AllowRspndrOnPublicNet"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.201 - Network - Responder Driver - EnableRspndr"
      info        : "This check verifies that the Responder network protocol driver is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Responder (RSPNDR) driver' to 'Disabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16636r1_rule,STIG-ID|5.201,SWIFT-CSCv1|2.3,Vuln-ID|V-15697"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
      reg_item    : "EnableRspndr"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.201 - Network - Responder Driver - ProhibitRspndrOnPrivateNet"
      info        : "This check verifies that the Responder network protocol driver is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Link-Layer Topology Discovery 'Turn on Responder (RSPNDR) driver' to 'Disabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16636r1_rule,STIG-ID|5.201,SWIFT-CSCv1|2.3,Vuln-ID|V-15697"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Lltd"
      reg_item    : "ProhibitRspndrOnPrivateNet"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REG_CHECK
          description : "Check for WCN configuration"
          value_type  : POLICY_TEXT
          value_data  : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_option  : MUST_EXIST
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.206 - Network - Windows Connect Now Wireless Configuration - DisableFlashConfigRegistrar"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|15.4,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,SWIFT-CSCv1|2.3,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_item    : "DisableFlashConfigRegistrar"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.206 - Network - Windows Connect Now Wireless Configuration - DisableInBand802DOT11Registrar"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|15.4,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,SWIFT-CSCv1|2.3,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_item    : "DisableInBand802DOT11Registrar"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.206 - Network - Windows Connect Now Wireless Configuration - DisableUPnPRegistrar"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|15.4,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,SWIFT-CSCv1|2.3,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_item    : "DisableUPnPRegistrar"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.206 - Network - Windows Connect Now Wireless Configuration - DisableWPDRegistrar"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|15.4,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,SWIFT-CSCv1|2.3,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_item    : "DisableWPDRegistrar"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.206 - Network - Windows Connect Now Wireless Configuration - EnableRegistrars"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|15.4,CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,SWIFT-CSCv1|2.3,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Registrars"
          reg_item    : "EnableRegistrars"
        </custom_item>
      </then>

      <else>
        <report type:"FAILED">
          description : "5.206 - Network - Windows Connect Now Wireless Configuration"
          info        : "This check verifies that the configuration of wireless devices using Windows Connect Now is disabled."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Configuration of wireless settings using Windows Connect Now' to 'Disabled'."
          reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-16637r1_rule,STIG-ID|5.206,Vuln-ID|V-15698"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.207 - Network - Windows Connect Now Wizards"
      info        : "This check verifies that access to the Windows Connect Now wizards is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Network -> Windows Connect Now 'Prohibit Access of the Windows Connect Now wizards' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|15.4,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16638r1_rule,STIG-ID|5.207,SWIFT-CSCv1|2.3,Vuln-ID|V-15699"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Wcn\Ui"
      reg_item    : "DisableWcnUi"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.208 - Device Install - PnP Interface Remote Access"
      info        : "This check verifies that remote access to the Plug and Play interface is disabled."
      solution    : "Vista -  Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Device Installation 'Allow remote access to the PnP interface' to 'Disabled'."
      reference   : "800-53|AC-6(3),CAT|II,CCI|CCI-000381,CSCv6|9.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,Rule-ID|SV-16639r1_rule,STIG-ID|5.208,SWIFT-CSCv1|5.1,Vuln-ID|V-15700"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Deviceinstall\Settings"
      reg_item    : "AllowRemoteRPC"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.209 - Device Install - Drivers System Restore Point"
      info        : "This check verifies that a system restore point will be created when a new device driver is installed."
      solution    : "Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Device Installation 'Do not create a system restore point when new device driver installed' to 'Disabled'."
      reference   : "800-171|3.8.9,800-53|CP-9,8500.2|ECSC-1,CAT|III,CCI|CCI-000366,CSF|PR.IP-4,ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4,Rule-ID|SV-16640r1_rule,STIG-ID|5.209,Vuln-ID|V-15701"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Deviceinstall\Settings"
      reg_item    : "DisableSystemRestore"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.210 - Device Install - Generic Driver Error Report"
      info        : "This check verifies that an Error Report will not be sent when a generic device driver is installed."
      solution    : "Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Device Installation 'Do not send a Windows Error Report when a generic driver is installed on a system' to 'Enabled'."
      reference   : "800-53|SI-11,CAT|III,CCI|CCI-000381,ITSG-33|SI-11,Rule-ID|SV-16641r1_rule,STIG-ID|5.210,Vuln-ID|V-15702"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Deviceinstall\Settings"
      reg_item    : "DisableSendGenericDriverNotFoundToWER"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.211 - Driver Install - Device Driver Search Prompt"
      info        : "This check verifies that users will not be prompted to search Windows Updated for device drivers."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Driver Installation 'Turn off Windows Update device driver search prompt' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-001812,CSF|PR.AC-4,Rule-ID|SV-16642r1_rule,STIG-ID|5.211,Vuln-ID|V-15703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Driversearching"
      reg_item    : "DontPromptForWindowsUpdate"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.215 - Handwriting Recognition Error Reporting (Tablet PCs)"
      info        : "This check verifies that errors in handwriting recognition on Tablet PCs are not reported to Microsoft."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communications settings 'Turn off handwriting recognition error reporting' to 'Enabled'."
      reference   : "800-53|SI-11,CAT|III,CCI|CCI-000381,CSCv6|13,ITSG-33|SI-11,Rule-ID|SV-16643r1_rule,STIG-ID|5.215,Vuln-ID|V-15704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Handwritingerrorreports"
      reg_item    : "PreventHandwritingErrorReports"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.224 - Power Mgmt - Password Wake on Battery"
      info        : "This check verifies that the user is prompted for a password on resume from sleep (on battery)."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Power Management -> Sleep Settings 'Require a Password When a Computer Wakes (On Battery)' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002038,CN-L3|8.1.10.6(d),CSCv6|13.2,CSCv6|16.5,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16644r1_rule,STIG-ID|5.224,SWIFT-CSCv1|2.3,Vuln-ID|V-15705"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Power\Powersettings\0E796Bdb-100D-47D6-A2D5-F7D2Daa51F51"
      reg_item    : "DCSettingIndex"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.225 - Power Mgmt - Password Wake When Plugged In"
      info        : "This check verifies that the user is prompted for a password on resume from sleep (Plugged In)."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Power Management -> Sleep Settings 'Require a Password When a Computer Wakes (Plugged In)' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002038,CN-L3|8.1.10.6(d),CSCv6|13.2,CSCv6|16.5,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16645r1_rule,STIG-ID|5.225,SWIFT-CSCv1|2.3,Vuln-ID|V-15706"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Power\Powersettings\0E796Bdb-100D-47D6-A2D5-F7D2Daa51F51"
      reg_item    : "ACSettingIndex"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.226 - Remote Assistance - Session Logging"
      info        : "This check verifies that Remote Assistance log files will be generated."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Remote Assistance 'Turn on session logging' to 'Enabled'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|III,CCI|CCI-000366,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16646r1_rule,STIG-ID|5.226,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-15707"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Terminal Services"
      reg_item    : "LoggingEnabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.227 - Digital Locker"
      info        : "This check verifies that Digital Locker, a dedicated download manager can not run."
      solution    : "Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Digital Locker 'Do not allow Digital Locker to run' to 'Enabled'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-16647r2_rule,STIG-ID|5.227,SWIFT-CSCv1|2.3,Vuln-ID|V-15708"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Digital Locker"
      reg_item    : "DoNotRunDigitalLocker"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.228 - Game Explorer Information Downloads"
      info        : "This check verifies that game information is not downloaded from Windows Metadata Services."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Game Explorer 'Turn off downloading of game information' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-16648r1_rule,STIG-ID|5.228,Vuln-ID|V-15709"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Gameux"
      reg_item    : "DownloadGameInfo"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.230 - Online Assistance - Untrusted Content"
      info        : "This check verifies that untrusted content is not rendered for online assistance."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Online Assistance 'Turn off Untrusted Content' to 'Enabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-16649r2_rule,STIG-ID|5.230,SWIFT-CSCv1|2.3,Vuln-ID|V-15710"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Assistance\Client\1.0"
      reg_item    : "NoUntrustedContent"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.232 - Search - Encrypted Files Indexing"
      info        : "This check verifies that encrypted files are not indexed."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Search 'Allow indexing of encrypted files' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSCv6|13.1,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16650r1_rule,STIG-ID|5.232,SWIFT-CSCv1|2.3,Vuln-ID|V-15711"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Search"
      reg_item    : "AllowIndexingEncryptedStoresOrItems"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.233 - Indexing of mail items in Exchange folders when Outlook is running in uncached mode must be turned off."
      info        : "Indexing of encrypted items may expose sensitive data.  This setting prevents mail items in a Microsoft Exchange folder from being indexed when Outlook is running in uncached mode."
      solution    : "If Outlook is not installed on the system, this is NA.
If Outlook is installed on the system, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Search -> 'Enable indexing uncached Exchange folders' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|III,CCI|CCI-000381,CSF|PR.AC-4,Rule-ID|SV-16651r2_rule,STIG-ID|5.233,Vuln-ID|V-15712"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Search"
      reg_item    : "PreventIndexingUncachedExchangeFolders"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.234 - Defender - SpyNet Reporting"
      info        : "This check verifies that SpyNet membership is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Defender 'Configure Microsoft Spynet Reporting' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000381,CSF|PR.AC-4,Rule-ID|SV-16652r1_rule,STIG-ID|5.234,Vuln-ID|V-15713"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet"
      reg_item    : "SpynetReporting"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000003 - The system must be configured to save Error Reporting events and messages to the system event log."
      info        : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises that have occurred, as well as detect attacks.  This setting ensures that Error Reporting events will be saved in the system event log."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> 'Disable logging' to 'Disabled'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|13,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-16653r2_rule,STIG-ID|WINER-000003,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-15714"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "LoggingDisabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000002 - The system must be configured to generate error reports."
      info        : "Enabling Windows Error Reporting generates information useful to system administrators and forensics analysts for diagnosing system problems and investigating intrusions.  If Windows Error Reporting is turned off, valuable system diagnostic and vulnerability information may be lost."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> 'Disable Windows Error Reporting' to 'Disabled'."
      reference   : "800-53|SI-11,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,ITSG-33|SI-11,Rule-ID|SV-16654r3_rule,STIG-ID|WINER-000002,Vuln-ID|V-15715"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "Disabled"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000004 - The system must be configured to allow a local or DOD-wide collector to request additional error reporting."
      info        : "Sending additional error reporting data provides valuable system diagnostic and vulnerability information that would otherwise not be generated nor collected.  This setting controls whether additional data in support of error reports can be sent to a local or DOD-wide reporting site."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> 'Do not send additional data' to 'Disabled'."
      reference   : "800-53|SI-11,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,ITSG-33|SI-11,Rule-ID|SV-16656r2_rule,STIG-ID|WINER-000004,Vuln-ID|V-15717"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "DontSendAdditionalData"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.239 - Windows Explorer - Heap Termination"
      info        : "This check verifies that heap termination on corruption is disabled.  This may prevent Windows Explorer from terminating immediately from certain legacy plug-in applications."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Explorer 'Turn off heap termination on corruption' to 'Disabled'."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-002385,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|8.4,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16657r2_rule,STIG-ID|5.239,SWIFT-CSCv1|2.3,Vuln-ID|V-15718"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Explorer"
      reg_item    : "NoHeapTerminationOnCorruption"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.245 - Windows Mail - Communities"
      info        : "This check verifies that Windows Mail will not check newsgroups for Communities support."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Mail 'Turn off the communities features' to 'Enabled'"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-16659r2_rule,STIG-ID|5.245,SWIFT-CSCv1|2.3,Vuln-ID|V-15720"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Mail"
      reg_item    : "DisableCommunities"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.246 - Windows Mail - Disable Application"
      info        : "This check verifies that Windows Mail will be disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Mail 'Turn off Windows Mail application' to 'Enabled'"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-16660r2_rule,STIG-ID|5.246,SWIFT-CSCv1|2.3,Vuln-ID|V-15721"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows Mail"
      reg_item    : "ManualLaunchAllowed"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.247 - Media DRM - Internet Access"
      info        : "This check verifies that Windows Media Digital Rights Management will be prevented from accessing the internet."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Media Digital Rights Management 'Prevent Windows Media DRM Internet Access' to 'Enabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000381,CSF|PR.AC-4,Rule-ID|SV-16661r1_rule,STIG-ID|5.247,Vuln-ID|V-15722"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Wmdrm"
      reg_item    : "DisableOnline"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "5.249 - Meeting Space"
      info        : "This check verifies that Windows Meeting Space is disabled."
      solution    : "Vista - Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Meeting Space 'Turn off Windows Meeting Space' to 'Enabled'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-16662r2_rule,STIG-ID|5.249,SWIFT-CSCv1|2.3,Vuln-ID|V-15723"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Collaboration"
      reg_item    : "TurnOffWindowsCollaboration"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.250 - Unsigned gadgets must not be installed."
          value_type  : POLICY_DWORD
          value_data  : 0
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Windows\Sidebar"
          reg_item    : "TurnOffSidebar"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.250 - Unsigned gadgets must not be installed. - TurnOffUnsignedGadgets"
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents unsigned gadgets from being installed."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar ->  'Disable unpacking and installation of gadgets that are not digitally signed' to 'Enabled'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16663r3_rule,STIG-ID|5.250,SWIFT-CSCv1|5.1,Vuln-ID|V-15724"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Windows\Sidebar"
          reg_item    : "TurnOffUnsignedGadgets"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.251 - The More Gadgets link must be disabled."
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents access to gadgets through the More Gadgets link."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Override the More Gadgets Link' to 'Enabled' with 'about-blank' entered in the 'Override Gadget Location'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16664r3_rule,STIG-ID|5.251,SWIFT-CSCv1|5.1,Vuln-ID|V-15725"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_TEXT
          value_data  : "about:blank"
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Windows\Sidebar"
          reg_item    : "OverrideMoreGadgetsLink"
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "5.252 - User-installed gadgets must be turned off."
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents user-installed gadgets from running."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn Off User Installed Windows Sidebar Gadgets' to 'Enabled'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16665r3_rule,STIG-ID|5.252,SWIFT-CSCv1|5.1,Vuln-ID|V-15726"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\Windows\Sidebar"
          reg_item    : "TurnOffUserInstalledGadgets"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "5.250 - Unsigned gadgets must not be installed. - TurnOffUnsignedGadgets"
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents unsigned gadgets from being installed."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar ->  'Disable unpacking and installation of gadgets that are not digitally signed' to 'Enabled'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16663r3_rule,STIG-ID|5.250,SWIFT-CSCv1|5.1,Vuln-ID|V-15724"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "5.251 - The More Gadgets link must be disabled."
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents access to gadgets through the More Gadgets link."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Override the More Gadgets Link' to 'Enabled' with 'about-blank' entered in the 'Override Gadget Location'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16664r3_rule,STIG-ID|5.251,SWIFT-CSCv1|5.1,Vuln-ID|V-15725"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "5.252 - User-installed gadgets must be turned off."
          info        : "Uncontrolled installation of applications can introduce various issues, including system instability, and allow access to sensitive information.  Installation of applications must be controlled by the enterprise.  This setting prevents user-installed gadgets from running."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn Off User Installed Windows Sidebar Gadgets' to 'Enabled'.

To turn off Windows Sidebar completely, configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Sidebar -> 'Turn off Windows Sidebar' to 'Enabled'."
          reference   : "800-53|CM-11(2),CAT|II,CCI|CCI-001812,CSCv6|2,CSF|DE.CM-3,Rule-ID|SV-16665r3_rule,STIG-ID|5.252,SWIFT-CSCv1|5.1,Vuln-ID|V-15726"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>
      </else>
    </if>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.253 - User Network Sharing"
      info                 : "This check verifies that users are prevented from sharing files."
      solution             : "Note-  This setting is under USER Configuration not COMPUTER Configuration

Configure the policy value for User Configuration -> Administrative Templates -> Windows Components -> Network Sharing 'Prevent users from sharing files within their profile' to 'Enabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|14.4,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16666r1_rule,STIG-ID|5.253,SWIFT-CSCv1|2.3,Vuln-ID|V-15727"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 1
      reg_key              : "HKU\Software\Microsoft\Windows\Currentversion\Policies\Explorer"
      reg_item             : "NoInplaceSharing"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "2.021 - Remove Software Certificate Installation Files"
      info                 : "This check verifies that software certificate installation files have been removed from a system."
      solution             : "Remove any certificate installation files found on a system.

Note-  This does not apply to server-based applications that have a requirement for .p12 certificate files (e.g., Oracle Wallet Manager)"
      reference            : "800-171|3.13.10,800-53|SC-12,CAT|II,CCI|CCI-000366,CSF|PR.IP-1,ISO/IEC-27001|A.10.1.2,ITSG-33|SC-12,NESA|T7.4.1,NESA|T7.4.2,NIAv2|CY2,NIAv2|CY8,NIAv2|CY9,Rule-ID|SV-29464r1_rule,STIG-ID|2.021,Vuln-ID|V-15823"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-WMIObject Win32_LogicalDisk -filter 'DriveType = 3' | Select-Object DeviceID | ForEach-Object {Get-Childitem ($_.DeviceID + '\') -include *.p12,*.pfx -recurse}"
      only_show_cmd_output : YES
    </custom_item>

    <custom_item>
      type         : SERVICE_POLICY
      description  : "5.254 - Windows Customer Experience Improvement Program is disabled."
      info         : "This check verifies that the Windows Customer Experience Improvement Program is disabled so information is not passed to the vendor."
      solution     : "Configure the policy value for Computer Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication Settings -> 'Turn off Windows Customer Experience Improvement Program' to 'Enabled'."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-16976r1_rule,STIG-ID|5.254,SWIFT-CSCv1|2.3,Vuln-ID|V-16020"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : SERVICE_SET
      value_data   : "Disabled"
      service_name : "TlntSvr"
      svc_option   : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.255 - Help Experience Improvement Program is disabled."
      info                 : "This check verifies that the Windows Help Experience Improvement Program is disabled to prevent information from being passed to the vendor."
      solution             : "Configure the policy value for User Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication Settings -> 'Turn off Help Experience Improvement Program' to 'Enabled'."
      reference            : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000381,CSCv6|13,CSF|PR.AC-4,Rule-ID|SV-16977r1_rule,STIG-ID|5.255,Vuln-ID|V-16021"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 1
      reg_key              : "HKU\Software\Policies\Microsoft\Assistance\Client\1.0"
      reg_item             : "NoImplicitFeedback"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type         : CHECK_ACCOUNT
      description  : "4.039 - Built-in Admin Account Status"
      info         : "This check verifies that Windows Vista is configured to disable the built-in administrator account which provides no accountability."
      solution     : "Configure the system to disable the built-in administrator account."
      reference    : "800-171|3.1.1,800-53|AC-2,CAT|II,CCI|CCI-000764,CN-L3|7.1.3.2(d),CSCv6|16,CSCv6|5.1,CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-17029r1_rule,STIG-ID|4.039,Vuln-ID|V-16047"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : POLICY_SET
      value_data   : "Disabled"
      account_type : ADMINISTRATOR_ACCOUNT
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "5.256 - Disable Help Ratings feed back."
      info                 : "This check verifies that the users cannot provide ratings feedback to Microsoft for Help content"
      solution             : "Configure the policy value for User Configuration -> Administrative Templates -> System -> Internet Communication Management -> Internet Communication Settings -> 'Turn off Help Ratings' to 'Enabled'."
      reference            : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-000381,CSF|PR.AC-4,Rule-ID|SV-17030r1_rule,STIG-ID|5.256,Vuln-ID|V-16048"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_DWORD
      value_data           : 1
      reg_key              : "HKU\Software\Policies\Microsoft\Assistance\Client\1.0"
      reg_item             : "NoExplicitFeedback"
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
      reg_option           : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.004 - Secure Removable Media - CD-ROM"
      info        : "This check verifies that Windows is configured to not limit access to CD drives when a user is logged on locally per the FDCC."
      solution    : "Configure the policy value for Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> 'Devices- Restrict CD-ROM access to locally logged-on user only' to 'Disabled'."
      reference   : "800-171|3.8.1,800-171|3.8.2,800-171|3.8.3,800-53|MP-2,CAT|III,CCI|CCI-000366,CSCv6|8.3,CSF|PR.PT-2,ITSG-33|MP-2,NESA|T1.3.2,NESA|T1.3.3,NESA|T1.4.1,Rule-ID|SV-29466r1_rule,STIG-ID|3.004,Vuln-ID|V-17373"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
      reg_item    : "AllocateCDRoms"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "3.141 - User Account Control - Executable Elevation"
      info        : "This check verifies that elevation of application in UAC is not restricted to signed and validated applications per the FDCC."
      solution    : "Configure the setting for 'User Account Control- Only elevate executables that are signed and validated' to 'Disabled'."
      reference   : "800-53|SI-7(6),8500.2|ECSC-1,CAT|III,CCI|CCI-001084,CSF|PR.DS-6,Rule-ID|SV-18428r2_rule,STIG-ID|3.141,SWIFT-CSCv1|6.2,Vuln-ID|V-17374"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "ValidateAdminCodeSignatures"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "2.022 - Disallow AutoPlay/Autorun from Autorun.inf"
      info        : "This registry key will prevent the autorun.inf from executing commands."
      solution    : "Add the registry value as specified in the manual check."
      reference   : "800-171|3.13.13,800-53|SC-18(4),CAT|I,CCI|CCI-001764,CSF|DE.CM-5,ITSG-33|SC-18(4),Rule-ID|SV-29584r1_rule,STIG-ID|2.022,Vuln-ID|V-17900"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "@SYS:DoesNotExist"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Inifilemapping\Autorun.Inf"
      reg_item    : ""
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : USER_RIGHTS_POLICY
      description : "4.005 - Unapproved Users have access to Debug programs."
      info        : "This is a Category 1 finding as it provides access to the kernel with complete access to sensitive and critical operating system components."
      solution    : "Configure the system to remove any accounts from the 'Debug programs' user right."
      reference   : "800-53|AC-6(7),CAT|I,CCI|CCI-002235,CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1,Rule-ID|SV-29588r1_rule,STIG-ID|4.005,Vuln-ID|V-18010"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : USER_RIGHT
      value_data  : ""
      right_type  : SeDebugPrivilege
    </custom_item>

    <custom_item>
      type        : REGISTRY_PERMISSIONS
      description : "2.023 - Standard user accounts must only have Read permissions to the Winlogon registry key."
      info        : "Permissions on the Winlogon registry key must only allow privileged accounts to change registry values. If standard users have this capability there is a potential for programs to run with elevated privileges when a privileged user logs on to the system."
      solution    : "Maintain the default permissions of the following registry key-

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\

Users - Read
Administrators - Full Control
SYSTEM - Full Control
CREATOR OWNER - Special
(Special = Full Control - Subkeys only)"
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|I,CCI|CCI-002235,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-33307r2_rule,STIG-ID|2.023,SWIFT-CSCv1|2.3,Vuln-ID|V-26070"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : REG_ACL
      value_data  : "Winlogon"
      reg_key     : "HKLM\Software\Microsoft\Windows Nt\Currentversion\Winlogon"
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "WINPK-000001 - The DoD Root CA certificates must be installed in the Trusted Root Store."
      info                 : "To ensure secure DoD websites and DoD-signed code are properly validated, the system must trust the DoD Root Certificate Authorities (CAs). The DoD root certificates will ensure that the trust chain is established for server certificates issued from the DoD CAs.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Install the DoD Root CA certificates.
DoD Root CA 2
DoD Root CA 3
DoD Root CA 4

The InstallRoot tool is available on IASE at http-//iase.disa.mil/pki-pke/Pages/tools.aspx."
      reference            : "800-171|3.13.15,800-53|SC-23(5),CAT|II,CCI|CCI-000185,CCI|CCI-002470,Rule-ID|SV-42593r4_rule,STIG-ID|WINPK-000001,Vuln-ID|V-32272"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "get-childitem -path Cert:\LocalMachine\Root | Where-Object {$_.Thumbprint -match '8C941B34EA1EA6ED9AE2BC54CF687252B4C9B561'} | Format-List -Property *"
      only_show_cmd_output : YES
      severity             : MEDIUM
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "WINPK-000002 - The External Root CA certificates must be installed in the Trusted Root Store on unclassified systems."
      info                 : "To ensure secure websites protected with External Certificate Authority (ECA) server certificates are properly validated, the system must trust the ECA Root CAs. The ECA root certificates will ensure the trust chain is established for server certificates issued from the External CAs. This requirement only applies to unclassified systems.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Install the ECA Root CA certificates on unclassified systems.
ECA Root CA 2
ECA Root CA 4

The InstallRoot tool is available on IASE at http-//iase.disa.mil/pki-pke/Pages/tools.aspx."
      reference            : "800-171|3.13.15,800-53|SC-23(5),CAT|II,CCI|CCI-000185,Rule-ID|SV-42599r4_rule,STIG-ID|WINPK-000002,Vuln-ID|V-32273"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "get-childitem -path Cert:\LocalMachine\Root | Where-Object {$_.Thumbprint -match 'C313F919A6ED4E0E8451AFA930FB419A20F181E4'} | Format-List -Property *"
      only_show_cmd_output : YES
      severity             : MEDIUM
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "WINPK-000003 - The DoD Interoperability Root CA cross-certificates must be installed."
      info                 : "To ensure users do not experience denial of service when performing certificate-based authentication to DoD websites due to the system chaining to a root other than DoD Root CAs, the DoD Interoperability Root CA cross-certificates must be installed in the Untrusted Certificate Store. This requirement only applies to unclassified systems.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Install the DoD Interoperability Root CA cross-certificates on unclassified systems.

Issued To - Issued By - Thumbprint
DoD Root CA 2 - DoD Interoperability Root CA 1 - 99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434
DoD Root CA 3 - DoD Interoperability Root CA 2 - FFAD03329B9E527A43EEC66A56F9CBB5393E6E13
DoD Root CA 3 - DoD Interoperability Root CA 2 - FCE1B1E25374DD94F5935BEB86CA643D8C8D1FF4

Administrators should run the Federal Bridge Certification Authority (FBCA) Cross-Certificate Removal Tool once as an administrator and once as the current user.

The FBCA Cross-Certificate Remover tool and user guide is available on IASE at http-//iase.disa.mil/pki-pke/Pages/tools.aspx."
      reference            : "800-171|3.13.15,800-53|SC-23(5),CAT|II,CCI|CCI-000185,Rule-ID|SV-42604r5_rule,STIG-ID|WINPK-000003,Vuln-ID|V-32274"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "get-childitem -path Cert:\LocalMachine\Disallowed | Where-Object {$_.Thumbprint -match '99C494ECE4FC093EEE13C4D65B1B1E01B9B5D434'} | Format-List -Property *"
      only_show_cmd_output : YES
      severity             : MEDIUM
    </custom_item>

    <custom_item>
      type        : REGISTRY_PERMISSIONS
      description : "WINRG-000001  - Standard user accounts must only have Read permissions to the Active Setup\Installed Components registry key."
      info        : "Permissions on the Active Setup\Installed Components registry key must only allow privileged accounts to add or change registry values.  If standard user accounts have this capability there is a potential for programs to run with elevated privileges when a privileged user logs on to the system."
      solution    : "Maintain the default permissions of the following registry keys-
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components\ (64-bit systems only)

Users - Read
Administrators - Full Control
SYSTEM - Full Control
CREATOR OWNER - Special
(Special = Full Control - Subkeys only)"
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CAT|I,CCI|CCI-002235,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-42616r2_rule,STIG-ID|WINRG-000001,SWIFT-CSCv1|2.3,Vuln-ID|V-32282"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : REG_ACL
      value_data  : "InstalledComponents"
      reg_key     : "HKLM\Software\Microsoft\Active Setup\Installed Components"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000001 - The Windows Installer Always install with elevated privileges must be disabled."
      info        : "Standard user accounts must not be granted elevated privileges.  Enabling Windows Installer to elevate privileges when installing applications can allow malicious persons and applications to gain full control of a system."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Installer -> 'Always install with elevated privileges' to 'Disabled'."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|I,CCI|CCI-001812,CSCv6|5.1,CSF|PR.AC-4,Rule-ID|SV-46217r1_rule,STIG-ID|WINCC-000001,Vuln-ID|V-34974"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Installer"
      reg_item    : "AlwaysInstallElevated"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINRG-000003 - Local administrator accounts must have their privileged token filtered to prevent elevated privileges."
      info        : "A compromised local administrator account can provide means for an attacker to move laterally between domain systems.

With User Account Control enabled, filtering the privileged token for local administrator accounts will prevent the elevated privileges of these accounts from being used over the network."
      solution    : "Configure the following registry value-

Registry Hive-  HKEY_LOCAL_MACHINE
Subkey- SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

Value Name-  LocalAccountTokenFilterPolicy

Type-  REG_DWORD
Value-  0"
      reference   : "800-53|AC-6(3),8500.2|ECLP-1,CAT|II,CCI|CCI-001084,CSCv6|5.8,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,Rule-ID|SV-47845r2_rule,STIG-ID|WINRG-000003,SWIFT-CSCv1|5.1,Vuln-ID|V-36439"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Microsoft\Windows\Currentversion\Policies\System"
      reg_item    : "LocalAccountTokenFilterPolicy"
      reg_option  : MUST_EXIST
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "WINFW-000100 -  Inbound exceptions to the firewall on domain workstations must only allow authorized management systems."
      info                 : "Allowing inbound access to domain workstations from other systems may allow lateral movement across systems if credentials are compromised.  Limiting inbound connections only from authorized management systems and remote management hosts will help limit this exposure.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Ensure firewall exceptions to inbound connections on domain workstations only allow authorized management systems and remote management hosts.

Firewall rules can be complex and should be thoroughly tested be applying in a production environment.

One method for restricting inbound connections is to only allow exceptions for a specific scope of remote IP addresses.  For any inbound rules that allow connections from other systems, configure the Scope for Remote IP address to those of authorized management systems and remote management hosts. This may be defined as an IP address, subnet or range. Apply the rule to all firewall profiles.

If a third-party firewall is used, configure inbound exceptions to only include authorized remote management hosts."
      reference            : "800-53|AC-6(3),CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,Rule-ID|SV-47849r1_rule,STIG-ID|WINFW-000100,SWIFT-CSCv1|5.1,Vuln-ID|V-36440"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "Get-NetFirewallRule | where-object {$_.direction -eq 'inbound' -AND $_.enabled -eq 'true'} | Format-List DisplayName,Enabled,Direction"
      only_show_cmd_output : YES
      severity             : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "1.006-01 - Policy must require that administrative user accounts not be used with applications that access the internet."
      info        : "Using applications that access the internet or have potential internet sources using administrative privileges exposes a system to compromise.  If a flaw in an application is exploited while running as a privileged user, the entire system could be compromised.  Web browsers and email are common attack vectors for introducing malicious code and must not be run with an administrative user account.

Since administrative user accounts may generally change or work around technical restrictions for running a web browser or other applications, it is essential that policy requires administrative users not access the internet or use applications, such as email.

The policy should define specific exceptions for local service administration.  These exceptions may include HTTP(S)-based tools that are used for the administration of the local system, services, or attached devices.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Establish a site policy to prohibit the use applications that access the internet, such as web browsers, or with potential internet sources, such as email, by administrative user accounts.  Ensure the policy is enforced."
      reference   : "8500.2|ECSC-1,CAT|I,CCI|CCI-000366,Rule-ID|SV-47863r1_rule,Vuln-ID|V-36451"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000078 - EMET system-wide Address Space Layout Randomization (ASLR) must be enabled and configured to Application Opt In."
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "This is applicable to unclassified systems, for other systems this is NA.

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> EMET -> 'System ASLR' to 'Enabled' with 'Application Opt-In' selected.

The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-49943r5_rule,STIG-ID|WINCC-000078,SWIFT-CSCv1|2.3,Vuln-ID|V-36701"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 3
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Syssettings"
      reg_item    : "ASLR"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000079 - EMET Default Protections for Internet Explorer must be enabled."
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Internet Explorer' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50026r5_rule,STIG-ID|WINCC-000079,SWIFT-CSCv1|2.3,Vuln-ID|V-36702"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+EAF+ eaf_modules:mshtml.dll;flash*.ocx;jscript*.dll;vbscript.dll;vgx.dll +ASR asr_modules:npjpi*.dll;jp2iexp.dll;vgx.dll;msxml4*.dll;wshom.ocx;scrrun.dll;vbscript.dll asr_zones:1;2"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Internet Explorer\iexplore.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - AcroRd32.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+EAF+ eaf_modules:AcroRd32.dll;Acrofx32.dll;AcroForm.api"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Adobe\*\Reader\AcroRd32.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - Acrobat.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+EAF+ eaf_modules:AcroRd32.dll;Acrofx32.dll;AcroForm.api"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Adobe\Acrobat*\Acrobat\Acrobat.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - java.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-HeapSpray"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Java\jre*\bin\java.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - javaw.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-HeapSpray"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Java\jre*\bin\javaw.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - javaws.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-HeapSpray"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Java\jre*\bin\javaws.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - EXCEL.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+ASR asr_modules:flash*.ocx"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\EXCEL.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - INFOPATH.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\INFOPATH.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - LYNC.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\LYNC.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - MSACCESS.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\MSACCESS.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - MSPUB.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\MSPUB.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - OIS.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\OIS.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - OUTLOOK.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\OUTLOOK.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - POWERPNT.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+ASR asr_modules:flash*.ocx"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\POWERPNT.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - PPTVIEW.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\PPTVIEW.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - VISIO.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\VISIO.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - VPREVIEW.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\VPREVIEW.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - WINWORD.EXE"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+ASR asr_modules:flash*.ocx"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\OFFICE1*\WINWORD.EXE"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000080 - EMET Default Protections for Recommended Software must be enabled. - wordpad.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Recommended Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50038r5_rule,STIG-ID|WINCC-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-36703"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Windows NT\Accessories\wordpad.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - 7z.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-EAF"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\7-Zip\7z.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - 7zG.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-EAF"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\7-Zip\7zG.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - 7zFM.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-EAF"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\7-Zip\7zFM.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Photoshop.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Adobe\Adobe Photoshop CS*\Photoshop.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Foxit Reader.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Foxit Reader\Foxit Reader.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - chrome.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+EAF+ eaf_modules:chrome_child.dll"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Google\Chrome\Application\chrome.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - googletalk.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-DEP"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Google\Google Talk\googletalk.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - iTunes.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\iTunes\iTunes.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - communicator.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Microsoft Lync\communicator.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - mirc.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\mIRC\mirc.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - firefox.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "+EAF+ eaf_modules:mozjs.dll;xul.dll"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Mozilla Firefox\firefox.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Firefox plugin-container.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Mozilla Firefox\plugin-container.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Thunderbird plugin-container.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Mozilla Thunderbird\plugin-container.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - thunderbird.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Mozilla Thunderbird\thunderbird.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - *\opera.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Opera\*\opera.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - opera.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Opera\opera.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - pidgin.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Pidgin\pidgin.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - QuickTimePlayer.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\QuickTime\QuickTimePlayer.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - realconverter.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Real\RealPlayer\realconverter.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - realplay.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Real\RealPlayer\realplay.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Safari.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Safari\Safari.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - SkyDrive.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\SkyDrive\SkyDrive.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - Skype.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-EAF"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Skype\Phone\Skype.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - vlc.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\VideoLAN\VLC\vlc.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - winamp.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Winamp\winamp.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - wlmail.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Windows Live\Mail\wlmail.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - WLXPhotoGallery.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Windows Live\Photo Gallery\WLXPhotoGallery.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - WindowsLiveWriter.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Windows Live\Writer\WindowsLiveWriter.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - wmplayer.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : "-EAF -MandatoryASLR"
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\Windows Media Player\wmplayer.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - rar.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\WinRAR\rar.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - unrar.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\WinRAR\unrar.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - winrar.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\WinRAR\winrar.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - winzip32.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\WinZip\winzip32.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000081 - EMET Default Protections for Popular Software must be enabled. - winzip64.exe"
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "Configure the policy value for Computer Configuration >> Administrative Templates >> Windows Components >> EMET >> 'Default Protections for Popular Software' to 'Enabled'.

Note- The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Due to a change in the registry structure for EMET 5.5, if the system has a previous version of EMET installed and configured, this setting needs to be set to 'Not Configured' prior to the upgrade to EMET 5.5, and the new administrative template files copied to the appropriate area.  The setting can then be re-enabled."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50048r5_rule,STIG-ID|WINCC-000081,SWIFT-CSCv1|2.3,Vuln-ID|V-36704"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_TEXT
      value_data  : ""
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Defaults"
      reg_item    : "*\WinZip\winzip64.exe"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000082 - EMET system-wide Data Execution Prevention (DEP) must be enabled and configured to at least Application Opt Out."
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "This is applicable to unclassified systems, for other systems this is NA.

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> EMET -> 'System DEP' to 'Enabled' with at least 'Application Opt-Out' selected.

The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Document applications that do not function properly due to this setting, and are opted out, with the ISSO.

Opted out exceptions can be configured with the following command-
EMET_Conf --Set 'application path\executable name' -DEP

Alternately, configure exceptions in System Properties-
Select 'System' in Control Panel.
Select 'Advanced system settings'.
Click 'Settings' in the 'Performance' section.
Select the 'Data Execution Prevention' tab.
Select 'Turn on DEP for all programs and services except those I select-'.

Applications that are opted out are configured in the window below this selection."
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50053r5_rule,STIG-ID|WINCC-000082,SWIFT-CSCv1|2.3,Vuln-ID|V-36705"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Syssettings"
      reg_item    : "DEP"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000083 - EMET system-wide Structured Exception Handler Overwrite Protection (SEHOP) must be configured to Application Opt Out."
      info        : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution    : "This is applicable to unclassified systems, for other systems this is NA.

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> EMET -> 'System SEHOP' to 'Enabled' with 'Application Opt-Out' selected.

The Enhanced Mitigation Experience Toolkit must be installed on the system and the administrative template files added to make this setting available.

Document applications that do not function properly due to this setting, and are opted out, with the ISSO.

Opted out exceptions can be configured with the following command-
EMET_Conf --Set 'application path\executable name' -SEHOP"
      reference   : "800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002824,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,Rule-ID|SV-50060r5_rule,STIG-ID|WINCC-000083,SWIFT-CSCv1|2.3,Vuln-ID|V-36706"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Policies\Microsoft\Emet\Syssettings"
      reg_item    : "SEHOP"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WINGE-000100 - EMET v5.5 or later must be installed on the system."
      info            : "Attackers are constantly looking for vulnerabilities in systems and applications.  The Enhanced Mitigation Experience Toolkit can enable several mechanisms, such as Data Execution Prevention (DEP), Address Space Layout Randomization (ASLR), and Structured Exception Handler Overwrite Protection (SEHOP) on the system and applications adding additional levels of protection."
      solution        : "Install EMET v5.5 or later on the system. EMET is available for download from Microsoft."
      reference       : "800-171|3.14.1,800-53|SI-2,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv6|8.4,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-50949r6_rule,STIG-ID|WINGE-000100,SWIFT-CSCv1|2.2,Vuln-ID|V-39137"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : ".*5.[5-9].*"
      powershell_args : "Get-WmiObject Win32_Product | where-object {$_.Description -match 'EMET 5'} | SELECT Version | Format-List"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type                 : AUDIT_POWERSHELL
      description          : "WINPK-000004 - The US DoD CCEB Interoperability Root CA cross-certificate must be installed."
      info                 : "To ensure users do not experience denial of service when performing certificate-based authentication to DoD websites due to the system chaining to a root other than DoD Root CAs, the US DoD CCEB Interoperability Root CA cross-certificate must be installed in the Untrusted Certificate Store. This requirement only applies to unclassified systems.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution             : "Install the US DoD CCEB Interoperability Root CA cross-certificate on unclassified systems.

Issued To - Issued By - Thumbprint
DoD Root CA 2 - US DoD CCEB Interoperability Root CA 1 - DA36FAF56B2F6FBA1604F5BE46D864C9FA013BA3

Administrators should run the Federal Bridge Certification Authority (FBCA) Cross-Certificate Removal Tool once as an administrator and once as the current user.

The FBCA Cross-Certificate Remover tool and user guide is available on IASE at http-//iase.disa.mil/pki-pke/Pages/tools.aspx."
      reference            : "800-171|3.13.15,800-53|SC-23(5),CAT|II,CCI|CCI-000185,Rule-ID|SV-52393r3_rule,STIG-ID|WINPK-000004,Vuln-ID|V-40237"
      see_also             : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type           : POLICY_TEXT
      value_data           : ""
      powershell_args      : "get-childitem -path Cert:\LocalMachine\Disallowed | Where-Object {$_.Thumbprint -match '7DA8E84296EE238818EE427287774508B26D094A'} | Format-List -Property *"
      only_show_cmd_output : YES
      severity             : MEDIUM
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINFW-000001 - A host-based firewall must be installed and enabled on the system."
      info        : "A firewall provides a line of defense against attack, allowing or blocking inbound and outbound connections based on a set of rules."
      solution    : "Install and enable a host-based firewall on the system."
      reference   : "800-171|3.13.1,800-53|SC-7(12),8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-55079r1_rule,STIG-ID|WINFW-000001,Vuln-ID|V-42420"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windowsfirewall\Domainprofile"
      reg_item    : "EnableFirewall"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000147 - The touch keyboard or input panel must not highlight keys as passwords are entered. - PasswordSecurityState"
      info        : "The touch keyboard or input panel may highlight keys as passwords are entered, providing visibility to nearby persons, and compromising them."
      solution    : "If the system does not have a touch screen, this is NA.
Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Tablet PC -> Input Panel -> 'Turn off password security in Input Panel' to at least 'Enabled- Medium High'."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CCI|CCI-000206,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-70675r1_rule,STIG-ID|WINCC-000147,SWIFT-CSCv1|2.3,Vuln-ID|V-56421"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Tablettip\1.7"
      reg_item    : "PasswordSecurityState"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINCC-000147 - The touch keyboard or input panel must not highlight keys as passwords are entered. - PasswordSecurity"
      info        : "The touch keyboard or input panel may highlight keys as passwords are entered, providing visibility to nearby persons, and compromising them."
      solution    : "If the system does not have a touch screen, this is NA.
Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Tablet PC -> Input Panel -> 'Turn off password security in Input Panel' to at least 'Enabled- Medium High'."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CCI|CCI-000206,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-70675r1_rule,STIG-ID|WINCC-000147,SWIFT-CSCv1|2.3,Vuln-ID|V-56421"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [4..5]
      reg_key     : "HKLM\Software\Policies\Microsoft\Tablettip\1.7"
      reg_item    : "PasswordSecurity"
      reg_option  : CAN_BE_NULL
    </custom_item>

    <custom_item>
      type         : SERVICE_POLICY
      description  : "WINER-000001 - The Windows Error Reporting Service must be running and configured to start automatically."
      info         : "Windows Error Reporting information can be used to help diagnose day-to-day software issues, as well as help discover malicious code and possibly zero-day attacks on systems."
      solution     : "Configure the Start Type of the Windows Error Reporting Service to 'Automatic' and ensure the service has a status of 'Started'."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-71657r1_rule,STIG-ID|WINER-000001,SWIFT-CSCv1|2.3,Vuln-ID|V-56511"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type   : SERVICE_SET
      value_data   : "Automatic"
      service_name : "WerSvc"
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000006 - The system must be configured to prevent the display of error messages to the user."
      info        : "Displaying error messages to users provides them the option of sending the reports.  Error reports should be sent silently, unknown to the user.  This setting controls whether users are shown an error dialog box that lets them report an error."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> 'Prevent display of the user interface for critical errors' to 'Enabled'."
      reference   : "800-53|SI-11,8500.2|ECSC-1,CAT|II,CCI|CCI-001314,CSCv6|13,ITSG-33|SI-11,Rule-ID|SV-71849r1_rule,STIG-ID|WINER-000006,Vuln-ID|V-57455"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "DontShowUI"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "WINER-000007 - The system must be configured to store error reports locally, and not send them to Microsoft."
          value_type  : POLICY_TEXT
# Note: Variable @CORP_SERVER@ replaced with "corp\\.server\\.com" in field "value_data".
          value_data  : "corp\\.server\\.com"
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
          reg_item    : "CorporateWerServer"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "WINER-000007 - The system must be configured to store error reports locally, and not send them to Microsoft."
          info        : "Forwarding error reports to vendors could expose sensitive information.  This setting controls the configuration of a local or DOD-wide error reporting site.   In order to not send the data to any system at this time, yet create the reports locally on the system, this value needs to be a single blank character.  To forward error reports to a collection server, the site's error reporting server name or IP address must be defined."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' -> to 'Enabled' with 'Corporate server name-' defined as a single blank character to store the data on the system or the name or IP address of the local collection server."
          reference   : "8500.2|ECSC-1,CAT|II,CCI|CCI-001312,Rule-ID|SV-71861r1_rule,STIG-ID|WINER-000007,Vuln-ID|V-57457"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "WINER-000008 - The system must be configured to use SSL to forward error reports."
          info        : "The use of SSL enables the secure forwarding of error reporting data from local systems to a reporting site.
      NOTE: Nessus did not perform a scan for this check because V-57457 passed"
          solution    : "This requirement is NA if Windows Error Reporting is not configured to forward reports to a collection server (see V-57457).

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' to 'Enabled' with 'Connect using SSL' selected."
          reference   : "800-171|3.3.8,800-53|AU-4(1),800-53|AU-9(3),8500.2|ECSC-1,CAT|II,CCI|CCI-002418,CN-L3|8.1.4.3(d),CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-71871r1_rule,STIG-ID|WINER-000008,TBA-FIISB|37.3.3,Vuln-ID|V-57459"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>

        <report type:"PASSED">
          description : "WINER-000009 - The system must be configured to send error reports on TCP port 1232."
          info        : "An error reporting site's TCP port must be defined in the local system in order to forward data from local systems via TCP.  Port 1232 is the recommended port setting.
      NOTE: Nessus did not perform a scan for this check because V-57457 passed"
          solution    : "This requirement is NA if Windows Error Reporting is not configured to forward reports to a collection server (see V-57457).

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' to 'Enabled' with '1232' defined as the 'Server Port'."
          reference   : "800-53|AU-4(1),CAT|II,CCI|CCI-000366,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-71881r1_rule,STIG-ID|WINER-000009,Vuln-ID|V-57461"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>
      </then>

      <else>
        <report type:"WARNING">
          description : "WINER-000007 - The system must be configured to store error reports locally, and not send them to Microsoft."
          info        : "Forwarding error reports to vendors could expose sensitive information.  This setting controls the configuration of a local or DOD-wide error reporting site.   In order to not send the data to any system at this time, yet create the reports locally on the system, this value needs to be a single blank character.  To forward error reports to a collection server, the site's error reporting server name or IP address must be defined.

      NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
          solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' -> to 'Enabled' with 'Corporate server name-' defined as a single blank character to store the data on the system or the name or IP address of the local collection server."
          reference   : "8500.2|ECSC-1,CAT|II,CCI|CCI-001312,Rule-ID|SV-71861r1_rule,STIG-ID|WINER-000007,Vuln-ID|V-57457"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
        </report>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "WINER-000008 - The system must be configured to use SSL to forward error reports."
          info        : "The use of SSL enables the secure forwarding of error reporting data from local systems to a reporting site."
          solution    : "This requirement is NA if Windows Error Reporting is not configured to forward reports to a collection server (see V-57457).

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' to 'Enabled' with 'Connect using SSL' selected."
          reference   : "800-171|3.3.8,800-53|AU-4(1),800-53|AU-9(3),8500.2|ECSC-1,CAT|II,CCI|CCI-002418,CN-L3|8.1.4.3(d),CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-71871r1_rule,STIG-ID|WINER-000008,TBA-FIISB|37.3.3,Vuln-ID|V-57459"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
          reg_item    : "CorporateWerUseSSL"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>

        <custom_item>
          type        : REGISTRY_SETTING
          description : "WINER-000009 - The system must be configured to send error reports on TCP port 1232."
          info        : "An error reporting site's TCP port must be defined in the local system in order to forward data from local systems via TCP.  Port 1232 is the recommended port setting."
          solution    : "This requirement is NA if Windows Error Reporting is not configured to forward reports to a collection server (see V-57457).

Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Corporate Windows Error Reporting' to 'Enabled' with '1232' defined as the 'Server Port'."
          reference   : "800-53|AU-4(1),CAT|II,CCI|CCI-000366,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-71881r1_rule,STIG-ID|WINER-000009,Vuln-ID|V-57461"
          see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
          value_type  : POLICY_DWORD
          value_data  : 1232
          reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
          reg_item    : "CorporateWerPortNumber"
          reg_option  : CAN_NOT_BE_NULL
        </custom_item>
      </else>
    </if>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000010 - The system must be configured to archive error reports."
      info        : "The error reporting archive is stored locally on the system, and is created after an error report has been sent to the local collector or DOD-wide collector (if defined).  This creates a backup of the error reporting."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Archive' to 'Enabled'."
      reference   : "800-53|AU-4,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-71891r1_rule,STIG-ID|WINER-000010,Vuln-ID|V-57463"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "DisableArchive"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000011 - The system must be configured to store all data in the error report archive."
      info        : "The error reporting archive is stored locally on the system and is created after an error report has been sent to the local collector or DOD-wide collector (if defined).  Storing all data, including memory contents, adds data that is very helpful in analyzing the errors."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Archive' to 'Enabled' with 'Store All' selected for 'Archive behavior-'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|13,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-71901r1_rule,STIG-ID|WINER-000011,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-57465"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 2
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "ConfigureArchive"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000012 - The maximum number of error reports to archive on a system must be configured to 100 or greater."
      info        : "The retention of archived reports provides a history.  Older reports are automatically deleted as new reports are generated once the maximum limit has been met.  The archive is stored locally on the system and is created after the error report has been sent to the local collector or DOD-wide collector (if defined)."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Archive' to 'Enabled' with 'Maximum number of reports to store-' set to '100' or greater."
      reference   : "800-53|AU-4,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-71911r1_rule,STIG-ID|WINER-000012,Vuln-ID|V-57467"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [100..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "MaxArchiveCount"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000013 - The system must be configured to queue error reports until a local or DOD-wide collector is available."
      info        : "Queueing error reports provides the ability for a system to collect reports locally or until a collection server can be contacted.  Valuable system diagnostic and vulnerability information may be lost if the report queue is disabled."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Queue' to 'Enabled'."
      reference   : "800-53|AU-4(1),8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-71923r1_rule,STIG-ID|WINER-000013,Vuln-ID|V-57469"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "DisableQueue"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000014 - The system must be configured to add all error reports to the queue."
      info        : "Error reports are queued for sending to an error reporting site when the queueing behavior is set to Always Queue.  This will maintain the reports in the queue until a connection can be made to the collection server."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Queue' to 'Enabled' with 'Queuing behavior-' to 'Always queue'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSCv6|13,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-71933r1_rule,STIG-ID|WINER-000014,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-57471"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "ForceQueue"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000015 - The maximum number of error reports to queue on a system must be configured to 50 or greater."
      info        : "The error reporting queue is stored locally on the system and contains the error reports until they have been manually removed or automatically sent to the local collector or DOD-wide collector (if defined).  Once a report has been sent to a collector, it is moved to the report archive.  Old reports are deleted as new ones arrive once the maximum limit has been met."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Queue' to 'Enabled' with 'Maximum number of reports to queue-' set to '50' or greater."
      reference   : "800-53|AU-4,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,Rule-ID|SV-71943r1_rule,STIG-ID|WINER-000015,Vuln-ID|V-57473"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : [50..MAX]
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "MaxQueueCount"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000016 - The system must be configured to attempt to forward queued error reports once a day."
      info        : "Error reports stored in the queue should be forwarded to a local or DOD-wide collection site when the system can connect to the site.  This setting controls the frequency a system will use to try forwarding queued reports to the local or DOD-wide collector."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Advanced Error Reporting Settings -> 'Configure Report Queue' to 'Enabled' with 'Number of days between solution check reminders-' set to '1'."
      reference   : "800-53|AU-4(1),8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CSCv6|13,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-71953r1_rule,STIG-ID|WINER-000016,Vuln-ID|V-57475"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting"
      reg_item    : "QueuePesterInterval"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000017 - Automatically consent to send all data requested by a local or DOD-wide error collection site."
      info        : "Configuring error reporting to send all requested data ensures all relevant data associated with the error report is captured for later analysis.  This setting determines the default consent behavior of Windows Error Reporting."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Consent -> 'Configure Default consent' to 'Enabled' with 'Send all data' selected for 'Consent level'."
      reference   : "800-171|3.3.8,800-53|AU-9(2),8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSCv6|13,CSF|PR.PT-1,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,Rule-ID|SV-71963r1_rule,STIG-ID|WINER-000017,Vuln-ID|V-57477"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 4
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting\Consent"
      reg_item    : "DefaultConsent"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>

    <custom_item>
      type        : REGISTRY_SETTING
      description : "WINER-000018 - The system must be configured to permit the default consent levels of Windows Error Reporting to override."
      info        : "This setting determines the behavior of the 'Configure Default Consent' setting in relation to custom consent settings.  Enabling this allows the default consent levels of Windows Error Reporting to always override any other consent policy setting."
      solution    : "Configure the policy value for Computer Configuration -> Administrative Templates -> Windows Components -> Windows Error Reporting -> Consent -> 'Ignore custom consent settings' to 'Enabled'."
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECSC-1,CAT|II,CCI|CCI-001312,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSCv6|13,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-71973r1_rule,STIG-ID|WINER-000018,Vuln-ID|V-57479"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\Software\Policies\Microsoft\Windows\Windows Error Reporting\Consent"
      reg_item    : "DefaultOverrideBehavior"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_MS_Windows_Vista_V6R41_STIG.audit"
      info        : "Windows Vista is not installed or remote registry service is disabled.

      NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "http://iasecontent.disa.mil/stigs/zip/Oct2016/U_Windows_Vista_V6R41_STIG.zip"
    </report>
  </else>
</if>

</group_policy>
</check_type>
