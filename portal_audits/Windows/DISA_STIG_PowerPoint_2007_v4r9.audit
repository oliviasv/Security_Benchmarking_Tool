#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.7 $
# $Date: 2020/04/22 $
#
# description	: This .audit is designed to query the Microsoft Office 2007 System
# 	  as defined by DISA in the Office 2007 STIG, v4r9 10.26.2012
#
#<ui_metadata>
#<display_name>DISA STIG Office 2007 PowerPoint v4r9</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Office 2007 PowerPoint</name>
#  <version>4.9.0</version>
#</spec>
#<labels>windows,microsoft,office,office_2007,access,access_2007</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"MS Office 2007">

<if>
  <condition type:"AND">
    <custom_item>
      type        : REGISTRY_SETTING
      description : "Test for presence of Office 2007"
      reg_key     : "HKLM\SOFTWARE\Microsoft\Office\12.0\Common\InstallRoot"
      reg_item    : "InstallCount"
      value_type  : POLICY_DWORD
      value_data  : [1..MAX]
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </condition>

  <then>
    <report type:"INFO">
      description : "DISA_STIG_PowerPoint_2007_v4r9.audit for MS PowerPoint, from DISA Office 2007 STIG, v4r9 10.26.2012"
    </report>

#check if Office 2007 service pack 2 is installed

    <if>
      <condition type:"AND">
        <custom_item>
          type        : REGISTRY_SETTING
          description : "Office 2007 service pack check - SP2 installed"
          reg_key     : "HKLM\SOFTWARE\Microsoft\Office\12.0\Common\ProductVersion"
          reg_item    : "LastProduct"
          value_type  : POLICY_TEXT
          value_data  : "12\.0\.64[0-9][0-9]\.1000"
          reg_option  : CAN_NOT_BE_NULL
          check_type  : CHECK_REGEX
        </custom_item>
      </condition>

      <then>
        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBOC_POPUPMANAGEMENT"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBOC_POPUPMANAGEMENT"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              info        : "The Pop-up Blocker feature in Internet Explorer can be used to block most unwanted pop-up and pop-under windows from appearing. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If the Pop-up Blocker is disabled, disruptive and potentially dangerous pop-up windows could load and present a security risk."
              reference   : "CAT|II,Rule-ID|SV-18211r2_rule,STIG-ID|DTOO129,Vuln-ID|V-17184"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Block popups' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              info        : "The Pop-up Blocker feature in Internet Explorer can be used to block most unwanted pop-up and pop-under windows from appearing. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If the Pop-up Blocker is disabled, disruptive and potentially dangerous pop-up windows could load and present a security risk."
              reference   : "CAT|II,Rule-ID|SV-18211r2_rule,STIG-ID|DTOO129,Vuln-ID|V-17184"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Block popups' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_VALIDATE_NAVIGATE_URL"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_VALIDATE_NAVIGATE_URL"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              info        : "To protect users from attacks, Internet Explorer usually does not attempt to load malformed URLs. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer attempts to load a malformed URL, a security risk could occur in some cases."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,Rule-ID|SV-18208r2_rule,STIG-ID|DTOO117,STIG-ID|DTOO123,Vuln-ID|V-17175,Vuln-ID|V-17183"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Navigate URL' will be set to 'Enabled' and powerpnt.exe and 'pptview.exe' are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              info        : "To protect users from attacks, Internet Explorer usually does not attempt to load malformed URLs. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer attempts to load a malformed URL, a security risk could occur in some cases."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,Rule-ID|SV-18208r2_rule,STIG-ID|DTOO117,STIG-ID|DTOO123,Vuln-ID|V-17175,Vuln-ID|V-17183"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Navigate URL' will be set to 'Enabled' and powerpnt.exe and 'pptview.exe' are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_UNC_SAVEDFILECHECK"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_UNC_SAVEDFILECHECK"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              info        : "Typically, when Internet Explorer loads a Web page from a UNC share that contains a Mark of the Web (MOTW) comment that indicates the page was saved from a site on the Internet, Internet Explorer runs the page in the Internet security zone instead of the less restrictive Local Intranet security zone. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer does not evaluate the page for a MOTW, potentially dangerous code could be allowed to run."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Saved from URL' will be set to 'Enabled' and powerpnt.exe and 'PPTView.exe' are checked."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,STIG-ID|DTOO117,Vuln-ID|V-17175"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              info        : "Typically, when Internet Explorer loads a Web page from a UNC share that contains a Mark of the Web (MOTW) comment that indicates the page was saved from a site on the Internet, Internet Explorer runs the page in the Internet security zone instead of the less restrictive Local Intranet security zone. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer does not evaluate the page for a MOTW, potentially dangerous code could be allowed to run."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Saved from URL' will be set to 'Enabled' and powerpnt.exe and 'PPTView.exe' are checked."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,STIG-ID|DTOO117,Vuln-ID|V-17175"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SAFE_BINDTOOBJECT"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SAFE_BINDTOOBJECT"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              info        : "Internet Explorer performs a number of safety checks before initializing an ActiveX control. It will not initialize a control if the kill bit for the control is set in the registry, or if the security settings for the zone in which the control is located do not allow it to be initialized.
This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). A security risk could occur if potentially dangerous controls are allowed to load."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Bind to Object' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18186r2_rule,STIG-ID|DTOO111,Vuln-ID|V-17174"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              info        : "Internet Explorer performs a number of safety checks before initializing an ActiveX control. It will not initialize a control if the kill bit for the control is set in the registry, or if the security settings for the zone in which the control is located do not allow it to be initialized.
This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). A security risk could occur if potentially dangerous controls are allowed to load."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Bind to Object' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18186r2_rule,STIG-ID|DTOO111,Vuln-ID|V-17174"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type                 : REGISTRY_SETTING
          description          : "DTOO146 - PowerPoint - Disable Trust access for VBA into Excel, Word, and PowerPoint."
          info                 : "VSTO projects require access to the Visual Basic for Applications project system in Excel 2007, PowerPoint 2007, and Word 2007, even though the projects do not use Visual Basic for Applications. Design-time support of controls in both Visual Basic and C sharp projects depends on the Visual Basic for Applications project system in Word and Excel.
By default, Excel, Word, and PowerPoint do not allow automation clients to have programmatic access to VBA projects. Users can enable this by selecting the Trust access to the VBA project object model in the Macro Settings section of the Trust Center. However, doing so allows macros in any documents the user opens to access the core Visual Basic objects, methods, and properties, which represents a potential security hazard."
          solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center 'Trust access to Visual Basic Project' will be set to 'Disabled'."
          reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-18611r2_rule,STIG-ID|DTOO146,SWIFT-CSCv1|2.3,Vuln-ID|V-17522"
          see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
          reg_item             : "AccessVBOM"
          value_type           : POLICY_DWORD
          reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
          value_data           : "0"
          reg_option           : CAN_NOT_BE_NULL
          reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              reg_key     : "HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              info        : "The Uniform Resource Locator (URL) standard allows user authentication to be included in URL strings in the form http://username:password@example.com. A malicious user might use this URL syntax to create a hyperlink that appears to open a legitimate Web site but actually opens a deceptive (spoofed) Web site. For example, the URL http://www.wingtiptoys.com@example.com appears to open http://www.wingtiptoys.com but actually opens http://example.com. To protect users from such attacks, Internet Explorer usually blocks any URLs using this syntax.

   This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If user names and passwords in URLs are allowed, users could be diverted to dangerous Web pages, which could pose a security risk."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Disable user name and password' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18179r2_rule,STIG-ID|DTOO104,Vuln-ID|V-17173"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              info        : "The Uniform Resource Locator (URL) standard allows user authentication to be included in URL strings in the form http://username:password@example.com. A malicious user might use this URL syntax to create a hyperlink that appears to open a legitimate Web site but actually opens a deceptive (spoofed) Web site. For example, the URL http://www.wingtiptoys.com@example.com appears to open http://www.wingtiptoys.com but actually opens http://example.com. To protect users from such attacks, Internet Explorer usually blocks any URLs using this syntax.

   This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If user names and passwords in URLs are allowed, users could be diverted to dangerous Web pages, which could pose a security risk."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Disable user name and password' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18179r2_rule,STIG-ID|DTOO104,Vuln-ID|V-17173"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>
      </then>

      <else>
        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_VALIDATE_NAVIGATE_URL"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_VALIDATE_NAVIGATE_URL"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              info        : "To protect users from attacks, Internet Explorer usually does not attempt to load malformed URLs. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer attempts to load a malformed URL, a security risk could occur in some cases."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,Rule-ID|SV-18208r2_rule,STIG-ID|DTOO117,STIG-ID|DTOO123,Vuln-ID|V-17175,Vuln-ID|V-17183"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Navigate URL' will be set to 'Enabled' and powerpnt.exe and 'pptview.exe' are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO123 - PowerPoint - Block navigation to URL embedded in Office products to protect against attack by malformed URL."
              info        : "To protect users from attacks, Internet Explorer usually does not attempt to load malformed URLs. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer attempts to load a malformed URL, a security risk could occur in some cases."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,Rule-ID|SV-18208r2_rule,STIG-ID|DTOO117,STIG-ID|DTOO123,Vuln-ID|V-17175,Vuln-ID|V-17183"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Navigate URL' will be set to 'Enabled' and powerpnt.exe and 'pptview.exe' are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_UNC_SAVEDFILECHECK"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_UNC_SAVEDFILECHECK"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              info        : "Typically, when Internet Explorer loads a Web page from a UNC share that contains a Mark of the Web (MOTW) comment that indicates the page was saved from a site on the Internet, Internet Explorer runs the page in the Internet security zone instead of the less restrictive Local Intranet security zone. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer does not evaluate the page for a MOTW, potentially dangerous code could be allowed to run."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Saved from URL' will be set to 'Enabled' and powerpnt.exe and 'PPTView.exe' are checked."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,STIG-ID|DTOO117,Vuln-ID|V-17175"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO117 - PowerPoint - Evaluate Saved from URL mark when launched from PowerPoint."
              info        : "Typically, when Internet Explorer loads a Web page from a UNC share that contains a Mark of the Web (MOTW) comment that indicates the page was saved from a site on the Internet, Internet Explorer runs the page in the Internet security zone instead of the less restrictive Local Intranet security zone. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If Internet Explorer does not evaluate the page for a MOTW, potentially dangerous code could be allowed to run."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Saved from URL' will be set to 'Enabled' and powerpnt.exe and 'PPTView.exe' are checked."
              reference   : "CAT|II,Rule-ID|SV-18201r2_rule,STIG-ID|DTOO117,Vuln-ID|V-17175"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBOC_POPUPMANAGEMENT"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_WEBOC_POPUPMANAGEMENT"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              info        : "The Pop-up Blocker feature in Internet Explorer can be used to block most unwanted pop-up and pop-under windows from appearing. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If the Pop-up Blocker is disabled, disruptive and potentially dangerous pop-up windows could load and present a security risk."
              reference   : "CAT|II,Rule-ID|SV-18211r2_rule,STIG-ID|DTOO129,Vuln-ID|V-17184"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Block popups' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO129 - PowerPoint - Block pop-ups for links that invoke instances of IE from within PowerPoint."
              info        : "The Pop-up Blocker feature in Internet Explorer can be used to block most unwanted pop-up and pop-under windows from appearing. This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If the Pop-up Blocker is disabled, disruptive and potentially dangerous pop-up windows could load and present a security risk."
              reference   : "CAT|II,Rule-ID|SV-18211r2_rule,STIG-ID|DTOO129,Vuln-ID|V-17184"
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Block popups' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <custom_item>
          type                 : REGISTRY_SETTING
          description          : "DTOO146 - PowerPoint - Disable Trust access for VBA into Excel, Word, and PowerPoint."
          info                 : "VSTO projects require access to the Visual Basic for Applications project system in Excel 2007, PowerPoint 2007, and Word 2007, even though the projects do not use Visual Basic for Applications. Design-time support of controls in both Visual Basic and C sharp projects depends on the Visual Basic for Applications project system in Word and Excel.
By default, Excel, Word, and PowerPoint do not allow automation clients to have programmatic access to VBA projects. Users can enable this by selecting the Trust access to the VBA project object model in the Macro Settings section of the Trust Center. However, doing so allows macros in any documents the user opens to access the core Visual Basic objects, methods, and properties, which represents a potential security hazard."
          solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center 'Trust access to Visual Basic Project' will be set to 'Disabled'."
          reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-18611r2_rule,STIG-ID|DTOO146,SWIFT-CSCv1|2.3,Vuln-ID|V-17522"
          see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
          reg_item             : "AccessVBOM"
          value_type           : POLICY_DWORD
          reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
          value_data           : "-1"
          reg_option           : CAN_BE_NULL
          reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
        </custom_item>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_HTTP_USERNAME_PASSWORD_DISABLE"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              info        : "The Uniform Resource Locator (URL) standard allows user authentication to be included in URL strings in the form http://username:password@example.com. A malicious user might use this URL syntax to create a hyperlink that appears to open a legitimate Web site but actually opens a deceptive (spoofed) Web site. For example, the URL http://www.wingtiptoys.com@example.com appears to open http://www.wingtiptoys.com but actually opens http://example.com. To protect users from such attacks, Internet Explorer usually blocks any URLs using this syntax.

   This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If user names and passwords in URLs are allowed, users could be diverted to dangerous Web pages, which could pose a security risk."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Disable user name and password' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18179r2_rule,STIG-ID|DTOO104,Vuln-ID|V-17173"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO104 - PowerPoint - Disable user name and password syntax from being used in URLs."
              info        : "The Uniform Resource Locator (URL) standard allows user authentication to be included in URL strings in the form http://username:password@example.com. A malicious user might use this URL syntax to create a hyperlink that appears to open a legitimate Web site but actually opens a deceptive (spoofed) Web site. For example, the URL http://www.wingtiptoys.com@example.com appears to open http://www.wingtiptoys.com but actually opens http://example.com. To protect users from such attacks, Internet Explorer usually blocks any URLs using this syntax.

   This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). If user names and passwords in URLs are allowed, users could be diverted to dangerous Web pages, which could pose a security risk."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Disable user name and password' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18179r2_rule,STIG-ID|DTOO104,Vuln-ID|V-17173"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>

        <if>
          <condition type:"AND">
            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SAFE_BINDTOOBJECT"
              reg_item    : "powerpnt.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>

            <custom_item>
              type        : REGISTRY_SETTING
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              reg_key     : "HKLM\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SAFE_BINDTOOBJECT"
              reg_item    : "pptview.exe"
              value_type  : POLICY_DWORD
              value_data  : "1"
              reg_option  : CAN_NOT_BE_NULL
            </custom_item>
          </condition>

          <then>
            <report type:"PASSED">
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              info        : "Internet Explorer performs a number of safety checks before initializing an ActiveX control. It will not initialize a control if the kill bit for the control is set in the registry, or if the security settings for the zone in which the control is located do not allow it to be initialized.
This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). A security risk could occur if potentially dangerous controls are allowed to load."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Bind to Object' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18186r2_rule,STIG-ID|DTOO111,Vuln-ID|V-17174"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </then>

          <else>
            <report type:"FAILED">
              description : "DTOO111 - PowerPoint - Enable IE Bind to Object functionality for instances of IE launched from PowerPoint."
              info        : "Internet Explorer performs a number of safety checks before initializing an ActiveX control. It will not initialize a control if the kill bit for the control is set in the registry, or if the security settings for the zone in which the control is located do not allow it to be initialized.
This functionality can be controlled separately for instances of Internet Explorer spawned by 2007 Office applications (for example, if a user clicks a link in an Office document or selects a menu option that loads a Web page). A security risk could occur if potentially dangerous controls are allowed to load."
              solution    : "The policy value for Computer Configuration -> Administrative Templates -> Microsoft Office 2007 system (Machine) -> Security Settings -> IE Security 'Bind to Object' will be set to 'Enabled' and powerpnt.exe and pptview.exe are checked."
              reference   : "CAT|II,Rule-ID|SV-18186r2_rule,STIG-ID|DTOO111,Vuln-ID|V-17174"
              see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
            </report>
          </else>
        </if>
      </else>
    </if>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO131 - PowerPoint - Disable Trust Bar Notification for unsigned application add-ins."
      info                 : "By default, if an application is configured to require that all add-ins be signed by a trusted publisher, any unsigned add-ins the application loads will be disabled and the application will display the Trust Bar at the top of the active window. The Trust Bar contains a message that informs users about the unsigned add-in."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center 'Disable Trust Bar Notification for unsigned application add-ins' will be set to 'Enabled'."
      reference            : "800-171|3.13.13,800-53|SC-18(4),CAT|II,CSF|DE.CM-5,ITSG-33|SC-18(4),Rule-ID|SV-18222r2_rule,STIG-ID|DTOO131,Vuln-ID|V-17187"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
      reg_item             : "NoTBPromptUnsignedAddin"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO133 - Powerpoint - Disable all Trusted Locations."
      info                 : "Trusted locations specified in the Trust Center are used to define file locations that are assumed to be safe. Content, code, and add-ins are allowed to load from trusted locations with a minimal amount of security, without prompting the users for permission. If a dangerous file is opened from a trusted location, it will not be subject to standard security measures and could harm users' computers or data.
By default, files located in trusted locations (those specified in the Trust Center) are assumed to be safe."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center -> Trusted Locations 'Disable all trusted locations' will be set to 'Enabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-18530r2_rule,STIG-ID|DTOO133,SWIFT-CSCv1|2.3,Vuln-ID|V-17471"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\Trusted Locations"
      reg_item             : "AllLocationsDisabled"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO134 - PowerPoint - Disable settings for content and add-ins that  'Allow trusted locations not on computer' that bypass security checks."
      info                 : "By default, files located in trusted locations and specified in the Trust Center are assumed to be safe. Content, code, and add-ins are allowed to load from trusted locations with minimal security and without prompting the user for permission.
By default, users can specify trusted locations on network shares or in other remote locations that are not under their direct control by selecting the Allow Trusted Locations on my network (not recommended) check box in the Trusted Locations section of the Trust Center. If a dangerous file is opened from a trusted location, it will not be subject to typical security measures and could affect users' computers or data."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center -> Trusted Locations 'Allow Trusted Locations not on the computer' will be set to 'Disabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-18599r2_rule,STIG-ID|DTOO134,SWIFT-CSCv1|2.3,Vuln-ID|V-17520"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\Trusted Locations"
      reg_item             : "AllowNetworkLocations"
      value_type           : POLICY_DWORD
      value_data           : "0"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <if>
      <condition type:"OR">
        <custom_item>
          type                 : REGISTRY_SETTING
          description          : "DTOO139 - PowerPoint - Save files default format as backward compatible,  not as XML."
          reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Options"
          reg_item             : "DefaultFormat"
          value_type           : POLICY_DWORD
          value_data           : "0"
          reg_option           : CAN_NOT_BE_NULL
          reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
        </custom_item>

        <custom_item>
          type                 : REGISTRY_SETTING
          description          : "DTOO139 - PowerPoint - Save files default format as backward compatible,  not as XML."
          reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Options"
          reg_item             : "DefaultFormat"
          value_type           : POLICY_DWORD
          value_data           : "27"
          reg_option           : CAN_NOT_BE_NULL
          reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
        </custom_item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "DTOO139 - PowerPoint - Save files default format as backward compatible,  not as XML."
          info        : "By default, Office 2007 producst save new workbooks in the Office Open XML format. For users who run prior versions of Office products, Microsoft offers the Microsoft Office Compatibility Pack, which enables these versions to open and save open XML format. If some users in your organization cannot install the Compatibility Pack, or are running other versions of Office products these users might not be able to access Excel files saved in the Open XML format."
          solution    : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Save 'default file format' will be set to 'Enabled (PowerPoint 97-2003 Presentation (*.ppt) or Enabled (PowerPoint Presentation ('.pptx)'."
          reference   : "CAT|II,Rule-ID|SV-18607r3_rule,STIG-ID|DTOO139,Vuln-ID|V-17521"
          see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
        </report>
      </then>

      <else>
        <report type:"FAILED">
          description : "DTOO139 - PowerPoint - Save files default format as backward compatible,  not as XML."
          info        : "By default, Office 2007 producst save new workbooks in the Office Open XML format. For users who run prior versions of Office products, Microsoft offers the Microsoft Office Compatibility Pack, which enables these versions to open and save open XML format. If some users in your organization cannot install the Compatibility Pack, or are running other versions of Office products these users might not be able to access Excel files saved in the Open XML format."
          solution    : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Save 'default file format' will be set to 'Enabled (PowerPoint 97-2003 Presentation (*.ppt) or Enabled (PowerPoint Presentation ('.pptx)'."
          reference   : "CAT|II,Rule-ID|SV-18607r3_rule,STIG-ID|DTOO139,Vuln-ID|V-17521"
          see_also    : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
        </report>
      </else>
    </if>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO142 - Powerpoint - Determine whether to force encrypted macros to be scanned in open XML presentations."
      info                 : "When an Office Open XML document (Word, Excel, Powerpoint) is rights-managed or password-protected, any macros that are embedded in the document are encrypted along with the rest of the contents.
By default, these encrypted macros will be disabled unless they are scanned by antivirus software immediately before being loaded. If this default configuration is modified, Office 2007 products will not require encrypted macros to be scanned before loading. They will be handled as specified by the Office 2007 System macro security settings, which can cause macro viruses to load undetected and lead to data loss or reduced application functionality."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security 'Determine whether to force encrypted macros to be scanned in Microsoft PowerPoint Open XML presentations' will be set to 'Enabled'."
      reference            : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,CAT|II,CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,NESA|T3.4.1,NIAv2|GS8a,NIAv2|NS24,Rule-ID|SV-18535r2_rule,STIG-ID|DTOO142,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7,Vuln-ID|V-17473"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
      reg_item             : "PowerPointBypassEncryptedMacroScan"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO153 - PowerPoint - Block opening of 'open XML' format files created by pre-release versions of PowerPoint."
      info                 : "By default, users can open files that were saved in pre-release versions of the new Office Open XML format, which underwent some minor changes prior to the final release of Office 2007. Open XML files usually have the following extensions-
-	.xlsb
-	.xlsx
-	.xlsm
-	.xltx
-	.xltm
-	.xlam
If a vulnerability is discovered that affects these kinds of files, you can use this setting to protect your organization against attacks by temporarily preventing users from opening files in these formats until a security patch is available.
By default, these file types are not blocked in Office 2007 products."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> Block file formats -> Open 'Block opening of pre-release versions of file formats new to PowerPoint 2007' will be set to 'Enabled'."
      reference            : "CAT|II,Rule-ID|SV-18590r2_rule,STIG-ID|DTOO153,Vuln-ID|V-17518"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock"
      reg_item             : "PowerPoint12BetaFiles"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO154 - PowerPoint - Block Opening of 'Open XML' file types to prevent them automatically executing code."
      info                 : "The Office Open XML format file types introduced in the 2007 Microsoft Office release offer a number of benefits compared to the previous binary file types supported in Office 2003, including the potential to reduce the effects of malicious code. Files can be identified as unable to run code, and will therefore ignore any embedded code. Also, any files that do have embedded code are easier to identify.
If a vulnerability is discovered that affects Office Open XML files, you can use this setting to protect your organization against attacks by temporarily preventing users from opening files in these formats until a security patch is available."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> Block file formats -> Open 'Block opening of Open Xml files types' will be set to 'Disabled'."
      reference            : "CAT|II,Rule-ID|SV-18594r2_rule,STIG-ID|DTOO154,Vuln-ID|V-17519"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock"
      reg_item             : "OpenXmlFiles"
      value_type           : POLICY_DWORD
      value_data           : "0"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO155 - PowerPoint - Disable feature that would block older version of office products from saving files to open XML formats."
      info                 : "The Office Open XML format file types introduced in the 2007 Microsoft Office release offer a number of benefits compared with the previous binary file types supported in Office 2003, including the potential to reduce the effects of malicious code. Files can be identified as unable to run code, and will therefore ignore any embedded code. Also, any files that do have embedded code are easier to identify.
For users who run older versions of these applications, Microsoft offers the Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats, which enables them to open and save Open XML files. The Compatibility Pack can be used with the following Microsoft Office programs-
-	Word 2000 with Service Pack 3, Excel 2000 with Service Pack 3, and PowerPoint 2000 with Service Pack 3
-	Word 2002 with Service Pack 3, Excel 2002 with Service Pack 3, and PowerPoint 2002 with Service Pack 3
-	Word 2003 with at least Service Pack 1, Excel 2003 with at least Service Pack 1, and PowerPoint 2003 with at least Service Pack 1
-	Microsoft Office Word Viewer 2003
-	Microsoft Office Excel Viewer 2003
-	Microsoft Office PowerPoint Viewer 2003
If users cannot save files in Office Open XML format for some reason, they will be unable to take advantage of the security benefits of the new file types."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> Block file formats -> Save 'Block saving of Open Xml file types' will be set to 'Disabled'."
      reference            : "CAT|II,Rule-ID|SV-18575r2_rule,STIG-ID|DTOO155,Vuln-ID|V-17503"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileSaveBlock"
      reg_item             : "OpenXmlFiles"
      value_type           : POLICY_DWORD
      value_data           : "0"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO210 - Powerpoint - Block opening of pre-release versions of file formats new to PowerPoint 2007 through the Compatibility Pack for 2007."
      info                 : "The Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats enables users of Microsoft Word 2000, Word 2002, and Office Word 2003 to open files saved in the Office Open XML format used by Word 2007. Word Open XML files usually have the following extensions-
-	.docx
-	.docm
-	.dotx
-	.dotm
-	.xml

By default, the Compatibility Pack does not open files that were saved in pre-release versions of the new Office Open XML format, which underwent some minor changes prior to the final release of Word 2007. If this configuration is changed, through a registry modification or by some other mechanism, users with the Compatibility Pack installed can open files saved by some pre-release versions of Word, but not by others, which can lead to inconsistent file opening functionality."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office 2007 system -> Office 2007 Converters 'Block opening of pre-release versions of file formats new to PowerPoint 2007 through the Compatibility Pack for the 2007 Office system and PowerPoint 2007 Converter' will be set to 'Enabled'."
      reference            : "CAT|II,Rule-ID|SV-18562r2_rule,STIG-ID|DTOO210,Vuln-ID|V-17322"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock"
      reg_item             : "PowerPoint12BetaFilesFromConverters"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO289 - PowerPoint - Disable the ability to run programs from a PowerPoint presentation."
      info                 : "Action buttons can be used to launch external programs from PowerPoint 2007 presentations. If a malicious person adds an action button to a presentation that launches a dangerous program, it could significantly affect the security of a user's computer and data."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security 'Run Programs' will be set to 'Enabled (disable (don't run any programs))'."
      reference            : "800-171|3.4.7,800-53|CM-7(2),CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),Rule-ID|SV-19007r2_rule,STIG-ID|DTOO289,SWIFT-CSCv1|2.3,Vuln-ID|V-17788"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
      reg_item             : "RunPrograms"
      value_type           : POLICY_DWORD
      value_data           : "0"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO291 - PowerPoint - Disable the feature to 'unblock automatic download of linked images' in PowerPoint."
      info                 : "When users insert images into PowerPoint 2007 presentations, they can select Link to File instead of Insert. If they do so, the image is represented by a link to a file on disk instead of being embedded in the presentation file itself.
By default, when PowerPoint opens a presentation it does not display any linked images saved on a different computer unless the presentation itself is saved in a trusted location (as configured in the Trust Center). If this configuration is changed, PowerPoint will load any images that were saved in remote locations, which presents a security risk."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security 'Unblock automatic download of linked images' will be set to 'Disabled'."
      reference            : "800-171|3.13.13,800-53|SC-18(3),CAT|II,CSF|DE.CM-5,ITSG-33|SC-18(3),NIAv2|NS26f,Rule-ID|SV-19044r2_rule,STIG-ID|DTOO291,Vuln-ID|V-17809"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
      reg_item             : "DownloadImages"
      value_type           : POLICY_DWORD
      value_data           : "0"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO299 - PowerPoint - Block PowerPoint from automatically opening converters to view older PowerPoint presentations."
      info                 : "PowerPoint 2007 requires the use of a conversion tool to open presentations saved in versions of PowerPoint older than PowerPoint 97, such as PowerPoint 95, PowerPoint 4.0, and others.
If a vulnerability is discovered that affects these kinds of files, you can use this setting to protect your organization against attacks by temporarily preventing users from opening files in these formats until a security patch is available."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> Block file formats -> Open 'Block opening of Converters' will be set to 'Enabled'."
      reference            : "CAT|II,Rule-ID|SV-18665r2_rule,STIG-ID|DTOO299,Vuln-ID|V-17563"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security\FileOpenBlock"
      reg_item             : "Converters"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO304 - PowerPoint - Enable Warning Bar settings for VBA macros contained in PowerPoint Files."
      info                 : "By default, when users open files in the specified applications that contain VBA macros, the applications open the files with the macros disabled and display the Trust Bar with a warning that macros are present and have been disabled. Users can inspect and edit the files if appropriate, but cannot use any disabled functionality until they enable it by clicking Options on the Trust Bar and selecting the appropriate action. If users enable dangerous macros, it could affect their computers or cause sensitive information to be compromised."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security -> Trust Center 'VBA Macro Warning Settings' will be set to 'Enabled (Trust Bar warning for all macros)'."
      reference            : "800-171|3.13.13,800-53|SC-18(4),CAT|II,CSF|DE.CM-5,ITSG-33|SC-18(4),Rule-ID|SV-18639r2_rule,STIG-ID|DTOO304,Vuln-ID|V-17545"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Security"
      reg_item             : "VBAWarnings"
      value_type           : POLICY_DWORD
      value_data           : "2"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>

    <custom_item>
      type                 : REGISTRY_SETTING
      description          : "DTOO290 -  PowerPoint - Make hidden markup invisible."
      info                 : "PowerPoint presentations that are saved in standard or HTML format can contain a flag indicating whether markup (comments or ink annotations) in the presentation should be visible when the presentation is open. By default, PowerPoint 2007 ignores this flag when opening a file, and always displays any markup present in the file. In addition, when saving a file, PowerPoint sets the flag to display markup when the presentation is next opened.
If this default configuration is changed, PowerPoint sets the flag according to the state of the Show Markup option on the Review tab of the Ribbon when it saves presentations in standard or HTML format. In addition, PowerPoint enables or disables the Show Markup option according to the way the flag is set when it opens files, which means that a presentation saved with hidden markup is opened with the markup still hidden.
If a file is saved with hidden markup, users might inadvertently distribute sensitive comments or information to others via the presentation file."
      solution             : "The policy value for User Configuration -> Administrative Templates -> Microsoft Office PowerPoint 2007 -> PowerPoint Options -> Security 'Make hidden markup visible' will be set to 'Enabled'."
      reference            : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-18943r2_rule,STIG-ID|DTOO290,SWIFT-CSCv1|2.3,Vuln-ID|V-17752"
      see_also             : "http://iase.disa.mil/stigs/app_security/office_auto/u_microsoft_office2007_v4r9_stig_20121026.zip"
      reg_key              : "HKU\Software\Policies\Microsoft\Office\12.0\PowerPoint\Options"
      reg_item             : "MarkupOpenSave"
      value_type           : POLICY_DWORD
      value_data           : "1"
      reg_option           : CAN_NOT_BE_NULL
      reg_ignore_hku_users : "S-1-5-18,S-1-5-19,S-1-5-20"
    </custom_item>
  </then>

  <else>
    <report type:"INFO">
      description : "Office 2007 is not installed on this system or Remote Registry service is disabled on the target."
    </report>
  </else>
</if>

</group_policy>
</check_type>
