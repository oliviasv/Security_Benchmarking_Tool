#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.7 $
# $Date: 2020/04/22 $
#
# description : This document implements the security configuration as recommended by the
#               DISA IBM WebSphere Traditional 9-x STIG v1r1
#
#               http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip
#
#<ui_metadata>
#<display_name>DISA IBM WebSphere Traditional 9 Windows STIG v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>IBM WebSphere Traditional 9</name>
#  <version>1.1.0</version>
#  <link>http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip</link>
#</spec>
#<labels>windows,disa,ibm,websphere,websphere_9</labels>
#<variables>
#  <variable>
#    <name>LEGAL_NOTICE_TEXT</name>
#    <default>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</default>
#    <description>Logon Window Text</description>
#    <info>This is the window text for the login warning a user receives when logging onto the system.</info>
#  </variable>
#  <variable>
#    <name>LOG_ROTATE_SIZE</name>
#    <default>1</default>
#    <description>Log File Rotation Size</description>
#    <info>The maximum file size allowed in MB before the file is rotated.</info>
#  </variable>
#  <variable>
#    <name>MAX_IN_MEMORY_SESSION_COUNT</name>
#    <default>1000</default>
#    <description>Maximum In Memory Session Count</description>
#    <info>Ensure the Maximum in-memory session count field is set to the number of sessions allowable.</info>
#  </variable>
#  <variable>
#    <name>MAX_LOG_FILES</name>
#    <default>100</default>
#    <description>Maximum Number of Audit Log Files</description>
#    <info>The maximum number of audit log files before action is taken.</info>
#  </variable>
#  <variable>
#    <name>MAX_LOG_SIZE</name>
#    <default>100</default>
#    <description>Audit Log File Size</description>
#    <info>The maximum audit log file size before the log is rotated.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_DEFAULT</name>
#    <default>20</default>
#    <description>Thread Pool Size - Default</description>
#    <info>The maximum size of the Default thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_ORB</name>
#    <default>50</default>
#    <description>Thread Pool Size - ORB</description>
#    <info>The maximum size of the ORB thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_TCPChannel</name>
#    <default>20</default>
#    <description>Thread Pool Size - TCPChannel</description>
#    <info>The maximum size of the TCPChannel DCS thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_SERVER_STARTUP</name>
#    <default>3</default>
#    <description>Thread Pool Size - Server Startup</description>
#    <info>The maximum size of the server startup thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_SIBFAP</name>
#    <default>50</default>
#    <description>Thread Pool Size - SIBFAP</description>
#    <info>The maximum size of the SIB FAP thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_SIBFAPInbound</name>
#    <default>50</default>
#    <description>Thread Pool Size - SIBFAPInbound</description>
#    <info>The maximum size of the SIB FAP Inbound thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_SIBJMSRA</name>
#    <default>41</default>
#    <description>Thread Pool Size - SIBJMSRA</description>
#    <info>The maximum size of the SIB JMS RA thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_WEBCONTAINER</name>
#    <default>50</default>
#    <description>Thread Pool Size - WebContainer</description>
#    <info>The maximum size of the Web Container thread pool.</info>
#  </variable>
#  <variable>
#    <name>THREAD_POOL_SIZE_WMQJCA</name>
#    <default>50</default>
#    <description>Thread Pool Size - WMQJCAResourceAdapter</description>
#    <info>The maximum size of the WMQ JCA Resource Adapter thread pool.</info>
#  </variable>
#  <variable>
#    <name>WEBSPHERE_INSTALL_PATH</name>
#    <default>C:\\Program Files\\IBM\\WebSphere\\AppServer</default>
#    <description>WebSphere Installation Path</description>
#    <info>The full path to the WebSphere installation with no trailing slash.</info>
#  </variable>
#  <variable>
#    <name>WEBSPHERE_GROUP</name>
#    <default>was</default>
#    <description>WebSphere Application Group</description>
#    <info>The WebSphere AppServer application group name.</info>
#  </variable>
#  <variable>
#    <name>WEBSPHERE_USER</name>
#    <default>was</default>
#    <description>WebSphere Application Users</description>
#    <info>The WebSphere AppServer application user name.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"MS Windows">

<if>
  <condition type:"AND">
    <custom_item>
      type        : FILE_CHECK
      description : "Check for WebSphere installation"
      value_type  : POLICY_TEXT
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "value_data".
      value_data  : "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer"
      file_option : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_IBM_WebSphere_Traditional_9_Windows_v1r1.audit for DISA IBM WebSphere Traditional 9 STIG v1r1"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000010 - The WebSphere Application Server maximum in-memory session count must be set according to application requirements."
      info            : "Application management includes the ability to control the number of sessions that utilize an application by all accounts and/or account types. Limiting the number of allowed sessions is helpful in limiting risks related to Denial of Service attacks.

Application servers host and expose business logic and application processes.

The application server must possess the capability to limit the maximum number of concurrent sessions in a manner that affects the entire application server or on an individual application basis.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction.

While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
      solution        : "In the administrative console page, click Servers >> Server Types >> WebSphere application servers >> [server_name] >> Session management.

Edit the Maximum in-memory session count field to be the number of sessions allowable."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-000054,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-95907r1_rule,STIG-ID|WBSP-AS-000010,Vuln-ID|V-81193"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @MAX_IN_MEMORY_SESSION_COUNT@ replaced with "1000" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<tuningParams[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maxInMemorySessionCount=.1000[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000020 - The WebSphere Application Server admin console session timeout must be configured."
      info            : "An attacker can take advantage of user sessions that are left open, thus bypassing the user authentication process.

To thwart the vulnerability of open and unused user sessions, the application server must be configured to close the sessions when a configured condition or trigger event is met.

Session termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.

Conditions or trigger events requiring automatic session termination can include, for example, periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use."
      solution        : "Locate the deployment.xml file. The default file locations where deployment.xml is installed are provided below.

UNIX:
/opt/IBM/WebSphere/Profiles/DefaultDmgr01/config/cells/<CELL NAME>/applications/isclite.ear/deployments/isclite/

Windows:
C:\Program Files\IBM\WebSphere\Profiles\DefaultDmgr01\config\cells\<CELL NAME>\applications\isclite.ear\deployments\isclite\

Make a backup copy of the deployment.xml file.

Edit the deployment.xml file.

Modify the 'invalidationtimeout=' value and set to '10'.

Restart the DMGR and all the JVMs."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002361,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-95909r1_rule,STIG-ID|WBSP-AS-000020,Vuln-ID|V-81195"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\applications\isclite.ear\deployments\isclite\deployment.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<tuningParams[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*invalidationTimeout=.([0-9]|10)[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000070 - The WebSphere Application Server security auditing must be enabled."
      info            : "Security auditing will not be performed unless the audit security subsystem has been enabled. Global security must be enabled for the security audit subsystem to function, as no security auditing occurs if global security is not also enabled. Enable global security before enabling security auditing.

Satisfies: SRG-APP-000016-AS-000013, SRG-APP-000343-AS-000030, SRG-APP-000080-AS-000045, SRG-APP-000092-AS-000053, SRG-APP-000266-AS-000168, SRG-APP-000267-AS-000170"
      solution        : "In the administrative console, navigate to Security >> Security auditing to enable.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|II,CCI|CCI-000067,CCI|CCI-000166,CCI|CCI-001312,CCI|CCI-001314,CCI|CCI-001464,CCI|CCI-002234,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-95917r1_rule,STIG-ID|WBSP-AS-000070,SWIFT-CSCv1|6.4,Vuln-ID|V-81203"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditPolicy[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*auditEnabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000080 - WebSphere Application Server groups mapped to WebSphere auditor roles must be configured in accordance with security plan"
      info            : "Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident.

Remote access by administrators requires that the admin activity be logged.

Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.

Satisfies: SRG-APP-000016-AS-000013, SRG-APP-000343-AS-000030

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "Document all groups in an Auditor role in the security plan.

In the administrative console, navigate to Users and Groups >> Administrative group roles.

If an unauthorized group is in the auditor role, remove the auditor role from the group.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.1,800-53|AC-3(7),CAT|II,CCI|CCI-000067,CCI|CCI-002234,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,Rule-ID|SV-95919r1_rule,STIG-ID|WBSP-AS-000080,Vuln-ID|V-81205"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit-authz.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '(?s)<authorizations.*role=.SecurityRoleExt_11.>.*?</authorizations>' -AllMatches | % { $_.Matches.Value } | Select-String -Pattern '<groups.*/>' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000090 - The WebSphere Application Server users WebSphere auditor role must be configured in accordance with System Security Plan."
      info            : "Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident.

Remote access by administrators requires that the admin activity be logged.

Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.

Satisfies: SRG-APP-000016-AS-000013, SRG-APP-000343-AS-000030, SRG-APP-000090-AS-000051

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "In the administrative console, navigate to Users and Groups >> Administrative User roles.

If an unauthorized user is in the auditor role, remove the user from the auditor role.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.1,800-53|AC-3(7),CAT|II,CCI|CCI-000067,CCI|CCI-000171,CCI|CCI-002234,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,Rule-ID|SV-95921r1_rule,STIG-ID|WBSP-AS-000090,Vuln-ID|V-81207"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit-authz.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '(?s)<authorizations.*role=.SecurityRoleExt_11.>.*?</authorizations>' -AllMatches | % { $_.Matches.Value } | Select-String -Pattern '<users.*/>' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000100 - The WebSphere Application Server audit event type filters must be configured."
      info            : "Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident.

Remote access by administrators requires that the admin activity be logged.

Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.

Satisfies: SRG-APP-000016-AS-000013, SRG-APP-000343-AS-000030, SRG-APP-000089-AS-000050, SRG-APP-000495-AS-000220, SRG-APP-000499-AS-000224, SRG-APP-000503-AS-000228, SRG-APP-000504-AS-000229, SRG-APP-000505-AS-000230, SRG-APP-000506-AS-000231, SRG-APP-000093-AS-000054, SRG-APP-000095-AS-000056, SRG-APP-000097-AS-000060, SRG-APP-000098-AS-000061, SRG-APP-000099-AS-000062, SRG-APP-000100-AS-000063, SRG-APP-000101-AS-000072, SRG-APP-000381-AS-000089, SRG-APP-000080-AS-000045

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "In the administrative console, navigate to Security >> Security auditing >> Event type Filters.

Click the 'New' button to create a new filter; give it a unique name.

Select SECURITY_AUTHN, SECURITY_AUTHZ, SECURITY_AUTHN_TERMINATE, and ADMIN_REPOSITORY_SAVE from 'Selectable events'.

Add them to the 'Enabled events' box by clicking on the right arrow.

Select INFO, ERROR, SUCCESS, DENIED, REDIRECT, and WARNING from the 'Selectable event outcomes' box.

Click the right arrow to fill in 'Enabled events outcomes' box.

Click 'OK'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000067,CCI|CCI-000130,CCI|CCI-000132,CCI|CCI-000133,CCI|CCI-000134,CCI|CCI-000135,CCI|CCI-000169,CCI|CCI-000172,CCI|CCI-001462,CCI|CCI-001487,CCI|CCI-001814,CCI|CCI-002234,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-95923r1_rule,STIG-ID|WBSP-AS-000100,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-81209"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '.*(auditSpecifications|SECURITY_AUTHN|SECURITY_AUTHZ|SECURITY_AUTHN_TERMINATE|ADMIN_REPOSITORY_SAVE|SUCCESS|INFO|WARNING|ERROR|DENIED|REDIRECT).*' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000110 - The WebSphere Application Server audit service provider must be enabled."
      info        : "Logging must be utilized in order to track system activity, assist in diagnosing system issues, and provide evidence needed for forensic investigations post security incident.

Remote access by administrators requires that the admin activity be logged.

Application servers provide a web and command line-based remote management capability for managing the application server. Application servers must ensure that all actions related to administrative functionality such as application server configuration are logged.

Satisfies: SRG-APP-000016-AS-000013, SRG-APP-000343-AS-000030

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "In the administrative console, navigate to Security >> Security auditing >> Event type Filters.

Identify and record the event type filter that contains the required 'Events and Outcomes'.

In the administrative console, click on Security >> Security auditing >> Audit Service Provider [provider name].

Under 'Selectable filters', select the filter that was previously identified and recorded.

Click the right arrow to add it to the list.

Click 'OK'.

Click 'Save' to save the changes.

Restart the DMGR and all the JVMs."
      reference   : "CAT|II,CCI|CCI-000067,CCI|CCI-002234,Rule-ID|SV-95925r1_rule,STIG-ID|WBSP-AS-000110,Vuln-ID|V-81211"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000120 - The WebSphere Application Server automatic repository checkpoints must be enabled to track configuration changes - enabled"
      info            : "Without enabling repository checkpoints, you will not be able to determine the history of changes to WebSphere configuration files, and who made those changes."
      solution        : "From administrative console click System administration >> Extended repository service >> Enable automatic repository checkpoints.

Enter a 'checkpoint depth value' according to the security plan.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.4.3,800-53|CM-3,CAT|II,CCI|CCI-000067,CN-L3|8.1.10.6(g),CSF|DE.CM-1,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.IP-3,ISO/IEC-27001|A.12.1.2,ITSG-33|CM-3,NESA|T3.2.3,NESA|T3.3.2,NESA|T7.5.1,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|CM1,NIAv2|CM1a,NIAv2|CM1b,NIAv2|CM1c,Rule-ID|SV-95911r1_rule,STIG-ID|WBSP-AS-000120,Vuln-ID|V-81197"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\repository\repository.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<repositorycheckpoint:ExtendedRepositoryService[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*autoCheckpointsEnabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000120 - The WebSphere Application Server automatic repository checkpoints must be enabled to track configuration changes - depth"
      info            : "Without enabling repository checkpoints, you will not be able to determine the history of changes to WebSphere configuration files, and who made those changes."
      solution        : "From administrative console click System administration >> Extended repository service >> Enable automatic repository checkpoints.

Enter a 'checkpoint depth value' according to the security plan.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.4.3,800-53|CM-3,CAT|II,CCI|CCI-000067,CN-L3|8.1.10.6(g),CSF|DE.CM-1,CSF|DE.CM-7,CSF|PR.IP-1,CSF|PR.IP-3,ISO/IEC-27001|A.12.1.2,ITSG-33|CM-3,NESA|T3.2.3,NESA|T3.3.2,NESA|T7.5.1,NESA|T7.6.1,NESA|T7.6.2,NESA|T7.6.3,NIAv2|CM1,NIAv2|CM1a,NIAv2|CM1b,NIAv2|CM1c,Rule-ID|SV-95911r1_rule,STIG-ID|WBSP-AS-000120,Vuln-ID|V-81197"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\repository\repository.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<repositorycheckpoint:ExtendedRepositoryService[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*autoCheckpointsDepth=.[1-9][0-9]*.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000130 - The WebSphere Application Server administrative security must be enabled."
      info            : "In previous releases of WebSphere Application Server, when a user enabled global security, both administrative and application security were enabled.  The previous notion of global security is split into administrative security and application security, each of which you can enable separately.

As a result of this split, WebSphere Application Server clients must know whether application security is disabled at the target server. Administrative security is enabled, by default. Application security is disabled, by default. Before you can enable application security, you must verify that administrative security is enabled. Application security is in effect only when administrative security is enabled."
      solution        : "From the administrative console, click Security >> Global Security.

Click 'Enable administrative security'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|I,CCI|CCI-002314,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95913r1_rule,STIG-ID|WBSP-AS-000130,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81199"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:Security[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000140 - The WebSphere Application Server bus security must be enabled."
      info            : "A service integration bus is a group of one or more application servers or server clusters in a WebSphere Application Server cell that cooperate to provide asynchronous messaging services. The application servers or server clusters in a bus are known as bus members.

When a bus is created with bus security enabled, the following conditions apply:
The bus requires client authentication.
The bus enforces authorization policy.
The bus requires use of SSL transport chains."
      solution        : "From the administration console, navigate to Security >> Bus Security.

For each service integration bus where security is not enabled, click on 'Disabled'.

Click the check box to 'Enable bus security'.

Configure the transport settings and authorization policies according to application security access requirements specified in the security plan."
      reference       : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-002315,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-95915r1_rule,STIG-ID|WBSP-AS-000140,SWIFT-CSCv1|2.3,Vuln-ID|V-81201"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\buses\*\sib-bus.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<sibresources:SIBus[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*secure=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000150 - The WebSphere Application Server users in a local user registry group must be authorized for that group."
      info        : "Application servers provide remote access capability and must be able to enforce remote access policy requirements or work in conjunction with enterprise tools designed to enforce policy requirements. Automated monitoring and control of remote access sessions allows organizations to detect cyber attacks and also ensure ongoing compliance with remote access policies by logging connection activities of remote users.

Examples of policy requirements include, but are not limited to, authorizing remote access to the information system, limiting access based on authentication credentials, and monitoring for unauthorized access.

Satisfies: SRG-APP-000315-AS-000094, SRG-APP-000380-AS-000088, SRG-APP-000133-AS-000092, SRG-APP-000033-AS-000024, SRG-APP-000153-AS-000104

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "From administrative console, navigate to Users and Groups >> Administrative group roles.

Note: names of the groups and the roles assigned to each group.

Navigate back to User and Groups >> Manage Groups.

Click on every group.

For each group, click on users.

If there is any user who does not belong to the group based on the roles assigned to the group, click on the checkbox next to the user.

Click 'Remove'.

Restart the DMGR and all the JVMs."
      reference   : "CAT|II,CCI|CCI-000213,CCI|CCI-000770,CCI|CCI-001499,CCI|CCI-001813,CCI|CCI-002314,Rule-ID|SV-95927r1_rule,STIG-ID|WBSP-AS-000150,Vuln-ID|V-81213"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000160 - The WebSphere Application Server Quality of Protection (QoP) must be set to use TLSv1.2 or higher."
      info            : "Quality of Protection specifies the security level, ciphers, and mutual authentication settings for the Secure Socket Layer (SSL/TLS) configuration."
      solution        : "From the administrative console, navigate to Security >> SSL certificate and key management.

Click 'SSL configurations'.

Click on each SSL configuration.

Under 'Additional Properties', click 'Quality of protection (QoP)' settings.

At the 'Protocol' pull-down menu, select 'TLSv1.2 or greater'.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-95929r1_rule,STIG-ID|WBSP-AS-000160,Vuln-ID|V-81215"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<setting[\s]+xmi:id=.SecureSocketLayer.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*sslProtocol=.TLSv1\.[2-9].')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000170 - The WebSphere Application Server global application security must be enabled - administrative security"
      info            : "Application security enables security for the applications in your environment. This setting provides application isolation and meets security requirements such as using SSL for authenticating application users.

In previous releases of WebSphere Application Server, when a user enabled global security, both administrative and application security were enabled. The previous notion of global security is split into administrative security and application security, each of which you can enable separately.

As a result of this split, WebSphere Application Server clients must know whether application security is disabled at the target server. Administrative security is enabled, by default. Application security is disabled, by default. Before you can enable application security, you must verify that administrative security is enabled. Application security is in effect only when administrative security is enabled.

Satisfies: SRG-APP-000014-AS-000009, SRG-APP-000172-AS-000120"
      solution        : "From the administrative console, navigate to Security >> Global Security.

Click on 'Enable administrative security'.

Click on 'Enable application security'.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|I,CCI|CCI-000068,CCI|CCI-000197,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95931r1_rule,STIG-ID|WBSP-AS-000170,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81217"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:Security[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000170 - The WebSphere Application Server global application security must be enabled - application security"
      info            : "Application security enables security for the applications in your environment. This setting provides application isolation and meets security requirements such as using SSL for authenticating application users.

In previous releases of WebSphere Application Server, when a user enabled global security, both administrative and application security were enabled. The previous notion of global security is split into administrative security and application security, each of which you can enable separately.

As a result of this split, WebSphere Application Server clients must know whether application security is disabled at the target server. Administrative security is enabled, by default. Application security is disabled, by default. Before you can enable application security, you must verify that administrative security is enabled. Application security is in effect only when administrative security is enabled.

Satisfies: SRG-APP-000014-AS-000009, SRG-APP-000172-AS-000120"
      solution        : "From the administrative console, navigate to Security >> Global Security.

Click on 'Enable administrative security'.

Click on 'Enable application security'.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|I,CCI|CCI-000068,CCI|CCI-000197,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95931r1_rule,STIG-ID|WBSP-AS-000170,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81217"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:Security[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*appEnabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000180 - The WebSphere Application Server Single Sign On (SSO) must have SSL enabled for Web and SIP Security."
      info            : "Remote management access is accomplished by leveraging common communication protocols and establishing a remote connection to the application server via a network for the purposes of managing the application server. If cryptography is not used, then the session data traversing the remote connection could be intercepted and compromised.

Types of management interfaces utilized by an application server include web-based HTTPS interfaces as well as command line-based management interfaces.

Satisfies: SRG-APP-000014-AS-000009, SRG-APP-000172-AS-000120, SRG-APP-000158-AS-000108"
      solution        : "From the administrative console, navigate to Security >> Global Security.

Expand 'Web and SIP security'.

Click on 'Single sign-on (SSO)'.

Select 'Requires SSL'.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|I,CCI|CCI-000068,CCI|CCI-000197,CCI|CCI-000778,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-95933r1_rule,STIG-ID|WBSP-AS-000180,Vuln-ID|V-81219"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<singleSignon[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*requiresSSL=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000190 - The WebSphere Application Server security cookies must be set to HTTPOnly."
      info            : "Web applications use cookies to track users across requests. These cookies, while typically not sensitive in themselves, connect you to your existing state on the back end system. If an intruder were to capture one of your cookies, they could potentially use the cookie to act as you. Important Web traffic should be encrypted using SSL. This includes important cookies.

In the case of WebSphere Application Server, the most important cookie is the LTPA cookie, and therefore it should be configured to be sent only over SSL."
      solution        : "From the administrative console, navigate to Security >> Global Security.

Expand 'Web and SIP security'.

Select 'Set security cookies to HTTPOnly'.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001453,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-95935r1_rule,STIG-ID|WBSP-AS-000190,SWIFT-CSCv1|2.3,Vuln-ID|V-81221"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<properties[\s].*name=.com.ibm.ws.security.addHttpOnlyAttributeToCookies.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*value=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000211 - The WebSphere Application Server Java 2 security must be enabled."
      info            : "Java 2 security provides a policy-based fine grained access control mechanism that increases overall system integrity by checking for permissions before allowing access to certain protected system resources. Java 2 Security is independent on J2EE role-based authorization. Java 2 Security guards access to system resources such as file input and output, sockets, and properties, whereas J2EE security guards access to Web resources such as servlets and JSP files. Administrators should understand the possible consequences of enabling Java 2 Security if applications are not prepared for Java 2 Security. Java 2 Security places some new requirements on application developers and administrators. Admins need to make sure that all the applications are granted the required permissions; otherwise, applications may fail to run. By default, applications are granted the permissions recommended in the J2EE 1.3 Specification. For details of default permissions granted to applications in WebSphere, please refer to the following policy files:

/QIBM/ProdData/Java400/jdk14/lib/security/java.policy
/QIBM/UserData/WebASE51/ASE/instance/properties/server.policy
/QIBM/UserData/WebASE51/ASE/instance/config/cells/cell/nodes/node/app.policy
where instance is the name of your instance, cell is the name of your cell, and node is the name of your node."
      solution        : "From the admin console, select Security >> Global Security >> Java 2 Security.

Select the 'Use Java 2 security to restrict application access to local resources' check box.

Ensure the application security policies are defined and access permissions are granted accordingly.

Policies are created and access is granted on an application by application basis. Application access to the underlying host is based upon application access requirements."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|I,CCI|CCI-000213,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95937r1_rule,STIG-ID|WBSP-AS-000211,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81223"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:Security[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enforceJava2Security=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000212 - The WebSphere Application Server Java 2 security must not be bypassed."
      info            : "WebSphere provides a passive filter mechanism that will allow administrators to set Java 2 security in the admin console as enabled while still allowing applications to access host resources. This setting bypasses the enforcement of Java2 security. Application access is allowed and activity is logged to the system.out file. This feature is to aid in the identification of application access requirements to the underlying host so security policies can be created. This feature is executed via a custom property that is set for each application server instance operating on the WebSphere server. This setting should only be enabled in a development or testing environment in order to identify what applications access requirements are so security policies can then be created."
      solution        : "From the admin console, select Servers >> Server Types >> WebSphere application servers.

For each application server, select Server Infrastructure >> Administration >> Custom properties.

Delete the 'com.ibm.websphere.java2secman.norethrow' resource value from production systems."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|I,CCI|CCI-000213,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95939r1_rule,STIG-ID|WBSP-AS-000212,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81225"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<properties[\s].*name=.com.ibm.websphere.java2secman.norethrow.*'; ''; $value; if (($value | Select-String -Pattern '[\s]*value=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000220 - The WebSphere Application Server users in the admin role must be authorized."
      info            : "Strong access controls are critical to securing the application server. Access control policies (e.g., identity-based policies, role-based policies, attribute-based policies) and access enforcement mechanisms (e.g., access control lists, access control matrices, cryptography) must be employed by the application server to control access between users (or processes acting on behalf of users) and objects (e.g., applications, files, records, processes, application domains) in the application server.

Without stringent logical access and authorization controls, an adversary may have the ability, with very little effort, to compromise the application server and associated supporting infrastructure.

Satisfies: SRG-APP-000033-AS-000024, SRG-APP-000380-AS-000088, SRG-APP-000340-AS-000185

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "Navigate to User and Groups >> Administrative user roles.

If an unauthorized user is assigned to the admin role, click on the user, remove admin rights and assign proper roles as defined in System Security Plan.

Do not delete any user with the 'Primary administrative user name' designation.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CCI|CCI-000213,CCI|CCI-001813,CCI|CCI-002235,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-95941r1_rule,STIG-ID|WBSP-AS-000220,SWIFT-CSCv1|5.1,Vuln-ID|V-81227"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\admin-authz.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '(?s)<authorizations.*role=.SecurityRoleExt_1.>.*?</authorizations>' -AllMatches | % { $_.Matches.Value } | Select-String -Pattern '<users.*/>' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000230 - The WebSphere Application Server LDAP groups must be authorized for the WebSphere role."
      info        : "Strong access controls are critical to securing the application server. Access control policies (e.g., identity-based policies, role-based policies, attribute-based policies) and access enforcement mechanisms (e.g., access control lists, access control matrices, cryptography) must be employed by the application server to control access between users (or processes acting on behalf of users) and objects (e.g., applications, files, records, processes, application domains) in the application server.

Without stringent logical access and authorization controls, an adversary may have the ability, with very little effort, to compromise the application server and associated supporting infrastructure.

Satisfies: SRG-APP-000033-AS-000024, SRG-APP-000267-AS-000170

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Navigate to User and Groups >> Administrative group roles.

If any group is assigned roles that the group should not have, click on the group.

Assign only the role(s) the group should have.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference   : "CAT|II,CCI|CCI-000213,CCI|CCI-001314,Rule-ID|SV-95943r1_rule,STIG-ID|WBSP-AS-000230,Vuln-ID|V-81229"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-000240 - The WebSphere Application Server users in a LDAP user registry group must be authorized for that group."
      info        : "Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.

Restricting non-privileged users also prevents an attacker, who has gained access to a non-privileged account, from elevating privileges, creating accounts, and performing system checks and maintenance.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "In the LDAP server admin console, assign WebSphere users to the appropriate WebSphere group."
      reference   : "CAT|II,CCI|CCI-002235,Rule-ID|SV-95945r1_rule,STIG-ID|WBSP-AS-000240,Vuln-ID|V-81231"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type         : BANNER_CHECK
      description  : "WBSP-AS-000310 - The WebSphere Application Server management interface must display the Standard Mandatory DoD Notice and Consent Banner"
      info         : "Application servers are required to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system management interface, providing privacy and security notices consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance that states that:

(i) users are accessing a U.S. Government information system;
(ii) system usage may be monitored, recorded, and subject to audit;
(iii) unauthorized use of the system is prohibited and subject to criminal and civil penalties; and
(iv) the use of the system indicates consent to monitoring and recording.

System use notification messages can be implemented in the form of warning banners displayed when individuals log on to the information system.

System use notification is intended only for information system access including an interactive logon interface with a human user, and is not required when an interactive interface does not exist.

Use this banner for desktops, laptops, and other devices accommodating banners of 1300 characters. The banner shall be implemented as a click-through banner at logon (to the extent permitted by the operating system), meaning it prevents further activity on the information system unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK'.

'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'"
      solution     : "Open the file ${WAS_HOME}/properties/login.info.

Follow the instructions in the HTML comment section to create the pre-logon banner.

Enter the Standard DoD Mandatory Notice and Consent banner into the HTML section.

If logged on to the admin console, log out and log back on to validate the changes.

Restart the DMGR and all the JVMs."
      reference    : "800-171|3.1.9,800-53|AC-8,CAT|II,CCI|CCI-000048,ITSG-33|AC-8,NESA|M1.3.6,Rule-ID|SV-95947r1_rule,STIG-ID|WBSP-AS-000310,TBA-FIISB|45.2.4,Vuln-ID|V-81233"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "file".
      file         : "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\properties\login.info"
      value_type   : POLICY_TEXT
# Note: Variable @LEGAL_NOTICE_TEXT@ replaced with "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." in field "value_data".
      value_data   : "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
      is_substring : YES
    </custom_item>

    <custom_item>
      type         : BANNER_CHECK
      description  : "WBSP-AS-000320 - The WebSphere Application Server management interface must retain the Standard Mandatory DoD Notice and Consent Banner"
      info         : "To establish acceptance of system usage policy, a click-through banner at the application server management interface logon is required. The banner shall prevent further activity on the application server unless and until the user executes a positive action to manifest agreement by clicking on a box indicating 'OK'."
      solution     : "Open the file ${WAS_HOME}/properties/login.info.

Follow the instructions in the HTML comment section to create the pre-logon banner.

Enter the Standard DoD Mandatory Notice and Consent banner into the HTML section.

If logged on to the admin console, log out and log back on to validate the changes.

Restart the DMGR and all the JVMs."
      reference    : "800-171|3.1.9,800-53|AC-8,CAT|II,CCI|CCI-000050,ITSG-33|AC-8,NESA|M1.3.6,Rule-ID|SV-95949r1_rule,STIG-ID|WBSP-AS-000320,TBA-FIISB|45.2.4,Vuln-ID|V-81235"
      see_also     : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "file".
      file         : "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\properties\login.info"
      value_type   : POLICY_TEXT
# Note: Variable @LEGAL_NOTICE_TEXT@ replaced with "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." in field "value_data".
      value_data   : "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
      is_substring : YES
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000380 - The WebSphere Application Server must generate log records when attempts to access subject privileges occur."
      info            : "Accessing a subject's privileges can be used to elevate a lower-privileged subject's privileges temporarily in order to cause harm to the application server or to gain privileges to operate temporarily for a designed purpose. When these actions take place, the event needs to be logged.

Application servers either provide a local user store, or they integrate with enterprise user stores like LDAP. When the application server provides the user store and enforces authentication, the application server must generate a log record when modification of privileges is successfully or unsuccessfully performed.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "In the administrative console, navigate to Security >> Security auditing >> Audit Service Provider.

Click on the providers in the list.

Note the names of all the filters, e.g., 'DefaultAuditSpecification_1'.

Go back to Security >> Security auditing >> Event type Filters.

Find the filters previously noted.

If you do not see that the provider filter for SECURITY_AUTHN, SECURITY_AUTHZ, SECURITY_AUTHN_TERMINATE, and ADMIN_REPOSITORY_SAVE that has INFO, ERROR, SUCCESS, DENIED, REDIRECT, and WARNING defined, click the 'New' button to create a new filter.

Give it a unique name.

Select 'SECURITY_AUTHN' and 'ADMIN_REPOSITORY_SAVE' from the 'Events to associate with audit filter' field.

Click the right arrow to fill in 'Enabled events' field.

From 'Event outcomes to associate with an audit filter' field, select INFO, ERROR, SUCCESS, DENIED, REDIRECT, and WARNING.

Click the right arrow to fill in 'Enabled event outcomes' field.

Click 'OK'.

Go back to Security >> Security auditing >> Audit Service Provider >> [provider].

Under 'Selectable filters', select the new filter just created.

Click the right arrow to add it to the list.

Click 'OK'.

Click 'Save'.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|III,CCI|CCI-000172,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-95951r1_rule,STIG-ID|WBSP-AS-000380,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-81237"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '.*(auditSpecifications|SECURITY_AUTHN|SECURITY_AUTHZ|SECURITY_AUTHN_TERMINATE|ADMIN_REPOSITORY_SAVE|SUCCESS|INFO|WARNING|ERROR|DENIED|REDIRECT).*' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000580 - The WebSphere Application Server must allocate JVM log record storage capacity in accordance with requirements - err"
      info            : "JVM logs are logs used to store application and runtime related events, rather than audit related events. They are mainly used to diagnose application or runtime bugs. But sometimes they may be useful in providing more context when correlated with audit related events.

The proper management of log records not only dictates proper archiving processes and procedures be established, it also requires allocating enough storage space to maintain the logs online for a defined period of time.

If adequate online log storage capacity is not maintained, intrusion monitoring, security investigations, and forensic analysis can be negatively affected.

It is important to keep a defined amount of logs online and readily available for investigative purposes. The logs may be stored on the application server until they can be archived to a log system or, in some instances, a Storage Area Networks (SAN). Regardless of the method used, log record storage capacity must be sufficient to store log data when the data cannot be offloaded to a log system or SAN."
      solution        : "Identify JVM log size and history retention based on component log policy.

Document those values in the System Security Plan.

From the administrative console, navigate to Troubleshooting >> Logs and Trace.

Select each [server name].

Click 'JVM' Logs.

Under 'System.out', 'Log Rotation', select 'File size' in the 'Maximum Size' entry field, enter the maximum log size based on policy.

Under 'System.err', 'Log Rotation', select 'File Size' in the 'Maximum Size' entry field, enter the maximum log size based on policy.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(1),CAT|II,CCI|CCI-001849,CN-L3|7.1.3.7(e),CSF|PR.PT-1,ITSG-33|AU-5(1),NESA|T3.3.1,Rule-ID|SV-95953r1_rule,STIG-ID|WBSP-AS-000580,TBA-FIISB|37.3.2,Vuln-ID|V-81239"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @LOG_ROTATE_SIZE@ replaced with "1" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<errorStreamRedirect[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*rolloverSize=.1[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000580 - The WebSphere Application Server must allocate JVM log record storage capacity in accordance with requirements - out"
      info            : "JVM logs are logs used to store application and runtime related events, rather than audit related events. They are mainly used to diagnose application or runtime bugs. But sometimes they may be useful in providing more context when correlated with audit related events.

The proper management of log records not only dictates proper archiving processes and procedures be established, it also requires allocating enough storage space to maintain the logs online for a defined period of time.

If adequate online log storage capacity is not maintained, intrusion monitoring, security investigations, and forensic analysis can be negatively affected.

It is important to keep a defined amount of logs online and readily available for investigative purposes. The logs may be stored on the application server until they can be archived to a log system or, in some instances, a Storage Area Networks (SAN). Regardless of the method used, log record storage capacity must be sufficient to store log data when the data cannot be offloaded to a log system or SAN."
      solution        : "Identify JVM log size and history retention based on component log policy.

Document those values in the System Security Plan.

From the administrative console, navigate to Troubleshooting >> Logs and Trace.

Select each [server name].

Click 'JVM' Logs.

Under 'System.out', 'Log Rotation', select 'File size' in the 'Maximum Size' entry field, enter the maximum log size based on policy.

Under 'System.err', 'Log Rotation', select 'File Size' in the 'Maximum Size' entry field, enter the maximum log size based on policy.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(1),CAT|II,CCI|CCI-001849,CN-L3|7.1.3.7(e),CSF|PR.PT-1,ITSG-33|AU-5(1),NESA|T3.3.1,Rule-ID|SV-95953r1_rule,STIG-ID|WBSP-AS-000580,TBA-FIISB|37.3.2,Vuln-ID|V-81239"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @LOG_ROTATE_SIZE@ replaced with "1" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<errorStreamRedirect[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*rolloverSize=.1[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000590 - WebSphere Application Server must allocate audit log record storage capacity in accordance with requirements - maxFileSize"
      info            : "The proper management of log records not only dictates proper archiving processes and procedures be established, it also requires allocating enough storage space to maintain the logs online for a defined period of time.

If adequate online log storage capacity is not maintained, intrusion monitoring, security investigations, and forensic analysis can be negatively affected.

It is important to keep a defined amount of logs online and readily available for investigative purposes. The logs may be stored on the application server until they can be archived to a log system or, in some instances, a Storage Area Networks (SAN). Regardless of the method used, log record storage capacity must be sufficient to store log data when the data cannot be offloaded to a log system or SAN."
      solution        : "Identify Audit Service Provider log size and history retention based on component log policy.

Document those values in the System Security Plan.

From administrative console, click Security >> Security auditing >>Related Items>> Audit service provider >> [audit_service_provider_name].

Under Audit log file size specify the size of the file in MB as defined by your policy.

Under 'Maximum number of audit logs files', specify the maximum number of logs you want to keep on the file system as defined by your policy.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(1),CAT|II,CCI|CCI-001849,CN-L3|7.1.3.7(e),CSF|PR.PT-1,ITSG-33|AU-5(1),NESA|T3.3.1,Rule-ID|SV-95955r1_rule,STIG-ID|WBSP-AS-000590,TBA-FIISB|37.3.2,Vuln-ID|V-81241"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @MAX_LOG_SIZE@ replaced with "100" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditServiceProviders[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maxFileSize=.100[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000590 - WebSphere Application Server must allocate audit log record storage capacity in accordance with requirements - maxLogs"
      info            : "The proper management of log records not only dictates proper archiving processes and procedures be established, it also requires allocating enough storage space to maintain the logs online for a defined period of time.

If adequate online log storage capacity is not maintained, intrusion monitoring, security investigations, and forensic analysis can be negatively affected.

It is important to keep a defined amount of logs online and readily available for investigative purposes. The logs may be stored on the application server until they can be archived to a log system or, in some instances, a Storage Area Networks (SAN). Regardless of the method used, log record storage capacity must be sufficient to store log data when the data cannot be offloaded to a log system or SAN."
      solution        : "Identify Audit Service Provider log size and history retention based on component log policy.

Document those values in the System Security Plan.

From administrative console, click Security >> Security auditing >>Related Items>> Audit service provider >> [audit_service_provider_name].

Under Audit log file size specify the size of the file in MB as defined by your policy.

Under 'Maximum number of audit logs files', specify the maximum number of logs you want to keep on the file system as defined by your policy.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(1),CAT|II,CCI|CCI-001849,CN-L3|7.1.3.7(e),CSF|PR.PT-1,ITSG-33|AU-5(1),NESA|T3.3.1,Rule-ID|SV-95955r1_rule,STIG-ID|WBSP-AS-000590,TBA-FIISB|37.3.2,Vuln-ID|V-81241"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @MAX_LOG_FILES@ replaced with "100" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditServiceProviders[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maxLogs=.100[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000630 - The WebSphere Application Server must provide an immediate real-time alert of all log failure events - enabled"
      info            : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process logs as required. Log processing failures include software/hardware errors, failures in the log capturing mechanisms, and log storage capacity being reached or exceeded. Notification of the failure event will allow administrators to take actions so that logs are not lost."
      solution        : "Establish and utilize a notification process for WebSphere log events or configure WebSphere to send log events alerts via email.

In the administrative console, navigate to Security >> Security auditing >> Audit monitor.

Select a 'Monitor' notification from the dropdown box or create a new notification.

Click on 'New'.

Specify a unique name for the new notification.

Click 'Message log' checkbox.

Select 'Email sent to notification list'.

Enter emails in the 'Email address to add' field.

Enter the mail server address in the 'Outgoing mail (STMP) server' field.

Click '>' to put email in 'List of email addresses' field.

Click 'OK'.

Select the 'Enable monitoring' check box to turn on audit failure notifications.

Select the notification configuration to be used from the 'Monitor notification' dropdown menu.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(2),CAT|II,CCI|CCI-001858,CSF|PR.PT-1,ITSG-33|AU-5(2),NIAv2|GS7f,Rule-ID|SV-95957r1_rule,STIG-ID|WBSP-AS-000630,Vuln-ID|V-81243"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditNotificationMonitor[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000640 - The WebSphere Application Server must alert the SA and ISSO, in the event of a log processing failure - enabled"
      info            : "Logs are essential to monitor the health of the system, investigate changes that occurred to the system, or investigate a security incident. When log processing fails, the events during the failure can be lost. To minimize the timeframe of the log failure, an alert needs to be sent to the SA and ISSO at a minimum.

Log processing failures include, but are not limited to, failures in the application server log capturing mechanisms or log storage capacity being reached or exceeded. In some instances, it is preferred to send alarms to individuals rather than to an entire group. Application servers must be able to trigger an alarm and send an alert to, at a minimum, the SA and ISSO in the event there is an application server log processing failure."
      solution        : "Establish and utilize a notification process for WebSphere log events or configure WebSphere to send log event alerts via email.

In the administrative console, navigate to Security >> Security auditing >> Audit monitor.

Click on 'New' button.

Specify a unique name for the new notification name.

Click 'Message log' checkbox.

Select 'Email sent to notification list'.

Enter SA and ISSO emails in the 'Email address to add' field.

Enter the mail server address in the 'Outgoing mail (STMP) server' field.

Click '>' to put email in 'List of email addresses' field.

Click 'OK'.

Select the 'Enable monitoring' check box to turn on audit failure notifications.

Select the notification configuration to be used from the 'Monitor notification' dropdown menu.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(2),CAT|III,CCI|CCI-000139,CSF|PR.PT-1,ITSG-33|AU-5(2),NIAv2|GS7f,Rule-ID|SV-95959r1_rule,STIG-ID|WBSP-AS-000640,Vuln-ID|V-81245"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditNotificationMonitor[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000640 - The WebSphere Application Server must alert the SA and ISSO, in the event of a log processing failure - notification"
      info            : "Logs are essential to monitor the health of the system, investigate changes that occurred to the system, or investigate a security incident. When log processing fails, the events during the failure can be lost. To minimize the timeframe of the log failure, an alert needs to be sent to the SA and ISSO at a minimum.

Log processing failures include, but are not limited to, failures in the application server log capturing mechanisms or log storage capacity being reached or exceeded. In some instances, it is preferred to send alarms to individuals rather than to an entire group. Application servers must be able to trigger an alarm and send an alert to, at a minimum, the SA and ISSO in the event there is an application server log processing failure."
      solution        : "Establish and utilize a notification process for WebSphere log events or configure WebSphere to send log event alerts via email.

In the administrative console, navigate to Security >> Security auditing >> Audit monitor.

Click on 'New' button.

Specify a unique name for the new notification name.

Click 'Message log' checkbox.

Select 'Email sent to notification list'.

Enter SA and ISSO emails in the 'Email address to add' field.

Enter the mail server address in the 'Outgoing mail (STMP) server' field.

Click '>' to put email in 'List of email addresses' field.

Click 'OK'.

Select the 'Enable monitoring' check box to turn on audit failure notifications.

Select the notification configuration to be used from the 'Monitor notification' dropdown menu.

Click 'OK'.

Click 'Save'."
      reference       : "800-53|AU-5(2),CAT|III,CCI|CCI-000139,CSF|PR.PT-1,ITSG-33|AU-5(2),NIAv2|GS7f,Rule-ID|SV-95959r1_rule,STIG-ID|WBSP-AS-000640,Vuln-ID|V-81245"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditNotificationMonitor[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*wsNotification=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000650 - The WebSphere Application Server audit subsystem failure action must be set to Log warning."
      info            : "Logs are essential to monitor the health of the system, investigate changes that occurred to the system, or investigate a security incident. When log processing fails, the events during the failure can be lost. To minimize the timeframe of the log failure, an alert needs to be sent to the SA and ISSO at a minimum.

Log processing failures include, but are not limited to, failures in the application server log capturing mechanisms or log storage capacity being reached or exceeded. WebSphere must be set to log warnings that the audit subsystem has failed or is in danger or failing so action can be taken to correct the issue."
      solution        : "In the administrative console, navigate to Security >> Security auditing.

Click the 'Audit subsystem failure action' dropdown box.

Select 'Log Warning'.

Click 'Apply'.

Click 'Save' to save the configuration.

Restart the DMGR and all JVMs."
      reference       : "800-171|3.3.4,800-53|AU-5,CAT|II,CCI|CCI-000139,CN-L3|7.1.3.3(e),CSF|PR.PT-1,ITSG-33|AU-5,NESA|T3.6.2,Rule-ID|SV-95961r1_rule,STIG-ID|WBSP-AS-000650,Vuln-ID|V-81247"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditPolicy[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*auditPolicy=.WARN.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000660 - The WebSphere Application Server must shut down by default upon log failure (unless availability is an overriding concern)."
      info            : "It is critical that, when a system is at risk of failing to process logs, it detects and takes action to mitigate the failure. Log processing failures include software/hardware errors, failures in the log capturing mechanisms, and log storage capacity being reached or exceeded. During a failure, the application server must be configured to shut down unless the application server is part of a high availability system or availability is an overriding concern.

When availability is an overriding concern, other approved actions in response to a log failure include:

(i) If the failure was caused by the lack of log record storage capacity, the application must continue generating log records if possible (automatically restarting the log service if necessary), overwriting the oldest log records in a first-in-first-out manner.

(ii) If log records are sent to a centralized collection server and communication with this server is lost or the server fails, the application must queue log records locally until communication is restored or until the log records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local log data with the collection server.

If the server will continue to process without any logging mitigations in place and the availability of the server is not critical to the success of the mission, the server must be configured to shut down on log failure."
      solution        : "In the admin console click Security >> Security Auditing.

Set 'Audit subsystem failure action' to 'Terminate'.

Restart the DMGR and all JVMs."
      reference       : "800-171|3.3.4,800-53|AU-5,CAT|III,CCI|CCI-000140,CN-L3|7.1.3.3(e),CSF|PR.PT-1,ITSG-33|AU-5,NESA|T3.6.2,Rule-ID|SV-95963r1_rule,STIG-ID|WBSP-AS-000660,Vuln-ID|V-81249"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditPolicy[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*auditPolicy=.FATAL.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000670 - The WebSphere Application Server high availability applications must be configured to fail over in log subsystem failure."
      info        : "This requirement is dependent upon system MAC and availability. If the system MAC and availability do not specify redundancy requirements, this requirement is NA.

It is critical that, when a system is at risk of failing to process logs as required, it detects and takes action to mitigate the failure.

Application servers must be capable of failing over to another system which can handle application and logging functions upon detection of an application log processing failure. This will allow continual operation of the application and logging functions while minimizing the loss of operation for the users and loss of log data.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "In the admin console, Click Servers >> Clusters >> WebSphere application server clusters.

Define a cluster for every high availability application as outlined in the System Security Plan documentation.

Refer to vendor documentation for steps on creating a fail over cluster."
      reference   : "CAT|III,CCI|CCI-000140,Rule-ID|SV-95965r1_rule,STIG-ID|WBSP-AS-000670,Vuln-ID|V-81251"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000740 - The WebSphere Application Server must be configured to protect log information from any type of unauthorized read access."
      info            : "WebSphere uses role-based access controls to restrict access to log data. To take advantage of this capability, WebSphere administrators must identify specific users and place them into their respective roles. The auditor role is used for controlling access to logs."
      solution        : "On the system hosting the WebSphere application server, log on to the operating system with admin rights.

Navigate to the WebSphere folder, change permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set 'WebSphere' folder permissions to '770'.

For Windows systems: set 'WebSphere' folder permission to allow full control for SYSTEM, WebSphere user and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|III,CCI|CCI-000162,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95967r1_rule,STIG-ID|WBSP-AS-000740,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81253"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000750 - The WebSphere Application Server must protect log information from unauthorized modification."
      info            : "WebSphere uses role-based access controls to restrict access to log data. To take advantage of this capability, WebSphere administrators must identify specific users and place them into their respective roles. The auditor role is used for controlling access to logs."
      solution        : "On the system hosting the WebSphere application server, log on to the operating system with admin rights.

Navigate to the 'WebSphere' folder, change permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set 'WebSphere folder' permissions to '770'.

For Windows systems: set 'WebSphere folder' permission to allow full control for SYSTEM, WebSphere user, and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|II,CCI|CCI-000163,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95969r1_rule,STIG-ID|WBSP-AS-000750,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81255"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000760 - The WebSphere Application Server must protect log information from unauthorized deletion."
      info            : "WebSphere uses role based access controls to restrict access to log data. To take advantage of this capability, WebSphere administrators must identify specific users and place them into their respective roles. The auditor role is used for controlling access to logs."
      solution        : "On the system hosting the WebSphere application server, log on to the operating system with admin rights.

Navigate to the WebSphere folder, change permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set 'WebSphere' folder permissions to '770'.

For Windows systems: set 'WebSphere' folder permission to allow full control for SYSTEM, WebSphere user, and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|II,CCI|CCI-000164,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95971r1_rule,STIG-ID|WBSP-AS-000760,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81257"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000770 - The WebSphere Application Server wsadmin file must be protected from unauthorized access."
      info            : "Protecting log data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to log tools be controlled and protected from unauthorized access.

Application servers provide a web- and/or a command line-based management functionality for managing the application server log capabilities. In addition, subsets of log tool components may be stored on the file system as jar or xml configuration files. The application server must ensure that in addition to protecting any web-based log tools, any file system-based tools are protected as well."
      solution        : "On the system hosting the WebSphere application server, log on to the operating system with admin rights.

Navigate to the 'WebSphere' folder, and change permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set the 'WebSphere' folder permissions to '770'.

For Windows systems: set the 'WebSphere' folder permission to allow full control for SYSTEM, WebSphere user, and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|II,CCI|CCI-001493,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95973r1_rule,STIG-ID|WBSP-AS-000770,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81259"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000780 - The WebSphere Application Server wsadmin file must be protected from unauthorized modification."
      info            : "Protecting log data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to log tools be controlled and protected from unauthorized modification. If an attacker were to modify log tools, he could also manipulate logs to hide evidence of malicious activity.

Application servers provide a web- and/or a command line-based management functionality for managing the application server log capabilities. In addition, subsets of log tool components may be stored on the file system as jar or xml configuration files. The application server must ensure that in addition to protecting any web-based log tools, any file system-based tools are protected as well."
      solution        : "On the system hosting the WebSphere Application Server, log on to the operating system with admin rights.

Navigate to the 'WebSphere' folder.

Change the permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set the 'WebSphere' folder permissions to '770'.

For Windows systems: set the 'WebSphere' folder permission to allow full control for SYSTEM, WebSphere user, and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|II,CCI|CCI-001494,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95975r1_rule,STIG-ID|WBSP-AS-000780,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81261"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000790 - The WebSphere Application Server wsadmin file must be protected from unauthorized deletion."
      info            : "Protecting log data also includes identifying and protecting the tools used to view and manipulate log data.

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data.

It is, therefore, imperative that access to log tools be controlled and protected from unauthorized modification. If an attacker were to delete log tools, the application server administrator would have no way of managing or viewing the logs.

Application servers provide a web- and/or a command line-based management functionality for managing the application server log capabilities. In addition, subsets of log tool components may be stored on the file system as jar, class, or xml configuration files. The application server must ensure that in addition to protecting any web-based log tools, any file system-based tools are protected from unauthorized deletion as well."
      solution        : "On the system hosting the WebSphere application server, log on to the operating system with admin rights.

Navigate to the 'WebSphere' folder, change permissions on the folder. Do not propagate permissions to sub-folders.

For UNIX systems: set the 'WebSphere' folder permissions to '770'.

For Windows systems: set 'WebSphere' folder permission to allow full control for SYSTEM, WebSphere user, and Admin Group. Do not propagate permissions to sub-folders."
      reference       : "800-171|3.1.5,800-53|AC-6,CAT|II,CCI|CCI-001495,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-95977r1_rule,STIG-ID|WBSP-AS-000790,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-81263"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_USER@ replaced with "was" in field "powershell_args".
# Note: Variable @WEBSPHERE_GROUP@ replaced with "was" in field "powershell_args".
      powershell_args : "$file = 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer'; $status = 'PASSED'; $acls = (icacls $file); foreach ($acl in $acls) { if (!$acl) { continue } elseif ($acl -like '*NT AUTHORITY\SYSTEM:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like '*was:*') { $acl; continue } elseif ($acl -like 'Successfully processed *') { continue } else { $acl + '- WARNING - extra permissions'; $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000810 - The WebSphere Application Server must be configured to encrypt log information."
      info            : "Protection of log records is of critical importance. Encrypting log records provides a level of protection that does not rely on host-based protections that can be accidentally misconfigured, such as file system permissions. Cryptographic mechanisms are the industry-established standard used to protect the integrity of log data. An example of a cryptographic mechanism is the computation and application of a cryptographic-signed hash using asymmetric cryptography. Encryption of log records must be tempered with architecture designs that incorporate log data into SIEM systems that read and act upon log data. Some SIEM systems may not be able to decrypt encrypted log data so encrypting the logs could be detrimental to the incident response process. This must be taken into account and addressed in the security plan."
      solution        : "From the administrative console, click Security >> Security Auditing >> Audit record encryption configuration.

Select the 'Enable encryption' checkbox.

Select the keystore that contains the encrypting certificate from the drop-down menu or click 'New' to create a new keystore.

If you are using an existing certificate to encrypt your audit records, ensure the Certificate in the keystore is selected and specify the intended certificate in the 'Certificate alias' drop-down menu.

If you are generating a new certificate to encrypt your audit records, do NOT use the 'Create a new certificate in the selected keystore' option, this will generate a SHA-1 signed certificate, which is not allowed.

Instead, select Security >> SSL Certificate and key management >> KeyStores and Certificates.

Select the keystore that is associated with the server hosting the audit logs.

Select 'Personal Certificates'.

Select 'Create'.

Select either a CA-Signed or Chained Certificate based on your requirements.

Fill in the information required to generate the certificate.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.3.8,800-53|AU-9(3),CAT|II,CCI|CCI-001350,CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-95979r1_rule,STIG-ID|WBSP-AS-000810,TBA-FIISB|37.3.3,Vuln-ID|V-81265"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditPolicy[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*encrypt=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000820 - The WebSphere Application Server must be configured to sign log information."
      info            : "Protection of log records is of critical importance. Encrypting log records provides a level of protection that does not rely on host-based protections that can be accidentally misconfigured, such as file system permissions. Cryptographic mechanisms are the industry-established standard used to protect the integrity of log data. An example of a cryptographic mechanism is the computation and application of a cryptographic-signed hash using asymmetric cryptography."
      solution        : "From the administrative console, click Security >> Security Auditing >> Audit record signing configuration.

Select the 'Enable signing' checkbox.

Select the keystore that contains the encrypting certificate from the drop-down menu.

If you are using an existing certificate to sign your audit records, ensure the Certificate in keystore is selected and specify the intended certificate in the 'Certificate alias' drop-down menu.

If you are generating a new certificate to sign your audit records, do NOT use the 'Create a new certificate in the selected keystore' option, this will generate a SHA-1 signed certificate, which is not allowed.

Instead, select Security >> SSL Certificate and key management >> KeyStores and Certificates.

Select the keystore that is associated with the server hosting the audit logs.

Select 'Personal Certificates'.

Select 'Create'.

Select either a CA-Signed or Chained Certificate based on your requirements.

Fill in the information required to generate the certificate.

Restart the DMGR and all the JVMs."
      reference       : "800-171|3.3.8,800-53|AU-9(3),CAT|II,CCI|CCI-001350,CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(3),NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-95981r1_rule,STIG-ID|WBSP-AS-000820,TBA-FIISB|37.3.3,Vuln-ID|V-81267"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\audit.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<auditPolicy[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*sign=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000910 - The WebSphere Application Server process must not be started from the command line with the -password option."
      info            : "The use of the -password option to launch a WebSphere process from the command line can result in a security exposure. Password information may become visible to any user with the ability to view system processes. For example, on a Linux system the 'ps' command will display all running processes, which would include all of the command line flags used to start a WebSphere process."
      solution        : "When starting WebSphere commands, such as wsadmin, stopManager, stopNode, stopServer, or syncNode; do not use the '-password <password>' option.

Use the interactive mode instead; you will be prompted for user id and password.

For scripts, you may configure user id and password in the 'connector properties' files. These files are under 'Profile_Root/Properties' folder.

- soap.client.props: for default SOAP
- sas.client.props : for RMI and JSR160RMI connectors
- ipc.client.props: for IPC connector"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-95983r1_rule,STIG-ID|WBSP-AS-000910,SWIFT-CSCv1|2.3,Vuln-ID|V-81269"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
      powershell_args : "$status = 'PASSED'; $procs = Get-WmiObject Win32_Process -Filter {name = 'wsadmin.exe'}; foreach ($proc in $procs) { $value = Select-String -Path $file -Pattern '-password'; ''; $value; if ($value) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000920 - The WebSphere Application Server files must be owned by the non-root WebSphere user ID."
      info        : "Having files owned by the root or administrator user is an indication that the WebSphere processes are being run with escalated privileges. Running as root/admin user gives attackers elevated privileges that can be used to compromise the system more easily compared to operating the WebSphere processes with regular user privileges.

Specifying a regular OS user when installing and managing WebSphere is best practice. By doing so, the WebSphere files will be owned by the user ID specified rather than being owned by the admin user.

Use the underlying OS file permissions to ensure that access to the WebSphere files are restricted to only those users who require access.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Note: executing this fix without proper planning regarding file ownership can render your installation inoperable. See vulnerability discussion before executing this fix.

Ensure all WebSphere related files and folders are owned by the WebSphere OS user.

Ensure OS group membership is restricted.

File ownership changes for UNIX systems:
chown -R <user> <WAS_HOME>
chown -R <user> <PROFILE_HOME>,
chown -R <user> <OTHER_HOME>, <OTHER_HOME> may be zero or more directories for other files

Group ownership changes for UNIX systems:
chgrp -R <user> <WAS_HOME>
chgrp -R <user> <PROFILE_HOME>,
chgrp -R <user> <OTHER_HOME>, where <OTHER_HOME> may be zero or more root directories for other files

File ownership changes for Windows systems:
'takeown /r /u <user> /f <directory /p <password of user>', where the <directory> is <WAS_HOME>, <PROFILE_HOME>, or <OTHER_HOME>"
      reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-95985r1_rule,STIG-ID|WBSP-AS-000920,Vuln-ID|V-81271"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000930 - The WebSphere Application Server sample applications must be removed."
      info            : "WebSphere samples are not intended for use in a production environment. Do not run them there, as they create significant security risks. In particular, the snoop servlet can provide an outsider with tremendous amounts of information about your system. This is precisely the type of information you do not want to give a potential intruder.

Do not install the samples during the profile creation or uninstall the sample programs."
      solution        : "Navigate to Applications >> All Applications.

Click on the corresponding application checkbox.

Select 'Remove'.

Click 'OK'.

Click 'Save'."
      reference       : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-95987r1_rule,STIG-ID|WBSP-AS-000930,SWIFT-CSCv1|2.3,Vuln-ID|V-81273"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "None"
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "if( Test-Path -Path 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\samples' ) { $files=ls 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\samples\*'; if ($files -eq $Null) { 'None' } else { $files } } else { 'None' }"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-000940 - The WebSphere Application Server must remove JREs left by web server and plug-in installers in the DMZ."
      info        : "When you install IBM HTTP Server, the installer leaves behind a JRE. Remove this JRE, as it provides functions that are not needed by the Web server or plug-in under normal conditions. Keep in mind that this will make it impossible to run some tools such as ikeyman on this Web server.

When you install the WebSphere Application Server HTTP Server plug-in using the IBM installer, it also leaves behind a JRE. Also, remove this JRE post install.

Having a functioning JRE in the DMZ provides attackers who have breached into the DMZ with additional tools to carry out further attacks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "For web servers provided with the WebSphere installation that are operating in the DMZ.

Remove the /java directory from within the plugins folder."
      reference   : "CAT|III,CCI|CCI-000381,Rule-ID|SV-95989r1_rule,STIG-ID|WBSP-AS-000940,Vuln-ID|V-81275"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-000960 - The WebSphere Application Server must be run as a non-admin user."
      info        : "Running WebSphere as an admin user gives attackers immediate admin privileges in the event the WebSphere processes are compromised.

Best practice is to operate the WebSphere server with an account that has limited OS privileges.

To configure system startup: https://www.ibm.com/support/knowledgecenter/en/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/trun_processrestart.html

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Ensure that WAS processes are started via the specified non-privileged OS user ID when running commands such as startManager, startNode, and startServer.

If startManager and startNode are in the system startup scripts, ensure that they are not started as the root user or admin user for Windows systems.

For example, in the UNIX system, the inittab entry may look like: 'was:235:respawn:/usr/WebSphere/AppServer/bin/rc.was >/dev/console 2>&amp;1'.

Ensure the user is not a root user and is instead a regular OS user."
      reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-95991r1_rule,STIG-ID|WBSP-AS-000960,Vuln-ID|V-81277"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-000970 - The WebSphere Application Server must disable JSP class reloading."
      info        : "Application servers provide a myriad of differing processes, features, and functionalities. Some of these processes may be deemed to be unnecessary or too unsecure to run on a production DoD system. Application servers must provide the capability to disable or deactivate functionality and services that are deemed to be non-essential to the server mission or can adversely impact server performance, for example, disabling dynamic JSP reloading on production application servers as a best practice.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "To disable JSP reloading:

From the admin console, navigate to: Applications >> All applications >> [application name] >> JSP and JSP options.

Uncheck 'JSP enable class reloading'."
      reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-95993r1_rule,STIG-ID|WBSP-AS-000970,Vuln-ID|V-81279"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-000980 - The WebSphere Application Server must prohibit or restrict the use of nonsecure ports, protocols, modules, and/or services"
      info            : "Some networking protocols may not meet organizational security requirements to protect data and components.

Application servers natively host a number of various features, such as management interfaces, httpd servers, and message queues. These features all run on TCPIP ports. This creates the potential that the vendor may choose to utilize port numbers or network services that have been deemed unusable by the organization. The application server must have the capability to both reconfigure and disable the assigned ports without adversely impacting application server operation capabilities. For a list of approved ports and protocols, reference the DoD ports and protocols website at https://powhatan.iiie.disa.mil/ports/cal.html.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "Ensure all available ports are registered with PPSM."
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-96007r1_rule,STIG-ID|WBSP-AS-000980,SWIFT-CSCv1|2.3,Vuln-ID|V-81293"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'MANUAL REVIEW'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\serverindex.xml'; foreach ($file in $files) { $file.FullName + ':'; Get-Content -Raw -Path $file | Select-String -Pattern '^[\s]*<endPoint[\s].*' -AllMatches | % { $_.Matches.Value }; '' }"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001010 - The WebSphere Application Server LDAP user registry must be used."
      info        : "To assure accountability and prevent unauthorized access, application server users must be uniquely identified and authenticated. This is typically accomplished via the use of a user store which is either local (OS-based) or centralized (LDAP) in nature.

To ensure support to the enterprise, the authentication must utilize an enterprise solution.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "In the administrative console, click Security >> Global security.

Under 'User account repository', click the 'Available realm definitions' drop-down list.

Select 'Standalone LDAP' registry.

Click 'Configure'.

Provide the Primary Administrative user name, type of LDAP server, hostname for the LDAP server, define the Base distinguished name.

Click 'OK'.

On 'Global security' panel, click 'Set as current'.

Click 'Apply'.

Click 'Save'.

Recycle and synchronize the JVMS."
      reference   : "CAT|II,CCI|CCI-000764,Rule-ID|SV-96013r1_rule,STIG-ID|WBSP-AS-001010,Vuln-ID|V-81299"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001020 - The WebSphere Application Server local file-based user registry must not be used."
      info        : "WebSphere does not provide direct audit of changes to the built-in file registry. The built-in file registry must not be used to support user logon accounts. Use an LDAP/AD server and manage user accounts centrally.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Navigate to Security >> Global Security.

Under 'User Account Repository', select 'Stand alone LDAP' from the 'Available realm definitions' drop-down.

Click on 'Configure'.

Select an existing user from the LDAP directory to be the primary WebSphere admin user.

Identify the type of LDAP server; specify an IP or DNS name for the LDAP Server, and the port used to connect to the LDAP server.

Specify BASE DN.

Specify the BIND DN.

Specify the BIND Password.

Select the 'SSL enabled' check box to use secure LDAP.

Click 'Apply'.

Click 'Save'.

Go to Global Security.

Select 'Standalone LDAP registry' from the 'Available realm definitions' drop-down.

Click 'Set as current'.

Click 'Apply'.

Click 'Save'.

Restart the dmgr and synchronize the JVMs."
      reference   : "CAT|II,CCI|CCI-000764,Rule-ID|SV-96019r1_rule,STIG-ID|WBSP-AS-001020,Vuln-ID|V-81305"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001030 - The WebSphere Application Server multifactor authentication for network access to privileged accounts must be used."
      info            : "Multifactor authentication creates a layered defense and makes it more difficult for an unauthorized person to access the application server. If one factor is compromised or broken, the attacker still has at least one more barrier to breach before successfully breaking into the target. Unlike a simple username/password scenario where the attacker could gain access by knowing both the username and password without the user knowing his account was compromised, multifactor authentication adds the requirement that the attacker must have something from the user, such as a token, or to biometrically be the user.

Multifactor authentication is defined as: using two or more factors to achieve authentication.

Factors include:
(i) something a user knows (e.g., password/PIN);
(ii) something a user has (e.g., cryptographic identification device, token); or
(iii) something a user is (e.g., biometric). A CAC or PKI Hardware Token meets this definition.

A privileged account is defined as an information system account with authorizations of a privileged user. These accounts would be capable of accessing the web management interface.

When accessing the application server via a network connection, administrative access to the application server must be PKI Hardware Token enabled.

Satisfies: SRG-APP-000149-AS-000102, SRG-APP-000391-AS-000239, SRG-APP-000392-AS-000240, SRG-APP-000151-AS-000103, SRG-APP-000177-AS-000126, SRG-APP-000402-AS-000247, SRG-APP-000403-AS-000248, SRG-APP-000404-AS-000249, SRG-APP-000219-AS-000147"
      solution        : "From the admin console, select System Administration >> Deployment Manager >> Java and Process Management >> Process definition >> Java Virtual Machine >> Custom Properties.

Select 'New'.

Insert the following case sensitive value into the 'Name' field: 'adminconsole.certLogin'.

Select 'Value'.

Enter 'true'.

Click 'Apply'.

Click 'Save'.

Select Security >> SSL Certificate and Key management >> SSL Configurations >> Select CellDefaultSSLSettings >> Quality of Protection (QOP) settings.

In the 'Client Authentication' drop-box, make sure 'Supported' or 'Required' is selected.

Click 'Apply'.

Click 'Save'.

Save a backup copy and edit the 'Web.xml' file as follows: <WAS_INSTALL>/profiles/<profileName>/config/cells/<cellName>/applications/isclite.ear/deployments/isclite/isclite.war/WEB-INF/web.xml:
--- Change:
< security-constraint>
<web-resource-collection>
<web-resource-name>Protected Area</web-resource-name>
<url-pattern>/</url-pattern>
--- So it becomes:
< security-constraint>
<web-resource-collection>
<web-resource-name>Protected Area</web-resource-name>
<url-pattern>/</url-pattern>
<url-pattern>/logon.jsp</url-pattern>
<url-pattern>/logonError.jsp</url-pattern>
--- Add these security constraints if not already present:
<security-constraint>
<web-resource-collection>
<web-resource-name>free pages</web-resource-name>
<url-pattern>/*.jsp</url-pattern>
<url-pattern>/css/*</url-pattern>
<url-pattern>/images/*</url-pattern>
<url-pattern>/j_security_check</url-pattern>
</web-resource-collection>
</security-constraint>
--- Change:
<auth-method>FORM</auth-method>
to
<auth-method>CLIENT-CERT</auth-method>

Save the 'web.xml' file.

Stop and restart the Deployment Manager.

Log on to the admin console using your certificate."
      reference       : "800-171|3.5.3,800-53|IA-2(1),CAT|II,CCI|CCI-000187,CCI|CCI-000765,CCI|CCI-000767,CCI|CCI-001184,CCI|CCI-001953,CCI|CCI-001954,CCI|CCI-002009,CCI|CCI-002010,CCI|CCI-002011,CN-L3|7.1.2.7(b),CSF|PR.AC-1,ITSG-33|IA-2(1),NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,Rule-ID|SV-96025r1_rule,STIG-ID|WBSP-AS-001030,SWIFT-CSCv1|1.2,Vuln-ID|V-81311"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\applications\isclite.ear\deployments\isclite\isclite.war\WEB-INF\web.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '<auth-method>FORM</auth-method>'; ''; $value; if ($value) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001080 - The WebSphere Application Server must provide security extensions to extend SOAP protocol and provide secure authentication"
      info        : "Application servers may provide a web services capability that could be leveraged to allow remote access to sensitive application data. A web service which is a repeatable process used to make data available to remote clients, should not be confused with a web server.

Many web services utilize SOAP, which in turn utilizes XML and HTTP as a transport. Natively, SOAP does not provide security protections. As such, the application server must provide security extensions to enhance SOAP capabilities to ensure that secure authentication mechanisms are employed to protect sensitive data. The WS_Security suite is a widely used and acceptable SOAP security extension.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "To attach policy sets for your service providers:
From admin console, navigate to Applications >> All applications >> [application].

For each application that is a web service provider and requires secure authentication, click on 'Service provider policy sets and bindings.'

Click button on the 'Select' column to select a resource.

Click on 'Attach Policy Set' drop down.

Select policy set that best matches the provider environment.

Click button on the 'Select' column to select the same resource.

Click on the 'Assign binding' drop down.

Select a binding that best matches the environment.

Click 'Save'.

Restart DMGR and resync the JVMs."
      reference   : "CAT|II,CCI|CCI-001941,Rule-ID|SV-96039r1_rule,STIG-ID|WBSP-AS-001080,Vuln-ID|V-81325"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001090 - The WebSphere Application Server must provide security extensions to extend SOAP protocol and provide secure authentication"
      info        : "Application servers may provide a web services capability that could be leveraged to allow remote access to sensitive application data. A web service, which is a repeatable process used to make data available to remote clients, should not be confused with a web server.

Many web services utilize SOAP, which in turn utilizes XML and HTTP as a transport. Natively, SOAP does not provide security protections. As such, the application server must provide security extensions to enhance SOAP capabilities to ensure that secure authentication mechanisms are employed to protect sensitive data. The WS_Security suite is a widely used and acceptable SOAP security extension.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "To attach policy sets for your service clients:
From admin console, navigate to Applications >> All applications >> [application].

For each application that is a web service client and requires secure authentication, click on 'Service client policy sets and bindings.'

Click button on the 'Select' column to select a resource.

Click on 'Attach Client Policy Set' drop down.

Select policy set that best matches the environment.

Click button on the 'Select' column to select the same resource.

Click on the 'Assign binding' drop down.

Select a binding that best matches the environment.

Click 'Save'.

Restart DMGR and resync the JVMs."
      reference   : "CAT|II,CCI|CCI-001941,Rule-ID|SV-96043r1_rule,STIG-ID|WBSP-AS-001090,Vuln-ID|V-81329"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001110 - WebSphere Application Server must authenticate all network-connected endpoint devices before establishing any connection"
      info            : "Device authentication requires unique identification and authentication that may be defined by type, by specific device, or by a combination of type and device.

Device authentication is accomplished via the use of certificates and protocols such as SSL mutual authentication.

Device authentication is performed when the application server is providing web services capabilities and data protection requirements mandate the need to establish the identity of the connecting device before the connection is established.

Note: with LDAP registry, the entire DN in the certificate is used to look up LDAP. Filters may be configured. With other registries, only the first attribute after the first '=', e.g., CN=<user> is used.

https://www.ibm.com/support/knowledgecenter/prodconn_1.0.0/com.ibm.scenarios.wmqwassecure.doc/topics/implementing.htm?cp=SSEQTP_8.0.0

Satisfies: SRG-APP-000394-AS-000241, SRG-APP-000177-AS-000126

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "From the admin console, navigate to Security >> SSL Certificate and Key Management >> SSL Configuration.

For each [NodeDefaultSSLSettings] select Quality of Protection (QoP) Settings.

Set 'Client authentication' according to the security plan."
      reference       : "800-53|IA-3,CAT|II,CCI|CCI-000187,CCI|CCI-001958,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-96047r1_rule,STIG-ID|WBSP-AS-001110,TBA-FIISB|27.1,Vuln-ID|V-81333"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<setting[\s].*clientAuthentication=.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*clientAuthentication=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001120 - WebSphere Application Server must authenticate all endpoint devices before establishing a local, remote, network connection"
      info            : "Device authentication requires unique identification and authentication that may be defined by type, by specific device, or by a combination of type and device.

Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.

Device authentication is performed when the application server is providing web services capabilities and data protection requirements mandate the need to establish the identity of the connecting device before the connection is established.

Because of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.

Note: with LDAP registry, the entire DN in the certificate is used to look up LDAP. Filters may be configured. With other registries, only the first attribute after the first '=', e.g., CN=<user> is used.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "From the admin console, navigate to Security >> SSL Certificate and Key Management >> SSL Configuration.

For each [NodeDefaultSSLSettings] select Quality of Protection (QoP) Settings.

Set 'Client authentication' according to the security plan."
      reference       : "800-53|IA-3,CAT|II,CCI|CCI-001967,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-96055r1_rule,STIG-ID|WBSP-AS-001120,TBA-FIISB|27.1,Vuln-ID|V-81341"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<setting[\s].*clientAuthentication=.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*clientAuthentication=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001180 - WebSphere Application Server application security must be enabled for each security domain except for publicly available"
      info            : "By default, all administrative and user applications in WebSphere Application Server use the global security configuration. For example, a user registry defined in global security is used to authenticate users for every application in the cell. WebSphere allows for additional WebSphere security domains where different security attributes for some or all of your user applications can be set. These domains must also be configured to use application security."
      solution        : "Navigate to security >> security domains.

Click through each security domain.

If 'Customize for this domain' is checked for Application Security under the Security Attributes, but 'Enable application security' is not checked, check 'Enable application security'.

Expand 'show' to find all affected nodes and servers.

Click 'OK'.

Click 'Save'.

Synchronize the changes.

Restart all affected nodes and servers."
      reference       : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000197,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-96057r1_rule,STIG-ID|WBSP-AS-001180,SWIFT-CSCv1|2.3,Vuln-ID|V-81343"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\waspolicies\default\securitydomains\*\domain-security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:AppSecurity[\s].*'; ''; $value; if ($value | Select-String -Pattern '[\s]*appEnabled=.false.') { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001200 - The WebSphere Application Server secure LDAP (LDAPS) must be used for authentication."
      info            : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.

Application servers have the capability to utilize LDAP directories for authentication. If LDAP connections are not protected during transmission, sensitive authentication credentials can be stolen. When the application server utilizes LDAP, the LDAP traffic must be encrypted.

To ensure an error-free operation for this step, first extract to a file the Signer certificate of the LDAP and send that file to the WebSphere Application Server machine. Then add the certificate to the truststore being defined for the LDAP. In this way, you are assured that the remaining actions for this step will be successful.

Satisfies: SRG-APP-000172-AS-000121, SRG-APP-000172-AS-000120"
      solution        : "In the administrative console, click Security >> Global security.

Under User account repository, click the 'Available realm definitions' drop-down list.

Select Standalone LDAP registry.

Click 'Configure'.

Click 'SSL enabled'.

Click 'OK'.

On Global security panel, click 'Set as current'.

Click 'Apply'.

Click 'Save'.

To ensure an error-free operation for this step, you need to first extract to a file the Signer certificate of the LDAP and send that file to the WebSphere Application Server machine. You can then add the certificate to the trust store being defined for the LDAP. In this way, you are assured that the remaining actions for this step will be successful."
      reference       : "800-171|3.1.1,800-53|AC-3,CAT|I,CCI|CCI-000197,CN-L3|8.1.10.2(c),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,Rule-ID|SV-96061r1_rule,STIG-ID|WBSP-AS-001200,TBA-FIISB|31.1,Vuln-ID|V-81347"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<userRegistries[\s].*security:LDAPUserRegistry.*'; ''; $value; if (($value | Select-String -Pattern '[\s]*sslEnabled=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001210 - The WebSphere Application Server must prohibit the use of cached authenticators after an organization-defined time period."
      info            : "When the application server is using PKI authentication, a local revocation cache must be stored for instances when the revocation cannot be authenticated through the network, but if cached authentication information is out of date, the validity of the authentication information may be questionable."
      solution        : "From the admin console, navigate to Security >> Global Security >> Authentication.

Click on 'Authentication cache' settings.

Enter the settings for 'Cache timeout' in accordance with the parameters defined in the Systems Security Plan."
      reference       : "800-53|IA-5(13),CAT|II,CCI|CCI-002007,CSF|PR.AC-1,Rule-ID|SV-96065r1_rule,STIG-ID|WBSP-AS-001210,Vuln-ID|V-81351"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<security:Security[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*cacheTimeout=.([1-9][0-9]?|[1-5][0-9]{2}|600)[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001230 - The WebSphere Application Server default keystore passwords must be changed."
      info            : "The cornerstone of the PKI is the private key used to encrypt or digitally sign information.

If the private key is stolen, this will lead to the compromise of the authentication and non-repudiation gained through PKI because the attacker can use the private key to digitally sign documents and can pretend to be the authorized user.

Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to keep the private keys. Java-based application servers utilize the Java keystore, which provides storage for cryptographic keys and certificates. The keystore is usually maintained in a file stored on the file system."
      solution        : "Navigate to Security >> SSL Certificate and Key Management >> Key stores and certificates.

Select a keystore from the list.

Click 'Change Password'.

Enter the new password and password confirmation.

Click 'OK'.

Repeat for every keystore in the list.

Synchronize changes to all nodes."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|I,CCI|CCI-000186,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-96071r1_rule,STIG-ID|WBSP-AS-001230,Vuln-ID|V-81357"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\logs\dmgr\SystemOut.log'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern 'CWPKI0041W'; ''; $value; if ($value) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001260 - The WebSphere Application Server must use signer for DoD-issued certificates."
      info        : "The cornerstone of PKI is the private key used to encrypt or digitally sign information. The key by itself is a cryptographic value that does not contain specific user information, but the key can be mapped to a user. Without mapping the certificate used to authenticate to the user account, the ability to determine the identity of the individual user or group will not be available for forensic analysis.

Application servers must provide the capability to utilize and meet requirements of the DoD Enterprise PKI infrastructure for application authentication.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Obtain the signer certificate either as Base 64 encoded ASCII file, or as binary DER data.

Navigate to Security >> SSl certificate and key management >> SSL Configurations >> CellDefaultSSLSettings >> key stores and certificates.

Click on cell default trust store.

Click on 'Signer Certificates'.

Click 'Add'.

Enter a new alias for the signer, and the location of the file that stores signer certificate.

For 'Data type', choose the type appropriate for the file, either Base64-encoded ASCII data file, or binary DER data.

Click 'OK'."
      reference   : "CAT|II,CCI|CCI-000187,Rule-ID|SV-96075r1_rule,STIG-ID|WBSP-AS-001260,Vuln-ID|V-81361"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001290 - WebSphere Application Server must utilize FIPS 140-2-approved encryption modules when authenticating users and processes."
      info            : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms. The use of TLS provides confidentiality of data in transit between the application server and client. FIPS 140-2 approved TLS versions include TLS V1.0 or greater.

TLS must be enabled and non-FIPS-approved SSL versions must be disabled. NIST SP 800-52 specifies the preferred configurations for government systems.

Satisfies: SRG-APP-000179-AS-000129, SRG-APP-000440-AS-000167, SRG-APP-000442-AS-000259, SRG-APP-000439-AS-000155, SRG-APP-000224-AS-000152, SRG-APP-000514-AS-000136, SRG-APP-000416-AS-000140"
      solution        : "From administrative console, click Security >> SSL certificate and key management >> Manage FIPS.

Check 'Enable FIPS 140-2'.

Click 'Save'.

Synchronize with the nodes.

Restart all the JVMs."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000803,CCI|CCI-001188,CCI|CCI-002418,CCI|CCI-002421,CCI|CCI-002422,CCI|CCI-002450,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-96079r1_rule,STIG-ID|WBSP-AS-001290,Vuln-ID|V-81365"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<properties[\s].*name=.com.ibm.security.useFIPS.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*value=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001300 - The WebSphere Application Server must accept PIV credentials from other federal agencies to access management interface."
      info            : "Personal Identity Verification (PIV) credentials are those credentials issued by federal agencies that conform to FIPS Publication 201 and supporting guidance documents. OMB Memorandum 11-11 requires federal agencies to continue implementing the requirements specified in HSPD-12 to enable agency-wide use of PIV credentials. PIV credentials are only used in an unclassified environment.

Access may be denied to authorized users if federal agency PIV credentials are not accepted to access the management interface."
      solution        : "From the admin console, select System Administration >> Deployment Manager >> Java and Process Management >> Process definition >> Java Virtual Machine >> Custom Properties.

Select 'New'.

Insert the following case sensitive value into the 'Name' field: 'adminconsole.certLogin'

Select 'Value'.

Enter 'true'.

Click 'Apply'.

Click 'Save'.

Select Security >> SSL Certificate and Key management >> SSL Configurations >> Select CellDefaultSSLSettings >> Quality of Protection (QOP) settings.

In the 'Client Authentication' drop box, make sure 'Supported' or 'Required' is selected.

Click 'Apply'.

Click 'Save'.

Save a backup copy and edit the Web.xml file as follows: <WAS_INSTALL>/profiles/<profileName>/config/cells/<cellName>/applications/isclite.ear/deployments/isclite/isclite.war/WEB-INF/web.xml:
--- Change:
< security-constraint>
<web-resource-collection>
<web-resource-name>Protected Area</web-resource-name>
<url-pattern>/</url-pattern>
--- So it becomes:
< security-constraint>
<web-resource-collection>
<web-resource-name>Protected Area</web-resource-name>
<url-pattern>/</url-pattern>
<url-pattern>/logon.jsp</url-pattern>
<url-pattern>/logonError.jsp</url-pattern>
--- Add these security constraints if not already present:
<security-constraint>
<web-resource-collection>
<web-resource-name>free pages</web-resource-name>
<url-pattern>/*.jsp</url-pattern>
<url-pattern>/css/*</url-pattern>
<url-pattern>/images/*</url-pattern>
<url-pattern>/j_security_check</url-pattern>
</web-resource-collection>
</security-constraint>
--- Change:
<auth-method>FORM</auth-method>
to
<auth-method>CLIENT-CERT</auth-method>

Save the 'web.xml' file.

Stop and restart the Deployment Manager.

Log on to the admin console using your certificate."
      reference       : "800-171|3.5.3,800-53|IA-2(1),CAT|II,CCI|CCI-002009,CN-L3|7.1.2.7(b),CSF|PR.AC-1,ITSG-33|IA-2(1),NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,Rule-ID|SV-96081r1_rule,STIG-ID|WBSP-AS-001300,SWIFT-CSCv1|1.2,Vuln-ID|V-81367"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\applications\isclite.ear\deployments\isclite\isclite.war\WEB-INF\web.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '<auth-method>FORM</auth-method>'; ''; $value; if ($value) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001370 - The WebSphere Application Server must use DoD-approved Signer Certificates."
      info        : "Class 3 PKI certificates are used for servers and software signing rather than for identifying individuals. Class 4 certificates are used for business-to-business transactions. Utilizing unapproved certificates not issued or approved by DoD or CNS creates an integrity risk. The application server must utilize approved DoD or CNS Class 3 or Class 4 certificates for software signing and business-to-business transactions.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Utilize DoD certificates that have been issued by a DoD PKI CA.

To replace a non-DoD PKI-established certificate:
From the administrative console, navigate to Security >> SSL Certificates and Key Management >> KeyStores and Certificates.

For each keystore that requires the change:
Import a new certificate by clicking 'Import'.

Click 'keystore' file.

Enter the location of the new certificate.

Specify the type of keystore and keystore password.

Specify alias information.

Click 'Apply'.

After the certificate is imported, click on 'Replace' to replace the original certificate with the new certificate."
      reference   : "CAT|II,CCI|CCI-002450,Rule-ID|SV-96083r1_rule,STIG-ID|WBSP-AS-001370,Vuln-ID|V-81369"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001390 - The WebSphere Application Servers must not be in the DMZ."
      info        : "The application server consists of the management interface and hosted applications. By separating the management interface from hosted applications, the user must authenticate as a privileged user to the management interface before being presented with management functionality. This prevents non-privileged users from having visibility to functions not available to the user. By limiting visibility, a compromised non-privileged account does not offer information to the attacker to functionality and information needed to further the attack on the application server.

Application server management functionality includes functions necessary to administer the application server and requires privileged access via one of the accounts assigned to a management role. The hosted application and hosted application functionality consists of the assets needed for the application to function, such as the business logic, databases, user authentication, etc.

The separation of application server administration functionality from hosted application functionality is either physical or logical and is accomplished by using different computers, different central processing units, different instances of the operating system, network addresses, network ports, or combinations of these methods, as appropriate.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "If any application server host is installed in the DMZ, reassign IP address to a secured network and reconfigure the application server."
      reference   : "CAT|II,CCI|CCI-001082,Rule-ID|SV-96085r1_rule,STIG-ID|WBSP-AS-001390,Vuln-ID|V-81371"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001410 - The WebSphere Application Server DoD root CAs must be in the trust store."
      info        : "This control focuses on communications protection at the session, versus packet level.

At the application layer, session IDs are tokens generated by web applications to uniquely identify an application user's session. Web applications utilize session tokens or session IDs in order to establish application user identity. Proper use of session IDs addresses man-in-the-middle attacks, including session hijacking or insertion of false information into a session.

Application servers must provide the capability to perform mutual authentication. Mutual authentication is when both the client and the server authenticate each other.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Navigate to Security >> SSL certificate and key management >> Keystore and certificates.

Click on the trust store used to store the signers of the administrators' certificates. (The default is cellDefaultTrustStore).

Click on 'Signer Certificates'.

Click 'Add'.

Follow the instructions to import the signer from a file.

Click 'OK'."
      reference   : "CAT|II,CCI|CCI-001184,Rule-ID|SV-96087r1_rule,STIG-ID|WBSP-AS-001410,Vuln-ID|V-81373"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001460 - The WebSphere Application Server personal certificates in all keystores must be issued by an approved DoD CA."
      info        : "Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.

The DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. The application server must only allow the use of DoD PKI-established certificate authorities for verification.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Utilize DoD certificates that have been issued by an approved DoD PKI CA.

To replace a non-DoD PKI-established certificate:
From the administrative console, navigate to Security >> SSL Certificates and Key Management >> KeyStores and Certificates.

For each keystores that requires the change:
Import a new certificate by clicking 'Import'.

Click 'keystore' file.

Enter the location of the new certificate.

Specify the type of keystore and keystore password.

Specify alias information.

Click 'Apply'.

After the certificate is imported, click on 'Replace' to replace the original certificate with the new certificate."
      reference   : "CAT|II,CCI|CCI-002470,Rule-ID|SV-96089r1_rule,STIG-ID|WBSP-AS-001460,Vuln-ID|V-81375"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001470 - The WebSphere Application Server must be configured to perform complete application deployments when using A/B clusters."
      info        : "Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system.

When an application is deployed to the application server, if the deployment process does not complete properly and without errors, there is the potential that some application files may not be deployed or may be corrupted and an application error may occur during runtime.

The application server must be able to perform complete application deployments. A partial deployment can leave the server in an inconsistent state. Application servers may provide a transaction rollback function to address this issue.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "From the administration console, select WebSphere application server clusters.

Select each cluster name.

Select cluster members >> Details.

Set all cluster members configured weight to a non-zero value."
      reference   : "CAT|III,CCI|CCI-001190,Rule-ID|SV-96091r1_rule,STIG-ID|WBSP-AS-001470,Vuln-ID|V-81377"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001480 - The WebSphere Application servers with an RMF categorization of high must be in a high-availability (HA) cluster."
      info        : "This requirement is dependent upon system MAC and confidentiality. If the system MAC and confidentiality levels do not specify redundancy requirements, this requirement is NA.

Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. When application failure is encountered, preserving application state facilitates application restart and return to the operational mode of the organization with less disruption of mission/business processes.

Clustering of multiple application servers is a common approach to providing fail-safe application availability when system MAC and confidentiality levels require redundancy.

Satisfies: SRG-APP-000225-AS-000154, SRG-APP-000435-AS-000069

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "In the administrative console, click Servers >> Clusters >> WebSphere application server clusters >> New.

Specify a name for the cluster.

Click 'Next'.

Specify the name of the first cluster member.

Select the node on which you want this cluster member to reside, leave remaining fields as default.

Click 'Next'.

Create additional cluster members as needed (give unique name for each member and click 'Add Member'), when finished adding members click 'Next'.

Click 'Finish' to create the cluster.

Click 'Save'.

Refer to vendor documentation that provides direction on the creation of clusters for specific details.

Restart DMGR and sync all JVMs."
      reference   : "CAT|III,CCI|CCI-001190,CCI|CCI-002385,Rule-ID|SV-96093r1_rule,STIG-ID|WBSP-AS-001480,Vuln-ID|V-81379"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001520 - The WebSphere Application Server must not generate LTPA keys automatically."
      info            : "Automated LTPA key generation can create unplanned outages. Plan to change your LTPA keys during a scheduled outage. Distribute the new keys to all nodes in the cell and to all external systems/cells during this outage window."
      solution        : "Navigate to Security >> SSL Certificate and Key Management >> Key set groups >> Cell LTPAKeySetGroup.

Uncheck automatically generate keys.

Click 'OK'.

Click 'Save'.

Restart the 'Deployment Manager'."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|III,CCI|CCI-002475,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-96095r1_rule,STIG-ID|WBSP-AS-001520,Vuln-ID|V-81381"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<keySetGroups[\s].*'; ''; $value; if (($value | Select-String -Pattern '[\s]*autoGenerate=.true.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001530 - The WebSphere Application Server must periodically regenerate LTPA keys."
      info            : "The encryption of authentication information that is exchanged between servers involves the Lightweight Third-Party Authentication (LTPA) mechanism. LTPA utilizes encryption keys, if LTPA is utilized, the LTPA keys must be regenerated on a regular basis. The time period must be defined, documented and accepted by the ISSO but must be performed at least annually.

Note: If LTPA keys are shared across cells, you must export the keys from the cell where the keys have been regenerated, and import into the cells whose keys have not changed. Instructions for managing the LTPA keys is provided here: https://www.ibm.com/support/knowledgecenter/en/SSAW57_9.0.0/com.ibm.websphere.nd.multiplatform.doc/ae/tsec_sslmanagelptakeys.html

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "These steps must be documented and then executed during the down time scheduled for periodic LTPA key regeneration.

The time period must be defined, documented and accepted by the ISSO but must be performed at least annually.

Navigate to Security >> SSL Certificate and Key Management >> Key set groups.

Check 'CellLTPAKeySetGroup'.

Click 'Generate Keys'.

Click 'Save'.

Then synchronize the changes to all nodes."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|III,CCI|CCI-002475,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-96097r1_rule,STIG-ID|WBSP-AS-001530,Vuln-ID|V-81383"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<keySetGroups[\s]*'; ''; $value; if ($value) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001570 - The WebSphere Application Server high availability applications must be installed on a cluster."
      info            : "DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity. To reduce the possibility or effect of a DoS, the application server must employ defined security safeguards. These safeguards will be determined by the placement of the application server and the type of applications being hosted within the application server framework.

There are many examples of technologies that exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the application opens at one time). Employing increased capacity and bandwidth, combined with service redundancy or clustering, may reduce the susceptibility to some DoS attacks.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution        : "To create a cluster, navigate to Servers >> Clusters >> WebSphere Application Server Clusters >> New and follow the wizard.

After cluster creation, re-install your application to the cluster.

Refer to product documentation for specific details on how to create and manage WebSphere clusters."
      reference       : "800-171|3.4.8,800-53|CM-7(5),CAT|II,CCI|CCI-002385,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,Rule-ID|SV-96099r1_rule,STIG-ID|WBSP-AS-001570,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-81385"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : "None"
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "ls 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\installedApps\*\*'"
      check_type      : CHECK_REGEX
      severity        : MEDIUM
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001580 - The WebSphere Application Server memory session settings must be defined according to application load requirements."
      info            : "DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity. To reduce the possibility or effect of a DoS, the application server must employ defined security safeguards. These safeguards will be determined by the placement of the application server and the type of applications being hosted within the application server framework.

There are many examples of technologies that exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the application opens at one time). Employing increased capacity and bandwidth, combined with service redundancy or clustering, may reduce the susceptibility to some DoS attacks."
      solution        : "From the admin console navigate to Servers >> all servers >> [web application server] >> Session management.

For every [web application server], set the 'Maximum in-memory session count', 'allow overflow', and 'session timeout' values according to your organizational requirements."
      reference       : "800-171|3.5.2,800-53|IA-5,CAT|III,CCI|CCI-002385,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,Rule-ID|SV-96101r1_rule,STIG-ID|WBSP-AS-001580,Vuln-ID|V-81387"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<tuningParams[\s].*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*invalidationTimeout=.([0-9]|1[0-9]|20)[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - Default"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_DEFAULT@ replaced with "20" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.Default.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.20[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - ORB"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_ORB@ replaced with "50" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.ORB.thread.pool.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.50[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - SIBFAPInbound"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_SIBFAPInbound@ replaced with "50" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.SIBFAPInboundThreadPool.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.50[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - SIBFAPThreadPool"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_SIBFAP@ replaced with "50" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.SIBFAPThreadPool.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.50[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - SIBJMSRAThreadPool"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_SIBJMSRA@ replaced with "41" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.SIBJMSRAThreadPool.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.41[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - TCPChannel.DCS"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_TCPChannel@ replaced with "20" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.TCPChannel.DCS.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.20[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - WMQJCAResourceAdapter"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_WMQJCA@ replaced with "50" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.WMQJCAResourceAdapter.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.50[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - WebContainer"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_WEBCONTAINER@ replaced with "50" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.WebContainer.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.50[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001590 - The WebSphere Application Server thread pool size must be defined to application load requirements - server.startup"
      info            : "A thread pool enables components of the application server to reuse threads, which eliminates the need to create new threads at run time. Creating new threads expends system resources and can possibly lead to a DoS. Perform loading for your application to determine the required thread pool sizes."
      solution        : "Perform loading for your application to determine the required thread pool sizes.

To set thread pool size:
From the admin console >> Servers >> all servers >> [server name] >> Additional Properties >> Select Thread Pools.

Set the thread pool size for each threadpool."
      reference       : "800-53|SC-5,CAT|II,CCI|CCI-002385,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-96103r1_rule,STIG-ID|WBSP-AS-001590,Vuln-ID|V-81389"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
# Note: Variable @THREAD_POOL_SIZE_SERVER_STARTUP@ replaced with "3" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<threadPools[\s].*name=.server.startup.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*maximumSize=.3[^0-9]')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001610 - The WebSphere Application Server must remove export ciphers to protect confidentiality and integrity of transmitted info"
      info            : "Export grade encryption suites are not strong and do not meet DoD requirements. The encryption for the session becomes easy for the attacker to break. Do not use export grade encryption. Information on disabling export ciphers can be found in Knowledge Center at this link: http://www.ibm.com/support/knowledgecenter/SS7K4U_8.5.5/com.ibm.websphere.ihs.doc/ihs/rihs_ciphspec.html"
      solution        : "From the administrative console, navigate to Security >> SSL certificate and key management >> SSL configurations >> [Name] >> for each SSL configuration

Select 'Quality of protection (QoP) settings' under 'Cipher suite' settings.

Identify any ciphers that include 'EXPORT' in their name.

Remove the cipher by selecting the cipher.

Click 'Remove' button.

Click 'OK'.

Recycle the DMGR and sync the JVMs."
      reference       : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-002418,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-96105r1_rule,STIG-ID|WBSP-AS-001610,Vuln-ID|V-81391"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\security.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<setting[\s].*'; ''; $value; if (($value | Select-String -Pattern '[\s]*enabledCiphers=.*EXPORT.*')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001620 - The WebSphere Application Server distribution and consistency services (DCS) transport links must be encrypted."
      info        : "A Core Group (HA Domain) is a component of the high availability manager function. It can contain stand-alone servers, cluster members, node agents, administrative agents, and the deployment manager.

Core groups rely on DCS, which uses a reliable multicast message (RMM) system for transport. RMM can use one of several wire transport technologies. Depending on your environment, sensitive information might be transmitted over DCS. For example, data in DynaCache and the security subject cache are transmitted using DCS. To ensure this, select a transport type of channel framework and DCS-Secure as channel chain for each core group.

Be aware that DCS always authenticates messages when global security is enabled. Once the transport is encrypted, you then have a highly secure channel.

Once you have done this, all services that rely on DCS are now using an encrypted and authenticated transport. Those services are DynaCache, memory-to-memory session replication, core groups, Web services caching, and stateful session bean persistence.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "From the admin console navigate to Core groups >> for every Core Group listed.

Select the [Core Group Name].

Under 'Transport' type, select 'CHANNEL_FRAMEWORK' button.

In the 'Transport chain' drop down box set to 'DCS-SECURE'.

Click 'Save'.

Sync the configuration."
      reference   : "CAT|II,CCI|CCI-002420,Rule-ID|SV-96107r1_rule,STIG-ID|WBSP-AS-001620,Vuln-ID|V-81393"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001630 - The WebSphere Application Server plugin must be configured to use HTTPS only - WCInboundDefault"
      info            : "The Web server plug-in transmits information from the Web server to the Web container over HTTP by default. Extra steps must be taken to protect the traffic from the Web server to the Web container. To force the use of HTTPS for all traffic from the plug-in, disable the HTTP transport from the Web container on every application server and then regenerate and deploy the plug-in. WCInboundDefault and the HttpQueueInboundDefault transport chains must be disabled. At which time the plug-in can only use HTTPS and so it will use it for all traffic regardless of how the traffic arrived at the Web container."
      solution        : "From the admin console, navigate to Servers >> Server Types >> WebSphere Application Servers >> select each server (server name) >> Web Container Settings >> Web container transport chains.

Select the 'WCInboundDefault' and the 'HttpQueueInboundDefault' transport chains and disable them.

Click 'Apply'.

Click 'Save'.

Restart the DMGR and resynch the JVMs."
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002421,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-96109r1_rule,STIG-ID|WBSP-AS-001630,SWIFT-CSCv1|2.3,Vuln-ID|V-81395"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<chains[\s].*name=.WCInboundDefault.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enable=.false.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <custom_item>
      type            : AUDIT_POWERSHELL
      description     : "WBSP-AS-001630 - The WebSphere Application Server plugin must be configured to use HTTPS only - HttpQueueInboundDefault"
      info            : "The Web server plug-in transmits information from the Web server to the Web container over HTTP by default. Extra steps must be taken to protect the traffic from the Web server to the Web container. To force the use of HTTPS for all traffic from the plug-in, disable the HTTP transport from the Web container on every application server and then regenerate and deploy the plug-in. WCInboundDefault and the HttpQueueInboundDefault transport chains must be disabled. At which time the plug-in can only use HTTPS and so it will use it for all traffic regardless of how the traffic arrived at the Web container."
      solution        : "From the admin console, navigate to Servers >> Server Types >> WebSphere Application Servers >> select each server (server name) >> Web Container Settings >> Web container transport chains.

Select the 'WCInboundDefault' and the 'HttpQueueInboundDefault' transport chains and disable them.

Click 'Apply'.

Click 'Save'.

Restart the DMGR and resynch the JVMs."
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-002421,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-96109r1_rule,STIG-ID|WBSP-AS-001630,SWIFT-CSCv1|2.3,Vuln-ID|V-81395"
      see_also        : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
      value_type      : POLICY_TEXT
      value_data      : 'STATUS: PASSED'
# Note: Variable @WEBSPHERE_INSTALL_PATH@ replaced with "C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer" in field "powershell_args".
      powershell_args : "$status = 'PASSED'; $files=Get-Item 'C:\\\\Program Files\\\\IBM\\\\WebSphere\\\\AppServer\profiles\*\config\cells\*\nodes\*\servers\*\server.xml'; foreach ($file in $files) { $value = Select-String -Path $file -Pattern '^[\s]*<chains[\s].*name=.HttpQueueInboundDefault.*'; ''; $value; if (!($value | Select-String -Pattern '[\s]*enable=.false.')) { $status = 'FAILED' } } ''; 'STATUS: '+$status"
      check_type      : CHECK_REGEX
    </custom_item>

    <report type:"WARNING">
      description : "WBSP-AS-001740 - The WebSphere Application Server must remove organization-defined software components after updated versions installed."
      info        : "By default, when updating WebSphere application server, the older version of binaries are saved in case a 'roll back' is necessary. Not keeping the older version makes it more difficult for attackers to 'revert' back to the older version.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Review System Security Plan and system documentation to locate the 'IBM InstallationManager' folder.

Default locations are:
UNIX:
/opt/InstallationManager

Windows:
C:\Program Files\InstallationManager

UNIX:
<IMHOME>/eclipse/tools/imcl -c

Select 'P' preferences.
Select '3' Files for rollback.
Enter '1' to deselect.
Enter 'A' for apply.
Enter 'R' to return to Main Menu.

Windows:
<IMHOME>\eclipse\tools\imcl.exe -c

Select 'P' preferences.
Select '3' Files for rollback.
Enter '1' to deselect.
Enter 'A' for apply.
Enter 'R' to return to Main Menu."
      reference   : "CAT|II,CCI|CCI-002617,Rule-ID|SV-96111r1_rule,STIG-ID|WBSP-AS-001740,Vuln-ID|V-81397"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001750 - The WebSphere Application Server must apply the latest security fixes."
      info        : "Security vulnerabilities are often addressed by testing and applying the latest security patches and fix packs. Latest fixpacks can be found at: http://www-01.ibm.com/support/docview.wss?uid=swg27009661

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Obtain WebSphere product security and patch support.

Test and apply the latest applicable WebSphere security fixes."
      reference   : "CAT|II,CCI|CCI-002605,Rule-ID|SV-96113r1_rule,STIG-ID|WBSP-AS-001750,Vuln-ID|V-81399"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "WBSP-AS-001760 - The WebSphere Application Server must install security-relevant software updates within the time period"
      info        : "Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes) to production systems after thorough testing of the patches within a lab environment. Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Sign up to receive WebSphere security bulletins at the IBM website.

Monitor IAVMs, CTOs, and DTMs for update notices affecting WebSphere.

Obtain WebSphere product security and patch support.

Test and apply the latest applicable WebSphere security fixes."
      reference   : "CAT|II,CCI|CCI-002605,Rule-ID|SV-96115r1_rule,STIG-ID|WBSP-AS-001760,Vuln-ID|V-81401"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/U_IBM_WebSphere_Traditional_V9-x_V1R1_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_IBM_WebSphere_Traditional_9_Windows_v1r1.audit for DISA IBM WebSphere Traditional 9 STIG v1r1"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</group_policy>
</check_type>
