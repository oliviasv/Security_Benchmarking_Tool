#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.4 $
# $Date: 2020/04/22 $
#
# Description	: This .audit is designed against the DISA IIS6 Server
# 	  Checklist V6R16, 24 Jul 2015.
# 	  http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip
#
#<ui_metadata>
#<display_name>DISA STIG IIS 6.0 Server v6r16</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>IIS 6.0 Server</name>
#  <version>6.16.0</version>
#  <link>http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip</link>
#</spec>
#<labels>windows,disa,internet,information,server,iis,iis_6</labels>
#<variables>
#  <variable>
#    <name>IUSER_ACCOUNT_GROUP_MEMBERSHIP</name>
#    <default>IUSR_MachineName</default>
#    <description>IUSR Account Group Membership</description>
#    <info>This is the name of the local IUSR account which is tested for membership in any groups besides Guests</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Windows" version:"2">
<group_policy:"DISA IIS6">

<file_acl:"WG200">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG220">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_1">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read permissions"
  </user>
</file_acl>

<file_acl:"WG300_2">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_21">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>
</file_acl>

<file_acl:"WG300_3">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"WebAdmins">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "modify"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read permissions"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read permissions"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read permissions"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read permissions"
  </user>
</file_acl>

<file_acl:"WG300_4">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"WebAdmins">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "write" | "delete"
  </user>

  <user:"FTPAdmins">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "write" | "delete"
  </user>

  <user:"SpecifiedUsers">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "write"
  </user>
</file_acl>

<file_acl:"WG300_5">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>
</file_acl>

<file_acl:"WG300_6">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>
</file_acl>

<file_acl:"WG300_7">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Authenticated Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "write"
  </user>
</file_acl>

<file_acl:"WG300_8">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"WebAdmins">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "modify"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "traverse folder / execute file"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "traverse folder / execute file"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "traverse folder / execute file"
  </user>
</file_acl>

<file_acl:"WG300_9">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>
</file_acl>

<file_acl:"WG300_10">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>
</file_acl>

<file_acl:"WG300_11">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_12">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_13">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_14">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_15">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Web Admins">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_16">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_17">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"LOCALSERVICE">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>

  <user:"NETWORKSERVICE">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>
</file_acl>

<file_acl:"WG300_18">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "read" | "read & execute"
  </user>

  <user:"Web Anonymous Users">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"Web Applications">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"IIS_WPG">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_deny        : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WG300_19">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<file_acl:"WA000WI035">
  <user:"Administrators">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>

  <user:"SYSTEM">
    acl_inheritance : "not inherited"
    acl_apply       : "This object only"
    acl_allow       : "change permissions" | "create files / write data" | "create folders / append data" | "delete" | "delete subfolder and files" | "full control" | "list folder / read data" | "read attributes" | "read extended attributes" | "read permissions" | "take ownership" | "traverse folder / execute file" | "write attributes" | "write extended attributes"
  </user>
</file_acl>

<report type:"PASSED">
  description : "DISA Web IIS 6 Server Checklist Version 6 Release 16"
</report>

<report type:"WARNING">
  description : "WG050 IIS6 - The web server service password(s) must be entrusted to the SA or Web Manager."
  info        : "Normally, a service account is established for the web server. This is because a privileged account is not desirable and the server is designed to run for long uninterrupted periods of time. The SA or Web Manager will need password access to the web server to restart the service in the event of an emergency as the web server is not to restart automatically after an unscheduled interruption. If the password is not entrusted to an SA or web manager the ability to ensure the availability of the web server is compromised.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure the SA or Web Manager is entrusted with the web service(s) password."
  reference   : "8500.2|IAAC-1,CAT|II,Rule-ID|SV-38188r1_rule,STIG-ID|WG050,Vuln-ID|V-2232"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG040 IIS6 - Public web server resources must not be shared with private assets."
  info                 : "It is important to segregate public web server resources from private resources located behind the DoD DMZ in order to protect private assets. When folders, drives or other resources are directly shared between the public web server and private servers the intent of data and resource segregation can be compromised.  Resources such as printers, files, and folders/directories must not be shared between public web servers and assets located within the internal network."
  solution             : "Configure the public web server to not have a trusted relationship with any system resource that is not accessible to the public."
  reference            : "800-171|3.4.2,800-53|CM-6,8500.2|EBPW-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38175r1_rule,STIG-ID|WG040,SWIFT-CSCv1|2.3,Vuln-ID|V-2234"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'get-wmiobject -namespace root\\cimv2 -class win32_share | where {$_.name -ne \\"IPC$\\" -and $_.name -ne \\"ADMIN$\\"} | select name,path | format-list'
  only_show_cmd_output : YES
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG060 IIS6 - The service account ID used to run the web service must have its password changed at least annually."
  info                 : "Normally, a service account is established for the web service to run under rather than permitting it to run as system or root. The password on such accounts must be changed at least annually. It is a fundamental tenet of security that passwords are not to be null and not to be set to never expire."
  info                 : "Review the list of service accounts listed for the web server and ensure the passwords are changed annually."
  info                 : "For IIS or other web server installations that are running as localsystem, the password is changed automatically by the OS every 7 days."
  solution             : "Configure the service account ID used to run the web site to have its password changed at least annually."
  reference            : "800-171|3.1.1,800-53|AC-2,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|T5.2.1,NESA|T5.2.4,NIAv2|AM27,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,Rule-ID|SV-38189r1_rule,STIG-ID|WG060,Vuln-ID|V-2235"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : "get-wmiobject -namespace root\microsoftiisv2 -class iisapplicationpoolsetting |select name,wamusername | format-list"
  only_show_cmd_output : YES
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG080 IIS6 - A compiler must not be installed on a production web server. - 'msc.exe search'"
  info              : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  solution          : "Remove any compiler programs found on the production web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38190r1_rule,STIG-ID|WG080,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2236"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include msc.exe -erroraction silentlycontinue|select directory,name|format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG080 IIS6 - A compiler must not be installed on a production web server. - 'msvc.exe search'"
  info              : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  solution          : "Remove any compiler programs found on the production web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38190r1_rule,STIG-ID|WG080,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2236"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include msvc.exe -erroraction silentlycontinue|select directory,name|format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG080 IIS6 - A compiler must not be installed on a production web server. - 'Python.exe search'"
  info              : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  solution          : "Remove any compiler programs found on the production web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38190r1_rule,STIG-ID|WG080,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2236"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include python.exe -erroraction silentlycontinue|select directory,name|format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG080 IIS6 - A compiler must not be installed on a production web server. - 'javac.exe search'"
  info              : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  solution          : "Remove any compiler programs found on the production web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38190r1_rule,STIG-ID|WG080,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2236"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include javac.exe -erroraction silentlycontinue|select directory,name|format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type              : AUDIT_POWERSHELL
  description       : "WG080 IIS6 - A compiler must not be installed on a production web server. - 'Lcc-win32.exe search'"
  info              : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses."
  info              : "NOTE: This check only searches the 'C:' drive, if the system has multiple drives ensure each drive doesn't contain compilers."
  solution          : "Remove any compiler programs found on the production web server."
  reference         : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38190r1_rule,STIG-ID|WG080,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2236"
  see_also          : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type        : POLICY_TEXT
  value_data        : ""
  powershell_args   : "get-childitem -recurse c:\ -include lcc-win32.exe -erroraction silentlycontinue|select directory,name|format-list"
  powershell_option : CAN_BE_NULL
</custom_item>

<report type:"WARNING">
  description : "WA060 IIS6 - A public web server, if hosted on the NIPRNet, must be isolated in an accredited DoD DMZ Extension."
  info        : "To minimize exposure of private assets to unnecessary risk by attackers, public web servers must be isolated from internal systems.  Public web servers are by nature more vulnerable to attack from publically based sources, such as the public Internet. Once compromised, a public web server might be used as a base for further attack on private resources, unless additional layers of protection are implemented. Public web servers must be located in a DoD DMZ Extension, if hosted on the NIPRNet, with carefully controlled access. Failure to isolate resources in this way increase risk that private assets are exposed to attacks from public sources.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Logically relocate the public web server to be isolated from internal systems. In addition, ensure the public web server does not have trusted connections with assets outside the confines of the demilitarized zone (DMZ) other than application and/or database servers that are a part of the same system as the web server."
  reference   : "8500.2|EBPW-1,8500.2|ECIC-1,CAT|II,Rule-ID|SV-38169r2_rule,STIG-ID|WA060,Vuln-ID|V-2242"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<report type:"WARNING">
  description : "WA070 IIS6 - A private web server must be located on a separate controlled access subnet."
  info        : "Private web servers, which host sites serving controlled access data, must be protected from outside threats in addition to insider threats. Insider threat may be accidental or intentional but, in either case, can cause a disruption in service of the web server. To protect the private web server from these threats, it must be located on a separate controlled access subnet and must not be a part of the public DMZ that houses the public web servers. It also cannot be located inside the enclave as part of the local general population LAN.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Isolate the private web server from the public DMZ and separate it from the internal general population LAN. This separation must have access control in place to protect the web server from internal threats."
  reference   : "8500.2|EBPW-1,CAT|II,Rule-ID|SV-38170r1_rule,STIG-ID|WA070,Vuln-ID|V-2243"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG190 IIS6 - The web server must use a vendor-supported version of the web server software."
  info        : "The web server Software, IIS 6, is no longer supported by Microsoft for security updates and is not evaluated or updated for vulnerabilities, leaving it open to potential attack. Organizations must transition to a supported IIS release to ensure continued support."
  solution    : "Upgrade Microsoft IIS to a supported version."
  reference   : "800-171|3.14.1,800-53|SI-2,8500.2|ECSC-1,CAT|I,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-38193r2_rule,STIG-ID|WG190,SWIFT-CSCv1|2.2,Vuln-ID|V-2246"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "Version 6.0"
  reg_key     : "HKLM\Software\Microsoft\Inetstp"
  reg_item    : "VersionString"
  check_type  : CHECK_NOT_EQUAL
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG200 IIS6 - Non-administrators must not be allowed access to the directory tree, the shell, or other utilities. - 'command.com'"
  info        : "As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. This is in addition to the anonymous web user account. The resources to which these accounts have access must also be closely monitored and controlled. Only the SA needs access to all the system's capabilities, while the web administrator and associated staff require access and control of the web content and web server configuration files. The anonymous web user account must not have access to system resources as that account could then control the server."
  solution    : "Ensure non-administrators are not allowed access to the directory tree, the shell, or other operating system functions and utilities."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECLP-1,CAT|I,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38194r2_rule,STIG-ID|WG200,SWIFT-CSCv1|2.3,Vuln-ID|V-2247"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG200"
  file        : "%systemroot%\system32\command.com"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG200 IIS6 - Non-administrators must not be allowed access to the directory tree, the shell, or other utilities. - 'cmd.exe'"
  info        : "As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. This is in addition to the anonymous web user account. The resources to which these accounts have access must also be closely monitored and controlled. Only the SA needs access to all the system's capabilities, while the web administrator and associated staff require access and control of the web content and web server configuration files. The anonymous web user account must not have access to system resources as that account could then control the server."
  solution    : "Ensure non-administrators are not allowed access to the directory tree, the shell, or other operating system functions and utilities."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECLP-1,CAT|I,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38194r2_rule,STIG-ID|WG200,SWIFT-CSCv1|2.3,Vuln-ID|V-2247"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG200"
  file        : "%systemroot%\system32\cmd.exe"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG220 IIS6 - Access to web administration tools must be restricted to the Web Manager and the Web Manager's designees."
  info        : "The key web service administrative and configuration tools must only be accessible by the web server staff. All users granted this authority will be documented and approved by the ISSO. Access to the IIS Manager will be limited to authorized users and administrators."
  solution    : "Restrict access to the web administration tool to only the Web Manager and the Web Manager's designees."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38326r2_rule,STIG-ID|WG220,SWIFT-CSCv1|2.3,Vuln-ID|V-2248"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG220"
  file        : "%systemroot%\system32\inetsrv\inetmgr.exe"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG130 IIS6 - Programs and features not necessary for operations must be removed."
  info                 : "Just as running unneeded services and protocols increase the attack surface of the web server, running unneeded utilities and programs is also an added risk to the web server."
  info                 : "Review the list of installed programs to ensure only those that are required for the system to run are listed."
  solution             : "Install only web support software on the web server. When other processes are supported by the web server, ensure a risk assessment has been performed and documented. If a database server is installed on the same platform as the web server, it must be on a separate drive or partition. Remove all unnecessary applications and programs."
  reference            : "800-171|3.4.8,800-53|CM-7(4),8500.2|ECSC-1,CAT|III,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,Rule-ID|SV-38191r2_rule,STIG-ID|WG130,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3,Vuln-ID|V-2251"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : "get-wmiobject -namespace root\cimv2 -class win32_product | select name | format-list"
  only_show_cmd_output : YES
</custom_item>

<report type:"WARNING">
  description : "WA120 IIS6 - Administrative users and groups with access privilege to the web server must be documented."
  info        : "There are typically several individuals and groups involved in running a production web site. In most cases, several types of users on a web server can be identified such as SA's, Web Managers, Auditors, Authors, Developers, and the Clients. Nonetheless, only necessary user and administrative accounts will be allowed on the web server. Accounts will be restricted to those who are necessary to maintain web services, review the server's operation and the OS. Owing to the sensitivity of web servers, a detailed record of these accounts must be maintained.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Document the administrative users and groups which have access rights to the web server in the web site SOP or an equivalent document."
  reference   : "8500.2|ECPA-1,CAT|III,Rule-ID|SV-38171r1_rule,STIG-ID|WA120,Vuln-ID|V-2257"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_1"
  file        : "%SYSTEMDRIVE%\Inetpub"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\AdminScripts'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_2"
  file        : "%SYSTEMDRIVE%\Inetpub\Adminscripts"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\ftproot'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_21"
  file        : "%SYSTEMDRIVE%\Inetpub\Ftproot"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\ftproot\ftpfiles'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_3"
  file        : "%SYSTEMDRIVE%\Inetpub\Ftproot\Ftpfiles"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\ftproot\dropbox'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_4"
  file        : "%SYSTEMDRIVE%\Inetpub\Ftproot\Dropbox"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\mailroot'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_5"
  file        : "%SYSTEMDRIVE%\Inetpub\Mailroot"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\wwwroot'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_6"
  file        : "%SYSTEMDRIVE%\Inetpub\Wwwroot"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\wwwroot\docs'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_7"
  file        : "%SYSTEMDRIVE%\Inetpub\Wwwroot\Docs"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\wwwroot\images'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_7"
  file        : "%SYSTEMDRIVE%\Inetpub\Wwwroot\Images"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\inetpub\wwwroot\scripts'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_8"
  file        : "%SYSTEMDRIVE%\Inetpub\Wwwroot\Scripts"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_9"
  file        : "%systemroot%\system32\inetsrv"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\data'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_10"
  file        : "%systemroot%\system32\inetsrv\data"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\ASP Compiled Templates'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_11"
  file        : "%systemroot%\system32\inetsrv\ASP Compiled Templates"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\History'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_12"
  file        : "%systemroot%\system32\inetsrv\History"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\iisadmin'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_13"
  file        : "%systemroot%\system32\inetsrv\iisadmin"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\iisadmpwd'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_14"
  file        : "%systemroot%\system32\inetsrv\iisadmpwd"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\inetmgr.exe'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_15"
  file        : "%systemroot%\system32\inetsrv\inetmgr.exe"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\MetaBack'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_16"
  file        : "%systemroot%\system32\inetsrv\MetaBack"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\urlscan'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_17"
  file        : "%systemroot%\system32\inetsrv\urlscan"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\*.exe'"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\*.exe"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\*.bat"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\*.bat"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\oblt-log.log"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AC-6(7),800-53|AU-9(4),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CN-L3|8.1.4.3(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-1,ISO/IEC-27001|A.9.2.5,ITSG-33|AU-9(4),ITSG-33|CM-6,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\oblt-log.log"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\oblt-rep.log"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AC-6(7),800-53|AU-9(4),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CN-L3|8.1.4.3(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-1,ISO/IEC-27001|A.9.2.5,ITSG-33|AU-9(4),ITSG-33|CM-6,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\oblt-rep.log"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\oblt-undo.log"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AC-6(7),800-53|AU-9(4),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CN-L3|8.1.4.3(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-1,ISO/IEC-27001|A.9.2.5,ITSG-33|AU-9(4),ITSG-33|CM-6,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\oblt-undo.log"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\oblt-undone.lob"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.3.8,800-171|3.3.9,800-171|3.4.2,800-53|AC-6(7),800-53|AU-9(4),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CN-L3|8.1.4.3(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,CSF|PR.PT-1,ISO/IEC-27001|A.9.2.5,ITSG-33|AU-9(4),ITSG-33|CM-6,NESA|M1.1.3,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,SWIFT-CSCv1|5.1,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_18"
  file        : "%systemroot%\system32\inetsrv\oblt-undone.log"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\metabase.bin"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_19"
  file        : "%systemroot%\system32\inetsrv\metabase.bin"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\metabase.xml"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_19"
  file        : "%systemroot%\system32\inetsrv\metabase.xml"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\MBSchema.xml"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_19"
  file        : "%systemroot%\system32\inetsrv\MBSchema.xml"
</custom_item>

<custom_item>
  type        : FILE_PERMISSIONS
  description : "WG300 IIS6 - Web server system files must conform to minimum file permission requirements. - '\system32\inetsrv\MBSchema.bin.00000000h"
  info        : "This check verifies the key web server system configuration files are owned by the SA or Web Manager controlled account. These same files which control the configuration of the web server, and thus its behavior, must also be accessible by the account which runs the web service. If these files are altered by a malicious user, the web server would no longer be under the control of its managers and owners; properties in the web server configuration could be altered to compromise the entire server platform."
  solution    : "Set file permissions on the web server systems files to meet minimum file permissions requirements."
  reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31321r1_rule,STIG-ID|WG300,SWIFT-CSCv1|2.3,Vuln-ID|V-2259"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : FILE_ACL
  value_data  : "WG300_19"
  file        : "%systemroot%\system32\inetsrv\MBSchema.bin.00000000h"
</custom_item>

<report type:"WARNING">
  description : "WG330 IIS6 - A public web server must limit e-mail to outbound only."
  info        : "Incoming e-mails have been known to provide hackers with access to servers. Disabling the incoming mail service prevents this type of attacks. Additionally, e-mail is a specialized application requiring the dedication of server resources. A production web server should only provide hosting services for web sites. Supporting mail services on a web server opens the server to the risk of abuse as an e-mail relay.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Disable the SMTP service.  If other e-mail programs are running, remove them."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-38328r1_rule,STIG-ID|WG330,Vuln-ID|V-2261"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG470 IIS6 - Wscript.exe and Cscript.exe must not be accessible by users other than the SA and Web Manager. - 'wscript.exe'"
  info                 : "Windows Scripting Host (WSH) is installed under either a Typical or Custom installation option of a Microsoft Network Server. This technology permits the execution of powerful script files from the Windows NT command line. This technology is also classified as a Category I Mobile Code. If the access to these files is not tightly controlled, a malicious user could readily compromise the server by using a form to send input to these scripting engines. This is a web-related vulnerability that could exist on any NT / Win 2000 system regardless of the web server software being used on the platform."
  info                 : "Review the file permissions to ensure that only the SA, System, or Web Manager have Full Control."
  solution             : "Remove Wscript.exe and Cscript.exe files from the server, or restrict access to these files to the SA, the Web Administrator, and the system account."
  reference            : "800-171|3.1.1,800-53|AC-3,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CN-L3|8.1.10.2(c),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,Rule-ID|SV-38332r1_rule,STIG-ID|WG470,TBA-FIISB|31.1,Vuln-ID|V-2264"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : "get-childitem -recurse c:\ -include wscript.exe -erroraction silentlycontinue|get-acl | %{$_.access}|select IdentityReference,FileSystemRights | format-list"
  only_show_cmd_output : YES
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG470 IIS6 - Wscript.exe and Cscript.exe must not be accessible by users other than the SA and Web Manager. - 'cscript.exe'"
  info                 : "Windows Scripting Host (WSH) is installed under either a Typical or Custom installation option of a Microsoft Network Server. This technology permits the execution of powerful script files from the Windows NT command line. This technology is also classified as a Category I Mobile Code. If the access to these files is not tightly controlled, a malicious user could readily compromise the server by using a form to send input to these scripting engines. This is a web-related vulnerability that could exist on any NT / Win 2000 system regardless of the web server software being used on the platform."
  info                 : "Review the file permissions to ensure that only the SA, System, or Web Manager have Full Control."
  solution             : "Remove Wscript.exe and Cscript.exe files from the server, or restrict access to these files to the SA, the Web Administrator, and the system account."
  reference            : "800-171|3.1.1,800-53|AC-3,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CN-L3|8.1.10.2(c),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(f),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,Rule-ID|SV-38332r1_rule,STIG-ID|WG470,TBA-FIISB|31.1,Vuln-ID|V-2264"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : "get-childitem -recurse c:\ -include cscript.exe -erroraction silentlycontinue|get-acl | %{$_.access}|select IdentityReference,FileSystemRights | format-list"
  only_show_cmd_output : YES
</custom_item>

<report type:"WARNING">
  description : "WG440 IIS6 - Monitoring software must include CGI type files or equivalent programs."
  info        : "By their very nature, CGI type files permit the anonymous web user to interact with data and perhaps store data on the web server. In many cases, CGI scripts exercise system-level control over the server's resources. These files make appealing targets for the malicious user. If these files can be modified or exploited, the web server can be compromised. CGI or equivalent files must be monitored by a security tool alerting the Web Admin of any unauthorized changes.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the monitoring tool to include CGI type files or equivalent programs directory."
  reference   : "8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECCD-1,CAT|II,Rule-ID|SV-38331r1_rule,STIG-ID|WG440,Vuln-ID|V-2271"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<report type:"WARNING">
  description : "WA140 IIS6 - Web server content and configuration files must be part of a routine backup program."
  info        : "Backing up web server data and web server application software after upgrades or maintenance ensures that recovery can be accomplished up to the current version. It also provides a means to determine and recover from subsequent unauthorized changes to the software and data.

A tested and verifiable backup strategy will be implemented for web server software as well as all web server data files. Backup and recovery procedures will be documented and the Web Manager or SA for the specific application will be responsible for the design, test, and implementation of the procedures.

The site will have a contingency processing plan/disaster recovery plan that includes web servers. The contingency plan will be periodically tested in accordance with DoDI 8500.2 requirements.

The site will identify an off-site storage facility in accordance with DoDI 8500.2 requirements. Off-site backups will be updated on a regular basis and the frequency will be documented in the contingency plan.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Document the backup procedures."
  reference   : "8500.2|CODB-1,8500.2|CODB-2,8500.2|CODB-3,CAT|III,Rule-ID|SV-38172r2_rule,STIG-ID|WA140,Vuln-ID|V-6485"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : USER_GROUPS_POLICY
  description : "WG195 IIS6 - Anonymous access accounts must be restricted."
  info        : "Many of the security problems that occur are not the result of a user gaining access to files or data for which the user does not have permissions, but rather users are assigned incorrect permissions to unauthorized data. The files, directories, and data that are stored on the web server need to be evaluated and a determination made concerning authorized access to information and programs on the server. In most cases, we can identify several types of users on a web server. These are system SAs, web administrators, auditors, authors, developers, and clients (web users, either anonymous or authenticated). Only authorized users and administrative accounts will be allowed on the host server in order to maintain the web server, applications, and review the server operations."
  solution    : "Remove the anonymous access account from all privileged accounts and all privileged groups."
  reference   : "800-171|3.1.5,800-53|AC-6(1),8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|I,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-29351r1_rule,STIG-ID|WG195,SWIFT-CSCv1|5.1,Vuln-ID|V-6537"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "Guests"
# Note: Variable @IUSER_ACCOUNT_GROUP_MEMBERSHIP@ replaced with "IUSR_MachineName" in field "user_name".
  user_name   : "IUSR_MachineName"
</custom_item>

<custom_item>
  type                 : AUDIT_POWERSHELL
  description          : "WG204 IIS6 - A web server must not be co-hosted with other services"
  info                 : "A detailed web server installation and configuration plan should be followed to provide standardization during the installation process. The installation and configuration plan should not support the co-hosting of multiple services such as Domain Name Service (DNS), e-mail, databases, search engines, indexing, or streaming media on the same server providing the web publishing service.

Disallowed or restricted services in the context of this vulnerability apply to services not directly associated with the delivery of web content. An operating system that supports a web server will not provide other services (e.g., domain controller, e-mail server, database server, etc.). Only those services necessary to support the web server and its hosted sites are specifically allowed and may include, but are not limited to, operating system, logging, anti-virus, host intrusion detection, administrative maintenance, or network requirements. Any unnecessary services or protocols should be removed."
  info                 : "NOTE: Review the list of running services to ensure only required services have been started and/or running."
  solution             : "Move or install additional services and applications to partitions that are not the operating system root or the web document root."
  reference            : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPA-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38196r1_rule,STIG-ID|WG204,SWIFT-CSCv1|2.3,Vuln-ID|V-6577"
  see_also             : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type           : POLICY_TEXT
  value_data           : ""
  powershell_args      : 'get-wmiobject -namespace root\\microsoftiisv2 -class iiswebvirtualdirsetting | where {$_.path -like \\"C:*\\"} | select name,path | format-list'
  only_show_cmd_output : YES
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WG520 IIS6 - Web server and/or operating system information must be protected."
  info        : "The web server response header of an HTTP response can contain several fields of information including the requested HTML page. The information included in this response can be web server type and version, operating system and version, and ports associated with the web server. This provides the malicious user valuable information without the use of extensive tools."
  solution    : "Set the following registry key to 1-

HKLM\SYSTEM\CurrentControlSet\Services\HTTP\Parameters\DisableServerHeader (REG_DWORD)"
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30051r1_rule,STIG-ID|WG520,SWIFT-CSCv1|2.3,Vuln-ID|V-6724"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\System\Currentcontrolset\Services\Http\Parameters"
  reg_item    : "DisableServerHeader"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI080 IIS6 - The IIS Internet Printing Protocol must be disabled."
  info        : "The use of Internet Printing Protocol (IPP) on an IIS web server allows client's access to shared printers. This privileged access could allow remote code execution by increasing the web servers attack surface. Additionally, IPP does not support SSL adding to its risk posture."
  solution    : "Set the Internet Printing Extension to 'Prohibited'."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38150r1_rule,STIG-ID|WA000-WI080,SWIFT-CSCv1|2.3,Vuln-ID|V-6754"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 1
  reg_key     : "HKLM\Software\Policies\Microsoft\Windows Nt\Printers"
  reg_item    : "DisableWebPrinting"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<report type:"WARNING">
  description : "WA155 IIS6 - Classified web servers must be afforded physical security commensurate with the classification of its content."
  info        : "When data of a classified nature is migrated to a web server, fundamental principles applicable to the safeguarding of classified material must be followed. A classified web server needs to be afforded physical security commensurate with the classification of its content to ensure the protection of the data it houses.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Relocate the web server to a location appropriate to classified devices."
  reference   : "8500.2|PECF-2,CAT|I,Rule-ID|SV-38173r2_rule,STIG-ID|WA155,Vuln-ID|V-13591"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<report type:"WARNING">
  description : "WA230 IIS6 - The site software used with the web server must have all applicable security patches applied and documented."
  info        : "The IAVM process does not address all patches that have been identified for the host operating system or, in this case, the web server software environment. Many vendors have subscription services available to notify users of known security threats. The site needs to be aware of these fixes and make determinations based on local policy and what software features are installed, if these patches need to be applied.

In some cases, patches also apply to middleware and database systems. Maintaining the security of web servers requires frequent reviews of security notices. Many security notices mandate the installation of a software patch to overcome security vulnerabilities.

SAs and ISSOs should regularly check the vendor support web site for patches and information related to the web server software. All applicable security patches will be applied to the operating system and to the web server software. Security patches are deemed applicable if the product is installed, even if it is not used or is disabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Establish a detailed process as part of the configuration management plan to stay compliant with all web server security-related patches."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-38174r2_rule,STIG-ID|WA230,Vuln-ID|V-13613"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
</report>

<custom_item>
  type        : FILE_CHECK
  description : "WG385 IIS6 - All web server documentation, sample code, example applications, and tutorials must be removed. - 'Inetpub\Iissamples'"
  info        : "Web server documentation, sample code, example applications, and tutorials may be an exploitable threat to a web server. A production web server may only contain components that are operationally necessary (e.g., compiled code, scripts, web-content, etc.). Delete all directories containing samples and any scripts used to execute the samples."
  solution    : "Remove sample code and documentation from the web server."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38330r1_rule,STIG-ID|WG385,SWIFT-CSCv1|2.3,Vuln-ID|V-13621"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "%SYSTEMDRIVE%\Inetpub\Iissamples"
  file_option : MUST_NOT_EXIST
</custom_item>

<custom_item>
  type        : FILE_CHECK
  description : "WG385 IIS6 - All web server documentation, sample code, example applications, and tutorials must be removed. - 'Inetpub\AdminScripts'"
  info        : "Web server documentation, sample code, example applications, and tutorials may be an exploitable threat to a web server. A production web server may only contain components that are operationally necessary (e.g., compiled code, scripts, web-content, etc.). Delete all directories containing samples and any scripts used to execute the samples."
  solution    : "Remove sample code and documentation from the web server."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38330r1_rule,STIG-ID|WG385,SWIFT-CSCv1|2.3,Vuln-ID|V-13621"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "%SYSTEMDRIVE%\Inetpub\AdminScripts"
  file_option : MUST_NOT_EXIST
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : FILE_CHECK
      description : "WA000-WI035 - The IISADMPWD directory has not been removed from the Web Server. - 'If Exist Check'"
      value_type  : POLICY_TEXT
      value_data  : "%systemroot%\system32\inetsrv\IISADMPWD"
      file_option : MUST_EXIST
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : FILE_PERMISSIONS
      description : "WA000-WI035 - The IISADMPWD directory has not been removed from the Web Server - permissions"
      info        : "Vulnerability Key: V0013698"
      info        : "IA Controls: ECSC-1 Security Configuration Compliance"
      info        : "Categories: 2.2 Least Privilege"
      info        : "Severity: Category I"
      info        : "Ref: WEB SERVER SECURITY TECHNICAL IMPLEMENTATION GUIDE Section 2.1"
      info        : "The IISADMPWD directory is included by default with IIS. It allows users to reset Windows passwords. The use of userid and passwords"
      info        : "is a far less secure solution for controlling user access to web applications than a PKI solution with subscriber certificates."
      info        : "The capability to be able to change password externally gives potential intruders an easier mechanism to access the system in an"
      info        : "effort to compromise the userids and passwords."
      value_type  : FILE_ACL
      value_data  : "WA000WI035"
      file        : "%systemroot%\system32\inetsrv\IISADMPWD"
      reference   : "800-171|3.4.2,800-53|AC-6(7),800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-4,CSF|PR.IP-1,ISO/IEC-27001|A.9.2.5,ITSG-33|CM-6,NESA|M1.1.3,NESA|T3.2.1,NESA|T5.1.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
    </custom_item>
  </then>

  <else>
    <custom_item>
      type        : FILE_CHECK
      description : "WA000-WI035 - The IISADMPWD directory has not been removed from the Web Server."
      info        : "Vulnerability Key: V0013698"
      info        : "IA Controls: ECSC-1 Security Configuration Compliance"
      info        : "Categories: 2.2 Least Privilege"
      info        : "Severity: Category I"
      info        : "Ref: WEB SERVER SECURITY TECHNICAL IMPLEMENTATION GUIDE Section 2.1"
      info        : "The IISADMPWD directory is included by default with IIS. It allows users to reset Windows passwords. The use of userid and passwords"
      info        : "is a far less secure solution for controlling user access to web applications than a PKI solution with subscriber certificates."
      info        : "The capability to be able to change password externally gives potential intruders an easier mechanism to access the system in an"
      info        : "effort to compromise the userids and passwords."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      value_type  : POLICY_TEXT
      value_data  : "%systemroot%\system32\inetsrv\IISADMPWD"
      file_option : MUST_NOT_EXIST
    </custom_item>
  </else>
</if>

<custom_item>
  type        : REG_CHECK
  description : "WA000-WI100 IIS6 - The File System Object component, if not required, must be disabled. - '{0D43FE01-F093-11CF-8940-00A0C9054228} Check'"
  info        : "Some COM components are not required for most applications and should be removed if possible.  Most notably, consider disabling the File System Object component; however, this will also remove the Dictionary object.  Be aware some programs may require components that are being disabled, so it is highly recommended this be tested completely before implementing on your production Web servers."
  solution    : "Unregister the File System Object using the following command: regsvr32 scrrun.dll /u."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38151r2_rule,STIG-ID|WA000-WI100,SWIFT-CSCv1|2.3,Vuln-ID|V-13700"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "HKCR\CLSID\{0D43FE01-F093-11CF-8940-00A0C9054228}"
  reg_option  : MUST_NOT_EXIST
</custom_item>

<custom_item>
  type        : REG_CHECK
  description : "WA000-WI100 IIS6 - The File System Object component, if not required, must be disabled. - 'Scripting.FileSystemObject Check'"
  info        : "Some COM components are not required for most applications and should be removed if possible.  Most notably, consider disabling the File System Object component; however, this will also remove the Dictionary object.  Be aware some programs may require components that are being disabled, so it is highly recommended this be tested completely before implementing on your production Web servers."
  solution    : "Unregister the File System Object using the following command: regsvr32 scrrun.dll /u."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38151r2_rule,STIG-ID|WA000-WI100,SWIFT-CSCv1|2.3,Vuln-ID|V-13700"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_TEXT
  value_data  : "HKCR\Scripting.FileSystemObject"
  reg_option  : MUST_NOT_EXIST
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI110 IIS6 - The command shell options must be disabled."
  info        : "The command shell can be used to call arbitrary commands at the web server from within an HTML page."
  solution    : "Set the following registry key:  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters to the following value:  SSIEnableCmdDirective REG_DWORD 0"
  reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-38159r1_rule,STIG-ID|WA000-WI110,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-13701"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrotset\Services\W3Svc\Parameters"
  reg_item    : "SSlEnableCmdDirective"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6080 IIS6 - The AllowRestrictedChars registry key must be disabled."
  info        : "IIS6 Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  If the AllowRestrictedChars key is set to a nonzero value, Http.sys accepts hex-escaped chars in request URLs that decode to U+0000 - U+001F and U+007F - U+009F ranges. If this capability is enabled it allows malicious characters to be hex-encoded by an attacker in an attempt to bypass input validation routines."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the AllowRestrictedChars key to REG_DWORD 0 or add the key and set it to REG_DWORD 0."
  reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38160r1_rule,STIG-ID|WA000-WI6080,Vuln-ID|V-13714"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "AllowRestrictedChars"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6082 IIS6 - The EnableNonUTF8 registry key must be disabled."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The EnableNonUTF8 registry key expands the amount of character types the web server accepts.  Hackers can use this capability to submit content in a URL that can execute in the CPU by means of a buffer overflow."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the EnableNonUTF8 key to REG_DWORD 0 or add the key and set it to REG_DWORD 0."
  reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38161r1_rule,STIG-ID|WA000-WI6082,Vuln-ID|V-13715"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "EnableNonUTF8"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : REGISTRY_SETTING
      description : "WA000-WI6082 - The EnableNonUTF8 registry entry is not set properly."
      value_type  : POLICY_DWORD
      value_data  : 0
      reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
      reg_item    : "EnableNonUTF8"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "WA000-WI6084 IIS6 - The FavorUTF8 registry key must be set properly."
      info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The FavorUTF8 registry key allows URLs to be decoded as UTF-8 before any other encoding.

Overlong encoding forms have been used to bypass security validations in high profile products including Microsoft's IIS web server. Therefore, great care must be taken to avoid security issues if validation is performed before conversion from UTF-8, and it is generally much simpler to handle overlong forms before any input validation is done.

To maintain security in the case of invalid input, there are two options. The first is to decode the UTF-8 before doing any input validation checks. The second is to use a decoder that, in the event of invalid input, returns either an error or text the application considers to be harmless. Another possibility is to avoid conversion out of UTF-8 altogether but this relies on any other software that the data is passed to safely handling the invalid data."
      solution    : "Use the registry editor and navigate to the following location in the registry- HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters Set the ' FavorUTF8' key to REG_DWORD 1, add the key if it does not exist."
      reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38162r1_rule,STIG-ID|WA000-WI6084,Vuln-ID|V-13716"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
    </report>
  </then>

  <else>
    <custom_item>
      type        : REGISTRY_SETTING
      description : "WA000-WI6084 IIS6 - The FavorUTF8 registry key must be set properly."
      info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The FavorUTF8 registry key allows URLs to be decoded as UTF-8 before any other encoding.

Overlong encoding forms have been used to bypass security validations in high profile products including Microsoft's IIS web server. Therefore, great care must be taken to avoid security issues if validation is performed before conversion from UTF-8, and it is generally much simpler to handle overlong forms before any input validation is done.

To maintain security in the case of invalid input, there are two options. The first is to decode the UTF-8 before doing any input validation checks. The second is to use a decoder that, in the event of invalid input, returns either an error or text the application considers to be harmless. Another possibility is to avoid conversion out of UTF-8 altogether but this relies on any other software that the data is passed to safely handling the invalid data."
      info        : "NOTE: If check WA000-WI6082 is set correctly to '0', this registry key is optional and would not be finding if it is not present."
      solution    : "Use the registry editor and navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters Set the ' FavorUTF8' key to REG_DWORD 1, add the key if it does not exist."
      reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38162r1_rule,STIG-ID|WA000-WI6084,Vuln-ID|V-13716"
      see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
      value_type  : POLICY_DWORD
      value_data  : 1
      reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
      reg_item    : "FavorUTF8"
      reg_option  : CAN_NOT_BE_NULL
    </custom_item>
  </else>
</if>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6086 IIS6 - The MaxFieldLength registry entry must be set properly."
  info        : "By default, the MaxFieldLength registry entry is not present. This registry entry specifies the maximum size of any individual HTTP client request. Typically, this registry entry is configured together with the MaxRequestBytes registry entry.   Setting this value to high, when the application does not require it to operate, may cause performance problems as well as Denial of Service issues for the web server."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the MaxFieldLength key to REG_DWORD 16384 (or less) or add the key and set it to REG_DWORD 16384."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38163r2_rule,STIG-ID|WA000-WI6086,Vuln-ID|V-13717"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : [MIN..16384]
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "MaxFieldLength"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6088 IIS6 - The MaxRequestBytes registry entry must be set properly."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The MaxRequestBytes registry key determines the upper limit for the total size of the HTTP request line and headers. If this value is set too high, performance or Denial of Service conditions may appear."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the MaxRequestBytes key to REG_DWORD 16384 (or less) or add the key and set it to REG_DWORD 16384."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38164r2_rule,STIG-ID|WA000-WI6088,Vuln-ID|V-13718"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : [MIN..16384]
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "MaxRequestBytes"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6090 IIS6 - The UrlSegmentMaxLength registry entry must be set properly."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The UrlSegmentMaxLength key sets the maximum number of characters in a URL path segment (the area between the slashes in the URL). Setting this value too large may cause performance or a Denial of Service condition on the web server."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the UrlSegmentMaxLength key to REG_DWORD 260 (or less) or add the key and set it to REG_DWORD 260."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38165r1_rule,STIG-ID|WA000-WI6090,Vuln-ID|V-13719"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : [MIN..260]
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "MaxSegmentMaxLength"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6092 IIS6 - The PercentUAllowed registry entry must be set properly."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The PercentUAllowed key allows the web server to accept Unicode character syntax via ASCII (i.e., through the URL). Allowing this type of notation, opens the web server to encoding attacks."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the PercentUAllowed key to REG_DWORD 0 or add the key and set it to REG_DWORD 0."
  reference   : "800-53|SI-10,8500.2|ECSC-1,CAT|II,CN-L3|8.1.4.4(d),ITSG-33|SI-10,NESA|T7.3.1,NESA|T7.3.2,NIAv2|SS6e,Rule-ID|SV-38166r1_rule,STIG-ID|WA000-WI6092,Vuln-ID|V-13720"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : 0
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "PercentUAllowed"
  reg_option  : CAN_NOT_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6094 IIS6 - The UriMaxUriBytes registry entry must be set properly."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The UriMaxUriBytes key is used to set size limits on what is cached in the kernel response cache. Setting this value to large may cause performance or Denial of Service conditions on the web server."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the UriMaxUriBytes key to REG_DWORD 262144 or add the key and set it to REG_DWORD 262144."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38167r1_rule,STIG-ID|WA000-WI6094,Vuln-ID|V-13721"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : [MIN..262144]
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "UriMaxUriBytes"
  reg_option  : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : REGISTRY_SETTING
  description : "WA000-WI6096 IIS6 - The UrlSegmentMaxCount registry entry must be set properly."
  info        : "Http.sys is the kernel mode driver that handles HTTP requests.  There are several registry keys associated with http.sys.  The UrlSegmentMaxCount value determines the maximum number of URL path segments accepted by the server. It effectively limits the number of slashes that can be included by the user in a request URL.  It is recommended to set fairly stringent limits on this value based on the depth of the web document root tree to protect the server from a file system traversal attack."
  solution    : "1. Open the registry editor.
2. Navigate to the following location in the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters.
3. Set the value for the UrlSegmentMaxCount key to REG_DWORD 255 (or less) or add the key and set it to REG_DWORD 255."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-38168r1_rule,STIG-ID|WA000-WI6096,Vuln-ID|V-13722"
  see_also    : "http://iasecontent.disa.mil/stigs/zip/July2015/U_IIS_6-0_V6R16_STIG.zip"
  value_type  : POLICY_DWORD
  value_data  : [MIN..255]
  reg_key     : "HKLM\System\Currentcontrotset\Services\Http\Parameters"
  reg_item    : "UrlSegmentMaxCount"
  reg_option  : CAN_BE_NULL
</custom_item>

</group_policy>
</check_type>
