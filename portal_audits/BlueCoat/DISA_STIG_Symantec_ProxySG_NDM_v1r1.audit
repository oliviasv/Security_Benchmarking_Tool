#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2020/04/15 $
#
#<ui_metadata>
#<display_name>DISA Symantec ProxySG Benchmark NDM v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>DISA Symantec ProxySG NDM</name>
#  <version>1.1.0</version>
#</spec>
#<labels>symantec,bluecoat,disa,proxysg</labels>
#<variables>
#  <variable>
#    <name>APPROVED_CIPHERS</name>
#    <default>^Cipher Suite: ecdhe-rsa-aes256-sha384$</default>
#    <description>SYMP-NM-000280 Approved Ciphers</description>
#    <info>SYMP-NM-000280 Approved Ciphers</info>
#  </variable>
#  <variable>
#    <name>ARCHIVE_HOST</name>
#    <default>1.1.1.1</default>
#    <description>SYMP-NM-000190 Archive Host</description>
#    <info>SYMP-NM-000190 Archive Host</info>
#  </variable>
#  <variable>
#    <name>ARCHIVE_PATH</name>
#    <default>/backups</default>
#    <description>SYMP-NM-000190 Archive Path</description>
#    <info>SYMP-NM-000190 Archive Path</info>
#  </variable>
#  <variable>
#    <name>ARCHIVE_UN</name>
#    <default>backup_operator</default>
#    <description>SYMP-NM-000190 Archive UserName</description>
#    <info>SYMP-NM-000190 Archive UserName</info>
#  </variable>
#  <variable>
#    <name>CLOUD_SERV_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - Cloud Services Notification</description>
#    <info>SYMP-NM-000210 - Cloud Services Notification</info>
#  </variable>
#  <variable>
#    <name>CPU_UTILIZATION_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - CPU Util Notification</description>
#    <info>SYMP-NM-000210 - CPU Util Notification</info>
#  </variable>
#  <variable>
#    <name>EVENT_LOG_EMAILS</name>
#    <default>admin@bus.gov</default>
#    <description>SYMP-NM-000090 - Event Log Emails</description>
#    <info>SYMP-NM-000090 - Event Log Emails</info>
#  </variable>
#  <variable>
#    <name>ICAP_DEF_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - ICAP Def Notification</description>
#    <info>SYMP-NM-000210 - ICAP Def Notification</info>
#  </variable>
#  <variable>
#    <name>LOCAL_USERS</name>
#    <default>admin</default>
#    <description>SYMP-NM-000010 - Local User</description>
#    <info>SYMP-NM-000010 - Local User</info>
#  </variable>
#  <variable>
#    <name>MEM_UTILIZATION_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - Mem Util Notification</description>
#    <info>SYMP-NM-000210 - Mem Util Notification</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVERS</name>
#    <default>1.1.1.1</default>
#    <description>SYMP-NM-000100 - NTP Server</description>
#    <info>SYMP-NM-000100 - NTP Server</info>
#  </variable>
#  <variable>
#    <name>NW00_UTIL_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - NW00 Util Notification</description>
#    <info>SYMP-NM-000210 - NW00 Util Notification</info>
#  </variable>
#  <variable>
#    <name>NW10_UTIL_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - NW10 Util Notification</description>
#    <info>SYMP-NM-000210 - NW10 Util Notification</info>
#  </variable>
#  <variable>
#    <name>NW20_UTIL_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - NW20 Util Notification</description>
#    <info>SYMP-NM-000210 - NW20 Util Notification</info>
#  </variable>
#  <variable>
#    <name>NW21_UTIL_NOTIFICATION</name>
#    <default>log trap</default>
#    <description>SYMP-NM-000210 - NW21 Util Notification</description>
#    <info>SYMP-NM-000210 - NW21 Util Notification</info>
#  </variable>
#  <variable>
#    <name>RADIUS_IP</name>
#    <default>1.1.1.1</default>
#    <description>SYMP-NM-000150 Radius IP</description>
#    <info>SYMP-NM-000150 Radius IP</info>
#  </variable>
#  <variable>
#    <name>SYSLOG_IP</name>
#    <default>1.1.1.1</default>
#    <description>SYMP-NM-000080 - Syslog IP</description>
#    <info>SYMP-NM-000080 - Syslog IP</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"BlueCoat">

<custom_item>
  cmd         : "show attack-detection configuration"
  description : "SYMP-NM-000320 - Symantec ProxySG must enable Attack Detection."
  info        : "DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.
Symantec ProxySG Attack Detection prevents or limits the effects of denial of service (DoS) and distributed-DoS (DDoS) attacks by limiting the number of simultaneous TCP connections and/or excessive repeated requests from each client IP address that can be established within a specified time frame. Configure attack detection for both clients and servers or server groups. The client attack-detection configuration is used to control the behavior of attacking sources. The server attack-detection configuration is used when an administrator wants to prevent a server from becoming overloaded by limiting the number of outstanding requests that are allowed.
The default settings should work in most environments, but can be fine tuned to prevent impact on the site's traffic flow. Organizations should also take into consideration the capabilities and configuration of adjacent network devices (e.g., firewalls performing packet filtering to block DoS attacks).
Default settings for client DDoS settings on the ProxySG are as follows.
To view Default settings for client DDoS settings on the ProxySG, type the following command at the command line interface. ProxySG
Client limits enabled:      false
Client interval:         20 minutes
Default client limits:
  Client concurrent request limit: unlimited
  Client connection limit:     100
  Client failure limit:       50
  Client request limit:       unlimited
  Client warning limit:       10
  Blocked client action:      Drop
  Client connection unblock time:  unlimited
  Monitor only mode:        disabledfalse"
  solution    : "Enable the Attack Detection function for the default settings or fine tune needed by site environment.
1. SSH into the ProxySG console, type \"enable\".
2. Enter the correct password, type \"configure terminal\".
3. Press \"Enter\", and then type \"attack-detection\".
4. Type \"client\" and press \"Enter\", type \"enable-limits\" and press \"Enter\".
See \"Chapter 73: Preventing Denial of Service Attacks\" in the ProxySG Administration Guide to understand the functionality before proceeding. Fine tune the default client limits if there is an operational impact."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|I,CCI|CCI-002385,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104305r1_rule,STIG-ID|SYMP-NM-000320,TBA-FIISB|43.1,Vuln-ID|V-94413"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "client limits enabled"
  expect      : "client limits enabled:[\s]*true"
</custom_item>

<custom_item>
  cmd         : "show security local-user-list"
  description : "SYMP-NM-000010 - Symantec ProxySG must be configured with only one local account that is used as the account of last resort."
  info        : "Authentication for administrative (privileged level) access to the device is required at all times. An account can be created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.
The account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable the root account (if possible) when not needed for system administration functions"
  solution    : "Remove local accounts that are not the account of last resort.
1. Log on to the Web Management Console.
2. Click \"Local\".
3. If a local realm exists on the list, delete the realm."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001358,CCI|CCI-002111,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104483r1_rule,STIG-ID|SYMP-NM-000010,SWIFT-CSCv1|2.3,Vuln-ID|V-94653"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Users:"
# Note: Variable @LOCAL_USERS@ replaced with "admin" in field "expect".
  expect      : "Users:admin"
</custom_item>

<custom_item>
  description : "SYMP-NM-000020 - Symantec ProxySG must be configured to enforce user authorization to implement least privilege."
  info        : "To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Network devices use access control policies and enforcement mechanisms to implement this requirement.
Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the network device to control access between administrators (or processes acting on behalf of administrators) and objects (e.g., device commands, files, records, processes) in the network device
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Obtain a list of authorized personnel or host IP addresses and associated roles/privileges. Remove any unauthorized users or excess privileges.
1. Log on to the Web Management Console.
2. Click Configuration >> Policy >> Visual Policy Manager.
3. Click the \"Launch\" button.
4. Click the \"Admin Access\" layer.
5. Delete unauthorized users or host IP addresses and adjust or correct user authorizations for \"allow read-only\" or \"allow read-write\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000213,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104485r1_rule,STIG-ID|SYMP-NM-000020,SWIFT-CSCv1|2.3,Vuln-ID|V-94655"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000030 - Symantec ProxySG must configure Web Management Console access restrictions to authorized IP address/ranges."
  info        : "It is important that administrative access (SSH, web) to an appliance using the account of last resort be able to be restricted to only the appropriate networks/subnets in order to reduce the likelihood of unauthorized access.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure console access using the account of last resort to specific networks/subnets.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> Console Access.
3. Click \"New\".
4. Enter the IP address and subnet mask for the desired network and click \"OK\".
5. Repeat step 4 until all desired networks have been added.
6. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000213,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104487r1_rule,STIG-ID|SYMP-NM-000030,SWIFT-CSCv1|2.3,Vuln-ID|V-94657"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "security allowed-access add"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000040 - Symantec ProxySG must be configured to enforce assigned privilege levels for approved administrators when accessing the management console, SSH, and the command line interface (CLI)."
  info        : "A mechanism to detect and prevent unauthorized communication flow must be configured or provided as part of the system design. If management information flow is not enforced based on approved authorizations, the network device may become compromised. Information flow control regulates where management information is allowed to travel within a network device. The flow of all management information must be monitored and controlled so it does not introduce any unacceptable risk to the network device or data.
Application-specific examples of enforcement occur in systems that employ rule sets or establish configuration settings that restrict information system services or message-filtering capability based on message content (e.g., implementing key word searches or using document characteristics).
Applications providing information flow control must be able to enforce approved authorizations for controlling the flow of management information within the system in accordance with applicable policy
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Obtain a list of authorized personnel and IP addresses that should have access to the Web Management Console or CLI.
2. Click Configuration >> Policy >> Visual Policy Manager.
3. Click the \"Launch\" button.
4. Click the \"Admin Access\" layer.
5. For every user and/or group listed in the \"source\" field of each rule, set the Action to either \"Allow Read/Write access\" or \"Allow Read-only Access\" per the user/groups assigned privileges.
6. For every user/group, also set the Service to \"SSH-Console\", \"HTTPS-Console\", or both, per the user/groups assigned privileges.
7. Configure the account of last resort to disallow access via the \"SSH-Console\" and the \"HTTPS-Console\". Access is only allowed via the local console port and CLI.
Note that DoD requires users to be assigned to groups rather than assigned privileges to individual users whenever possible."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001368,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104489r1_rule,STIG-ID|SYMP-NM-000040,SWIFT-CSCv1|2.3,Vuln-ID|V-94659"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show security local-user-list"
  description : "SYMP-NM-000050 - Symantec ProxySG must be configured to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period. - Lockout duration"
  info        : "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced."
  solution    : "The lockout policy may be configured for both SSH and Web Management Console sessions.
1. SSH into the ProxySG console, type \"enable\", press \"Enter\".
2. Enter the appropriate password, type \"config\", press \"Enter\".
3. Type \"security local-user-list edit local_user_database\", press \"Enter\".
4. Type \"lockout-duration 900\", type \"max-failed-attempts 3\", press \"Enter\"."
  reference   : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,Rule-ID|SV-104491r1_rule,STIG-ID|SYMP-NM-000050,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-94661"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Lockout duration:"
  expect      : "Lockout duration:[\s]+900$"
</custom_item>

<custom_item>
  cmd         : "show security local-user-list"
  description : "SYMP-NM-000050 - Symantec ProxySG must be configured to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period. - Reset interval"
  info        : "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced."
  solution    : "The lockout policy may be configured for both SSH and Web Management Console sessions.
1. SSH into the ProxySG console, type \"enable\", press \"Enter\".
2. Enter the appropriate password, type \"config\", press \"Enter\".
3. Type \"security local-user-list edit local_user_database\", press \"Enter\".
4. Type \"lockout-duration 900\", type \"max-failed-attempts 3\", press \"Enter\"."
  reference   : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,Rule-ID|SV-104491r1_rule,STIG-ID|SYMP-NM-000050,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-94661"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Reset interval:"
  expect      : "Reset interval:[\s]+900$"
</custom_item>

<custom_item>
  cmd         : "show security local-user-list"
  description : "SYMP-NM-000050 - Symantec ProxySG must be configured to enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period. - max-failed-attempts"
  info        : "By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced."
  solution    : "The lockout policy may be configured for both SSH and Web Management Console sessions.
1. SSH into the ProxySG console, type \"enable\", press \"Enter\".
2. Enter the appropriate password, type \"config\", press \"Enter\".
3. Type \"security local-user-list edit local_user_database\", press \"Enter\".
4. Type \"lockout-duration 900\", type \"max-failed-attempts 3\", press \"Enter\"."
  reference   : "800-171|3.1.8,800-53|AC-7,CAT|II,CCI|CCI-000044,CN-L3|8.1.4.1(b),ITSG-33|AC-7,NIAv2|AM24,Rule-ID|SV-104491r1_rule,STIG-ID|SYMP-NM-000050,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,Vuln-ID|V-94661"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "max failed attempts:"
  expect      : "max failed attempts:[\s]+3$"
</custom_item>

<report type:"WARNING">
  description : "SYMP-NM-000060 - Symantec ProxySG must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device."
  info        : "Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.
System use notifications are required only for access via logon interfaces with human users.
Configuration of the notice banner on for logon to the management console requires the configuration of a reverse proxy service and a policy associated with this service. Refer to the detailed documentation for information on configuration. https://origin-symwisedownload.symantec.com//resources/webguides/proxysg/certification/notice_consent_webguide/Notice_Consent_Banner.htm
The banner must be formatted in accordance with applicable DoD policy. Use the following verbiage that can accommodate banners of 1300 characters:
\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"
Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:
\"I've read & consent to terms in IS user agreem't.\"false
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the Symantec ProxySG Management Console, SSH, and serial port to display the Standard Mandatory DoD Notice and Consent Banner in accordance with DoD policy before granting access to the device. Use the following verbiage for applications that can accommodate banners of 1300 characters:
\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"
Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:
\"I've read & consent to terms in IS user agreem't.\"
To create an SSH logon banner:
1. Log on to the ProxySG Web Management Console, click \"Configuration,\" then \"Authentication,\" then \"SSH Inbound Connections\".
2. Enter the desired banner text into the \"SSHv2 Welcome Banner\" field, click \"Apply\".
To create a web user interface banner:
1. Log on to the ProxySG Management Console.
2. Create a reverse proxy service for the Notice and Consent banner.
3. Create the banner policy for the reverse proxy service realm using Visual Policy Manager.
To create a banner for the serial port:
1. Log on to the Command Line Interface (CLI).
2. Enter privileged mode.
3. Enter the following commands:
<Add the banner line by line exactly as stated with no changes.>
EOF"
  reference   : "CAT|III,CCI|CCI-000048,Rule-ID|SV-104493r1_rule,STIG-ID|SYMP-NM-000060,Vuln-ID|V-94663"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-NM-000070 - Symantec ProxySG must enable event access logging."
  info        : "Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
Audit records can be generated from various components within the network device (e.g., process, module). Certain specific device functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.
DoD has defined the list of events for which the device will provide an audit record generation capability as the following:
(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);
(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and
(iii) All account creation, modification, disabling, and termination actions.
ProxySG generates the required logs both automatically and with additional configuration. See the check section for more details. Logs are written locally up to the allowed log size and overwrite the oldest log entries first when the log size limit is reached. The retention of logs written to remote syslog systems are governed by those remote systems"
  solution    : "Event access logging is enabled by default. In order to enable audit logging, both \"Event Logging\" and \"Admin Access Layer\" logging must be configured. All information is always logged, but a display filter can be set to view a subset of the information.
1. Log on to the Web Management Console.
2. Click Maintenance >> Event Logging and ensure that the log level is set to at least \"Configuration Events\"."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|II,CCI|CCI-000169,CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104495r1_rule,STIG-ID|SYMP-NM-000070,SWIFT-CSCv1|6.4,Vuln-ID|V-94665"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "level"
  expect      : "level (configuration|policy|verbose)"
</custom_item>

<custom_item>
  description : "SYMP-NM-000080 - Symantec ProxySG must be configured to support centralized management and configuration of the audit log. - enable"
  info        : "Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.
The DoD requires centralized management of all network component audit record content. Network components requiring centralized audit log management must have the capability to support centralized management. The content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Ensure at least one Syslog server and local files are configured to support requirements. However, the Syslog itself must also be configured to filter event records so it is not overwhelmed"
  solution    : "Configure event logging to a remote events server to ensure that event logs are recorded on a different system.
To configure Syslog:
1. Log on to the Web Management Console.
2. Click Maintenance >> Event Logging >> Syslog.
3. Enter the IP address or name of a syslog server, click \"OK\".
4. Repeat step 3 for any additional syslog servers.
5. Click \"Apply\"."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|II,CCI|CCI-001851,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104497r1_rule,STIG-ID|SYMP-NM-000080,SWIFT-CSCv1|6.4,Vuln-ID|V-94667"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "syslog"
  expect      : "syslog enable"
</custom_item>

<custom_item>
  description : "SYMP-NM-000080 - Symantec ProxySG must be configured to support centralized management and configuration of the audit log. - Syslog IP"
  info        : "Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.
The DoD requires centralized management of all network component audit record content. Network components requiring centralized audit log management must have the capability to support centralized management. The content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Ensure at least one Syslog server and local files are configured to support requirements. However, the Syslog itself must also be configured to filter event records so it is not overwhelmed"
  solution    : "Configure event logging to a remote events server to ensure that event logs are recorded on a different system.
To configure Syslog:
1. Log on to the Web Management Console.
2. Click Maintenance >> Event Logging >> Syslog.
3. Enter the IP address or name of a syslog server, click \"OK\".
4. Repeat step 3 for any additional syslog servers.
5. Click \"Apply\"."
  reference   : "800-171|3.3.4,800-53|AU-5,CAT|II,CCI|CCI-001851,CN-L3|7.1.3.3(e),CSF|PR.PT-1,ITSG-33|AU-5,NESA|T3.6.2,Rule-ID|SV-104497r1_rule,STIG-ID|SYMP-NM-000080,Vuln-ID|V-94667"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "syslog add"
# Note: Variable @SYSLOG_IP@ replaced with "1.1.1.1" in field "expect".
  expect      : "syslog add 1.1.1.1"
</custom_item>

<if>
  <condition type:"OR">
    <custom_item>
      description : "Event Log set to info"
      context     : "event-log ;mode"
      regex       : "level"
      expect      : "level"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-NM-000090 - Symantec ProxySG must generate an alert to the console when a log processing failure is detected such as loss of communications with the Central Log Server or log records are no longer being sent."
      info        : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without an alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages"
      solution    : "Configure the ProxySG to send notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Events Logging.
3. Select \"Severe\".
4. Select the \"Mail\" tab and enter the email address to receive the email alert.
5. Click \"Apply\"."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|III,CCI|CCI-001858,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104499r1_rule,STIG-ID|SYMP-NM-000090,SWIFT-CSCv1|6.4,Vuln-ID|V-94669"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "event-log ;mode"
      regex       : "level"
      expect      : "level (severe|configuration|policy|verbose)"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-NM-000090 - Symantec ProxySG must generate an alert to the console when a log processing failure is detected such as loss of communications with the Central Log Server or log records are no longer being sent."
      info        : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without an alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages"
      solution    : "Configure the ProxySG to send notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Events Logging.
3. Select \"Severe\".
4. Select the \"Mail\" tab and enter the email address to receive the email alert.
5. Click \"Apply\"."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|III,CCI|CCI-001858,CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104499r1_rule,STIG-ID|SYMP-NM-000090,SWIFT-CSCv1|6.4,Vuln-ID|V-94669"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  description : "SYMP-NM-000090 - Symantec ProxySG must generate an alert to the console when a log processing failure is detected such as loss of communications with the Central Log Server or log records are no longer being sent. - email addresses"
  info        : "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without an alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages"
  solution    : "Configure the ProxySG to send notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Events Logging.
3. Select \"Severe\".
4. Select the \"Mail\" tab and enter the email address to receive the email alert.
5. Click \"Apply\"."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|III,CCI|CCI-001858,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104499r1_rule,STIG-ID|SYMP-NM-000090,SWIFT-CSCv1|6.4,Vuln-ID|V-94669"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "mail add"
# Note: Variable @EVENT_LOG_EMAILS@ replaced with "admin@bus.gov" in field "expect".
  expect      : "mail add admin@bus.gov"
</custom_item>

<custom_item>
  description : "SYMP-NM-000100 - Symantec ProxySG must compare internal information system clocks at least every 24 hours with an authoritative time server. - Interval"
  info        : "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. Additionally, unnecessary synchronization may have an adverse impact on system performance and may indicate malicious activity. Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network."
  solution    : "Configure the Symantec ProxySG to use authoritative NTP servers (the NTP protocol itself enforces periodic checks at least every 24 hours).
1. Log on to the Web Management Console.
2. Select \"Configuration\", then \"General\", then \"Clock\".
3. Enter the desired time sync period into the \"Query interval (minutes) field and click Apply.
4. Click \"NTP\", then \"New\", then \"Add\" and enter each desired authoritative time server.
5. Click \"Apply\"."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CCI|CCI-001891,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-104501r1_rule,STIG-ID|SYMP-NM-000100,Vuln-ID|V-94671"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "ntp interval"
  expect      : "ntp interval (1440|1[5-9][0-9][0-9]|[2-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]+)"
</custom_item>

<custom_item>
  description : "SYMP-NM-000100 - Symantec ProxySG must compare internal information system clocks at least every 24 hours with an authoritative time server. - NTP Server"
  info        : "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. Additionally, unnecessary synchronization may have an adverse impact on system performance and may indicate malicious activity. Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network."
  solution    : "Configure the Symantec ProxySG to use authoritative NTP servers (the NTP protocol itself enforces periodic checks at least every 24 hours).
1. Log on to the Web Management Console.
2. Select \"Configuration\", then \"General\", then \"Clock\".
3. Enter the desired time sync period into the \"Query interval (minutes) field and click Apply.
4. Click \"NTP\", then \"New\", then \"Add\" and enter each desired authoritative time server.
5. Click \"Apply\"."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CCI|CCI-001891,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-104501r1_rule,STIG-ID|SYMP-NM-000100,Vuln-ID|V-94671"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "ntp server"
# Note: Variable @NTP_SERVERS@ replaced with "1.1.1.1" in field "expect".
  expect      : "ntp server 1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000110 - Symantec ProxySG must be configured to synchronize internal information system clocks with the primary and secondary time sources located in different geographic regions using redundant authoritative time sources."
  info        : "The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.
Multiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.
DoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source"
  solution    : "Configure the ProxySG is configured to use authoritative NTP servers.
1. Log on to the Web Management Console.
2. Click Configuration >> General >> Clock.
3. Click \"NTP\", click \"New\", click \"Add\" and enter each desired authoritative time server.
4. Click \"Apply\"."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CCI|CCI-000366,CCI|CCI-001893,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-104503r1_rule,STIG-ID|SYMP-NM-000110,Vuln-ID|V-94673"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "ntp server"
# Note: Variable @NTP_SERVERS@ replaced with "1.1.1.1" in field "expect".
  expect      : "ntp server 1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000120 - Symantec ProxySG must protect the Web Management Console, SSH, and command line interface (CLI) from unauthorized modification."
  info        : "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.
Network devices providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.
Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Obtain a list of authorized personnel and IP addresses that should have access to the Web Management Console or CLI.
2. Log on to the Web Management Console.
3. Click Configuration >> Policy >> Visual Policy Manager.
4. Click \"Launch\", select the \"Admin Access\" layer.
5. For every user and/or group listed in the \"source\" field of each rule, set the \"Action\" to either \"Allow Read/Write access\" or \"Allow Read-only Access\" per the user/groups assigned privileges.
6. For every user/group, also set the \"Service\" to \"SSH-Console\", \"HTTPS-Console\", or both, per the user/groups assigned privileges.
Note that DoD requires users to be assigned to groups rather than assigned privileges to individual users whenever possible."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001494,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104505r1_rule,STIG-ID|SYMP-NM-000120,SWIFT-CSCv1|2.3,Vuln-ID|V-94675"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000130 - Symantec ProxySG must protect the Web Management Console, SSH, and command line interface (CLI) from unauthorized access."
  info        : "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.
Network devices providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.
Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Obtain a list of authorized personnel and IP addresses that should have access to the Web Management Console or CLI.
2. Log on to the Web Management Console.
3. Click Configuration >> Policy >> Visual Policy Manager.
4. Click \"Launch\", select the \"Admin Access\" layer.
5. For every user and/or group listed in the \"source\" field of each rule, set the \"Action\" to either \"Allow Read/Write access\" or \"Allow Read-only Access\" per the user/groups assigned privileges.
6. For every user/group, also set the \"Service\" to \"SSH-Console\", \"HTTPS-Console\", or both, per the user/groups assigned privileges.
Note that DoD requires users to be assigned to groups rather than assigned privileges to individual users whenever possible."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001493,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104507r1_rule,STIG-ID|SYMP-NM-000130,SWIFT-CSCv1|2.3,Vuln-ID|V-94677"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000140 - Symantec ProxySG must back up event logs onto a different system or system component than the system or component being audited. - Syslog Enabled"
  info        : "Protection of log data includes assuring log data is not accidentally lost or deleted. Regularly backing up audit records to a different system or onto separate media than the system being audited helps to assure, in the event of a catastrophic system failure, the audit records will be retained.
This helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records"
  solution    : "Configure event logging to a remote events server to ensure that event logs are recorded on a different system.
To configure Syslog:
1. Log on to the Web Management Console.
2. Click Maintenance >> Event Logging >> Syslog.
3. Enter the IP address or name of a syslog server, click \"OK\".
4. Repeat step 3 for any additional syslog servers.
5. Click \"Apply\"."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,CAT|II,CCI|CCI-001348,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-104509r1_rule,STIG-ID|SYMP-NM-000140,SWIFT-CSCv1|6.4,Vuln-ID|V-94679"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "syslog"
  expect      : "syslog enable"
</custom_item>

<custom_item>
  description : "SYMP-NM-000140 - Symantec ProxySG must back up event logs onto a different system or system component than the system or component being audited. - Syslog IP"
  info        : "Protection of log data includes assuring log data is not accidentally lost or deleted. Regularly backing up audit records to a different system or onto separate media than the system being audited helps to assure, in the event of a catastrophic system failure, the audit records will be retained.
This helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records"
  solution    : "Configure event logging to a remote events server to ensure that event logs are recorded on a different system.
To configure Syslog:
1. Log on to the Web Management Console.
2. Click Maintenance >> Event Logging >> Syslog.
3. Enter the IP address or name of a syslog server, click \"OK\".
4. Repeat step 3 for any additional syslog servers.
5. Click \"Apply\"."
  reference   : "800-171|3.3.4,800-53|AU-5,CAT|II,CCI|CCI-001348,CN-L3|7.1.3.3(e),CSF|PR.PT-1,ITSG-33|AU-5,NESA|T3.6.2,Rule-ID|SV-104509r1_rule,STIG-ID|SYMP-NM-000140,Vuln-ID|V-94679"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "event-log ;mode"
  regex       : "syslog add"
# Note: Variable @SYSLOG_IP@ replaced with "1.1.1.1" in field "expect".
  expect      : "syslog add 1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000150 - Symantec ProxySG must employ automated mechanisms to centrally verify authentication settings. Radius Realm Exists"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure the Symantec ProxySG to use a centrally administered AAA server.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> RADIUS.
3. Click \"New\" then enter a Realm name.
4. Under \"Realm configuration\" enter the IP address for the primary RADIUS server and modify port (if necessary).
5. Enter a Secret pre-shared key, and enter the same Secret pre-shred key for confirmation, click \"OK\".
6. Click Radius Servers.
7. Enter an IP address for the Alternate Server and modify port (if necessary).
8. Click \"Apply\".
9. Click Configuration >> Policy >> Visual Policy Manager.
10. Click \"Launch\", select the \"Admin Authentication\" layer.
11. Right-click the \"Action\" in each rule and click \"Set\".
12. Click \"New\", then \"Authenticate\", and choose the RADIUS realm configured in step 3.
13. Click \"File\", click \"Install Policy on SG Appliance\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-000372,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104511r1_rule,STIG-ID|SYMP-NM-000150,SWIFT-CSCv1|2.3,Vuln-ID|V-94681"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "security radius create-realm"
# Note: Variable @RADIUS_IP@ replaced with "1.1.1.1" in field "expect".
  expect      : "security radius create-realm.+1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000150 - Symantec ProxySG must employ automated mechanisms to centrally verify authentication settings. - Policy Review"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the Symantec ProxySG to use a centrally administered AAA server.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> RADIUS.
3. Click \"New\" then enter a Realm name.
4. Under \"Realm configuration\" enter the IP address for the primary RADIUS server and modify port (if necessary).
5. Enter a Secret pre-shared key, and enter the same Secret pre-shred key for confirmation, click \"OK\".
6. Click Radius Servers.
7. Enter an IP address for the Alternate Server and modify port (if necessary).
8. Click \"Apply\".
9. Click Configuration >> Policy >> Visual Policy Manager.
10. Click \"Launch\", select the \"Admin Authentication\" layer.
11. Right-click the \"Action\" in each rule and click \"Set\".
12. Click \"New\", then \"Authenticate\", and choose the RADIUS realm configured in step 3.
13. Click \"File\", click \"Install Policy on SG Appliance\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-000372,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104511r1_rule,STIG-ID|SYMP-NM-000150,SWIFT-CSCv1|2.3,Vuln-ID|V-94681"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000160 - Accounts for device management must be configured on the authentication server and not on Symantec ProxySG itself, except for the account of last resort."
  info        : "Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "In order to configure the ProxySG to use a centrally administered AAA server (LDAP to Active Directory):
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> LDAP.
3. Click \"New\", provide a name for the realm.
4. Change the \"Type of LDAP server\" to be \"Microsoft Active Directory\".
5. Provide an IP address or FQDN for the \"Primary Server host\" and change the port to 636 for LDAP over TLS.
6. Change the \"User attribute type\" if your organization uses a different attribute than the sAMAccountName, click \"OK\".
7. Click on the \"LDAP Servers\" tab, select \"Enable SSL\", and confirm the other settings per your organization.
8. Click through the \"LDAP DN\", \"LDAP Search & Groups\", \"LDAP Objectclasses\", and \"LDAP General\" tabs and ensure that the settings are appropriate for your organization.
9. Click \"Apply\".
10. To test the configuration, click the \"Test Configuration\" button under \"LDAP Servers\", and provide a valid username and password.
11. Still within the \"Configuration\" tab, click on \"Policy\", then \"Visual Policy Editor\" and click \"Launch\".
12. Click \"Policy\" and choose \"Add Admin Authentication Layer\".
13. Give it a name and click \"OK\".
14. Right-click the \"Action\" cell and choose \"Set\".
15. With \"AdminAuthenticate1\" highlighted, click \"Edit\".
16. Choose the \"Realm\" that was created on step 3, and click \"OK\", click \"OK\" again.
17. Click \"Policy\" and choose \"Add Admin Access Layer\".
18. Give it a name and click \"OK\".
19. Right-click the \"Source\" field and click \"Set\".
20. If a \"local realm\" exists in the list, highlight it and click \"Remove\".
21. Click \"New\", and choose either \"User\" or \"Group\" depending on what you wish to accomplish.
22. Provide the user or group name, and ensure that the Authentication Realm from step 3 is selected, and populate the Group/User Base DN and \"Full Name\" fields as appropriate for your organization.
23. If you wish to restrict this user/group to specific management services, right-click the \"Service\" Field, and select \"Set\", click \"New\", click \"Service Name\" then choose the appropriate service name. Repeat for any other specific services you would like to grant access for. Then click \"OK\".
24. Right-click the \"Action\" cell, and either choose \"read-only\" or \"read/write\" access.
25. Click \"File\" and choose \"Install Policy on SG Appliance\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-000370,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104513r1_rule,STIG-ID|SYMP-NM-000160,SWIFT-CSCv1|2.3,Vuln-ID|V-94683"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security ldap edit-realm .* ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000170 - Symantec ProxySG must use Role-Based Access Control (RBAC) to assign privileges to users for access to files and functions."
  info        : "Organizations can create specific roles based on job functions and the authorizations (i.e., privileges) to perform needed operations on organizational information systems associated with the organization-defined roles. When administrators are assigned to the organizational roles, they inherit the authorizations or privileges defined for those roles. RBAC simplifies privilege administration for organizations because privileges are not assigned directly to every administrator (which can be a significant number of individuals for mid- to large-size organizations) but are instead acquired through role assignments. RBAC can be implemented either as a mandatory or discretionary form of access control.
The RBAC policies and the subjects and objects are defined uniquely for each network device, so they cannot be specified in the requirement
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG for role-based group access.
1. Log on to the Web Management Console.
2. Click Configuration >> Policy >> Visual Policy Manager.
3. Click \"Launch\", select \"Admin Access Layer\".
4. For each rule that does not have an Action of \"None\" or \"Deny\" that also does not have a user group set in the \"Source\" field, right-click the \"Source\" field and click \"Set\".
5. Click each \"Source Object\" that represents a specific user (vs a user group) and click \"Remove\".
6. Click \"New\" and select \"Group\" from the menu. Enter the correct information for the desired user group which should have access to the ProxySG and click \"OK\", then \"OK\" again. Repeat for each rule in the Admin Access layer.
7. Click the \"Install Policy\" button to commit the changes to the Symantec ProxySG."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-002169,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104515r1_rule,STIG-ID|SYMP-NM-000170,SWIFT-CSCv1|2.3,Vuln-ID|V-94685"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000180 - Symantec ProxySG must employ automated mechanisms to centrally apply authentication settings. Radius Realm Exists"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion."
  solution    : "Configure the Symantec ProxySG to use a centrally administered AAA server.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> RADIUS.
3. Click \"New\" then enter a Realm name.
4. Under \"Realm configuration\", enter the IP address for the primary RADIUS server and modify port (if necessary).
5. Enter a Secret pre-shared key, and enter the same Secret pre-shared key for confirmation, and click \"OK\".
6. Click \"Radius Servers\".
7. Enter an IP address for the Alternate Server and modify port (if necessary).
8. Click \"Apply\".
9. Click Policy >> Visual Policy Manager.
10. Click \"Launch\", select the \"Admin Authentication\" Layer, right-click the Action in each rule, and click \"Set\".
11. Click \"New\", click \"Authenticate\", and choose the RADIUS realm configured in step 2.
12. Click \"File\" and then \"Install Policy on SG Appliance\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-000371,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104517r1_rule,STIG-ID|SYMP-NM-000180,SWIFT-CSCv1|2.3,Vuln-ID|V-94687"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "security radius create-realm"
# Note: Variable @RADIUS_IP@ replaced with "1.1.1.1" in field "expect".
  expect      : "security radius create-realm.+1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000180 - Symantec ProxySG must employ automated mechanisms to centrally apply authentication settings. - Policy Review"
  info        : "The use of authentication servers or other centralized management servers for providing centralized authentication services is required for network device management. Maintaining local administrator accounts for daily usage on each network device without centralized management is not scalable or feasible. Without centralized management, it is likely that credentials for some network devices will be forgotten, leading to delays in administration, which itself leads to delays in remediating production problems and in addressing compromises in a timely fashion.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the Symantec ProxySG to use a centrally administered AAA server.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> RADIUS.
3. Click \"New\" then enter a Realm name.
4. Under \"Realm configuration\", enter the IP address for the primary RADIUS server and modify port (if necessary).
5. Enter a Secret pre-shared key, and enter the same Secret pre-shared key for confirmation, and click \"OK\".
6. Click \"Radius Servers\".
7. Enter an IP address for the Alternate Server and modify port (if necessary).
8. Click \"Apply\".
9. Click Policy >> Visual Policy Manager.
10. Click \"Launch\", select the \"Admin Authentication\" Layer, right-click the Action in each rule, and click \"Set\".
11. Click \"New\", click \"Authenticate\", and choose the RADIUS realm configured in step 2.
12. Click \"File\" and then \"Install Policy on SG Appliance\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-000371,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104517r1_rule,STIG-ID|SYMP-NM-000180,SWIFT-CSCv1|2.3,Vuln-ID|V-94687"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000190 - Symantec ProxySG must support organizational requirements to conduct backups of system level information contained in the ProxySG when changes occur or weekly, whichever is sooner. -Host"
  info        : "System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.
This control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups"
  solution    : "Configure backups for remote storage as follows.
1. Log on to the Web Management Console.
2. Click Configuration >> General >> Archive >> Archive Storage.
3. Provide the correct entries in the \"Remote Upload\" fields for an available remote backup storage server (Protocol, Host, Path, Username).
4. Click \"Apply\".
Note: Please see Chapter 5: Backing Up the Configuration in the ProxySG Administration Guide for complete details."
  reference   : "800-171|3.8.9,800-53|CP-9,CAT|II,CCI|CCI-000366,CCI|CCI-000537,CSF|PR.IP-4,ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4,Rule-ID|SV-104519r1_rule,STIG-ID|SYMP-NM-000190,Vuln-ID|V-94689"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "archive-configuration host"
# Note: Variable @ARCHIVE_HOST@ replaced with "1.1.1.1" in field "expect".
  expect      : "archive-configuration host 1.1.1.1"
</custom_item>

<custom_item>
  description : "SYMP-NM-000190 - Symantec ProxySG must support organizational requirements to conduct backups of system level information contained in the ProxySG when changes occur or weekly, whichever is sooner. - Path"
  info        : "System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.
This control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups"
  solution    : "Configure backups for remote storage as follows.
1. Log on to the Web Management Console.
2. Click Configuration >> General >> Archive >> Archive Storage.
3. Provide the correct entries in the \"Remote Upload\" fields for an available remote backup storage server (Protocol, Host, Path, Username).
4. Click \"Apply\".
Note: Please see Chapter 5: Backing Up the Configuration in the ProxySG Administration Guide for complete details."
  reference   : "800-171|3.8.9,800-53|CP-9,CAT|II,CCI|CCI-000366,CCI|CCI-000537,CSF|PR.IP-4,ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4,Rule-ID|SV-104519r1_rule,STIG-ID|SYMP-NM-000190,Vuln-ID|V-94689"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "archive-configuration path"
# Note: Variable @ARCHIVE_PATH@ replaced with "/backups" in field "expect".
  expect      : "archive-configuration path \"/backups\""
</custom_item>

<custom_item>
  description : "SYMP-NM-000190 - Symantec ProxySG must support organizational requirements to conduct backups of system level information contained in the ProxySG when changes occur or weekly, whichever is sooner. - Username"
  info        : "System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.
This control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups"
  solution    : "Configure backups for remote storage as follows.
1. Log on to the Web Management Console.
2. Click Configuration >> General >> Archive >> Archive Storage.
3. Provide the correct entries in the \"Remote Upload\" fields for an available remote backup storage server (Protocol, Host, Path, Username).
4. Click \"Apply\".
Note: Please see Chapter 5: Backing Up the Configuration in the ProxySG Administration Guide for complete details."
  reference   : "800-171|3.8.9,800-53|CP-9,CAT|II,CCI|CCI-000366,CCI|CCI-000537,CSF|PR.IP-4,ISO/IEC-27001|A.12.3.1,ITSG-33|CP-9,NESA|M5.2.3,NESA|T2.2.4,Rule-ID|SV-104519r1_rule,STIG-ID|SYMP-NM-000190,Vuln-ID|V-94689"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "archive-configuration username"
# Note: Variable @ARCHIVE_UN@ replaced with "backup_operator" in field "expect".
  expect      : "archive-configuration username \"backup_operator\""
</custom_item>

<custom_item>
  description : "SYMP-NM-000200 - Symantec ProxySG must obtain its public key certificates from an appropriate certificate policy through an approved service provider.- Keyring Name"
  info        : "For user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Assign an appropriately signed certificate to the management interface.
1. Log on to the Web Management Console.
2. Click Configuration >> SSL >> Keyrings.
3. Click \"Create\", provide a name and bit size, click \"OK\".
4. Select the newly created keyring, click \"Edit\".
5. Click \"Create\" under \"Certificate Signing Request\" and enter the appropriate information, click \"OK\", click \"Close\", click \"Apply\".
6. Select the newly created keyring, click \"Edit\".
7. Copy the text in the \"Certificate Signing Request\" field and submit to your appropriate Certificate Authority.
8. Once the certificate has been issued, paste it into the \"Certificate\" field, click \"Close\", click \"Apply\".
9. Click Services >> Management Services, click on \"HTTPS-Console\", click \"Edit\".
10. Change the \"Keyring\" value to the newly created keyring, click \"OK\", click \"Apply\"."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000366,CCI|CCI-001159,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-104521r1_rule,STIG-ID|SYMP-NM-000200,Vuln-ID|V-94691"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"HTTPS-Console\" ;mode"
  regex       : "attribute keyring"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "SYMP-NM-000200 - Symantec ProxySG must obtain its public key certificates from an appropriate certificate policy through an approved service provider."
  info        : "For user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Assign an appropriately signed certificate to the management interface.
1. Log on to the Web Management Console.
2. Click Configuration >> SSL >> Keyrings.
3. Click \"Create\", provide a name and bit size, click \"OK\".
4. Select the newly created keyring, click \"Edit\".
5. Click \"Create\" under \"Certificate Signing Request\" and enter the appropriate information, click \"OK\", click \"Close\", click \"Apply\".
6. Select the newly created keyring, click \"Edit\".
7. Copy the text in the \"Certificate Signing Request\" field and submit to your appropriate Certificate Authority.
8. Once the certificate has been issued, paste it into the \"Certificate\" field, click \"Close\", click \"Apply\".
9. Click Services >> Management Services, click on \"HTTPS-Console\", click \"Edit\".
10. Change the \"Keyring\" value to the newly created keyring, click \"OK\", click \"Apply\"."
  reference   : "CAT|II,CCI|CCI-000366,CCI|CCI-001159,Rule-ID|SV-104521r1_rule,STIG-ID|SYMP-NM-000200,Vuln-ID|V-94691"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - CPU Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification cpu-utilization"
# Note: Variable @CPU_UTILIZATION_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification cpu-utilization log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - Memory Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification memory-utilization"
# Note: Variable @MEM_UTILIZATION_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification memory-utilization log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - NW 0:0 Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification network-utilization 0:0"
# Note: Variable @NW00_UTIL_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification network-utilization 0:0 log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - NW 1:0 Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification network-utilization 1:0"
# Note: Variable @NW10_UTIL_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification network-utilization 1:0 log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - NW 2:0 Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification network-utilization 2:0"
# Note: Variable @NW20_UTIL_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification network-utilization 2:0 log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - NW 2:1 Utilization"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification network-utilization 2:1"
# Note: Variable @NW21_UTIL_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification network-utilization 2:1 log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - Cloud Services"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification cloud-common-policy update-errors"
# Note: Variable @CLOUD_SERV_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification cloud-common-policy update-errors log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - ICAP Deferred"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification icap deferred-connections email"
# Note: Variable @ICAP_DEF_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification icap deferred-connections email log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - ICAP queued"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse"
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert notification icap queued-connections"
# Note: Variable @CLOUD_SERV_NOTIFICATION@ replaced with "log trap" in field "expect".
  expect      : "alert notification icap queued-connections log trap"
</custom_item>

<custom_item>
  description : "SYMP-NM-000210 - Symantec ProxySG must configure the maintenance and health monitoring to send an alarm when a critical condition occurs for a component. - Thresholds"
  info        : "Predictable failure prevention requires organizational planning to address device failure issues. If components key to maintaining the device's security fail to function, the device could continue operating in an insecure state. If appropriate actions are not taken when a network device failure occurs, a denial of service condition may occur which could result in mission failure since the network would be operating without a critical security monitoring and prevention function. Upon detecting a failure of network device security components, the network device must activate a system alert message or send an alarm.
The type of alarm should ensure that an administrator is made aware of the situation within a period specified in the site's SSP based on mission impact. Alarms may be a message send to an events server, SNMP server, email/text, or a monitored console.
The following alarms are required for ProxySG devices used in DoD.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Rebootfalse
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the Symantec ProxySG to send system health notifications.
1. Log on to the Web Management Console.
2. Click Maintenance >> Health Monitoring, select the \"General\" tab.
3. Click on each metric, click \"Edit\" and set the desired thresholds and notification types (Log, Trap, and/or Email).
4. Click \"Apply\".
Configure the following alarms at a minimum.
General
* CPU utilization
* Memory utilization
* Interface(s) utilization
Licensing
* User license utilization
* Base license expiration
Status
* Disk
* Sensor Count Status
* Reboot"
  reference   : "800-53|SI-4(5),CAT|II,CCI|CCI-000366,CCI|CCI-001328,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4(5),Rule-ID|SV-104523r1_rule,STIG-ID|SYMP-NM-000210,SWIFT-CSCv1|6.4,TBA-FIISB|45.2.5,Vuln-ID|V-94693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "alert threshold"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-NM-000220 - Symantec ProxySG must use only approved management services protocols."
  info        : "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.
Network devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.
To support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved"
  solution    : "By default, Symantec ProxySG has only HTTPS and SSH enabled for management services. SNMP may also be enabled if needed to support the architecture. \"HTTP-Console\" is not approved for use in DoD.
1. Log on to Web Management Console.
2. Click Configuration >> Services >> Management Services.
3. Uncheck \"enabled\" next to unapproved management services such as \"HTTP-Console\".
4. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000382,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104525r1_rule,STIG-ID|SYMP-NM-000220,SWIFT-CSCv1|2.3,Vuln-ID|V-94695"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  not_expect  : "edit \"HTTP-Console\" ;mode"
</custom_item>

<custom_item>
  description : "SYMP-NM-000230 - Symantec ProxySG must implement HTTPS-console to provide replay-resistant authentication mechanisms for network access to privileged accounts.- HTTPS Console Enabled"
  info        : "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.
An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.
Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators"
  solution    : "Enable TLS management services.
1. Log on to Web Management Console.
2. Click Configuration >> Services >> Management Services.
3. Make sure that \"HTTPS-Console\" is \"Enabled\".
4. Uncheck \"Enabled\" next to that \"HTTP-Console\".
5. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001941,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104527r1_rule,STIG-ID|SYMP-NM-000230,SWIFT-CSCv1|2.3,Vuln-ID|V-94697"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  expect      : "edit \"HTTPS-Console\" ;mode"
</custom_item>

<custom_item>
  description : "SYMP-NM-000230 - Symantec ProxySG must implement HTTPS-console to provide replay-resistant authentication mechanisms for network access to privileged accounts.- HTTP Console Not Enabled"
  info        : "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.
An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.
Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators"
  solution    : "Enable TLS management services.
1. Log on to Web Management Console.
2. Click Configuration >> Services >> Management Services.
3. Make sure that \"HTTPS-Console\" is \"Enabled\".
4. Uncheck \"Enabled\" next to that \"HTTP-Console\".
5. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001941,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104527r1_rule,STIG-ID|SYMP-NM-000230,SWIFT-CSCv1|2.3,Vuln-ID|V-94697"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  not_expect  : "edit \"HTTP-Console\" ;mode"
</custom_item>

<custom_item>
  description : "SYMP-NM-000240 - Symantec ProxySG must configure SNMPv3 so that cryptographically-based bidirectional authentication is used.- SNMPv3 Enabled"
  info        : "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.
A local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).
Because of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability"
  solution    : "Enable only SNMPv3 (which supports authentication) on the Symantec ProxySG.
1. Log on to the Web Management Console.
2. Click Maintenance >> SNMP.
3. Uncheck \"Enable SNMPv1\" and \"Enable SNMPv2c\" and check \"Enable SNMPv3\".
4. Click on \"SNMPv3 Users\", click \"New\" and enter the desired username, credentials, and authorization settings, click \"OK\".
5. Click \"SNMPv3 Traps\", click \"New\", enter the IP address/FQDN for the SNMP receiver.
6. Click \"OK\", click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001967,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104529r1_rule,STIG-ID|SYMP-NM-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94699"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "snmp ;mode"
  not_expect  : "protocol snmpv3 disable"
</custom_item>

<custom_item>
  description : "SYMP-NM-000240 - Symantec ProxySG must configure SNMPv3 so that cryptographically-based bidirectional authentication is used.- SNMPv1 Disabled"
  info        : "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.
A local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).
Because of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability"
  solution    : "Enable only SNMPv3 (which supports authentication) on the Symantec ProxySG.
1. Log on to the Web Management Console.
2. Click Maintenance >> SNMP.
3. Uncheck \"Enable SNMPv1\" and \"Enable SNMPv2c\" and check \"Enable SNMPv3\".
4. Click on \"SNMPv3 Users\", click \"New\" and enter the desired username, credentials, and authorization settings, click \"OK\".
5. Click \"SNMPv3 Traps\", click \"New\", enter the IP address/FQDN for the SNMP receiver.
6. Click \"OK\", click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001967,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104529r1_rule,STIG-ID|SYMP-NM-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94699"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "snmp ;mode"
  regex       : "protocol snmpv1 disable"
  expect      : "protocol snmpv1 disable"
</custom_item>

<custom_item>
  description : "SYMP-NM-000240 - Symantec ProxySG must configure SNMPv3 so that cryptographically-based bidirectional authentication is used.- SNMPv2 Disabled"
  info        : "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.
A local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).
Because of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability"
  solution    : "Enable only SNMPv3 (which supports authentication) on the Symantec ProxySG.
1. Log on to the Web Management Console.
2. Click Maintenance >> SNMP.
3. Uncheck \"Enable SNMPv1\" and \"Enable SNMPv2c\" and check \"Enable SNMPv3\".
4. Click on \"SNMPv3 Users\", click \"New\" and enter the desired username, credentials, and authorization settings, click \"OK\".
5. Click \"SNMPv3 Traps\", click \"New\", enter the IP address/FQDN for the SNMP receiver.
6. Click \"OK\", click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001967,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104529r1_rule,STIG-ID|SYMP-NM-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94699"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "snmp ;mode"
  regex       : "protocol snmpv2c disable"
  expect      : "protocol snmpv2c disable"
</custom_item>

<custom_item>
  description : "SYMP-NM-000240 - Symantec ProxySG must configure SNMPv3 so that cryptographically-based bidirectional authentication is used.- SNMPv3 User Exists"
  info        : "Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.
A local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).
Because of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability"
  solution    : "Enable only SNMPv3 (which supports authentication) on the Symantec ProxySG.
1. Log on to the Web Management Console.
2. Click Maintenance >> SNMP.
3. Uncheck \"Enable SNMPv1\" and \"Enable SNMPv2c\" and check \"Enable SNMPv3\".
4. Click on \"SNMPv3 Users\", click \"New\" and enter the desired username, credentials, and authorization settings, click \"OK\".
5. Click \"SNMPv3 Traps\", click \"New\", enter the IP address/FQDN for the SNMP receiver.
6. Click \"OK\", click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001967,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104529r1_rule,STIG-ID|SYMP-NM-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94699"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "snmp ;mode"
  regex       : "create user"
  expect      : "create user .+"
</custom_item>

<custom_item>
  cmd         : "show security"
  description : "SYMP-NM-000250 - Symantec ProxySG must be configured to enforce a minimum 15-character password length for local accounts."
  info        : "Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.
The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password"
  solution    : "In order to set the minimum password length 15 characters.
1. Log on to the Symantec ProxySG SSH CLI.
2. Type \"enable\", enter the enable password.
3. Type \"configure\" and press \"Enter\".
4. Type \"security password-min-len 15\" and press \"Enter\"."
  reference   : "800-171|3.5.7,800-53|IA-5(1),CAT|II,CCI|CCI-000205,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,Rule-ID|SV-104531r1_rule,STIG-ID|SYMP-NM-000250,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-94701"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Minimum Password Length: "
  expect      : "Minimum Password Length: (1[5-9]|[2-9][0-9]|[1-9][0-9][0-9]+)"
</custom_item>

<custom_item>
  description : "SYMP-NM-000260 - Symantec ProxySG must transmit only encrypted representations of passwords.- HTTPS-Console Enabled"
  info        : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.
Network devices can accomplish this by making direct function calls to encryption modules or by leveraging operating system encryption capabilities"
  solution    : "Enable TLS management services.
1. Log on to the Web Management Console.
2. Click Configuration >> Services >> Management Services.
3. Ensure \"HTTPS-Console\" is already enabled.
4. Ensure \"HTTP-Console\" is not enabled.
5. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000197,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104533r1_rule,STIG-ID|SYMP-NM-000260,SWIFT-CSCv1|2.3,Vuln-ID|V-94703"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  expect      : "edit \"HTTPS-Console\" ;mode"
</custom_item>

<custom_item>
  description : "SYMP-NM-000260 - Symantec ProxySG must transmit only encrypted representations of passwords. - HTTP-Console Disabled"
  info        : "Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.
Network devices can accomplish this by making direct function calls to encryption modules or by leveraging operating system encryption capabilities"
  solution    : "Enable TLS management services.
1. Log on to the Web Management Console.
2. Click Configuration >> Services >> Management Services.
3. Ensure \"HTTPS-Console\" is already enabled.
4. Ensure \"HTTP-Console\" is not enabled.
5. Click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000197,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104533r1_rule,STIG-ID|SYMP-NM-000260,SWIFT-CSCv1|2.3,Vuln-ID|V-94703"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  not_expect  : "edit \"HTTP-Console\" ;mode"
</custom_item>

<report type:"WARNING">
  description : "SYMP-NM-000270 - Symantec ProxySG must not have a default manufacturer passwords when deployed."
  info        : "Network devices not protected with strong password schemes provide the opportunity for anyone to crack the password and gain access to the device, which can result in loss of availability, confidentiality, or integrity of network traffic.
Many default vendor passwords are well known or are easily guessed; therefore, not removing them prior to deploying the network device into production provides an opportunity for a malicious user to gain unauthorized access to the device
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Passwords are set during initial configuration of the Symantec ProxySG. In order to perform this action on a new appliance:
1. Connect to the Symantec ProxySG via a serial console, choose \"Manual Setup\", and follow the prompts to set system parameters, including local account passwords.
2. Once the system has been configured, local passwords can be changed from the Web Management Console, click Configuration >> Authentication >> Console Access >> Change Password."
  reference   : "CAT|II,CCI|CCI-002041,Rule-ID|SV-104535r1_rule,STIG-ID|SYMP-NM-000270,Vuln-ID|V-94705"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  cmd         : "show management-services"
  description : "SYMP-NM-000280 - Symantec ProxySG must be configured to use only FIPS 140-2 approved algorithms for authentication to a cryptographic module with any application or protocol."
  info        : "Unapproved mechanisms that are used for authentication to the cryptographic module are not validated and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.
The Symantec ProxySG can be configured in FIPS-mode, but this is not recommended by the vendor or DoD. Instead, ensure that FIPS-compliant mechanisms are used for authenticating to cryptographic modules when not in FIPS-mode. This is true by default, but must be verified to prevent misconfiguration by an administrator.
FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.
To protect the integrity of the authenticator and authentication mechanism used for the cryptographic module used by the network device, the application, operating system, or protocol must be configured to use one of the following hash functions for hashing the password or other authenticator in accordance with SP 800-131Ar1: SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256, SHA3-224, SHA3-256, SHA3-384, and SHA3-512.
Applications also include HMAC, KDFs, Random Bit Generation, and hash-only applications (e.g., hashing passwords and using SHA-1 or higher to compute a checksum). For digital signature verification, SP800-131Ar1 allows SHA-1 for legacy use where needed.
Currently, the AES block cipher algorithm is approved for use in DoD for both applying cryptographic protection (e.g., encryption) and removing or verifying the protection that was previously applied (e.g., decryption). NTP devices use MD5 authentication keys. The MD5 algorithm is not specified in either the FIPS or NIST recommendation; thus, a CAT 1 finding if used. However, MD5 is preferred to no authentication at all"
  solution    : "Configure the ProxySG to use only FIPS 140-2 approved algorithms.
1. Log on to the CLI via SSH.
2. Type \"enable\", press \"Enter\".
3. Type \"configure\", press \"Enter\".
4. Type \"management services\", press \"Enter\".
5. Type \"edit https-console\", press \"Enter\".
6. Type \"attribute cipher-suite\", press \"Enter\".
7. From the list displayed, enter a list of cipher numbers (comma separated) that correspond to only FIPS 140-2 approved algorithms."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104537r1_rule,STIG-ID|SYMP-NM-000280,SWIFT-CSCv1|2.6,Vuln-ID|V-94707"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show management-services"
  description : "SYMP-NM-000290 - The Symantec ProxySG Web Management Console and SSH sessions must implement cryptographic mechanisms to protect the confidentiality of nonlocal maintenance and diagnostic communications."
  info        : "This requirement requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to eavesdropping, potentially putting sensitive data (including administrator passwords) at risk of compromise and potentially allowing hijacking of maintenance sessions."
  solution    : "Configure the Symantec ProxySG to use only AES ciphers for nonlocal maintenance and diagnostic communications.
1. Log on to the CLI via SSH.
2. Type \"enable\", enter the enable password.
3. Type \"configure terminal\" and press \"Enter\".
4. Type \"management-services\" and press \"Enter\", type \"edit HTTPS-Console\" and press \"Enter\".
5. Type \"view\" to display the list of configured cipher suites.
6. Type \"attribute cipher-suite\" followed by a space-delimited list of only cipher suites from step 5 containing AES and press \"Enter\"."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-003123,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104539r1_rule,STIG-ID|SYMP-NM-000290,SWIFT-CSCv1|2.6,Vuln-ID|V-94709"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show management-services"
  description : "SYMP-NM-000300 - The Symantec ProxySG must use FIPS-validated Keyed-Hash Message Authentication Code (HMAC) to protect the integrity of nonlocal maintenance and diagnostic communications."
  info        : "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.
Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the Internet) or an internal network.
Currently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.
Separate requirements for configuring applications and protocols used by each application (e.g., SNMPv3, SSHv2, NTP, HTTPS, and other protocols and applications that require server/client authentication) are required to implement this requirement. Where SSH is used, the SSHv2 protocol suite is required because it includes Layer 7 protocols such as SCP and SFTP, which can be used for secure file transfers"
  solution    : "Configure the ProxySG to use only FIPS compliant HMAC algorithms.
1. Log on to the CLI via SSH.
2. Type \"enable\", enter the enable password.
3. Type \"configure terminal\" and press \"Enter\".
4. Type \"management-services\" and press \"Enter\", type \"edit HTTPS-Console\" and press \"Enter\".
5. Type \"view\" to display the list of configured cipher suites.
6. Type \"attribute cipher-suite\" followed by a space-delimited list of only cipher suites from step 5 which use FIPS compliant HMAC algorithms and press \"Enter\"."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-002890,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104541r1_rule,STIG-ID|SYMP-NM-000300,SWIFT-CSCv1|2.6,Vuln-ID|V-94711"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  description : "SYMP-NM-000310 - Symantec ProxySG must terminate all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill documented and validated mission requirements. - web timeout"
  info        : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed Symantec ProxySG.
Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.
By default, when a user logs off of the session all session attributes are terminated. For abruptly terminated sessions, the Keep-alive default is 2 minutes and then the session is terminated and cleans up. This is inherent to the system and cannot be misconfigured"
  solution    : "Configure the device management session inactivity timeouts to \"10\" minutes.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> Console Access >> Console Account.
3. Set \"Enforce Web auto-logout\" and \"Enforce CLI auto-logout\" to \"10\" minutes."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|I,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104543r1_rule,STIG-ID|SYMP-NM-000310,Vuln-ID|V-94713"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "security management web-timeout"
  expect      : "security management web-timeout 10"
</custom_item>

<custom_item>
  description : "SYMP-NM-000310 - Symantec ProxySG must terminate all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill documented and validated mission requirements. - cli timeout"
  info        : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed Symantec ProxySG.
Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.
By default, when a user logs off of the session all session attributes are terminated. For abruptly terminated sessions, the Keep-alive default is 2 minutes and then the session is terminated and cleans up. This is inherent to the system and cannot be misconfigured"
  solution    : "Configure the device management session inactivity timeouts to \"10\" minutes.
1. Log on to the Web Management Console.
2. Click Configuration >> Authentication >> Console Access >> Console Account.
3. Set \"Enforce Web auto-logout\" and \"Enforce CLI auto-logout\" to \"10\" minutes."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|I,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104543r1_rule,STIG-ID|SYMP-NM-000310,Vuln-ID|V-94713"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "security management cli-timeout"
  expect      : "security management cli-timeout 10"
</custom_item>

</check_type>
