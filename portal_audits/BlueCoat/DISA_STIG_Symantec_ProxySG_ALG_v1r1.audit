#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2020/04/15 $
#
#<ui_metadata>
#<display_name>DISA Symantec ProxySG Benchmark ALG v1r1</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>DISA Symantec ProxySG ALG</name>
#  <version>1.1.0</version>
#</spec>
#<labels>symantec,bluecoat,disa,proxysg</labels>
#<variables>
#  <variable>
#    <name>CLIENT_NEG_SSL_VER</name>
#    <default>.*TLSv1.2.*</default>
#    <description>SYMP-AG-000030 Client SSL VER</description>
#    <info>SYMP-AG-000030 Client SSL VER</info>
#  </variable>
#  <variable>
#    <name>CLIENT_NEG_CIPHER</name>
#    <default>.*AES128-GCM-SHA256,AES128-SHA.*</default>
#    <description>SYMP-AG-000030 Client Cipher</description>
#    <info>SYMP-AG-000030 Client Cipher</info>
#  </variable>
#  <variable>
#    <name>SERVER_NEG_CIPHER</name>
#    <default>.*AES128-GCM-SHA256,AES128-SHA.*</default>
#    <description>SYMP-AG-000030 - Server Cipher</description>
#    <info>SYMP-AG-000030 - Server Cipher</info>
#  </variable>
#  <variable>
#    <name>SERVER_NEG_SSL_VER</name>
#    <default>.*TLSv1.2.*</default>
#    <description>SYMP-AG-000030 Server SSL VER</description>
#    <info>SYMP-AG-000030 Server SSL VER</info>
#  </variable>
#  <variable>
#    <name>SSL_VERSIONS</name>
#    <default>.*TLSv1.2.*</default>
#    <description>SYMP-AG-000040 Reverse Proxy SSL VER</description>
#    <info>SYMP-AG-000040 Reverse Proxy SSL VER</info>
#  </variable>
#  <variable>
#    <name>CREDENTIAL_REFRESH_TIME</name>
#    <default>900</default>
#    <description>SYMP-AG-000310 Cred Refresh Time</description>
#    <info>SYMP-AG-000310 Cred Refresh Time</info>
#  </variable>
#  <variable>
#    <name>APPROVED_CIPHERS</name>
#    <default>^Cipher Suite: ecdhe-rsa-aes256-sha384$</default>
#    <description>SYMP-AG-000380 FIPS Ciphers</description>
#    <info>SYMP-AG-000380 FIPS Ciphers</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"BlueCoat">

<custom_item>
  description : "SYMP-AG-000010 - If Symantec ProxySG filters externally initiated traffic, reverse proxy services must be configured."
  info        : "Automated monitoring of remote access traffic allows organizations to detect cyber attacks and also ensure ongoing compliance with remote access policies by inspecting connection activities of remote access capabilities.
Remote access methods include both unencrypted and encrypted traffic (e.g., web portals, web content filter, TLS, and webmail). With inbound TLS inspection, the traffic must be inspected prior to being allowed on the enclave's web servers hosting TLS or HTTPS applications
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to monitor and control inbound traffic by configuring reverse proxy services. This provides SSL proxy in reverse proxy mode.
1. Log on to the Web Management Console.
2. Click Configuration >> Services >> Proxy Services.
3. Click \"New Service\".
4. Enter information into the various service boxes in accordance with site architecture, operational requirements, and SSP requirements for which web servers are to be monitored and controlled."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000067,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104171r1_rule,STIG-ID|SYMP-AG-000010,SWIFT-CSCv1|2.3,Vuln-ID|V-94217"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "proxy-services ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000020 - Symantec ProxySG providing intermediary services for remote access communications traffic must ensure outbound traffic is monitored for compliance with remote access security policies."
  info        : "Automated monitoring of remote access traffic allows organizations to detect cyber attacks and also ensure ongoing compliance with remote access policies by inspecting connection activities of remote access capabilities.
Remote access methods include both unencrypted and encrypted traffic (e.g., web portals, web content filter, TLS, and webmail). With outbound traffic inspection, traffic must be inspected prior to being forwarded to destinations outside of the enclave, such as external email traffic"
  solution    : "Configure the ProxySG to inspect internally initiated traffic.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer (transparent proxy architectures) or Add Web Access Layer (explicit proxy architectures).
4. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000067,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104173r1_rule,STIG-ID|SYMP-AG-000020,SWIFT-CSCv1|2.3,Vuln-ID|V-94219"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ";; Tab: \[SSL Access Layer \(1\)\]|;; Tab: \[Web Access Layer \(1\)\]"
  expect      : ";; Tab: \[SSL Access Layer \(1\)\]|;; Tab: \[Web Access Layer \(1\)\]"
</custom_item>

<custom_item>
  description : "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52. - client.connection.negotiated_ssl_version"
  info        : "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.
This requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.
NIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers"
  solution    : "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.
4. Right-click the \"Source\" field of the existing rule and select \"Set\". Click \"New\" and select \"Combined Source Object\".
5. Click \"New\" and select \"Client Negotiated Cipher\". Select all ciphers that should be permitted and click \"OK\".
6. Click the upper \"Add\" button and click the \"Negate\" checkbox.
7. Click \"New\" and select \"Client Negotiated SSL Version\". Select all SSL versions that should be permitted and click \"OK\".
8. Click the upper \"Add\" button.
9. Click \"OK\" and then \"OK\" again.
10. Repeat steps 4 to 9 for the \"Destination\" field, using the \"Server Negotiated Cipher\" and \"Server Negotiated SSL Version\" objects.
11. Right-click the \"Action\" field of the rule, click \"Set\", and select \"Deny\".
12. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : "client.connection.negotiated_ssl_version"
# Note: Variable @CLIENT_NEG_SSL_VER@ replaced with ".*TLSv1.2.*" in field "expect".
  expect      : "client.connection.negotiated_ssl_version=.*TLSv1.2.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52. - client.connection.negotiated_cipher"
  info        : "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.
This requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.
NIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers"
  solution    : "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.
4. Right-click the \"Source\" field of the existing rule and select \"Set\". Click \"New\" and select \"Combined Source Object\".
5. Click \"New\" and select \"Client Negotiated Cipher\". Select all ciphers that should be permitted and click \"OK\".
6. Click the upper \"Add\" button and click the \"Negate\" checkbox.
7. Click \"New\" and select \"Client Negotiated SSL Version\". Select all SSL versions that should be permitted and click \"OK\".
8. Click the upper \"Add\" button.
9. Click \"OK\" and then \"OK\" again.
10. Repeat steps 4 to 9 for the \"Destination\" field, using the \"Server Negotiated Cipher\" and \"Server Negotiated SSL Version\" objects.
11. Right-click the \"Action\" field of the rule, click \"Set\", and select \"Deny\".
12. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : "client.connection.negotiated_cipher"
# Note: Variable @CLIENT_NEG_CIPHER@ replaced with ".*AES128-GCM-SHA256,AES128-SHA.*" in field "expect".
  expect      : "client.connection.negotiated_cipher=.*AES128-GCM-SHA256,AES128-SHA.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52. - server.connection.negotiated_cipher"
  info        : "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.
This requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.
NIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers"
  solution    : "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.
4. Right-click the \"Source\" field of the existing rule and select \"Set\". Click \"New\" and select \"Combined Source Object\".
5. Click \"New\" and select \"Client Negotiated Cipher\". Select all ciphers that should be permitted and click \"OK\".
6. Click the upper \"Add\" button and click the \"Negate\" checkbox.
7. Click \"New\" and select \"Client Negotiated SSL Version\". Select all SSL versions that should be permitted and click \"OK\".
8. Click the upper \"Add\" button.
9. Click \"OK\" and then \"OK\" again.
10. Repeat steps 4 to 9 for the \"Destination\" field, using the \"Server Negotiated Cipher\" and \"Server Negotiated SSL Version\" objects.
11. Right-click the \"Action\" field of the rule, click \"Set\", and select \"Deny\".
12. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : "server.connection.negotiated_cipher"
# Note: Variable @SERVER_NEG_CIPHER@ replaced with ".*AES128-GCM-SHA256,AES128-SHA.*" in field "expect".
  expect      : "server.connection.negotiated_cipher=.*AES128-GCM-SHA256,AES128-SHA.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000030 - Symantec ProxySG providing forward proxy intermediary services for TLS must be configured to comply with the required TLS settings in NIST SP 800-52. - server.connection.negotiated_ssl_version"
  info        : "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.
This requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance.
NIST SP 800-52 sets TLS version 1.1 as a minimum version; therefore, all versions of SSL are not allowed (including for client negotiation) either on DoD-only or public-facing servers"
  solution    : "Configure TLS forward proxy intermediary services to comply with NIST SP 800-52 TLS settings.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.
4. Right-click the \"Source\" field of the existing rule and select \"Set\". Click \"New\" and select \"Combined Source Object\".
5. Click \"New\" and select \"Client Negotiated Cipher\". Select all ciphers that should be permitted and click \"OK\".
6. Click the upper \"Add\" button and click the \"Negate\" checkbox.
7. Click \"New\" and select \"Client Negotiated SSL Version\". Select all SSL versions that should be permitted and click \"OK\".
8. Click the upper \"Add\" button.
9. Click \"OK\" and then \"OK\" again.
10. Repeat steps 4 to 9 for the \"Destination\" field, using the \"Server Negotiated Cipher\" and \"Server Negotiated SSL Version\" objects.
11. Right-click the \"Action\" field of the rule, click \"Set\", and select \"Deny\".
12. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104175r1_rule,STIG-ID|SYMP-AG-000030,SWIFT-CSCv1|2.6,Vuln-ID|V-94221"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : "server.connection.negotiated_ssl_version"
# Note: Variable @SERVER_NEG_SSL_VER@ replaced with ".*TLSv1.2.*" in field "expect".
  expect      : "server.connection.negotiated_ssl_version=.*TLSv1.2.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000040 - Symantec ProxySG providing reverse proxy intermediary services for TLS must be configured to version 1.1 or higher with an approved cipher suite."
  info        : "SP 800-52 provides guidance on using the most secure version and configuration of the TLS/SSL protocol. Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.
This requirement applies to TLS gateways (also known as SSL gateways) and is not applicable to VPN devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance"
  solution    : "Verify that TLS reverse proxy intermediary services are configured to comply with NIST SP 800-52 TLS settings.
1. Verify with the ProxySG administrator that reverse proxy services are configured.
2. Log on to the Web Management Console.
3. Click Configuration >> Services >> Proxy Services.
4. For each reverse proxy service configured, click \"Edit Service\" and select only NIST-SP 800-52-approved SSL protocols. Click \"Apply\".
5. Log on to the ProxySG SSH CLI.
6. Type \"enable\" and enter the enable password.
7. Type \"configure\" and press \"Enter\".
8. Type \"proxy-services\" and press \"Enter\".
9. For each reverse proxy service identified by the administrator, type \"edit <reverse proxy service name\".
10. Type \"attribute\" followed by a list of the desired NIST SP 800-52-compliant cipher suites."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-104177r1_rule,STIG-ID|SYMP-AG-000040,Vuln-ID|V-94223"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "proxy-services ;mode"
  regex       : "attribute ssl-versions"
# Note: Variable @SSL_VERSIONS@ replaced with ".*TLSv1.2.*" in field "expect".
  expect      : "attribute ssl-versions .*TLSv1.2.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000050 - Symantec ProxySG storing secret or private keys must use FIPS-approved key management technology and processes in the production and control of private/secret cryptographic keys."
  info        : "Private key data is used to prove that the entity presenting a public key certificate is the certificate's rightful owner. Compromise of private key data allows an adversary to impersonate the key holder.
Private key data associated with software certificates, including those issued to an ALG, must be generated and protected in at least a FIPS 140-2 Level 1 validated cryptographic module
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to use FIPS-approved key management.
1. Log on to the Web Management Console.
2. Click Configuration >> SSL >> HSM.
3. Click the \"HSM\" and \"HSM Keyring\" tabs and configure these options per the guidance in the ProxySG Administration Guide, Chapter 9: Managing the SSL Proxy, Section G: Working with an HSM Appliance.
4. Click Configuration >> Proxy Settings >> SSL Proxy.
5. Select the HSM Keyring in the Issuer Keyring field and click \"Apply\"."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-104179r1_rule,STIG-ID|SYMP-AG-000050,Vuln-ID|V-94225"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "proxy-services ;mode"
  regex       : "hsm-keyring"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000060 - Symantec ProxySG must implement security policies that enforce approved authorizations for logical access to information and system resources by employing identity-based, role-based, and/or attribute-based security policies."
  info        : "Successful authentication must not automatically give an entity access to an asset or security boundary. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.
Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.
Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. ALGs must use these policies and mechanisms to control access on behalf of the application for which it is acting as intermediary
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Obtain the SSP with the site's security policy. Configure the ProxySG to enforce approved authorizations by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.
1. Log on to the web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\".
4. For each Web Access Layer that is configured, right-click the \"Source\" of each column and click \"Set\".
5. Select the users, groups, roles, and attributes as required by the site's security policy.
6. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000213,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104181r1_rule,STIG-ID|SYMP-AG-000060,SWIFT-CSCv1|2.3,Vuln-ID|V-94227"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000070 - Symantec ProxySG must restrict or block harmful or suspicious communications traffic by controlling the flow of information between interconnected networks based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic. - Web Access"
  info        : "Information flow control regulates where information is allowed to travel within a network and between interconnected networks. Blocking or restricting detected harmful or suspicious communications between interconnected networks enforces approved authorizations for controlling the flow of traffic.
This requirement applies to the flow of information between the ALG when used as a gateway or boundary device that allows traffic flow between interconnected networks of differing security policies.
The ALG is installed and configured to restrict or block information flows based on guidance in the PPSM regarding restrictions for boundary crossing for ports, protocols, and services. Information flow restrictions may be implemented based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.
The ALG must be configured with policy filters (e.g., security policy, rules, and/or signatures) that restrict or block information system services, provide a packet-filtering capability based on header information, and/or perform message-filtering based on message content. The policy filters used depend on the type of application gateway (e.g., web, email, or TLS)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure ProxySG to restrict access to suspicious or harmful web traffic. Destination security policy must be configured to filter based on destination, headers, geolocation, protocol characteristics, and other available security objects.
1. Log on to the web Management Console.
2. Click Configuration >> Content Filtering.
3. Under \"General,\" ensure that at least one \"Provider\" is enabled.
4. Click Configuration >> Visual Policy Manager.
5. Click \"Launch\". While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.
6. Within each layer above, right-click the \"Destination\" fields of each rule, click \"set\", and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-001414,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104183r1_rule,STIG-ID|SYMP-AG-000070,SWIFT-CSCv1|2.3,Vuln-ID|V-94229"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000070 - Symantec ProxySG must restrict or block harmful or suspicious communications traffic by controlling the flow of information between interconnected networks based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic. - SSL"
  info        : "Information flow control regulates where information is allowed to travel within a network and between interconnected networks. Blocking or restricting detected harmful or suspicious communications between interconnected networks enforces approved authorizations for controlling the flow of traffic.
This requirement applies to the flow of information between the ALG when used as a gateway or boundary device that allows traffic flow between interconnected networks of differing security policies.
The ALG is installed and configured to restrict or block information flows based on guidance in the PPSM regarding restrictions for boundary crossing for ports, protocols, and services. Information flow restrictions may be implemented based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic.
The ALG must be configured with policy filters (e.g., security policy, rules, and/or signatures) that restrict or block information system services, provide a packet-filtering capability based on header information, and/or perform message-filtering based on message content. The policy filters used depend on the type of application gateway (e.g., web, email, or TLS)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure ProxySG to restrict access to suspicious or harmful web traffic. Destination security policy must be configured to filter based on destination, headers, geolocation, protocol characteristics, and other available security objects.
1. Log on to the web Management Console.
2. Click Configuration >> Content Filtering.
3. Under \"General,\" ensure that at least one \"Provider\" is enabled.
4. Click Configuration >> Visual Policy Manager.
5. Click \"Launch\". While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.
6. Within each layer above, right-click the \"Destination\" fields of each rule, click \"set\", and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-001414,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104183r1_rule,STIG-ID|SYMP-AG-000070,SWIFT-CSCv1|2.3,Vuln-ID|V-94229"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000080 - Symantec ProxySG must enforce approved authorizations for controlling the flow of information within the network based on attribute- and content-based inspection of the source, destination, headers, and/or content of the communications traffic."
  info        : "Information flow control regulates where information is allowed to travel within a network. The flow of all network traffic must be monitored and controlled so it does not introduce any unacceptable risk to the network infrastructure or data.
Information flow control policies and enforcement mechanisms are commonly employed by organizations to control the flow of information between designated sources and destinations (e.g., networks, individuals, devices) within information systems. Examples of information flow control restrictions include keeping export-controlled information from being transmitted in the clear to the Internet or blocking information marked as classified that is being transported to an unapproved destination.
ALGs enforce approved authorizations by employing security policy and/or rules that restrict information system services or provide packet filtering capability based on header or protocol information and/or message filtering capability based on data content (e.g., implementing keyword searches or using document characteristics)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Obtain the SSP with the site's security policy. Configure the ProxySG to enforce approved authorizations by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.
1. Log on to the web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\".
4. For each Web Access Layer that is configured, right-click the \"Source\" of each column and click \"Set\".
5. Select objects based on traffic attributes, content, source, or headers as required by the site's security policy.
6. For each Web Access Layer that is configured, right-click the \"Destination\" of each column and click \"Set\".
7. Select objects based on traffic attributes, content, destination, or headers as required by the site's security policy.
8. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001368,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104185r1_rule,STIG-ID|SYMP-AG-000080,SWIFT-CSCv1|2.3,Vuln-ID|V-94231"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000090 - Symantec ProxySG must immediately use updates made to policy enforcement mechanisms such as policies and rules. - Web Access"
  info        : "Information flow policies regarding dynamic information flow control include, for example, allowing or disallowing information flows based on changes to the PPSM CAL, vulnerability assessments, or mission conditions. Changing conditions include changes in the threat environment and detection of potentially harmful or adverse events.
Changes to the ALG must take effect when made by an authorized administrator and the new configuration is put in place or committed, including upon restart of the application or reboot of the system. With some devices, the changes take effect as the configuration is changed, while with others, the new configuration must be submitted to the device. In any case, the behavior of the ALG must immediately be affected to reflect the configuration change.
In the ProxySG platform, a policy contains one or more layers that provide functionality, such as SSL interception, authentication, and web access. Each layer contains rules that define source and destination criteria and an action to take for each set of criteria
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure ProxySG to restrict access to suspicious or harmful communications.
1. Log on to the Web Management Console.
2. Click Configuration >> Content Filtering.
3. Under \"General,\" verify that at least one \"Provider\" is enabled.
4. Click Configuration >> Visual Policy Manager.
5. Click \"Launch\". While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.
6. Within each layer above, right-click the \"Destination\" fields of each rule, click \"set\", and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001414,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104187r1_rule,STIG-ID|SYMP-AG-000090,SWIFT-CSCv1|2.3,Vuln-ID|V-94233"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000090 - Symantec ProxySG must immediately use updates made to policy enforcement mechanisms such as policies and rules. - SSL"
  info        : "Information flow policies regarding dynamic information flow control include, for example, allowing or disallowing information flows based on changes to the PPSM CAL, vulnerability assessments, or mission conditions. Changing conditions include changes in the threat environment and detection of potentially harmful or adverse events.
Changes to the ALG must take effect when made by an authorized administrator and the new configuration is put in place or committed, including upon restart of the application or reboot of the system. With some devices, the changes take effect as the configuration is changed, while with others, the new configuration must be submitted to the device. In any case, the behavior of the ALG must immediately be affected to reflect the configuration change.
In the ProxySG platform, a policy contains one or more layers that provide functionality, such as SSL interception, authentication, and web access. Each layer contains rules that define source and destination criteria and an action to take for each set of criteria
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure ProxySG to restrict access to suspicious or harmful communications.
1. Log on to the Web Management Console.
2. Click Configuration >> Content Filtering.
3. Under \"General,\" verify that at least one \"Provider\" is enabled.
4. Click Configuration >> Visual Policy Manager.
5. Click \"Launch\". While in the Visual Policy Manager, click into each Web Access and SSL Access Layer.
6. Within each layer above, right-click the \"Destination\" fields of each rule, click \"set\", and specify URL categories and/or threat risk levels that should be blocked per the organization's security policy.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001414,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104187r1_rule,STIG-ID|SYMP-AG-000090,SWIFT-CSCv1|2.3,Vuln-ID|V-94233"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000100 - Symantec ProxySG providing user access control intermediary services must display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to the network."
  info        : "Display of a standardized and approved use notification before granting access to the network ensures that privacy and security notification verbiage used is consistent with applicable Federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.
System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. This requirement applies to network elements that have the concept of a user account and have the logon function residing on the network element.
The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for network elements that can accommodate banners of 1300 characters:
\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"

Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:
\"I've read & consent to terms in IS user agreem't.\"
This policy only applies to ALGs (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the Standard Mandatory DoD Banner to be displayed.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, select each Web Access Layer that is configured and perform the following:
    i. Click \"edit\" and select \"add rule\".
    ii. Right-click the \"Actions\" field of the new rule and select \"set\". Click \"New\" and select \"NotifyUser\" from the list and click \"OK\".
    iii. Input the correct banner text in the \"Body\" field and click \"OK\".
    iv. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000048,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104189r1_rule,STIG-ID|SYMP-AG-000100,SWIFT-CSCv1|2.3,Vuln-ID|V-94235"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000110 - Symantec ProxySG providing user access control intermediary services for publicly accessible applications must display the Standard Mandatory DoD-approved Notice and Consent Banner before granting access to the system."
  info        : "Display of a standardized and approved use notification before granting access to the publicly accessible network element ensures privacy and security notification verbiage used is consistent with applicable Federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.
System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. This requirement applies to network elements that have the concept of a user account and have the logon function residing on the network element.
The banner must be formatted in accordance with DoD requirements. Use the following verbiage for network elements that can accommodate banners of 1300 characters:
\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"
Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:
\"I've read & consent to terms in IS user agreem't.\"
This policy only applies to gateways (e.g., identity management or authentication gateways) that provide user account services as part of the intermediary services off-loaded from the application. Publicly accessible systems are used in DoD to provide benefit information, pay information, or public services. These gateways may also provide self-registration and authorization services
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the Standard Mandatory DoD Banner to be displayed.
The banner must be formatted in accordance with DoD requirements. Use the following verbiage for network elements that can accommodate banners of 1300 characters:
\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"
Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:
\"I've read & consent to terms in IS user agreem't.\"
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, select each Web Access Layer that is configured and perform the following:
    i. Click \"edit\" and select \"add rule\".
    ii. Right-click the \"Actions\" field of the new rule and select \"set\". Click \"New\" and select \"NotifyUser\" from the list and click \"OK\".
    iii. Input the correct banner text in the \"Body\" field and click \"OK\".
    iv. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001384,CCI|CCI-001385,CCI|CCI-001386,CCI|CCI-001387,CCI|CCI-001388,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104191r1_rule,STIG-ID|SYMP-AG-000110,SWIFT-CSCv1|2.3,Vuln-ID|V-94237"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000120 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful logon attempts occur. - enabled"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
Audit records can be generated from various components within the information system (e.g., module or policy filter)"
  solution    : "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access and Web Authentication Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New\" and select \"Event Log\"."
  reference   : "800-53|AU-14,CAT|II,CCI|CCI-000172,CSF|PR.PT-1,ITSG-33|AU-14,Rule-ID|SV-104193r1_rule,STIG-ID|SYMP-AG-000120,SWIFT-CSCv1|6.4,Vuln-ID|V-94239"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "access-log  ;mode"
  regex       : "^enable$"
  expect      : "^enable$"
</custom_item>

<custom_item>
  description : "SYMP-AG-000120 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful logon attempts occur. - policy rules"
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
Audit records can be generated from various components within the information system (e.g., module or policy filter)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access and Web Authentication Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000172,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104193r1_rule,STIG-ID|SYMP-AG-000120,SWIFT-CSCv1|2.3,Vuln-ID|V-94239"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000130 - Symantec ProxySG providing user access control intermediary services must generate audit records showing starting and ending time for user access to the system."
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
Audit records can be generated from various components within the information system (e.g., module or policy filter).
This requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access and Web Authentication Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000172,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104195r1_rule,STIG-ID|SYMP-AG-000130,SWIFT-CSCv1|2.3,Vuln-ID|V-94241"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000140 - Symantec ProxySG providing user access control intermediary services must generate audit records when successful/unsuccessful attempts to access web resources occur."
  info        : "Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
Audit records can be generated from various components within the information system (e.g., module or policy filter). Security objects are data objects that are controlled by security policy and bound to security attributes.
This requirement applies to the ALG traffic management functions such as content filtering or intermediary services. This does not apply to audit logs generated on behalf of the device (device management)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to generate alerts for successful/unsuccessful logon attempts.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access and Web Authentication Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000172,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104197r1_rule,STIG-ID|SYMP-AG-000140,SWIFT-CSCv1|2.3,Vuln-ID|V-94243"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000150 - Symantec ProxySG must produce audit records containing information to establish what type of events occurred."
  info        : "Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.
Audit record content that may be necessary to satisfy this requirement includes, for example, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.
Associating event types with detected events in the gateway logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes the event type.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging. Check \"Enable Access Logging\" and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the HTTP protocol (\"main\" by default).
4. Click \"Formats,\" select the Default Log from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the following variables:
  cs-method
  cs-protocol
  cs-uri-scheme
  cs-uri-path
  cs-uri-query
  sc-status
  s-action
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104199r1_rule,STIG-ID|SYMP-AG-000150,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94245"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*cs-method)(?=.*cs-protocol)(?=.*cs-uri-scheme)(?=.*cs-uri-path)(?=.*cs-uri-query)(?=.*sc-status)(?=.*s-action)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000160 - Symantec ProxySG must produce audit records containing information to establish when (date and time) the events occurred."
  info        : "Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.
In order to compile an accurate risk assessment and provide forensic analysis of network traffic patterns, it is essential for security personnel to know when flow control events occurred within the infrastructure.
Associating event types with detected events in the network audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes the date/time of the event.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging. Check \"Enable Access Logging\" and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the HTTP protocol (\"main\" by default).
4. Click \"Formats,\" select the Default Log from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the \"date\" and \"time\" variables.
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000131,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104201r1_rule,STIG-ID|SYMP-AG-000160,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94247"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*time)(?=.*date)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000170 - Symantec ProxySG must produce audit records containing information to establish where the events occurred."
  info        : "Without establishing where events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.
In order to compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as network element components, modules, device identifiers, node names, and functionality.
Associating information about where the event occurred within the network provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes where the event occurred.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\", click \"Access Logging\", check \"Enable Access Logging\", and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the HTTP protocol (\"main\" by default).
4. Click \"Formats\", select the \"Default Log\" from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the following variables:
  c-ip
  r-ip
  s-ip
  s-supplier-country
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000132,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104203r1_rule,STIG-ID|SYMP-AG-000170,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94249"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*c-ip)(?=.*r-ip)(?=.*s-ip)(?=.*s-supplier-country)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000180 - Symantec ProxySG must produce audit records containing information to establish the source of the events."
  info        : "Without establishing the source of the event, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack. In order to compile an accurate risk assessment and provide forensic analysis, security personnel need to know the source of the event.
In addition to logging where events occur within the network, the audit records must also identify sources of events such as IP addresses, processes, and node or device names.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes the source of the event.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check \"Enable Access Logging\" and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the HTTP protocol (\"main\" by default).
4. Click \"Formats,\" select the Default Log from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the \"c-ip\" variable.
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104205r1_rule,STIG-ID|SYMP-AG-000180,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94251"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*c-ip)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000190 - Symantec ProxySG must produce audit records containing information to establish the outcome of the events."
  info        : "Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the network.
Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the network after the event occurred). They also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes information about the outcome of the event.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check \"Enable Access Logging\" and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the HTTP protocol (\"main\" by default).
4. Click \"Formats\", select the Default Log from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the following variables:
  s-action
  rs-response-line
  rs-status
  sc-status
  x-exception-reason
 duration
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000134,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104207r1_rule,STIG-ID|SYMP-AG-000190,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94253"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*s-action)(?=.*rs-response-line)(?=.*rs-status)(?=.*sc-status)(?=.*x-exception-reason)(?=.*duration)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000200 - Symantec ProxySG must generate audit records containing information to establish the identity of any individual or process associated with the event."
  info        : "Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.
Associating information about where the event occurred within the network provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured network element.
This requirement does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to log user web traffic for auditing that includes information to establish the identity of any individual or process associated with the event.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging. Check \"Enable Access Logging\" and click \"Apply\".
3. Browse to \"Access Logging\", click \"General\", and note which Default Log is indicated for the \"HTTP\" protocol (\"main\" by default).
4. Click \"Formats,\" select the Default Log from step 3, and click \"Edit/View\".
5. Edit the log format string to include at least the \"c-ip\" and \"cs-username\" variables.
6. Click OK >> Apply."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001487,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-104209r1_rule,STIG-ID|SYMP-AG-000200,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-94255"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit format main ;mode"
  regex       : "type elff"
  expect      : ".*(?=.*c-ip)(?=.*cs-username)"
</custom_item>

<custom_item>
  description : "SYMP-AG-000210 - Symantec ProxySG must use a centralized log server."
  info        : "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.
Off-loading is a common process in information systems with limited audit storage capacity.
This does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure audit log off-loading.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Access Logging >> Logs.
3. Configure the \"Upload Client\" and \"Upload Schedule\" capabilities. (All client types use TCP for communication to the site's event server.)"
  reference   : "800-171|3.3.1,800-53|AU-3(2),CAT|II,CCI|CCI-001851,CSF|PR.PT-1,ITSG-33|AU-3(2),Rule-ID|SV-104211r1_rule,STIG-ID|SYMP-AG-000210,SWIFT-CSCv1|6.4,Vuln-ID|V-94257"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit log main ;mode"
  regex       : "client-type"
  expect      : "client-type"
</custom_item>

<custom_item>
  description : "SYMP-AG-000220 - Symantec ProxySG must be configured to send the access logs to the centralized log server continuously."
  info        : "Off-loading ensures audit information does not get overwritten if the limited audit storage capacity is reached and also protects the audit record in case the system/component being audited is compromised.
Off-loading is a common process in information systems with limited audit storage capacity. The audit storage on the ALG is used only in a transitory fashion until the system can communicate with the centralized log server designated for storing the audit records, at which point the information is transferred. However, DoD requires that the log be transferred in real time, which indicates that the time from event detection to off-loading is seconds or less.
This does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure continuous audit log off-loading.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Access Logging >> Logs.
3. Click \"Upload Schedule\" and select \"Upload the access log continuously\" option.
4. Click \"Apply\"."
  reference   : "800-171|3.3.1,800-53|AU-3(2),CAT|II,CCI|CCI-001851,CSF|PR.PT-1,ITSG-33|AU-3(2),Rule-ID|SV-104213r1_rule,STIG-ID|SYMP-AG-000220,SWIFT-CSCv1|6.4,Vuln-ID|V-94259"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit log main ;mode"
  regex       : "continuous-upload"
  expect      : "continuous-upload enable"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      description : "SNMP v1 disabled"
      context     : "snmp ;mode"
      regex       : "protocol snmpv1 disable"
      expect      : "protocol snmpv1 disable"
    </custom_item>

    <custom_item>
      description : "SNMP v2c disabled"
      context     : "snmp ;mode"
      regex       : "protocol snmpv2c disable"
      expect      : "protocol snmpv2c disable"
    </custom_item>

    <custom_item>
      description : "SNMP v3 disabled"
      context     : "snmp ;mode"
      regex       : "protocol snmpv3 disable"
      expect      : "protocol snmpv3 disable"
    </custom_item>
  </condition>

  <then>
    <report type:"FAILED">
      description : "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server. - Enabled"
      info        : "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).
This does not apply to audit logs generated on behalf of the device itself (management)"
      solution    : "Configure the ProxySG to send real-time alerts via SMTP and SNMP.
1. Log on to the Web Management Console.
2. Browse to Maintenance >> SNMP.
3. Check the \"Enable SNMPv3\" box.
4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.
5. Browse to \"Event Logging\".
6. Click \"Mail\" and check the \"Send Event Logs\" box.
7. Click \"New\" and add all desired recipients to the \"Names\" list.
8. Enter the correct SMTP server and port into the proper fields.
9. Click \"Apply\".
For more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance."
      reference   : "CAT|II,CCI|CCI-001858,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,Vuln-ID|V-94261"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server. - Enabled"
      info        : "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).
This does not apply to audit logs generated on behalf of the device itself (management)"
      solution    : "Configure the ProxySG to send real-time alerts via SMTP and SNMP.
1. Log on to the Web Management Console.
2. Browse to Maintenance >> SNMP.
3. Check the \"Enable SNMPv3\" box.
4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.
5. Browse to \"Event Logging\".
6. Click \"Mail\" and check the \"Send Event Logs\" box.
7. Click \"New\" and add all desired recipients to the \"Names\" list.
8. Enter the correct SMTP server and port into the proper fields.
9. Click \"Apply\".
For more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance."
      reference   : "CAT|II,CCI|CCI-001858,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,Vuln-ID|V-94261"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  description : "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server. - Server"
  info        : "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).
This does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to send real-time alerts via SMTP and SNMP.
1. Log on to the Web Management Console.
2. Browse to Maintenance >> SNMP.
3. Check the \"Enable SNMPv3\" box.
4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.
5. Browse to \"Event Logging\".
6. Click \"Mail\" and check the \"Send Event Logs\" box.
7. Click \"New\" and add all desired recipients to the \"Names\" list.
8. Enter the correct SMTP server and port into the proper fields.
9. Click \"Apply\".
For more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001858,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,SWIFT-CSCv1|2.3,Vuln-ID|V-94261"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "smtp ;mode"
  regex       : "server"
  expect      : "server.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000230 - Symantec ProxySG must provide an alert to, at a minimum, the SCA and ISSO of all audit failure events where the detection and/or prevention function is unable to write events to either local storage or the centralized server. - From"
  info        : "Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.
Alerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).
This does not apply to audit logs generated on behalf of the device itself (management)"
  solution    : "Configure the ProxySG to send real-time alerts via SMTP and SNMP.
1. Log on to the Web Management Console.
2. Browse to Maintenance >> SNMP.
3. Check the \"Enable SNMPv3\" box.
4. Click the SNMPv3 Users and SNMPv3 Traps tabs and configure per organizational specifications.
5. Browse to \"Event Logging\".
6. Click \"Mail\" and check the \"Send Event Logs\" box.
7. Click \"New\" and add all desired recipients to the \"Names\" list.
8. Enter the correct SMTP server and port into the proper fields.
9. Click \"Apply\".
For more information, see the ProxySG Administration Guide, Chapter 75: Monitoring the Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001858,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104215r1_rule,STIG-ID|SYMP-AG-000230,SWIFT-CSCv1|2.3,Vuln-ID|V-94261"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "smtp ;mode"
  regex       : "from"
  expect      : "from.*"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000240 - The reverse proxy Symantec ProxySG providing intermediary services for FTP must inspect inbound FTP communications traffic for protocol compliance and protocol anomalies. - Review Proxies"
  info        : "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Because protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure FTP reverse proxy intermediary services.
See the ProxySG Reverse Proxy WebGuide for details.
1. Log on to the Web Management Console.
2. Click Configuration >> Services >> Proxy Services.
3. Click \"New Service\" and create new FTP proxy services with the Action set to \"intercept\".
4. Browse to Configuration >> Forwarding Hosts. Click \"New\" and create an entry for the desired back-end FTP server. Click \"Apply\".
5. Browse to Policy >> Visual Policy Manager and click \"Launch\".
6. Click Policy >> Add Forwarding Layer. In the default rule, set the Action to be the Forwarding Host configured in step 4.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104217r1_rule,STIG-ID|SYMP-AG-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94263"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000240 - The reverse proxy Symantec ProxySG providing intermediary services for FTP must inspect inbound FTP communications traffic for protocol compliance and protocol anomalies. - Policy Rules"
  info        : "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Because protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure FTP reverse proxy intermediary services.
See the ProxySG Reverse Proxy WebGuide for details.
1. Log on to the Web Management Console.
2. Click Configuration >> Services >> Proxy Services.
3. Click \"New Service\" and create new FTP proxy services with the Action set to \"intercept\".
4. Browse to Configuration >> Forwarding Hosts. Click \"New\" and create an entry for the desired back-end FTP server. Click \"Apply\".
5. Browse to Policy >> Visual Policy Manager and click \"Launch\".
6. Click Policy >> Add Forwarding Layer. In the default rule, set the Action to be the Forwarding Host configured in step 4.
7. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104217r1_rule,STIG-ID|SYMP-AG-000240,SWIFT-CSCv1|2.3,Vuln-ID|V-94263"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000250 - Symantec ProxySG providing intermediary services for FTP must inspect outbound FTP communications traffic for protocol compliance and protocol anomalies."
  info        : "Application protocol anomaly detection examines application layer protocols such as FTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an FTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound FTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks"
  solution    : "Enable outbound FTP proxying to inspect this traffic for compliance and anomalies.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Click the \"Standard\", \"Predefined Service Group\" and set FTP service to \"Intercept\".
4. Click \"Apply\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104219r1_rule,STIG-ID|SYMP-AG-000250,TBA-FIISB|43.1,Vuln-ID|V-94265"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"FTP\" ;mode"
  regex       : "intercept"
  expect      : "intercept.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies. - Explicit"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.
All inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,TBA-FIISB|43.1,Vuln-ID|V-94267"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"Explicit HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies. - External"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.
All inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,TBA-FIISB|43.1,Vuln-ID|V-94267"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"External HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000260 - Symantec ProxySG providing intermediary services for HTTP must inspect inbound HTTP traffic for protocol compliance and protocol anomalies. - Internal"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks.
All inbound and outbound traffic, including HTTPS, must be inspected. However, the intention of this policy is not to mandate HTTPS inspection by the ALG. Typically, HTTPS traffic is inspected either at the source or destination and/or is directed for inspection by an organization-defined network termination point
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services, select each HTTP proxy service to be reviewed, and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104221r1_rule,STIG-ID|SYMP-AG-000260,SWIFT-CSCv1|2.3,Vuln-ID|V-94267"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"Internal HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies. - Explicit"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,TBA-FIISB|43.1,Vuln-ID|V-94269"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"Explicit HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies. - Internal"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,SWIFT-CSCv1|2.3,Vuln-ID|V-94269"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"Internal HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000270 - Symantec ProxySG  providing intermediary services for HTTP must inspect outbound HTTP traffic for protocol compliance and protocol anomalies. - External"
  info        : "Application protocol anomaly detection examines application layer protocols such as HTTP to identify attacks based on observed deviations in the normal RFC behavior of a protocol or service. This type of monitoring allows for the detection of known and unknown exploits that exploit weaknesses of commonly used protocols.
Since protocol anomaly analysis examines the application payload for patterns or anomalies, an HTTP proxy must be included in the ALG. This ALG will be configured to inspect inbound and outbound HTTP communications traffic to detect protocol anomalies such as malformed message and command insertion attacks
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform inbound and outbound HTTP traffic protocol compliance inspection/enforcement.
Fix 1 (This is an uncommon configuration. If it is found, it has been very deliberately done by the Proxy administrator and cannot/should not be removed without consultation with/advice from the administrator.)
1. Browse to Configuration >> Policy >> Policy Files and click the button to view the installed policy.
2. Using \"<Ctrl>-F\", perform a search for the exact terms \"detect_protocol(no)\".
3. If this phrase appears in the policy, work with the ProxySG administrator to determine why this was configured, whether it can be disabled and if so, how to disable it.
Fix 2
1. Browse to Configuration >> Services >> Proxy Services and select each HTTP proxy service to be reviewed and click \"Edit Service\".
2. Select the \"Detect Protocol\" checkbox and click \"OK\".
3. Once all services have been modified, click \"Apply\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-000366,CCI|CCI-001125,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104223r1_rule,STIG-ID|SYMP-AG-000270,TBA-FIISB|43.1,Vuln-ID|V-94269"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit \"External HTTP\" ;mode"
  regex       : "attribute detect-protocol enable"
  expect      : "attribute detect-protocol enable"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "SYMP-AG-000280 - Symantec ProxySG must not have unnecessary services and functions enabled."
  info        : "Information systems are capable of providing a wide variety of functions (capabilities or processes) and services. Some of these functions and services are installed and enabled by default. The organization must determine which functions and services are required to perform the content filtering and other necessary core functionality for each component of the ALG. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.
The primary function of an ALG is to provide application-specific content filtering and/or proxy services. The ALG application suite may integrate related content filtering and analysis services and tools (e.g., IPS, proxy, malware inspection, blacklists, whitelists). Some gateways may also include email scanning, decryption, caching, and DLP services. However, services and capabilities that are unrelated to this primary functionality must not be installed (e.g., DNS, email client or server, FTP server, or web server).
Next Generation ALGs (NGFW) and Unified Threat Management (UTM) ALGs integrate functions that have been traditionally separated. These products integrate content filtering features to provide more granular policy filtering. There may be operational drawbacks to combining these services into one device. Another issue is that NGFW and UTM products vary greatly with no current definitive industry standard
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Disable/remove unnecessary proxy services on the ProxySG. In particular, reverse proxy services should not configured if not used.
1. Log on to the Web Management Console
2. Browse to Configuration >> Services >> Proxy Services
3. Review each service and service group specified in the list with the ProxySG administrator.
4. Remove any unnecessary services or service groups by selecting them and clicking \"Delete\"
5. Click \"Apply\" once all unnecessary services or groups have been removed."
  reference   : "CAT|II,CCI|CCI-000381,Rule-ID|SV-104225r1_rule,STIG-ID|SYMP-AG-000280,Vuln-ID|V-94271"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-AG-000290 - Symantec ProxySG must be configured to remove or disable unrelated or unneeded application proxy services."
  info        : "Unrelated or unneeded proxy services increase the attack vector and add excessive complexity to the securing of the ALG. Multiple application proxies can be installed on many ALGs. However, proxy types must be limited to related functions. At a minimum, the web and email gateway represent different security domains/trust levels. Organizations should also consider separation of gateways that service the DMZ and the trusted network.
Possible services that may be configured on the ProxySG:
AOL IM
DNS Proxy
FTP
FTPS
HTTPS
HTTPS Reverse Proxy
MMS
MSN IM
RMTP
RTSP
SOCKS
TLS
TCP Tunnel
TELNET
Yahoo IMfalse
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Disable/remove unnecessary proxy services on the ProxySG. In particular, reverse proxy services should not configured if not used.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Review each service and service group specified in the list with the ProxySG administrator.
4. Remove any unnecessary services or service groups by selecting them and clicking \"delete\".
5. Click \"Apply\" once all unnecessary services or groups have been removed."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CCI|CCI-000381,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-104227r1_rule,STIG-ID|SYMP-AG-000290,Vuln-ID|V-94273"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "proxy-services ;mode"
  regex       : "edit.*mode"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000300 - Symantec ProxySG must be configured to prohibit or restrict the use of network services as defined in the PPSM CAL and vulnerability assessments."
  info        : "To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.
ALGs are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. DoD continually assesses the ports, protocols, and services that can be used for network communications. Some ports, protocols, and services have known exploits or security weaknesses. Network traffic using these ports, protocols, and services must be prohibited or restricted in accordance with DoD policy. The ALG is a key network element for preventing these noncompliant ports, protocols, and services from causing harm to DoD information systems.
The network ALG must be configured to prevent or restrict the use of prohibited ports, protocols, and services throughout the network by filtering the network traffic and disallowing or redirecting traffic as necessary. Default and updated policy filters from the vendors will disallow older versions of protocols and applications and will address most known nonsecure ports, protocols, and/or services. However, sources for further policy filters are the IAVMs and the PPSM requirements
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Obtain the SSP and PPSMCAL and vulnerability assessments with the site's security policy. Configure the ProxySG to perform resources by employing identity-based, role-based, and/or attribute-based authorization for access to proxied websites.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\".
4. For each Web Access Layer that is configured, right-click the \"Source\" and \"destination\" of each column and click \"Set\".
5. Select the users, groups, roles, ports, protocols, and attributes as required by the PPSMCAL.
6. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000382,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104229r1_rule,STIG-ID|SYMP-AG-000300,SWIFT-CSCv1|2.3,Vuln-ID|V-94275"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<if>
  <condition type:"OR">
    <custom_item>
      description : "Radius In Use"
      regex       : "security radius edit-realm .* ;mode"
      expect      : "security radius edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - RADIUS"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security radius edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. -RADIUS"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "CAT|II,CCI|CCI-002038,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "LDAP In Use"
      regex       : "security ldap edit-realm .* ;mode"
      expect      : "security ldap edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - LDAP"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security ldap edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - LDAP"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "XML In Use"
      regex       : "security xml edit-realm .* ;mode"
      expect      : "security xml edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - xml"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security xml edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - xml"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "IWA In Use"
      regex       : "security iwa-bcaaa edit-realm .* ;mode"
      expect      : "security iwa-bcaaa edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - iwa"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security iwa-bcaaa edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - iwa"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "siteminder In Use"
      regex       : "security siteminder edit-realm .* ;mode"
      expect      : "security siteminder edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - siteminder"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security siteminder edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - siteminder"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "coreid In Use"
      regex       : "security coreid edit-realm .* ;mode"
      expect      : "security coreid edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - coreid"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security coreid edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000310 - Symantec ProxySG providing user authentication intermediary services must require users to reauthenticate every 900 seconds when organization-defined circumstances or situations require reauthentication. - coreid"
      info        : "Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances:
1. When authenticators change
2. When roles change
3. When security categories of information systems change
4. When the execution of privileged functions occurs
5. After a fixed period of time
6. Periodically
Within the DoD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.
This requirement only applies to components where this is specific to the function of the device or has the concept of user authentication (e.g., VPN or ALG capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management)"
      solution    : "Reauthentication of users may be enforced by using credential cache lifetimes and inactivity timeouts. Set credential cache lifetimes and inactivity timeouts for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to the organization-defined time period.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002038,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104231r1_rule,STIG-ID|SYMP-AG-000310,Vuln-ID|V-94277"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  description : "SYMP-AG-000320 - Symantec ProxySG must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users). - Domain Exists"
  info        : "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.
Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.
By default, the ProxySG operates as an un-authenticated proxy. Authentication of users must be explicitly configured as described here and in in the ProxySG Administration Guide, Chapter 49: Controlling Access to the Internet and Intranet"
  solution    : "Configure the ProxySG to perform unique identification of organizational users.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104233r1_rule,STIG-ID|SYMP-AG-000320,SWIFT-CSCv1|2.3,Vuln-ID|V-94279"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : "create"
  expect      : "create.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000320 - Symantec ProxySG must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users). - Domain Joined"
  info        : "To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.
Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.
By default, the ProxySG operates as an un-authenticated proxy. Authentication of users must be explicitly configured as described here and in in the ProxySG Administration Guide, Chapter 49: Controlling Access to the Internet and Intranet
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to perform unique identification of organizational users.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104233r1_rule,STIG-ID|SYMP-AG-000320,SWIFT-CSCv1|2.3,Vuln-ID|V-94279"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000330 - Symantec ProxySG must be configured with a pre-established trust relationship and mechanisms with appropriate authorities that validate user account access authorizations and privileges. - Domain Exists"
  info        : "User account and privilege validation must be centralized to prevent unauthorized access using changed or revoked privileges.
ALGs can implement functions such as traffic filtering, authentication, access, and authorization functions based on computer and user privileges. However, the directory service (e.g., Active Directory or LDAP) must not be installed on the ALG, particularly if the gateway resides on the untrusted zone of the enclave"
  solution    : "Configure the ProxySG with pre-established trust relationships with the appropriate authorities.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104235r1_rule,STIG-ID|SYMP-AG-000330,SWIFT-CSCv1|2.3,Vuln-ID|V-94281"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : "create"
  expect      : "create.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000330 - Symantec ProxySG must be configured with a pre-established trust relationship and mechanisms with appropriate authorities that validate user account access authorizations and privileges. - Domain joined"
  info        : "User account and privilege validation must be centralized to prevent unauthorized access using changed or revoked privileges.
ALGs can implement functions such as traffic filtering, authentication, access, and authorization functions based on computer and user privileges. However, the directory service (e.g., Active Directory or LDAP) must not be installed on the ALG, particularly if the gateway resides on the untrusted zone of the enclave
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG with pre-established trust relationships with the appropriate authorities.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104235r1_rule,STIG-ID|SYMP-AG-000330,SWIFT-CSCv1|2.3,Vuln-ID|V-94281"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000340 - Symantec ProxySG providing user authentication intermediary services must restrict user authentication traffic to specific authentication servers. - Domain exists"
  info        : "User authentication can be used as part of the policy filtering rule sets. Some URLs or network resources can be restricted to authenticated users only. Users are prompted by the application or browser for credentials. Authentication service may be provided by the ProxySG as an intermediary for the application; however, the authentication credential must be stored in the site's directory services server.
This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., proxy capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).
The ProxySG will not use any other authentication server that has not been explicitly configured, such as the primary and backup authentication servers"
  solution    : "Configure the ProxySG for user authentication.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104237r1_rule,STIG-ID|SYMP-AG-000340,SWIFT-CSCv1|2.3,Vuln-ID|V-94283"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : "create"
  expect      : "create.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000340 - Symantec ProxySG providing user authentication intermediary services must restrict user authentication traffic to specific authentication servers. - Domain joined"
  info        : "User authentication can be used as part of the policy filtering rule sets. Some URLs or network resources can be restricted to authenticated users only. Users are prompted by the application or browser for credentials. Authentication service may be provided by the ProxySG as an intermediary for the application; however, the authentication credential must be stored in the site's directory services server.
This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., proxy capability). This does not apply to authentication for the purpose of configuring the device itself (i.e., device management).
The ProxySG will not use any other authentication server that has not been explicitly configured, such as the primary and backup authentication servers
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG for user authentication.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000764,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104237r1_rule,STIG-ID|SYMP-AG-000340,SWIFT-CSCv1|2.3,Vuln-ID|V-94283"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security windows-domains ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "SYMP-AG-000350 - Symantec ProxySG providing user authentication intermediary services must implement multifactor authentication for remote access to nonprivileged accounts such that one of the factors is provided by a device separate from the system gaining access."
  info        : "For remote access to nonprivileged accounts, the purpose of requiring a device that is separate from the information system gaining access for one of the factors during multifactor authentication is to reduce the likelihood of compromising authentication credentials stored on the system.
Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD common access card.
A privileged account is defined as an information system account with authorizations of a privileged user.
Remote access is access to DoD-nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
An example of compliance with this requirement is the use of a one-time password token and PIN coupled with a password or the use of a CAC/PIV card and PIN coupled with a password
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure an approved method of multifactor authentication (such as CAC certificate authentication).
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Configure at least one multifactor method (such as CAC certificate authentication) per the ProxySG Administration Guide (CAC Certificate authentication configuration is covered in Chapter 52: Certificate Realm Authentication and Chapter 58: LDAP Realm Authentication)."
  reference   : "CAT|II,CCI|CCI-001951,Rule-ID|SV-104239r1_rule,STIG-ID|SYMP-AG-000350,Vuln-ID|V-94285"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "SYMP-AG-000360 - Symantec ProxySG providing user authentication intermediary services must implement multifactor authentication for remote access to privileged accounts such that one of the factors is provided by a device separate from the system gaining access."
  info        : "For remote access to privileged accounts, the purpose of requiring a device that is separate from the information system gaining access for one of the factors during multifactor authentication is to reduce the likelihood of compromising authentication credentials stored on the system.
Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD common access card.
A privileged account is defined as an information system account with authorizations of a privileged user.
Remote access is access to DoD-nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure an approved method of multifactor authentication (such as CAC certificate authentication).
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Configure at least one multifactor method (such as CAC certificate authentication) per the ProxySG Administration Guide (CAC Certificate authentication configuration is covered in Chapter 52: Certificate Realm Authentication and Chapter 58: LDAP Realm Authentication)."
  reference   : "CAT|II,CCI|CCI-001948,Rule-ID|SV-104241r1_rule,STIG-ID|SYMP-AG-000360,Vuln-ID|V-94287"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<report type:"WARNING">
  description : "SYMP-AG-000370 - Symantec ProxySG providing user authentication intermediary services must use multifactor authentication for network access to nonprivileged accounts."
  info        : "To assure accountability and prevent unauthenticated access, nonprivileged users must use multifactor authentication to prevent potential misuse and compromise of the system.
Multifactor authentication uses two or more factors to achieve authentication. Factors include:
1. Something you know (e.g., password/PIN)
2. Something you have (e.g., cryptographic, identification device, token)
3. Something you are (e.g., biometric)
Nonprivileged accounts are not authorized access to the network element regardless of access method.
Network access is any access to an application by a user (or process acting on behalf of a user) where the access is obtained through a network connection.
Authenticating with a PKI credential and entering the associated PIN is an example of multifactor authentication
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure a DoD-approved authentication server that uses multifactor authentication.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication >> Windows Domain.
3. Click \"Add New Domain\" and follow prompts to join the Windows Domain."
  reference   : "CAT|II,CCI|CCI-000766,Rule-ID|SV-104243r1_rule,STIG-ID|SYMP-AG-000370,Vuln-ID|V-94289"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  cmd         : "show management-services"
  description : "SYMP-AG-000380 - Symantec ProxySG providing user authentication intermediary services must implement replay-resistant authentication mechanisms for network access to nonprivileged accounts."
  info        : "A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.
An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.
A nonprivileged account is any account with the authorizations of a nonprivileged user. Privileged roles are organization-defined roles assigned to individuals that allow those individuals to perform certain security-relevant functions that ordinary users are not authorized to perform. Security-relevant roles include key management, account management, network and system administration, database administration, and web administration.
Techniques used to address this include protocols using nonces (e.g., numbers generated for a specific one time use) or challenges (e.g., TLS). Additional techniques include time-synchronous or challenge-response one-time authenticators"
  solution    : "Configure the ProxySG to use only FIPS-compliant HMAC algorithms.
1. Log on to the ProxySG SSH CLI.
2. Type \"enable\" and enter the enable password.
3. Type \"configure terminal\" and press \"Enter\".
4. Type \"management-services,\" press \"Enter\". Type \"edit HTTPS-Console\" and press \"Enter\".
5. Type \"view\" to display the list of configured cipher suites.
6. Type \"attribute cipher-suite\" followed by a space-delimited list of only cipher suites from step 5 that use FIPS-compliant HMAC algorithms.
7. Press \"Enter\"."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001942,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104245r1_rule,STIG-ID|SYMP-AG-000380,SWIFT-CSCv1|2.6,Vuln-ID|V-94291"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<if>
  <condition type:"OR">
    <custom_item>
      description : "Radius In Use"
      regex       : "security radius edit-realm .* ;mode"
      expect      : "security radius edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - RADIUS"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security radius edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. -RADIUS"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "CAT|II,CCI|CCI-002007,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "LDAP In Use"
      regex       : "security ldap edit-realm .* ;mode"
      expect      : "security ldap edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - LDAP"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security ldap edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - LDAP"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "XML In Use"
      regex       : "security xml edit-realm .* ;mode"
      expect      : "security xml edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - xml"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security xml edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - xml"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "IWA In Use"
      regex       : "security iwa-bcaaa edit-realm .* ;mode"
      expect      : "security iwa-bcaaa edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - iwa"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security iwa-bcaaa edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - iwa"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "siteminder In Use"
      regex       : "security siteminder edit-realm .* ;mode"
      expect      : "security siteminder edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - siteminder"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security siteminder edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - siteminder"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      description : "coreid In Use"
      regex       : "security coreid edit-realm .* ;mode"
      expect      : "security coreid edit-realm .* ;mode"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - coreid"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
      context     : "security coreid edit-realm .* ;mode"
      regex       : "refresh-time credential-refresh"
# Note: Variable @CREDENTIAL_REFRESH_TIME@ replaced with "900" in field "expect".
      expect      : "refresh-time credential-refresh 900"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "SYMP-AG-000390 - Symantec ProxySG must prohibit the use of cached authenticators after 300 seconds at a minimum. - coreid"
      info        : "If the cached authenticator information is out of date, the validity of the authentication information may be questionable.
This requirement applies to all ALGs that may cache user authenticators for use throughout a session. It also applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
      solution    : "Set credential cache lifetimes for LDAP, RADIUS, XML, IWA (with Basic credentials), SiteMinder, and COREid authentication methods.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click each of the above authentication mechanisms and select the \"General\" tab (e.g., Radius General or LDAP General).
4. Set the \"Credential Refresh\" time to 300 at a minimum.
5. Click \"Apply\"."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CCI|CCI-002007,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104247r1_rule,STIG-ID|SYMP-AG-000390,Vuln-ID|V-94293"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
    </report>
  </else>
</if>

<report type:"WARNING">
  description : "SYMP-AG-000410 - Symantec ProxySG, when configured for reverse proxy/WAF services and providing PKI-based user authentication intermediary services, must map the client certificate to the authentication server store."
  info        : "Authorization for access to any network element requires an approved and assigned individual account identifier. To ensure only the assigned individual is using the account, the account must be bound to a user certificate when PKI-based authentication is implemented.
This requirement applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). It does not apply to authentication for the purpose of configuring the device itself (device management)
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to map PKI user credentials to user identities in a reverse proxy configuration.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Click each HTTPS Reverse Proxy service and click \"Edit Service\".
4. Check the \"Verify Client\" option and click \"Apply\".
5. Configure all remaining options in accordance with the site's SSP."
  reference   : "CAT|II,CCI|CCI-000187,Rule-ID|SV-104249r1_rule,STIG-ID|SYMP-AG-000410,Vuln-ID|V-94295"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-AG-000420 - Symantec ProxySG providing user authentication intermediary services using PKI-based user authentication must implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network."
  info        : "Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).
The intent of this requirement is to require support for a secondary certificate validation method using a locally cached revocation data, such as Certificate Revocation List (CRL), in case access to OCSP (required by CCI-000185) is not available. Based on a risk assessment, an alternate mitigation is to configure the system to deny access when revocation data is unavailable.
This requirement applies to ALGs that provide user authentication intermediary services (e.g., authentication gateway or TLS gateway). This does not apply to authentication for the purpose of configuring the device itself (device management)"
  solution    : "Configure PKI Certificate Revocation lists.
1. Log on to the Web Management Console.
2. Browse to Configuration >> SSL >> CRLs.
3. Click \"New\" and configure in accordance the setting required by site guidance."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-001991,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-104251r1_rule,STIG-ID|SYMP-AG-000420,Vuln-ID|V-94297"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "ssl ;mode"
  regex       : "create crl"
  expect      : "create crl.*"
</custom_item>

<custom_item>
  description : "SYMP-AG-000430 - Symantec ProxySG providing user authentication intermediary services must conform to Federal Identity, Credential, and Access Management (FICAM)-issued profiles."
  info        : "Without conforming to FICAM-issued profiles, the information system may not be interoperable with FICAM-authentication protocols, such as SAML 2.0 and OpenID 2.0.
Use of FICAM-issued profiles addresses open identity management standards.
This only applies to components where this is specific to the function of the device or has the concept of a nonorganizational user (e.g., ALG capability that is the front end for an application in a DMZ)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure ProxySG to conform to a FICAM-authentication protocol and configure it to use SAML authentication.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. Click \"SAML\" and configure."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002014,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104253r1_rule,STIG-ID|SYMP-AG-000430,SWIFT-CSCv1|2.3,Vuln-ID|V-94299"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "security saml edit-realm .* ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show tcp-ip"
  description : "SYMP-AG-000440 - Symantec ProxySG must terminate all network connections associated with a communications session at the end of the session or terminate user sessions (nonprivileged session) after 15 minutes of inactivity."
  info        : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the ProxySG.
Terminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level and deallocating networking assignments at the application level if multiple application sessions are using a single operating system level network connection.
ALGs may provide session control functionality as part of content filtering, load balancing, or proxy services. Symantec ProxySG manages sessions automatically and terminates them once they become idle. The idle period is governed by parameters such as the TCP segment lifetime (default is 120 seconds) and authentication credential inactivity timeout (default is 900 seconds for all authentication types)"
  solution    : "Configure the two user-configurable parameters that affect session termination (TCP segment lifetime and authentication credential inactivity timeout).
Configure the TCP segment lifetime setting (default is 120 seconds).
1. SSH into the ProxySG console and type \"enable\" and then \"configure\".
2. Type \"tcp-ip tcp 2msl 900\", for example, to set the timeout to 900 seconds (the default).
Configure the authentication credential inactivity timeouts.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Authentication.
3. For each authentication method listed, click it and then the \"General\" tab and set the \"Inactivity timeout\" to 600 seconds or less (default is 900 seconds).
4. Click \"Apply\"."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|I,CCI|CCI-001133,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),ITSG-33|AC-12,NIAv2|NS49,Rule-ID|SV-104255r1_rule,STIG-ID|SYMP-AG-000440,Vuln-ID|V-94301"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "TCP 2MSL timeout:"
  expect      : "TCP 2MSL timeout: [0-9]|[0-9][0-9]|0-5][0-9][0-9]|600$"
</custom_item>

<custom_item>
  description : "SYMP-AG-000450 - Symantec ProxySG providing forward proxy encryption intermediary services must use NIST FIPS-validated cryptography to implement encryption services."
  info        : "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.
This requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure TLS intermediary services to comply with NIST FIPS-validated cryptography.
1. Log on to the Web Management Console.
2. Click Configuration >> Visual Policy Manager.
3. Click \"Launch\". While in the Visual Policy Manager, click Policy >> Add SSL Access Layer.
4. Right-click the \"Source\" field of the existing rule and select \"Set\". Click \"New\" and select \"Combined Source Object\".
5. Click \"New\" and select \"Client Negotiated Cipher\". Select all ciphers that should be permitted and click \"OK\".
6. Click the upper \"Add\" button and click the \"Negate\" checkbox.
7. Click \"New\" and select \"Client Negotiated SSL Version\". Select all NIST FIPS-validated SSL versions that should be permitted and click \"OK\".
8. Click the upper \"Add\" button.
9. Click \"OK\" and then \"OK\" again.
10. Repeat steps 4-9 for the \"Destination\" field using the \"Server Negotiated Cipher\" and \"Server Negotiated SSL Version\" objects.
11. Right-click the \"Action\" field of the rule, click \"Set\", and select \"Deny\".
12. Click File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002450,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104257r1_rule,STIG-ID|SYMP-AG-000450,SWIFT-CSCv1|2.3,Vuln-ID|V-94303"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<SSL>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000460 - Symantec ProxySG providing reverse proxy encryption intermediary services must implement NIST FIPS-validated cryptography to generate cryptographic hashes."
  info        : "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.
This requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC)"
  solution    : "Configure TLS reverse proxy intermediary services to comply with NIST FIPS-validated cryptography.
1. Verify with the ProxySG administrator that reverse proxy services are configured.
2. Log on to the Web Management Console.
3. Click Configuration >> Services >> Proxy Services.
4. For each reverse proxy service configured, click \"Edit Service\" and select only NIST FIPS-validated SSL protocols. Click \"Apply\".
5. Log on to the ProxySG SSH CLI.
6. Type \"enable\" and enter the enable password.
7. Type \"configure\" and press \"Enter\".
8. Type \"proxy-services\" and press \"Enter\".
9. For each reverse proxy service identified by the administrator, type \"edit <reverse proxy service name\".
10. Type \"attribute\" followed by a list of the desired NIST FIPS-validated cipher suites."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104259r1_rule,STIG-ID|SYMP-AG-000460,SWIFT-CSCv1|2.6,Vuln-ID|V-94305"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000470 - Symantec ProxySG providing reverse proxy encryption intermediary services must implement NIST FIPS-validated cryptography for digital signatures."
  info        : "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.
This requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC)"
  solution    : "Configure TLS reverse proxy intermediary services to comply with NIST FIPS-validated cryptography.
1. Verify with the ProxySG administrator that reverse proxy services are configured.
2. Log on to the Web Management Console.
3. Click Configuration >> Services >> Proxy Services.
4. For each reverse proxy service configured, click \"Edit Service\" and select only NIST FIPS-validated SSL protocols. Click \"Apply\".
5. Log on to the ProxySG SSH CLI.
6. Type \"enable\" and enter the enable password.
7. Type \"configure\" and press \"Enter\".
8. Type \"proxy-services\" and press \"Enter\".
9. For each reverse proxy service identified by the administrator, type \"edit <reverse proxy service name\".
10. Type \"attribute\" followed by a list of the desired NIST FIPS-validated cipher suites."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104261r1_rule,STIG-ID|SYMP-AG-000470,SWIFT-CSCv1|2.6,Vuln-ID|V-94307"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000480 - Symantec ProxySG providing reverse proxy encryption intermediary services must use NIST FIPS-validated cryptography to implement encryption services."
  info        : "Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The network element must implement cryptographic modules adhering to the higher standards approved by the Federal government since this provides assurance they have been tested and validated.
This requirement applies only to ALGs that provide encryption intermediary services (e.g., HTTPS, TLS, or DNSSEC)"
  solution    : "Configure TLS reverse proxy intermediary services to comply with NIST FIPS-validated cryptography.
1. Verify with the ProxySG administrator that reverse proxy services are configured.
2. Log on to the Web Management Console.
3. Click Configuration >> Services >> Proxy Services.
4. For each reverse proxy service configured, click \"Edit Service\" and select only NIST FIPS-validated SSL protocols. Click \"Apply\".
5. Log on to the ProxySG SSH CLI.
6. Type \"enable\" and enter the enable password.
7. Type \"configure\" and press \"Enter\".
8. Type \"proxy-services\" and press \"Enter\".
9. For each reverse proxy service identified by the administrator, type \"edit <reverse proxy service name\".
10. Type \"attribute\" followed by a list of the desired NIST FIPS-validated cipher suites.
See the Blue Coat Reverse Proxy WebGuide for more information."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104263r1_rule,STIG-ID|SYMP-AG-000480,SWIFT-CSCv1|2.6,Vuln-ID|V-94309"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000490 - Symantec ProxySG must use Transport Layer Security (TLS) to protect the authenticity of communications sessions."
  info        : "Authenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.
This requirement focuses on communications protection for the application session rather than for the network packet and establishes grounds for confidence at both ends of communications sessions in ongoing identities of other parties and in the validity of information transmitted. Depending on the required degree of confidentiality and integrity, web services/SOA will require the use of mutual authentication (two-way/bidirectional)"
  solution    : "Configure the ProxySG to use only FIPS-compliant HMAC algorithms.
1. Log on to the ProxySG SSH CLI.
2. Type \"enable\" and enter the enable password.
3. Type \"configure terminal\" and press \"Enter\".
 4. Type \"management-services\" and press \"Enter\". Type \"edit HTTPS-Console\" and press \"Enter\".
 5. Type \"view\" to display the list of configured cipher suites.
 6. Type \"attribute cipher-suite\" followed by a space-delimited list of only cipher suites from step 5 that use FIPS-compliant HMAC algorithms and press \"Enter\"."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-001184,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-104265r1_rule,STIG-ID|SYMP-AG-000490,SWIFT-CSCv1|2.6,Vuln-ID|V-94311"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "Cipher Suite"
# Note: Variable @APPROVED_CIPHERS@ replaced with "^Cipher Suite: ecdhe-rsa-aes256-sha384$" in field "expect".
  expect      : "^Cipher Suite: ecdhe-rsa-aes256-sha384$"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000500 - If reverse proxy is used for validating and restricting certs from external entities, and this function is required by the SSP, Symantec ProxySG providing user authentication intermediary services using PKI-based user authentication must only accept end entity certificates issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) for the establishment of protected sessions."
  info        : "Non-DoD-approved PKIs have not been evaluated to ensure they have security controls and identity vetting procedures in place that are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.
The authoritative list of DoD-approved PKIs is published at http://iase.disa.mil/pki-pke/interoperability. DoD-approved PKI CAs may include Category I, II, and III certificates. Category I DoD-Approved External PKIs are PIV issuers. Category II DoD-Approved External PKIs are Non-Federal Agency PKIs cross-certified with the Federal Bridge Certification Authority (FBCA). Category III DoD-Approved External PKIs are Foreign, Allied, or Coalition Partner PKIs.
Deploying the ALG with TLS enabled will require the installation of DoD and/or DoD-Approved CA certificates in the trusted root certificate store of each proxy to be used for TLS traffic.
This requirement focuses on communications protection for the application session rather than for the network packet
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure reverse proxy services to only trust DoD-approved Certificate Authorities.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Browse to SSL >> CA Certificates >> CA Certificate Lists.
4. Click \"Import,\" provide a \"Name,\" and paste in the first DoD CA certificate in PEM format and click \"OK\". Repeat for each DoD CA certificate desired.
5. Click CA Certificate Lists >> New.
6. Provide a \"Name,\" click each DoD CA certificate created in step 4, and click \"Add\". Once all certificates have been added, click \"OK\".
7. Browse to Configuration >> Services >> Proxy Services.
8. Select each HTTPS Reverse Proxy service and click \"Edit Service\".
9. Select the CCL created in step 6, click \"OK,\" and then click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002470,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104267r1_rule,STIG-ID|SYMP-AG-000500,SWIFT-CSCv1|2.3,Vuln-ID|V-94313"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000510 - Symantec ProxySG must fail to a secure state upon failure of initialization, shutdown, or abort actions."
  info        : "Failure to a known safe state helps prevent systems from failing to a state that may cause loss of data or unauthorized access to system resources. Network elements that fail suddenly and with no incorporated failure state planning may leave the hosting system available but with a reduced security protection capability. Preserving system state information also facilitates system restart and return to the operational mode of the organization with less disruption to mission-essential processes.
An example is a firewall that blocks all traffic rather than allowing all traffic when a firewall component fails (e.g., fail closed and do not forward traffic). This prevents an attacker from forcing a failure of the system to obtain access.
Depending on the deployment architecture, there are many configurations to check external to the ProxySG to ensure that failures of initialization, shutdown, or abort actions result in a secure state. With these external configurations in place, the ProxySG meets this requirement inherently. However, if a ProxySG hardware appliance is configured in a transparent, physically in-path manner, the check and fix apply"
  solution    : "Configure the transparent, physically in-line hardware ProxySG appliance to fail securely in the event of failures of initialization, shutdown, or abort actions.
1. Browse to Configuration >> Network >> Adapters >> Bridges.
2. Select the appropriate bridge-pair (whichever is in use) and click \"Edit\".
3. Select the \"fail-closed\" radio button and click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001190,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104269r1_rule,STIG-ID|SYMP-AG-000510,SWIFT-CSCv1|2.3,Vuln-ID|V-94315"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "bridge ;mode"
  regex       : "mode"
  expect      : "mode fail-closed"
</custom_item>

<custom_item>
  cmd         : "show attack-detection configuration"
  description : "SYMP-AG-000520 - Symantec ProxySG providing content filtering must protect against known and unknown types of denial-of-service (DoS) attacks by employing rate-based attack prevention behavior analysis."
  info        : "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users.
Installation of content filtering gateways and application layer firewalls at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.
Detection components that use rate-based behavior analysis can detect attacks when signatures for the attack do not exist or are not installed. These attacks include zero-day attacks, which are new attacks for which vendors have not yet developed signatures. Rate-based behavior analysis can detect sophisticated, Distributed DoS (DDoS) attacks by correlating traffic information from multiple network segments or components"
  solution    : "Configure denial-of-service attack detection/mitigation.

1. SSH into the ProxySG console and type \"enable\".
2. Enter the correct password and type \"config\".
3. Press \"Enter\" and type \"attack-detection\".
4. Type \"client\", press \"Enter\", type \"enable-limits\", and press \"Enter\"."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-002385,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104271r1_rule,STIG-ID|SYMP-AG-000520,TBA-FIISB|43.1,Vuln-ID|V-94317"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "client limits enabled"
  expect      : "client limits enabled:[\s]*true"
</custom_item>

<custom_item>
  description : "SYMP-AG-000530 - Symantec ProxySG must implement load balancing to limit the effects of known and unknown types of denial-of-service (DoS) attacks."
  info        : "If the network does not provide safeguards against DoS attacks, network resources will be unavailable to users. Load balancing provides service redundancy, which reduces the susceptibility of the ALG to many DoS attacks.
The ALG must be configured to prevent or mitigate the impact on network availability and traffic flow of DoS attacks that have occurred or are ongoing.
This requirement applies to the network traffic functionality of the device as it pertains to handling network traffic. Some types of attacks may be specialized to certain network technologies, functions, or services. For each technology, known and potential DoS attacks must be identified and solutions for each type implemented.
For detailed information, see the ProxySG Administration Guide, Chapter 39: Configuring Failover"
  solution    : "Configure redundancy on the ProxySG.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Network >> Advanced.
3. Select the \"Failover\" tab and configure using the SSP requirements."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002385,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104273r1_rule,STIG-ID|SYMP-AG-000530,SWIFT-CSCv1|2.3,Vuln-ID|V-94319"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "failover ;mode"
  regex       : "enable"
  expect      : "enable"
</custom_item>

<custom_item>
  cmd         : "show attack-detection configuration"
  description : "SYMP-AG-000540 - Symantec ProxySG must block outbound traffic containing known and unknown denial-of-service (DoS) attacks to protect against the use of internal information systems to launch any DoS attacks against other networks or endpoints."
  info        : "DoS attacks can take multiple forms but have the common objective of overloading or blocking a network or host to deny or seriously degrade performance. If the network does not provide safeguards against DoS attack, network resources will be unavailable to users.
Installation of an ALG at key boundaries in the architecture mitigates the risk of DoS attacks. These attacks can be detected by matching observed communications traffic with patterns of known attacks and monitoring for anomalies in traffic volume/type.
The ALG must include protection against DoS attacks that originate from inside the enclave that can affect either internal or external systems. These attacks may use legitimate or rogue endpoints from inside the enclave. These attacks can be simple \"floods\" of traffic to saturate circuits or devices, malware that consumes CPU and memory on a device or causes it to crash, or a configuration issue that disables or impairs the proper function of a device. For example, an accidental or deliberate misconfiguration of a routing table can misdirect traffic for multiple networks.
The appliance can reduce the effects of DoS and distributed-DoS (DDoS) attacks. DoS and DDoS attacks occur when one or more machines coordinate an attack on a specific website to cripple or disrupt host services. As the attack progresses, the target host shows decreased responsiveness and often stops responding. Legitimate HTTP traffic is unable to proceed because the infected system no longer has the resources to process new requests.
ProxySG appliances prevent attacks by limiting the number of simultaneous TCP connections and/or excessive repeated requests from each client IP address that can be established within a specified time frame. If these limits are met, the appliance either does not respond to connection attempts from a client already at this limit or resets the connection. It can also be configured to limit the number of active connections to prevent server overloading.
If the appliance starts seeing a large number of failed requests, and that number exceeds the configured error limit, subsequent requests are blocked and the proxy returns a warning page.
Failed requests, by default, include various HTTP response failures such as 4xx client errors (excluding 401 and 407) and 5xx server errors. The HTTP responses that should be treated as failures can be defined by creating policy.
If the requests continue despite the warnings, and the rate exceeds the warning limits that have been specified for the client, the client is then blocked at the TCP level"
  solution    : "Enable the Attack Detection function.
1. SSH into the ProxySG console and type \"enable\".
2. Enter the correct password and type \"configure terminal\".
3. Press \"Enter\" and type \"attack-detection\".
4. Type \"client\" and press \"Enter\". Type \"enable-limits\" and press \"Enter\".
Note: See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding. Fine-tune the default client limits if there is an operational impact."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-001094,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104275r1_rule,STIG-ID|SYMP-AG-000540,TBA-FIISB|43.1,Vuln-ID|V-94321"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "client limits enabled"
  expect      : "client limits enabled:[\s]*true"
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000550 - Symantec ProxySG must allow incoming communications only from organization-defined authorized sources routed to organization-defined authorized destinations. - Proxy Services"
  info        : "Unrestricted traffic may contain malicious traffic that poses a threat to an enclave or to other connected networks. Additionally, unrestricted traffic may transit a network, which uses bandwidth and other resources.
Access control policies and access control lists implemented on devices that control the flow of network traffic (e.g., application-level firewalls and web content filters) ensure the flow of traffic is only allowed from authorized sources to authorized destinations. Networks with different levels of trust (e.g., the Internet or CDS) must be kept separate
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure proxy services.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.
4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.
5. Click each layer and right-click the \"Source\" and \"Destination\" fields for each rule. Select \"Set\" and set each to the organizationally defined values in accordance with the site's SSP."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002403,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104277r1_rule,STIG-ID|SYMP-AG-000550,SWIFT-CSCv1|2.3,Vuln-ID|V-94323"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000550 - Symantec ProxySG must allow incoming communications only from organization-defined authorized sources routed to organization-defined authorized destinations. - Rules"
  info        : "Unrestricted traffic may contain malicious traffic that poses a threat to an enclave or to other connected networks. Additionally, unrestricted traffic may transit a network, which uses bandwidth and other resources.
Access control policies and access control lists implemented on devices that control the flow of network traffic (e.g., application-level firewalls and web content filters) ensure the flow of traffic is only allowed from authorized sources to authorized destinations. Networks with different levels of trust (e.g., the Internet or CDS) must be kept separate
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure proxy services.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.
4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.
5. Click each layer and right-click the \"Source\" and \"Destination\" fields for each rule. Select \"Set\" and set each to the organizationally defined values in accordance with the site's SSP."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002403,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104277r1_rule,STIG-ID|SYMP-AG-000550,SWIFT-CSCv1|2.3,Vuln-ID|V-94323"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>|<SSL>|<Admin>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000560 - Symantec ProxySG must fail securely in the event of an operational failure."
  info        : "If a boundary protection device fails in an unsecure manner (open), information external to the boundary protection device may enter, or the device may permit unauthorized information release.
Secure failure ensures that when a boundary control device fails, all traffic will be subsequently denied.
Fail secure is a condition achieved by employing information system mechanisms to ensure that in the event of operational failures of boundary protection devices at managed interfaces (e.g., routers, firewalls, guards, and application gateways residing on protected subnetworks commonly referred to as demilitarized zones), information systems do not enter into unsecure states where intended security properties no longer hold.
Depending on the deployment architecture, there are many configurations to check that are external to the ProxySG to ensure that an operational failure results in a secure state. With these external configurations in place, the ProxySG meets this requirement inherently. However, if a ProxySG hardware appliance is configured in a transparent, physically in-path manner, the check and fix on the ProxySG will apply"
  solution    : "Configure the transparent, physically in-line hardware ProxySG appliance to fail securely in the event of an operational failure.
1. Browse to Configuration >> Network >> Adapters >> Bridges.
2. Select the appropriate bridge-pair (whichever is in use) and click \"Edit\".
3. Select the \"fail-closed\" radio button and click \"Apply\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-001126,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104279r1_rule,STIG-ID|SYMP-AG-000560,SWIFT-CSCv1|2.3,Vuln-ID|V-94325"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "bridge ;mode"
  regex       : "mode"
  expect      : "mode fail-closed"
</custom_item>

<report type:"WARNING">
  description : "SYMP-AG-000570 - Symantec ProxySG must deny network communications traffic by default and allow network communications traffic by exception (i.e., deny all, permit by exception)."
  info        : "A deny-all, permit-by-exception network communications traffic policy ensures that only connections that are essential and approved are allowed.
As a managed interface, the ALG must block all inbound and outbound network communications traffic to the application being managed and controlled unless a policy filter is installed to explicitly allow the traffic. The allow policy filters must comply with the site's security policy.
This requirement applies to both inbound and outbound network communications traffic. All inbound and outbound traffic for which the ALG is acting as an intermediary or proxy must be denied by default
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to deny all traffic by default.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Policy >> Policy Options.
3. Set the \"Default Proxy Policy\" to \"Deny\" and click \"Apply\"."
  reference   : "CAT|II,CCI|CCI-001109,Rule-ID|SV-104281r1_rule,STIG-ID|SYMP-AG-000570,Vuln-ID|V-94327"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-AG-000580 - Symantec ProxySG must identify and log internal users associated with denied outgoing communications traffic posing a threat to external information systems."
  info        : "Without identifying the users who initiated the traffic, it would be difficult to identify those responsible for the denied communications.
This requirement applies to network elements that perform Data Leakage Prevention (DLP) (e.g., ALGs, proxies, or application level firewalls)
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to log user web traffic for auditing.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access Layer, right-click the \"Track\" column for each rule that has \"Action\" set to \"Deny\" and \"Destination\" defined as a restricted set of potentially threatening destinations and select \"Set\".
5. Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002400,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104283r1_rule,STIG-ID|SYMP-AG-000580,SWIFT-CSCv1|2.3,Vuln-ID|V-94329"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "SYMP-AG-000590 - Symantec ProxySG must tailor the Exceptions messages to generate error messages that provide the information necessary for corrective actions without revealing information that could be exploited by adversaries."
  info        : "Providing too much information in error messages risks compromising the data and security of the application and system.
Organizations must carefully consider the structure/content of error messages. The required information within error messages will vary based on the protocol and error condition. Information that could be exploited by adversaries includes, for example, ICMP messages that reveal the use of firewalls or access control lists.
The ProxySG is designed to not reveal useful information to adversaries in error messages, although it may be configured to display custom exception pages to comply with site-specific requirements
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to tailor the Exceptions messages to generate error messages that provide only the information necessary for corrective actions.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Policy >> Exceptions.
3. Change \"Install Exceptions Definitions from\" to \"Text Editor\" and click \"Install\".
4. Refer to the Custom Exception Pages for ProxySG Guide for more information on creating the text for this field.
5. After the text is entered, click Install >> Apply."
  reference   : "CAT|II,CCI|CCI-001312,Rule-ID|SV-104285r1_rule,STIG-ID|SYMP-AG-000590,Vuln-ID|V-94331"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
</report>

<custom_item>
  description : "SYMP-AG-000600 - Symantec ProxySG providing content filtering must be configured to integrate with a system-wide intrusion detection system."
  info        : "Without coordinated reporting between separate devices, it is not possible to identify the true scale and possible target of an attack.
Integration of the ALG with a system-wide intrusion detection system supports continuous monitoring and incident response programs. This requirement applies to monitoring at internal boundaries using TLS gateways, web content filters, email gateways, and other types of ALGs.
ALGs can work as part of the network monitoring capabilities to off-load inspection functions from the external boundary IDPS by performing more granular content inspection of protocols at the upper layers of the OSI reference model
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to log to an intrusion detection system.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging. Check the \"Enable Access Logging\" option.
3. Click Logs >> Upload Client and ensure that the Client Type parameters are set to send logs to the intrusion detection system."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-002656,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104287r1_rule,STIG-ID|SYMP-AG-000600,TBA-FIISB|43.1,Vuln-ID|V-94333"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "edit log main ;mode"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000610 - Symantec ProxySG providing content filtering must detect use of network services that have not been authorized or approved by the ISSM and ISSO, at a minimum."
  info        : "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.
Examples of network services include service-oriented architectures (SOAs), cloud-based services (e.g., infrastructure as a service, platform as a service, or software as a service), cross-domain, Voice over Internet Protocol, Instant Messaging, auto-execute, and file sharing.
To comply with this requirement, the ALG may be configured to detect services either directly or indirectly (i.e., by detecting traffic associated with a service). This requirement applies to gateways/firewalls that perform content inspection or have higher-layer proxy functionality.
ProxySG is a default-deny device and only permits authorized/approved network services to be used
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Enable network proxy services on the ProxySG.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Click \"New Service\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002683,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104289r1_rule,STIG-ID|SYMP-AG-000610,SWIFT-CSCv1|2.3,Vuln-ID|V-94335"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000620 - Symantec ProxySG providing content filtering must generate a log record when access attempts to unauthorized websites and/or services are detected."
  info        : "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.
Examples of network services include service-oriented architectures (SOAs), cloud-based services (e.g., infrastructure as a service, platform as a service, or software as a service), cross-domain, Voice over Internet Protocol, Instant Messaging, auto-execute, and file sharing
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to log access attempts to unauthorized websites and/or services.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access Layer, right-click the \"Track\" column for each rule and select \"Set\".
5. Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002684,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104291r1_rule,STIG-ID|SYMP-AG-000620,SWIFT-CSCv1|2.3,Vuln-ID|V-94337"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000630 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when access attempts to unauthorized websites and/or services are detected."
  info        : "Unauthorized or unapproved network services lack organizational verification or validation and therefore may be unreliable or serve as malicious rogues for valid services.
Automated mechanisms can be used to send automatic alerts or notifications. Such automatic alerts or notifications can be conveyed in a variety of ways (e.g., telephonically, via electronic mail, via text message, or via websites). The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to generate alerts for access attempts to unauthorized websites and/or services.
Email may be used to send alerts directly to the ISSO/ISSM. However, use caution and be selective when choosing on which Web Access rules to enable email notification.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New,\" and select \"Email\".
5. Select \"Custom Recipients\" and click \"Configure Custom Recipients Lists\".
6. Click \"New,\" provide a name for the list, and enter the ISSO and ISSM email addresses in the \"List Members\" field.
7. Click \"OK\" and click \"OK\" again. Create message text, and click \"OK\".
8. Click \"OK\" and click \"OK\" again. Select File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002684,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104293r1_rule,STIG-ID|SYMP-AG-000630,SWIFT-CSCv1|2.3,Vuln-ID|V-94339"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000640 - Reverse proxy Symantec ProxySG providing content filtering must continuously monitor inbound communications traffic crossing internal security boundaries for unusual or unauthorized activities or conditions."
  info        : "If inbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.
Internal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to monitor inbound communication traffic for unusual or unauthorized activities or conditions.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access Layer, right-click the \"Track\" column for each rule and select \"Set\".
5. Click \"New\" and select \"Event Log\"."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002661,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104295r1_rule,STIG-ID|SYMP-AG-000640,SWIFT-CSCv1|2.3,Vuln-ID|V-94341"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show proxy-services"
  description : "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions. - Proxy Services"
  info        : "If outbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.
Internal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure proxy services.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.
4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.
5. Click each layer and right-click the \"Source\" and \"Destination\" fields for each rule. Select \"Set\" and set each to the organizationally defined values in accordance with the site's SSP."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002662,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104297r1_rule,STIG-ID|SYMP-AG-000650,SWIFT-CSCv1|2.3,Vuln-ID|V-94343"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000650 - Symantec ProxySG providing content filtering must continuously monitor outbound communications traffic crossing internal security boundaries for unusual/unauthorized activities or conditions. - Rules"
  info        : "If outbound communications traffic is not continuously monitored, hostile activity may not be detected and prevented. Output from application and traffic monitoring serves as input to continuous monitoring and incident response programs.
Internal monitoring includes the observation of events occurring on the network as they cross internal boundaries at managed interfaces such as web content filters. Depending on the type of ALG, organizations can monitor information systems by monitoring audit activities, application access patterns, characteristics of access, content filtering, or unauthorized exporting of information across boundaries. Unusual/unauthorized activities or conditions may include large file transfers, long-time persistent connections, unusual protocols and ports in use, and attempted communications with suspected malicious external addresses
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure proxy services.
1. Log on to the Web Management Console.
2. Browse to Configuration >> Services >> Proxy Services.
3. Review each service specified in the list with the ProxySG administrator to ensure that all remote access traffic has been accounted for and add any that are missing per the ProxySG Administration Guide, Chapter 7: Managing Proxy Services.
4. Click Configuration >> Policy >> Visual Policy Manager >> Launch.
5. Click each layer and right-click the \"Source\" and \"Destination\" fields for each rule. Select \"Set\" and set each to the organizationally defined values in accordance with the site's SSP."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002662,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104297r1_rule,STIG-ID|SYMP-AG-000650,SWIFT-CSCv1|2.3,Vuln-ID|V-94343"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  description : "SYMP-AG-000660 - Symantec ProxySG providing content filtering must send an alert to, at a minimum, the ISSO and ISSM when detection events occur."
  info        : "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.
Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.
These systems must generate an alert when detection events from real-time monitoring occur. Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to generate alerts for access attempts to unauthorized websites and/or services.
Email may be used to send alerts directly to the ISSO/ISSM. However, use caution and be selective when choosing which Web Access rules on which to enable email notification.
1. Log on to the Web Management Console.
2. Browse to \"Configuration\" and click \"Access Logging\". Check the \"Enable Access Logging\" option and click \"Apply\".
3. Click Policy >> Visual Policy Manager >> Launch.
4. For each Web Access Layer, right-click the \"Track\" column for each rule and select \"Set\". Click \"New\" and select \"Email\".
5. Select \"Custom Recipients\" and click \"Configure Custom Recipients Lists\".
6. Click \"New,\" provide a name for the list, and enter the ISSO and ISSM email addresses in the \"List Members\" field.
7. Click \"OK\" and click \"OK\" again. Create message text and click \"OK\".
8. Click \"OK\" and click \"OK\" again. Select File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002664,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104299r1_rule,STIG-ID|SYMP-AG-000660,SWIFT-CSCv1|2.3,Vuln-ID|V-94345"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

<custom_item>
  cmd         : "show attack-detection configuration"
  description : "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected. - Client limits"
  info        : "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.
The ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.
CJCSM 6510.01B, \"Cyber Incident Handling Program\", lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.
Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel"
  solution    : "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.
1. SSH into the ProxySG console and type \"enable\".
2. Enter the correct password and type \"config\".
3. Press \"Enter\" and type \"attack-detection\".
4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.
5. Type \"client\" and press \"Enter\". Type \"enable-limits\" and press \"Enter\".
6. Log on to the Web Management Console.
7. Browse to Maintenance >> Event Logging and click the \"Mail\" tab. Ensure that the ISSO and ISSM email addresses are specified.
8. Browse to Configuration >> Policy >> Visual Policy Manager. Click \"Launch\".
9. In one Web Access Layer, create a new rule. Right-click the \"Action\" of that rule and select \"Set\". Click \"New\" and select \"Set Attack Detection\". Provide a \"Failure Weight\" per local security policy requirements.
10. Click \"OK\" and click \"OK\" again.
11. Right-click the \"Track\" column for this rule and select \"Set\". Click \"New\" and select \"Email\".
12. Select \"Custom Recipients\" and click \"Configure Custom Recipients Lists\".
13. Click \"New,\" provide a name for the list, and enter the ISSO and ISSM email addresses in the \"List Members\" field.
14. Click \"OK\" and click \"OK\" again. Create message text and click \"OK\".
15. Click \"OK\" and click \"OK\" again. Select File >> Install Policy on SG Appliance."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CAT|II,CCI|CCI-002664,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,TBA-FIISB|43.1,Vuln-ID|V-94347"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  regex       : "client limits enabled"
  expect      : "client limits enabled:[\s]*true"
</custom_item>

<custom_item>
  description : "SYMP-AG-000670 - Symantec ProxySG providing content filtering must generate an alert to, at a minimum, the ISSO and ISSM when denial-of-service (DoS) incidents are detected. Rules"
  info        : "Without an alert, security personnel may be unaware of major detection incidents that require immediate action, and this delay may result in the loss or compromise of information.
The ALG generates an alert that notifies designated personnel of the Indicators of Compromise (IOCs) that require real-time alerts. These messages should include a severity level indicator or code as an indicator of the criticality of the incident. These indicators reflect the occurrence of a compromise or a potential compromise. Since these incidents require immediate action, these messages are assigned a critical or level 1 priority/severity, depending on the system's priority schema.
CJCSM 6510.01B, \"Cyber Incident Handling Program\", lists nine Cyber Incident and Reportable Event categories. DoD has determined that categories identified by CJCSM 6510.01B Major Indicators (category 1, 2, 4, or 7 detection events) will require an alert when an event is detected.
Alerts may be transmitted, for example, telephonically, by electronic mail messages, or by text messaging. The ALG must either send the alert to a management console that is actively monitored by authorized personnel or use a messaging capability to send the alert directly to designated personnel
NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the ProxySG to email DoS attack detection/mitigation alerts to the ISSO and ISSM.
1. SSH into the ProxySG console and type \"enable\".
2. Enter the correct password and type \"config\".
3. Press \"Enter\" and type \"attack-detection\".
4. See the ProxySG Administration Guide, Chapter 73: Preventing Denial of Service Attacks, to understand the functionality before proceeding.
5. Type \"client\" and press \"Enter\". Type \"enable-limits\" and press \"Enter\".
6. Log on to the Web Management Console.
7. Browse to Maintenance >> Event Logging and click the \"Mail\" tab. Ensure that the ISSO and ISSM email addresses are specified.
8. Browse to Configuration >> Policy >> Visual Policy Manager. Click \"Launch\".
9. In one Web Access Layer, create a new rule. Right-click the \"Action\" of that rule and select \"Set\". Click \"New\" and select \"Set Attack Detection\". Provide a \"Failure Weight\" per local security policy requirements.
10. Click \"OK\" and click \"OK\" again.
11. Right-click the \"Track\" column for this rule and select \"Set\". Click \"New\" and select \"Email\".
12. Select \"Custom Recipients\" and click \"Configure Custom Recipients Lists\".
13. Click \"New,\" provide a name for the list, and enter the ISSO and ISSM email addresses in the \"List Members\" field.
14. Click \"OK\" and click \"OK\" again. Create message text and click \"OK\".
15. Click \"OK\" and click \"OK\" again. Select File >> Install Policy on SG Appliance."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-002664,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-104301r1_rule,STIG-ID|SYMP-AG-000670,SWIFT-CSCv1|2.3,Vuln-ID|V-94347"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Symantec_ProxySG_V1R1_STIG.zip"
  context     : "<Proxy>"
  regex       : ".*"
  expect      : "MANUAL_REVIEW"
  severity    : MEDIUM
</custom_item>

</check_type>
