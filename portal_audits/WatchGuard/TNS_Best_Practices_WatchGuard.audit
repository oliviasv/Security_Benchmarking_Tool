#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.13 $
# $Date: 2020/04/22 $
#
# Description	: This .audit is designed to query WatchGuard Devices
#
#<ui_metadata>
#<display_name>TNS Best Practice WatchGuard Audit 1.0.0</display_name>
#<spec>
#  <type>TNS</type>
#  <name>TNS Best Practice WatchGuard Audit</name>
#  <version>1.0.0</version>
#</spec>
#<labels>TNS,WatchGuard</labels>
#<variables>
#  <variable>
#    <name>AUTH_USR_TO</name>
#    <default>7200</default>
#    <description>User Auth Timeout</description>
#    <info>This is the timeout for user authentication</info>
#  </variable>
#  <variable>
#    <name>AUTH_USR_SESS_TO</name>
#    <default>36000</default>
#    <description>User Session Tiemout</description>
#    <info>This is the timeout for User Inactive Session</info>
#  </variable>
#  <variable>
#    <name>MGMT_USR_IDL_TO</name>
#    <default>900</default>
#    <description>MGMT User Auth Timeout</description>
#    <info>This is the timeout for management user authentication</info>
#  </variable>
#  <variable>
#    <name>MGMT_USR_SESS_TO</name>
#    <default>36000</default>
#    <description>MGMT User Session Timeout</description>
#    <info>This is the timeout for Management User Inactive Session</info>
#  </variable>
#  <variable>
#    <name>SSO_ENABLE</name>
#    <default>ENABLED</default>
#    <description>Single Sign-On</description>
#    <info>Single Sign-On ENABLED/DISABLED</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVERS</name>
#    <default>(0\.pool\.ntp\.org|1\.pool\.ntp\.org|2\.pool\.ntp\.org)</default>
#    <description>NTP Server IP addresses</description>
#    <info>NTP Server IP addresses</info>
#  </variable>
#  <variable>
#    <name>DNS_SERVERS</name>
#    <default>(1\.1\.1\.1\|2\.2\.2\.2|.*)</default>
#    <description>DNS Server IP addresses</description>
#    <info>DNS Server IP addresses</info>
#  </variable>
#  <variable>
#    <name>WINS_SERVERS</name>
#    <default>(1\.1\.1\.1\|2\.2\.2\.2|.*)</default>
#    <description>WINS Server IP addresses</description>
#    <info>WINS Server IP addresses</info>
#  </variable>
#  <variable>
#    <name>LDAP_SERV_NAME</name>
#    <default>LDAP Server Name</default>
#    <description>LDAP Server Name</description>
#    <info>LDAP Server Name</info>
#  </variable>
#  <variable>
#    <name>LDAP_SERVER_PORT</name>
#    <default>111</default>
#    <description>LDAP Server Port</description>
#    <info>LDAP Server Port</info>
#  </variable>
#  <variable>
#    <name>DDOS_PER_SERV</name>
#    <default>100</default>
#    <description>DDoS Server - Conns Per Second</description>
#    <info>DDoS Server Quota - Connections per Second</info>
#  </variable>
#  <variable>
#    <name>DDOS_PER_CLIENT</name>
#    <default>100</default>
#    <description>DDoS Client - Conns Per Second</description>
#    <info>DDoS Client Quota - Connections per Second</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_PMTU</name>
#    <default>0</default>
#    <description>ICMP Error Handling PMTU</description>
#    <info>ICMP Error Handling PMTU Discovery</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_TE</name>
#    <default>0</default>
#    <description>ICMP Error Handling Time Exceeded</description>
#    <info>ICMP Error Handling Time Exceeded</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_NU</name>
#    <default>0</default>
#    <description>ICMP Error Handling NW Unreachable</description>
#    <info>ICMP Error Handling Network Unreachable</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_HU</name>
#    <default>0</default>
#    <description>ICMP Err. Handling Host Unreachable</description>
#    <info>ICMP Error Handling Host Unreachable</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_PORTU</name>
#    <default>0</default>
#    <description>ICMP - Port Unreachable</description>
#    <info>ICMP Error Handling Port Unreachable</info>
#  </variable>
#  <variable>
#    <name>ICMP_ERR_PROTU</name>
#    <default>0</default>
#    <description>ICMP - Protocol Unreachable</description>
#    <info>ICMP Error Handling Protocol Unreachable</info>
#  </variable>
#  <variable>
#    <name>LOG_SERV</name>
#    <default>1\.1\.1\.1</default>
#    <description>Remote Log Server Address</description>
#    <info>Remote Log Server Address</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"WatchGuard">

#Device Info

<custom_item>
  description : "WatchGuard : Device Info"
  info        : "The device info should be reviewed.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Device Info\n\n </xsl:text>"
  xsl_stmt    : "<xsl:text>\nModel - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/for-model\"/>"
  xsl_stmt    : "<xsl:text>\nSystem Contact - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/system-contact\"/>"
  xsl_stmt    : "<xsl:text>\nLocation - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/location\"/>"
  xsl_stmt    : "<xsl:text>\nTime Zone - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/time-zone\"/>"
  xsl_stmt    : "<xsl:text>\nEmail - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/email\"/>"
  xsl_stmt    : "<xsl:text>\nSystem Name - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/system-name\"/>"
  xsl_stmt    : "<xsl:text>\nDomain Name - </xsl:text> <xsl:value-of select=\"system-parameters/device-conf/domain-name\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.4.1,800-53|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,PCI-DSS|2.4,SANS-CSC|1"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Information' and then fill out the appropriate form fields."
  expect      : ".*"
  severity    : MEDIUM
</custom_item>

#NTP

<custom_item>
  description : "WatchGuard : NTP Enabled"
  info        : "Ensuring that approved NTP servers are used allows for accurate log/audit file correlation."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ntp-conf[contains(ntp-enabled,'1')]\">"
  xsl_stmt    : "<xsl:text>NTP Enabled : TRUE </xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>NTP Enabled : FALSE </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4.1,SANS-CSC|14"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'NTP' and then click the check box for 'Enable NTP'."
  regex       : "^NTP[\s]Enabled[\s]: "
  expect      : "^NTP[\s]Enabled[\s]:[\s]True$"
</custom_item>

<custom_item>
  description : "WatchGuard : NTP Servers"
  info        : "Ensuring that approved NTP servers are used allows for accurate log/audit file correlation."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>NTP Servers : </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ntp-conf/ntp-server-list\">"
  xsl_stmt    : "<xsl:for-each select=\"system-parameters/ntp-conf/ntp-server-list/ntp-server-ip\"><xsl:text>\n </xsl:text>"
  xsl_stmt    : "<xsl:value-of select=\".\"/>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4.1,SANS-CSC|14"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'NTP' and then click the check box for 'Enable NTP'. Add applicable server IP addresses."
  regex       : ".*"
# Note: Variable @NTP_SERVERS@ replaced with "(0\\.pool\\.ntp\\.org|1\\.pool\\.ntp\\.org|2\\.pool\\.ntp\\.org)" in field "expect".
  expect      : "(0\\.pool\\.ntp\\.org|1\\.pool\\.ntp\\.org|2\\.pool\\.ntp\\.org)"
</custom_item>

#DNS

<custom_item>
  description : "WatchGuard : DNS Servers"
  info        : "The DNS server IP address should be reviewed. A DNS server may return malicious IP addresses in response to requests for domains that are normally good. This provides an avenue to leak information about the appliance or to download untrusted content."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>DNS Servers : </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dns-server-list\">"
  xsl_stmt    : "<xsl:for-each select=\"system-parameters/dns-server-list/dns-entry\"><xsl:text>\n </xsl:text>"
  xsl_stmt    : "<xsl:value-of select=\".\"/>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-53|SC-20,ITSG-33|SC-20,PCI-DSS|2.2.3,SANS-CSC|19"
  solution    : "In the Web UI , navigate to the 'Network' section , click on 'Interfaces' and populate the DNS server text box with a DNS server IP and then click 'Add'."
  regex       : ".*"
# Note: Variable @DNS_SERVERS@ replaced with "(1\\.1\\.1\\.1\\|2\\.2\\.2\\.2|.*)" in field "expect".
  expect      : "(1\\.1\\.1\\.1\\|2\\.2\\.2\\.2|.*)"
</custom_item>

#WINS

<custom_item>
  description : "WatchGuard : WINS Servers"
  info        : "The WINS server IP address should be reviewed. A WINS server may return malicious IP addresses in response to requests for NetBIOS names that are normally good. This provides an avenue to leak information about the appliance or to download untrusted content."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>WINS Servers : </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/wins-server-list\">"
  xsl_stmt    : "<xsl:for-each select=\"system-parameters/wins-server-list/wins-server\"><xsl:text>\n </xsl:text>"
  xsl_stmt    : "<xsl:value-of select=\".\"/>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SANS-CSC|19,SWIFT-CSCv1|2.3"
  solution    : "In the Web UI , navigate to the 'Network' section , click on 'Interfaces' and populate the WINS server text box with a WINS server IP and then click 'Add'."
  regex       : ".*"
# Note: Variable @WINS_SERVERS@ replaced with "(1\\.1\\.1\\.1\\|2\\.2\\.2\\.2|.*)" in field "expect".
  expect      : "(1\\.1\\.1\\.1\\|2\\.2\\.2\\.2|.*)"
</custom_item>

#LDAP

<if>
  <condition type:"OR">
    <custom_item>
      description : "WatchGuard : LDAP is used check"
      xsl_stmt    : "<xsl:template match=\"profile\">"
      xsl_stmt    : "<xsl:text>LDAP in use: </xsl:text>"
      xsl_stmt    : "<xsl:choose>"
      xsl_stmt    : "<xsl:when test=\"auth-domain-list/auth-domain[contains(name,'LDAP')]\">"
      xsl_stmt    : "<xsl:value-of select=\"auth-domain-list/auth-domain/ldap/enabled\"/>"
      xsl_stmt    : "</xsl:when>"
      xsl_stmt    : "<xsl:otherwise>"
      xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
      xsl_stmt    : "</xsl:otherwise>"
      xsl_stmt    : "</xsl:choose>"
      xsl_stmt    : "</xsl:template>"
      regex       : "LDAP in use:"
      expect      : "LDAP in use: 1"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      description : "WatchGuard : LDAP Server Name"
      info        : "Ensure LDAP server is trusted - LDAP Server Name"
      solution    : "In the Web UI navigate to the 'Authentications' - > 'Servers' -> 'LDAP' section and populate the appropriate text fields."
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|2.2.3,SANS-CSC|19,TBA-FIISB|35.1,TBA-FIISB|36.1"
      xsl_stmt    : "<xsl:template match=\"profile\">"
      xsl_stmt    : "<xsl:text>LDAP Server Name: </xsl:text><xsl:value-of select=\"auth-domain-list/auth-domain/ldap/server-name\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "LDAP Server Name:"
# Note: Variable @LDAP_SERV_NAME@ replaced with "LDAP Server Name" in field "expect".
      expect      : "LDAP Server Name: LDAP Server Name"
    </custom_item>

    <custom_item>
      description : "WatchGuard : LDAP Server Password"
      info        : "Ensure LDAP server is trusted - LDAP Server Password is used"
      solution    : "In the Web UI navigate to the 'Authentications' - > 'Servers' -> 'LDAP' section and populate the appropriate text fields."
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|2.2.3,SANS-CSC|19,TBA-FIISB|35.1,TBA-FIISB|36.1"
      xsl_stmt    : "<xsl:template match=\"profile\">"
      xsl_stmt    : "<xsl:text>LDAP Server Password: </xsl:text><xsl:value-of select=\"auth-domain-list/auth-domain/ldap/search-user-pwd\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "LDAP Server Password:"
      expect      : "LDAP Server Password: .*"
    </custom_item>

    <custom_item>
      description : "WatchGuard : LDAP Server Port"
      info        : "Ensure LDAP server is trusted - LDAP Server Port"
      solution    : "In the Web UI navigate to the 'Authentications' - > 'Servers' -> 'LDAP' section and populate the appropriate text fields."
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|2.2.3,SANS-CSC|19,TBA-FIISB|35.1,TBA-FIISB|36.1"
      xsl_stmt    : "<xsl:template match=\"profile\">"
      xsl_stmt    : "<xsl:text>LDAP Server Port: </xsl:text><xsl:value-of select=\"auth-domain-list/auth-domain/ldap/server-port\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "LDAP Server Port:"
# Note: Variable @LDAP_SERVER_PORT@ replaced with "111" in field "expect".
      expect      : "LDAP Server Port: 111"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "WatchGuard : LDAP is not in use - LDAP checks are N/A"
      info        : "LDAP is not in use - LDAP checks are N/A"
    </report>
  </else>
</if>

#DoS

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop SYN Flood Attack"
  info        : "DoS Prevention - Drop SYN Flood Attack"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop SYN Flood Attack'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop SYN Flood Attack: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '1']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 1]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop SYN Flood Attack:"
  expect      : "Drop SYN Flood Attack: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop ICMP Flood Attack"
  info        : "DoS Prevention - Drop ICMP Flood Attack"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop ICMP Flood Attack'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop ICMP Flood Attack: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '2']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 2]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop ICMP Flood Attack:"
  expect      : "Drop ICMP Flood Attack: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop UDP Flood Attack"
  info        : "DoS Prevention - Drop UDP Flood Attack"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop UDP Flood Attack'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop UDP Flood Attack: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '3']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 3]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop UDP Flood Attack:"
  expect      : "Drop UDP Flood Attack: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop IP Source Route"
  info        : "DoS Prevention - Drop IP Source Route"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop IP Source Route'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop IP Source Route: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '5']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 5]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop IP Source Route:"
  expect      : "Drop IP Source Route: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop IPSEC Flood Attack"
  info        : "DoS Prevention - Drop IPSEC Flood Attack"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop IPSEC Flood Attack'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop IPSEC Flood Attack: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '7']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 7]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop IPSEC Flood Attack:"
  expect      : "Drop IPSEC Flood Attack: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Drop IKE Flood Attack"
  info        : "DoS Prevention - Drop IKE Flood Attack"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Drop IKE Flood Attack'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Drop IKE Flood Attack: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '8']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 8]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Drop IKE Flood Attack:"
  expect      : "Drop IKE Flood Attack: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Block Address Space Probes"
  info        : "DoS Prevention - Block Address Space Probes"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Block Address Space Probes'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Block Address Space Probes: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '12']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 12]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Block Address Space Probes:"
  expect      : "Block Address Space Probes: 1"
</custom_item>

<custom_item>
  description : "WatchGuard : DoS Prevention - Block Port Space Probes"
  info        : "DoS Prevention - Block Port Space Probes"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Click the checkbox next to 'Block Port Space Probes'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Block Port Space Probes: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '13']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 13]/dos-enable\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Block Port Space Probes:"
  expect      : "Block Port Space Probes: 1"
</custom_item>

#DDoS

<custom_item>
  description : "WatchGuard : DDoS Prevention - Distributed Denial-of-Service Prevention - Per Server Quota"
  info        : "DDoS Prevention - Distributed Denial-of-Service Prevention - Per Server Quota"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Populate the test field next to 'Per Server Quota'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Distributed Denial-of-Service Prevention - Per Server Quota: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '9']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 9]/dos-threshold\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Distributed Denial-of-Service Prevention - Per Server Quota:"
# Note: Variable @DDOS_PER_SERV@ replaced with "100" in field "expect".
  expect      : "Distributed Denial-of-Service Prevention - Per Server Quota: 100"
</custom_item>

<custom_item>
  description : "WatchGuard : DDoS Prevention - Distributed Denial-of-Service Prevention - Per Client Quota"
  info        : "Distributed Denial-of-Service Prevention - Per Client Quota"
  solution    : "In the Web UI navigate to the 'Firewall' - > 'Default Packet Handling' section. Populate the test field next to 'Per Client Quota'."
  reference   : "800-53|SC-5,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Distributed Denial-of-Service Prevention - Per Client Quota: </xsl:text>"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/dos-prevention/dos-item/dos-type[text() = '10']\">"
  xsl_stmt    : "<xsl:value-of select=\"system-parameters/dos-prevention/dos-item[dos-type/text() = 10]/dos-threshold\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Not Enabled </xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Distributed Denial-of-Service Prevention - Per Client Quota:"
# Note: Variable @DDOS_PER_CLIENT@ replaced with "100" in field "expect".
  expect      : "Distributed Denial-of-Service Prevention - Per Client Quota: 100"
</custom_item>

#ICMP Error Handling

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'pmtu-discovery'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Fragmentation req (PMTU)'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>PMTU Discovery : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/pmtu-discovery\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^PMTU[\s]Discovery[\s]:[\s]"
# Note: Variable @ICMP_ERR_PMTU@ replaced with "0" in field "expect".
  expect      : "^PMTU[\s]Discovery[\s]:[\s]0"
</custom_item>

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'time-exceeded'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Time Exceeded'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Time Exceeded : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/time-exceeded\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^Time[\s]Exceeded[\s]:[\s]"
# Note: Variable @ICMP_ERR_TE@ replaced with "0" in field "expect".
  expect      : "^Time[\s]Exceeded[\s]:[\s]0"
</custom_item>

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'network-unreachable'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Network unreachable'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Network Unreachable : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/network-unreachable\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^Network[\s]Unreachable[\s]:[\s]"
# Note: Variable @ICMP_ERR_NU@ replaced with "0" in field "expect".
  expect      : "^Network[\s]Unreachable[\s]:[\s]0"
</custom_item>

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'host-unreachable'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Host unreachable'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Host Unreachable : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/host-unreachable\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^Host[\s]Unreachable[\s]:[\s]"
# Note: Variable @ICMP_ERR_HU@ replaced with "0" in field "expect".
  expect      : "^Host[\s]Unreachable[\s]:[\s]0"
</custom_item>

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'port-unreachable'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Port unreachable'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Port Unreachable : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/port-unreachable\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^Port[\s]Unreachable[\s]:[\s]"
# Note: Variable @ICMP_ERR_PORTU@ replaced with "0" in field "expect".
  expect      : "^Port[\s]Unreachable[\s]:[\s]0"
</custom_item>

<custom_item>
  description : "WatchGuard : ICMP Error Handling - 'protocol-unreachable'"
  info        : "ICMP Error messages can be used as a means to compromise sytems and networks. Appropriate configuration and filtering of these messages should be used to reduce potential threats."
  solution    : "In the Web UI navigate to the 'System' - > 'Global Settings' - > 'Networking' section. Uncheck the box for 'Protocol unreachable'."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,TBA-FIISB|43.1"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Protocol Unreachable : </xsl:text> <xsl:value-of select=\"system-parameters/icmp-error-handling/protocol-unreachable\"/>"
  xsl_stmt    : "</xsl:template>"
  see_also    : "https://www.sans.org/security-resources/idfaq/icmp_misuse.php"
  regex       : "^Protocol[\s]Unreachable[\s]:[\s]"
# Note: Variable @ICMP_ERR_PROTU@ replaced with "0" in field "expect".
  expect      : "^Protocol[\s]Unreachable[\s]:[\s]0"
</custom_item>

#SNMP

<custom_item>
  description : "WatchGuard : SNMP Configuration - Version = '3'"
  info        : "SNMP v3 supports enhanced security."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol[contains(snmp-version,'3')]\">"
  xsl_stmt    : "<xsl:text>SNMP Protocol Version : </xsl:text> <xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-version\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP Protocol Version : </xsl:text><xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-version\"/>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.1,800-171|3.4.2,800-53|CM-6,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(d),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv6|3.1,CSF|ID.RA-1,CSF|PR.IP-1,CSF|PR.IP-12,ITSG-33|CM-6,ITSG-33|SI-2,NESA|T3.2.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.3"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the dropdown box for 'Version'. Set it to 'v3'."
  regex       : "^SNMP[\s]Protocol[\s]Version[\s]:[\s]"
  expect      : "^SNMP[\s]Protocol[\s]Version[\s]:[\s]3$"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - v3 uses SHA1 Auth Algorithm"
  info        : "If SNMP v3 users are configured, they should use SHA1 for authentication."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3\">"
  xsl_stmt    : "<xsl:text>SNMP Auth Algorithm : </xsl:text> <xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3/auth-algm\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP Auth Algorithm : (v3) NOT ENABLED</xsl:text> "
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.13.8,800-53|SC-8(1),CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSS|2.2.3,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the dropdown box for 'Authentication Protocol'. Set it to 'SHA1'."
  regex       : "^SNMP[\s]Auth[\s]Algorithm[\s]:[\s]"
  expect      : "^SNMP[\s]Auth[\s]Algorithm[\s]:[\s]2$"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - v3 uses DES"
  info        : "If SNMP v3 is used, it should use DES for privacy."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3\">"
  xsl_stmt    : "<xsl:text>SNMP Priv Algorithm : </xsl:text> <xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3/priv-algm\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP Priv Algorithm : (v3) NOT ENABLED</xsl:text> "
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.1,800-171|3.4.2,800-53|CM-6,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(d),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSCv6|3.1,CSF|ID.RA-1,CSF|PR.IP-1,CSF|PR.IP-12,ITSG-33|CM-6,ITSG-33|SI-2,NESA|T3.2.1,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,SWIFT-CSCv1|2.2,SWIFT-CSCv1|2.3"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the dropdown box for 'Privacy Protocol'. Set it to 'DES'."
  regex       : "^SNMP[\s]Priv[\s]Algorithm[\s]:[\s]"
  expect      : "^SNMP[\s]Priv[\s]Algorithm[\s]:[\s]1$"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - v3 user has password - auth protocol"
  info        : "SNMP Configuration - v3 users have passwords"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3[contains(auth-algm,'0')]\">"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : SNMP v3 not enabled</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.13,800-53|AC-17(2),CIP|005-5-R2,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSS|2.2.3,SWIFT-CSCv1|2.6"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the password form box for 'Password' under authentication protocol. Fill out the form with the password."
  regex       : "^SNMP[\s]User[\s]Has[\s]a[\s]PW[\s]:[\s]"
  expect      : "^SNMP[\s]User[\s]Has[\s]a[\s]PW[\s]:[\s]TRUE"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - v3 user has password - priv protocol"
  info        : "SNMP Configuration - v3 users have passwords"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol/snmp-v3[contains(priv-algm,'0')]\">"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP User Has a PW : SNMP v3 not enabled</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.13,800-53|AC-17(2),CIP|005-5-R2,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,PCI-DSS|2.2.3,SWIFT-CSCv1|2.6"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the password form box for 'Password' under authentication protocol. Fill out the form with the password."
  regex       : "^SNMP[\s]User[\s]Has[\s]a[\s]PW[\s]:[\s]"
  expect      : "^SNMP[\s]User[\s]Has[\s]a[\s]PW[\s]:[\s]TRUE"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - community string - 'private'"
  info        : "Ensure SNMP does not use an easy to guess or default community string - 'private'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol[contains(snmp-version,'2')]\">"
  xsl_stmt    : "<xsl:text>SNMP Community String : </xsl:text> <xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-comm-string\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP Community String : (v2) Not Enabled</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSS|2.2.3"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the community string form box. Ensure that the community string is not 'private'."
  regex       : "^SNMP[\s]Community[\s]String[\s]:[\s]"
  not_expect  : "^SNMP[\s]Community[\s]String[\s]:[\s]private$"
</custom_item>

<custom_item>
  description : "WatchGuard : SNMP Configuration - community string - 'public'"
  info        : "Ensure SNMP does not use an easy to guess or default community string - 'public'."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/snmp-conf/snmp-protocol[contains(snmp-version,'2')]\">"
  xsl_stmt    : "<xsl:text>SNMP Community String : </xsl:text> <xsl:value-of select=\"system-parameters/snmp-conf/snmp-protocol/snmp-comm-string\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>SNMP Community String : (v2) Not Enabled</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSS|2.2.3"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'SNMP' and then click the community string form box. Ensure that the community string is not 'public'."
  regex       : "^SNMP[\s]Community[\s]String[\s]:[\s]"
  not_expect  : "^SNMP[\s]Community[\s]String[\s]:[\s]public$"
</custom_item>

#Logging

<custom_item>
  description : "WatchGuard : Logging - Remote Logging Enabled"
  info        : "Verify the device is configured to submit system logs to one or more syslog servers to centrally record system events."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf/remote-logging[contains(enabled,'1')]\">"
  xsl_stmt    : "<xsl:text>Remote Logging Enabled : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Remote Logging Enabled : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.8,800-53|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Logging' and then click the 'Send log messages to the syslog server at this IP address' check box."
  regex       : "^Remote[\s]Logging[\s]Enabled[\s]:[\s]"
  expect      : "^Remote[\s]Logging[\s]Enabled[\s]:[\s]TRUE$"
</custom_item>

<custom_item>
  description : "WatchGuard : Logging - Syslog Timestamps"
  info        : "Ensuring that Syslog Timestamps are used allows for accurate log/audit file correlation."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf/remote-logging/remote-logging-list/logging-entry[contains(format, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf/remote-logging/remote-logging-list/logging-entry/syslog[contains(timestamp,'1')]\">"
  xsl_stmt    : "<xsl:text>Syslog Timestamps Enabled : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Syslog Timestamps Enabled : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Syslog Timestamps Enabled : Syslog Not Enabled</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.7,800-53|AU-8,CN-L3|8.1.4.3(b),CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ITSG-33|AU-8,NESA|T3.6.2,NESA|T3.6.7,TBA-FIISB|37.4"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Logging' and then click the 'The time stamp' checkbox under the 'Select the details to include in syslog messages' check box."
  regex       : "^Syslog[\s]Timestamps[\s]Enabled[\s]:[\s]"
  expect      : "^Syslog[\s]Timestamps[\s]Enabled[\s]:[\s]TRUE$"
</custom_item>

<custom_item>
  description : "WatchGuard : Logging - Configuration Changes are Logged"
  info        : "Verify that Configuration Changes are Logged."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf[contains(config-change-log-enable,'1')]\">"
  xsl_stmt    : "<xsl:text>Configuration Change Logging Enabled : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Configuration Change Logging Enabled : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Logging' and then click the 'Send log messages when the configuration for this Firebox is changed' checkbox under the 'Settings' section."
  regex       : "^Configuration[\s]Change[\s]Logging[\s]Enabled[\s]:[\s]"
  expect      : "^Configuration[\s]Change[\s]Logging[\s]Enabled[\s]:[\s]TRUE$"
</custom_item>

<custom_item>
  description : "WatchGuard : Logging - IKE Packet Tracing"
  info        : "Logging - IKE Packet Tracing"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf[contains(ike-decryp-pkt-trace,'1')]\">"
  xsl_stmt    : "<xsl:text>IKE Packet Trace Enabled : TRUE</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IKE Packet Trace Enabled : FALSE</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Logging' and then click the 'Enable IKE packet tracing to Firebox internal storage' checkbox under the 'Settings' section."
  regex       : "^IKE[\s]Packet[\s]Trace[\s]Enabled[\s]:[\s]"
  expect      : "^IKE[\s]Packet[\s]Trace[\s]Enabled[\s]:[\s]TRUE$"
</custom_item>

<custom_item>
  description : "WatchGuard : Logging - Review Remote Logging Server Address"
  info        : "Verify the device is configured to submit system logs to one or more syslog servers to centrally record system events."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/log-conf/remote-logging[contains(enabled,'1')]\">"
  xsl_stmt    : "<xsl:text>Remote Logging Server Address : </xsl:text> <xsl:value-of select=\"system-parameters/log-conf/remote-logging/remote-logging-list/logging-entry/server-ip\"/>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Remote Logging Server Address : REMOTE LOGGING NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.8,800-53|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,HIPAA|164.308(a)(1)(ii)(D),ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4"
  solution    : "In the Web UI , navigate to the 'System' section , click on 'Logging' and then review the syslog IP address"
  regex       : "Remote Logging Server Address :"
# Note: Variable @LOG_SERV@ replaced with "1\\.1\\.1\\.1" in field "expect".
  expect      : "Remote Logging Server Address : 1\\.1\\.1\\.1"
</custom_item>

#AUTH

<custom_item>
  description : "WatchGuard : Authentication Settings - 'Authentication User Timeout'"
  info        : "Set a timeout to avoid the possibility of an user walking away from the management computer and leaving it exposed to unauthorized personnel - 'Authentication User Timeout'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Authentication User Timeout : </xsl:text> <xsl:value-of select=\"system-parameters/auth-global-setting/auth-user-timeout\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|2.2.3,SANS-CSC|16"
  solution    : "In the Web UI , navigate to the 'Authentication' section , click on 'settings' and then fill out the 'idle Timeout' form field under the 'Firewall Authentication' section."
  regex       : "^Authentication[\s]User[\s]Timeout[\s]:[\s]"
# Note: Variable @AUTH_USR_TO@ replaced with "7200" in field "expect".
  expect      : "^Authentication[\s]User[\s]Timeout[\s]:[\s]7200"
</custom_item>

<custom_item>
  description : "WatchGuard : Authentication Settings - 'Authentication User Session Timeout'"
  info        : "Set a timeout to avoid the possibility of an user walking away from the management computer and leaving it exposed to unauthorized personnel - 'Authentication User Session Timeout'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Authentication User Session Timeout : </xsl:text> <xsl:value-of select=\"system-parameters/auth-global-setting/auth-user-session-timeout\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|2.2.3,SANS-CSC|16"
  solution    : "In the Web UI , navigate to the 'Authentication' section , click on 'settings' and then fill out the 'Session Timeout' form field under the 'Firewall Authentication' section."
  regex       : "^Authentication[\s]User[\s]Session[\s]Timeout[\s]:[\s]"
# Note: Variable @AUTH_USR_SESS_TO@ replaced with "36000" in field "expect".
  expect      : "^Authentication[\s]User[\s]Session[\s]Timeout[\s]:[\s]36000"
</custom_item>

<custom_item>
  description : "WatchGuard : Authentication Settings - 'Management User Idle Timeout'"
  info        : "Set a timeout to avoid the possibility of an user walking away from the management computer and leaving it exposed to unauthorized personnel - 'Management User Idle Timeout'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Management User Idle Timeout : </xsl:text> <xsl:value-of select=\"system-parameters/auth-global-setting/mgmt-user-idle-timeout\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|2.2.3,SANS-CSC|16"
  solution    : "In the Web UI , navigate to the 'Authentication' section , click on 'settings' and then fill out the 'Idle Timeout' form field under the 'Management Session' section."
  regex       : "^Management[\s]User[\s]Idle[\s]Timeout[\s]:[\s]"
# Note: Variable @MGMT_USR_IDL_TO@ replaced with "900" in field "expect".
  expect      : "^Management[\s]User[\s]Idle[\s]Timeout[\s]:[\s]900"
</custom_item>

<custom_item>
  description : "WatchGuard : Authentication Settings - 'Management User Session Timeout'"
  info        : "Set a timeout to avoid the possibility of an user walking away from the management computer and leaving it exposed to unauthorized personnel - 'Management User Session Timeout'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>Management User Session Timeout : </xsl:text> <xsl:value-of select=\"system-parameters/auth-global-setting/mgmt-user-session-timeout\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.11,800-53|AC-12,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|2.2.3,SANS-CSC|16"
  solution    : "In the Web UI , navigate to the 'Authentication' section , click on 'settings' and then fill out the 'Session Timeout' form field under the 'Management Session' section."
  regex       : "^Management[\s]User[\s]Session[\s]Timeout[\s]:[\s]"
# Note: Variable @MGMT_USR_SESS_TO@ replaced with "36000" in field "expect".
  expect      : "^Management[\s]User[\s]Session[\s]Timeout[\s]:[\s]36000"
</custom_item>

#SSO

<custom_item>
  description : "WatchGuard : Single Sign-On - 'Enabled'"
  info        : "When used properly, SSO can increase security by allowing for the use of more complex authentication policies. Single-Sign On - 'Enabled'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/single-sign-on[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:text>Single Sign On : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>Single Sign On : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-53|IA-2(10),CSF|PR.AC-1,HIPAA|164.312(a)(2)(iii),PCI-DSS|2.2.3,SANS-CSC|16"
  solution    : "In the Web UI , navigate to the 'Authentication' section , click on 'Single Sign-On' and then check the 'Enable Single Sign-On (SSO) with Active Directory' checkbox."
  regex       : "^Single[\s]Sign[\s]On[\s]:[\s]"
# Note: Variable @SSO_ENABLE@ replaced with "ENABLED" in field "expect".
  expect      : "^Single[\s]Sign[\s]On[\s]:[\s]ENABLED"
</custom_item>

#IPS

<custom_item>
  description : "WatchGuard : IPS - 'Enabled'"
  info        : "IPS - 'Enabled'"
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:text>IPS : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.7,800-53|SI-4(1),CN-L3|8.1.4.4(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,ITSG-33|SI-4(1),NIAv2|NS5i,SANS-CSC|10,SWIFT-CSCv1|6.5,TBA-FIISB|45.2.6"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS' and then click the check box for 'Enable Intrusion Prevention'."
  regex       : "^IPS[\s]:[\s]"
# Note: Variable @SSO_ENABLE@ replaced with "ENABLED" in field "expect".
  expect      : "^IPS[\s]:[\s]ENABLED"
</custom_item>

#signature updates

<custom_item>
  description : "WatchGuard : IPS Signature Update - 'Enabled'"
  info        : "Verify the device is configured to keep IDS signatures up to date."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"signature-update/services[contains(IPS, 'true')]\">"
  xsl_stmt    : "<xsl:text>IPS Signature Update : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Signature Update : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),SANS-CSC|10,SWIFT-CSCv1|2.2,TBA-FIISB|49.4"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Update Server' tab and then click the check box for 'Enable automatic update'."
  regex       : "^IPS[\s]Signature[\s]Update[\s]:[\s]"
  expect      : "^IPS[\s]Signature[\s]Update[\s]:[\s]ENABLED"
</custom_item>

<custom_item>
  description : "WatchGuard : Gateway AntiVirus - 'Enabled'"
  info        : "Verify the device is configured to keep GAV signatures up to date."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"signature-update/services[contains(GAV, 'true')]\">"
  xsl_stmt    : "<xsl:text>GAV Signature Update : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>GAV Signature Update : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.2,800-171|3.14.4,800-53|SI-3(2),CN-L3|7.1.3.6(a),CSF|DE.CM-4,ITSG-33|SI-3(2),SANS-CSC|10,SANS-CSC|5,SWIFT-CSCv1|2.2,TBA-FIISB|49.4"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'Gateway AntiVirus', click the 'Settings' button and then click the check box for 'Enable automatic update'."
  regex       : "^GAV[\s]Signature[\s]Update[\s]:[\s]"
  expect      : "^GAV[\s]Signature[\s]Update[\s]:[\s]ENABLED"
</custom_item>

<custom_item>
  description : "WatchGuard : Data Loss Prevention Signature Update - 'Enabled'"
  info        : "Verify the device is configured to keep DLP signatures up to date."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"signature-update/services[contains(DLP, 'true')]\">"
  xsl_stmt    : "<xsl:text>DLP Signature Update : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>DLP Signature Update : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.13.1,800-171|3.14.1,800-53|SC-7(10),800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|DE.CM-1,CSF|ID.RA-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.IP-12,CSF|PR.PT-4,ITSG-33|SC-7(10),ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,SANS-CSC|10,SWIFT-CSCv1|2.2,TBA-FIISB|33.1"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'Data Loss Prevention', click the 'Settings' button and then click the check box for 'Enable automatic update'."
  regex       : "^DLP[\s]Signature[\s]Update[\s]:[\s]"
  expect      : "^DLP[\s]Signature[\s]Update[\s]:[\s]ENABLED"
</custom_item>

<custom_item>
  description : "WatchGuard : Review ABS Policy Listing"
  info        : "Review ABS Policy Listing

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:text>ABS Policy Listing : \n</xsl:text>"
  xsl_stmt    : "<xsl:for-each select=\"abs-policy-list/abs-policy\"><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>\nName : </xsl:text><xsl:value-of select=\"name\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Service : </xsl:text><xsl:value-of select=\"service\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Description : </xsl:text><xsl:value-of select=\"description\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Type : </xsl:text><xsl:value-of select=\"type\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Enabled : </xsl:text><xsl:value-of select=\"enabled\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Firewall : </xsl:text><xsl:value-of select=\"firewall\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Reject Action : </xsl:text><xsl:value-of select=\"reject-action\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>Traffic Type : </xsl:text><xsl:value-of select=\"type\"/><xsl:text>\n</xsl:text>"
  xsl_stmt    : "<xsl:text>\n\n</xsl:text>"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.1.3,800-53|AC-4(8),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|AC-4(8),NIAv2|GS10a,NIAv2|GS10d,NIAv2|NS12a,NIAv2|NS12b,NIAv2|NS12c,PCI-DSS|2.2.3,SANS-CSC|19"
  expect      : ".*"
  severity    : MEDIUM
</custom_item>

#IPS Logging/Threat Level Action

<custom_item>
  description : "WatchGuard : IPS Logging Threat Level Critical - Enabled"
  info        : "Verify IPS items classified as threat level 'critical' are logged."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/critical[contains(log, '1')]\">"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Critical : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Critical : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Critical : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|1.1,SANS-CSC|10,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the check box for Threat level 'Critical' -> 'Log'."
  regex       : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]Critical[\s]:[\s]"
  expect      : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]Critical[\s]:[\s](ENABLED|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

<custom_item>
  description : "WatchGuard : IPS Logging Threat Level HIGH - Enabled"
  info        : "Verify IPS items classified as threat level 'high' are logged."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/high[contains(log, '1')]\">"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level High : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level High : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level High : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|1.1,SANS-CSC|10,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the check box for Threat level 'High' -> 'Log'."
  regex       : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]High[\s]:[\s]"
  expect      : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]High[\s]:[\s](ENABLED|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

<custom_item>
  description : "WatchGuard : IPS Logging Threat Level Medium - Enabled"
  info        : "Verify IPS items classified as threat level 'medium' are logged."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/medium[contains(log, '1')]\">"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Medium : ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Medium : DISABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Logging Threat Level Medium : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|1.1,SANS-CSC|10,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the check box for Threat level 'Medium' -> 'Log'."
  regex       : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]Medium[\s]:[\s]"
  expect      : "^IPS[\s]Logging[\s]Threat[\s]Level[\s]Medium[\s]:[\s](ENABLED|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

#threat level action

<custom_item>
  description : "WatchGuard : IPS Threat Level Action Critical - DROP or BLOCK"
  info        : "Verify IPS items classified as threat level 'critical' are set to DROP or BLOCK."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/critical[contains(action, 'Block') or contains(action, 'Drop')]\">"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Critical : DROP or BLOCK</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Critical : ALLOW</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Critical : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,PCI-DSS|1.1,SANS-CSC|10"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the drop down box for Threat level 'Critical' -> 'Action' to 'Drop' or 'Block'."
  regex       : "^IPS[\s]Threat[\s]Level[\s]Action[\s]Critical[\s]:[\s]"
  expect      : "^IPS[\s]Threat[\s]Level[\s]Action[\s]Critical[\s]:[\s](DROP[\s]or[\s]BLOCK|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

<custom_item>
  description : "WatchGuard : IPS Threat Level Action High - DROP or BLOCK"
  info        : "Verify IPS items classified as threat level 'high' are set to DROP or BLOCK."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/high[contains(action, 'Block') or contains(action, 'Drop')]\">"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action High : DROP or BLOCK</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action High : ALLOW</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action High : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,PCI-DSS|1.1,SANS-CSC|10"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the drop down box for Threat level 'High' -> 'Action' to 'Drop' or 'Block'."
  regex       : "^IPS[\s]Threat[\s]Level[\s]Action[\s]High[\s]:[\s]"
  expect      : "^IPS[\s]Threat[\s]Level[\s]Action[\s]High[\s]:[\s](DROP[\s]or[\s]BLOCK|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

<custom_item>
  description : "WatchGuard : IPS Threat Level Action Medium - DROP or BLOCK"
  info        : "Verify IPS items classified as threat level 'medium' are set to DROP or BLOCK."
  xsl_stmt    : "<xsl:template match=\"profile\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips[contains(enabled, '1')]\">"
  xsl_stmt    : "<xsl:choose>"
  xsl_stmt    : "<xsl:when test=\"system-parameters/ips/threat-level/medium[contains(action, 'Block') or contains(action, 'Drop')]\">"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Medium : DROP or BLOCK</xsl:text>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Medium : ALLOW</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:when>"
  xsl_stmt    : "<xsl:otherwise>"
  xsl_stmt    : "<xsl:text>IPS Threat Level Action Medium : NOT APPLICABLE IPS NOT ENABLED</xsl:text>"
  xsl_stmt    : "</xsl:otherwise>"
  xsl_stmt    : "</xsl:choose>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-171|3.14.6,800-171|3.14.7,800-53|SI-4,CN-L3|7.1.3.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.10.6(f),CSF|DE.AE-1,CSF|DE.AE-2,CSF|DE.AE-3,CSF|DE.AE-4,CSF|DE.CM-1,CSF|DE.CM-5,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|DE.DP-3,CSF|DE.DP-4,CSF|DE.DP-5,CSF|ID.RA-1,CSF|PR.DS-5,CSF|PR.IP-8,CSF|RS.AN-1,CSF|RS.CO-3,ITSG-33|SI-4,NESA|M1.2.2,PCI-DSS|1.1,SANS-CSC|10"
  solution    : "In the Web UI , navigate to the 'Subscription Services' section , click on 'IPS', click the 'Settings' button and then click the drop down box for Threat level 'Medium' -> 'Action' to 'Drop' or 'Block'."
  regex       : "^IPS[\s]Threat[\s]Level[\s]Action[\s]Medium[\s]:[\s]"
  expect      : "^IPS[\s]Threat[\s]Level[\s]Action[\s]Medium[\s]:[\s](DROP[\s]or[\s]BLOCK|NOT[\s]APPLICABLE[\s]IPS[\s]NOT[\s]ENABLED)"
</custom_item>

</check_type>
