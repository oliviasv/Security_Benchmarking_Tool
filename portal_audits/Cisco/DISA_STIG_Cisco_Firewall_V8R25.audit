#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.4 $
# $Date: 2020/04/15 $
#
# Description   : This .audit is designed against the DISA Firewall Security
#                 Technical Implementation Guide - Cisco Version 8 Release 25.
#                 https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip
#
#<ui_metadata>
#<display_name>DISA STIG Cisco Firewall v8r25</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Cisco Firewall</name>
#  <version>8.25.0</version>
#  <link>https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip</link>
#</spec>
#<labels>cisco,disa,firewall</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>BANNER_LOGIN</name>
#    <default>I've read & consent to terms in IS user agreem't.</default>
#    <description>Banner Login config</description>
#    <info>The banner displayed from the 'banner login' configuration.</info>
#  </variable>
#  <variable>
#    <name>Inside_Interface</name>
#    <default>Vlan1</default>
#    <description>Inside_Interface</description>
#    <info>This is the inside interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>NAMEIF_Inside</name>
#    <default>inside</default>
#    <description>NAMEIF_Inside</description>
#    <info>This is the name of inside interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>Inside_Network</name>
#    <default>192.168.1.0 255.255.255.0</default>
#    <description>Inside_Network</description>
#    <info>This is the network IP address and subnet mask of the Inside interface for your organization.</info>
#  </variable>
#  <variable>
#    <name>Outside_Interface</name>
#    <default>Vlan2</default>
#    <description>Outside_Interface</description>
#    <info>This is the outside interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>NAMEIF_Outside</name>
#    <default>outside</default>
#    <description>NAMEIF_Outside</description>
#    <info>This is the name of outside interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>MGMT_Interface</name>
#    <default>Vlan3</default>
#    <description>MGMT_Interface</description>
#    <info>This is the out of bounds management interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>NAMEIF_Mgmt</name>
#    <default>mgmt</default>
#    <description>NAMEIF_Mgmt</description>
#    <info>This is the name of the out of bounds management interface for the device in your organization.</info>
#  </variable>
#  <variable>
#    <name>Inside_Access_In_ACL</name>
#    <default>inside_access_in</default>
#    <description>Inside_Access_In_ACL</description>
#    <info>This is the ACL applied to the Inside interface to inspect inbound traffic.</info>
#  </variable>
#  <variable>
#    <name>Inside_Access_Out_ACL</name>
#    <default>inside_access_out</default>
#    <description>Inside_Acc_Out_ACL</description>
#    <info>This is the ACL applied to the Inside interface to inspect outbound traffic.</info>
#  </variable>
#  <variable>
#    <name>Outside_Access_In_ACL</name>
#    <default>outside_access_in</default>
#    <description>Outside_Acc_In_ACL</description>
#    <info>This is the ACL applied to the Outside interface to inspect inbound traffic.</info>
#  </variable>
#  <variable>
#    <name>Outside_Access_Out_ACL</name>
#    <default>outside_access_out</default>
#    <description>Outside_Acc_Out_ACL</description>
#    <info>This is the ACL applied to the Outside interface to inspect outbound traffic.</info>
#  </variable>
#  <variable>
#    <name>MGMT_Access_In_ACL</name>
#    <default>mgmt_access_in</default>
#    <description>MGMT_Access_In_ACL</description>
#    <info>This is the ACL applied to the Management interface to inspect inbound traffic.</info>
#  </variable>
#  <variable>
#    <name>MGMT_Access_Out_ACL</name>
#    <default>mgmt_access_out</default>
#    <description>MGMT_Access_Out_ACL</description>
#    <info>This is the ACL applied to the Management interface to inspect outbound traffic.</info>
#  </variable>
#  <variable>
#    <name>Syslog_Server</name>
#    <default>172.26.22.170</default>
#    <description>Syslog_Server</description>
#    <info>This is the IP address for the off device syslog storage server for your organization.</info>
#  </variable>
#  <variable>
#    <name>Loopback_Address</name>
#    <default>127.0.0.0 255.0.0.0</default>
#    <description>IPv4 Loopback Addr</description>
#    <info>This is the IP loopback address range as defined by IANA.</info>
#  </variable>
#  <variable>
#    <name>AAA_Server_Group</name>
#    <default>AAA-Test</default>
#    <description>AAA Server Group</description>
#    <info>This is the configured server group name defining AAA services in your organization.</info>
#  </variable>
#  <variable>
#    <name>AAA_Server_1</name>
#    <default>10.0.0.10</default>
#    <description>AAA_Server_1</description>
#    <info>This is the first configured AAA server for your organization.</info>
#  </variable>
#  <variable>
#    <name>AAA_Server_2</name>
#    <default>10.0.0.11</default>
#    <description>AAA_Server_2</description>
#    <info>This is the second configured AAA server for your organization.</info>
#  </variable>
#  <variable>
#    <name>Emergency_Account</name>
#    <default>admin</default>
#    <description>Emergency_Account</description>
#    <info>This is the name of the single account created on your device for emergency purposes when utilizing AAA services.</info>
#  </variable>
#  <variable>
#    <name>NTP_Server_1</name>
#    <default>10.0.0.1</default>
#    <description>NTP_Server_1</description>
#    <info>This is the IP address of the 1st NTP server utilized by your organization.</info>
#  </variable>
#  <variable>
#    <name>NTP_Server_2</name>
#    <default>10.0.0.2</default>
#    <description>NTP_Server_2</description>
#    <info>This is the IP address of the 2nd NTP server utilized by your organization.</info>
#  </variable>
#  <variable>
#    <name>NTP_Auth_Key</name>
#    <default>1</default>
#    <description>NTP_Auth_Key</description>
#    <info>This is the number of the NTP authentication-key utilized in your organization.</info>
#  </variable>
#  <variable>
#    <name>DNS_Server_1</name>
#    <default>8.8.8.8</default>
#    <description>DNS_Server_1</description>
#    <info>This is the IP address of the 1st DNS name-server utilized in your organization.</info>
#  </variable>
#  <variable>
#    <name>DNS_Server_2</name>
#    <default>8.8.4.4</default>
#    <description>DNS_Server_2</description>
#    <info>This is the IP address of the 2nd DNS name-server utilized in your organization.</info>
#  </variable>
#  <variable>
#    <name>DNS_Server_Group</name>
#    <default>DefaultDNS</default>
#    <description>DNS_Server_Group</description>
#    <info>This is the name of the DNS server-group utilized in your organization.</info>
#  </variable>
#  <variable>
#    <name>SNMP_Host_IP</name>
#    <default>10.0.0.3</default>
#    <description>SNMP_Host_IP</description>
#    <info>The IP address for an authorized SNMP host from with your management network range.</info>
#  </variable>
#  <variable>
#    <name>Class_Map</name>
#    <default>CONNS</default>
#    <description>Class_Map</description>
#    <info>This is the class map name used for the TCP timeout policy in your organization.</info>
#  </variable>
#  <variable>
#    <name>Policy_Map</name>
#    <default>CONNS</default>
#    <description>Policy_Map</description>
#    <info>This is the policy map name used for the TCP timeout policy in your organization.</info>
#  </variable>
#  <variable>
#    <name>Service_Policy_TCP</name>
#    <default>CONNS</default>
#    <description>Service_Policy_TCP</description>
#    <info>This is the service policy name used for the TCP timeout policy in your organization.</info>
#  </variable>
#  <variable>
#    <name>Crypto_Map_Name</name>
#    <default>oobm_crypto</default>
#    <description>Crypto_Map_Name</description>
#    <info>This is the crypto map utilized to build the IPSec site-to-site VPN for securing OOBM management traffic.</info>
#  </variable>
#  <variable>
#    <name>IPSec_ACL</name>
#    <default>125</default>
#    <description>IPSec_ACL</description>
#    <info>This is the ACL used by the IPSec site-to-site VPN to restrict access to and from the tunnel for OOBM management traffic.</info>
#  </variable>
#  <variable>
#    <name>OOBM_IP_Subnet</name>
#    <default>172.26.0.16 255.255.252.0</default>
#    <description>OOBM_IP_Subnet</description>
#    <info>The management interface IP address and subnet mask from your organization's managed network address space.</info>
#  </variable>
#  <variable>
#    <name>OOBM_Network</name>
#    <default>172.26.0.0 255.255.252.0</default>
#    <description>OOBM_Network</description>
#    <info>The management network IP address and subnet mask from your organization's managed network address space.</info>
#  </variable>
#  <variable>
#    <name>OOBM_Mgmt_Network</name>
#    <default>172.16.0.0 255.240.0.0</default>
#    <description>OOBM_Mgmt_Network</description>
#    <info>The network address and subnet for the authorized network range from which the device is being managed.</info>
#  </variable>
#  <variable>
#    <name>Inside_Next_Hop</name>
#    <default>192.168.1.1</default>
#    <description>Inside_Next_Hop</description>
#    <info>The IP address of the next-hop router associated with the Inside interface.</info>
#  </variable>
#  <variable>
#    <name>SNMP_V3_Group</name>
#    <default>testgroup</default>
#    <description>SNMP_V3_Group</description>
#    <info>This is the name for the SNMP V3 group used on your device.</info>
#  </variable>
#  <variable>
#    <name>Transform_Name</name>
#    <default>Test-Transform</default>
#    <description>Transform_Name</description>
#    <info>This is the name of the transform-set used in your organization's IPSec tunnel for OOBM management traffic.</info>
#  </variable>
#  <variable>
#    <name>SSH_ALGORITHM_MAC</name>
#    <default>hmac-sha1 hmac-sha1-96</default>
#    <description>SSH Algorithm MAC</description>
#    <info>The list of SSH algorithm MAC types</info>
#  </variable>
#  <variable>
#    <name>SSH_ALGORITHM_ENCRYPTION</name>
#    <default>aes128-cbc aes192-cbc aes256-cbc</default>
#    <description>SSH Algorithm Encryption</description>
#    <info>The list of SSH algorithm encryption types</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-004 - Router advertisements must be suppressed on all external-facing IPv6-enabled interfaces."
  info        : "Many of the known attacks in stateless autoconfiguration are defined in RFC 3756 were present in IPv4 ARP attacks. IPSec AH was originally suggested as mitigation for the link local attacks, but has since been found to have bootstrapping problems and to be very administrative intensive. Due to first requiring an IP address in order to set up the IPSec security association creates the chicken-before-the-egg dilemma. There are solutions being developed (Secure Neighbor Discovery and Cryptographic Generated Addressing) to secure these threats but are not currently available at the time of this writing.

To mitigate these vulnerabilities, links that have no hosts connected such as the interface connecting to external gateways will be configured to suppress router advertisements.

Disable (or do not configure) all IPv6 Neighbor Discovery functions across tunnels including the Neighbor Unreachability Detection (NUD) function.  Note: this is applicable only when the inner IP layer is IPv6 since IPv4 does not have the Neighbor Discovery functionality.

falseInformation Assurance Officer"
  solution    : "Configure the network device to enable route advertisement suppression on all external facing have IPv6 enabled on the interface."
  reference   : "800-171|3.13.1,800-53|SC-7(16),CAT|II,CSF|PR.PT-4,ITSG-33|SC-7(16),NIAv2|GS8d,PCI-DSSv3.2|1.3.7,Rule-ID|SV-15262r3_rule,STIG-ID|NET-IPV6-004,Vuln-ID|V-14637"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Interface@ replaced with "Vlan2" in field "context".
  context     : "interface Vlan2"
  item        : "ipv6 nd suppress-ra"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-005 - IPV6 firewall does not meet DITO requirements"
# Note: Variable @Outside_Interface@ replaced with "Vlan2" in field "context".
      context     : "interface Vlan2"
      item        : "ipv6 address"
    </item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "NET-IPV6-005 - The IAO must ensure firewalls deployed in an IPv6 enclave meet the requirements defined by DITO and NSA milestone objective 3"
      info        : "The IAO must ensure firewalls deployed in an IPv6 enclave meet the requirements defined by DITO and NSA milestone objective 3 guidance.

1) Drop IPv6 Undetectable protocol/port (May be an intrinsic FW feature.) - IPv6 allows an unlimited number of extension headers to be applied to a packet. A FW may not be able to locate the layer 4 protocol and port values if too many extension headers exhaust its resources. As a minimum, a FW must be able to drop any packet for which it cannot identify the layer 4 protocol and ports (if applicable). The security policy would be subverted if these packets were allowed to pass through a FW. If the FW cannot traverse through extension headers at all, it must drop packets using any extension header. This measure will disable a large amount of IPv6's functionality and should only be used if the Primary guidance cannot be implemented.
2) Drop IPv6 Type 0 Routing Header - The IPv6 Type 0 Routing Header (extension header) is functionally equivalent to the IPv4 loose source routing header option, which is typically blocked for security reasons.  The Type 0 Routing Header is dangerous because it allows attackers to spoof source addresses and get traffic in response (rather than to the real owner of the address). Secondly, a packet with an allowed destination address could be sent through a FW only to bounce to a different (disallowed) node once inside using the Routing Header functionality.  If the Type 0 Routing Header must be used, it must be used in conjunction with either the IPSec AH or the IPSec Encapsulation Security Payload (ESP) headers.  If the FW cannot distinguish the type field of a routing header, it should be configured to drop all routing headers. Note that Mobile IP is disabled without the Type 2 Routing Header.  Although deprecated by a recent RFC, there may be existing implementations that still recognize this header.
3) Drop Undefined IPv6 Header Extensions/Protocol Values (May be an intrinsic FW feature.) - Undefined IPv6 header extensions means that the Next Header type is not registered with Internet Assigned Numbers Authority (IANA).  The header extension is the same as the protocol value, and should be dropped.  Drop all undefined extension headers/protocol values.
4) Drop at least one fragment of any inbound fragmented packet for which the complete data set for filtering to include protocol/port values cannot be determined.(May be an intrinsic FW feature) - A FW must be able to properly enforce its filtering policy upon fragmented packets. This requires that the FW be able to find the complete set of header data including extension headers and the upper layer protocol/port values. It also requires that the packet not be susceptible to fragment overlap attacks. Fragment overlaps are a more serious problem in IPv6 than in IPv4 because the presence of extension headers can push the upper layer protocol/port information outward (toward packet boundaries) making it much harder to protect. How a FW achieves these requirements is not important as long as both aspects are met.  The wording 'drop at least one fragment' used in the actions below is a statement of the bare minimum action to secure a packet, and is chosen to allow FW venders flexibility in achieving it.  Refer to Firewall Design Considerations for IPv6 section 3.6 for extensive detail on this topic. https://www.us.army.mil/suite/doc/10209656
5) Drop all inbound IPv6 packets containing more than one Fragmentation Header within an IP header chain. (May be an intrinsic FW feature) - Nested fragmentation is an unnecessary and unwanted IPv6 condition that is not forbidden by the specifications. It occurs when an IP header chain contains more than one Fragmentation Header implying that a fragment has been fragmented. In the specification, the phrase 'IP header chain' rather than 'packet' is used, because a tunneled packet has more than one IP header chain and each chain can have a Fragment Header (this case is not nested fragmentation).  Nested fragmentation is a new phenomenon with IPv6. It is not possible in IPv4, because the fragmentation fields are part of the main header and are modified in the event of a secondary fragmentation event.  Nested fragmentation in IPv6 should be dropped by FWs since internal nodes that process the fragmentation may or may not be equipped to handle this unexpected case.  These nodes may crash or behave in some unpredictable manner.

NOTE: This check requires a manual review.  Ensure your device is capable of enforcing the the requirements defined by DITO and NSA milestone objective 3 guidance.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Identify the firewall capabilities to ensure they support the DITO requirements prior to procurement. Review current alternatives defined in the MO3 guidance for mitigation."
      reference   : "8500.2|DCDS-1,8500.2|EBBD-1,CAT|II,Rule-ID|SV-40424r1_rule,STIG-ID|NET-IPV6-005,Vuln-ID|V-30638"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET-IPV6-005 - The IAO must ensure firewalls deployed in an IPv6 enclave meet the requirements defined by DITO and NSA milestone objective 3"
      info        : "The IAO must ensure firewalls deployed in an IPv6 enclave meet the requirements defined by DITO and NSA milestone objective 3 guidance.

1) Drop IPv6 Undetectable protocol/port (May be an intrinsic FW feature.) - IPv6 allows an unlimited number of extension headers to be applied to a packet. A FW may not be able to locate the layer 4 protocol and port values if too many extension headers exhaust its resources. As a minimum, a FW must be able to drop any packet for which it cannot identify the layer 4 protocol and ports (if applicable). The security policy would be subverted if these packets were allowed to pass through a FW. If the FW cannot traverse through extension headers at all, it must drop packets using any extension header. This measure will disable a large amount of IPv6's functionality and should only be used if the Primary guidance cannot be implemented.
2) Drop IPv6 Type 0 Routing Header - The IPv6 Type 0 Routing Header (extension header) is functionally equivalent to the IPv4 loose source routing header option, which is typically blocked for security reasons.  The Type 0 Routing Header is dangerous because it allows attackers to spoof source addresses and get traffic in response (rather than to the real owner of the address). Secondly, a packet with an allowed destination address could be sent through a FW only to bounce to a different (disallowed) node once inside using the Routing Header functionality.  If the Type 0 Routing Header must be used, it must be used in conjunction with either the IPSec AH or the IPSec Encapsulation Security Payload (ESP) headers.  If the FW cannot distinguish the type field of a routing header, it should be configured to drop all routing headers. Note that Mobile IP is disabled without the Type 2 Routing Header.  Although deprecated by a recent RFC, there may be existing implementations that still recognize this header.
3) Drop Undefined IPv6 Header Extensions/Protocol Values (May be an intrinsic FW feature.) - Undefined IPv6 header extensions means that the Next Header type is not registered with Internet Assigned Numbers Authority (IANA).  The header extension is the same as the protocol value, and should be dropped.  Drop all undefined extension headers/protocol values.
4) Drop at least one fragment of any inbound fragmented packet for which the complete data set for filtering to include protocol/port values cannot be determined.(May be an intrinsic FW feature) - A FW must be able to properly enforce its filtering policy upon fragmented packets. This requires that the FW be able to find the complete set of header data including extension headers and the upper layer protocol/port values. It also requires that the packet not be susceptible to fragment overlap attacks. Fragment overlaps are a more serious problem in IPv6 than in IPv4 because the presence of extension headers can push the upper layer protocol/port information outward (toward packet boundaries) making it much harder to protect. How a FW achieves these requirements is not important as long as both aspects are met.  The wording 'drop at least one fragment' used in the actions below is a statement of the bare minimum action to secure a packet, and is chosen to allow FW venders flexibility in achieving it.  Refer to Firewall Design Considerations for IPv6 section 3.6 for extensive detail on this topic. https://www.us.army.mil/suite/doc/10209656
5) Drop all inbound IPv6 packets containing more than one Fragmentation Header within an IP header chain. (May be an intrinsic FW feature) - Nested fragmentation is an unnecessary and unwanted IPv6 condition that is not forbidden by the specifications. It occurs when an IP header chain contains more than one Fragmentation Header implying that a fragment has been fragmented. In the specification, the phrase 'IP header chain' rather than 'packet' is used, because a tunneled packet has more than one IP header chain and each chain can have a Fragment Header (this case is not nested fragmentation).  Nested fragmentation is a new phenomenon with IPv6. It is not possible in IPv4, because the fragmentation fields are part of the main header and are modified in the event of a secondary fragmentation event.  Nested fragmentation in IPv6 should be dropped by FWs since internal nodes that process the fragmentation may or may not be equipped to handle this unexpected case.  These nodes may crash or behave in some unpredictable manner.

NOTE: Nessus did not detect IPv6 on the Outside interface so this check is not applicable."
      solution    : "Identify the firewall capabilities to ensure they support the DITO requirements prior to procurement. Review current alternatives defined in the MO3 guidance for mitigation."
      reference   : "8500.2|DCDS-1,8500.2|EBBD-1,CAT|II,Rule-ID|SV-40424r1_rule,STIG-ID|NET-IPV6-005,Vuln-ID|V-30638"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-024 - IPv6 6-to-4 addresses are not filtered"
# Note: Variable @Outside_Interface@ replaced with "Vlan2" in field "context".
      context     : "interface Vlan2"
      item        : "ipv6 address"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-024 - IPv6 6-to-4 addresses with a prefix of 2002::/16 must be filtered at the perimeter. - 2002 inbound"
      info        : "'6-to-4' is a tunneling IPv6 transition mechanism [RFC 3056]. The guidance is the default case, which assumes that 6-to-4 is not being used as an IPv6 transition mechanism. If 6-to-4 is implemented, reference addition 6-to-4 guidance defined in the STIG.

Drop all inbound IPv6 packets containing a source address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

Drop all inbound IPv6 packets containing a destination address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used."
      solution    : "Configure the device using filters to restrict IP addresses that contain any 6-to-4 addresses."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20160r2_rule,STIG-ID|NET-IPV6-024,Vuln-ID|V-18608"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_In_ACL@ replaced with "outside_access_in" in field "item".
      item        : "access-list outside_access_in extended deny ip 2002::/16 any log"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-024 - IPv6 6-to-4 addresses with a prefix of 2002::/16 must be filtered at the perimeter. - 2002 outbound"
      info        : "'6-to-4' is a tunneling IPv6 transition mechanism [RFC 3056]. The guidance is the default case, which assumes that 6-to-4 is not being used as an IPv6 transition mechanism. If 6-to-4 is implemented, reference addition 6-to-4 guidance defined in the STIG.

Drop all inbound IPv6 packets containing a source address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

Drop all inbound IPv6 packets containing a destination address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used."
      solution    : "Configure the device using filters to restrict IP addresses that contain any 6-to-4 addresses."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20160r2_rule,STIG-ID|NET-IPV6-024,Vuln-ID|V-18608"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_Out_ACL@ replaced with "outside_access_out" in field "item".
      item        : "access-list outside_access_out extended deny ip any 2002::/16 log"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET-IPV6-024 - IPv6 6-to-4 addresses with a prefix of 2002::/16 must be filtered at the perimeter. - 2002 inbound"
      info        : "'6-to-4' is a tunneling IPv6 transition mechanism [RFC 3056]. The guidance is the default case, which assumes that 6-to-4 is not being used as an IPv6 transition mechanism. If 6-to-4 is implemented, reference addition 6-to-4 guidance defined in the STIG.

Drop all inbound IPv6 packets containing a source address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

Drop all inbound IPv6 packets containing a destination address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

NOTE: Nessus did not detect IPv6 on the Outside interface so this check is not applicable."
      solution    : "Configure the device using filters to restrict IP addresses that contain any 6-to-4 addresses."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20160r2_rule,STIG-ID|NET-IPV6-024,Vuln-ID|V-18608"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET-IPV6-024 - IPv6 6-to-4 addresses with a prefix of 2002::/16 must be filtered at the perimeter. - 2002 outbound"
      info        : "'6-to-4' is a tunneling IPv6 transition mechanism [RFC 3056]. The guidance is the default case, which assumes that 6-to-4 is not being used as an IPv6 transition mechanism. If 6-to-4 is implemented, reference addition 6-to-4 guidance defined in the STIG.

Drop all inbound IPv6 packets containing a source address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

Drop all inbound IPv6 packets containing a destination address of type 2002::/16. This assumes the 6-to-4 transition mechanism is not being used.

NOTE: Nessus did not detect IPv6 on the Outside interface so this check is not applicable."
      solution    : "Configure the device using filters to restrict IP addresses that contain any 6-to-4 addresses."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20160r2_rule,STIG-ID|NET-IPV6-024,Vuln-ID|V-18608"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-IPV6-025 - The network device must be configured to ensure IPv6 Site Local Unicast addresses are not defined in the enclave"
  info        : "The network device must be configured to ensure IPv6 Site Local Unicast addresses are not defined in the enclave, (FEC0::/10). Note that this consist of all addresses that begin with FEC, FED, FEE and FEF.

As currently defined, site local addresses are ambiguous and can be present in multiple sites.  The address itself does not contain any indication of the site to which it belongs.  The use of site-local addresses has the potential to adversely affect network security through leaks, ambiguity and potential misrouting, as documented in section 2 of RFC3879.  RFC3879 formally deprecates the IPv6 site-local unicast prefix defined in RFC3513, i.e., 1111111011 binary or FEC0::/10."
  solution    : "Configure the device using authorized IP addresses."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15397r2_rule,STIG-ID|NET-IPV6-025,SWIFT-CSCv1|2.3,Vuln-ID|V-14693"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Interface@ replaced with "Vlan2" in field "context".
  context     : "interface Vlan2"
  item        : "ipv6 address (FEC|FED|FEE|FEF)::/10"
</item>

<report type:"WARNING">
  description : "NET-IPV6-035 - IPv6 Jumbo Payload hop by hop header must be blocked."
  info        : "The IPv6 Jumbo Payload allows IP packets to be larger than 65,535 bytes.  This feature is only useful on very specialized high performance systems (e.g. super computers).  Common place link layer technologies do not support these payload sizes and special link layer designs would be necessary.  This header should be dropped unless the system is specifically designed to use very large payloads, since it only serves as an opportunity to break implementations.

NOTE: This check requires a manual review.  Determine if your device and software version support IPv6 ACL Extensions for Hop by Hop Filtering. You may use the Cisco Feature Navigator for assistance.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the firewall to drop all inbound and/or outbound IPv6 packets containing a hop-by-hop option of option type 0xC2."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-20551r2_rule,STIG-ID|NET-IPV6-035,Vuln-ID|V-18815"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-047 - IPv4 Interfaces in NAT-PT receive IPv6"
# Note: Variable @Inside_Interface@ replaced with "Vlan1" in field "context".
      context     : "interface Vlan1"
      item        : "ipv6 address"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-047 - Interfaces supporting IPv4 in NAT-PT Architecture must not receive IPv6 traffic. - inside IPv6 block in"
      info        : "Network Address Translation with Protocol Translation (NAT-PT), defined in [RFC2766], is a service that can be used to translate data sent between IP-heterogeneous nodes. NAT-PT translates IPv4 datagrams into a semantically equivalent IPv6 datagram or vice versa. For this service to work it has to be located in the connection point between the IPv4 network and the IPv6 network. The PT-part of the NAT-PT handles the interpretation and translation of the semantically equivalent IP header, either from IPv4 to IPv6 or from IPv6 to IPv4. Like NAT, NATPT also uses a pool of addresses which it dynamically assigns to the translated datagrams.

The NAT-PT architecture is not one of the preferred DoD IPv6 transition paradigms due to the deprecation of NAT-PT within the DoD community. However, as described in the 'DoD IPv6 Guidance for Information Assurance (IA) Milestone Objective 3 (MO3) Requirements', some services/agencies may choose to implement this transition mechanism within an enclave. The following sub-sections provide guidelines for the use of NAT-PT within a controlled enclave.

In addition to the single point of failure, the reduced performance of an application level gateway, coupled with limitations on the kinds of applications that work, decreases the overall value and utility of the network. NAT-PT also inhibits the ability to deploy security at the IP layer."
      solution    : "This can be accomplished by not having IPv6 enabled on the interface supporting the IPv4 network. In addition a filter can be added to deny IPv6 at the interface."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16078r2_rule,STIG-ID|NET-IPV6-047,Vuln-ID|V-15296"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Inside_Access_In_ACL@ replaced with "inside_access_in" in field "item".
      item        : "access-list inside_access_in extended deny 41 any any log"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET-IPV6-047 - Interfaces supporting IPv4 in NAT-PT Architecture must not receive IPv6 traffic. - inside IPv6 block out"
      info        : "Network Address Translation with Protocol Translation (NAT-PT), defined in [RFC2766], is a service that can be used to translate data sent between IP-heterogeneous nodes. NAT-PT translates IPv4 datagrams into a semantically equivalent IPv6 datagram or vice versa. For this service to work it has to be located in the connection point between the IPv4 network and the IPv6 network. The PT-part of the NAT-PT handles the interpretation and translation of the semantically equivalent IP header, either from IPv4 to IPv6 or from IPv6 to IPv4. Like NAT, NATPT also uses a pool of addresses which it dynamically assigns to the translated datagrams.

The NAT-PT architecture is not one of the preferred DoD IPv6 transition paradigms due to the deprecation of NAT-PT within the DoD community. However, as described in the 'DoD IPv6 Guidance for Information Assurance (IA) Milestone Objective 3 (MO3) Requirements', some services/agencies may choose to implement this transition mechanism within an enclave. The following sub-sections provide guidelines for the use of NAT-PT within a controlled enclave.

In addition to the single point of failure, the reduced performance of an application level gateway, coupled with limitations on the kinds of applications that work, decreases the overall value and utility of the network. NAT-PT also inhibits the ability to deploy security at the IP layer."
      solution    : "This can be accomplished by not having IPv6 enabled on the interface supporting the IPv4 network. In addition a filter can be added to deny IPv6 at the interface."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16078r2_rule,STIG-ID|NET-IPV6-047,Vuln-ID|V-15296"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Inside_Access_Out_ACL@ replaced with "inside_access_out" in field "item".
      item        : "access-list inside_access_out extended deny 41 any any log"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET-IPV6-047 - Interfaces supporting IPv4 in NAT-PT Architecture must not receive IPv6 traffic. - inside IPv6 block in"
      info        : "Network Address Translation with Protocol Translation (NAT-PT), defined in [RFC2766], is a service that can be used to translate data sent between IP-heterogeneous nodes. NAT-PT translates IPv4 datagrams into a semantically equivalent IPv6 datagram or vice versa. For this service to work it has to be located in the connection point between the IPv4 network and the IPv6 network. The PT-part of the NAT-PT handles the interpretation and translation of the semantically equivalent IP header, either from IPv4 to IPv6 or from IPv6 to IPv4. Like NAT, NATPT also uses a pool of addresses which it dynamically assigns to the translated datagrams.

The NAT-PT architecture is not one of the preferred DoD IPv6 transition paradigms due to the deprecation of NAT-PT within the DoD community. However, as described in the 'DoD IPv6 Guidance for Information Assurance (IA) Milestone Objective 3 (MO3) Requirements', some services/agencies may choose to implement this transition mechanism within an enclave. The following sub-sections provide guidelines for the use of NAT-PT within a controlled enclave.

In addition to the single point of failure, the reduced performance of an application level gateway, coupled with limitations on the kinds of applications that work, decreases the overall value and utility of the network. NAT-PT also inhibits the ability to deploy security at the IP layer."
      solution    : "This can be accomplished by not having IPv6 enabled on the interface supporting the IPv4 network. In addition a filter can be added to deny IPv6 at the interface."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16078r2_rule,STIG-ID|NET-IPV6-047,Vuln-ID|V-15296"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET-IPV6-047 - Interfaces supporting IPv4 in NAT-PT Architecture must not receive IPv6 traffic. - inside IPv6 block out"
      info        : "Network Address Translation with Protocol Translation (NAT-PT), defined in [RFC2766], is a service that can be used to translate data sent between IP-heterogeneous nodes. NAT-PT translates IPv4 datagrams into a semantically equivalent IPv6 datagram or vice versa. For this service to work it has to be located in the connection point between the IPv4 network and the IPv6 network. The PT-part of the NAT-PT handles the interpretation and translation of the semantically equivalent IP header, either from IPv4 to IPv6 or from IPv6 to IPv4. Like NAT, NATPT also uses a pool of addresses which it dynamically assigns to the translated datagrams.

The NAT-PT architecture is not one of the preferred DoD IPv6 transition paradigms due to the deprecation of NAT-PT within the DoD community. However, as described in the 'DoD IPv6 Guidance for Information Assurance (IA) Milestone Objective 3 (MO3) Requirements', some services/agencies may choose to implement this transition mechanism within an enclave. The following sub-sections provide guidelines for the use of NAT-PT within a controlled enclave.

In addition to the single point of failure, the reduced performance of an application level gateway, coupled with limitations on the kinds of applications that work, decreases the overall value and utility of the network. NAT-PT also inhibits the ability to deploy security at the IP layer."
      solution    : "This can be accomplished by not having IPv6 enabled on the interface supporting the IPv4 network. In addition a filter can be added to deny IPv6 at the interface."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16078r2_rule,STIG-ID|NET-IPV6-047,Vuln-ID|V-15296"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET-SRVFRM-003-005 - Combined forced reports for items NET-SRVFRM-003 through NET-SRVFRM-005."
      item        : "interface Vlan"
    </item>
  </condition>

  <then>
    <report type:"WARNING">
      description : "NET-SRVFRM-003 - Server VLAN interfaces must be protected by restrictive ACLs using a deny-by-default security posture."
      info        : "Protecting data sitting in a server VLAN is necessary and can be accomplished using access control lists on VLANs provisioned for servers.  Without proper access control of traffic entering or leaving the server VLAN, potential threats such as a denial of service, data corruption, or theft could occur, resulting in the inability to complete mission requirements by authorized users.

NOTE: This check requires a manual review.  Determine if the detected VLAN interface on your device is being utilized to segment and protect servers. If so, ensure that an ACL has been applied and designed to only allow authorized traffic and to deny everything else by default.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure an ACL to protect the server VLAN interface.  The ACL must be in a deny-by-default security posture."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-20061r2_rule,STIG-ID|NET-SRVFRM-003,Vuln-ID|V-18522"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "NET-SRVFRM-004 - The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces between server farms"
      info        : "The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces that restrict data originating from one server farm segment destined to another server farm segment.

ACLs on VLAN interfaces do not protect against compromised servers. The Server farm vlans need to protect the servers located on one subnet from servers located on another subnet. Protecting a client's data from other clients is necessary and can be accomplished using VLAN provisioning, layer 3 filtering and content filtering at the Server Farm entry point. Restricting protocol, source and destination traffic via filters is an option; however additional security practices such as content filtering are required.

The Server farm private vlans need to protect the servers located on one subnet from servers located on another subnet.

NOTE: This check requires a manual review.  Determine if the detected VLAN interface on your device is being utilized to segment and protect servers. If so, ensure that an ACL has been applied and designed to only allow authorized traffic and to deny everything else by default.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Review the filter and ensure access from other server segments is denied unless necessary for application operation. The intent of the policy should be to protect servers from a server that has been compromised by an intruder."
      reference   : "CAT|II,Rule-ID|SV-20062r1_rule,STIG-ID|NET-SRVFRM-004,Vuln-ID|V-18523"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "NET-SRVFRM-005 - The IAO will ensure the Server Farm VLANs are protected by severely restricting the actions hosts can perform on servers"
      info        : "The IAO will ensure the Server Farm VLANs are protected by severely restricting the actions the hosts can perform on the servers by firewall content filtering.

Most current applications are deployed as a multi-tier architecture. The multi-tier model uses separate server machines to provide the different functions of presentation, business logic, and database.
Multi-tier server farms provide added security because a compromised web server does not provide direct access to the application itself or to the database.

The multi-tier separation is accomplished in several architectures, by a layer 2 switch, by a layer3 switch/router or by a firewall located at the server farm. Using the firewall implementation is the most secure method and is the only approved DoD architecture.

Firewalls get packets from VLAN-supporting switches complete with 802.1Q tags in their headers. What the VLAN-aware firewall can do is extract the tags and use the information within the tags to make policy-based security decisions.

NOTE: This check requires a manual review.  Determine if the detected VLAN interface on your device is being utilized to segment and protect servers. If so, ensure that an ACL has been applied and designed to only allow authorized traffic and to deny everything else by default.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the firewall to inspect traffic content to and from the server farm."
      reference   : "CAT|II,Rule-ID|SV-20064r1_rule,STIG-ID|NET-SRVFRM-005,Vuln-ID|V-18525"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET-SRVFRM-003 - Server VLAN interfaces must be protected by restrictive ACLs using a deny-by-default security posture."
      info        : "Protecting data sitting in a server VLAN is necessary and can be accomplished using access control lists on VLANs provisioned for servers.  Without proper access control of traffic entering or leaving the server VLAN, potential threats such as a denial of service, data corruption, or theft could occur, resulting in the inability to complete mission requirements by authorized users.

NOTE: Nessus did not detect any configured VLAN interfaces. Therefore, this check is not required."
      solution    : "Configure an ACL to protect the server VLAN interface.  The ACL must be in a deny-by-default security posture."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-20061r2_rule,STIG-ID|NET-SRVFRM-003,Vuln-ID|V-18522"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET-SRVFRM-004 - The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces between server farms"
      info        : "The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces that restrict data originating from one server farm segment destined to another server farm segment.

ACLs on VLAN interfaces do not protect against compromised servers. The Server farm vlans need to protect the servers located on one subnet from servers located on another subnet. Protecting a client's data from other clients is necessary and can be accomplished using VLAN provisioning, layer 3 filtering and content filtering at the Server Farm entry point. Restricting protocol, source and destination traffic via filters is an option; however additional security practices such as content filtering are required.

The Server farm private vlans need to protect the servers located on one subnet from servers located on another subnet."
      solution    : "Review the filter and ensure access from other server segments is denied unless necessary for application operation. The intent of the policy should be to protect servers from a server that has been compromised by an intruder.

NOTE: Nessus did not detect any configured VLAN interfaces. Therefore, this check is not required."
      reference   : "CAT|II,Rule-ID|SV-20062r1_rule,STIG-ID|NET-SRVFRM-004,Vuln-ID|V-18523"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"WARNING">
      description : "NET-SRVFRM-005 - The IAO will ensure the Server Farm VLANs are protected by severely restricting the actions hosts can perform on servers"
      info        : "The IAO will ensure the Server Farm VLANs are protected by severely restricting the actions the hosts can perform on the servers by firewall content filtering.

Most current applications are deployed as a multi-tier architecture. The multi-tier model uses separate server machines to provide the different functions of presentation, business logic, and database.
Multi-tier server farms provide added security because a compromised web server does not provide direct access to the application itself or to the database.

The multi-tier separation is accomplished in several architectures, by a layer 2 switch, by a layer3 switch/router or by a firewall located at the server farm. Using the firewall implementation is the most secure method and is the only approved DoD architecture.

Firewalls get packets from VLAN-supporting switches complete with 802.1Q tags in their headers. What the VLAN-aware firewall can do is extract the tags and use the information within the tags to make policy-based security decisions.

NOTE: Nessus did not detect any configured VLAN interfaces. Therefore, this check is not required.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the firewall to inspect traffic content to and from the server farm."
      reference   : "CAT|II,Rule-ID|SV-20064r1_rule,STIG-ID|NET-SRVFRM-005,Vuln-ID|V-18525"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<report type:"WARNING">
  description : "NET-TUNL-013 - L2TP must not pass into the private network of an enclave."
  info        : "Unlike GRE (a simple encapsulating header) L2TP is a full-fledged communications protocol with control channel, data channels, and a robust command structure. In addition to PPP, other link layer types (called pseudowires) can be and are defined for delivery in L2TP by separate RFC documents. Further complexity is created by the capability to define vender-specific parameters beyond those defined in the L2TP specifications.

The endpoint devices of an L2TP connection can be an L2TP Access Concentrator (LAC) in which case it inputs/outputs the layer 2 protocol to/from the L2TP tunnel. Otherwise it is an L2TP Network Server (LNS), in which case it inputs/outputs the layer 3 (IP) protocol to/from the L2TP tunnel. The specifications describe three reference models: LAC-LNS, LAC-LAC, and LNS-LNS, the first of which is the most common case. The LAC-LNS model allows a remote access user to reach his home network or ISP from a remote location. The remote access user either dials (or otherwise connects via layer 2) to a LAC device which tunnels his connection home to an awaiting LNS. The LAC could also be located on the remote user's laptop which connects to an LNS at home using some generic internet connection. The other reference models may be used for more obscure scenarios.

Although the L2TP protocol does not contain encryption capability, it can be operated over IPSEC which would provide authentication and confidentiality. A remote user in the LAC-LNS model would most likely obtain a dynamically assigned IP address from the home network to ultimately use through the tunnel back to the home network. Secondly, the outer IP source address used to send the L2TP tunnel packet to the home network is likely to be unknown or highly variable. Thirdly, since the LNS provides the remote user with a dynamic IP address to use, the firewall at the home network would have to be dynamically updated to accept this address in conjunction with the outer tunnel address. Finally, there is also the issue of authentication of the remote user prior to divulging an acceptable IP address. As a result of all of these complications, the strict filtering rules applied to the IP-in-IP and GRE tunneling cases will likely not be possible in the L2TP scenario.

In addition to the difficulty of enforcing addresses and endpoints (as explained above), the L2TP protocol itself is a security concern if allowed through a security boundary. In particular:

1) L2TP potentially allows link layer protocols to be delivered from afar. These protocols were intended for link-local scope only, are less defended, and not as well-known
2) The L2TP tunnels can carry IP packets that are very difficult to see and filter because of the additional layer 2 overhead
3) L2TP is highly complex and variable (vender-specific variability) and therefore would be a viable target that is difficult to defend. It is better left outside of the main firewall where less damage occurs if the L2TP-processing node is compromised.
4) Filtering cannot be used to detect and prevent other unintended layer 2 protocols from being tunneled. The strength of the application layer code would have to be relied on to achieve this task.
5) Regardless of whether the L2TP is handled inside or outside of the main network, a secondary layer of IP filtering is required, therefore bringing it inside doesn't save resources.

Therefore, it is not recommended to allow unencrypted L2TP packets across the security boundary into the network's protected areas. Reference the Backbone Transport STIG for additional L2TP guidance and use.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Terminate L2TP tunnels at the enclave perimeter, either in the DMZ or a service network for filtering and content inspection before passing traffic to the enclave's private network."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-3982r3_rule,STIG-ID|NET-TUNL-013,Vuln-ID|V-3982"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-TUNL-020 - Teredo packets must be blocked inbound to the enclave and outbound from the enclave. - 'outside in ACL'"
  info        : "Teredo (RFC 4380) is a tunneling mechanism that allows computers to encapsulate IPv6 packets inside IPv4 to traverse IPv4-only networks.  It relies on UDP to allow the tunnel to traverse NAT devices. Teredo uses UDP port 3544 to communicate with Teredo relays which access the packet, decapsulated the packet, and route it to the appropriate IPv6 network.  While Teredo was proposed by Microsoft, Linux versions do exist.

By allowing Teredo tunneling mechanism to be uncontrolled, it can pass malicious IPv6 packets over IPv4 without further inspection of the packet by router and firewall ACLs."
  solution    : "Configure either the perimeter router or firewall to block UDP port 3544 traffic inbound and outbound."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16075r5_rule,STIG-ID|NET-TUNL-020,Vuln-ID|V-15294"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_In_ACL@ replaced with "outside_access_in" in field "item".
  item        : "access-list outside_access_in deny udp any any eq 3544 log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-TUNL-020 - Teredo packets must be blocked inbound to the enclave and outbound from the enclave. - 'outside out ACL'"
  info        : "Teredo (RFC 4380) is a tunneling mechanism that allows computers to encapsulate IPv6 packets inside IPv4 to traverse IPv4-only networks.  It relies on UDP to allow the tunnel to traverse NAT devices. Teredo uses UDP port 3544 to communicate with Teredo relays which access the packet, decapsulated the packet, and route it to the appropriate IPv6 network.  While Teredo was proposed by Microsoft, Linux versions do exist.

By allowing Teredo tunneling mechanism to be uncontrolled, it can pass malicious IPv6 packets over IPv4 without further inspection of the packet by router and firewall ACLs."
  solution    : "Configure either the perimeter router or firewall to block UDP port 3544 traffic inbound and outbound."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-16075r5_rule,STIG-ID|NET-TUNL-020,Vuln-ID|V-15294"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_Out_ACL@ replaced with "outside_access_out" in field "item".
  item        : "access-list outside_access_out deny udp any eq 3544 any log"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET0230 - Network element is not password protected"
      item        : "aaa authentication"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0230 - Network devices must be password protected. - 'ASDM authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "aaa authentication http console .+"
      required    : NO
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0230 - Network devices must be password protected. - 'enable authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "aaa authentication enable console .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0230 - Network devices must be password protected. - 'serial authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "aaa authentication serial console .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0230 - Network devices must be password protected. - 'ssh authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "aaa authentication ssh console .+"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET0230 - Network devices must be password protected. - 'no telnet authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,PCI-DSSv3.2|2.2.5,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "aaa authentication telnet console .+"
    </item>
  </then>

  <else>
    <report type:"FAILED">
      description : "NET0230 - Network devices must be password protected. - 'ASDM authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0230 - Network devices must be password protected. - 'enable authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0230 - Network devices must be password protected. - 'serial authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0230 - Network devices must be password protected. - 'ssh authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0230 - Network devices must be password protected. - 'no telnet authentication'"
      info        : "Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network device. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network device providing opportunity for intruders to compromise resources within the network infrastructure.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
      solution    : "Configure the network devices so it will require a password to gain administrative access to the device."
      reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,PCI-DSSv3.2|2.2.5,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,Vuln-ID|V-3012"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<report type:"WARNING">
  description : "NET0240 - Network devices must not have any default manufacturer passwords."
  info        : "Network devices not protected with strong password schemes provide the opportunity for anyone to crack the password thus gaining access to the device and causing network outage or denial of service. Many default vendor passwords are well-known; hence, not removing them prior to deploying the network devices into production provides an opportunity for a malicious user to gain unauthorized access to the device.

NOTE: This check requires a manual review.  Determine whether or not the device is configured with default passwords. The Nessus Pluggin ID 23938 Cisco Device Default Password may be used to assist in verification. Verification with the device's administrator should also be pursued.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove any vendor default passwords from the network devices configuration."
  reference   : "CAT|I,Rule-ID|SV-3143r4_rule,STIG-ID|NET0240,Vuln-ID|V-3143"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : BANNER_CHECK
  description : "NET0340 - Network devices must display the DoD-approved logon banner warning."
  info        : "All network devices must present a DoD-approved warning banner prior to a system administrator logging on. The banner should warn any unauthorized user not to proceed. It also should provide clear and unequivocal notice to both authorized and unauthorized personnel that access to the device is subject to monitoring to detect unauthorized usage. Failure to display the required logon warning banner prior to logon attempts will limit DoD's ability to prosecute unauthorized access and also presents the potential to give rise to criminal and civil liability for systems administrators and information systems managers. In addition, DISA's ability to monitor the device's usage is limited unless a proper warning banner is displayed.

DoD CIO has issued new, mandatory policy standardizing the wording of 'notice and consent' banners and matching user agreements for all Secret and below DoD information systems, including stand-alone systems by releasing DoD CIO Memo, 'Policy on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User Agreement', dated 9 May 2008. The banner is mandatory and deviations are not permitted except as authorized in writing by the Deputy Assistant Secretary of Defense for Information and Identity Assurance. Implementation of this banner verbiage is further directed to all DoD components for all DoD assets via USCYBERCOM CTO 08-008A."
  solution    : "Configure all management interfaces to the network device to display the DoD-mandated warning banner verbiage at logon regardless of the means of connection or communication. The required banner verbiage that must be displayed verbatim is as follows:

Option A

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and
counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

Option B

If the system is incapable of displaying the required banner verbiage due to its size, a smaller banner must be used. The mandatory verbiage follows: 'I've read & consent to terms in IS user agreem't.'"
  reference   : "800-171|3.1.9,800-53|AC-8,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSSv3.2|2.2.4,Rule-ID|SV-3013r4_rule,STIG-ID|NET0340,TBA-FIISB|45.2.4,Vuln-ID|V-3013"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "banner login"
# Note: Variable @BANNER_LOGIN@ replaced with "I've read & consent to terms in IS user agreem't." in field "content".
  content     : "I've read & consent to terms in IS user agreem't."
</item>

<report type:"WARNING">
  description : "NET0366 - The SA must configure the firewall for the minimum content  and protocol inspection requirements."
  info        : "Creating a filter to allow a port or service through the firewall without content or protocol inspection creates a direct connection between the host in the private network and a host on the outside; thereby, bypassing additional security measures that could be provided. This places the internal host at a greater risk of exploitation that could make the entire network vulnerable to an attack.

NOTE: This check requires a manual verification.  Review the configuration to verify each port and service has protocol inspection.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure the firewall has content and protocol inspection implemented for all ingress and egress traffic."
  reference   : "CAT|II,Rule-ID|SV-15269r2_rule,STIG-ID|NET0366,Vuln-ID|V-14643"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0375 - The device must be configured to protect the network against denial of service attacks such as Ping of Death, TCP SYN floods, etc."
  info        : "A SYN-flood attack is a denial-of-service attack where the attacker sends a huge amount of please-start-a-connection packets and then nothing else.  This causes the device being attacked to be overloaded with the open sessions and eventually crash.

A ping sweep (also known as an ICMP sweep) is a basic network scanning technique used to determine which of a range of IP addresses map to live hosts (computers)."
  solution    : "If the firewall support SYN-flood or ping sweep protection then enable these features.  If the firewall does not support these features, enable the security features on the router to protect the network from these attacks."
  reference   : "800-53|SC-5,8500.2|EBBD-1,8500.2|EBBD-2,8500.2|EBBD-3,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|11.4,Rule-ID|SV-3156r2_rule,STIG-ID|NET0375,Vuln-ID|V-3156"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "threat-detection basic-threat"
</item>

<report type:"WARNING">
  description : "NET0377 - The firewall must not utilize any services or capabilities that are not necessary for the administration of the firewall."
  info        : "The risk of an attack increases with more services enabled on the firewall, since the firewall will listen for these services. If non-firewall services (e.g., DNS servers, e-mail client servers, ftp servers, web servers, etc.) are part of the standard firewall suite and are not necessary for administration of the firewall, they will be uninstalled or disabled.

NOTE: This check requires a manual review.  Verify all non-essential features are removed from the firewall.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The Firewall Administrator will only utilize services related to the operation of the firewall. Any unnecessary services, even if they are part of the firewall standard suite, must be uninstalled or disabled."
  reference   : "CAT|II,Rule-ID|SV-3054r3_rule,STIG-ID|NET0377,Vuln-ID|V-3054"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0378 - The firewall must not be listening for telnet service. - 'no telnet'"
  info        : "Telnet is an unencrypted service which can be easily exploited, especially when used over a public network such as the internet. With telnet enabled on the firewall, an attacker may be able to send spoofed packets through the firewall and consume the firewall's memory, causing a denial of service on the device. Telnet service is vulnerable to many exploits which can compromise the network device if enabled."
  solution    : "Disable telnet and verify the firewall is not listening to port 23 or 1467 as shown in the following example:

no telnet 2.0.0.2 255.255.255.255 inside

ciscoasa# show asp table socket

Protocol   Socket    State      Local Address                                Foreign Address

ciscoasa#"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-87531r1_rule,STIG-ID|NET0378,SWIFT-CSCv1|2.3,Vuln-ID|V-72879"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "^telnet ([0-9.]+|timeout)"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0378 - The firewall must not be listening for telnet service. - 'open ports'"
  info        : "Telnet is an unencrypted service which can be easily exploited, especially when used over a public network such as the internet. With telnet enabled on the firewall, an attacker may be able to send spoofed packets through the firewall and consume the firewall's memory, causing a denial of service on the device. Telnet service is vulnerable to many exploits which can compromise the network device if enabled."
  solution    : "Disable telnet and verify the firewall is not listening to port 23 or 1467 as shown in the following example:

no telnet 2.0.0.2 255.255.255.255 inside

ciscoasa# show asp table socket

Protocol   Socket    State      Local Address                                Foreign Address

ciscoasa#"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-87531r1_rule,STIG-ID|NET0378,SWIFT-CSCv1|2.3,Vuln-ID|V-72879"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  cmd         : "show asp table socket"
  item        : "TCP *[0-9]* *LISTEN *[0-9\.]*:(23|1467)"
</item>

<report type:"WARNING">
  description : "NET0379 - The FA will ensure that if the firewall product operates on an OS platform, the host must be STIG compliant prior to the install"
  info        : "The FA will ensure that if the firewall product operates on an OS platform, the host must be STIG compliant prior to the installation of the firewall product.

If the host that a firewall engine is operating on is not secured, the firewall itself is exposed to greater risk.

NOTE: This audit was specifically written for the Cisco ASA firewall appliance. Hence, the firewall software is likely not installed on an underlying host OS and is a software image created by Cisco Systems, Inc. Refer to the Cisco software documentation regarding software recommendations for your hardware platform to ensure the latest secure and stable version of the ASA software is installed. Further consultation with your applicable security policies and guidance may be required so the appropriate versions of software are installed.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The firewall administrator will install all patches that address IAVA."
  reference   : "CAT|II,Rule-ID|SV-4619r1_rule,STIG-ID|NET0379,Vuln-ID|V-4619"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'inside in'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Inside_Access_In_ACL@ replaced with "inside_access_in" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list inside_access_in extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'inside out'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Inside_Access_Out_ACL@ replaced with "inside_access_out" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list inside_access_out extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'mgmt in'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list mgmt_access_in extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'mgmt out'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_Out_ACL@ replaced with "mgmt_access_out" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list mgmt_access_out extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'outside in'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_In_ACL@ replaced with "outside_access_in" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list outside_access_in extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0380 - The firewall must reject requests for access from loopback address - 'outside out'"
  info        : "The firewall must reject requests for access or services where the source address received by the firewall specifies a loopback address.

The loopback address is used by an Inter-Processor Control (IPC) mechanism that enables the client and server portion of an application running on the same machine to communicate, and so it is trusted. It should never be used as the source IP address of an inbound or outbound transmission."
  solution    : "Establish filters to block any attempt from the firewall or any network to pass any packets claiming to be from a loopback address."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15270r2_rule,STIG-ID|NET0380,Vuln-ID|V-14644"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_Out_ACL@ replaced with "outside_access_out" in field "item".
# Note: Variable @Loopback_Address@ replaced with "127.0.0.0 255.0.0.0" in field "item".
  item        : "access-list outside_access_out extended deny ip 127.0.0.0 255.0.0.0 any log"
</item>

<report type:"WARNING">
  description : "NET0386 - Alerts must be automatically generated to notify the administrator when log storage reaches seventy-five percent or more"
  info        : "Alerts must be automatically generated to notify the administrator when log storage reaches seventy-five percent or more of its maximum capacity.

Configuring the network device or syslog server to provide alerts to the administrator in the event of modification or audit log capacity being exceeded ensures administrative staff is aware of critical alerts.  Without this type of notification setup, logged audits and events could potentially fill to capacity, causing subsequent records to not be recorded and dropped without any knowledge by the administrative staff.  Other unintended consequences of filling the log storage to capacity may include a denial of service of the device itself without proper notification.

NOTE: This check requires a manual review.  Ensure the syslog server alerts are configured for notification purposes.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the network device or syslog server to automatically generate and notify the administrator when seventy-five percent or more of the storage capacity has been reached with log data."
  reference   : "CAT|III,Rule-ID|SV-15272r3_rule,STIG-ID|NET0386,Vuln-ID|V-14646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0388 - The network device must dump logs when they reach 75% capacity to a syslog server."
  info        : "Having a procedure tested and verified will prevent the logs from filling when they reach 75% capacity."
  solution    : "Configure the device to dump logs to a syslog server when reaching a storage capacity of 75%."
  reference   : "800-171|3.3.8,800-53|AU-9(2),8500.2|ECSC-1,CAT|III,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15273r2_rule,STIG-ID|NET0388,Vuln-ID|V-14647"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
# Note: Variable @Syslog_Server@ replaced with "172.26.22.170" in field "item".
  item        : "logging host inside 172.26.22.170"
</item>

<report type:"WARNING">
  description : "NET0390 - The network devices must be configured to alert the administrator of a potential attack or system failure."
  info        : "The IDS or firewall is the first device that is under the sites control that has the possibility to alarm the local staff of an ongoing attack. An alert from either of these devices can be the first indication of an attack or system failure.

NOTE: This check requires a manual review.  Determine what clipping levels / thresholds, specific alerts, and how notifications are performed and appropriate for your organizaiton.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the IDS or firewall to alarm the SA of potential attacks or system failure."
  reference   : "CAT|II,Rule-ID|SV-3176r2_rule,STIG-ID|NET0390,Vuln-ID|V-3176"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0391 - Critical alerts must be generated and notifications sent to authorized personnel regardless if the person is logged in."
  info        : "By immediately displaying an alarm message, identifying the potential security violation and making it accessible with the audit record contents associated with the event(s) that generated the alarm provides the administration staff prompt alert messages, regardless if the person is logged into the system.

NOTE: This check requires a manual review.  Determine what alerts and notification actions are required for your organization.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the firewall to immediately notify authorized personnel of critical alerts."
  reference   : "8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|II,Rule-ID|SV-15274r2_rule,STIG-ID|NET0391,Vuln-ID|V-14648"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0392 - The ISSO must ensure the message is displayed at the remote console if an administrator is already logged in - 'console alerts'"
  info        : "The ISSO must ensure the message is displayed at the remote console if an administrator is already logged in, or when an administrator logs in if the alarm message has not been acknowledged.

By immediately displaying an alarm message, identifying the potential security violation and making it accessible with the audit record contents associated with the auditable event(s) that generated the alarm provides the administration staff prompt alert messages at their work areas."
  solution    : "Configure the firewall to immediately write an alarm message to the remote consoles."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.6,Rule-ID|SV-15275r2_rule,STIG-ID|NET0392,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14649"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "logging console alerts"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0392 - The ISSO must ensure the message is displayed at the remote console if an administrator is already logged in - 'monitor alerts'"
  info        : "The ISSO must ensure the message is displayed at the remote console if an administrator is already logged in, or when an administrator logs in if the alarm message has not been acknowledged.

By immediately displaying an alarm message, identifying the potential security violation and making it accessible with the audit record contents associated with the auditable event(s) that generated the alarm provides the administration staff prompt alert messages at their work areas."
  solution    : "Configure the firewall to immediately write an alarm message to the remote consoles."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15275r2_rule,STIG-ID|NET0392,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14649"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "logging monitor alerts"
</item>

<report type:"WARNING">
  description : "NET0395 - The ISSO must ensure the alarm message identifying the potential security violation makes accessible the audit record contents"
  info        : "The ISSO must ensure the alarm message identifying the potential security violation makes accessible the audit record contents associated with the event(s).

The relevant audit information must be available to administrators. The firewall shall immediately display an alarm message, identifying the potential security violation and make accessible the audit record contents associated with the event(s) that generated the alarm.

NOTE: This check is a manual review.  Determine if the alarm messages contain, or make available, the content of the associated event(s).
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the firewall to write violations to the console and make accessible the audit record contents."
  reference   : "8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|III,Rule-ID|SV-15279r2_rule,STIG-ID|NET0395,Vuln-ID|V-14653"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0396 - The ISSO must ensure an alert will remain written on the consoles until acknowledged by an administrator."
  info        : "Critical alerts require immediate response. Critical alerts must not roll off the screens. The requirements are necessary to ensure an administrator will be aware of the alerts or alarm. The intent is to ensure that if an administrator is physically at the remote workstation the message will remain displayed until they have acknowledged it.

NOTE: This check requires a manual review.  Determine the appropriate alerts and notifications performed as required by your organization. Utilizing a syslog server or SIEM product with advanced searching and alerting capabilities will greatly assist with this requirement.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the firewall to send an alarm or retain an alert message until acknowledged."
  reference   : "8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|III,Rule-ID|SV-15281r2_rule,STIG-ID|NET0396,Vuln-ID|V-14655"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0398 - The ISSO must ensure an acknowledgement message identifying a reference to the potential security violation is logged"
  info        : "The ISSO must ensure an acknowledgement message identifying a reference to the potential security violation is logged and it contains a notice that it has been acknowledged, the time of the acknowledgement and the user identifier that acknowledged the alarm, at the remote administrator session that received the alarm.

Acknowledging the alert could be a single event, or different events. In addition, assurance is required that each administrator that received the alarm message also receives the acknowledgement message, which includes some form of reference to the alarm message, who acknowledged the message and when.

NOTE: The Cisco ASA does not support all of the required features on the device itself. Utilizing a syslog server or SIEM product with advanced searching and alerting capabilities will greatly assist with this requirement.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the firewall to send acknowledge messages to administrators, referencing the alarm, who acknowledged the alarm, and timestamps."
  reference   : "8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|III,Rule-ID|SV-15282r2_rule,STIG-ID|NET0398,Vuln-ID|V-14656"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0405 - A service or feature that calls home to the vendor must be disabled."
  info        : "Call home services or features will routinely send data such as configuration and diagnostic information to the vendor for routine or emergency analysis and troubleshooting.  The risk that transmission of sensitive data sent to unauthorized persons could result in data loss or downtime due to an attack."
  solution    : "Configure the network device to disable the call home service or feature.

The command below will disable the call-home service on a Cisco device.
Example:
hostname(config)# no service call-home"
  reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CSF|PR.AC-4,PCI-DSSv3.2|2.2.5,Rule-ID|SV-38003r2_rule,STIG-ID|NET0405,Vuln-ID|V-28784"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  cmd         : "show call-home"
  context     : "Current.+[Cc]all-[Hh]ome settings"
  item        : ".+[Cc]all-[Hh]ome feature.+disable"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0422 - Network devices must be configured with rotating keys used for authenticating IGP peers that have a duration of 180 days or less."
  info        : "If the keys used for routing protocol authentication are guessed, the malicious user could create havoc within the network by advertising incorrect routes and redirecting traffic. Changing the keys frequently reduces the risk of them eventually being guessed. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates, both with 180-day or less expirations.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the device so rotating keys expire at 180 days or less."
  reference   : "800-53|IA-3,CAT|III,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-15301r4_rule,STIG-ID|NET0422,TBA-FIISB|27.1,Vuln-ID|V-14667"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  context     : "key chain .+"
  item        : ".*lifetime.*"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - Network devices must use two or more authentication servers for the purpose of granting administrative access. - 'AAA servr group'"
  info        : "The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands.   For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes.falseInformation Assurance Officer"
  solution    : "Configure the device to use two separate authentication servers."
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @AAA_Server_Group@ replaced with "AAA-Test" in field "item".
  item        : "aaa authentication .* AAA-Test LOCAL"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - Network devices must use two or more authentication servers for the purpose of granting administrative access. - 'AAA server 1'"
  info        : "The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands.   For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes.falseInformation Assurance Officer"
  solution    : "Configure the device to use two separate authentication servers."
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @AAA_Server_Group@ replaced with "AAA-Test" in field "item".
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
# Note: Variable @AAA_Server_1@ replaced with "10.0.0.10" in field "item".
  item        : "aaa-server AAA-Test .inside. host 10.0.0.10"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - Network devices must use two or more authentication servers for the purpose of granting administrative access. - 'AAA server 2'"
  info        : "The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands.   For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes.falseInformation Assurance Officer"
  solution    : "Configure the device to use two separate authentication servers."
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @AAA_Server_Group@ replaced with "AAA-Test" in field "item".
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
# Note: Variable @AAA_Server_2@ replaced with "10.0.0.11" in field "item".
  item        : "aaa-server AAA-Test .inside. host 10.0.0.11"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET0440 - More than one emergency account is defined"
# Note: Variable @AAA_Server_Group@ replaced with "AAA-Test" in field "item".
      item        : "aaa authentication .* AAA-Test LOCAL"
    </item>
  </condition>

  <then>
    <item>
      type            : CONFIG_CHECK
      description     : "NET0440 - In the event the authentication server is unavailable, the network device must have a single local account of last resort defined."
      info            : "Authentication for administrative access to the device is required at all times. A single account of last resort can be created on the device's local database for use in an emergency such as when the authentication server is down or connectivity between the device and the authentication server is not operable. The console or local account of last resort logon credentials must be stored in a sealed envelope and kept in a safe."
      solution        : "Configure the device to only allow one local account of last resort for emergency access and store the credentials in a secure manner."
      reference       : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15469r6_rule,STIG-ID|NET0440,SWIFT-CSCv1|5.1,Vuln-ID|V-3966"
      see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item            : "username"
      max_occurrences : "1"
    </item>
  </then>

  <else>
    <report type:"FAILED">
      description : "NET0440 - In the event the authentication server is unavailable, the network device must have a single local account of last resort defined."
      info        : "Authentication for administrative access to the device is required at all times. A single account of last resort can be created on the device's local database for use in an emergency such as when the authentication server is down or connectivity between the device and the authentication server is not operable. The console or local account of last resort logon credentials must be stored in a sealed envelope and kept in a safe.

NOTE: Nessus did not detect any configured AAA servers. Please refer to NET0433 for guidance."
      solution    : "Configure the device to only allow one local account of last resort for emergency access and store the credentials in a secure manner."
      reference   : "800-171|3.1.5,800-53|AC-6,CAT|II,CSF|PR.AC-4,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15469r6_rule,STIG-ID|NET0440,SWIFT-CSCv1|5.1,Vuln-ID|V-3966"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0441 - The emergency administration account must be set to an appropriate authorization level to perform necessary admin functions."
  info        : "The emergency administration account must be set to an appropriate authorization level to perform necessary administrative functions when the authentication server is not online.

The emergency administration account is to be configured as a local account on the network devices. It is to be used only when the authentication server is offline or not reachable via the network. The emergency account must be set to an appropriate authorization level to perform necessary administrative functions during this time."
  solution    : "Assign a privilege level to the emergency administration account to allow the administrator to perform necessary administrative functions when the authentication server is not online."
  reference   : "800-171|3.5.3,800-53|IA-2(2),800-53|IA-5(1),CAT|I,CSF|PR.AC-1,ITSG-33|IA-2(2),ITSG-33|IA-5(1),NESA|T5.2.3,NESA|T5.4.2,PCI-DSSv3.2|8.1.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-16261r5_rule,STIG-ID|NET0441,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.1,Vuln-ID|V-15434"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Emergency_Account@ replaced with "admin" in field "item".
  item        : "username admin .* privilege 15"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0460 - Group accounts must not be configured for use on the network device."
  info        : "Group accounts configured for use on a network device do not allow for accountability or repudiation of individuals using the shared account.  If group accounts are not changed when someone leaves the group, that person could possibly gain control of the network device.  Having group accounts does not allow for proper auditing of who is accessing or changing the network.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure individual user accounts for each authorized person then remove any group accounts."
  reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|I,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|8.1,Rule-ID|SV-3056r7_rule,STIG-ID|NET0460,SWIFT-CSCv1|5.1,Vuln-ID|V-3056"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  regex       : "manual review required"
  item        : "username.*"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0465 - Authorized accounts must be assigned the least privilege level necessary to perform assigned duties."
  info        : "By not restricting authorized accounts to their proper privilege level, access to restricted functions may be allowed before authorized personnel are trained or experienced enough to use those functions. Network disruptions or outages may occur due to mistakes made by inexperienced persons using accounts with greater privileges than necessary.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure authorized accounts with the least privilege rule. Each user will have access to only the privileges they require to perform their assigned duties."
  reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|8.1,Rule-ID|SV-3057r5_rule,STIG-ID|NET0465,SWIFT-CSCv1|5.1,Vuln-ID|V-3057"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  regex       : "manual review required"
  item        : "username.*"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0470 - Unauthorized accounts must not be configured for access to the network device."
  info        : "A malicious user attempting to gain access to the network device may compromise an account that may be unauthorized for use.  The unauthorized account may be a temporary or inactive account that is no longer needed to access the device.  Denial of Service, interception of sensitive information, or other destructive actions could potentially take place if an unauthorized account is configured to access the network device.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Remove any account configured for access to the network device that is not defined in the organization's responsibilities list."
  reference   : "800-171|3.1.5,800-53|AC-6(1),CAT|II,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|8.1,Rule-ID|SV-3058r5_rule,STIG-ID|NET0470,SWIFT-CSCv1|5.1,Vuln-ID|V-3058"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  regex       : "manual review required"
  item        : "username.*"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0600 - The network element must be configured to ensure passwords are not viewable when displaying configuration information - 'enable'"
  info        : "Many attacks information systems and network elements are launched from within the network. Hence, it is imperative that all passwords are encrypted so they cannot be intercepted by viewing the console or printout of the configuration.

NOTE: The PIX and ASA device will encrypt both user-mode and enable-mode passwords. When displayed the password will be shown encrypted followed by the keyword 'encrypted'. Hence, this would never be a finding."
  solution    : "Configure the network devices to ensure passwords are not viewable when displaying configuration information."
  reference   : "800-171|3.5.10,800-53|IA-5(1),8500.2|ECSC-1,CAT|I,CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-41452r2_rule,STIG-ID|NET0600,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-3062"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "enable .* encrypted"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0600 - The network element must be configured to ensure passwords are not viewable when displaying configuration information - 'username'"
  info        : "Many attacks information systems and network elements are launched from within the network. Hence, it is imperative that all passwords are encrypted so they cannot be intercepted by viewing the console or printout of the configuration.

NOTE: The PIX and ASA device will encrypt both user-mode and enable-mode passwords. When displayed the password will be shown encrypted followed by the keyword 'encrypted'. Hence, this would never be a finding."
  solution    : "Configure the network devices to ensure passwords are not viewable when displaying configuration information."
  reference   : "800-171|3.5.3,800-53|IA-2(2),800-53|IA-5(1),8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-2(2),ITSG-33|IA-5(1),NESA|T5.2.3,NESA|T5.4.2,PCI-DSSv3.2|8.2.1,Rule-ID|SV-41452r2_rule,STIG-ID|NET0600,SWIFT-CSCv1|1.2,SWIFT-CSCv1|4.1,Vuln-ID|V-3062"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "username .* encrypted"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0700 - Network devices must be running a current and supported operating system with all IAVMs addressed."
  info        : "Network devices not running the latest tested and approved versions of software are vulnerable to network attacks. Running the most current, approved version of system and device software helps the site maintain a stable base of security fixes and patches, as well as enhancements to IP security. Viruses, denial of service attacks, system weaknesses, back doors and other potentially harmful situations could render a system vulnerable, allowing unauthorized access to DoD assets.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Update operating system to a supported version that addresses all related IAVMs."
  reference   : "800-171|3.4.1,800-53|CM-8,CAT|II,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,PCI-DSSv3.2|2.4,Rule-ID|SV-3160r4_rule,STIG-ID|NET0700,Vuln-ID|V-3160"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  cmd         : "show version"
  regex       : "manual review required"
  item        : "Cisco.*Version.*"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0740 - The network element must have HTTP service for administrative access disabled."
  info        : "The additional services the router is enabled for increases the risk for an attack since the router will listen for these services. In addition, these services provide an unsecured method for an attacker to gain access to the router. Most recent software versions support remote configuration and monitoring using the World Wide Web's HTTP protocol. In general, HTTP access is equivalent to interactive access to the router. The authentication protocol used for HTTP is equivalent to sending a clear-text password across the network, and, unfortunately, there is no effective provision in HTTP for challenge-based or one-time passwords. This makes HTTP a relatively risky choice for use across the public Internet. Any additional services that are enabled increase the risk for an attack since the router will listen for these services. The HTTPS server may be enabled for administrative access.

NOTE: The Cisco ASA does not use the unsecure HTTP protocol (typcially TCP port 80) for management as it's not available for security purposes. Nessus may detect 'http server enable' for this check but the Cisco ASA only uses HTTPS for management connections when the command 'http server enable' is implemented. You may run a port scan against the device for confirmation.
NOTE: If Nessus returns a value of 'PASSED' the check is detecting the use of either HTTPS or ASDM for device management in your environment."
  solution    : "Configure the device to disable using HTTP (port 80) for administrative access."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.3,Rule-ID|SV-41470r2_rule,STIG-ID|NET0740,SWIFT-CSCv1|2.3,Vuln-ID|V-3085"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "http server enable"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - The network element must use two or more NTP servers to synchronize time. - 'NTP server 1'"
  info        : "Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source."
  solution    : "Configure the device to use two separate NTP servers."
  reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41499r1_rule,STIG-ID|NET0812,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Server_1@ replaced with "10.0.0.1" in field "item".
  item        : "ntp server 10.0.0.1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - The network element must use two or more NTP servers to synchronize time. - 'NTP server 2'"
  info        : "Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source."
  solution    : "Configure the device to use two separate NTP servers."
  reference   : "800-53|AU-8(2),CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41499r1_rule,STIG-ID|NET0812,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Server_2@ replaced with "10.0.0.2" in field "item".
  item        : "ntp server 10.0.0.2"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET0813 - NTP messages are not authenticated"
      item        : "ntp authenticate"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server Authentication-Key'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,SWIFT-CSCv1|2.3,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Auth_Key@ replaced with "1" in field "item".
      item        : "ntp authentication-key 1 md5"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server 1 Authentication'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-171|3.3.7,800-53|AU-8(1),CAT|II,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Server_1@ replaced with "10.0.0.1" in field "item".
# Note: Variable @NTP_Auth_Key@ replaced with "1" in field "item".
      item        : "ntp server 10.0.0.1 key 1"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server 2 Authentication'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-53|AU-8(2),CAT|II,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Server_2@ replaced with "10.0.0.2" in field "item".
# Note: Variable @NTP_Auth_Key@ replaced with "1" in field "item".
      item        : "ntp server 10.0.0.2 key 1"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Trusted-Key'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-53|IA-3,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|10.4.2,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,TBA-FIISB|27.1,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NTP_Auth_Key@ replaced with "1" in field "item".
      item        : "ntp trusted-key 1"
    </item>
  </then>

  <else>
    <report type:"FAILED">
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server Authentication-Key'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,SWIFT-CSCv1|2.3,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server 1 Authentication'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-171|3.3.7,800-53|AU-8,CAT|II,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Server 2 Authentication'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-53|AU-8,CAT|II,CSCv6|6.1,CSF|PR.PT-1,ITSG-33|AU-8,NESA|T3.6.7,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"FAILED">
      description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers. - 'NTP Trusted-Key'"
      info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them."
      solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
      reference   : "800-53|IA-3,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|10.4.2,Rule-ID|SV-41500r3_rule,STIG-ID|NET0813,TBA-FIISB|27.1,Vuln-ID|V-14671"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET0820 - DNS servers must be defined for client resolver"
      item        : "dns domain-lookup"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0820 - The network element must have DNS servers defined if it is configured as a client resolver. - 'DNS server 1'"
      info        : "The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities.  For example, suppose a source host wishes to establish a Telnet connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target.  The user on the source host might then provide logon, authentication, and other sensitive data.

NOTE: DNS lookup on the PIX and ASA is disabled by default."
      solution    : "Configure the device to include DNS servers or disable domain lookup."
      reference   : "800-53|SC-20,CAT|III,ITSG-33|SC-20,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41503r1_rule,STIG-ID|NET0820,Vuln-ID|V-3020"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @DNS_Server_Group@ replaced with "DefaultDNS" in field "context".
      context     : "dns server-group DefaultDNS"
# Note: Variable @DNS_Server_1@ replaced with "8.8.8.8" in field "item".
      item        : "name-server 8.8.8.8"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0820 - The network element must have DNS servers defined if it is configured as a client resolver. - 'DNS server 2'"
      info        : "The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities.  For example, suppose a source host wishes to establish a Telnet connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target.  The user on the source host might then provide logon, authentication, and other sensitive data.

NOTE: DNS lookup on the PIX and ASA is disabled by default."
      solution    : "Configure the device to include DNS servers or disable domain lookup."
      reference   : "800-53|SC-20,CAT|III,ITSG-33|SC-20,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41503r1_rule,STIG-ID|NET0820,Vuln-ID|V-3020"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @DNS_Server_Group@ replaced with "DefaultDNS" in field "context".
      context     : "dns server-group DefaultDNS"
# Note: Variable @DNS_Server_2@ replaced with "8.8.4.4" in field "item".
      item        : "name-server 8.8.4.4"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0820 - The network element must have DNS servers defined if it is configured as a client resolver. - 'DNS server 1'"
      info        : "The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities.  For example, suppose a source host wishes to establish a Telnet connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target.  The user on the source host might then provide logon, authentication, and other sensitive data.

NOTE: DNS lookup on the PIX and ASA is disabled by default. Based on the current check it appears that your organization is not using this device as a DNS client resolver."
      solution    : "Configure the device to include DNS servers or disable domain lookup."
      reference   : "800-53|SC-20,CAT|III,ITSG-33|SC-20,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41503r1_rule,STIG-ID|NET0820,Vuln-ID|V-3020"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0820 - The network element must have DNS servers defined if it is configured as a client resolver. - 'DNS server 2'"
      info        : "The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities.  For example, suppose a source host wishes to establish a Telnet connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target.  The user on the source host might then provide logon, authentication, and other sensitive data.

NOTE: DNS lookup on the PIX and ASA is disabled by default. Based on the current check it appears that your organization is not using this device as a DNS client resolver."
      solution    : "Configure the device to include DNS servers or disable domain lookup."
      reference   : "800-53|SC-20,CAT|III,ITSG-33|SC-20,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41503r1_rule,STIG-ID|NET0820,Vuln-ID|V-3020"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0890 - The network element must only allow SNMP access from addresses belonging to the management network."
  info        : "Detailed information about the network is sent across the network via SNMP.  If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices.

NOTE: You may need to duplicate this check if you have you allow multiple hosts SNMP access to the device in your organization."
  solution    : "Configure the network devices to only allow SNMP access from only addresses belonging to the management network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-41507r1_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
# Note: Variable @SNMP_Host_IP@ replaced with "10.0.0.3" in field "item".
  item        : "snmp-server host mgmt 10.0.0.3"
</item>

<report type:"PASSED">
  description : "NET0894 - The network device must only allow SNMP read-only access."
  info        : "Enabling write access to the router via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

NOTE: SNMP write access is not allowed, so you cannot make changes with SNMP."
  solution    : "The ASA appliance can send SNMP traps and can be polled via SNMP. However, it does not allow SNMP write access. This requirement will not be a finding."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-41513r2_rule,STIG-ID|NET0894,Vuln-ID|V-3969"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0910 - The SA will utilize ingress and egress ACLs to restrict traffic in accordance with DoD Instruction 8551.1"
  info        : "The SA will utilize ingress and egress ACLs to restrict traffic destined to the enclave perimeter in accordance with the guidelines contained in DoD Instruction 8551.1 for all ports and protocols required for operational commitments.

Vulnerability assessments must be reviewed by the SA and protocols must be approved by the IA staff before entering the enclave.

Access Control Lists (ACLs) are the first line of defense in a layered security approach.  They permit authorized packets and deny unauthorized packets based on port or service type.  They enhance the posture of the network by not allowing packets to even reach a potential target within the security domain.  The list provided are highly susceptible ports and services that should be blocked or limited as much as possible without adversely affecting customer requirements.   Auditing packets attempting to penetrate the network but are stopped by an ACL will allow network administrators to broaden their protective ring and more tightly define the scope of operation.

If the perimeter is in a Deny-by-Default posture and what is allowed through the filter is IAW DoD Instruction 8551.1, and if the permit rule is explicitly defined with explicit ports and protocols allowed, then all requirements related to PPS being blocked would be satisfied.

NOTE: It is the responsibility of the enclave owner to have the applications the enclave uses registered in the PPSM database.
NOTE: This check requires manual verification to review the ACLs to ensure they are compliant with DoD Instruction 8551.1.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "The SA will utilize ingress and egress ACLs to restrict traffic in accordance with the guidelines contained in DOD Instruction 8551.1 for all services and protocols required for operational commitments."
  reference   : "CAT|II,Rule-ID|SV-5731r1_rule,STIG-ID|NET0910,Vuln-ID|V-5731"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0965 - The network device must drop half-open TCP connections through filtering thresholds or timeout periods. - 'class-map'"
  info        : "A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

An attacker's goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state. Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack. Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints."
  solution    : "Configure the device to drop half-open TCP connections through threshold filtering or timeout periods."
  reference   : "800-171|3.13.9,800-53|SC-10,800-53|SC-5,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,ITSG-33|SC-5,NESA|T2.3.8,NESA|T3.3.1,NESA|T4.5.1,NESA|T5.5.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|1.2.1,Rule-ID|SV-5646r5_rule,STIG-ID|NET0965,SWIFT-CSCv1|2.6,Vuln-ID|V-5646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Class_Map@ replaced with "CONNS" in field "context".
  context     : "class-map CONNS"
  item        : "match any"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0965 - The network device must drop half-open TCP connections through filtering thresholds or timeout periods. - 'connection timeout'"
  info        : "A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

An attacker's goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state. Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack. Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints."
  solution    : "Configure the device to drop half-open TCP connections through threshold filtering or timeout periods."
  reference   : "800-171|3.13.9,800-53|SC-10,800-53|SC-5,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,ITSG-33|SC-5,NESA|T2.3.8,NESA|T3.3.1,NESA|T4.5.1,NESA|T5.5.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-5646r5_rule,STIG-ID|NET0965,SWIFT-CSCv1|2.6,Vuln-ID|V-5646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Policy_Map@ replaced with "CONNS" in field "context".
  context     : "policy-map CONNS"
  item        : ".*set connection timeout .* embryonic 0:00:10"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0965 - The network device must drop half-open TCP connections through filtering thresholds or timeout periods. - 'policy-map'"
  info        : "A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

An attacker's goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state. Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack. Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints."
  solution    : "Configure the device to drop half-open TCP connections through threshold filtering or timeout periods."
  reference   : "800-171|3.13.9,800-53|SC-10,800-53|SC-5,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,ITSG-33|SC-5,NESA|T2.3.8,NESA|T3.3.1,NESA|T4.5.1,NESA|T5.5.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-5646r5_rule,STIG-ID|NET0965,SWIFT-CSCv1|2.6,Vuln-ID|V-5646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Policy_Map@ replaced with "CONNS" in field "context".
  context     : "policy-map CONNS"
# Note: Variable @Class_Map@ replaced with "CONNS" in field "item".
  item        : "class CONNS"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0965 - The network device must drop half-open TCP connections through filtering thresholds or timeout periods. - 'service-policy'"
  info        : "A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

An attacker's goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state. Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack. Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints."
  solution    : "Configure the device to drop half-open TCP connections through threshold filtering or timeout periods."
  reference   : "800-171|3.13.9,800-53|SC-10,800-53|SC-5,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,ITSG-33|SC-5,NESA|T2.3.8,NESA|T3.3.1,NESA|T4.5.1,NESA|T5.5.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|1.3.3,Rule-ID|SV-5646r5_rule,STIG-ID|NET0965,SWIFT-CSCv1|2.6,Vuln-ID|V-5646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Service_Policy_TCP@ replaced with "CONNS" in field "item".
# Note: Variable @NAMEIF_Outside@ replaced with "outside" in field "item".
  item        : "service-policy CONNS interface outside"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0991 - The network element's OOBM interface must be configured with an OOBM network address."
  info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the OOBM interface does not have an IP address from the managed network address space, it will not have reachability from the NOC using scalable and normal control plane and forwarding mechanisms."
  solution    : "Configure the managed network element's OOBM interface with an IP address from the address space
belonging to the OOBM network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20207r2_rule,STIG-ID|NET0991,Vuln-ID|V-17821"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Interface@ replaced with "Vlan3" in field "context".
  context     : "interface Vlan3"
# Note: Variable @OOBM_IP_Subnet@ replaced with "172.26.0.16 255.255.252.0" in field "item".
  item        : "ip address 172.26.0.16 255.255.252.0"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET0992 - The management interface does not have an ACL"
# Note: Variable @MGMT_Interface@ replaced with "Vlan3" in field "context".
      context     : "interface Vlan3"
      item        : "ip address"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-group mgmt inbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
      item        : "access-group mgmt_access_in in interface mgmt"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-group mgmt outbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_Out_ACL@ replaced with "mgmt_access_out" in field "item".
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
      item        : "access-group mgmt_access_out out interface mgmt"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-list mgmt inbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @Inside_Network@ replaced with "192.168.1.0 255.255.255.0" in field "item".
      item        : "access-list mgmt_access_in deny ip 192.168.1.0 255.255.255.0 log"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-list mgmt outbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_Out_ACL@ replaced with "mgmt_access_out" in field "item".
# Note: Variable @OOBM_Network@ replaced with "172.26.0.0 255.255.252.0" in field "item".
      item        : "access-list mgmt_access_out permit ip 172.26.0.0 255.255.252.0 log"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-group mgmt inbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network.

NOTE: Nessus detected that the management interface does not appear to be a routed interface. Therefore, you will be unable to assign ingress and egress ACLs and will need to verify your architecture to ensure any potential security threats related to this requirement are addressed."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-group mgmt outbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network.

NOTE: Nessus detected that the management interface does not appear to be a routed interface. Therefore, you will be unable to assign ingress and egress ACLs and will need to verify your architecture to ensure any potential security threats related to this requirement are addressed."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-list mgmt inbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network.

NOTE: Nessus detected that the management interface does not appear to be a routed interface. Therefore, you will be unable to assign ingress and egress ACLs and will need to verify your architecture to ensure any potential security threats related to this requirement are addressed."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0992 - The network elements management interface must be configured with both an ingress and egress ACL. - 'access-list mgmt outbound'"
      info        : "The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic does not leak into the managed network and production traffic does not leak into the management network.

NOTE: Nessus detected that the management interface does not appear to be a routed interface. Therefore, you will be unable to assign ingress and egress ACLs and will need to verify your architecture to ensure any potential security threats related to this requirement are addressed."
      solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network device."
      reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19333r2_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0993 - The network element's management interface is not configured as passive for the IGP instance - 'eigrp passive-interface'"
  info        : "The network element's management interface is not configured as passive for the IGP instance deployed in the managed network.

The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic, both data plane and control plane, does not leak into the managed network and production traffic does not leak into the management network.

NOTE: The Cisco ASA appliance only supports the passive interface feature on RIP and EIGRP, OSPF is not supported at this time on the ASA."
  solution    : "Configure the management interface as passive for the IGP instance configured for the managed network. Depending on the platform and routing protocol, this may simply require that the interface or its IP address is not included in the IGP configuration."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-19336r2_rule,STIG-ID|NET0993,Vuln-ID|V-17823"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  context     : "router eigrp"
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
  item        : "passive-interface mgmt"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0993 - The network element's management interface is not configured as passive for the IGP instance - 'rip passive-interface'"
  info        : "The network element's management interface is not configured as passive for the IGP instance deployed in the managed network.

The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic, both data plane and control plane, does not leak into the managed network and production traffic does not leak into the management network.

NOTE: The Cisco ASA appliance only supports the passive interface feature on RIP and EIGRP, OSPF is not supported at this time on the ASA."
  solution    : "Configure the management interface as passive for the IGP instance configured for the managed network. Depending on the platform and routing protocol, this may simply require that the interface or its IP address is not included in the IGP configuration."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-19336r2_rule,STIG-ID|NET0993,Vuln-ID|V-17823"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  context     : "router rip"
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
  item        : "passive-interface mgmt"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1001 - A firewall located behind the premise router must be configured to block all outbound management traffic. - 'step 1 egress ACL'"
  info        : "The management network must still have its own subnet in order to enforce control and access boundaries provided by Layer 3 network nodes such as routers and firewalls. Management traffic between the managed network elements and the management network is routed via the same links and nodes as that used for production or operational traffic. Safeguards must be implemented to ensure that the management traffic does not leak past the managed network's premise equipment. It there is a firewall located behind the premise router, then all management traffic should  be blocked at that point-with the exception of management traffic destined to premise equipment.

NOTE: Access lists can be defined for PIX/ASA using the familiar IOS software ACL format. However, one important difference exists between the PIX/ASA and IOS ACL formats: PIXs use real subnet masks (a 1 bit matches, and a 0 bit ignores), whereas IOS platforms use a wildcard mask (a 0 bit matches, and a 1 bit ignores)."
  solution    : "With the exception of management traffic destined to perimeter equipment, a firewall located behind the premise router must be configured to block all outbound management traffic."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19319r1_rule,STIG-ID|NET1001,Vuln-ID|V-17830"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_Out_ACL@ replaced with "outside_access_out" in field "item".
# Note: Variable @OOBM_Mgmt_Network@ replaced with "172.16.0.0 255.240.0.0" in field "item".
  item        : "access-list outside_access_out extended deny ip 172.16.0.0 255.240.0.0 log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1001 - A firewall located behind the premise router must be configured to block all outbound management traffic. - 'step 1 egress group'"
  info        : "The management network must still have its own subnet in order to enforce control and access boundaries provided by Layer 3 network nodes such as routers and firewalls. Management traffic between the managed network elements and the management network is routed via the same links and nodes as that used for production or operational traffic. Safeguards must be implemented to ensure that the management traffic does not leak past the managed network's premise equipment. It there is a firewall located behind the premise router, then all management traffic should  be blocked at that point-with the exception of management traffic destined to premise equipment.

NOTE: Access lists can be defined for PIX/ASA using the familiar IOS software ACL format. However, one important difference exists between the PIX/ASA and IOS ACL formats: PIXs use real subnet masks (a 1 bit matches, and a 0 bit ignores), whereas IOS platforms use a wildcard mask (a 0 bit matches, and a 1 bit ignores)."
  solution    : "With the exception of management traffic destined to perimeter equipment, a firewall located behind the premise router must be configured to block all outbound management traffic."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19319r1_rule,STIG-ID|NET1001,Vuln-ID|V-17830"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Outside_Access_Out_ACL@ replaced with "outside_access_out" in field "item".
# Note: Variable @NAMEIF_Outside@ replaced with "outside" in field "item".
  item        : "access-group outside_access_out out interface outside"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1001 - A firewall located behind the premise router must be configured to block all outbound management traffic. - 'step 2 next-hop'"
  info        : "The management network must still have its own subnet in order to enforce control and access boundaries provided by Layer 3 network nodes such as routers and firewalls. Management traffic between the managed network elements and the management network is routed via the same links and nodes as that used for production or operational traffic. Safeguards must be implemented to ensure that the management traffic does not leak past the managed network's premise equipment. It there is a firewall located behind the premise router, then all management traffic should  be blocked at that point-with the exception of management traffic destined to premise equipment.

NOTE: Access lists can be defined for PIX/ASA using the familiar IOS software ACL format. However, one important difference exists between the PIX/ASA and IOS ACL formats: PIXs use real subnet masks (a 1 bit matches, and a 0 bit ignores), whereas IOS platforms use a wildcard mask (a 0 bit matches, and a 1 bit ignores)."
  solution    : "With the exception of management traffic destined to perimeter equipment, a firewall located behind the premise router must be configured to block all outbound management traffic."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.3.4,Rule-ID|SV-19319r1_rule,STIG-ID|NET1001,Vuln-ID|V-17830"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
# Note: Variable @OOBM_Mgmt_Network@ replaced with "172.16.0.0 255.240.0.0" in field "item".
# Note: Variable @Inside_Next_Hop@ replaced with "192.168.1.1" in field "item".
  item        : "route inside 172.16.0.0 255.240.0.0 192.168.1.1"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "NET1006 - IPSec traffic is not restricted"
# Note: Variable @NAMEIF_Outside@ replaced with "outside" in field "item".
      item        : "isakmp enable outside"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET1006 - Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address. - 'crypto'"
      info        : "Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services."
      solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
      reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19312r1_rule,STIG-ID|NET1006,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17835"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Crypto_Map_Name@ replaced with "oobm_crypto" in field "item".
# Note: Variable @IPSec_ACL@ replaced with "125" in field "item".
      item        : "crypto map oobm_crypto .* match address 125"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET1006 - Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address. - 'ipsec'"
      info        : "Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services."
      solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
      reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19312r1_rule,STIG-ID|NET1006,Vuln-ID|V-17835"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @IPSec_ACL@ replaced with "125" in field "item".
# Note: Variable @OOBM_Network@ replaced with "172.26.0.0 255.255.252.0" in field "item".
# Note: Variable @OOBM_Mgmt_Network@ replaced with "172.16.0.0 255.240.0.0" in field "item".
      item        : "access-list 125 permit ip 172.26.0.0 255.255.252.0 172.16.0.0 255.240.0.0"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET1006 - Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address. - 'crypto'"
      info        : "Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services

NOTE: Nessus did not detect the present of an IPSec tunnel configured on the outside interface of your organization."
      solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
      reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7,800-53|SC-8,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7,ITSG-33|SC-8,NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19312r1_rule,STIG-ID|NET1006,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17835"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET1006 - Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address. - 'ipsec'"
      info        : "Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services.

NOTE: Nessus did not detect the present of an IPSec tunnel configured on the outside interface of your organization."
      solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
      reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19312r1_rule,STIG-ID|NET1006,Vuln-ID|V-17835"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET1020 - The network device must log all interface access control lists (ACL) deny statements."
  info        : "Auditing and logging are key components of any security architecture.  It is essential for security personnel to know what is being done, attempted to be done, and by whom in order to compile an accurate risk assessment.  Auditing the actions on network devices provides a means to recreate an attack, or identify a configuration mistake on the device.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure interface ACLs to log all deny statements."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-50941r1_rule,STIG-ID|NET1020,Vuln-ID|V-3000"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  regex       : "manual review required"
  item        : "access-list.+deny.+"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1288 - Network device logs must be timestamped."
  info        : "Device logs can be used for forensic analysis in support of incident as well as to aid with normal traffic analysis. It can take numerous days to recover from a firewall outage when a proper backup scheme is not used.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to include timestamps on all device logs."
  reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,8500.2|ECTB-1,CAT|III,CN-L3|8.1.4.3(b),CSF|PR.PT-1,ITSG-33|AU-8,NESA|T3.6.2,NESA|T3.6.7,PCI-DSSv3.2|10.3.3,Rule-ID|SV-32503r2_rule,STIG-ID|NET1288,TBA-FIISB|37.4,Vuln-ID|V-25890"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  regex       : "manual review required"
  item        : "logging timestamp"
  severity    : MEDIUM
</item>

<report type:"WARNING">
  description : "NET1289 - Network device logs must include source IP, destination IP, port, protocol used and action taken."
  info        : "The network device logs can be used for forensic analysis in support of incident as well as to aid with normal traffic analysis.

NOTE: This check requires manual review of the firewall logs. Content of individual logs may vary depending on the message ID. You can review the Cisco ASA Series Syslog Messages guide to determine available information for a given message ID. If you are utilizing a syslog server you will need to review the logs on that device to ensure the syslog server is properly parsing the firewall logs and extracting the desired fields.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure the firewall logs are receiving source IP, destination IP, port, protocol used and action taken."
  reference   : "8500.2|ECSC-1,8500.2|ECTB-1,CAT|III,Rule-ID|SV-32504r2_rule,STIG-ID|NET1289,Vuln-ID|V-25891"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET1300 - Administrator logons, changes to the administrator group, and account lockouts must be logged."
  info        : "The network device and the associated logging functions allows for forensic investigations if properly configured and protected. The administrators account is the most sought after account so extra protection must be taken to protect this account and log its activity.

NOTE: This check reqiures manual verification to ensure the applicable information is logged. Review the Cisco ASA Series Syslog Messages guide to ensure none of the necessary message IDs are not being filtered out. You may also want to verify that any AAA services are logging their activity to your syslog server for further verification.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the network device to log all administrative actions performed on the device."
  reference   : "8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECSC-1,CAT|III,Rule-ID|SV-3178r2_rule,STIG-ID|NET1300,Vuln-ID|V-3178"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1623 - The network device must require authentication for console access."
  info        : "Network devices with no password for administrative access via the console provide the opportunity for anyone with physical access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

NOTE: This Nessus check is looking for the minimal presence of local authentication for administrative access to the device. If you implement AAA services in your environment this check may need to be modified to account for the utilization of AAA services."
  solution    : "Configure authentication for console access on the network device."
  reference   : "800-171|3.5.1,800-53|IA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-4582r5_rule,STIG-ID|NET1623,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-4582"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "aaa authentication serial console LOCAL"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1624 - The network devices must time out access to the console port at 10 minutes or less of inactivity."
  info        : "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition quickly terminating an idle session will also free up resources committed by the managed network device. Setting the timeout of the session to 10 minutes or less increases the level of protection afforded critical network components."
  solution    : "Configure the timeout for idle console connection to 10 minutes or less."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-3967r4_rule,STIG-ID|NET1624,Vuln-ID|V-3967"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "console timeout ([1-9]|10)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1629 - The auxiliary port must be disabled unless it is connected to a secured modem providing encryption and authentication."
  info        : "The use of POTS lines to modems connecting to network devices provides clear text of authentication traffic over commercial circuits that could be captured and used to compromise the network.  Additional war dial attacks on the device could degrade the device and the production network.

Secured modem devices must be able to authenticate users and must negotiate a key exchange before full encryption takes place.  The modem will provide full encryption capability (Triple DES) or stronger.  The technician who manages these devices will be authenticated using a key fob and granted access to the appropriate maintenance port, thus the technician will gain access to the managed device (router, switch, etc.).  The token provides a method of strong (two-factor) user authentication.  The token works in conjunction with a server to generate one-time user passwords that will change values at second intervals.  The user must know a personal identification number (PIN) and possess the token to be allowed access to the device.

NOTE: Certain Cisco ASA models do not have auxiliary ports so this check may or may not be applicable to your environment, depending upon the model you have deployed."
  solution    : "Disable the auxiliary port. If used for out-of-band administrative access, the port must be connected to a secured modem providing encryption and authentication."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-7365r4_rule,STIG-ID|NET1629,SWIFT-CSCv1|2.3,Vuln-ID|V-7011"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  context     : "line aux 0"
  item        : "no exec"
  required    : NO
</item>

<report type:"WARNING">
  description : "NET1636 - The network device must require authentication prior to establishing a management connection for administrative access."
  info        : "Network devices with no password for administrative access via a management connection provide the opportunity for anyone with network access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

NOTE: The currently configured NET0230 check covers this requirement. In order to reduce duplicate checks and cluttered output, a manual review of the NET0230 output will assist in determining NET1636 compliance.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure authentication for all management connections."
  reference   : "CAT|I,Rule-ID|SV-3175r5_rule,STIG-ID|NET1636,Vuln-ID|V-3175"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1637 - The network devices must only allow management connections for admin access from hosts in the management network. - 'access-group'"
  info        : "The network devices must only allow management connections for administrative access from hosts residing in the management network.

Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions."
  solution    : "Configure an ACL or filter to restrict management access to the device from only the management network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-5611r5_rule,STIG-ID|NET1637,Vuln-ID|V-5611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @NAMEIF_Mgmt@ replaced with "mgmt" in field "item".
  item        : "access-group mgmt_access_in in interface mgmt control-plane"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1637 - The network devices must only allow management connections for admin access from hosts in the management network. - 'access-list'"
  info        : "The network devices must only allow management connections for administrative access from hosts residing in the management network.

Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Nessus is only checking for the presence of an item in the given ACL. Since most ACLs are typically processed in their order of entry you may still need to manually verify ACL rule order to ensure proper traffic handling so that no traffic is inadvertently passed or denied."
  solution    : "Configure an ACL or filter to restrict management access to the device from only the management network."
  reference   : "800-171|3.13.1,800-53|SC-7,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-5611r5_rule,STIG-ID|NET1637,Vuln-ID|V-5611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @OOBM_Mgmt_Network@ replaced with "172.16.0.0 255.240.0.0" in field "item".
  item        : "access-list mgmt_access_in extended permit ip 172.16.0.0 255.240.0.0"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1638 - Management connections must be established using secure protocols with FIPS 140-2 cryptographic modules - Telnet"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: The Cisco ASA device allows for management over ASDM,HTTPS,Telnet, and SSH. Since Telnet is the only non-secure protocol allowed for management, this check looks for the absence of Telnet management access in the configuration leaving the other 3 secure protocols as the only options for management access."
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,SWIFT-CSCv1|2.3,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
  item        : "telnet .* inside"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be established using secure protocols with FIPS 140-2 cryptographic modules - Cipher Encryption"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: The Cisco ASA device allows for management over ASDM,HTTPS,Telnet, and SSH. Since Telnet is the only non-secure protocol allowed for management, this check looks for the absence of Telnet management access in the configuration leaving the other 3 secure protocols as the only options for management access."
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CIP|005-5-R2,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.DS-5,HIPAA|164.312(e)(1),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|4.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @SSH_ALGORITHM_ENCRYPTION@ replaced with "aes128-cbc aes192-cbc aes256-cbc" in field "item".
  item        : "ssh cipher encryption custom aes128-cbc aes192-cbc aes256-cbc"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be established using secure protocols with FIPS 140-2 cryptographic modules - Cipher MAC"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: The Cisco ASA device allows for management over ASDM,HTTPS,Telnet, and SSH. Since Telnet is the only non-secure protocol allowed for management, this check looks for the absence of Telnet management access in the configuration leaving the other 3 secure protocols as the only options for management access."
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,CAT|II,CIP|005-5-R2,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.DS-5,HIPAA|164.312(e)(1),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|4.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @SSH_ALGORITHM_MAC@ replaced with "hmac-sha1 hmac-sha1-96" in field "item".
  item        : "ssh cipher integrity custom hmac-sha1 hmac-sha1-96"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1639 - The network element must timeout management connections for administrative access after 10 minutes - 'ssh timeout'"
  info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

Setting the timeout of the session to ten minutes or less increases the level of protection afforded critical network components."
  solution    : "Configure the network devices to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
  reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-32758r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "ssh timeout ([1-9]|10)"
</item>

<if>
  <condition type:"OR">
    <item>
      type        : CONFIG_CHECK
      description : "NET1639 - Management connection does not timeout - 'http server'"
      item        : "http server enable"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET1639 - Management connection does not timeout - 'webvpn'"
      context     : "webvpn"
      item        : ".+enable"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET1639 - The network element must timeout management connections for administrative access after 10 minutes - 'http idle-timeout'"
      info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

Setting the timeout of the session to ten minutes or less increases the level of protection afforded critical network components."
      solution    : "Configure the network devices to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-32758r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "http server idle-timeout ([1-9]|10)"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET1639 - The network element must timeout management connections for administrative access after 10 minutes - 'http session-timeout'"
      info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

Setting the timeout of the session to ten minutes or less increases the level of protection afforded critical network components."
      solution    : "Configure the network devices to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,Rule-ID|SV-32758r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
      item        : "http server session-timeout ([1-9]|10)"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET1639 - The network element must timeout management connections for administrative access after 10 minutes - 'http idle-timeout'"
      info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

Setting the timeout of the session to ten minutes or less increases the level of protection afforded critical network components.
NOTE: Nessus did not detect the presence of either 'http server enable' or 'webvpn' that would necessitate the configuration of timeout settings."
      solution    : "Configure the network devices to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-32758r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET1639 - The network element must timeout management connections for administrative access after 10 minutes - 'http session-timeout'"
      info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

Setting the timeout of the session to ten minutes or less increases the level of protection afforded critical network components.
NOTE: Nessus did not detect the presence of either 'http server enable' or 'webvpn' that would necessitate the configuration of timeout settings."
      solution    : "Configure the network devices to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
      reference   : "800-171|3.1.11,800-53|AC-12,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-32758r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET1640 - Network devices must log all attempts to establish a management connection for administrative access."
  info        : "Audit logs are necessary to provide a trail of evidence in case the network is compromised.  Without an audit trail that provides a when, where, who and how set of information, repeat offenders could continue attacks against the network indefinitely.  With this information, the network administrator can devise ways to block the attack and possibly identify and prosecute the attacker."
  solution    : "Configure the device to log all access attempts to the device to establish a management connection for administrative access."
  reference   : "800-171|3.13.1,800-53|SC-7,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-3070r4_rule,STIG-ID|NET1640,Vuln-ID|V-3070"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @MGMT_Access_In_ACL@ replaced with "mgmt_access_in" in field "item".
# Note: Variable @OOBM_Mgmt_Network@ replaced with "172.16.0.0 255.240.0.0" in field "item".
  item        : "access-list mgmt_access_in extended permit ip 172.16.0.0 255.240.0.0 .* log"
</item>

<report type:"WARNING">
  description : "NET1645 - The network devices must be configured to timeout after 60 seconds or less for incomplete or broken SSH sessions."
  info        : "An attacker may attempt to connect to the device using SSH by guessing the authentication method, encryption algorithm, and keys. Limiting the amount of time allowed for authenticating and negotiating the SSH session reduces the window of opportunity for the malicious user attempting to make a connection to the network device.

NOTE: The Cisco ASA does not currently support the feature. You may wish to double check by using the Cisco Feature Navigator for your given device and software version. Not to be confused with 'ssh timeout 10', which disconnects an idle session once the initial TCP 3-way handshake and SSH authentication have taken place, resulting from a period of no user activity. NET1645 is calling for a timeout of 60 seconds or less for the period after the TCP 3-way handshake but before SSH authentication has completed. Once you receive the prompt for 'Login as:' the guidance recommends giving the user 60 seconds or less to complete the SSH authentication, otherwise the session will be closed without reaching the secure shell environment.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the network devices so it will require a secure shell timeout of 60 seconds or less."
  reference   : "CAT|II,Rule-ID|SV-5612r4_rule,STIG-ID|NET1645,Vuln-ID|V-5612"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1646 - The network device must be configured for a maximum number of unsuccessful SSH logon attempts set at 3"
  info        : "The network device must be configured for a maximum number of unsuccessful SSH logon attempts set at 3 before resetting the interface.

An attacker may attempt to connect to the device using SSH by guessing the authentication method and authentication key or shared secret. Setting the authentication retry to 3 or less strengthens against a Brute Force attack.

NOTE: If utilizing AAA services in your organization you may need to manually review the RADIUS or TACACS+ server(s) providing AAA services to verify the unsuccessful login attempts response."
  solution    : "Configure the network device to require a maximum number of unsuccessful SSH logon attempts at 3."
  reference   : "800-171|3.1.8,800-53|AC-7,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.2|8.1.6,Rule-ID|SV-5613r4_rule,STIG-ID|NET1646,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-5613"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "aaa local authentication attempts max-fail 3"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1647 - The network device must not allow SSH Version 1 to be used for administrative access."
  info        : "SSH Version 1 is a protocol that has never been defined in a standard. Since SSH-1 has inherent design flaws which make it vulnerable to attacks, e.g., man-in-the-middle attacks, it is now generally considered obsolete and should be avoided by explicitly disabling fallback to SSH-1."
  solution    : "Configure the network device to use SSH version 2."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15459r4_rule,STIG-ID|NET1647,SWIFT-CSCv1|2.3,Vuln-ID|V-14717"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
  item        : "ssh version 2"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1660 - The network device must use SNMP Version 3 Security Model with FIPS 140-2 cryptography - 'snmp v3 group'"
  info        : "The network device must use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography for any SNMP agent configured on the device.

SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network."
  solution    : "If SNMP is enabled, configure the network device to use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography (i.e., SHA authentication and AES encryption)."
  reference   : "800-171|3.13.8,800-53|SC-8(1),CAT|I,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|7.1.2,Rule-ID|SV-3196r4_rule,STIG-ID|NET1660,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3196"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @SNMP_V3_Group@ replaced with "testgroup" in field "item".
  item        : "snmp-server group testgroup v3 priv"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1660 - The network device must use SNMP Version 3 Security Model with FIPS 140-2 cryptography - 'snmp v3 interface'"
  info        : "The network device must use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography for any SNMP agent configured on the device.

SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network."
  solution    : "If SNMP is enabled, configure the network device to use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography (i.e., SHA authentication and AES encryption)."
  reference   : "800-171|3.13.11,800-171|3.3.8,800-53|AU-9(2),800-53|SC-13,CAT|I,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.DS-5,CSF|PR.PT-1,ISO/IEC-27001|A.10.1.1,ITSG-33|AU-9(2),ITSG-33|SC-13,NESA|M5.2.3,NESA|M5.2.6,NESA|M5.5.2,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-3196r4_rule,STIG-ID|NET1660,Vuln-ID|V-3196"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @NAMEIF_Inside@ replaced with "inside" in field "item".
# Note: Variable @SNMP_Host_IP@ replaced with "10.0.0.3" in field "item".
  item        : "snmp-server host insideinside 10.0.0.3 version 3"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1660 - The network device must use SNMP Version 3 Security Model with FIPS 140-2 cryptography - 'snmp v3 user'"
  info        : "The network device must use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography for any SNMP agent configured on the device.

SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network."
  solution    : "If SNMP is enabled, configure the network device to use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography (i.e., SHA authentication and AES encryption)."
  reference   : "800-171|3.13.11,800-171|3.3.8,800-53|AU-9(2),800-53|SC-13,CAT|I,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.DS-5,CSF|PR.PT-1,ISO/IEC-27001|A.10.1.1,ITSG-33|AU-9(2),ITSG-33|SC-13,NESA|M5.2.3,NESA|M5.2.6,NESA|M5.5.2,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|7.1.2,Rule-ID|SV-3196r4_rule,STIG-ID|NET1660,Vuln-ID|V-3196"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @SNMP_V3_Group@ replaced with "testgroup" in field "item".
  item        : "snmp-server user .* testgroup v3 encrypted auth sha .* priv aes 128"
</item>

<report type:"WARNING">
  description : "NET1665 - The network device must not use the default or well-known SNMP community strings public and private."
  info        : "Network devices may be distributed by the vendor pre-configured with an SNMP agent using the well-known SNMP community strings public for read only and private for read and write authorization. An attacker can obtain information about a network device using the read community string 'public'. In addition, an attacker can change a system configuration using the write community string 'private'.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure unique SNMP community strings replacing the default community strings."
  reference   : "CAT|I,Rule-ID|SV-3210r4_rule,STIG-ID|NET1665,Vuln-ID|V-3210"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET1675 - The network device must use different SNMP community names or groups for various levels of read and write access."
  info        : "Numerous vulnerabilities exist with SNMP; therefore, without unique SNMP community names, the risk of compromise is dramatically increased. This is especially true with vendors default community names which are widely known by hackers and other networking experts. If a hacker gains access to these devices and can easily guess the name, this could result in denial of service, interception of sensitive information, or other destructive actions.

NOTE: This check requires a manual review.  Ensure the different SNMP community names or groups are unique. Running the command 'more system:running-config | grep snmp' from the CLI will assist in the varification process.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the SNMP community strings on the network device and change them from the default values. SNMP community strings and user passwords must be unique and not match any other network device passwords. Different community strings (V1/2) or groups (V3) must be configured for various levels of read and write access."
  reference   : "CAT|II,Rule-ID|SV-3043r4_rule,STIG-ID|NET1675,Vuln-ID|V-3043"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check isakmp enabled on outside interface"
# Note: Variable @NAMEIF_Outside@ replaced with "outside" in field "item".
      item        : "isakmp enable outside"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1800 - The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone."
      info        : "The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone network.

Using dedicated paths, the OOBM backbone connects the OOBM gateway routers located at the premise of the managed networks and at the NOC.  Dedicated links can be deployed using provisioned circuits (ATM, Frame Relay, SONET, T-carrier, and others or VPN technologies such as subscribing to MPLS Layer 2 and Layer 3 VPN services) or implementing a secured path with gateway-to-gateway IPsec tunnel.  The tunnel mode ensures that the management traffic will be logically separated from any other traffic traversing the same path.

NOTE: The default mode for the Cisco ASA is tunnel and does not always display in the configuration output. Therefore, this check is looking to make sure transport mode is not present."
      solution    : "Establish the VPN as a tunneled VPN.

Terminate the tunneled VPN outside of the firewall.

Ensure all host-to-host VPN are established between trusted known hosts."
      reference   : "800-171|3.13.8,800-53|SC-8(1),CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|2.2.3,Rule-ID|SV-3008r1_rule,STIG-ID|NET1800,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3008"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Transform_Name@ replaced with "Test-Transform" in field "item".
      item        : "crypto ipsec ikev1 transform-set Test-Transform mode transport"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET1800 - The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone."
      info        : "The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone network.

Using dedicated paths, the OOBM backbone connects the OOBM gateway routers located at the premise of the managed networks and at the NOC.  Dedicated links can be deployed using provisioned circuits (ATM, Frame Relay, SONET, T-carrier, and others or VPN technologies such as subscribing to MPLS Layer 2 and Layer 3 VPN services) or implementing a secured path with gateway-to-gateway IPsec tunnel.  The tunnel mode ensures that the management traffic will be logically separated from any other traffic traversing the same path.

NOTE: Nessus did not detect the present of an IPSec tunnel configured on the outside interface of your organization."
      solution    : "Establish the VPN as a tunneled VPN.

Terminate the tunneled VPN outside of the firewall.

Ensure all host-to-host VPN are established between trusted known hosts."
      reference   : "800-171|3.13.8,800-53|SC-8,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|2.2.3,Rule-ID|SV-3008r1_rule,STIG-ID|NET1800,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3008"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check isakmp enabled on outside interface"
# Note: Variable @NAMEIF_Outside@ replaced with "outside" in field "item".
      item        : "isakmp enable outside"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET1807 - Management traffic is not restricted to only the authorized management packets based on destination and source IP address."
      info        : "The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC.  This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation.

NOTE: Access lists can be defined for PIX/ASA using the familiar IOS software ACL format. However, one important difference exists between the PIX/ASA and IOS ACL formats: PIXs use real subnet masks (a 1 bit matches, and a 0 bit ignores), whereas IOS platforms use a wildcard mask (a 0 bit matches, and a 1 bit ignores)."
      solution    : "Configure filters based on source and destination IP address to restrict only authorized management traffic into IPSec tunnels used for transiting management data."
      reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19320r1_rule,STIG-ID|NET1807,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17754"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
# Note: Variable @Crypto_Map_Name@ replaced with "oobm_crypto" in field "item".
# Note: Variable @IPSec_ACL@ replaced with "125" in field "item".
      item        : "crypto map oobm_crypto .* match address 125"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET1807 - Management traffic is not restricted to only the authorized management packets based on destination and source IP address."
      info        : "The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC.  This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation.

NOTE: Access lists can be defined for PIX/ASA using the familiar IOS software ACL format. However, one important difference exists between the PIX/ASA and IOS ACL formats: PIXs use real subnet masks (a 1 bit matches, and a 0 bit ignores), whereas IOS platforms use a wildcard mask (a 0 bit matches, and a 1 bit ignores).

NOTE: Nessus did not detect the present of an IPSec tunnel configured on the outside interface of your organization."
      solution    : "Configure filters based on source and destination IP address to restrict only authorized management traffic into IPSec tunnels used for transiting management data."
      reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7,800-53|SC-8,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7,ITSG-33|SC-8,NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19320r1_rule,STIG-ID|NET1807,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17754"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

<report type:"WARNING">
  description : "NET1808 - Gateway configuration at the remote VPN end-point is a not a mirror of the local gateway"
  info        : "The IPSec tunnel end points may be configured on the OOBM gateway routers connecting the managed network and the NOC. They may also be configured on a firewall or VPN concentrator located behind the gateway router. In either case, the crypto access-list used to identify the traffic to be protected must be a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer.

NOTE: This check requires a manual review.  Determine whether the remote VPN end-point is a mirror configuration of the local end-point.
NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure he crypto access-list used to identify the traffic to be protected so that it is a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer."
  reference   : "CAT|II,Rule-ID|SV-19063r1_rule,STIG-ID|NET1808,Vuln-ID|V-17814"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
</report>

<if>
  <condition type:"OR">
    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 1"
      cmd         : "show version"
      item        : "Cisco.+Version.([0-5]\..+|6\.[0-2].+|6\.3\([0-4].+|6\.3\(5\)|6\.3\(5\.[0-9]\)|6\.3\(5\.[0-9][0-9]\)|6\.3\(5\.1[0-3][0-9].+|6\.3\(5\.14[0-3].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 2"
      cmd         : "show version"
      item        : "Cisco.+Version.(7\.0\([0-7]\..+|7\.0\(8\.0.+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 3"
      cmd         : "show version"
      item        : "Cisco.+Version.(7\.1\([0-1].+|7\.1\(2\.[0-6].+|7\.1\(2\.7[0-3].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 4"
      cmd         : "show version"
      item        : "Cisco.+Version.(7\.2\([0-3].+|7\.2\(4\.[0-8].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 5"
      cmd         : "show version"
      item        : "Cisco.+Version.(8\.0\([0-2].+|8\.0\(3\.[0-2].+|8\.0\(3\.3[0-1].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 6"
      cmd         : "show version"
      item        : "Cisco.+Version.(8\.1\(0\..+|8\.1\(1\.[0-7]\)|8\.1\(1\.9\)|8\.1\(1\.1[0-9]\)|8\.1\(1\.[2-9][0-9]\))"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 7"
      cmd         : "show version"
      item        : "Cisco.+Version.(8\.1\([2-9]\..+|8\.1\([1-9][0-9]\..+|8\.1\(100\..+|8\.1\(101\.[0-3].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 8"
      cmd         : "show version"
      item        : "Cisco.+Version.(8\.2\(0\.[0-9]\).+|8\.2\(0\.[0-9][0-9]\).+|8\.2\(0\.1[0-3][0-9].+)"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET1970 - PAT is vulnerable to DNS cache poisoning - 9"
      cmd         : "show version"
      item        : "Cisco.+Version.(9\..+|10\..+)"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "NET1970 - Firewall software has been upgraded to mitigate the risk of DNS cache poisoning attack caused by a flawed PAT implementation"
      info        : "The IAO will ensure that the router or firewall software has been upgraded to mitigate the risk of DNS cache poisoning attack caused by a flawed PAT implementation using a predictable source port allocation method for DNS query traffic.

DNS cache poisoning is an attack technique that allows an attacker to introduce forged DNS information into the cache of a caching name server. There are inherent deficiencies in the DNS protocol and defects in implementations that facilitate DNS cache poisoning.

Name servers vulnerable to cache poisoning attacks are due to their use of insufficiently randomized transaction IDs and UDP source ports in the DNS queries that they produce, which may allow an attacker to more easily forge DNS answers that can poison DNS caches. To exploit these vulnerabilities an attacker must be able to cause a vulnerable DNS server to perform recursive DNS queries. Therefore, DNS servers that are only authoritative, or servers where recursion is not allowed, are not affected.

The DNS protocol specification includes a transaction ID field of 16 bits. If the specification is correctly implemented and the transaction ID is randomly selected with a strong random number generator, an attacker will require, on average, 32,768 attempts to successfully predict the ID. Some flawed implementations may use a smaller number of bits for this transaction ID, meaning that fewer attempts will be needed. Furthermore, there are known errors with the randomness of transaction IDs that are generated by a number of implementations.

Some current implementations allocate an arbitrary source port at startup (and sometimes selected at random) and reuse this source port for all outgoing queries. With other implementations, the source port for outgoing queries is fixed at the traditional assigned DNS server UDP port number 53. Because attacks against these vulnerabilities all rely on an attacker's ability to predict, the implementation of per-query source port randomization in the server presents a practical mitigation against these attacks within the boundaries of the current protocol specification. Randomized source ports can be used to gain approximately 16 additional bits of randomness in the data that an attacker must guess. Randomizing the ports adds a significant amount of attack resiliency.

Routers, firewalls, proxies, and other gateway devices that perform NAT-more specifically Port Address Translation (PAT)-often rewrite source ports in order to track connection state. A flawed implementation of a PAT device using a predictiable source port allocation method can reduce any effectiveness of source port randomization implemented by name servers and stub resolvers. Henceforth, it is imperative that the router or firewall software has been upgraded or patched to reduce an attacker's opportunity for launching a DNS cache poisoning attack.

Note: Regular NAT (allocating one public IP address for each private IP address) is not affected by this problem because it only rewrites layer 3 information and does not modify layer 4 header information of packets traversing the NAT device.

NOTE: Nessus did not detect one of the vulnerable versions of software listed in the DISA STIG guidance. You may reference NET0700 to manually double check the version you have on your device to ensure the installed software is not susceptible to the DNS cache poisoning vulnerability."
      solution    : "Update the OS to the release that mitigates the risk of a DNS cache poisoning attack"
      reference   : "CAT|I,Rule-ID|SV-30841r1_rule,STIG-ID|NET1970,Vuln-ID|V-25037"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </then>

  <else>
    <report type:"FAILED">
      description : "NET1970 - Firewall software has been upgraded to mitigate the risk of DNS cache poisoning attack caused by a flawed PAT implementation"
      info        : "The IAO will ensure that the router or firewall software has been upgraded to mitigate the risk of DNS cache poisoning attack caused by a flawed PAT implementation using a predictable source port allocation method for DNS query traffic.

DNS cache poisoning is an attack technique that allows an attacker to introduce forged DNS information into the cache of a caching name server. There are inherent deficiencies in the DNS protocol and defects in implementations that facilitate DNS cache poisoning.

Name servers vulnerable to cache poisoning attacks are due to their use of insufficiently randomized transaction IDs and UDP source ports in the DNS queries that they produce, which may allow an attacker to more easily forge DNS answers that can poison DNS caches. To exploit these vulnerabilities an attacker must be able to cause a vulnerable DNS server to perform recursive DNS queries. Therefore, DNS servers that are only authoritative, or servers where recursion is not allowed, are not affected.

The DNS protocol specification includes a transaction ID field of 16 bits. If the specification is correctly implemented and the transaction ID is randomly selected with a strong random number generator, an attacker will require, on average, 32,768 attempts to successfully predict the ID. Some flawed implementations may use a smaller number of bits for this transaction ID, meaning that fewer attempts will be needed. Furthermore, there are known errors with the randomness of transaction IDs that are generated by a number of implementations.

Some current implementations allocate an arbitrary source port at startup (and sometimes selected at random) and reuse this source port for all outgoing queries. With other implementations, the source port for outgoing queries is fixed at the traditional assigned DNS server UDP port number 53. Because attacks against these vulnerabilities all rely on an attacker's ability to predict, the implementation of per-query source port randomization in the server presents a practical mitigation against these attacks within the boundaries of the current protocol specification. Randomized source ports can be used to gain approximately 16 additional bits of randomness in the data that an attacker must guess. Randomizing the ports adds a significant amount of attack resiliency.

Routers, firewalls, proxies, and other gateway devices that perform NAT-more specifically Port Address Translation (PAT)-often rewrite source ports in order to track connection state. A flawed implementation of a PAT device using a predictiable source port allocation method can reduce any effectiveness of source port randomization implemented by name servers and stub resolvers. Henceforth, it is imperative that the router or firewall software has been upgraded or patched to reduce an attacker's opportunity for launching a DNS cache poisoning attack.

Note: Regular NAT (allocating one public IP address for each private IP address) is not affected by this problem because it only rewrites layer 3 information and does not modify layer 4 header information of packets traversing the NAT device.

NOTE: Nessus did not detect one of the patched versions of software listed in the DISA STIG guidance. You may reference NET0700 to manually double check the version you have on your device to ensure the installed software is not susceptible to the DNS cache poisoning vulnerability."
      solution    : "Update the OS to the release that mitigates the risk of a DNS cache poisoning attack"
      reference   : "CAT|I,Rule-ID|SV-30841r1_rule,STIG-ID|NET1970,Vuln-ID|V-25037"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Firewall_V8R25_STIG.zip"
    </report>
  </else>
</if>

</check_type>
