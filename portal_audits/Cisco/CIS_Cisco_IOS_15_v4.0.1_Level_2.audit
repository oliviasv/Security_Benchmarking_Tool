#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2020/04/15 $
#
# description : This .audit is designed against the CIS Benchmark for
#               Cisco IOS 15 Benchmark v4.0.1, November 14, 2019.
#               https://workbench.cisecurity.org/files/2585
#
# NOTE        : Some queries in this .audit require site-specific data to be known to the query in order to function properly.  Please note the following
#               queries and edit their values accordingly.
#
#<ui_metadata>
#<display_name>CIS Cisco IOS 15 L2 v4.0.1</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Cisco IOS 15 L2</name>
#  <version>4.0.1</version>
#  <link>https://workbench.cisecurity.org/files/2585</link>
#</spec>
#<labels>cisco,cis,ios</labels>
#<benchmark_refs>LEVEL,CSCv6,CSCv7</benchmark_refs>
#<variables>
#  <variable>
#    <name>NTP_KEY_ID</name>
#    <default>10</default>
#    <description>Authentication key ID for NTP servs</description>
#    <info>This key should be used to authenticate communications with the routers NTP servers</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>192.168.0.1</default>
#    <description>NTP server IP address</description>
#    <info>Your organization's preferred NTP server</info>
#  </variable>
#  <variable>
#    <name>AG_INGRESS_ACL</name>
#    <default>3</default>
#    <description>AG ingress ACL ID</description>
#    <info>The number of the access control list on the perimeter router's external interface used to block internal source addresses.</info>
#  </variable>
#  <variable>
#    <name>INTERNAL_NETWORK</name>
#    <default>192\.168\.1\.0 0\.0\.0\.255</default>
#    <description>Internal IP address and netmask</description>
#    <info>Your organization's internal IP address range, defined by an IP address and network mask. This network is used in the TCP intercept ACL and in the AG ingress ACL to block spoofed addresses.</info>
#  </variable>
#  <variable>
#    <name>EXTERNAL_INTERFACE</name>
#    <default>FastEthernet0/1</default>
#    <description>External interface name</description>
#    <info>The external interface for your organization.</info>
#  </variable>
#  <variable>
#    <name>KEY_CHAIN_NAME</name>
#    <default>eigrp-keys</default>
#    <description>Keychain name</description>
#    <info>The keychain name for your organization's routing protocol.</info>
#  </variable>
#  <variable>
#    <name>INTERNAL_NETWORK_INGRESS_ACL</name>
#    <default>1</default>
#    <description>Internal Network ingress ACL ID</description>
#    <info>The number of the access control list used to allow internal source addresses to enter the external interface.</info>
#  </variable>
#  <variable>
#    <name>AS_NUMBER</name>
#    <default>100</default>
#    <description>AS Number</description>
#    <info>The Autonomous System number used by the router</info>
#  </variable>
#  <variable>
#    <name>OSPF_KEY_ID</name>
#    <default>1</default>
#    <description>OSPF Key ID</description>
#    <info>Your organization's OSPF key ID</info>
#  </variable>
#  <variable>
#    <name>RIP_KEY_CHAIN</name>
#    <default>rip-keys</default>
#    <description>RIPv2 keychain name</description>
#    <info>The keychain for your organization's RIPv2 authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#  <variable>
#    <name>RIP_KEY_NUMBER</name>
#    <default>key_number</default>
#    <description>RIPv2 key number</description>
#    <info>The key number for your organization's RIPv2 authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check if Cisco IOS 15 is installed"
      item        : "^version 15"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Cisco_IOS_15_v4.0.1_Level_1 from CIS Cisco IOS 15 Benchmark"
      see_also    : "https://workbench.cisecurity.org/files/2585"
    </report>

#
## 1 Management Plane
#
#
## 1.1 Local Authentication, Authorization and Accounting (AAA) Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "1.1.7 Set 'aaa accounting' to log all privileged use commands using 'commands 15'"
      info        : "Runs accounting for all commands at the specified privilege level.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS or TACACS+."
      solution    : "Configure AAA accounting for commands.

hostname(config)#aaa accounting commands 15 {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Impact:

Enabling 'aaa accounting' for privileged commands records and sends activity to the accounting servers and enables organizations to monitor and analyze privileged activity.

Default Value:

AAA accounting is disabled.

Notes:

Valid privilege level entries are integers from 0 through 15."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CSCv6|5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2S,PCI-DSSv3.2|8.1,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "aaa accounting commands 15 [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.8 Set 'aaa accounting connection'"
      info        : "Provides information about all outbound connections made from the network access server.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+."
      solution    : "Configure AAA accounting for connections.

hostname(config)#aaa accounting connection {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Impact:

Implementing aaa accounting connection creates accounting records about connections from the network access server. Organizations should regular monitor these connection records for exceptions, remediate issues, and report findings regularly.

Default Value:

AAA accounting is not enabled.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA"
      reference   : "800-171|3.3.1,800-53|AU-12(1),CSCv6|16.9,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2S,PCI-DSSv3.2|8.1,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "aaa accounting connection [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.9 Set 'aaa accounting exec'"
      info        : "Runs accounting for the EXEC shell session.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+."
      solution    : "Configure AAA accounting for EXEC shell session.

hostname(config)#aaa accounting exec {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Impact:

Enabling aaa accounting exec creates accounting records for the EXEC terminal sessions on the network access server. These records include start and stop times, usernames, and date information. Organizations should regularly monitor these records for exceptions, remediate issues, and report findings.

Default Value:

AAA accounting is not enabled.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA"
      reference   : "800-171|3.3.1,800-53|AU-12(1),CSCv6|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2S,PCI-DSSv3.2|8.1,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "aaa accounting exec [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.10 Set 'aaa accounting network'"
      info        : "Runs accounting for all network-related service requests.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+."
      solution    : "Configure AAA accounting for connections.

hostname(config)#aaa accounting network {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Impact:

Implementing aaa accounting network creates accounting records for a method list including ARA, PPP, SLIP, and NCPs sessions. Organizations should regular monitor these records for exceptions, remediate issues, and report findings.

Default Value:

AAA accounting is not enabled.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA"
      reference   : "800-171|3.3.1,800-53|AU-12(1),CSCv7|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2S,PCI-DSSv3.2|8.1,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "aaa accounting network [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.11 Set 'aaa accounting system'"
      info        : "Performs accounting for all system-level events not associated with users, such as reloads.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+."
      solution    : "Configure AAA accounting system.

hostname(config)#aaa accounting system {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Impact:

Enabling aaa accounting system creates accounting records for all system-level events. Organizations should regular monitor these records for exceptions, remediate issues, and report findings regularly.

Default Value:

AAA accounting is not enabled.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/a1/sec-cr-a1.html#GUID-0520BCEF-89FB-4505-A5DF-D7F1389F1BBA

Notes:

When system accounting is used and the accounting server is unreachable at system startup time, the system will not be accessible for approximately two minutes."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CSCv6|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2S,PCI-DSSv3.2|8.1,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "aaa accounting system [^ ]+"
    </item>

#
## 1.2 Access Rules
#
# No applicable Level II Checks
#
## 1.3 Banner Rules
#
# No applicable Level II Checks
#
## 1.4 Password Rules
#
# No applicable Level II Checks
#
## 1.5 SNMP Rules
#

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "SNMP is enabled"
          item        : "snmp-server community .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "1.5.9 Set 'priv' for each 'snmp-server group' using SNMPv3"
          info        : "Specifies authentication of a packet with encryption when using SNMPv3

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
          solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...


hostname(config)#snmp-server group {group_name} v3 priv

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit.

Default Value:

No SNMP server groups are configured.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-56E87D02-C56F-4E2D-A5C8-617E31740C3F"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|3.4,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          regex       : "snmp-server group .+ v3 priv"
          item        : "snmp-server group .+ v3"
        </item>

        <item>
          type        : CONFIG_CHECK_NOT
          description : "1.5.10 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
          info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
          solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.


hostname(config)#snmp-server user {user_name} {group_name} v3 auth sha {auth_password} priv aes 128 {priv_password} {acl_name_or_number}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit.

Default Value:

SNMP username as not set by default.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-4EED4031-E723-4B84-9BBF-610C3CF60E31"
          reference   : "800-171|3.13.11,800-171|3.3.8,800-53|AU-9,800-53|SC-13,CSCv6|3.4,CSF|PR.DS-5,CSF|PR.PT-1,ITSG-33|AU-9,ITSG-33|SC-13,LEVEL|2S,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|8.2.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          cmd         : "show snmp user"
          item        : "Privacy Protocol: (DES|3DES)"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "1.5.9 Set 'priv' for each 'snmp-server group' using SNMPv3"
          info        : "Specifies authentication of a packet with encryption when using SNMPv3

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
          solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...


hostname(config)#snmp-server group {group_name} v3 priv

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit.

Default Value:

No SNMP server groups are configured.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-56E87D02-C56F-4E2D-A5C8-617E31740C3F"
          reference   : "CSCv6|3.4,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "1.5.10 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
          info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed."
          solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.


hostname(config)#snmp-server user {user_name} {group_name} v3 auth sha {auth_password} priv aes 128 {priv_password} {acl_name_or_number}

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit.

Default Value:

SNMP username as not set by default.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/snmp/command/nm-snmp-cr-s5.html#GUID-4EED4031-E723-4B84-9BBF-610C3CF60E31"
          reference   : "CSCv6|3.4,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </else>
    </if>

#
## 2 Control Plane
#
#
## 2.1 Global Service Rules
#
# No applicable Level II Checks
#
## 2.2 Logging Rules
#
# No applicable Level II Checks
#
## 2.3 NTP Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.1 Set 'ntp authenticate'"
      info        : "Enable NTP authentication.

Rationale:

Using authenticated NTP ensures the Cisco device only permits time updates from authorized NTP servers."
      solution    : "Configure NTP authentication:


hostname(config)#ntp authenticate

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authenticate' command enforces authentication between NTP hosts.

Default Value:

NTP authentication is not enabled.





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-8BEBDAF4-6D03-4C3E-B8D6-6BCBC7D0F324"
      reference   : "800-53|IA-3,CSCv6|6.1,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|10.4.2"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "[ ]*ntp authenticate"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.2 Set 'ntp authentication-key'"
      info        : "Define an authentication key for Network Time Protocol (NTP).

Rationale:

Using an authentication key provides a higher degree of security as only authenticated NTP servers will be able to update time for the Cisco device."
      solution    : "Configure at the NTP key ring and encryption key using the following command


hostname(config)#ntp authentication-key {ntp_key_id} md5 {ntp_key_hash}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authentication-key' command enforces encrypted authentication between NTP hosts.

Default Value:

No authentication key is defined for NTP.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-0435BFD1-D7D7-41D4-97AC-7731C11226BC"
      reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|6.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
      regex       : "[ ]*ntp authentication-key 10 md5"
      item        : "[ ]*ntp authentication-key .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.3 Set the 'ntp trusted-key'"
      info        : "Ensure you authenticate the identity of a system to which Network Time Protocol (NTP) will synchronize

Rationale:

This authentication function provides protection against accidentally synchronizing the system to another system that is not trusted, because the other system must know the correct authentication key."
      solution    : "Configure the NTP trusted key using the following command


hostname(config)#ntp trusted-key {ntp_key_id}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp trusted-key' command enforces encrypted authentication between NTP hosts.

Default Value:

Authentication of the identity of the system is disabled.



References:

http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-89CA798D-0F12-4AE8-B382-DE10CBD261DB"
      reference   : "800-53|IA-3,CSCv6|6.1,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|10.4.2,TBA-FIISB|27.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
      regex       : "[ ]*ntp trusted-key 10"
      item        : "[ ]*ntp trusted-key .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.4 Set 'key' for each 'ntp server'"
      info        : "Specifies the authentication key for NTP.

Rationale:

This authentication feature provides protection against accidentally synchronizing the ntp system to another system that is not trusted, because the other system must know the correct authentication key."
      solution    : "Configure each NTP Server to use a key ring using the following command.


hostname(config)#ntp server {ntp-server_ip_address}{key ntp_key_id}

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server key' command enforces encrypted authentication between NTP hosts.

Default Value:

No NTP key is set by default"
      reference   : "800-171|3.3.7,800-53|AU-8,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,LEVEL|2S,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @NTP_SERVER@ replaced with "192.168.0.1" in field "regex".
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
      regex       : "[ ]*ntp server 192.168.0.1 key 10"
      item        : "[ ]*ntp server .+ key .+"
    </item>

#
## 2.4 Loopback Rules
#

    <item>
      type            : CONFIG_CHECK
      description     : "2.4.1 Create a single 'interface loopback' - 'Only one loopback interface is defined'"
      info            : "Configure a single loopback interface.

Rationale:

Software-only loopback interface that emulates an interface that is always up. It is a virtual interface supported on all platforms.

Alternate loopback addresses create a potential for abuse, mis-configuration, and inconsistencies. Additional loopback interfaces must be documented and approved prior to use by local security personnel."
      solution        : "Define and configure one loopback interface.


hostname(config)#interface loopback <number>
hostname(config-if)#ip address <loopback_ip_address> <loopback_subnet_mask>

Impact:

Organizations should plan and establish 'loopback interfaces' for the enterprise network. Loopback interfaces enable critical network information such as OSPF Router IDs and provide termination points for routing protocol sessions.

Default Value:

There are no loopback interfaces defined by default.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF"
      reference       : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|9.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/2585"
      item            : "interface [Ll]oopback"
      max_occurrences : "1"
    </item>

    <item>
      type            : CONFIG_CHECK
      description     : "2.4.1 Create a single 'interface loopback' - 'Only one loopback interface IP Address is defined'"
      info            : "Configure a single loopback interface.

Rationale:

Software-only loopback interface that emulates an interface that is always up. It is a virtual interface supported on all platforms.

Alternate loopback addresses create a potential for abuse, mis-configuration, and inconsistencies. Additional loopback interfaces must be documented and approved prior to use by local security personnel."
      solution        : "Define and configure one loopback interface.


hostname(config)#interface loopback <number>
hostname(config-if)#ip address <loopback_ip_address> <loopback_subnet_mask>

Impact:

Organizations should plan and establish 'loopback interfaces' for the enterprise network. Loopback interfaces enable critical network information such as OSPF Router IDs and provide termination points for routing protocol sessions.

Default Value:

There are no loopback interfaces defined by default.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF"
      reference       : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|9.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/2585"
      context         : "interface [Ll]oopback"
      item            : "ip address"
      min_occurrences : "1"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.4.2 Set AAA 'source-interface'"
      info        : "Force AAA to use the IP address of a specified interface for all outgoing AAA packets

Rationale:

This is required so that the AAA server (RADIUS or TACACS+) can easily identify routers and authenticate requests by their IP address."
      solution    : "Bind AAA services to the loopback interface.


Hostname(config)#ip radius source-interface loopback {loopback_interface_number}
or
Hostname(config)#aaa group server tacacs+ {group_name} hostname(config-sg-tacacs+)#ip tacacs source-interface {loopback_interface_number}

Impact:

Organizations should design and implement authentication, authorization, and accounting (AAA) services for effective monitoring of enterprise network devices. Binding AAA services to the source-interface loopback enables these services.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i2.html#GUID-22E8B211-751F-48E0-9C76-58F0FE0AABA8

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-54A00318-CF69-46FC-9ADC-313BFC436713"
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),CN-L3|8.1.10.6(h),CSCv6|16.9,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),LEVEL|2S,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|3.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "ip (tacacs|radius) source-interface [Ll]oopback"
    </item>

    <if>
      <condition type:"OR">
        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP is bound to loopback'"
          item        : "[ ]*ntp source [Ll]oopback"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'SNTP is bound to loopback'"
          item        : "[ ]*sntp source-interface [Ll]oopback"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP/SNTP is bound to loopback'"
          info        : "Use a particular source address in Network Time Protocol (NTP) packets.

Rationale:

Set the source address to be used when sending NTP traffic. This may be required if the NTP servers you peer with filter based on IP address."
          solution    : "Bind the NTP service to the loopback interface.


hostname(config)#ntp source loopback {loopback_interface_number}

Impact:

Organizations should plan and implement network time protocol (NTP) services to establish official time for all enterprise network devices. Setting 'ntp source loopback' enforces the proper IP address for NTP services.

Default Value:

Source address is determined by the outgoing interface.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/bsm/command/bsm-cr-n1.html#GUID-DF29FBFB-E1C0-4E5C-9013-D4CE59CA0B88"
          reference   : "CSCv6|6.1,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </then>

      <else>
        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP is bound to loopback'"
          info        : "Use a particular source address in Network Time Protocol (NTP) packets."
          solution    : "Bind the NTP service to the loopback interface.
    hostname(config)#ntp source loopback {loopback_interface_number}"
          reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          item        : "[ ]*(ntp source|sntp source-interface) [Ll]oopback"
        </item>
      </else>
    </if>

    <item>
      type        : CONFIG_CHECK
      description : "2.4.4 Set 'ip tftp source-interface' to the Loopback Interface"
      info        : "Specify the IP address of an interface as the source address for TFTP connections.

Rationale:

This is required so that the TFTP servers can easily identify routers and authenticate requests by their IP address."
      solution    : "Bind the TFTP client to the loopback interface.


hostname(config)#ip tftp source-interface loopback {loobpback_interface_number}

Impact:

Organizations should plan and implement trivial file transfer protocol (TFTP) services in the enterprise by setting 'tftp source-interface loopback', which enables the TFTP servers to identify routers and authenticate requests by IP address.

Default Value:

The address of the closest interface to the destination is selected as the source address.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/fundamentals/command/F_through_K.html#GUID-9AA27050-A578-47CD-9F1D-5A8E2B449209"
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),CN-L3|8.1.10.6(h),CSCv6|9.1,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),LEVEL|2S,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|3.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "ip tftp source-interface [Ll]oopback"
    </item>

#
## 3 Data Plane
#
#
## 3.1 Routing Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "3.1.2 Set 'no ip proxy-arp'"
      info        : "Disable proxy ARP on all interfaces.

Rationale:

Address Resolution Protocol (ARP) provides resolution between IP and MAC Addresses (or other Network and Link Layer addresses on none IP networks) within a Layer 2 network.

Proxy ARP is a service where a device connected to one network (in this case the Cisco router) answers ARP Requests which are addressed to a host on another network, replying with its own MAC Address and forwarding the traffic on to the intended host.

Sometimes used for extending broadcast domains across WAN links, in most cases Proxy ARP on enterprise networks is used to enable communication for hosts with mis-configured subnet masks, a situation which should no longer be a common problem. Proxy ARP effectively breaks the LAN Security Perimeter, extending a network across multiple Layer 2 segments. Using Proxy ARP can also allow other security controls such as PVLAN to be bypassed."
      solution    : "Disable proxy ARP on all interfaces.


hostname(config)#interface {interface}
hostname(config-if)#no ip proxy-arp






Impact:

Organizations should plan and implement network policies to ensure unnecessary services are explicitly disabled. The 'ip proxy-arp' feature effectively breaks the LAN security perimeter and should be disabled.

Default Value:

Enabled

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/ipaddr/command/ipaddr-i4.html#GUID-AEB7DDCB-7B3D-4036-ACF0-0A0250F3002E"
      reference   : "800-171|3.13.1,800-53|SC-7(16),CSCv6|11,CSF|PR.PT-4,ITSG-33|SC-7(16),LEVEL|2S,NIAv2|GS8d,PCI-DSSv3.2|1.3.7,PCI-DSSv3.2|2.2.5"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      context     : "interface .+"
      item        : "no ip proxy-arp"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "3.1.3 Set 'no interface tunnel'"
      info        : "Verify no tunnel interfaces are defined.

Rationale:

Tunnel interfaces should not exist in general. They can be used for malicious purposes. If they are necessary, the network admin's should be well aware of them and their purpose."
      solution    : "Remove any tunnel interfaces.


hostname(config)#no interface tunnel {instance}

Impact:

Organizations should plan and implement enterprise network security policies that disable insecure and unnecessary features that increase attack surfaces such as 'tunnel interfaces'.

Default Value:

No tunnel interfaces are defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF"
      reference   : "800-171|3.13.2,800-171|3.13.5,800-171|3.13.7,800-53|SC-7(7),CSCv6|11,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|SC-7(7),LEVEL|2S,NIAv2|NS50,PCI-DSSv3.2|2.2.2"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      item        : "interface [Tt]unnel[0-9]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.1.4 Set 'ip verify unicast source reachable-via'"
      info        : "Examines incoming packets to determine whether the source address is in the Forwarding Information Base (FIB) and permits the packet only if the source is reachable through the interface on which the packet was received (sometimes referred to as strict mode).

Rationale:

Enabled uRPF helps mitigate IP spoofing by ensuring only packet source IP addresses only originate from expected interfaces. Configure unicast reverse-path forwarding (uRPF) on all external or high risk interfaces."
      solution    : "Configure uRPF.


hostname(config)#interface {interface_name}
hostname(config-if)#ip verify unicast source reachable-via rx

Impact:

Organizations should plan and implement enterprise security policies that protect the confidentiality, integrity, and availability of network devices. The 'unicast Reverse-Path Forwarding' (uRPF) feature dynamically uses the router table to either accept or drop packets when arriving on an interface.

Default Value:

Unicast RPF is disabled.



References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i3.html#GUID-2ED313DB-3D3F-49D7-880A-047463632757"
      reference   : "800-171|3.13.1,800-53|SC-7(16),CSCv6|11,CSF|PR.PT-4,ITSG-33|SC-7(16),LEVEL|2S,NIAv2|GS8d,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
      context     : "interface .+"
      regex       : "ip verify unicast source reachable-via rx"
      item        : "ip verify unicast"
    </item>

#
## 3.2 Border Routing Filtering
#

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny internal networks'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\.168\\.1\\.0 0\\.0\\.0\\.255" in field "regex".
      regex       : "deny +ip 192\\.168\\.1\\.0 0\\.0\\.0\\.255 any log"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\.168\\.1\\.0 0\\.0\\.0\\.255" in field "item".
      item        : "deny +ip 192\\.168\\.1\\.0 0\\.0\\.0\\.255 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 127.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 127\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 127\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 10.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 10\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 10\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 0.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 0\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 0\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 172.16.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 172\\.16\\.0\\.0 0\\.15\\.255\\.255 any log"
      item        : "deny +ip 172\\.16\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 192.168.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 192\\.168\\.0\\.0 0\\.0\\.255\\.255 any log"
      item        : "deny +ip 192\\.168\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 192.0.2.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 192\\.0\\.2\\.0 0\\.0\\.0\\.255 any log"
      item        : "deny +ip 192\\.0\\.2\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 169.254.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 169\\.254\\.0\\.0 0\\.0\\.255\\.255 any log"
      item        : "deny +ip 169\\.254\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 224.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 224\\.0\\.0\\.0 31\\.255\\.255\\.255 any log"
      item        : "deny +ip 224\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny host 255.255.255.255'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip host 255\\.255\\.255\\.255 any log"
      item        : "deny +ip host 255\\.255\\.255\\.255 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Default deny configured'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,CN-L3|7.1.2.2(c),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip any any log"
      item        : "deny +ip any .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - External interface has ACL applied"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span>name | number}
</span><span>hostname(config-nacl)#deny ip {</span>internal_networks} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_interface>
hostname(config-if)#access-group <access-list> in


Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies.

Default Value:

No access list defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-BD76E065-8EAC-4B32-AF25-04BA94DD2B11"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,LEVEL|2NS,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @EXTERNAL_INTERFACE@ replaced with "FastEthernet0/1" in field "context".
      context     : "interface FastEthernet0/1"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "item".
      item        : "ip access-group 3 in"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.2 Set inbound 'ip access-group' on the External Interface"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permitrule(s) above the final denyrule only allow traffic according to your organization's least privilege policy."
      solution    : "Apply the access-group for the external (untrusted) interface


hostname(config)#interface {external_interface}
hostname(config-if)#ip access-group {name | number} in

Impact:

Organizations should plan and implement enterprise security policies explicitly permitting and denying access based upon access lists. Using the 'ip access-group' command enforces these policies by explicitly identifying groups permitted access.

Default Value:

No access-group defined

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/security/d1/sec-cr-i1.html#GUID-D9FE7E44-7831-4C64-ACB8-840811A0C993"
      reference   : "800-171|3.13.1,800-53|SC-7(11),CSCv6|11,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),LEVEL|2NS,NIAv2|GS7c,PCI-DSSv3.2|1.2.1,TBA-FIISB|31.3"
      see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @EXTERNAL_INTERFACE@ replaced with "FastEthernet0/1" in field "context".
      context     : "interface FastEthernet0/1"
# Note: Variable @INTERNAL_NETWORK_INGRESS_ACL@ replaced with "1" in field "item".
      item        : "ip access-group 1 in"
    </item>

#
## 3.3 Neighbor Authentication
#

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "EIGRP is enabled"
          item        : "router eigrp .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for routing protocols. A key chain must have at least one key and can have up to 2,147,483,647 keys.

NOTE: Only DRP Agent, EIGRP, and RIPv2 use key chains.

Rationale:

Routing protocols such as DRP Agent, EIGRP, and RIPv2 use key chains for authentication."
          solution    : "Establish the key chain.


hostname(config)#key chain {key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key chains' for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-A62E89F5-0B8B-4CF0-B4EB-08F2762D88BB"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "key chain eigrp-keys"
          item        : "key chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key number.


hostname(config-keychain)#key {key-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key numbers' for key chains for routing protocols enforces these policies.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-3F31B2E0-0E4B-4F49-A4A8-8ADA1CA0D73F"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,PCI-DSSv3.2|3.6,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "key chain .+"
          item        : "key .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <key-string>

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key strings' for key chains for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-D7A8DC18-2E16-4EA5-8762-8B68B94CC43E"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|3.6,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "key chain .+"
          item        : "key-string .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.4 Set 'address-family ipv4 autonomous-system'"
          info        : "Configure the EIGRP address family.

Rationale:

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors"
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router eigrp .+"
          item        : "address-family ipv4.*autonomous-system [0-9]+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.5 Set 'af-interface default'"
          info        : "Defines user defaults to apply to EIGRP interfaces that belong to an address-family.

Rationale:

Part of the EIGRP address-family setup"
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface default

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'af-interface default' for EIGRP interfaces enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-DC0EF1D3-DFD4-45DF-A553-FA432A3E7233"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router eigrp .+"
          item        : "af-interface default"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.6 Set 'authentication key-chain'"
          info        : "Configure the EIGRP address family key chain.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the EIGRP address family key chain.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication key-chain {eigrp_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the address-family 'key chain' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

No key chains are specified for EIGRP





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-6B6ED6A3-1AAA-4EFA-B6B8-9BF11EEC37A0"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|4.1,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router eigrp .+"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "authentication key-chain eigrp-keys"
          item        : "authentication key-chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.7 Set 'authentication mode md5'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false service messages.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the EIGRP address family authentication mode.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'authentication mode' for EIGRP address-family or service-family packets enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not defined





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-A29E0EF6-4CEF-40A7-9824-367939001B73"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router eigrp .+"
          item        : "authentication mode md5"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.8 Set 'ip authentication key-chain eigrp'"
          info        : "Specify the type of authentication used in Enhanced Interior Gateway Routing Protocol (EIGRP) packets per interface.

Rationale:

Configuring EIGRP authentication key-chain number and name to restrict packet exchanges between network devices."
          solution    : "Configure the interface with the EIGRP key chain.


hostname(config)#interface {interface_name}
hostname(config-if)#ip authentication key-chain eigrp {eigrp_as-number} {eigrp_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication key chain' for EIGRP by name and number enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-0B344B46-5E8E-4FE2-A3E0-D92410CE5E91"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "interface .+"
# Note: Variable @AS_NUMBER@ replaced with "100" in field "regex".
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "ip authentication key-chain eigrp 100 eigrp-keys"
          item        : "ip authentication key-chain eigrp"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.9 Set 'ip authentication mode eigrp'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false routing messages.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the interface with the EIGRP authentication mode.


hostname(config)#interface {interface_name}
hostname(config-if)#ip authentication mode eigrp {<span>eigrp_as-number</span><span>}</span> md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication mode' for EIGRP by number and mode enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-8D1B0697-8E96-4D8A-BD20-536956D68506"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "interface .+"
# Note: Variable @AS_NUMBER@ replaced with "100" in field "regex".
          regex       : "ip authentication mode eigrp 100 md5"
          item        : "ip authentication mode eigrp"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.1.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for routing protocols. A key chain must have at least one key and can have up to 2,147,483,647 keys.

NOTE: Only DRP Agent, EIGRP, and RIPv2 use key chains.

Rationale:

Routing protocols such as DRP Agent, EIGRP, and RIPv2 use key chains for authentication."
          solution    : "Establish the key chain.


hostname(config)#key chain {key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key chains' for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-A62E89F5-0B8B-4CF0-B4EB-08F2762D88BB"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key number.


hostname(config-keychain)#key {key-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key numbers' for key chains for routing protocols enforces these policies.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-3F31B2E0-0E4B-4F49-A4A8-8ADA1CA0D73F"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <key-string>

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key strings' for key chains for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-D7A8DC18-2E16-4EA5-8762-8B68B94CC43E"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.4 Set 'address-family ipv4 autonomous-system'"
          info        : "Configure the EIGRP address family.

Rationale:

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors"
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.5 Set 'af-interface default'"
          info        : "Defines user defaults to apply to EIGRP interfaces that belong to an address-family.

Rationale:

Part of the EIGRP address-family setup"
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface default

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'af-interface default' for EIGRP interfaces enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-DC0EF1D3-DFD4-45DF-A553-FA432A3E7233"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.6 Set 'authentication key-chain'"
          info        : "Configure the EIGRP address family key chain.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the EIGRP address family key chain.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication key-chain {eigrp_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the address-family 'key chain' for EIGRP enforces these policies by restricting the exchanges between predefined network devices.

Default Value:

No key chains are specified for EIGRP





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-6B6ED6A3-1AAA-4EFA-B6B8-9BF11EEC37A0"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.7 Set 'authentication mode md5'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false service messages.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the EIGRP address family authentication mode.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'authentication mode' for EIGRP address-family or service-family packets enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not defined





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-67388D6C-AE9C-47CA-8C35-2A2CF9FA668E

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-C03CFC8A-3CE3-4CF9-9D65-52990DBD3377

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-a1.html#GUID-A29E0EF6-4CEF-40A7-9824-367939001B73"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.8 Set 'ip authentication key-chain eigrp'"
          info        : "Specify the type of authentication used in Enhanced Interior Gateway Routing Protocol (EIGRP) packets per interface.

Rationale:

Configuring EIGRP authentication key-chain number and name to restrict packet exchanges between network devices."
          solution    : "Configure the interface with the EIGRP key chain.


hostname(config)#interface {interface_name}
hostname(config-if)#ip authentication key-chain eigrp {eigrp_as-number} {eigrp_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication key chain' for EIGRP by name and number enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set





References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-0B344B46-5E8E-4FE2-A3E0-D92410CE5E91"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.1.9 Set 'ip authentication mode eigrp'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false routing messages.

Rationale:

This is part of the EIGRP authentication configuration"
          solution    : "Configure the interface with the EIGRP authentication mode.


hostname(config)#interface {interface_name}
hostname(config-if)#ip authentication mode eigrp {<span>eigrp_as-number</span><span>}</span> md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication mode' for EIGRP by number and mode enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_eigrp/command/ire-i1.html#GUID-8D1B0697-8E96-4D8A-BD20-536956D68506"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "OSPF is enabled"
          item        : "router ospf .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.2.1 Set 'authentication message-digest' for OSPF area"
          info        : "Enable MD5 authentication for OSPF.

Rationale:

This is part of the OSPF authentication setup."
          solution    : "Configure the Message Digest option for OSPF.


hostname(config)#router ospf <ospf_process-id>
hostname(config-router)#area <ospf_area-id> authentication message-digest

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the area 'authentication message-digest' for OSPF enforces these policies by restricting exchanges between network devices.

Default Value:

Not set



References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-3D5781A3-F8DF-4760-A551-6A3AB80A42ED

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-a1.html#GUID-81D0F753-D8D5-494E-9A10-B15433CFD445

Notes:

The authentication type must be the same for all routers and access servers in an area. The authentication password for all OSPF routers on a network must be the same if they are to communicate with each other via OSPF"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,PCI-DSSv3.2|4.1,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router ospf .+"
          item        : "area [^ ]+ authentication message-digest"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.2.2 Set 'ip ospf message-digest-key md5'"
          info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

Rationale:

This is part of the OSPF authentication setup"
          solution    : "Configure the appropriate interface(s) for Message Digest authentication


hostname(config)#interface {interface_name}
hostname(config-if)#ip ospf message-digest-key {ospf_md5_key-id} md5 {ospf_md5_key}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-939C79FF-8C09-4D5A-AEB5-DAF25038CA18"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "interface .+"
# Note: Variable @OSPF_KEY_ID@ replaced with "1" in field "regex".
          regex       : "ip ospf message-digest-key 1 md5 ([A-Za-z0-9]+)"
# Note: Variable @OSPF_KEY_ID@ replaced with "1" in field "item".
          item        : "ip ospf message-digest-key 1"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.2.1 Set 'authentication message-digest' for OSPF area"
          info        : "Enable MD5 authentication for OSPF.

Rationale:

This is part of the OSPF authentication setup."
          solution    : "Configure the Message Digest option for OSPF.


hostname(config)#router ospf <ospf_process-id>
hostname(config-router)#area <ospf_area-id> authentication message-digest

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the area 'authentication message-digest' for OSPF enforces these policies by restricting exchanges between network devices.

Default Value:

Not set



References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-3D5781A3-F8DF-4760-A551-6A3AB80A42ED

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-a1.html#GUID-81D0F753-D8D5-494E-9A10-B15433CFD445

Notes:

The authentication type must be the same for all routers and access servers in an area. The authentication password for all OSPF routers on a network must be the same if they are to communicate with each other via OSPF"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.2.2 Set 'ip ospf message-digest-key md5'"
          info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

Rationale:

This is part of the OSPF authentication setup"
          solution    : "Configure the appropriate interface(s) for Message Digest authentication


hostname(config)#interface {interface_name}
hostname(config-if)#ip ospf message-digest-key {ospf_md5_key-id} md5 {ospf_md5_key}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_ospf/command/ospf-i1.html#GUID-939C79FF-8C09-4D5A-AEB5-DAF25038CA18"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "RIP is enabled"
          context     : "interface .+"
          regex       : "ip rip"
          item        : "ip rip"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for RIPv2 routing protocols.

Rationale:

This is part of the routing authentication process."
          solution    : "Establish the key chain.


hostname(config)#key chain {rip_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key-chain (name)' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-A62E89F5-0B8B-4CF0-B4EB-08F2762D88BB"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
# Note: Variable @RIP_KEY_CHAIN@ replaced with "rip-keys" in field "regex".
          regex       : "key chain rip-keys"
          item        : "key chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key number.


hostname(config-keychain)#key {key-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-3F31B2E0-0E4B-4F49-A4A8-8ADA1CA0D73F"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,PCI-DSSv3.2|3.6,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "key chain .+"
# Note: Variable @RIP_KEY_NUMBER@ replaced with "key_number" in field "item".
          item        : "key key_number"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <key-string>

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key-string' for key chains for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-D7A8DC18-2E16-4EA5-8762-8B68B94CC43E"
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|3.6,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "key chain .+"
          item        : "key-string .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.4 Set 'ip rip authentication key-chain'"
          info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used on an interface.

Rationale:

This is part of the RIPv2 authentication setup"
          solution    : "Configure the Interface with the RIPv2 key chain.


hostname(config)#interface {interface_name}
hostname(config-if)#ip rip authentication key-chain {rip_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip rip authentication key-chain' by name enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_rip/command/irr-cr-rip.html#GUID-C1C84D0D-4BD0-4910-911A-ADAB458D0A84"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "interface .+"
# Note: Variable @RIP_KEY_CHAIN@ replaced with "rip-keys" in field "regex".
          regex       : "ip rip authentication key-chain rip-keys"
          item        : "ip rip authentication key-chain"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.5 Set 'ip rip authentication mode' to 'md5'"
          info        : "Configure the Interface with the RIPv2 key chain.

Rationale:

This is part of the RIPv2 authentication setup"
          solution    : "Configure the RIPv2 authentication mode on the necessary interface(s)


hostname(config)#interface <interface_name>
hostname(config-if)#ip rip authentication mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'ip rip authentication mode md5' enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_rip/command/irr-cr-rip.html#GUID-47536344-60DC-4D30-9E03-94FF336332C7"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CSCv6|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2S,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "interface .+"
          regex       : "ip rip authentication mode md5"
          item        : "ip rip authentication mode"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.3.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for RIPv2 routing protocols.

Rationale:

This is part of the routing authentication process."
          solution    : "Establish the key chain.


hostname(config)#key chain {rip_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key-chain (name)' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-A62E89F5-0B8B-4CF0-B4EB-08F2762D88BB"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.3.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key number.


hostname(config-keychain)#key {key-number}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices.

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-3F31B2E0-0E4B-4F49-A4A8-8ADA1CA0D73F"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.3.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup"
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <key-string>

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key-string' for key chains for routing protocols enforces these policies.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_pi/command/iri-cr-a1.html#GUID-D7A8DC18-2E16-4EA5-8762-8B68B94CC43E"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.3.4 Set 'ip rip authentication key-chain'"
          info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used on an interface.

Rationale:

This is part of the RIPv2 authentication setup"
          solution    : "Configure the Interface with the RIPv2 key chain.


hostname(config)#interface {interface_name}
hostname(config-if)#ip rip authentication key-chain {rip_key-chain_name}

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip rip authentication key-chain' by name enforces these policies by restricting the exchanges between network devices.

Default Value:

Not set







References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_rip/command/irr-cr-rip.html#GUID-C1C84D0D-4BD0-4910-911A-ADAB458D0A84"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>

        <report type:"PASSED">
          description : "3.3.3.5 Set 'ip rip authentication mode' to 'md5'"
          info        : "Configure the Interface with the RIPv2 key chain.

Rationale:

This is part of the RIPv2 authentication setup"
          solution    : "Configure the RIPv2 authentication mode on the necessary interface(s)


hostname(config)#interface <interface_name>
hostname(config-if)#ip rip authentication mode md5

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'ip rip authentication mode md5' enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/interface/command/ir-i1.html#GUID-0D6BDFCD-3FBB-4D26-A274-C1221F8592DF

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_rip/command/irr-cr-rip.html#GUID-47536344-60DC-4D30-9E03-94FF336332C7"
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "BGP is enabled"
          item        : "router [Bb][Gg][Pp] .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.4.1 Set 'neighbor password'"
          info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Rationale:

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing."
          solution    : "Configure BGP neighbor authentication where feasible.


hostname(config)#router bgp <bgp_as-number>
hostname(config-router)#neighbor <bgp_neighbor-ip | peer-group-name> password <password>





Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-n1.html#GUID-A8900842-ECF3-42D3-B188-921BE0EC060B

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-m1.html#GUID-159A8006-F0DF-4B82-BB71-C39D2C134205

Notes:

MD5 authentication between two BGP peers, meaning that each segment sent on the TCP connection between the peers is verified. MD5 authentication must be configured with the same password on both BGP peers."
          reference   : "800-53|IA-3,CSCv6|11,CSF|PR.AC-1,ITSG-33|IA-3,LEVEL|2S,NESA|T5.4.3,PCI-DSSv3.2|4.1,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/2585"
          context     : "router [Bb][Gg][Pp] .+"
          regex       : "neighbor [^ ]+ password ([A-Za-z0-9\\/\\$]{30})"
          item        : "neighbor [^ ]+ password .+"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.4.1 Set 'neighbor password'"
          info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Rationale:

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing."
          solution    : "Configure BGP neighbor authentication where feasible.


hostname(config)#router bgp <bgp_as-number>
hostname(config-router)#neighbor <bgp_neighbor-ip | peer-group-name> password <password>





Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices.

Default Value:

Not set

References:

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-n1.html#GUID-A8900842-ECF3-42D3-B188-921BE0EC060B

http://www.cisco.com/en/US/docs/ios-xml/ios/iproute_bgp/command/bgp-m1.html#GUID-159A8006-F0DF-4B82-BB71-C39D2C134205

Notes:

MD5 authentication between two BGP peers, meaning that each segment sent on the TCP connection between the peers is verified. MD5 authentication must be configured with the same password on both BGP peers."
          reference   : "CSCv6|11,LEVEL|2S"
          see_also    : "https://workbench.cisecurity.org/files/2585"
        </report>
      </else>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Cisco_IOS_15_v4.0.1_Level_2.audit for Cisco IOS 15 from CIS Cisco IOS 15 Benchmark v4.0.1"
      info        : "Nessus has not identified that Cisco IOS 15 is installed.
      NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/2585"
    </report>
  </else>
</if>

</check_type>
