#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2020/04/15 $
#
# Description   : This .audit is designed against the DISA Infrastructure L3 Switch Security
#                 Technical Implementation Guide Cisco Version 8 Release 29.
#
#                 https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip
#
#<ui_metadata>
#<display_name>DISA STIG Cisco Infrastructure L3 Switch v8r29</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Cisco Infrastructure L3 Switch</name>
#  <version>8.29.0</version>
#  <link>https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip</link>
#</spec>
#<labels>cisco,disa,ios,infrastructure,layer_3,switch</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>ISIS_KEY_CHAIN</name>
#    <default>isis-keys</default>
#    <description>IS-IS keychain name</description>
#    <info>The keychain for your organization's IS-IS authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#  <variable>
#    <name>EIGRP_KEY_CHAIN</name>
#    <default>eigrp-keys</default>
#    <description>EIGRP keychain</description>
#    <info>The keychain for your organization's EIGRP authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#  <variable>
#    <name>RIPv2_KEY_CHAIN</name>
#    <default>rip-keys</default>
#    <description>RIPv2 keychain</description>
#    <info>The keychain for your organization's RIPv2 authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#  <variable>
#    <name>KEY_CHAIN_NAME</name>
#    <default>keychain</default>
#    <description>Routing Protocol Key Chain Name</description>
#    <info>The key chain name for your organization's routing protocol.</info>
#  </variable>
#  <variable>
#    <name>EMERGENCY_ACCT</name>
#    <default>emergencyaccount</default>
#    <description>Emergency account</description>
#    <info>The username of the emergency account configured for your organization. The credentials for this account must be stored ina locked safe.</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_1</name>
#    <default>192\.168\.3\.1</default>
#    <description>NTP server address 1</description>
#    <info>The IP address of the first NTP server listed for your organization.</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER_2</name>
#    <default>192\.168\.3\.2</default>
#    <description>NTP server address 2</description>
#    <info>The IP address of the second NTP server listed for your organization.</info>
#  </variable>
#  <variable>
#    <name>MULTICAST_IP_1</name>
#    <default>192\.168\.3\.1</default>
#    <description>NTP multicast address 1</description>
#    <info>The IP address of the first NTP multicast address listed for your organization.</info>
#  </variable>
#  <variable>
#    <name>MULTICAST_IP_2</name>
#    <default>192\.168\.3\.2</default>
#    <description>NTP multicast address 2</description>
#    <info>The IP address of the second NTP multicast address listed for your organization.</info>
#  </variable>
#  <variable>
#    <name>NMS_LIST</name>
#    <default>1</default>
#    <description>NMS ACL - ACL ID</description>
#    <info>The ACL list number for your organization's network management system SNMP ACL.</info>
#  </variable>
#  <variable>
#    <name>NMS_HOST_1</name>
#    <default>192\.168\.0\.1</default>
#    <description>NMS ACL - authorized host address</description>
#    <info>The IP address of the permitted host for network management system SNMP requests.</info>
#  </variable>
#  <variable>
#    <name>INTERNAL_INTERFACE</name>
#    <default>FastEthernet0/0</default>
#    <description>Internal interface</description>
#    <info>The name of the internal interface for your organization.</info>
#  </variable>
#  <variable>
#    <name>CONTROL_PLANE_POLICY</name>
#    <default>controlplanepolicy</default>
#    <description>Control plane service policy</description>
#    <info>The name of your organization's control-plane service policy. This policy is designed to mitigate DoS attacks but requires preparation. For more information see result NET0966 - Control plan protection is not enabled.</info>
#  </variable>
#  <variable>
#    <name>IP_RECEIVE_ACL</name>
#    <default>1</default>
#    <description>IP receive ACL ID</description>
#    <info>The access control list number for IP receive filtering. This should be used if if Control Plane is not in use. Review the ACL list to ensure it is configured correctly to filter traffic.</info>
#  </variable>
#  <variable>
#    <name>OOBM_EGRESS_ACL</name>
#    <default>1</default>
#    <description>OOBM egress ACL ID</description>
#    <info>The access control list number for egress through the out of band management (OOBM) interface. This interface grants the management network access to the router.</info>
#  </variable>
#  <variable>
#    <name>OOBM_INTERFACE</name>
#    <default>Serial0</default>
#    <description>OOBM interface</description>
#    <info>The OOBM interface name. It is used for VPN connectivity. The management network must be restricted to accessing this interface or information from the managed network will leak.</info>
#  </variable>
#  <variable>
#    <name>LOCAL_MANAGEMENT_NETWORK</name>
#    <default>10\.10\.2\.0 0\.0\.0\.255</default>
#    <description>Management network</description>
#    <info>The local management network address and wildcard mask. Access to this network through the out of band management (OOBM) interface must be restricted to the remote management network (e.g. NOC).</info>
#  </variable>
#  <variable>
#    <name>REMOTE_MANAGEMENT_NETWORK</name>
#    <default>10\.10\.1\.0 0\.0\.0\.255</default>
#    <description>Remote management network</description>
#    <info>The remote management network range (such as the NOC's range). This range must be granted access through the out of band management (OOBM) interface.</info>
#  </variable>
#  <variable>
#    <name>OOBM_INGRESS_ACL</name>
#    <default>2</default>
#    <description>OOBM ingress ACL ID</description>
#    <info>The access control list number for ingress through the out of band management (OOBM) interface. This interface grants the management network access to the router.</info>
#  </variable>
#  <variable>
#    <name>MANAGEMENT_INTERFACE</name>
#    <default>FastEthernet0</default>
#    <description>Management interface</description>
#    <info>The name of the management interface for your organization.</info>
#  </variable>
#  <variable>
#    <name>MANAGEMENT_IP_AND_NETMASK</name>
#    <default>10\.10\.2\.1 255\.255\.255\.0</default>
#    <description>Management interface network</description>
#    <info>The IP address and network mask of the router's management interface.</info>
#  </variable>
#  <variable>
#    <name>MGMT_INGRESS_ACL</name>
#    <default>12</default>
#    <description>Management ingress ACL ID</description>
#    <info>The ingress access control list for blocking your organization's non-management traffic from your management network.</info>
#  </variable>
#  <variable>
#    <name>MGMT_EGRESS_ACL</name>
#    <default>13</default>
#    <description>Management egress ACL ID</description>
#    <info>The egress access control list for blocking your organization's management traffic from your non-management network.</info>
#  </variable>
#  <variable>
#    <name>OOBM_LOCAL_POLICY</name>
#    <default>icmproutemap</default>
#    <description>OOBM filtering route-map</description>
#    <info>The policy name for your organization's local OOBM filtering route-map.</info>
#  </variable>
#  <variable>
#    <name>NIPRNET_LINK_INTERFACE</name>
#    <default>FastEthernet0</default>
#    <description>NIPRNet link interface</description>
#    <info>The name of the router's interface that connects to the NIPRNET Provider.</info>
#  </variable>
#  <variable>
#    <name>IN_BAND_MGMT_VPN</name>
#    <default>inbandvpn</default>
#    <description>In-band management VPN</description>
#    <info>The VPN crypto map name for in-band management of the device.</info>
#  </variable>
#  <variable>
#    <name>IN_BAND_MGMT_VPN_ACL</name>
#    <default>10</default>
#    <description>In-band management ACL ID</description>
#    <info>The number of the access control list filtering VPN access for in-band management of the device.</info>
#  </variable>
#  <variable>
#    <name>MANAGEMENT_TRAFFIC</name>
#    <default>mgmttraffic</default>
#    <description>Management traffic class-map</description>
#    <info>The name for your organization's class-map name for management traffic.</info>
#  </variable>
#  <variable>
#    <name>MGMT_TRAFFIC_CLASSIFICATION_ACL</name>
#    <default>mgmttrafficclass</default>
#    <description>Management traffic class ACL</description>
#    <info>The extended access control list name classifying your organization's management traffic. It must permit any address to connect to the local management network.</info>
#  </variable>
#  <variable>
#    <name>DIST_LAYER_POLICY</name>
#    <default>mgmttraffic</default>
#    <description>Management traffic policy-map</description>
#    <info>The name for your organization's policy-map name for the management traffic.</info>
#  </variable>
#  <variable>
#    <name>DIST_LAYER_DSCP_VALUE</name>
#    <default>1</default>
#    <description>Management traffic DSCP value</description>
#    <info>The DSCP value for your organization's management traffic.</info>
#  </variable>
#  <variable>
#    <name>LOGGING_HOST_IP</name>
#    <default>192\.168\.2\.1</default>
#    <description>Syslog host address</description>
#    <info>The IP address for your organization's logging host. Syslog messages must be sent to this address.</info>
#  </variable>
#  <variable>
#    <name>AAA_LOGIN_LIST</name>
#    <default>networkadmins</default>
#    <description>AAA login group</description>
#    <info>The TACACS+ or RADIUS group configured on the device. This group is allowed to authenticate through http, con, and vty interfaces.</info>
#  </variable>
#  <variable>
#    <name>VTY_AUTH_IP</name>
#    <default>192\.168\.1\.0 0\.0\.0\.255</default>
#    <description>VTY authorized network</description>
#    <info>The individual IP address or network address and wildcard mask that are allowed to access the router through VTY.</info>
#  </variable>
#  <variable>
#    <name>VTY_ACL</name>
#    <default>20</default>
#    <description>VTY ACL ID</description>
#    <info>The access control list number restricting VTY access.</info>
#  </variable>
#  <variable>
#    <name>OOBM_VPN</name>
#    <default>oobmvpn</default>
#    <description>OOOBM VPN crypto map</description>
#    <info>The VPN crypto map name for out-of-band management of the device.</info>
#  </variable>
#  <variable>
#    <name>OOBM_VPN_ACL</name>
#    <default>10</default>
#    <description>OOBM VPN ACL ID</description>
#    <info>The number of the access control list filtering VPN access for out-of-band management of the device.</info>
#  </variable>
#  <variable>
#    <name>IPV6_EGRESS_ACL</name>
#    <default>9</default>
#    <description>IPv6 egress ACL ID</description>
#    <info>The access control list number for IPv6 outbound connection filtering.</info>
#  </variable>
#  <variable>
#    <name>OUT_TO_BACKBONE_ACL</name>
#    <default>7</default>
#    <description>IPv6 backbone ACL ID</description>
#    <info>The access control list number for IPv6 outbound to backbone connection filtering.</info>
#  </variable>
#  <variable>
#    <name>TUNNEL_SRC_INTERFACE</name>
#    <default>FastEthernet0/1</default>
#    <description>Tunnel Source Interface</description>
#    <info>The source interface of the 6to4 tunnel interface.</info>
#  </variable>
#  <variable>
#    <name>IPV4_EGRESS_ACL</name>
#    <default>9</default>
#    <description>IPv4 egress ACL ID</description>
#    <info>The access control list number for IPv4 outbound connection filtering.</info>
#  </variable>
#  <variable>
#    <name>V4ADDR</name>
#    <default>C612:1</default>
#    <description>IPv4 6to4 address</description>
#    <info>The hexadecimal representation of the IPv4 address of the internal network interface.</info>
#  </variable>
#  <variable>
#    <name>PIM_INTERFACE</name>
#    <default>FastEther0/3</default>
#    <description>IP PIM-enabled interface</description>
#    <info>IP interface with PIM enabled.</info>
#  </variable>
#  <variable>
#    <name>IP_PIM_NEIGHBORS_ACL</name>
#    <default>IP_PIM_NEIGHBORS</default>
#    <description>IP standard access-list</description>
#    <info>The standard access-list used for filtering authorized PIM neighbors.</info>
#  </variable>
#  <variable>
#    <name>IPV6_PIM_NEIGHBORS_ACL</name>
#    <default>IPV6_PIM_NEIGHBORS</default>
#    <description>IPV6 PIM access-list</description>
#    <info>The IPv6 access-list used for filtering authorized PIM neighbors.</info>
#  </variable>
#  <variable>
#    <name>MCAST_ADMIN_SCOPED_BOUNDARY</name>
#    <default>MCAST_ADMIN_SCOPED_BOUNDARY</default>
#    <description>Standard IP access-list multicast</description>
#    <info>The filter used to effect multicast traffic outside of the administratively scoped IPv4 multicast space.</info>
#  </variable>
#  <variable>
#    <name>MANAGEMENT_INTERFACE_PORT</name>
#    <default>GigabitEthernet1/0/1</default>
#    <description>Switch Port Management Interface</description>
#    <info>The management interface port for your organization.</info>
#  </variable>
#  <variable>
#    <name>MGMT_VLAN_ID</name>
#    <default>5</default>
#    <description>Management VLAN Identification</description>
#    <info>The management vlan configured for your organization's mangement network element's OOBM interface.</info>
#  </variable>
#  <variable>
#    <name>TRUNK_INTERFACE</name>
#    <default>GigabitEthernet1/0/10</default>
#    <description>OOBM Switch Trunk Port</description>
#    <info>The device's trunk listening interface.</info>
#  </variable>
#  <variable>
#    <name>ALLOWED_VLANS</name>
#    <default>2-9</default>
#    <description>Permitted Non-OOBM VLANs</description>
#    <info>The vlans that are allowed on the trunk interface excluding the management vlan.</info>
#  </variable>
#  <variable>
#    <name>MGMT_VLAN_Interface</name>
#    <default>Vlan5</default>
#    <description>Layer 3 MGMT VLAN Interface</description>
#    <info>The VLAN interface configured to carry the management network traffic.</info>
#  </variable>
#  <variable>
#    <name>MGMT_VLAN_ACL</name>
#    <default>108</default>
#    <description>MGMT VLAN Access-List</description>
#    <info>The MGMT access-list configured to control management traffic.</info>
#  </variable>
#  <variable>
#    <name>SSH_ALGORITHM_MAC</name>
#    <default>hmac-sha1 hmac-sha1-96</default>
#    <description>SSH Algorithm MAC</description>
#    <info>The list of SSH algorithm MAC types</info>
#  </variable>
#  <variable>
#    <name>SSH_ALGORITHM_ENCRYPTION</name>
#    <default>aes128-cbc aes192-cbc aes256-cbc</default>
#    <description>SSH Algorithm Encryption</description>
#    <info>The list of SSH algorithm encryption types</info>
#  </variable>
#  <variable>
#    <name>BANNER_LOGIN</name>
#    <default>I've read & consent to terms in IS user agreem't.</default>
#    <description>Banner displayed at login</description>
#    <info>Standard Mandatory DoD Notice and Consent Banner</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<item>
  type        : CONFIG_CHECK
  description : "NET0230 - Network element is not password protected"
  info        : "The network element must be password protected.

 Network access control mechanisms interoperate to prevent unauthorized access and to enforce the organization's security policy. Access to the network must be categorized as administrator, user, or guest so the appropriate authorization can be assigned to the user requesting access to the network or a network element. Authorization requires an individual account identifier that has been approved, assigned, and configured on an authentication server. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multi-factor authentication, some combination thereof. Lack of authentication enables anyone to gain access to the network or possibly a network element providing opportunity for intruders to compromise resources within the network infrastructure."
  solution    : "Configure the network element so it will require a password to gain administrative access to the device."
  reference   : "800-171|3.5.1,800-53|IA-2,8500.2|ECSC-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-3012r4_rule,STIG-ID|NET0230,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-3012"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line (con|aux|vty) .*"
  item        : "login"
</item>

<report type:"WARNING">
  description : "NET0240 - Devices exist with standard default passwords"
  info        : "The network element must not have any default manufacturer passwords.

 Network elements not protected with strong password schemes provide the opportunity for anyone to crack the password thus gaining access to the device and causing network outage or denial of service. Many default vendor passwords are well known; hence, not removing them prior to deploying the network element into production provides an opportunity for a malicious user to gain unauthorized access to the device.

 NOTE: Nessus did not perform this check as it requires other verification as to whether or not the device is configured.
 NOTE: Nessus Plugin ID 23938 Cisco Device Default Password maybe used to assist in verification.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove any vendor default passwords from the network element configuration."
  reference   : "8500.2|ECSC-1,CAT|I,Rule-ID|SV-3143r4_rule,STIG-ID|NET0240,Vuln-ID|V-3143"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : BANNER_CHECK
  description : "NET0340 - Network devices must display the DoD-approved logon banner warning."
  info        : "All network devices must present a DoD-approved warning banner prior to a system administrator logging on. The banner should warn any unauthorized user not to proceed. It also should provide clear and unequivocal notice to both authorized and unauthorized personnel that access to the device is subject to monitoring to detect unauthorized usage. Failure to display the required logon warning banner prior to logon attempts will limit DoD's ability to prosecute unauthorized access and also presents the potential to give rise to criminal and civil liability for systems administrators and information systems managers. In addition, DISA's ability to monitor the device's usage is limited unless a proper warning banner is displayed.

DoD CIO has issued new, mandatory policy standardizing the wording of 'notice and consent' banners and matching user agreements for all Secret and below DoD information systems, including stand-alone systems by releasing DoD CIO Memo, 'Policy on Use of Department of Defense (DoD) Information Systems Standard Consent Banner and User Agreement', dated 9 May 2008. The banner is mandatory and deviations are not permitted except as authorized in writing by the Deputy Assistant Secretary of Defense for Information and Identity Assurance. Implementation of this banner verbiage is further directed to all DoD components for all DoD assets via USCYBERCOM CTO 08-008A."
  solution    : "Configure all management interfaces to the network device to display the DoD-mandated warning banner verbiage at logon regardless of the means of connection or communication. The required banner verbiage that must be displayed verbatim is as follows:

Option A

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

Option B

If the system is incapable of displaying the required banner verbiage due to its size, a smaller banner must be used. The mandatory verbiage follows: 'I've read & consent to terms in IS user agreem't.'"
  reference   : "800-171|3.1.9,800-53|AC-8,8500.2|ECWM-1,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSSv3.2|2.2.4,Rule-ID|SV-3013r5_rule,STIG-ID|NET0340,TBA-FIISB|45.2.4,Vuln-ID|V-3013"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "banner login"
# Note: Variable @BANNER_LOGIN@ replaced with "I've read & consent to terms in IS user agreem't." in field "content".
  content     : "I've read & consent to terms in IS user agreem't."
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Interior routing protocols are not authenticated - 'OSPFv2 Check'"
      item        : "router ospf ([0-9]+)"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'OSPFv2 (Interface Check)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
      item        : "ip ospf message-digest-key ([0-9]+) md5"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'OSPFv2 (Router Check)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "router ospf ([0-9]+)"
      item        : "area ([0-9]+) authentication message-digest"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'OSPFv2 (Interface Check)'"
      info        : "OSPF not present in the configuration so checks related to OSPF authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'OSPFv2 (Router Check)'"
      info        : "OSPF not present in the configuration so checks related to OSPF authentication are not applicable."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Interior routing protocols are not authenticated - 'IS-IS Check'"
      item        : "router isis"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Interface Check - isis authentication mode)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
      item        : "isis authentication mode md5 (level-[1|2])"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Interface Check - isis authentication key-chain)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
      item        : "isis authentication key-chain ([^ ]+) (level-[1|2])"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Router Check - authentication mode)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "router isis"
      item        : "authentication mode md5 (level-[1|2])"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Router Check - authentication key-chain)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "router isis"
      item        : "authentication key-chain ([^ ]+) (level-[1|2])"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Key-Chain Check)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks.

 NOTE: Change 'ISIS_KEY_CHAIN' to the key-chain for your organization's IS-IS authentication."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @ISIS_KEY_CHAIN@ replaced with "isis-keys" in field "item".
      item        : "key chain isis-keys"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Interface Check - isis authentication mode)'"
      info        : "IS-IS routing protocol not present in the configuration so checks related to IS-IS authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Interface Check - isis authentication key-chain)'"
      info        : "IS-IS routing protocol not present in the configuration so checks related to IS-IS authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Router Check - authentication mode)'"
      info        : "IS-IS routing protocol not present in the configuration so checks related to IS-IS authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Router Check - authentication key-chain)'"
      info        : "IS-IS routing protocol not present in the configuration so checks related to IS-IS authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'IS-IS (Key-Chain Check)'"
      info        : "IS-IS routing protocol not present in the configuration so checks related to IS-IS authentication are not applicable."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Interior routing protocols are not authenticated - 'EIGRP Check'"
      item        : "router eigrp ([0-9]+)"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Interface Check - authentication mode)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)? ?([0-9]+\/[0-9].?[0-9]?)?"
      item        : "ip authentication mode eigrp ([0-9]+) md5"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Interface Check - authentication key-chain)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)? ?([0-9]+\/[0-9].?[0-9]?)?"
      item        : "ip authentication key-chain eigrp ([0-9]+) ([^ ]+)"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Key-Chain Check)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks.

 NOTE: Change 'EIGRP_KEY_CHAIN' to the key-chain for your organization's EIGRP authentication."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @EIGRP_KEY_CHAIN@ replaced with "eigrp-keys" in field "item".
      item        : "key chain eigrp-keys"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Interface Check - authentication mode)'"
      info        : "EIGRP not present in the configuration so checks related to EIGRP authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Interface Check - authentication key-chain)'"
      info        : "EIGRP not present in the configuration so checks related to EIGRP authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'EIGRP (Key-Chain Check)'"
      info        : "EIGRP not present in the configuration so checks related to EIGRP authentication are not applicable."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Interior routing protocols are not authenticated - 'RIP Check'"
      item        : "router rip"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Interface Check - authentication mode)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
      item        : "ip rip authentication mode md5"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Interface Check - authentication key-chain)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
      item        : "ip rip authentication key-chain ([^ ]+)"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Key-Chain Check)'"
      info        : "The network element must authenticate all IGP peers.

 A rogue router could send a fictitious routing update to convince a site's premise router to send traffic to an incorrect or even a rogue destination.  This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks.

 NOTE: Change 'RIPv2_KEY_CHAIN' to the key-chain for your organization's EIGRP authentication."
      solution    : "Configure authentication for all IGP peers."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @RIPv2_KEY_CHAIN@ replaced with "rip-keys" in field "item".
      item        : "key chain rip-keys"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Interface Check - authentication mode)'"
      info        : "RIPv2 not present in the configuration so checks related to RIPv2 authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Interface Check - authentication key-chain)'"
      info        : "RIPv2 not present in the configuration so checks related to RIPv2 authentication are not applicable."
      reference   : "800-171|3.13.8,800-53|SC-8,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3034"
    </report>

    <report type:"PASSED">
      description : "NET0400 - Interior routing protocols are not authenticated - 'RIPv2 (Key-Chain Check)'"
      info        : "RIPv2 not present in the configuration so checks related to RIPv2 authentication are not applicable."
      reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,Rule-ID|SV-15290r2_rule,STIG-ID|NET0400,TBA-FIISB|27.1,Vuln-ID|V-3034"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0405 - A service or feature that calls home to the vendor must be disabled."
  info        : "Call home services or features will routinely send data such as configuration and diagnostic information to the vendor for routine or emergency analysis and troubleshooting. The risk that transmission of sensitive data sent to unauthorized persons could result in data loss or downtime due to an attack.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the network device to disable the call home service or feature.

The command below will disable the call-home service on a Cisco device.
Example:
hostname(config)# no service call-home

Note: This feature can be enabled if the communication is only to a server residing in the local area network or enclave."
  reference   : "800-171|3.1.7,800-53|AC-6(10),8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,PCI-DSSv3.2|2.2.5,Rule-ID|SV-38003r3_rule,STIG-ID|NET0405,Vuln-ID|V-28784"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  cmd         : "show call-home"
  context     : "Current call home settings:"
  item        : ".+call home feature.+disable"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0408 - BGP must authenticate all peers"
  info        : "The network element must authenticate all BGP peers within the same or between autonomous systems (AS).

 As specified in RFC 793, TCP utilizes sequence checking to ensure proper ordering of received packets. RFC 793 also specifies that RST (reset) control flags should be processed immediately, without waiting for out of sequence packets to arrive. RFC 793 also requires that sequence numbers are checked against the window size before accepting data or control flags as valid. A router receiving an RST segment will close the TCP session with the BGP peer that is being spoofed; thereby, purging all routes learned from that BGP neighbor. A RST segment is valid as long as the sequence number is within the window. The TCP reset attack is made possible due to the requirements that Reset flags should be processed immediately and that a TCP endpoint must accept out of order packets that are within the range of a window size. This reduces the number of sequence number guesses the attack must make by a factor equivalent to the active window size. Each sequence number guess made by the attacker can be simply incremented by the receiving connections window size. The BGP peering session can protect itself against such an attack by authenticating each TCP segment. The TCP header options include an MD5 signature in every packet and are checked prior to the acceptance and processing of any TCP packet-including RST flags.

 One way to create havoc in a network is to advertise bogus routes to a network. A rogue router could send a fictitious routing update to convince a BGP router to send traffic to an incorrect or rogue destination. This diverted traffic could be analyzed to learn confidential information of the site's network, or merely used to disrupt the network's ability to effectively communicate with other networks. An autonomous system can advertise incorrect information by sending BGP updates messages to routers in a neighboring AS. A malicious AS can advertise a prefix originated from another AS and claim that it is the originator (prefix hijacking). Neighboring autonomous systems receiving this announcement will believe that the malicious AS is the prefix owner and route packets to it."
  solution    : "The administrator must configure the router to authenticate all BGP peers."
  reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|4.1,Rule-ID|SV-41555r2_rule,STIG-ID|NET0408,TBA-FIISB|27.1,Vuln-ID|V-31285"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "router bgp ([0-9]+)"
  item        : "neighbor ([^ ]+) password ([^ ]+)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0422 - Keys expiration exceeds 180 days."
  info        : "If the keys used for routing protocol authentication are guessed, the malicious user could create havoc within the network by advertising incorrect routes and redirecting traffic. Changing the keys frequently reduces the risk of them eventually being guessed. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates, both with 180-day or less expirations.

  NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure the device so rotating keys expire at 180 days or less."
  reference   : "800-53|IA-3,8500.2|IAKM-1,8500.2|IAKM-2,8500.2|IAKM-3,CAT|III,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-15301r4_rule,STIG-ID|NET0422,TBA-FIISB|27.1,Vuln-ID|V-14667"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "key chain .+"
  item        : ".*lifetime.*"
  severity    : MEDIUM
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Third key set to accept-lifetime infinite'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "accept-lifetime .* infinite"
  max_occurrences : "1"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Third key set to send-lifetime infinite'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "send-lifetime .* infinite"
  max_occurrences : "1"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Ensure rotating keys are not set to accept-lifetime infinite - Key 1'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "accept-lifetime( +local|) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+)$"
  min_occurrences : "2"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Ensure rotating keys are not set to accept-lifetime infinite - Key 2'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "accept-lifetime( +local|) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+)$"
  min_occurrences : "2"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Ensure rotating keys are not set to send-lifetime infinite - Key 1'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "send-lifetime( +local|) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+)$"
  min_occurrences : "2"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0425 - An Infinite Lifetime key has not been implemented - 'Ensure rotating keys are not set to send-lifetime infinite - Key 2'"
  info            : "Only Interior Gateway Protocols (IGPs) use key chains. When configuring authentication for routing protocols that provide key chains, configure two rotating keys with overlapping expiration dates--both with a 180-day or less lifetime. A third key must also be defined with an infinite lifetime. Both of these steps ensure there will always be a key that can be placed into service by all peers. If a time period occurs during which no key is activated, authentication cannot occur; hence, route updates will not occur. The lifetime key should be changed 7 days after successful key rotation and synchronization has occurred with all peers.

 Notes: Only Interior Gateway Protocols (IGPs) use key chains.
 Notes: When using authentication keys, it is imperative the site is in compliance with the NTP policies. The router has to know the time!
 Notes: Must make this a high number to ensure you have plenty of room to put keys in before it. All subsequent keys will be decremented by one (9998, 9997...)."
  solution        : "This check is in place to ensure keys do not expire creating a DOS due to adjacencies being dropped and routes being aged out. The recommendation is to use two rotating six month keys with a third key set as infinite lifetime. The lifetime key should be changed 7 days after the rotating keys have expired and redefined."
  reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.5.3,PCI-DSSv3.2|3.6.4,Rule-ID|SV-7363r3_rule,STIG-ID|NET0425,Vuln-ID|V-7009"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "keychain" in field "context".
  context         : "key chain keychain"
  item            : "send-lifetime( +local|) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+) ([^ ]+) ([A-Za-z]+) ([0-9]|1[0-9]|2[0-9]|3[0-1]) ([0-9]+)$"
  min_occurrences : "2"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - The device is not authenticated using a AAA server - 'aaa new-model'"
  info        : "The network element must use two or more authentication servers for the purpose of granting administrative access.

 The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

 The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands. For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes."
  solution    : "Ensure an authentication server is required to access the device and that there are two or more authentication servers defined."
  reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.5.1,800-53|AC-3,800-53|AU-2,800-53|IA-2,8500.2|IAIA-1,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.10.2(c),CN-L3|8.1.4.1(a),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AU-2,ITSG-33|IA-2,NESA|M1.2.2,NESA|M5.5.1,NESA|T2.3.8,NESA|T4.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM3,NIAv2|AM7,NIAv2|AM8,NIAv2|SS29,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,SWIFT-CSCv1|6.4,TBA-FIISB|31.1,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "aaa new-model"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - The device is not authenticated using a AAA server - 'aaa authentication login'"
  info        : "The network element must use two or more authentication servers for the purpose of granting administrative access.

 The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

 The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands. For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes."
  solution    : "Ensure an authentication server is required to access the device and that there are two or more authentication servers defined."
  reference   : "800-171|3.5.1,800-53|IA-2,8500.2|IAIA-1,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "aaa authentication login ([^ ]+|default group) ([^ ]*) local"
</item>

<item>
  type            : CONFIG_CHECK
  description     : "NET0433 - The device is not authenticated using a AAA server - 'tacacs-server host(s) - more than 2 hosts exist'"
  info            : "The network element must use two or more authentication servers for the purpose of granting administrative access.

 The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

 The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands. For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes."
  solution        : "Ensure an authentication server is required to access the device and that there are two or more authentication servers defined."
  reference       : "800-171|3.5.1,800-53|IA-2,8500.2|IAIA-1,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CSF|PR.AC-1,ITSG-33|IA-2,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,Vuln-ID|V-15432"
  see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item            : "(tacacs|radius)-server host [^ ]+"
  min_occurrences : "2"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - The device is not authenticated using a AAA server - 'ip http authentication'"
  info        : "The network element must use two or more authentication servers for the purpose of granting administrative access.

 The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

 The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands. For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes."
  solution    : "Ensure an authentication server is required to access the device and that there are two or more authentication servers defined."
  reference   : "800-171|3.5.1,800-53|IA-2,8500.2|IAIA-1,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip http authentication aaa"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0433 - The device is not authenticated using a AAA server - 'line con - authentication'"
  info        : "The network element must use two or more authentication servers for the purpose of granting administrative access.

 The use of Authentication, Authorization, and Accounting (AAA) affords the best methods for controlling user access, authorization levels, and activity logging.  By enabling AAA on the routers in conjunction with an authentication server such as TACACS+ or RADIUS, the administrators can easily add or remove user accounts, add or remove command authorizations, and maintain a log of user activity.

 The use of an authentication server provides the capability to assign router administrators to tiered groups that contain their privilege level that is used for authorization of specific commands. For example, user mode would be authorized for all authenticated administrators while configuration or edit mode should only be granted to those administrators that are permitted to implement router configuration changes."
  solution    : "Ensure an authentication server is required to access the device and that there are two or more authentication servers defined."
  reference   : "800-171|3.5.1,800-53|IA-2,8500.2|IAIA-1,CAT|II,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1,Rule-ID|SV-16259r4_rule,STIG-ID|NET0433,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15432"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line con 0"
  item        : "login authentication ([^ ]+|default)"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "More than one local account is defined - aaa new-model"
      item        : "aaa new-model"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "More than one local account is defined aaa auth"
      item        : "aaa authentication login default local"
    </item>
  </condition>

  <then>
    <item>
      type            : CONFIG_CHECK
      description     : "NET0440 - More than one local account is defined."
      info            : "In the event the authentication server is unavailable, the network device must have a single local account of last resort defined.

 Authentication for administrative access to the device is required at all times. A single account of last resort can be created on the device's local database for use in an emergency such as when the authentication server is down or connectivity between the device and the authentication server is not operable. The console or local account of last resort logon credentials must be stored in a sealed envelope and kept in a safe."
      solution        : "Configure the device to only allow one local account of last resort for emergency access and store the credentials in a secure manner."
      reference       : "800-171|3.1.5,800-53|AC-6(1),8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15469r6_rule,STIG-ID|NET0440,SWIFT-CSCv1|5.1,Vuln-ID|V-3966"
      see_also        : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      item            : "username ([^ ]+)"
      max_occurrences : "1"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0440 - More than one local account is defined."
      info        : "In the event the authentication server is unavailable, the network device must have a single local account of last resort defined.

 Authentication for administrative access to the device is required at all times. A single account of last resort can be created on the device's local database for use in an emergency such as when the authentication server is down or connectivity between the device and the authentication server is not operable. The console or local account of last resort logon credentials must be stored in a sealed envelope and kept in a safe.

NOTE: It does not appear that an authentication server is defined for gaining administrative access on this device, therefore more than one account may be configured locally within the guidance of your applicable security policy."
      solution    : "Configure the device to only allow one local account of last resort for emergency access and store the credentials in a secure manner."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15469r6_rule,STIG-ID|NET0440,SWIFT-CSCv1|5.1,Vuln-ID|V-3966"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0441 - Emergency administration account privilege level is not set."
  info        : "The emergency administration account must be set to an appropriate authorization level to perform necessary administrative functions when the authentication server is not online.

 NOTE: Change 'EMERGENCY_ACCT' to the username of the emergency administrator account configured for your organization. The credentials for this account must be stored in a locked safe."
  solution    : "Assign a privilege level to the emergency administration account to allow the administrator to perform necessary administrative functions when the authentication server is not online."
  reference   : "800-171|3.5.1,800-53|IA-2,800-53|IA-5(1),8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-5(1),NESA|T2.3.8,NESA|T5.2.3,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSSv3.2|8.1.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-16261r5_rule,STIG-ID|NET0441,SWIFT-CSCv1|4.1,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-15434"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @EMERGENCY_ACCT@ replaced with "emergencyaccount" in field "item".
  item        : "username emergencyaccount privilege [0-9]{1,2} secret 5"
</item>

<report type:"WARNING">
  description : "NET0460 - Group accounts are defined"
  info        : "Group accounts must not be configured for use on the network device.

 Group accounts configured for use on a network device do not allow for accountability or repudiation of individuals using the shared account.  If group accounts are not changed when someone leaves the group, that person could possibly gain control of the network device.  Having group accounts does not allow for proper auditing of who is accessing or changing the network.

 NOTE: Nessus did not perform this check as it requires manual verification with the SA to ensure no group accounts are utilized on the device.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure individual user accounts for each authorized person then remove any group accounts."
  reference   : "8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,Rule-ID|SV-3056r7_rule,STIG-ID|NET0460,Vuln-ID|V-3056"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0465 - Authorized accounts must be assigned the least privilege level necessary to perform assigned duties."
  info        : "By not restricting authorized accounts to their proper privilege level, access to restricted functions may be allowed before authorized personell are trained or experienced enough to use those functions. Network disruptions or outages may occur due to mistakes made by inexperienced persons using accounts with greater privileges than necessary.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure authorized accounts with the least privilege rule. Each user will have access to only the privileges they require to perform their assigned duties."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-15471r4_rule,STIG-ID|NET0465,Vuln-ID|V-3057"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0470 -  Unauthorized accounts are configured to access device"
  info        : "Unauthorized accounts must not be configured for access to the network device.

 A malicious user attempting to gain access to the network device may compromise an account that may be unauthorized for use. The unauthorized account may be a temporary or inactive account that is no longer needed to access the device. Denial of Service, interception of sensitive information, or other destructive actions could potentially take place if an unauthorized account is configured to access the network device.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove any account configured for access to the network device that is not defined in the organization's responsibilities list."
  reference   : "8500.2|ECSC-1,8500.2|IAAC-1,CAT|II,Rule-ID|SV-3058r5_rule,STIG-ID|NET0470,Vuln-ID|V-3058"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0600 - Passwords are viewable when displaying the config"
  info        : "The network element must be configured to ensure passwords are not viewable when displaying configuration information.

 Many attacks information systems and network elements are launched from within the network. Hence, it is imperative that all passwords are encrypted so they cannot be intercepted by viewing the console or printout of the configuration."
  solution    : "Configure the network element to ensure passwords are not viewable when displaying configuration information. Review all Cisco IOS routers and switches to determine if the global command 'service password-encryption' is present in the configurations."
  reference   : "800-171|3.5.10,800-53|IA-5(1),8500.2|ECSC-1,CAT|I,CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,Rule-ID|SV-41449r2_rule,STIG-ID|NET0600,SWIFT-CSCv1|4.1,TBA-FIISB|26.1,Vuln-ID|V-3062"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "service password-encryption"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0700 -  Operating system is not at a current release level"
  info        : "The network element must be running a current and supported operating system with all IAVMs addressed.

 Network devices that are not running the latest tested and approved versions of software are vulnerable to network attacks. Running the most current, approved version of system and device software helps the site maintain a stable base of security fixes and patches, as well as enhancements to IP security. Viruses, denial of service attacks, system weaknesses, back doors and other potentially harmful situations could render a system vulnerable, allowing unauthorized access to DoD assets.

NOTE: Nessus was able to return the value of the current IOS version installed on your device for your reference. You will still need to manually verify that the version installed is a current and supported operating system with all IAVMs addressed."
  solution    : "Update operating system and address all related IAVMs."
  reference   : "800-171|3.4.1,800-53|CM-8,8500.2|ECSC-1,CAT|II,CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35,PCI-DSSv3.2|2.4,Rule-ID|SV-15302r2_rule,STIG-ID|NET0700,Vuln-ID|V-3160"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  cmd         : "show version"
  item        : "Cisco.+Version.+"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0720 - TCP and UDP small server services are not disabled - 'service tcp-small-servers'"
  info        : "The network element must have TCP & UDP small servers disabled.

 Cisco IOS provides the 'small services' that include echo, chargen, and discard. These services, especially their User Datagram Protocol (UDP) versions, are infrequently used for legitimate purposes. However, they have been used to launch denial of service attacks that would otherwise be prevented by packet filtering. For example, an attacker might send a DNS packet, falsifying the source address to be a DNS server that would otherwise be unreachable, and falsifying the source port to be the DNS service port (port 53). If such a packet were sent to the Cisco's UDP echo port, the result would be Cisco sending a DNS packet to the server in question. No outgoing access list checks would be applied to this packet, since it would be considered locally generated by the router itself.

 NOTE: The small services are disabled by default in Cisco IOS 12.0 and later software. In earlier software, they may be disabled using the commands no service tcp-small-servers and no service udp-small-servers."
  solution    : "Change the device configuration to include the following IOS commands- no service tcp-small-servers and no service udp-small-servers for each device running an IOS version prior to 12.0. This is the default for IOS versions 12.0 and later (i.e., these commands will not appear in the running configuration.)"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-3078r3_rule,STIG-ID|NET0720,SWIFT-CSCv1|2.3,Vuln-ID|V-3078"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "service tcp-small-servers"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0720 - TCP and UDP small server services are not disabled - 'service udp-small-servers'"
  info        : "The network element must have TCP & UDP small servers disabled.

 Cisco IOS provides the 'small services' that include echo, chargen, and discard. These services, especially their User Datagram Protocol (UDP) versions, are infrequently used for legitimate purposes. However, they have been used to launch denial of service attacks that would otherwise be prevented by packet filtering. For example, an attacker might send a DNS packet, falsifying the source address to be a DNS server that would otherwise be unreachable, and falsifying the source port to be the DNS service port (port 53). If such a packet were sent to the Cisco's UDP echo port, the result would be Cisco sending a DNS packet to the server in question. No outgoing access list checks would be applied to this packet, since it would be considered locally generated by the router itself.

 NOTE: The small services are disabled by default in Cisco IOS 12.0 and later software. In earlier software, they may be disabled using the commands no service tcp-small-servers and no service udp-small-servers."
  solution    : "Change the device configuration to include the following IOS commands- no service tcp-small-servers and no service udp-small-servers for each device running an IOS version prior to 12.0. This is the default for IOS versions 12.0 and later (i.e., these commands will not appear in the running configuration.)"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-3078r3_rule,STIG-ID|NET0720,SWIFT-CSCv1|2.3,Vuln-ID|V-3078"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "service udp-small-servers"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0722 - The PAD service is enabled"
  info        : "The network element must have the PAD service disabled.

 Packet Assembler Disassembler (PAD) is an X.25 component seldom used. It collects the data transmissions from the terminals and gathers them into a X.25 data stream and vice versa. PAD acts like a multiplexer for the terminals. If enabled, it can render the device open to attacks. Some voice vendors use PAD on internal routers. Review all Cisco router and switch configurations to verify that the service pad command is not found."
  solution    : "IOS Procedure- Change the configuration to include the following commands- no service pad"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-5614r3_rule,STIG-ID|NET0722,SWIFT-CSCv1|2.3,Vuln-ID|V-5614"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no service pad"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0724 - TCP Keep-Alives must be enabled"
  info        : "The network element must have TCP Keep-Alives enabled for TCP sessions.

 Idle TCP sessions can be susceptible to unauthorized access and hijacking attacks. By default, routers do not continually test whether a previously connected TCP endpoint is still reachable. If one end of a TCP connection idles out or terminates abnormally, the opposite end of the connection may still believe the session is available. These 'orphaned' sessions use up valuable router resources and can also be hijacked by an attacker. To mitigate this risk, routers must be configured to send periodic keepalive messages to check that the remote end of a session is still connected. If the remote device fails to respond to the keepalive message, the sending router will clear the connection and free resources allocated to the session. Review the device configuration to verify the 'service tcp-keepalives-in' command is configured."
  solution    : "IOS Procedure- Change the configuration to include the 'service tcp-keepalives-in' command."
  reference   : "800-171|3.13.9,800-53|SC-10,8500.2|ECSC-1,CAT|III,ITSG-33|SC-10,NESA|T2.3.8,NESA|T4.5.1,NESA|T5.5.1,PCI-DSSv3.2|2.2.3,Rule-ID|SV-5615r3_rule,STIG-ID|NET0724,SWIFT-CSCv1|2.6,Vuln-ID|V-5615"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "service tcp-keepalives-in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0726 - Identification support is enabled."
  info        : "The network element must have identification support disabled.

 Identification support allows one to query a TCP port for identification. This feature enables an unsecured protocol to report the identity of a client initiating a TCP connection and a host responding to the connection. Identification support can connect a TCP port on a host, issue a simple text string to request information, and receive a simple text-string reply. This is another mechanism to learn the router vendor, model number, and software version being run. Review the device configuration to verify that identification support is not enabled via 'ip identd' global command. It is disabled by default."
  solution    : "IOS Procedure- Disable identification support by configuring the global 'no ip identd' command."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-5616r3_rule,STIG-ID|NET0726,SWIFT-CSCv1|2.3,Vuln-ID|V-5616"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no ip identd"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0730 - The finger service is not disabled"
  info        : "The network element must have the Finger service disabled.

 The finger service supports the UNIX finger protocol, which is used for querying a host about the users that are logged on. This service is not necessary for generic users. If an attacker were to find out who is using the network, they may use social engineering practices to try to elicit classified DoD information.

 NOTE: Beginning with IOS 12.1(5), finger is disabled by default. For IOS version 12.0 through 12.1(4), verify that the no ip finger command is present. For any version prior to 12.0, verify that the no service finger command is present."
  solution    : "Disable the finger service."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15305r2_rule,STIG-ID|NET0730,SWIFT-CSCv1|2.3,Vuln-ID|V-3079"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip finger"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0740 - HTTP server is not disabled"
  info        : "The additional services the router is enabled for increases the risk for an attack since the router will listen for these services. In addition, these services provide an unsecured method for an attacker to gain access to the router. Most recent software versions support remote configuration and monitoring using the World Wide Web's HTTP protocol. In general, HTTP access is equivalent to interactive access to the router. The authentication protocol used for HTTP is equivalent to sending a clear-text password across the network, and, unfortunately, there is no effective provision in HTTP for challenge-based or one-time passwords. This makes HTTP a relatively risky choice for use across the public Internet. Any additional services that are enabled increase the risk for an attack since the router will listen for these services. The HTTPS server may be enabled for administrative access."
  solution    : "Configure the device to disable using HTTP (port 80) for administrative access."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-41467r2_rule,STIG-ID|NET0740,SWIFT-CSCv1|2.3,Vuln-ID|V-3085"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "^ip http server"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0744 - BSDr commands are not disabled - rcp-enable"
  info        : "The administrator must ensure BSD r command services are disabled.

 Berkeley Software Distribution (BSD) 'r' commands allow users to execute commands on remote systems using a variety of protocols. The BSD 'r' commands (e.g., rsh, rlogin, rcp, rdump, rrestore, and rdist) are designed to provide convenient remote access without passwords to services such as remote command execution (rsh), remote login (rlogin), and remote file copy (rcp and rdist). The difficulty with these commands is that they use address-based authentication. An attacker who convinces a server that he is coming from a 'trusted' machine can essentially get complete and unrestricted access to a system. The attacker can convince the server by impersonating a trusted machine and using IP address, by confusing DNS so that DNS thinks that the attacker's IP address maps to a trusted machine's name, or by any of a number of other methods.

Verify that the following BSDr global commands are not defined in the configuration-

ip rcmd rcp-enable
ip rcmd rsh-enable

 NOTE: These commands have been disabled by default in IOS since version 12.0."
  solution    : "Configure the device to disable BSDr command services."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15314r2_rule,STIG-ID|NET0744,SWIFT-CSCv1|2.3,Vuln-ID|V-14669"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip rcmd rcp-enable"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0744 - BSDr commands are not disabled - rsh-enable"
  info        : "The administrator must ensure BSD r command services are disabled.

 Berkeley Software Distribution (BSD) 'r' commands allow users to execute commands on remote systems using a variety of protocols. The BSD 'r' commands (e.g., rsh, rlogin, rcp, rdump, rrestore, and rdist) are designed to provide convenient remote access without passwords to services such as remote command execution (rsh), remote login (rlogin), and remote file copy (rcp and rdist). The difficulty with these commands is that they use address-based authentication. An attacker who convinces a server that he is coming from a 'trusted' machine can essentially get complete and unrestricted access to a system. The attacker can convince the server by impersonating a trusted machine and using IP address, by confusing DNS so that DNS thinks that the attacker's IP address maps to a trusted machine's name, or by any of a number of other methods.

Verify that the following BSDr global commands are not defined in the configuration-

ip rcmd rcp-enable
ip rcmd rsh-enable

 NOTE: These commands have been disabled by default in IOS since version 12.0."
  solution    : "Configure the device to disable BSDr command services."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15314r2_rule,STIG-ID|NET0744,SWIFT-CSCv1|2.3,Vuln-ID|V-14669"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip rcmd rsh-enable"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0750 - The Bootp service is not disabled"
  info        : "The router must have Bootp service disabled.

 Bootp is a user datagram protocol (UDP) that can be used by Cisco routers to access copies of Cisco IOS Software on another Cisco router running the Bootp service. In this scenario, one Cisco router acts as a Cisco IOS Software server that can download the software to other Cisco routers acting as Bootp clients. In reality, this service is rarely used and can allow an attacker to download a copy of a router's Cisco IOS Software."
  solution    : "Change the configuration to include the IOS command 'no ip bootp server'."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSD-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-3086r3_rule,STIG-ID|NET0750,SWIFT-CSCv1|2.3,Vuln-ID|V-3086"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no ip bootp server"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0760 - Configuration auto-loading must be disabled - 'service config'"
  info        : "Devices can find their startup configuration either in their own NVRAM or access it over the network via TFTP or Remote Copy (rcp). Loading the image from the network is taking a security risk since the image could be intercepted by an attacker who could corrupt the image resulting in a denial of service. Configuration auto-loading can be enabled when the device is connected to a non-operational network. Once the device is connected to an operational (i.e. production) network, configuration auto-loading must be disabled."
  solution    : "Disable the configuration auto-loading feature, when connected to an operational network."
  reference   : "800-53|SI-7(10),8500.2|ECSC-1,CAT|II,CSF|PR.DS-6,PCI-DSSv3.2|2.2.5,Rule-ID|SV-3080r4_rule,STIG-ID|NET0760,Vuln-ID|V-3080"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "service config"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0760 - Configuration auto-loading must be disabled - 'book network'"
  info        : "Devices can find their startup configuration either in their own NVRAM or access it over the network via TFTP or Remote Copy (rcp). Loading the image from the network is taking a security risk since the image could be intercepted by an attacker who could corrupt the image resulting in a denial of service. Configuration auto-loading can be enabled when the device is connected to a non-operational network. Once the device is connected to an operational (i.e. production) network, configuration auto-loading must be disabled."
  solution    : "Disable the configuration auto-loading feature, when connected to an operational network."
  reference   : "800-53|SI-7(9),8500.2|ECSC-1,CAT|II,CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSF|PR.DS-6,PCI-DSSv3.2|2.2.5,Rule-ID|SV-3080r4_rule,STIG-ID|NET0760,Vuln-ID|V-3080"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "boot network"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0770 - IP Source Routing is not disabled on all routers."
  info        : "The router must have IP source routing disabled.

 Source routing is a feature of IP, whereby individual packets can specify routes. This feature is used in several different network attacks by bypassing perimeter and internal defense mechanisms."
  solution    : "Configure the router to disable IP source routing."
  reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,NESA|T3.4.1,NESA|T3.6.3,NESA|T4.2.1,NESA|T4.3.1,NESA|T4.3.2,NESA|T4.5.1,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSSv3.2|2.2.2,Rule-ID|SV-15316r2_rule,STIG-ID|NET0770,TBA-FIISB|43.1,Vuln-ID|V-3081"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no ip source-route"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0781 - Gratuitous ARP must be disabled."
  info        : "The router must have gratuitous ARP disabled.

 A gratuitous ARP is an ARP broadcast in which the source and destination MAC addresses are the same. It is used to inform the network about a hosts IP address. A spoofed gratuitous ARP message can cause network mapping information to be stored incorrectly, causing network malfunction. Review the configuration and verify that the 'ip gratuitous-arps' global command is not configured. It is disabled by default in release 12.3 and above."
  solution    : "The administrator must ensure the device configuration does not include the 'ip gratuitous-arp' command."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|2.2.5,Rule-ID|SV-5618r3_rule,STIG-ID|NET0781,Vuln-ID|V-5618"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip gratuitous-arps"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0790 - IP directed broadcast is not disabled."
  info        : "The router must have IP directed broadcast disabled on all layer 3 interfaces.

 An IP directed broadcast is a datagram sent to the broadcast address of a subnet that is not directly attached to the sending machine. The directed broadcast is routed through the network as a unicast packet until it arrives at the target subnet, where it is converted into a link-layer broadcast. Because of the nature of the IP addressing architecture, only the last router in the chain, which is connected directly to the target subnet, can conclusively identify a directed broadcast. IP directed broadcasts are used in the extremely common and popular smurf, or Denial of Service (DoS), attacks. In a smurf attack, the attacker sends ICMP echo requests from a falsified source address to a directed broadcast address, causing all the hosts on the target subnet to send replies to the falsified source. By sending a continuous stream of such requests, the attacker can create a much larger stream of replies, which can completely inundate the host whose address is being falsified. This service should be disabled on all interfaces when not needed to prevent smurf and DoS attacks.

 NOTE: IP directed broadcast is disabled by default in IOS version 12.0 and higher so the command 'no ip directed-broadcast' will not be displayed in the running configuration. For versions prior to 12.0 ensure the command 'no ip directed-broadcast' is displayed in the running configuration."
  solution    : "Change the router configuration files to disable IP directed broadcast on all interfaces."
  reference   : "800-53|SC-5,8500.2|ECSC-1,CAT|III,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|2.2.5,Rule-ID|SV-3083r3_rule,STIG-ID|NET0790,Vuln-ID|V-3083"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
  item        : "ip directed-broadcast"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'First NTP Server'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: Change 'NTP_SERVER_1' to the first NTP server listed for your organization."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-171|3.3.7,800-53|AU-8(1),8500.2|ECSC-1,CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NTP_SERVER_1@ replaced with "192\\.168\\.3\\.1" in field "item".
  item        : "ntp server 192\\.168\\.3\\.1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'Second NTP Server'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: Change 'NTP_SERVER_2' to the second NTP server listed for your organization."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-53|AU-8(2),8500.2|ECSC-1,CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NTP_SERVER_2@ replaced with "192\\.168\\.3\\.2" in field "item".
  item        : "ntp server 192\\.168\\.3\\.2"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'ntp update-calendar'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: This option may not be available on lower-end routers (i.e. Cisco 2500 serices or 2600 series)."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-171|3.3.7,800-53|AU-8(1),8500.2|ECSC-1,CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ntp update-calendar"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'ntp broadcast client'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: An alternative to querying an NTP server for time is to receive NTP updates via server that is broadcasting or multicasting the time update messages. If you already have two NTP servers defined this check in not necessary."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,SWIFT-CSCv1|2.3,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
  item        : "ntp broadcast client"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'ntp multicast client MULTICAST_IP_1'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: An alternative to querying an NTP server for time is to receive NTP updates via server that is broadcasting or multicasting the time update messages. If you already have two NTP servers defined this check in not necessary.
 NOTE: Change 'MULTICAST_IP_1' to The IP address of the first NTP multicast address listed for your organization."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,SWIFT-CSCv1|2.3,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
# Note: Variable @MULTICAST_IP_1@ replaced with "192\\.168\\.3\\.1" in field "item".
  item        : "ntp multicast client 192\\.168\\.3\\.1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0812 - Two NTP servers are not used to synchronize time - 'ntp multicast client MULTICAST_IP_2'"
  info        : "The network element must use two or more NTP servers to synchronize time.

 Without synchronized time, accurately correlating information between devices becomes difficult, if not impossible. If you cannot successfully compare logs between each of your routers, switches, and firewalls, it will be very difficult to determine the exact events that resulted in a network breach incident. NTP provides an efficient and scalable method for network elements to synchronize to an accurate time source.

 NOTE: An alternative to querying an NTP server for time is to receive NTP updates via server that is broadcasting or multicasting the time update messages. If you already have two NTP servers defined this check in not necessary.
 NOTE: Change 'MULTICAST_IP_2' to the IP address of the second NTP multicast address listed for your organization."
  solution    : "Specify two NTP server IP addresses on the device to be used to request time from."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-41497r1_rule,STIG-ID|NET0812,SWIFT-CSCv1|2.3,Vuln-ID|V-23747"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.*[Ee]thernet|[Ss]erial)([0-9]+)"
# Note: Variable @MULTICAST_IP_2@ replaced with "192\\.168\\.3\\.2" in field "item".
  item        : "ntp multicast client 192\\.168\\.3\\.2"
</item>

<report type:"WARNING">
  description : "NET0813 - The network element must authenticate all NTP messages received from NTP servers and peers."
  info        : "Since NTP is used to ensure accurate log file time stamp information, NTP could pose a security risk if a malicious user were able to falsify NTP information. To launch an attack on the NTP infrastructure, a hacker could inject time that would be accepted by NTP clients by spoofing the IP address of a valid NTP server. To mitigate this risk, the time messages must be authenticated by the client before accepting them as a time source.

Two NTP-enabled devices can communicate in either client-server mode or peer-to-peer mode (aka 'symmetric mode'). The peering mode is configured manually on the device and indicated in the outgoing NTP packets. The fundamental difference is the synchronization behavior: an NTP server can synchronize to a peer with better stratum, whereas it will never synchronize to its client regardless of the client's stratum. From a protocol perspective, NTP clients are no different from the NTP servers. The NTP client can synchronize to multiple NTP servers, select the best server and synchronize with it, or synchronize to the averaged value returned by the servers.

A hierarchical model can be used to improve scalability. With this implementation, an NTP client can also become an NTP server providing time to downstream clients at a higher stratum level and of decreasing accuracy than that of its upstream server. To increase availability, NTP peering can be used between NTP servers. In the event the device loses connectivity to its upstream NTP server, it will be able to choose time from one of its peers.

The NTP authentication model is opposite of the typical client-server authentication model. NTP authentication enables an NTP client or peer to authenticate time received from their servers and peers. It is not used to authenticate NTP clients because NTP servers do not care about the authenticity of their clients, as they never accept any time from them.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the device to authenticate all received NTP messages using a FIPS-approved message authentication code algorithm."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16089r4_rule,STIG-ID|NET0813,Vuln-ID|V-14671"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0820 - DNS servers must be defined for client resolver"
  info        : "The network element must have DNS servers defined if it is configured as a client resolver.

 The susceptibility of IP addresses to spoofing translates to DNS host name and IP address mapping vulnerabilities. For example, suppose a source host wishes to establish a connection with a destination host and queries a DNS server for the IP address of the destination host name.  If the response to this query is the IP address of a host operated by an attacker, the source host will establish a connection with the attackers host, rather than the intended target. The user on the source host might then provide logon, authentication, and other sensitive data.

Review the device configuration to ensure that DNS servers have been defined if it has been configured as a client resolver (name lookup). The configuration should look similar to one of the following examples:

ip domain-lookup

ip name-server 192.168.1.253

or

no ip domain-lookup

The first configuration example has DNS lookup enabled and hence has defined its DNS server. The second example has DNS lookup disabled.

 NOTE: ip domain-lookup is enabled by default. Hence it may not be shown-depending on the IOS release. If it is enabled, it will be shown near the beginning of the configuration. If you don't allow the router to act as a DNS resolver you'll need to ensure 'no ip domain-lookup' is present in the configuration.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the device to include DNS servers or disable domain lookup."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-15330r2_rule,STIG-ID|NET0820,Vuln-ID|V-3020"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<if>
  <condition type:"OR">
    <item>
      type        : CONFIG_CHECK
      description : "SNMPv2 CONFIG IF STATEMENT"
      item        : "snmp-server community.*"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "SNMPv3 CONFIG IF STATEMENT"
      item        : "snmp-server group.*v3.*"
    </item>
  </condition>

  <then>
    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "SNMPv2 CONFIG IF STATEMENT With ACL"
          item        : "snmp-server community.*R[W|O] .+$"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "NET0890 - Network devices must restrict SNMPv2 access to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv2 must be configured using an ACL as as part of the configuration.
          SNMPv2 is configured with an ACL.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
          item        : "snmp-server community.*R[W|O] .+$"
        </item>

        <if>
          <condition type:"AND">
            <item>
              type        : CONFIG_CHECK
              description : "SNMPv2 with ACL is configured Check for ACL Configuration"
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
              regex       : "access-list (1|standard) (1|permit)"
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_HOST_1@ replaced with "192\\.168\\.0\\.1" in field "item".
              item        : "access-list (1|standard) (1|permit) 192\\.168\\.0\\.1"
            </item>
          </condition>

          <then>
            <item>
              type        : CONFIG_CHECK
              description : "NET0890 - Network devices must only allow SNMPv2 access from addresses belonging to the management network."
              info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
                SNMPv2 must be configured using an ACL as as part of the configuration.
                SNMPv2 is configured with an ACL and the ACL configured is present with a valid entries.
                Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
              solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
              reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
              regex       : "access-list (1|standard) (1|permit)"
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_HOST_1@ replaced with "192\\.168\\.0\\.1" in field "item".
              item        : "access-list (1|standard) (1|permit) 192\\.168\\.0\\.1"
            </item>
          </then>

          <else>
            <report type:"FAILED">
              description : "NET0890 - Network devices must only allow SNMPv2 access from addresses belonging to the management network."
              info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
                SNMPv2 must be configured using an ACL as as part of the configuration.
                SNMPv2 is configured with an ACL and the ACL configured is not present or does not have valid entries.
                Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
              solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
              reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
            </report>
          </else>
        </if>
      </then>

      <else>
        <report type:"FAILED">
          description : "NET0890 - Network devices must restrict SNMPv2 access to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv2 must be configured using an ACL as as part of the configuration.
          SNMPv2 is NOT configured with an ACL.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
        </report>

        <report type:"FAILED">
          description : "NET0890 - Network devices must only allow SNMPv2 access from addresses belonging to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
      SNMPv2 must be configured using an ACL as as part of the configuration.
      SNMPv2 is configured with an ACL and the ACL configured is not present or does not have valid entries.
      Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "SNMPv3 CONFIG IF STATEMENT With ACL"
          item        : "snmp-server group.*v3.*access .+$"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "NET0890 - Network devices must restrict SNMPv3 access to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv3 must be configured using an ACL as as part of the configuration.
          SNMPv3 is configured with an ACL.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
          item        : "snmp-server group.*v3.*access .+"
        </item>

        <if>
          <condition type:"AND">
            <item>
              type        : CONFIG_CHECK
              description : "SNMPv3 with ACL is configured Check for ACL Configuration"
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
              regex       : "access-list (1|standard) (1|permit)"
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_HOST_1@ replaced with "192\\.168\\.0\\.1" in field "item".
              item        : "access-list (1|standard) (1|permit) 192\\.168\\.0\\.1"
            </item>
          </condition>

          <then>
            <item>
              type        : CONFIG_CHECK
              description : "NET0890 - Network devices must only allow SNMPv3 access from addresses belonging to the management network."
              info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
                SNMPv3 must be configured using an ACL as as part of the configuration.
                SNMPv3 is configured with an ACL and the ACL configured is present with a valid entries.
                Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
              solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
              reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
# Note: Variable @NMS_LIST@ replaced with "1" in field "regex".
              regex       : "access-list (1|standard) (1|permit)"
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
# Note: Variable @NMS_LIST@ replaced with "1" in field "item".
              item        : "access-list (1|standard) (1|permit) 10.31.100.0 0.0.0.255"
            </item>
          </then>

          <else>
            <report type:"FAILED">
              description : "NET0890 - Network devices must only allow SNMPv3 access from addresses belonging to the management network."
              info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
                SNMPv3 must be configured using an ACL as as part of the configuration.
                SNMPv3 is configured with an ACL and the ACL configured is not present or does not have valid entries.
                Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
              solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
              reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
              see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
            </report>
          </else>
        </if>
      </then>

      <else>
        <report type:"FAILED">
          description : "NET0890 - Network devices must restrict SNMPv3 access to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv3 must be configured using an ACL as as part of the configuration.
          SNMPv3 is NOT configured with an ACL.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
        </report>

        <report type:"FAILED">
          description : "NET0890 - Network devices must only allow SNMPv3 access from addresses belonging to the management network."
          info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
      SNMPv3 must be configured using an ACL as as part of the configuration.
      SNMPv3 is configured with an ACL and the ACL configured is not present or does not have valid entries.
      Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
          solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
          reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
          see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
        </report>
      </else>
    </if>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0890 - Network devices must restrict SNMPv2 access to the management network."
      info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv2 must be configured using an ACL as as part of the configuration.
          SNMPv2 was not found to be configured on this device.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
      solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0890 - Network devices must only allow SNMPv2 access from addresses belonging to the management network."
      info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
    SNMPv2 must be configured using an ACL as as part of the configuration.
    SNMPv2 was not found to be configured on this device.
    Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
      solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0890 - Network devices must restrict SNMPv3 access to the management network."
      info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
          SNMPv3 must be configured using an ACL as as part of the configuration.
          SNMPv3 was not found to be configured on this device.
          Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
      solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|7.1.2,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0890 - Network devices must only allow SNMPv3 access from addresses belonging to the management network."
      info        : "Network devices must only allow SNMP access from addresses belonging to the management network.
    SNMPv3 must be configured using an ACL as as part of the configuration.
    SNMPv3 was not found to be configured on this device.
    Detailed information about the network is sent across the network via SNMP. If this information is discovered by attackers it could be used to trace the network, show the networks topology, and possibly gain access to network devices."
      solution    : "Configure the network element to only allow SNMP access from only addresses belonging to the management network."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15332r2_rule,STIG-ID|NET0890,Vuln-ID|V-3021"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0894 - Network element must only allow SNMP read access - 'community RW'"
  info        : "The network device must only allow SNMP read-only access.

 Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

 Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. If write-access is used for SNMP versions 1, 2c, or 3 noAuth or Priv mode and there is no documented approval by the IAO, this is a finding."
  solution    : "Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3."
  reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,Rule-ID|SV-30086r3_rule,STIG-ID|NET0894,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3,Vuln-ID|V-3969"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "snmp-server community (.+) RW"
</item>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Network element must only allow SNMP read access"
      item        : "snmp-server group .* v3"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK_NOT
      description : "NET0894 - Network element must only allow SNMP read access - 'SNMP v3 priv|noauth'"
      info        : "The network device must only allow SNMP read-only access.

 Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

 Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. If write-access is used for SNMP versions 1, 2c, or 3 noAuth or Priv mode and there is no documented approval by the IAO, this is a finding."
      solution    : "Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30086r3_rule,STIG-ID|NET0894,SWIFT-CSCv1|2.3,Vuln-ID|V-3969"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      item        : "snmp-server group .* v3 (priv|noauth) (.*)?write"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "NET0894 - Network element must only allow SNMP read access - 'SNMP v3 auth'"
      info        : "The network device must only allow SNMP read-only access.

 Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

 Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. If write-access is used for SNMP versions 1, 2c, or 3 noAuth or Priv mode and there is no documented approval by the IAO, this is a finding.

You will need to manually check the configured views (e.g., read, write) to ensure they only include the desired MIB objects approved for your organization. You may also add an access statement to reference an ACL to further restrict access. Also of note, SNMPv3 users are not shown in a running configuration. You can view them with the show 'snmp user' command to ensure the configured users are assigned to the proper group."
      solution    : "Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3."
      reference   : "800-171|3.4.2,800-53|CM-6,800-53|IA-3,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.AC-1,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|IA-3,NESA|T3.2.1,NESA|T5.4.3,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|7.1.2,Rule-ID|SV-30086r3_rule,STIG-ID|NET0894,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-3969"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      item        : "snmp-server group .* v3 auth"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0894 - Network element must only allow SNMP read access - 'SNMP v3 priv|noauth'"
      info        : "The network device must only allow SNMP read-only access.

 Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

 Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. If write-access is used for SNMP versions 1, 2c, or 3 noAuth or Priv mode and there is no documented approval by the IAO, this is a finding."
      solution    : "Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-30086r3_rule,STIG-ID|NET0894,SWIFT-CSCv1|2.3,Vuln-ID|V-3969"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "NET0894 - Network element must only allow SNMP read access - 'SNMP v3 auth'"
      info        : "The network device must only allow SNMP read-only access.

 Enabling write access to the device via SNMP provides a mechanism that can be exploited by an attacker to set configuration variables that can disrupt network operations.

 Review the network device configuration and verify SNMP community strings are read-only when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3. If write-access is used for SNMP versions 1, 2c, or 3 noAuth or Priv mode and there is no documented approval by the IAO, this is a finding.

You will need to manually check the configured views (e.g., read, write) to ensure they only include the desired MIB objects approved for your organization. You may also add an access statement to reference an ACL to further restrict access. Also of note, SNMPv3 users are not shown in a running configuration. You can view them with the show 'snmp user' command to ensure the configured users are assigned to the proper group."
      solution    : "Configure the network device to allow for read-only SNMP access when using SNMPv1, v2c, or basic v3 (no authentication or privacy). Write access may be used if authentication is configured when using SNMPv3."
      reference   : "800-171|3.4.2,800-53|CM-6,800-53|IA-3,8500.2|ECSC-1,CAT|II,CSCv6|3.1,CSF|PR.AC-1,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|IA-3,NESA|T3.2.1,NESA|T5.4.3,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|7.1.2,Rule-ID|SV-30086r3_rule,STIG-ID|NET0894,SWIFT-CSCv1|2.3,TBA-FIISB|27.1,Vuln-ID|V-3969"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "TACACS Authentication traffic does not use loopback"
      item        : "aaa group server tacacs|tacacs server|tacacs-server host"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0897 - TACACS Authentication traffic does not use loopback interface."
      info        : "The router must use its loopback or OOB management interface address as the source address when originating TACACS+ or RADIUS traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TACACS+, RADIUS messages sent to management servers should use the loopback address as the source address.

 NOTE: If the device is managed from an OOB management network, the OOB interface must be used instead.
 NOTE: This check is testing to see if Lookpback0 is used for TACACS authentication."
      solution    : "Configure the router to use its loopback or OOBM interface address as the source address when originating TACACS+ or RADIUS traffic."
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16091r2_rule,STIG-ID|NET0897,SWIFT-CSCv1|3.1,Vuln-ID|V-14672"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      item        : "ip tacacs source-interface Loopback0"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0897 - TACACS Authentication traffic does not use loopback interface."
      info        : "The router must use its loopback or OOB management interface address as the source address when originating TACACS+ or RADIUS traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TACACS+, RADIUS messages sent to management servers should use the loopback address as the source address.

 NOTE: If the device is managed from an OOB management network, the OOB interface must be used instead.
 NOTE: This check did not find TACACS authentication configured on this device."
      solution    : "Configure the router to use its loopback or OOBM interface address as the source address when originating TACACS+ or RADIUS traffic."
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7,8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16091r2_rule,STIG-ID|NET0897,SWIFT-CSCv1|3.1,Vuln-ID|V-14672"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "RADIUS Authentication traffic does not use loopback"
      item        : "aaa group server radius|radius server|radius-server host"
    </item>
  </condition>

  <then>
    <item>
      type        : CONFIG_CHECK
      description : "NET0897 - RADIUS Authentication traffic does not use loopback interface."
      info        : "The router must use its loopback or OOB management interface address as the source address when originating TACACS+ or RADIUS traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TACACS+, RADIUS messages sent to management servers should use the loopback address as the source address.

 NOTE: If the device is managed from an OOB management network, the OOB interface must be used instead.
 NOTE: This check is testing to see if Lookpback0 is used for TACACS authentication."
      solution    : "Configure the router to use its loopback or OOBM interface address as the source address when originating TACACS+ or RADIUS traffic."
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16091r2_rule,STIG-ID|NET0897,SWIFT-CSCv1|3.1,Vuln-ID|V-14672"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
      item        : "ip radius source-interface Loopback0"
    </item>
  </then>

  <else>
    <report type:"PASSED">
      description : "NET0897 - RADIUS Authentication traffic does not use loopback interface."
      info        : "The router must use its loopback or OOB management interface address as the source address when originating TACACS+ or RADIUS traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TACACS+, RADIUS messages sent to management servers should use the loopback address as the source address.

 NOTE: If the device is managed from an OOB management network, the OOB interface must be used instead.
 NOTE: This check did not find RADIUS authentication configured on this device."
      solution    : "Configure the router to use its loopback or OOBM interface address as the source address when originating TACACS+ or RADIUS traffic."
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7,8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-16091r2_rule,STIG-ID|NET0897,SWIFT-CSCv1|3.1,Vuln-ID|V-14672"
      see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
    </report>
  </else>
</if>

<item>
  type        : CONFIG_CHECK
  description : "NET0898 - Syslog traffic is not using loopback address - 'logging on'"
  info        : "The router must use its loopback or OOB management interface address as the source address when originating syslog traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. Syslog messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the router to use its loopback or OOB management interface address as the source address when originating syslog traffic."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15340r2_rule,STIG-ID|NET0898,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14673"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging on"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0898 - Syslog traffic is not using loopback address - 'logging source-interface Loopback0'"
  info        : "The router must use its loopback or OOB management interface address as the source address when originating syslog traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. Syslog messages sent to management servers should use the loopback address as the source address.

 NOTE: If the device is managed from an OOB management network, the OOB interface must be used instead."
  solution    : "Configure the router to use its loopback or OOB management interface address as the source address when originating syslog traffic."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15340r2_rule,STIG-ID|NET0898,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-14673"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging source-interface Loopback0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0899 - NTP traffic is not using loopback address"
  info        : "The router must use its loopback or OOB management interface address as the source address when originating NTP traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. NTP messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the router to use its loopback or OOB management interface address as the source address when originating NTP traffic."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|10.4.1,Rule-ID|SV-15343r2_rule,STIG-ID|NET0899,SWIFT-CSCv1|3.1,Vuln-ID|V-14674"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ntp source Loopback0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0900 - SNMP traffic does not use loopback"
  info        : "The router must use its loopback or OOB management interface address as the source address when originating SNMP traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. SNMP messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the router to use its loopback or OOB management interface address as the source address when originating SNMP traffic."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|10.5,Rule-ID|SV-15346r2_rule,STIG-ID|NET0900,SWIFT-CSCv1|3.1,Vuln-ID|V-14675"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "snmp-server trap-source Loopback0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0901 - Netflow traffic is not using loopback"
  info        : "The router must use its loopback or OOB management interface address as the source address when originating NetFlow traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. Netflow messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the router to use its loopback or OOB management interface address as the source address when originating NetFlow traffic."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15349r2_rule,STIG-ID|NET0901,SWIFT-CSCv1|3.1,Vuln-ID|V-14676"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip flow-export source Loopback0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0902 - FTP/TFTP traffic does not use loopback - 'ip ftp source-interface Loopback0'"
  info        : "The network device must use its loopback or OOB management interface address as the source address when originating TFTP or FTP traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of network devices. It is easier to construct appropriate ingress filters for management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TFTP and FTP messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the network device to use a loopback interface address as the source address when originating TFTP or FTP traffic. If an OOB management interface is being used, configure the interface for TFTP or FTP traffic origination."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-15352r3_rule,STIG-ID|NET0902,SWIFT-CSCv1|3.1,Vuln-ID|V-14677"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip ftp source-interface Loopback0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0902 - FTP/TFTP traffic does not use loopback - 'ip tftp source-interface Loopback0'"
  info        : "The network device must use its loopback or OOB management interface address as the source address when originating TFTP or FTP traffic.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of network devices. It is easier to construct appropriate ingress filters for management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses. TFTP and FTP messages sent to management servers should use the loopback address as the source address."
  solution    : "Configure the network device to use a loopback interface address as the source address when originating TFTP or FTP traffic. If an OOB management interface is being used, configure the interface for TFTP or FTP traffic origination."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(h),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(13),NIAv2|GS7d,PCI-DSSv3.2|2.2.4,Rule-ID|SV-15352r3_rule,STIG-ID|NET0902,SWIFT-CSCv1|3.1,Vuln-ID|V-14677"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip tftp source-interface Loopback0"
</item>

<report type:"WARNING">
  description : "NET0903 - Loopback address is not used as the iBGP source IP"
  info        : "The router must use its loopback interface address as the source address for all iBGP peering sessions.

 Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability. It is easier to construct appropriate filters for control plane traffic. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.
NOTE: This check requires manual verfication to ensure all configured peering sessions with iBGP neighbors use the loopback address as the source address as shown in the example below:

router bgp 100
neighbor 10.10.2.2 remote-as 100
neighbor 10.10.2.2 update-source Loopback0"
  solution    : "Ensure the router's loopback address is used as the source address for iBGP peering."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-15359r2_rule,STIG-ID|NET0903,Vuln-ID|V-14681"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0949 - Cisco Express Fowarding (CEF) not enabled on supported devices"
  info        : "Cisco Express Forwarding (CEF) must be enabled on all supported Cisco Layer 3 IP devices.

 The Cisco Express Forwarding (CEF) switching mode replaces the traditional Cisco routing cache with a data structure that mirrors the entire system routing table. Because there is no need to build cache entries when traffic starts arriving for new destinations, CEF behaves more predictably when presented with large volumes of traffic addressed to many destinations such as a SYN flood attacks. Because many SYN flood attacks use randomized source addresses to which the hosts under attack will reply to, there can be a substantial amount of traffic for a large number of destinations that the router will have to handle. Consequently, routers configured for CEF will perform better under SYN floods directed at hosts inside the network than routers using the traditional cache."
  solution    : "1. If the Cisco Layer 3 IP device not enabled by default, enable Distributed CEF Mode globally.

Router(config)# ip cef distributed

2. If Distributed CEF Mode is not supported, enable Centralized CEF Mode globally.

Router(config)# ip cef

3. If CEF is not supported in any capacity on the device, this finding is N/A."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-5645r4_rule,STIG-ID|NET0949,SWIFT-CSCv1|2.3,Vuln-ID|V-5645"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip cef"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0965 - Devices not configured to filter and drop half-open connections"
  info        : "The network device must drop half-open TCP connections through filtering thresholds or timeout periods.

 A TCP connection consists of a three-way handshake message sequence. A connection request is transmitted by the originator, an acknowledgement is returned from the receiver, and then an acceptance of that acknowledgement is sent by the originator.

 An attacker's goal in this scenario is to cause a denial of service to the network or device by initiating a high volume of TCP packets, then never sending an acknowledgement, leaving connections in a half-opened state.  Without the device having a connection or time threshold for these half-opened sessions, the device risks being a victim of a denial of service attack.  Setting a TCP timeout threshold will instruct the device to shut down any incomplete connections. Services such as SSH, BGP, SNMP, LDP, etc. are some services that may be prone to these types of denial of service attacks. If the router does not have any BGP connections with BGP neighbors across WAN links, values could be set to even tighter constraints.

 NOTE: If the device can not be configured for 10 seconds or less, it should be set to the least amount of time allowable in the configuration. Threshold filters will need to be determined by the organization for optimal filtering."
  solution    : "Configure the device to drop half-open TCP connections through threshold filtering or timeout periods."
  reference   : "800-171|3.13.9,800-53|SC-10,800-53|SC-5,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-10,ITSG-33|SC-5,NESA|T2.3.8,NESA|T3.3.1,NESA|T4.5.1,NESA|T5.5.1,NIAv2|GS10c,NIAv2|GS8e,PCI-DSSv3.2|1.3.5,Rule-ID|SV-15435r4_rule,STIG-ID|NET0965,SWIFT-CSCv1|2.6,Vuln-ID|V-5646"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip tcp synwait-time ([1-9]$|10$)"
</item>

<report type:"WARNING">
  description : "NET0966 - Control plan protection is not enabled - 'Steps 1 - 3'"
  info        : "The router must have control plane protection enabled.

 The Route Processor (RP) is critical to all network operations as it is the component used to build all forwarding paths for the data plane via control plane processes. It is also instrumental with ongoing network management functions that keep the routers and links available for providing network services. Hence, any disruption to the RP or the control and management planes can result in mission critical network outages.

 In addition to control plane and management plane traffic that is in the router's receive path, the RP must also handle other traffic that must be punted to the RP-that is, the traffic must be fast or process switched. This is the result of packets that must be fragmented, require an ICMP response (TTL expiration, unreachable, etc.) have IP options, etc. A DoS attack targeting the RP can be perpetrated either inadvertently or maliciously involving high rates of punted traffic resulting in excessive RP CPU and memory utilization. To maintain network stability, the router must be able to securely handle specific control plane and management plane traffic that is destined to it, as well as other punted traffic.

 Using the ingress filter on forwarding interfaces is a method that has been used in the past to filter both forwarding path and receiving path traffic. However, this method does not scale well as the number of interfaces grows and the size of the ingress filters grow. Control plane policing can be used to increase security of routers and multilayer switches by protecting the RP from unnecessary or malicious traffic. Filtering and rate limiting the traffic flow of control plane packets can be implemented to protect routers against reconnaissance and DoS attacks allowing the control plane to maintain packet forwarding and protocol states despite an attack or heavy load on the router or multilayer switch.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.
 NOTE: Nessus did not perform this check as it requires manual verification of multiple steps to ensure CoPP is enabled and configured accordingly.

Step 1: Verify that traffic types have been classified based on importance levels.
Step 2: Review the ACLs referenced by the match access-group commands to determine if the traffic is being classified appropriately.
Step 3: Review the policy-map to determine if the traffic is being policed appropriately for each classification."
  solution    : "Implement control plane protection by classifying traffic types based on importance levels and configure filters to restrict and rate limit the traffic punted to the route processor as according to each class."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-21167r2_rule,STIG-ID|NET0966,Vuln-ID|V-19188"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0966 - Control plan protection is not enabled - 'Step 4: Verify that the CoPP policy is enabled. (service-policy)'"
  info        : "The router must have control plane protection enabled.

 The Route Processor (RP) is critical to all network operations as it is the component used to build all forwarding paths for the data plane via control plane processes. It is also instrumental with ongoing network management functions that keep the routers and links available for providing network services. Hence, any disruption to the RP or the control and management planes can result in mission critical network outages.

 In addition to control plane and management plane traffic that is in the router's receive path, the RP must also handle other traffic that must be punted to the RP-that is, the traffic must be fast or process switched. This is the result of packets that must be fragmented, require an ICMP response (TTL expiration, unreachable, etc.) have IP options, etc. A DoS attack targeting the RP can be perpetrated either inadvertently or maliciously involving high rates of punted traffic resulting in excessive RP CPU and memory utilization. To maintain network stability, the router must be able to securely handle specific control plane and management plane traffic that is destined to it, as well as other punted traffic.

 Using the ingress filter on forwarding interfaces is a method that has been used in the past to filter both forwarding path and receiving path traffic. However, this method does not scale well as the number of interfaces grows and the size of the ingress filters grow. Control plane policing can be used to increase security of routers and multilayer switches by protecting the RP from unnecessary or malicious traffic. Filtering and rate limiting the traffic flow of control plane packets can be implemented to protect routers against reconnaissance and DoS attacks allowing the control plane to maintain packet forwarding and protocol states despite an attack or heavy load on the router or multilayer switch.

 NOTE: Change 'CONTROL_PLANE_POLICY' to the name of your organization's control-plane service policy."
  solution    : "Implement control plane protection by classifying traffic types based on importance levels and configure filters to restrict and rate limit the traffic punted to the route processor as according to each class."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-21167r2_rule,STIG-ID|NET0966,SWIFT-CSCv1|2.3,Vuln-ID|V-19188"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @CONTROL_PLANE_POLICY@ replaced with "controlplanepolicy" in field "item".
  item        : "service-policy input controlplanepolicy"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0966 - Control plane protection is not enabled - 'ip receive acl in use'"
  info        : "The router must have control plane protection enabled.

 The Route Processor (RP) is critical to all network operations as it is the component used to build all forwarding paths for the data plane via control plane processes. It is also instrumental with ongoing network management functions that keep the routers and links available for providing network services. Hence, any disruption to the RP or the control and management planes can result in mission critical network outages.

 In addition to control plane and management plane traffic that is in the router's receive path, the RP must also handle other traffic that must be punted to the RP-that is, the traffic must be fast or process switched. This is the result of packets that must be fragmented, require an ICMP response (TTL expiration, unreachable, etc.) have IP options, etc. A DoS attack targeting the RP can be perpetrated either inadvertently or maliciously involving high rates of punted traffic resulting in excessive RP CPU and memory utilization. To maintain network stability, the router must be able to securely handle specific control plane and management plane traffic that is destined to it, as well as other punted traffic.

 Using the ingress filter on forwarding interfaces is a method that has been used in the past to filter both forwarding path and receiving path traffic. However, this method does not scale well as the number of interfaces grows and the size of the ingress filters grow. Control plane policing can be used to increase security of routers and multilayer switches by protecting the RP from unnecessary or malicious traffic. Filtering and rate limiting the traffic flow of control plane packets can be implemented to protect routers against reconnaissance and DoS attacks allowing the control plane to maintain packet forwarding and protocol states despite an attack or heavy load on the router or multilayer switch.

 NOTE: Change 'IP_RECEIVE_ACL' to the access control list number for IP receive filtering.
 NOTE: If 'ip receive acl' is in use, review the ACL list to ensure it is configured correctly to filter traffic."
  solution    : "Implement control plane protection by classifying traffic types based on importance levels and configure filters to restrict and rate limit the traffic punted to the route processor as according to each class."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,Rule-ID|SV-21167r2_rule,STIG-ID|NET0966,TBA-FIISB|31.3,Vuln-ID|V-19188"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IP_RECEIVE_ACL@ replaced with "1" in field "item".
  item        : "ip receive acl 1"
</item>

<report type:"WARNING">
  description : "NET0966 - Control plan protection is not enabled - 'inbound ACL option'"
  info        : "The router must have control plane protection enabled.

 The Route Processor (RP) is critical to all network operations as it is the component used to build all forwarding paths for the data plane via control plane processes. It is also instrumental with ongoing network management functions that keep the routers and links available for providing network services. Hence, any disruption to the RP or the control and management planes can result in mission critical network outages.

 In addition to control plane and management plane traffic that is in the router's receive path, the RP must also handle other traffic that must be punted to the RP-that is, the traffic must be fast or process switched. This is the result of packets that must be fragmented, require an ICMP response (TTL expiration, unreachable, etc.) have IP options, etc. A DoS attack targeting the RP can be perpetrated either inadvertently or maliciously involving high rates of punted traffic resulting in excessive RP CPU and memory utilization. To maintain network stability, the router must be able to securely handle specific control plane and management plane traffic that is destined to it, as well as other punted traffic.

 Using the ingress filter on forwarding interfaces is a method that has been used in the past to filter both forwarding path and receiving path traffic. However, this method does not scale well as the number of interfaces grows and the size of the ingress filters grow. Control plane policing can be used to increase security of routers and multilayer switches by protecting the RP from unnecessary or malicious traffic. Filtering and rate limiting the traffic flow of control plane packets can be implemented to protect routers against reconnaissance and DoS attacks allowing the control plane to maintain packet forwarding and protocol states despite an attack or heavy load on the router or multilayer switch.

 NOTE: This check requires manual verification in the event that neither CoPP nor the ip receive path acl feature are supported. An inbound ACL should be configured to the guidance documentation. If CoPP is in place and properly configured this check can be ignored.
 NOTE: If the Management Plane Protection (MPP) feature is enabled for an OOBM interface, there would be no purpose in filtering this traffic on the receive path. With MPP enabled, no interfaces except the management interface will accept network management traffic destined to the device. This feature also provides the capability to restrict which management protocols are allowed. See NET0992 for additional configuration information.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Implement control plane protection by classifying traffic types based on importance levels and configure filters to restrict and rate limit the traffic punted to the route processor as according to each class."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-21167r2_rule,STIG-ID|NET0966,Vuln-ID|V-19188"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET0985 - IGP instances do not peer with appropriate domain"
  info        : "IGP instances configured on the OOBM gateway router do not peer only with their appropriate routing domain.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. Since the managed network and the management network are separate routing domains, separate IGP routing instances must be configured on the router-one for the managed network and one for the OOBM network.

 NOTE: This check requires manual verification to ensure all IGP instances are configured on the OOBM gateway router peer only with their appropriate routing domain.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure that multiple IGP instances configured on the OOBM gateway router peer only with their appropriate routing domain. Verify that the all interfaces are configured for the appropriate IGP instance."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-19297r1_rule,STIG-ID|NET0985,Vuln-ID|V-17815"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET0986 - Routes from the two IGP domains are redistributed"
  info        : "The routes from the two IGP domains are redistributed to each other.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. Since the managed network and the management network are separate routing domains, separate IGP routing instances must be configured on the route-one for the managed network and one for the OOBM network. In addition, the routes from the two domains must not be redistributed to each other."
  solution    : "Ensure that the IGP instance used for the managed network does not redistribute routes into the IGP instance used for the management network and vice versa."
  reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(21),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.DS-5,NESA|T4.5.3,NIAv2|VL6,PCI-DSSv3.2|2.2.4,Rule-ID|SV-19299r1_rule,STIG-ID|NET0986,Vuln-ID|V-17816"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "router ([^ ]+) ([0-9]+)"
  item        : "redistribute ([^ ]+) ([0-9]+)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0987 - Managed network has access to OOBM gateway router - 'ip receive acl IP_RECEIVE_ACL'"
  info        : "Traffic from the managed network is able to access the OOBM gateway router.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. It is imperative that hosts from the managed network are not able to access the OOBM gateway router.

 NOTE: Change 'IP_RECEIVE_ACL' to the access control list number for IP receive filtering."
  solution    : "Ensure that traffic from the managed network is not able to access the OOBM gateway router using either receive path or interface ingress ACLs."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19301r2_rule,STIG-ID|NET0987,TBA-FIISB|31.3,Vuln-ID|V-17817"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IP_RECEIVE_ACL@ replaced with "1" in field "item".
  item        : "ip receive acl 1"
</item>

<report type:"WARNING">
  description : "NET0987 - Managed network has access to OOBM gateway router - 'Review IP_RECEIVE_ACL'"
  info        : "Traffic from the managed network is able to access the OOBM gateway router.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. It is imperative that hosts from the managed network are not able to access the OOBM gateway router.

 NOTE: A manual review of the ACL list utilized to grant your organization's management network access to the router should be performed to ensure the managed network does not have access. Verify that the ACL referenced by the ip receive acl statement restricts all management plane traffic to the validated network management address block at the NOC.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure that traffic from the managed network is not able to access the OOBM gateway router using either receive path or interface ingress ACLs."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-19301r2_rule,STIG-ID|NET0987,Vuln-ID|V-17817"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0988 - Traffic from the managed network will leak - 'OOBM Interface (ip access-list OOBM_EGRESS_ACL out)'"
  info        : "Traffic from the managed network will leak into the management network via the gateway router interface connected to the OOBM backbone.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries such as using interface ACLs or filters at the boundaries between the two networks.

 NOTE: Change 'OOBM_INTERFACE' to the OOBM interface for your organization.
 NOTE: Change 'OOBM_EGRESS_ACL' to the ACL list for granting your organization's management network access to the router and to prevent the managed network from leaking into the management network."
  solution    : "Configure the OOBM gateway router interface ACLs to ensure traffic from the managed network does not leak into the management network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19303r1_rule,STIG-ID|NET0988,Vuln-ID|V-17818"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_INTERFACE@ replaced with "Serial0" in field "context".
  context     : "interface Serial0"
# Note: Variable @OOBM_EGRESS_ACL@ replaced with "1" in field "item".
  item        : "ip access-list 1 out"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0988 - Traffic from the managed network will leak - 'access-list OOBM_EGRESS_ACL permit'"
  info        : "Traffic from the managed network will leak into the management network via the gateway router interface connected to the OOBM backbone.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries such as using interface ACLs or filters at the boundaries between the two networks.

 NOTE: Change 'OOBM_EGRESS_ACL' to the ACL list for granting your organization's management network access to the router and to prevent the managed network from leaking into the management network.
 NOTE: Change 'LOCAL_MANAGEMENT_NETWORK' to the OOBM network for your organization.
 NOTE: Change 'REMOTE_MANAGEMENT_NETWORK' to the management network space at the NOC."
  solution    : "Configure the OOBM gateway router interface ACLs to ensure traffic from the managed network does not leak into the management network."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19303r1_rule,STIG-ID|NET0988,Vuln-ID|V-17818"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_EGRESS_ACL@ replaced with "1" in field "item".
# Note: Variable @LOCAL_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.2\\.0 0\\.0\\.0\\.255" in field "item".
# Note: Variable @REMOTE_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.1\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "access-list 1 permit ip 10\\.10\\.2\\.0 0\\.0\\.0\\.255 10\\.10\\.1\\.0 0\\.0\\.0\\.255"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0988 - Traffic from the managed network will leak - 'access-list OOBM_EGRESS_ACL deny'"
  info        : "Traffic from the managed network will leak into the management network via the gateway router interface connected to the OOBM backbone.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries such as using interface ACLs or filters at the boundaries between the two networks.

 NOTE: Change 'OOBM_EGRESS_ACL' to the ACL list for granting your organization's management network access to the router and to prevent the managed network from leaking into the management network."
  solution    : "Configure the OOBM gateway router interface ACLs to ensure traffic from the managed network does not leak into the management network."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19303r1_rule,STIG-ID|NET0988,Vuln-ID|V-17818"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_EGRESS_ACL@ replaced with "1" in field "item".
  item        : "access-list 1 deny ( +)?ip any any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0989 - Management traffic leaks into the managed network - 'OOBM Interface (ip access-list ACL_LIST in)'"
  info        : "Management network traffic is leaking into the managed network.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. To provide separation, access control lists or filters must be configured to block any traffic from the management network destined for the managed network's production address spaces.

 NOTE: Change 'OOBM_INTERFACE' to the OOBM interface for your organization.
 NOTE: Change 'OOBM_INGRESS_ACL' to the ACL list for granting access to the local management network access to ensure management traffic does not leak into the managed network."
  solution    : "Configure access control lists or filters to block any traffic from the management network destined for the managed network's production address spaces."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19305r1_rule,STIG-ID|NET0989,Vuln-ID|V-17819"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_INTERFACE@ replaced with "Serial0" in field "context".
  context     : "interface Serial0"
# Note: Variable @OOBM_INGRESS_ACL@ replaced with "2" in field "item".
  item        : "ip access-list 2 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0989 - Management traffic leaks into the managed network - 'access-list OOBM_INGRESS_ACL permit'"
  info        : "Management network traffic is leaking into the managed network.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. To provide separation, access control lists or filters must be configured to block any traffic from the management network destined for the managed network's production address spaces.

 NOTE: Change 'OOBM_INRESS_ACL' to the ACL list for granting your organization's management network access to the router and to prevent the management network from leaking into the managed network.
 NOTE: Change 'REMOTE_MANAGEMENT_NETWORK' to the management network space at the NOC.
 NOTE: Change 'LOCAL_MANAGEMENT_NETWORK' to the OOBM network for your organization."
  solution    : "Configure access control lists or filters to block any traffic from the management network destined for the managed network's production address spaces."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19305r1_rule,STIG-ID|NET0989,Vuln-ID|V-17819"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_INGRESS_ACL@ replaced with "2" in field "item".
# Note: Variable @REMOTE_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.1\\.0 0\\.0\\.0\\.255" in field "item".
# Note: Variable @LOCAL_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.2\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "access-list 2 permit ip 10\\.10\\.1\\.0 0\\.0\\.0\\.255 10\\.10\\.2\\.0 0\\.0\\.0\\.255"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0989 - Management traffic leaks into the managed network - 'access-list OOBM_INGRESS_ACL deny'"
  info        : "Management network traffic is leaking into the managed network.

 If the gateway router is not a dedicated device for the OOBM network, several safeguards must be implemented for containment of management and production traffic boundaries. To provide separation, access control lists or filters must be configured to block any traffic from the management network destined for the managed network's production address spaces.

 NOTE: Change 'OOBM_INRESS_ACL' to the ACL list for granting your organization's management network access to the router and to prevent the management network from leaking into the managed network."
  solution    : "Configure access control lists or filters to block any traffic from the management network destined for the managed network's production address spaces."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19305r1_rule,STIG-ID|NET0989,Vuln-ID|V-17819"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_INGRESS_ACL@ replaced with "2" in field "item".
  item        : "access-list 2 deny ( +)?ip any any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0991 - The OOBM interface not configured correctly"
  info        : "The network element's OOBM interface must be configured with an OOBM network address.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the OOBM interface does not have an IP address from the managed network address space, it will not have reachability from the NOC using scalable and normal control plane and forwarding mechanisms.

 NOTE: Change 'MANAGEMENT_INTERFACE' to the management interface for your organization.
 NOTE: Change 'MANAGEMENT_IP_AND_NETMASK' to the IP address and subnet mask for the OOBM IP address space on the managed network element's OOBM interface."
  solution    : "Configure the managed network element's OOBM interface with an IP address from the address space belonging to the OOBM network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20205r2_rule,STIG-ID|NET0991,Vuln-ID|V-17821"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MANAGEMENT_INTERFACE@ replaced with "FastEthernet0" in field "context".
  context     : "interface FastEthernet0"
# Note: Variable @MANAGEMENT_IP_AND_NETMASK@ replaced with "10\\.10\\.2\\.1 255\\.255\\.255\\.0" in field "item".
  item        : "ip address 10\\.10\\.2\\.1 255\\.255\\.255\\.0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 1 (Ingress ACL)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: Change 'MANAGEMENT_INTERFACE' to the management interface for your organization.
 NOTE: Change 'MGMT_INGRESS_ACL' to the ingress access control list for your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MANAGEMENT_INTERFACE@ replaced with "FastEthernet0" in field "context".
  context     : "interface FastEthernet0"
# Note: Variable @MGMT_INGRESS_ACL@ replaced with "12" in field "item".
  item        : "ip access-group 12 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 1 (Egress ACL)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: Change 'MANAGEMENT_INTERFACE' to the management interface for your organization.
 NOTE: Change 'MGMT_EGRESS_ACL' to the egress access control list for your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MANAGEMENT_INTERFACE@ replaced with "FastEthernet0" in field "context".
  context     : "interface FastEthernet0"
# Note: Variable @MGMT_EGRESS_ACL@ replaced with "13" in field "item".
  item        : "ip access-group 13 out"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 2 (access-list MGMT_INGRESS_ACL permit LOCAL_MANAGEMENT_NETWORK)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: Change 'MGMT_INRESS_ACL' to the ingress access control list for your organization's management interface.
 NOTE: Change 'REMOTE_MANAGEMENT_NETWORK' to the management network space at the NOC.
 NOTE: Change 'MANAGEMENT_IP_AND_NETMASK' to the IP address for your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MGMT_INGRESS_ACL@ replaced with "12" in field "item".
# Note: Variable @REMOTE_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.1\\.0 0\\.0\\.0\\.255" in field "item".
# Note: Variable @MANAGEMENT_IP_AND_NETMASK@ replaced with "10\\.10\\.2\\.1 255\\.255\\.255\\.0" in field "item".
  item        : "access-list 12 permit ip 10\\.10\\.1\\.0 0\\.0\\.0\\.255 host 10\\.10\\.2\\.1 255\\.255\\.255\\.0"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 2 (access-list MGMT_INGRESS_ACL deny)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: Change 'MGMT_INRESS_ACL' to the ingress access control list for your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MGMT_INGRESS_ACL@ replaced with "12" in field "item".
  item        : "access-list 12 deny ( +)?ip any any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 3 (access-list MGMT_EGRESS_ACL deny)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: Change 'MGMT_EGRESS_ACL' to the egress access control list for your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MGMT_EGRESS_ACL@ replaced with "13" in field "item".
  item        : "access-list 13 deny ( +)?ip any any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0992 - The management interface does not have an ACL - 'Step 3 (ip local policy route-map LOCAL_POLICY)'"
  info        : "The management interface is not configured with both an ingress and egress ACL.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 Cisco router-generated packets are not inspected by outgoing access-lists. To filter local traffic, IOS provides a feature called local policy routing, which enables the administrator to apply a route-map to any local router-generated traffic. To prohibit outgoing traffic from the local router to any destination other than the NOC ensure an appropriate LOCAL_POLICY is defined.

 NOTE: Change 'OOBM_LOCAL_POLICY' to the policy used for the route-map of your organization's management interface."
  solution    : "If the management interface is a routed interface, it must be configured with both an ingress and egress ACL. The ingress ACL should block any transit traffic, while the egress ACL should block any traffic that was not originated by the managed network elements."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-20208r1_rule,STIG-ID|NET0992,Vuln-ID|V-17822"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_LOCAL_POLICY@ replaced with "icmproutemap" in field "item".
  item        : "ip local policy route-map icmproutemap"
</item>

<report type:"WARNING">
  description : "NET0993 - The management interface is not IGP passive"
  info        : "The network element's management interface is not configured as passive for the IGP instance deployed in the managed network.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so management traffic, both data plane and control plane, does not leak into the managed network and production traffic does not leak into the management network.

 NOTE: This check requires manual verification that the router's management interface is configured as passive for the IGP instance configured for the managed network.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the management interface as passive for the IGP instance configured for the managed network. Depending on the platform and routing protocol, this may simply require that the interface or its IP address is not included in the IGP configuration."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-19334r2_rule,STIG-ID|NET0993,Vuln-ID|V-17823"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0994 - Management interface is assigned to a user VLAN - 'MGMT VLAN ID'"
  info        : "The management interface is an access switchport and has not been assigned to a separate management VLAN.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: Change 'MANAGEMENT_INTERFACE_PORT' to the used to connected to the management VLAN.
 NOTE: Change 'MGMT_VLAN_ID' to the VLAN associated with carrying your management traffic."
  solution    : "If the management interface is an access switchport, assign it to a separate management VLAN while the remainder of the access switchports can be assigned to user VLANs belonging to the managed network. This provides some level of separation between the management network and the managed network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|2.2.4,Rule-ID|SV-19337r1_rule,STIG-ID|NET0994,Vuln-ID|V-17824"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MANAGEMENT_INTERFACE_PORT@ replaced with "GigabitEthernet1/0/1" in field "context".
  context     : "interface GigabitEthernet1/0/1$"
# Note: Variable @MGMT_VLAN_ID@ replaced with "5" in field "item".
  item        : "switchport access vlan 5"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET0994 - Management interface is assigned to a user VLAN - 'access mode'"
  info        : "The management interface is an access switchport and has not been assigned to a separate management VLAN.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored."
  solution    : "If the management interface is an access switchport, assign it to a separate management VLAN while the remainder of the access switchports can be assigned to user VLANs belonging to the managed network. This provides some level of separation between the management network and the managed network."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|2.2.4,Rule-ID|SV-19337r1_rule,STIG-ID|NET0994,Vuln-ID|V-17824"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface GigabitEthernet1/0/1$"
  item        : "switchport mode access"
</item>

<report type:"WARNING">
  description : "NET0995 - Management VLAN has invalid addresses"
  info        : "An address has not been configured for the management VLAN from space belonging to the OOBM network assigned to that site.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering.  The separation also ensures that congestion or failures in the managed network do not affect the management of the device.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that the IP address configured is within the management IP network range.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Assign an IP address to the management VLAN from the address space belonging to the OOBM network."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-19338r1_rule,STIG-ID|NET0995,Vuln-ID|V-17825"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET0996 - Invalid ports with membership to the mgmt VLAN"
  info        : "The access switchport connecting to the OOBM access switch is not the only port with membership to the management VLAN.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network. An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures that congestion or failures in the managed network do not affect the management of the device.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: Change 'TRUNK_INTERFACE' to the devices trunk listening interface.
 NOTE: Change 'ALLOWED_VLANS' to the vlans that are allowed on the trunk interface excluding the management vlan."
  solution    : "Ensure that the access switchport connecting to the OOBM access switch  is the only port with membership to the management VLAN"
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|2.2.4,Rule-ID|SV-19339r1_rule,STIG-ID|NET0996,TBA-FIISB|31.3,Vuln-ID|V-17826"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @TRUNK_INTERFACE@ replaced with "GigabitEthernet1/0/10" in field "context".
  context     : "interface GigabitEthernet1/0/10$"
# Note: Variable @ALLOWED_VLANS@ replaced with "2-9" in field "item".
  item        : "switchport trunk allowed vlan 2-9"
</item>

<report type:"WARNING">
  description : "NET0997 - The management VLAN is not pruned from trunk links"
  info        : "The management VLAN is not pruned from any VLAN trunk links belonging to the managed network's infrastructure.

 The OOBM access switch will connect to the management interface of the managed network elements. The management interface can be a true OOBM interface or a standard interface functioning as the management interface. In either case, the management interface of the managed network element will be directly connected to the OOBM network.

 An OOBM interface does not forward transit traffic; thereby, providing complete separation of production and management traffic. Since all management traffic is immediately forwarded into the management network, it is not exposed to possible tampering. The separation also ensures that congestion or failures in the managed network do not affect the management of the device. If the device does not have an OOBM port, the interface functioning as the management interface must be configured so that management traffic does not leak into the managed network and that production traffic does not leak into the management network. ISL and 802.1q trunking enables multiple VLANs to traverse the same physical links between layer 2 switches or between a layer 2 switch and a router. If the management VLAN is not pruned from any VLAN trunk links belonging to the managed network's infrastructure, management traffic has the potential to leak into the production network.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that the management VLAN is not part of the range of permitted VLANs on any trunk interface.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Prune the management VLAN from any VLAN trunk links belonging to the managed network's infrastructure."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-19340r1_rule,STIG-ID|NET0997,Vuln-ID|V-17827"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET1003 - Mgmt VLAN does not have correct IP address"
  info        : "The management VLAN is not configured with an IP address from the management network address block.

 If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that the IP address assigned is a part of the management network address range.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the management VLAN with an IP address from the management network address block."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-19702r1_rule,STIG-ID|NET1003,Vuln-ID|V-17832"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1004 - No ingress ACL on management VLAN interface"
  info        : "If the management systems reside within the same Layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN. Inter-VLAN routing or the routing of traffic between nodes residing in different subnets requires a router or multi-layer switch (MLS). Access control lists must be used to enforce the boundaries between the management network and the network being managed. When using a MLS, an alternate method to prevent inter-VLAN routing is to configure the management Virtual Routing and Forwarding (VRF) to not import route targets from other VRFs which would ensure there is no reachability between networks.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: Change 'MGT_VLAN_Interface' to the VLAN interface configured to carry the management network traffic.
 NOTE: Change 'MGT_VLAN_ACL' to the MGMT access-list configured to control management traffic."
  solution    : "If an MLS is used to provide inter-VLAN routing, configure an inbound ACL for the management network VLAN interface."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19703r2_rule,STIG-ID|NET1004,Vuln-ID|V-17833"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MGMT_VLAN_Interface@ replaced with "Vlan5" in field "context".
  context     : "interface Vlan5"
# Note: Variable @MGMT_VLAN_ACL@ replaced with "108" in field "item".
  item        : "ip access-group 108 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1005 - No inbound ACL for mgmt network sub-interface - 'Sub-Interface Ingress ACL'"
  info        : "An inbound ACL is not configured for the management network sub-interface of the trunk link to block non-management traffic.

 If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN. Inter-VLAN routing or the routing of traffic between nodes residing in different subnets requires a router or multi-layer switch (MLS). Access control lists must be used to enforce the boundaries between the management network and the network being managed. All physical and virtual (i.e. MLS SVI) routed interfaces must be configured with ACLs to prevent the leaking of unauthorized traffic from one network to the other.

 NOTE: Change 'NIPRNET_LINK_INTERFACE' to the router's interface that connects to the NIPRNET Provider.
 NOTE: Change 'MGMT_INGRESS_ACL' to the ingress access control list for blocking your organization's non-management traffic on the management sub-interface."
  solution    : " If a router is used to provide inter-VLAN routing, configure an inbound ACL for the management network sub-interface for the trunk link to block non-management traffic."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19308r1_rule,STIG-ID|NET1005,Vuln-ID|V-17834"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NIPRNET_LINK_INTERFACE@ replaced with "FastEthernet0" in field "context".
  context     : "interface FastEthernet0"
# Note: Variable @MGMT_INGRESS_ACL@ replaced with "12" in field "item".
  item        : "ip access-group 12 in"
</item>

<report type:"WARNING">
  description : "NET1005 - No inbound ACL for mgmt network sub-interface - 'Sub-Interface Ingress ACL Permit/Deny'"
  info        : "An inbound ACL is not configured for the management network sub-interface of the trunk link to block non-management traffic.

 If the management systems reside within the same layer 2 switching domain as the managed network elements, then separate VLANs will be deployed to provide separation at that level. In this case, the management network still has its own subnet while at the same time it is defined as a unique VLAN. Inter-VLAN routing or the routing of traffic between nodes residing in different subnets requires a router or multi-layer switch (MLS). Access control lists must be used to enforce the boundaries between the management network and the network being managed. All physical and virtual (i.e. MLS SVI) routed interfaces must be configured with ACLs to prevent the leaking of unauthorized traffic from one network to the other.

 NOTE: A manual review of the Sub-Interface Ingress ACL is required to determine if the management network is the only network allowed to the management sub-interface and all other networks are denied.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If a router is used to provide inter-VLAN routing, configure an inbound ACL for the management network sub-interface for the trunk link to block non-management traffic."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-19308r1_rule,STIG-ID|NET1005,Vuln-ID|V-17834"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1006 - IPSec traffic is not restricted - 'crypto map configured on interface'"
  info        : "Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address.

 Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services.

 NOTE: Change 'NIPRNET_LINK_INTERFACE' to the router's interface that connects to the NIPRNET Provider.
 NOTE: Change 'IN_BAND_MGMT_VPN' to the VPN crypto map name for your organization."
  solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
  reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19310r1_rule,STIG-ID|NET1006,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17835"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @NIPRNET_LINK_INTERFACE@ replaced with "FastEthernet0" in field "context".
  context     : "interface FastEthernet0"
# Note: Variable @IN_BAND_MGMT_VPN@ replaced with "inbandvpn" in field "item".
  item        : "crypto map inbandvpn"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1006 - IPSec traffic is not restricted - 'crypto map IN_BAND_MGMT_VPN - match address IN_BAND_MGMT_VPN_ACL'"
  info        : "Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address.

 Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services.

 NOTE: Change 'IN_BAND_MGMT_VPN' to the VPN crypto map name for your organization.
 NOTE: Change 'IN_BAND_MGMT_VPN_ACL' to the access control list filtering VPN access for in-band management of the device."
  solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
  reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-19310r1_rule,STIG-ID|NET1006,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17835"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IN_BAND_MGMT_VPN@ replaced with "inbandvpn" in field "context".
  context     : "crypto map inbandvpn ([0-9]+) ipsec-isakmp"
# Note: Variable @IN_BAND_MGMT_VPN_ACL@ replaced with "10" in field "item".
  item        : "match address 10"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1006 - IPSec traffic is not restricted - 'access-list IN_BAND_MGMT_VPN_ACL permit'"
  info        : "Traffic entering the tunnels is not restricted to only the authorized management packets based on destination address.

 Similar to the OOBM model, when the production network is managed in-band, the management network could also be housed at a NOC that is located locally or remotely at a single or multiple interconnected sites. NOC interconnectivity as well as connectivity between the NOC and the managed networks' premise routers would be enabled using either provisioned circuits or VPN technologies such as IPSec tunnels or MPLS VPN services.

 NOTE: Change 'IN_BAND_MGMT_VPN_ACL' to the access control list filtering VPN access for in-band management of the device.
 NOTE: Change 'LOCAL_MANAGEMENT_NETWORK' to the management network for your organization."
  solution    : "Where IPSec technology is deployed to connect the managed network to the NOC, it is imperative that the traffic entering the tunnels is restricted to only the authorized management packets based on destination address."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19310r1_rule,STIG-ID|NET1006,Vuln-ID|V-17835"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IN_BAND_MGMT_VPN_ACL@ replaced with "10" in field "item".
# Note: Variable @LOCAL_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.2\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "access-list 10 permit ip any 10\\.10\\.2\\.0 0\\.0\\.0\\.255"
</item>

<report type:"WARNING">
  description : "NET1007 - Management traffic is not classified and marked"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network traffic.

 NOTE: This check requires manual verification that all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1007 - Management traffic is not classified and marked - 'class-map match-all MANAGEMENT_TRAFFIC'"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: Change 'MANAGEMENT_TRAFFIC' to the name for your organization's class-map name for management traffic.
 NOTE: Change 'MGMT_TRAFFIC_CLASSIFICATION_ACL' to the extended access control list name classifying your organization's management traffic."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MANAGEMENT_TRAFFIC@ replaced with "mgmttraffic" in field "context".
  context     : "class-map match-all mgmttraffic"
# Note: Variable @MGMT_TRAFFIC_CLASSIFICATION_ACL@ replaced with "mgmttrafficclass" in field "item".
  item        : "match access-group name mgmttrafficclass"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1007 - Management traffic is not classified and marked - 'policy-map DIST_LAYER_POLICY'"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: Change 'DIST_LAYER_POLICY' to the name for your organization's policy-map name for the management traffic.
 NOTE: Change 'MANAGEMENT_TRAFFIC' to the name for your organization's class-map name for management traffic."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @DIST_LAYER_POLICY@ replaced with "mgmttraffic" in field "context".
  context     : "policy-map mgmttraffic"
# Note: Variable @MANAGEMENT_TRAFFIC@ replaced with "mgmttraffic" in field "item".
  item        : "class mgmttraffic"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1007 - Management traffic is not classified and marked - 'policy-map DIST_LAYER_POLICY (set ip dscp DIST_LAYER_DSCP_VALUE)'"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: Change 'DIST_LAYER_POLICY' to the name for your organization's policy-map name for the management traffic.
 NOTE: Change 'DIST_LAYER_DSCP_VALUE' to the DSCP value for your organization's management traffic."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @DIST_LAYER_POLICY@ replaced with "mgmttraffic" in field "context".
  context     : "policy-map mgmttraffic"
# Note: Variable @DIST_LAYER_DSCP_VALUE@ replaced with "1" in field "item".
  item        : "set ip dscp 1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1007 - Management traffic is not classified and marked - 'Interface Configured (service-policy input DIST_LAYER_POLICY)'"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: Change 'INTERNAL_INTERFACE' to the Internal interface for your organization.
 NOTE: Change 'DIST_LAYER_POLICY' to the name for your organization's policy-map name for the management traffic."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,SWIFT-CSCv1|2.3,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @INTERNAL_INTERFACE@ replaced with "FastEthernet0/0" in field "context".
  context     : "interface FastEthernet0/0"
# Note: Variable @DIST_LAYER_POLICY@ replaced with "mgmttraffic" in field "item".
  item        : "service-policy input mgmttraffic"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1007 - Management traffic is not classified and marked - 'ip access-list extended MGMT_TRAFFIC_CLASSIFICATION_ACL permit'"
  info        : "Management traffic is not classified and marked at the nearest upstream MLS or router when management traffic must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: Change 'MGMT_TRAFFIC_CLASSIFICATION_ACL' to the extended access control list name classifying your organization's management traffic.
 NOTE: Change 'LOCAL_MANAGEMENT_NETWORK' to the management network for your organization."
  solution    : "When management traffic must traverse several nodes to reach the management network, classify and mark management traffic at the nearest upstream MLS or router."
  reference   : "800-171|3.13.1,800-53|SC-7(15),8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(15),NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-19313r1_rule,STIG-ID|NET1007,Vuln-ID|V-17836"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MGMT_TRAFFIC_CLASSIFICATION_ACL@ replaced with "mgmttrafficclass" in field "item".
# Note: Variable @LOCAL_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.2\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "ip access-list extended mgmttrafficclass permit ip any 10\\.10\\.2\\.0 0\\.0\\.0\\.255"
</item>

<report type:"WARNING">
  description : "NET1008 - Management traffic doesn't get preferred treatment"
  info        : "The core router within the managed network has not been configured to provide preferred treatment for management traffic that must traverse several nodes to reach the management network.

 When network congestion occurs, all traffic has an equal chance of being dropped. Prioritization of network management traffic must be implemented to ensure that even during periods of severe network congestion, the network can be managed and monitored. Quality of Service (QoS) provisioning categorizes network traffic, prioritizes it according to its relative importance, and provides priority treatment through congestion avoidance techniques. Implementing QoS within the network makes network performance more predictable and bandwidth utilization more effective. Most important, since the same bandwidth is being used to manage the network, it provides some assurance that there will be bandwidth available to troubleshoot outages and restore availability when needed.

 When management traffic must traverse several nodes to reach the management network, management traffic should be classified and marked at the nearest upstream MLS or router. In addition, all core routers within the managed network must be configured to provide preferred treatment based on the QoS markings. This will ensure that management traffic receives preferred treatment (per-hop behavior) at each forwarding device along the path to the management network. traffic.

 NOTE: This check requires a manual review of all class-maps and interfaces to ensure management traffic is given preferred treatment over all other traffic.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "When management traffic must traverse several nodes to reach the management network, ensure that all core routers within the managed network have been configured to provide preferred treatment for management traffic."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-19315r1_rule,STIG-ID|NET1008,Vuln-ID|V-17837"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1020 - Interface ACL deny statements are not logged"
  info        : "The network device must log all access control lists (ACL) deny statements.

 Auditing and logging are key components of any security architecture.  It is essential for security personnel to know what is being done, attempted to be done, and by whom in order to compile an accurate risk assessment. Auditing the actions on network devices provides a means to recreate an attack, or identify a configuration mistake on the device.

NOTE: Nessus returned all access-list statements that are configured with 'deny'. You will still need to manually review the list of deny statements to ensure all of them are set to log."
  solution    : "Configure interface ACLs to log all deny statements."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS7b,NIAv2|NS25,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15474r3_rule,STIG-ID|NET1020,Vuln-ID|V-3000"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "access-list ([0-9]+) deny.+"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1021 - The network element must log all messages except debugging. - 'Debugging on'"
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.

Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -> 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server.

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1. Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis.
2. Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3. Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server.

The buffer could be set to notification level or altered to a different level when required (i.e. debugging)."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-2,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|8.1.4.3(a),CSF|PR.PT-1,ITSG-33|AU-2,NESA|M1.2.2,NESA|M5.5.1,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM7,NIAv2|SS30,NIAv2|VL8,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,SWIFT-CSCv1|6.4,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging .* debugging"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1021 - The network element must log all messages except debugging. - 'Logging on'"
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.

Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -> 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server.

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1. Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis.
2. Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3. Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server.

The buffer could be set to notification level or altered to a different level when required (i.e. debugging)."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no logging on"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1021 - The network element must log all messages except debugging. - 'Logging buffered'"
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.

Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -> 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server.

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1. Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis.
2. Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3. Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server.

The buffer could be set to notification level or altered to a different level when required (i.e. debugging)."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-53|AU-4,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging buffered (409[6-9]|4[1-9][0-9]{2}|[5-9][0-9]{3}|[1-5][0-9]{4}|6[0-3][0-9]{3}|64000)$"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1021 - The network element must log all messages except debugging. - 'Logging console notifications'"
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.

Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -> 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server.

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1. Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis.
2. Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3. Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server.

The buffer could be set to notification level or altered to a different level when required (i.e. debugging)."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.6,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging console notifications"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1021 - The network element must log all messages except debugging. - 'Logging trap'"
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.

Cisco IOS routers and switches use level 6 (informational) when logging packets that are dropped via access control list. (%SEC-6-IPACCESSLOGNP: list 1 denied 0 1.1.1.2 -> 1.1.1.1, 1 packet). Hence, it is imperative that log messages at level 6 are captured for further analysis and incident reporting. However, these messages do not need to go to the console, but must go to the syslog server.

To avoid being locked out of the console in the event of an intensive log message generation such as when a large number of packets are being dropped, you can implement any of the following:

1. Limit the amount of logging based on same packet matching via the access-list log-update threshold command. The configured threshold specifies how often syslog messages are generated and sent after the initial packet match on a per flow basis.
2. Rate-limit messages at specific severity levels destined to be logged at the console via logging rate-limit command.
3. Have only messages at levels 0-5 (or 0-4) go to the console and messages at level 0-6 go to the syslog server.

The buffer could be set to notification level or altered to a different level when required (i.e. debugging)."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging trap ([^ ]+)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1021 - The network element must log all messages except debugging. - 'Logging LOGGING_HOST_IP'"
# Note: Variable @LOGGING_HOST_IP@ replaced with "192\\.168\\.2\\.1" in field "info".
  info        : "The network element must log all messages except debugging and send all log data to a syslog server.

Logging is a critical part of router security. Maintaining an audit trail of system activity logs (syslog) can help identify configuration errors, understand past intrusions, troubleshoot service disruptions, and react to probes and scans of the network. Syslog levels 0-6 are the levels required to collect the necessary information to help in the recovery process.
NOTE: This check looks to verify the command 'logging 192\\.168\\.2\\.1' is present in the configuration.
NOTE: Change 'LOGGING_HOST_IP' to the IP address for your organization's logging host."
  solution    : "Configure the network element to log all messages except debugging and send all log data to a syslog server."
  reference   : "800-171|3.3.8,800-53|AU-9(2),8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECSC-1,CAT|III,CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ITSG-33|AU-9(2),NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15476r2_rule,STIG-ID|NET1021,Vuln-ID|V-4584"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @LOGGING_HOST_IP@ replaced with "192\\.168\\.2\\.1" in field "item".
  item        : "logging host 192\\.168\\.2\\.1"
</item>

<report type:"WARNING">
  description : "NET1030 - Running and startup configurations are not synchronized"
  info        : "The network element's running configuration must be synchronized with the startup configuration after changes have been made and implemented.

 If the running and startup router configurations are not synchronized properly and a router malfunctions, it will not restart with all of the recent changes incorporated.  If the recent changes were security related, then the routers would be vulnerable to attack.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Add procedures to the standard operating procedure to keep the running configuration synchronized with the startup configuration."
  reference   : "8500.2|COBR-1,8500.2|ECSC-1,CAT|III,Rule-ID|SV-3072r3_rule,STIG-ID|NET1030,Vuln-ID|V-3072"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1623 - Authentication required for console access - 'CON port (login authentication AUTH_LIST)'"
  info        : "The network device must require authentication for console access.

 Network devices with no password for administrative access via the console provide the opportunity for anyone with physical access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

 NOTE: Change 'AAA_LOGIN_LIST' to your organization's AAA group name. If the default list is used for the AAA function then the login authentication list is not displayed in output.
 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure authentication for console access on the network device."
  reference   : "800-53|AC-6(3),8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,PCI-DSSv3.2|8.1,Rule-ID|SV-19270r4_rule,STIG-ID|NET1623,SWIFT-CSCv1|5.1,Vuln-ID|V-4582"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line con 0"
# Note: Variable @AAA_LOGIN_LIST@ replaced with "networkadmins" in field "item".
  item        : "login authentication networkadmins"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1623 - Authentication required for console access - 'AUX port (login authentication AUTH_LIST)'"
  info        : "The network device must require authentication for console access.

 Network devices with no password for administrative access via the console provide the opportunity for anyone with physical access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

 NOTE: Change 'AAA_LOGIN_LIST' to your organization's AAA group name. If the default list is used for the AAA function then the login authentication list is not displayed in output.
 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance.
 NOTE: If the AUX port in not used in your organization then it must be disabled. Once disabled this check is no longer applicable."
  solution    : "Configure authentication for console access on the network device."
  reference   : "800-53|AC-6(3),8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,PCI-DSSv3.2|8.1,Rule-ID|SV-19270r4_rule,STIG-ID|NET1623,SWIFT-CSCv1|5.1,Vuln-ID|V-4582"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line aux 0"
# Note: Variable @AAA_LOGIN_LIST@ replaced with "networkadmins" in field "item".
  item        : "login authentication networkadmins"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1623 - Authentication required for console access - 'AUX port no exec'"
  info        : "The network device must require authentication for console access.

 Network devices with no password for administrative access via the console provide the opportunity for anyone with physical access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

 NOTE: If the AUX port in not used in your organization then it must be disabled. This check is valid only if you need to ensure the AUX port is disabled when not required for access."
  solution    : "Configure authentication for console access on the network device."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-19270r4_rule,STIG-ID|NET1623,SWIFT-CSCv1|2.3,Vuln-ID|V-4582"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line aux 0"
  item        : "no exec"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1624 - The console port does not timeout after 10 minutes"
  info        : "The network element must time out access to the console port after 10 minutes or less of inactivity.

 Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition quickly terminating an idle session will also free up resources committed by the managed network element. Setting the timeout of the session to 10 minutes or less increases the level of protection afforded critical network components."
  solution    : "Configure the timeout for idle console connection to 10 minutes or less."
  reference   : "800-171|3.1.11,800-53|AC-12,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-15444r2_rule,STIG-ID|NET1624,Vuln-ID|V-3967"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line con 0"
  item        : "exec-timeout ([1-9]|10) ?0?"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1629 - The auxiliary port is not disabled"
  info        : "The network element's auxiliary port must be disabled unless it is connected to a secured modem providing encryption and authentication.

 The use of POTS lines to modems connecting to network devices provides clear text of authentication traffic over commercial circuits that could be captured and used to compromise the network.  Additional war dial attacks on the device could degrade the device and the production network. Secured modem devices must be able to authenticate users and must negotiate a key exchange before full encryption takes place.  The modem will provide full encryption capability (Triple DES) or stronger. The technician who manages these devices will be authenticated using a key fob and granted access to the appropriate maintenance port, thus the technician will gain access to the managed device (router, switch, etc.). The token provides a method of strong (two-factor) user authentication.  The token works in conjunction with a server to generate one-time user passwords that will change values at second intervals.  The user must know a personal identification number (PIN) and possess the token to be allowed access to the device.

 NOTE: The auxiliary port is must be disabled unless a secured modem providing encryption and authentication is connected to it. If a secure modem is in place and properly configured this check can be ignored."
  solution    : "Disable the auxiliary port. If used for out-of-band administrative access, the port must be connected to a secured modem providing encryption and authentication."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,Rule-ID|SV-15446r2_rule,STIG-ID|NET1629,SWIFT-CSCv1|2.3,Vuln-ID|V-7011"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line aux 0"
  item        : "no exec"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1636 - Management connections must require passwords - 'VTY port (login authentication AUTH_LIST)'"
  info        : "The network devices must require authentication prior to establishing a management connection for administrative access.

 Network devices with no password for administrative access via a management connection provide the opportunity for anyone with network access to the device to make configuration changes enabling them to disrupt network operations resulting in a network outage.

 NOTE: Change 'AAA_LOGIN_LIST' to your organization's AAA group name. If the default list is used for the AAA function then the login authentication list is not displayed in output.
 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure authentication for all management connections."
  reference   : "800-53|AC-6(3),8500.2|ECSC-1,CAT|I,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,PCI-DSSv3.2|8.1,Rule-ID|SV-15448r4_rule,STIG-ID|NET1636,SWIFT-CSCv1|5.1,Vuln-ID|V-3175"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line vty (.+)"
# Note: Variable @AAA_LOGIN_LIST@ replaced with "networkadmins" in field "item".
  item        : "login authentication networkadmins"
  severity    : MEDIUM
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1637 - Management connections are not restricted - 'VTY port (access-class ACL_LIST in)'"
  info        : "The network element must only allow management connections for administrative access from hosts residing in to the management network.

 Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment, could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering."
  solution    : "Configure an ACL or filter to restrict management access to the device from only the management network."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15449r3_rule,STIG-ID|NET1637,TBA-FIISB|31.3,Vuln-ID|V-5611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line vty (.+)"
# Note: Variable @VTY_ACL@ replaced with "20" in field "item".
  item        : "access-class 20 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1637 - Management connections are not restricted - 'VTY port (access-list VTY_ACL permit VTY_AUTH_IP log)'"
  info        : "The network element must only allow management connections for administrative access from hosts residing in to the management network.

 Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment, could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering.
 NOTE: Change 'VTY_AUTH_IP' to the individual IP address or network address and wildcard mask that are allowed to access the router through VTY."
  solution    : "Configure an ACL or filter to restrict management access to the device from only the management network."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15449r3_rule,STIG-ID|NET1637,TBA-FIISB|45.1.1,Vuln-ID|V-5611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @VTY_ACL@ replaced with "20" in field "item".
# Note: Variable @VTY_AUTH_IP@ replaced with "192\\.168\\.1\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "access-list 20 permit 192\\.168\\.1\\.0 0\\.0\\.0\\.255 log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1637 - Management connections are not restricted - 'VTY port (access-list VTY_ACL deny any log)'"
  info        : "The network element must only allow management connections for administrative access from hosts residing in to the management network.

 Remote administration is inherently dangerous because anyone with a sniffer and access to the right LAN segment, could acquire the device account and password information. With this intercepted information they could gain access to the infrastructure and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering."
  solution    : "Configure an ACL or filter to restrict management access to the device from only the management network."
  reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(c),CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|GS7b,NIAv2|NS25,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15449r3_rule,STIG-ID|NET1637,Vuln-ID|V-5611"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @VTY_ACL@ replaced with "20" in field "item".
  item        : "access-list 20 deny ( +)?any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'input ssh'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

 Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|2.3,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line vty (.+)"
  item        : "transport input ssh"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'ssh algorithm mac'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

 Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CIP|005-5-R2,CSF|PR.DS-5,HIPAA|164.312(e)(1),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.2|4.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,TBA-FIISB|29.1,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @SSH_ALGORITHM_MAC@ replaced with "hmac-sha1 hmac-sha1-96" in field "item".
  item        : "ip ssh server algorithm mac hmac-sha1 hmac-sha1-96"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'ssh algorithm encryption'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

 Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CIP|005-5-R2,CSF|PR.DS-5,HIPAA|164.312(e)(1),ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.2|4.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,TBA-FIISB|29.1,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @SSH_ALGORITHM_ENCRYPTION@ replaced with "aes128-cbc aes192-cbc aes256-cbc" in field "item".
  item        : "ip ssh server algorithm encryption aes128-cbc aes192-cbc aes256-cbc"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'ip http server'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all' is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,SWIFT-CSCv1|2.3,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip http server"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'ip http secure-server'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

 Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.2|8.2.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip http secure-server"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1638 - Management connections must be secured by FIPS 140-2 -'ip scp secure-server'"
  info        : "Management connections to a network device must be established using secure protocols with FIPS 140-2 validated cryptographic modules.

 Administration and management connections performed across a network are inherently dangerous because anyone with a packet sniffer and access to the right LAN segment can acquire the network device account and password information.  With this intercepted information they could gain access to the router and cause denial of service attacks, intercept sensitive information, or perform other destructive actions.

NOTE: Review the network device configuration to verify only secure protocols using FIPS 140-2 validated cryptographic modules are used for any administrative access. Using 'transport input all is not advisable. Some of the secure protocols used for administrative and management access are listed below. This list is not all inclusive and represents a sample selection of secure protocols.

-SSHv2
-SCP
-HTTPS
-SSL
-TLS"
  solution    : "Configure the network device to use secure protocols with FIPS 140-2 validated cryptographic modules."
  reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,8500.2|ECSC-1,CAT|II,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,PCI-DSSv3.2|4.1,Rule-ID|SV-15451r4_rule,STIG-ID|NET1638,Vuln-ID|V-3069"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip scp secure-server"
  required    : NO
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1639 - Management connection does not timeout"
  info        : "The network element must timeout management connections for administrative access after 10 minutes or less of inactivity.

 Setting the timeout of the session to 10 minutes or less increases the level of protection afforded critical network components."
  solution    : "Configure the network element to ensure the timeout for unattended administrative access connections is no longer than 10 minutes."
  reference   : "800-171|3.1.11,800-53|AC-12,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-15453r2_rule,STIG-ID|NET1639,Vuln-ID|V-3014"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "line vty (.+)"
  item        : "exec-timeout ([1-9]|10)$"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1640 - Management connections must be logged"
  info        : "The network element must log all attempts to establish a management connection for administrative access.

 Audit logs are necessary to provide a trail of evidence in case the network is compromised. Without an audit trail that provides a when, where, who and how set of information, repeat offenders could continue attacks against the network indefinitely. With this information, the network administrator can devise ways to block the attack and possibly identify and prosecute the attacker.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering."
  solution    : "Configure the device to log all access attempts to the device to establish a management connection for administrative access."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-15455r3_rule,STIG-ID|NET1640,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-3070"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "logging on"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1640 - Management connections must be logged - login failure"
  info        : "The network element must log all attempts to establish a management connection for administrative access.

 Audit logs are necessary to provide a trail of evidence in case the network is compromised. Without an audit trail that provides a when, where, who and how set of information, repeat offenders could continue attacks against the network indefinitely. With this information, the network administrator can devise ways to block the attack and possibly identify and prosecute the attacker.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering."
  solution    : "Configure the device to log all access attempts to the device to establish a management connection for administrative access."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15455r3_rule,STIG-ID|NET1640,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-3070"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "login on-failure log every 1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1640 - Management connections must be logged - login success"
  info        : "The network element must log all attempts to establish a management connection for administrative access.

 Audit logs are necessary to provide a trail of evidence in case the network is compromised. Without an audit trail that provides a when, where, who and how set of information, repeat offenders could continue attacks against the network indefinitely. With this information, the network administrator can devise ways to block the attack and possibly identify and prosecute the attacker.

 NOTE: Change 'VTY_ACL' to your organization's access control list for in-band management filtering."
  solution    : "Configure the device to log all access attempts to the device to establish a management connection for administrative access."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|III,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15455r3_rule,STIG-ID|NET1640,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-3070"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "login on-success log every 1"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1645 - SSH session timeout is not 60 seconds or less"
  info        : "The network element must be configured to timeout after 60 seconds or less for incomplete or broken SSH sessions.

 An attacker may attempt to connect to the device using SSH by guessing the authentication method, encryption algorithm, and keys. Limiting the amount of time allowed for authenticating and negotiating the SSH session reduces the window of opportunity for the malicious user attempting to make a connection to the network element."
  solution    : "Configure the network element so it will require a secure shell timeout of 60 seconds or less."
  reference   : "800-171|3.1.11,800-53|AC-12,8500.2|ECSC-1,CAT|II,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CN-L3|8.1.4.1(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-15457r2_rule,STIG-ID|NET1645,Vuln-ID|V-5612"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip ssh time-out ([1-9]|[1-5][0-9]|60)$"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1646 - SSH login attempts value is greater than 3 - 'ip ssh authentication-retries not found'"
  info        : "The network element must be configured for a maximum number of unsuccessful SSH login attempts set at 3 before resetting the interface.

 An attacker may attempt to connect to the device using SSH by guessing the authentication method and authentication key or shared secret. Setting the authentication retry to 3 or less strengthens against a Brute Force attack."
  solution    : "Configure the network element to require a maximum number of unsuccessful SSH login attempts at 3."
  reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECSC-1,CAT|II,CSCv6|16.7,ITSG-33|AC-7,PCI-DSSv3.2|8.1.6,Rule-ID|SV-15458r2_rule,STIG-ID|NET1646,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-5613"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip ssh authentication-retries [1-3]$"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1647 - The network element must not allow SSH Version 1"
  info        : "The network element must not use SSH Version 1 for administrative access.

 SSH Version 1 is a protocol that has never been defined in a standard. Since SSH-1 has inherent design flaws which make it vulnerable to, e.g., man-in-the-middle attacks, it is now generally considered obsolete and should be avoided by explicitly disabling fallback to SSH-1."
  solution    : "Configure the network element to use SSH version 2."
  reference   : "800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CSF|PR.IP-1,CSF|PR.PT-3,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15460r2_rule,STIG-ID|NET1647,Vuln-ID|V-14717"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip ssh version 2$"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1660 - An insecure version of SNMP is being used"
  info        : "The network element must use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography for any SNMP agent configured on the device.

 SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy that is provided by the SNMP Version 3 User-based Security Model (USM), an unauthorized user can gain access to network management information used to launch an attack against the network."
  solution    : "If SNMP is enabled, configure the network element to use SNMP Version 3 Security Model with FIPS 140-2 validated cryptography (i.e., SHA authentication and AES encryption)."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|I,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-3196r4_rule,STIG-ID|NET1660,SWIFT-CSCv1|2.3,Vuln-ID|V-3196"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "snmp-server host ([^ ]+) (.+) version (1|2c)(.+)$"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET1665 - Using default SNMP community names - 'Community set to Public or Private'"
  info        : "The network element must not use the default or well-known SNMP community strings public and private.

 Network elements may be distributed by the vendor pre-configured with an SNMP agent using the well known SNMP community strings public for read only and private for read and write authorization. An attacker can obtain information about a network element using the read community string 'public'. In addition, an attacker can change a system configuration using the write community string 'private'."
  solution    : "Configure unique SNMP community strings replacing the default community strings."
  reference   : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I,CIP|007-6-R5,CN-L3|7.1.3.2(d),CN-L3|8.1.4.2(b),CSCv6|5.3,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|NS2,NIAv2|NS39,NIAv2|SS14f,PCI-DSSv3.1|2.1,PCI-DSSv3.2|2.1,Rule-ID|SV-3210r4_rule,STIG-ID|NET1665,Vuln-ID|V-3210"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "snmp-server community public|private"
</item>

<report type:"WARNING">
  description : "NET1675 - SNMP privilege and non-privileged access"
  info        : "The network element must use different SNMP community names or groups for various levels of read and write access.

 Numerous vulnerabilities exist with SNMP; therefore, without unique SNMP community names, the risk of compromise is dramatically increased. This is especially true with vendors default community names which are widely known by hackers and other networking experts. If a hacker gains access to these devices and can easily guess the name, this could result in denial of service, interception of sensitive information, or other destructive actions.

 NOTE: This check requires a manual review of the router's configuration file to ensure that each SNMP community name/group is different for each level, (i.e. read and write access).
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the SNMP community strings on the network element and change them from the default values. SNMP community strings and user passwords must be unique and do not match any other network device passwords. Different community strings (V1/2) or groups (V3) must be configured for various levels of read and write access."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-3043r4_rule,STIG-ID|NET1675,Vuln-ID|V-3043"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET1800 - IPSec VPN is not configured as a tunnel type VPN"
  info        : "The IAO will ensure IPSec VPNs are established as tunnel type VPNs when transporting management traffic across an ip backbone network.

 Using dedicated paths, the OOBM backbone connects the OOBM gateway routers located at the premise of the managed networks and at the NOC. Dedicated links can be deployed using provisioned circuits (ATM, Frame Relay, SONET, T-carrier, and others or VPN technologies such as subscribing to MPLS Layer 2 and Layer 3 VPN services) or implementing a secured path with gateway-to-gateway IPsec tunnel. The tunnel mode ensures that the management traffic will be logically separated from any other traffic traversing the same path.

 NOTE: This check requires a manual review of the router's configuration file to ensure that each IPSec VPN is configured as 'mode tunnel'.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Establish the VPN as a tunneled VPN. Terminate the tunneled VPN outside of the firewall. Ensure all host-to-host VPN are established between trusted known hosts."
  reference   : "8500.2|EBVC-1,8500.2|ECSC-1,CAT|II,Rule-ID|SV-3008r1_rule,STIG-ID|NET1800,Vuln-ID|V-3008"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET1807 - Management traffic is not restricted - 'Interface crypto map configured (crypto map MYVPN)'"
  info        : "Management traffic is not restricted to only the authorized management packets based on destination and source IP address.

 The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC. This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation.

 NOTE: Change 'OOBM_INTERFACE' to the interface for your organization that allows VPN connections.
 NOTE: Change 'OOBM_VPN' to the VPN name for your organization."
  solution    : "Where IPSec technology is deployed to connect the OOBM gateway routers or firewall, traffic entering the tunnels is restricted to only the authorized management packets based on destination and source IP address from the address block used for the management network."
  reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),8500.2|ECNK-1,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-18945r2_rule,STIG-ID|NET1807,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17754"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_INTERFACE@ replaced with "Serial0" in field "context".
  context     : "interface Serial0"
# Note: Variable @OOBM_VPN@ replaced with "oobmvpn" in field "item".
  item        : "crypto map oobmvpn"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1807 - Management traffic is not restricted - 'crypto map OOBM_VPN (match address OOBM_VPN_ACL)'"
  info        : "Management traffic is not restricted to only the authorized management packets based on destination and source IP address.

 The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC. This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation.

 NOTE: Change 'OOBM_VPN' to the VPN name for your organization.
 NOTE: Change 'OOBM_VPN_ACL' to the number of the access control list filtering VPN access for out-of-band management of the device."
  solution    : "Where IPSec technology is deployed to connect the OOBM gateway routers or firewall, traffic entering the tunnels is restricted to only the authorized management packets based on destination and source IP address from the address block used for the management network."
  reference   : "800-171|3.13.1,800-171|3.13.8,800-53|SC-7(15),800-53|SC-8(1),8500.2|ECNK-1,CAT|II,CSF|PR.AC-5,CSF|PR.DS-2,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-7(15),ITSG-33|SC-8(1),NESA|T4.5.3,NESA|T7.4.1,NIAv2|NS5c,NIAv2|NS5d,NIAv2|NS6a,NIAv2|NS6b,PCI-DSSv3.2|4.1,Rule-ID|SV-18945r2_rule,STIG-ID|NET1807,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-17754"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_VPN@ replaced with "oobmvpn" in field "context".
  context     : "crypto map oobmvpn ([0-9]+) ipsec-isakmp"
# Note: Variable @OOBM_VPN_ACL@ replaced with "10" in field "item".
  item        : "match address 10"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET1807 - Management traffic is not restricted - 'access list OOBM_VPN_ACL permit'"
  info        : "Management traffic is not restricted to only the authorized management packets based on destination and source IP address.

 The Out-of-Band Management (OOBM) network is an IP network used exclusively for the transport of OAM&P data from the network being managed to the OSS components located at the NOC. Its design provides connectivity to each managed network element enabling network management traffic to flow between the managed NEs and the NOC. This allows the use of paths separate from those used by the network being managed. Traffic from the managed network to the management network and vice-versa must be secured via IPSec encapsulation.

 NOTE: Change 'OOBM_VPN_ACL' to the number of the access control list filtering VPN access for out-of-band management of the device.
 NOTE: Change 'LOCAL_MANAGEMENT_NETWORK' to the OOBM network for your organization.
 NOTE: Change 'REMOTE_MANAGEMENT_NETWORK' to the management network space at the NOC."
  solution    : "Where IPSec technology is deployed to connect the OOBM gateway routers or firewall, traffic entering the tunnels is restricted to only the authorized management packets based on destination and source IP address from the address block used for the management network."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECNK-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,NESA|T4.5.3,NIAv2|NS5c,NIAv2|NS6a,PCI-DSSv3.2|1.2.1,Rule-ID|SV-18945r2_rule,STIG-ID|NET1807,Vuln-ID|V-17754"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OOBM_VPN_ACL@ replaced with "10" in field "item".
# Note: Variable @LOCAL_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.2\\.0 0\\.0\\.0\\.255" in field "item".
# Note: Variable @REMOTE_MANAGEMENT_NETWORK@ replaced with "10\\.10\\.1\\.0 0\\.0\\.0\\.255" in field "item".
  item        : "access-list 10 permit ip 10\\.10\\.2\\.0 0\\.0\\.0\\.255 10\\.10\\.1\\.0 0\\.0\\.0\\.255"
</item>

<report type:"WARNING">
  description : "NET1808 - Remote VPN end-point not a mirror of local gateway"
  info        : "Gateway configuration at the remote VPN end-point is a not a mirror of the local gateway.

 The IPSec tunnel end points may be configured on the OOBM gateway routers connecting the managed network and the NOC. They may also be configured on a firewall or VPN concentrator located behind the gateway router. In either case, the crypto access-list used to identify the traffic to be protected must be a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer.

 NOTE: This check requires manual verification that the crypto access-list are mirrored on other VPN equipment located behind the gateway router.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the crypto access-list used to identify the traffic to be protected so that it is a mirror (both IP source and destination address) of the crypto access list configured at the remote VPN peer."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-19063r1_rule,STIG-ID|NET1808,Vuln-ID|V-17814"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-IPV6-025 - IPv6 Site Local Unicast ADDR must not be defined"
  info        : "The network element must be configured to ensure IPv6 Site Local Unicast addresses are not defined in the enclave, (FEC0--/10). Note that this consist of all addresses that begin with FEC, FED, FEE and FEF.

 As currently defined, site local addresses are ambiguous and can be present in multiple sites. The address itself does not contain any indication of the site to which it belongs. The use of site-local addresses has the potential to adversely affect network security through leaks, ambiguity and potential misrouting, as documented in section 2 of RFC3879. RFC3879 formally deprecates the IPv6 site-local unicast prefix defined in RFC3513, i.e., 1111111011 binary or FEC0--/10."
  solution    : "Configure the device using authorized IP addresses."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15397r2_rule,STIG-ID|NET-IPV6-025,SWIFT-CSCv1|2.3,Vuln-ID|V-14693"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.+)"
  item        : "ipv6 address (FEC0|FEC|FED|FEE|FEF):.*"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-IPV6-033 - IPv6 routers are not configured with CEF enabled"
  info        : "The administrator will enable CEF to improve router stability during a SYN flood attack in an IPv6 enclave.

 The Cisco Express Forwarding (CEF) switching mode replaces the traditional Cisco routing cache with a data structure that mirrors the entire system routing table. Because there is no need to build cache entries when traffic starts arriving for new destinations, CEF behaves more predictably when presented with large volumes of traffic addressed to many destinations-such as a SYN flood attacks that. Because many SYN flood attacks use randomized source addresses to which the hosts under attack will reply to, there can be a substantial amount of traffic for a large number of destinations that the router will have to handle. Consequently, routers configured for CEF will perform better under SYN floods directed at hosts inside the network than routers using the traditional cache.

 Note: Juniper's FPC (Flexible PIC Concentrator) architecture with the integrated Packet Forwarding Engine provides similar functionality and capabilities and is far superior than the traditional routing cache that is vulnerable to a DoS attack described above. The forwarding plane on all Juniper M and T  Series platforms are built around this architecture and therefore is not configurable. The forwarding plane on all Juniper M and T Series platforms are built around the FPC (Flexible PIC Concentrator) architecture that has similar capabilities as CEF. FPC is not configurable and is totally integrated with the Packet Forwarding Engine; hence, this will always be not a finding."
  solution    : "The IAO will ensure that the ipv6 cef command has been configured on Cisco routers."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-15425r1_rule,STIG-ID|NET-IPV6-033,SWIFT-CSCv1|2.3,Vuln-ID|V-14705"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "no ipv6 cef"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-034 - IPv6 Egress Outbound Spoofing Filter - 'ipv6 verify unicast source reachable-via rx OUTBOUND_TO_BACKBONE'"
  info        : "The network element must be configured from accepting any outbound IP packet that contains an illegitimate address in the source address field via egress ACL or by enabling Unicast Reverse Path Forwarding in an IPv6 enclave.

 Unicast Reverse Path Forwarding (uRPF) provides a mechanism for IP address spoof protection. When uRPF is enabled on an interface, the router examines all packets received as input on that interface to make sure that the source address and source interface appear in the routing table and match the interface on which the packet was received. If the packet was received from one of the best reverse path routes, the packet is forwarded as normal. If there is no reverse path route on the same interface from which the packet was received, it might mean that the source address was modified. If Unicast RPF does not find a reverse path for the packet, the packet is dropped.

 If internal nodes automatically configure an address based on a prefix from a bogus Router Advertisement a dangerous situation may exist. An internal host may contact an internal server which responds with a packet that could be routed outside of the network via default routing (because the routers do not recognize the destination address as an internal address.

 To prevent this, filtering should be applied to network interfaces between internal host LANs and internal server LANs to insure that source addresses have valid prefixes.

 NOTE: Change 'INTERNAL_INTERFACE' to the router's interface that connects to your LAN.
 NOTE: Change 'OUT_TO_BACKBONE_ACL' to the access control list for IPv6 outbound to backbone connection filtering."
  solution    : "The network element must be configured to ensure that an ACL is configured to restrict the router from accepting any outbound IP packet that contains an external IP address in the source field."
  reference   : "800-171|3.13.1,800-53|SC-7(16),8500.2|ECSC-1,CAT|II,CSF|PR.PT-4,ITSG-33|SC-7(16),NIAv2|GS8d,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15429r1_rule,STIG-ID|NET-IPV6-034,Vuln-ID|V-14707"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @INTERNAL_INTERFACE@ replaced with "FastEthernet0/0" in field "context".
  context     : "interface FastEthernet0/0"
# Note: Variable @OUT_TO_BACKBONE_ACL@ replaced with "7" in field "item".
  item        : "ipv6 verify unicast source reachable-via rx 7"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-034 - IPv6 Egress Outbound Spoofing Filter - 'deny ipv6 any any log'"
  info        : "The network element must be configured from accepting any outbound IP packet that contains an illegitimate address in the source address field via egress ACL or by enabling Unicast Reverse Path Forwarding in an IPv6 enclave.

 Unicast Reverse Path Forwarding (uRPF) provides a mechanism for IP address spoof protection. When uRPF is enabled on an interface, the router examines all packets received as input on that interface to make sure that the source address and source interface appear in the routing table and match the interface on which the packet was received. If the packet was received from one of the best reverse path routes, the packet is forwarded as normal. If there is no reverse path route on the same interface from which the packet was received, it might mean that the source address was modified. If Unicast RPF does not find a reverse path for the packet, the packet is dropped.

 If internal nodes automatically configure an address based on a prefix from a bogus Router Advertisement a dangerous situation may exist. An internal host may contact an internal server which responds with a packet that could be routed outside of the network via default routing (because the routers do not recognize the destination address as an internal address.

 To prevent this, filtering should be applied to network interfaces between internal host LANs and internal server LANs to insure that source addresses have valid prefixes.

 NOTE: Change 'OUT_TO_BACKBONE_ACL' to the access control list for IPv6 outbound to backbone connection filtering."
  solution    : "The network element must be configured to ensure that an ACL is configured to restrict the router from accepting any outbound IP packet that contains an external IP address in the source field."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-15429r1_rule,STIG-ID|NET-IPV6-034,Vuln-ID|V-14707"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @OUT_TO_BACKBONE_ACL@ replaced with "7" in field "context".
  context     : "ipv6 access-list 7"
  item        : "deny ipv6 any any log"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-IPV6-059 - Maximum hop limit is less than 32"
  info        : "The administrator must ensure that the maximum hop limit is at least 32.

 The Neighbor Discovery protocol allows a hop limit value to be advertised by routers in a Router Advertisement message to be used by hosts instead of the standardized default value. If a very small value was configured and advertised to hosts on the LAN segment, communications would fail due to hop limit reaching zero before the packets sent by a host reached its destination.

 NOTE: The IOS default is 64. Hence, if the hop limit is not configured, the router will be in compliance with the requirement."
  solution    : "If the maximum hop limit is configured, it must be set to at least 32."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-40389r1_rule,STIG-ID|NET-IPV6-059,SWIFT-CSCv1|2.3,Vuln-ID|V-30617"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ipv6 hop-limit ([0-9]|[1-2][0-9]|3[0-1])$"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-065 - The 6-to-4 router is not filtering protocol 41 - 'tunnel mode ipv6ip 6to4'"
  info        : "The administrator must ensure the 6-to-4 router is configured to drop any IPv4 packets with protocol 41 received from the internal network.

 The 6to4 specific filters accomplish the role of endpoint verification and provide assurance that the tunnels are being used properly. This primary guidance assumes that only the designated 6to4 router is allowed to form tunnel packets. If they are being formed inside an enclave and passed to the 6to4 router, they are suspicious and must be dropped. In accordance with DoD IPv6 IA Guidance for MO3 (S5-C7-8), packets as such must be dropped and logged as a security event."
  solution    : "If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets."
  reference   : "800-171|3.1.3,800-53|AC-4,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|AC-4,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSSv3.2|2.2.4,Rule-ID|SV-40454r1_rule,STIG-ID|NET-IPV6-065,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4,Vuln-ID|V-30660"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface Tunnel[0-9]+"
  item        : "tunnel mode ipv6ip 6to4"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-065 - The 6-to-4 router is not filtering protocol 41 - 'ip access-group IPV4_EGRESS_FILTER'"
  info        : "The administrator must ensure the 6-to-4 router is configured to drop any IPv4 packets with protocol 41 received from the internal network.

 The 6to4 specific filters accomplish the role of endpoint verification and provide assurance that the tunnels are being used properly. This primary guidance assumes that only the designated 6to4 router is allowed to form tunnel packets. If they are being formed inside an enclave and passed to the 6to4 router, they are suspicious and must be dropped. In accordance with DoD IPv6 IA Guidance for MO3 (S5-C7-8), packets as such must be dropped and logged as a security event.

 NOTE: Change 'TUNNEL_SRC_INTERFACE' to the source interface of the 6to4 tunnel interface.
 NOTE: Change 'IPV4_EGRESS_ACL' to the access control list number for IPv4 outbound connection filtering."
  solution    : "If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,Rule-ID|SV-40454r1_rule,STIG-ID|NET-IPV6-065,TBA-FIISB|31.3,Vuln-ID|V-30660"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @TUNNEL_SRC_INTERFACE@ replaced with "FastEthernet0/1" in field "context".
  context     : "interface FastEthernet0/1"
# Note: Variable @IPV4_EGRESS_ACL@ replaced with "9" in field "item".
  item        : "ip access-group 9 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-065 - The 6-to-4 router is not filtering protocol 41 - 'ip access-list IPV4_EGRESS_FILTER'"
  info        : "The administrator must ensure the 6-to-4 router is configured to drop any IPv4 packets with protocol 41 received from the internal network.

 The 6to4 specific filters accomplish the role of endpoint verification and provide assurance that the tunnels are being used properly. This primary guidance assumes that only the designated 6to4 router is allowed to form tunnel packets. If they are being formed inside an enclave and passed to the 6to4 router, they are suspicious and must be dropped. In accordance with DoD IPv6 IA Guidance for MO3 (S5-C7-8), packets as such must be dropped and logged as a security event.

 NOTE: Change 'IPV4_EGRESS_ACL' to the access control list number for IPv4 outbound connection filtering."
  solution    : "If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv4 packets that are tunneling IPv6 packets."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-40454r1_rule,STIG-ID|NET-IPV6-065,Vuln-ID|V-30660"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IPV4_EGRESS_ACL@ replaced with "9" in field "context".
  context     : "ip access-list extended 9"
  item        : "deny 41 any any log"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-066 - 6-to-4 router not filtering invalid source address - 'ipv6 traffic-filter IPV6_EGRESS_ACL in'"
  info        : "The administrator must ensure the 6-to-4 router is configured to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002-V4ADDR--/48 where V4ADDR is the designated IPv4 6to4 address for the enclave.

 An automatic 6to4 tunnel allows isolated IPv6 domains to be connected over an IPv4 network and allows connections to remote IPv6 networks. The key difference between this deployment and manually configured tunnels is that the routers are not configured in pairs and thus do not require manual configuration because they treat the IPv4 infrastructure as a virtual non-broadcast link, using an IPv4 address embedded in the IPv6 address to find the remote end of the tunnel. In other words, the tunnel destination is determined by the IPv4 address of the external interface of the 6to4 router that is concatenated to the 2002--/16 prefix in the format 2002- V4ADDR--/48.  Hence, the imbedded V4ADDR of the 6to4 prefix must belong to the same ipv4 prefix as configured on the external-facing interface of the 6to4 router.

 NOTE: Change 'INTERNAL_INTERFACE' to the router's interface that connects to your LAN.
 NOTE: Change 'IPV6_EGRESS_ACL' to the access control list for IPv6 inbound connection filtering and verify the ACL is applied to the proper interface."
  solution    : "If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002-V4ADDR--/48 where V4ADDR is the designated IPv4 6to4 address for the enclave."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|III,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,Rule-ID|SV-40539r1_rule,STIG-ID|NET-IPV6-066,TBA-FIISB|31.3,Vuln-ID|V-30736"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @INTERNAL_INTERFACE@ replaced with "FastEthernet0/0" in field "context".
  context     : "interface FastEthernet0/0"
# Note: Variable @IPV6_EGRESS_ACL@ replaced with "9" in field "item".
  item        : "ipv6 traffic-filter 9 in"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-IPV6-066 - 6-to-4 router not filtering invalid source address - 'permit ipv6 2002:V4ADDR::/48'"
  info        : "The administrator must ensure the 6-to-4 router is configured to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002-V4ADDR--/48 where V4ADDR is the designated IPv4 6to4 address for the enclave.

 An automatic 6to4 tunnel allows isolated IPv6 domains to be connected over an IPv4 network and allows connections to remote IPv6 networks. The key difference between this deployment and manually configured tunnels is that the routers are not configured in pairs and thus do not require manual configuration because they treat the IPv4 infrastructure as a virtual non-broadcast link, using an IPv4 address embedded in the IPv6 address to find the remote end of the tunnel. In other words, the tunnel destination is determined by the IPv4 address of the external interface of the 6to4 router that is concatenated to the 2002--/16 prefix in the format 2002- V4ADDR--/48.  Hence, the imbedded V4ADDR of the 6to4 prefix must belong to the same ipv4 prefix as configured on the external-facing interface of the 6to4 router.

 NOTE: Change 'IPV6_EGRESS_ACL' to the access control list for IPv6 inbound connection filtering and verify the ACL is applied to the proper interface.
 NOTE: Change 'V4ADDR' to the hexadecimal representation of the IPv4 address of the internal network interface."
  solution    : "If the router is functioning as a 6to4 router, configure an egress filter (inbound on the internal-facing interface) to drop any outbound IPv6 packets from the internal network with a source address that is not within the 6to4 prefix 2002-V4ADDR--/48 where V4ADDR is the designated IPv4 6to4 address for the enclave."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|III,CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7,PCI-DSSv3.2|1.2.1,Rule-ID|SV-40539r1_rule,STIG-ID|NET-IPV6-066,Vuln-ID|V-30736"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IPV6_EGRESS_ACL@ replaced with "9" in field "context".
  context     : "ipv6 access-list 9"
# Note: Variable @V4ADDR@ replaced with "C612:1" in field "item".
  item        : "permit ipv6 2002:C612:1::/48 any"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-MCAST-001 - PIM enabled on wrong interfaces -'ip multicast-routing'"
  info        : "The administrator must ensure that Protocol Independent Multicast (PIM) is disabled on all interfaces that are not required to support multicast routing.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective' -that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.' Hence, it is imperative that the network has documented their multicast topology and thereby knows which interfaces are enabled for multicast. Once, this is done, the zones can be scoped as required."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM is documented in the network's multicast topology diagram. Enable PIM only on the applicable interfaces according to the multicast topology diagram."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-40312r1_rule,STIG-ID|NET-MCAST-001,SWIFT-CSCv1|2.3,Vuln-ID|V-30577"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ip multicast-routing"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-MCAST-001 - PIM enabled on wrong interfaces -'ipv6 multicast-routing'"
  info        : "The administrator must ensure that Protocol Independent Multicast (PIM) is disabled on all interfaces that are not required to support multicast routing.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective' -that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.' Hence, it is imperative that the network has documented their multicast topology and thereby knows which interfaces are enabled for multicast. Once, this is done, the zones can be scoped as required."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM is documented in the network's multicast topology diagram. Enable PIM only on the applicable interfaces according to the multicast topology diagram."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-40312r1_rule,STIG-ID|NET-MCAST-001,SWIFT-CSCv1|2.3,Vuln-ID|V-30577"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "ipv6 multicast-routing"
</item>

<report type:"WARNING">
  description : "NET-MCAST-001 - PIM enabled on wrong interfaces -'interfaces enabled for PIM'"
  info        : "The administrator must ensure that Protocol Independent Multicast (PIM) is disabled on all interfaces that are not required to support multicast routing.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective' -that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.' Hence, it is imperative that the network has documented their multicast topology and thereby knows which interfaces are enabled for multicast. Once, this is done, the zones can be scoped as required.

 NOTE: This check requires manual verification that only the required interfaces are enabled for PIM as documented in the network topology diagram.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM is documented in the network's multicast topology diagram. Enable PIM only on the applicable interfaces according to the multicast topology diagram."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-40312r1_rule,STIG-ID|NET-MCAST-001,Vuln-ID|V-30577"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-002 - PIM neighbor filter is not configured - 'ip pim neighbor-filter IP_PIM_NEIGHBORS_ACL'"
  info        : "The administrator must ensure that a PIM neighbor filter is bound to all interfaces that have PIM enabled.

 Protocol Independent Multicast (PIM) is a routing protocol used to build multicast distribution tress for forwarding multicast traffic across the network infrastructure. PIM traffic must be limited to only known PIM neighbors by configuring and binding a PIM neighbor filter to those interfaces that have PIM enabled.

 NOTE: This check may need to be duplicated if there are multiple PIM enabled interfaces.
 NOTE: Change 'PIM_INTERFACE' to the IP interface with PIM enabled.
 NOTE: Change 'IP_PIM_NEIGHBORS_ACL' to the standard access-list used for filtering authorized PIM neighbors."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|2.2.4,Rule-ID|SV-40315r1_rule,STIG-ID|NET-MCAST-002,TBA-FIISB|31.3,Vuln-ID|V-30578"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @PIM_INTERFACE@ replaced with "FastEther0/3" in field "context".
  context     : "interface FastEther0/3"
# Note: Variable @IP_PIM_NEIGHBORS_ACL@ replaced with "IP_PIM_NEIGHBORS" in field "item".
  item        : "ip pim neighbor-filter IP_PIM_NEIGHBORS"
</item>

<report type:"WARNING">
  description : "NET-MCAST-002 - PIM neighbor filter is not configured - 'ip access-list standard IP_PIM_NEIGHBORS_ACL'"
  info        : "The administrator must ensure that a PIM neighbor filter is bound to all interfaces that have PIM enabled.

 Protocol Independent Multicast (PIM) is a routing protocol used to build multicast distribution tress for forwarding multicast traffic across the network infrastructure. PIM traffic must be limited to only known PIM neighbors by configuring and binding a PIM neighbor filter to those interfaces that have PIM enabled.

 NOTE: This check requires manual verification to ensure all allowable PIM neighbors are entered into the appropriate standard IP access-list.
 NOTE: Nessus has not identified that the chosen audit applies to the target device."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-40315r1_rule,STIG-ID|NET-MCAST-002,Vuln-ID|V-30578"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-002 - PIM neighbor filter is not configured - 'ipv6 pim neighbor-filter list IPV6_PIM_NEIGHBORS_ACL'"
  info        : "The administrator must ensure that a PIM neighbor filter is bound to all interfaces that have PIM enabled.

 Protocol Independent Multicast (PIM) is a routing protocol used to build multicast distribution tress for forwarding multicast traffic across the network infrastructure. PIM traffic must be limited to only known PIM neighbors by configuring and binding a PIM neighbor filter to those interfaces that have PIM enabled.

 NOTE: Change 'IPV6_PIM_NEIGHBORS_ACL' to the IPv6 access-list used for filtering authorized PIM neighbors."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram."
  reference   : "800-171|3.13.1,800-53|SC-7(11),8500.2|ECSC-1,CAT|II,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(11),NIAv2|GS7c,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|2.2.4,Rule-ID|SV-40315r1_rule,STIG-ID|NET-MCAST-002,TBA-FIISB|31.3,Vuln-ID|V-30578"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @IPV6_PIM_NEIGHBORS_ACL@ replaced with "IPV6_PIM_NEIGHBORS" in field "item".
  item        : "ipv6 pim neighbor-filter list IPV6_PIM_NEIGHBORS"
</item>

<report type:"WARNING">
  description : "NET-MCAST-002 - PIM neighbor filter is not configured - 'ipv6 access-list IPV6_PIM_NEIGHBORS_ACL'"
  info        : "The administrator must ensure that a PIM neighbor filter is bound to all interfaces that have PIM enabled.

 Protocol Independent Multicast (PIM) is a routing protocol used to build multicast distribution tress for forwarding multicast traffic across the network infrastructure. PIM traffic must be limited to only known PIM neighbors by configuring and binding a PIM neighbor filter to those interfaces that have PIM enabled.

 NOTE: This check requires manual verification to ensure all allowable PIM neighbors are entered into the appropriate IPv6 access-list.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "If IPv4 or IPv6 multicast routing is enabled, ensure that all interfaces enabled for PIM has a neighbor filter to only accept PIM control plane traffic from the documented routers according to the multicast topology diagram."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-40315r1_rule,STIG-ID|NET-MCAST-002,Vuln-ID|V-30578"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-010 - No Admin-local or Site-local boundary - 'ip multicast boundary'"
  info        : "The administrator must ensure that multicast routers are configured to establish boundaries for Admin-local or Site-local scope multicast traffic.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective'-that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.

 Administrative scoped multicast addresses are locally assigned and are to be used exclusively by the enterprise network or enclave. Hence, administrative scoped multicast traffic must not cross the perimeter of the enclave in either direction. Admin-local scope could be used to contain multicast traffic to a portion of an enclave or within a site. This can make it more difficult for a malicious user to access sensitive traffic if the traffic is restricted to links that the user does not have access to. Admin-local scope is encouraged for any multicast traffic within a network that is intended for network management as well as control plane traffic that must reach beyond link-local destinations.

 NOTE: Change 'PIM_INTERFACE' to the multicase boundary interface for your organization.
 NOTE: Change 'MCAST_ADMIN_SCOPED_BOUNDARY' to the filter used to effect multicast traffic outside of the administratively scoped IPv4 multicast space."
  solution    : "Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The scope of IPv6 multicast packets are determined by the scope value where 4 is Admin-local and 5 is Site-local. Configure the necessary boundary to ensure packets addressed to these administratively scoped multicast addresses do not cross the applicable administrative boundaries."
  reference   : "800-171|3.13.1,800-53|SC-7(16),8500.2|ECSC-1,CAT|III,CSF|PR.PT-4,ITSG-33|SC-7(16),NIAv2|GS8d,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-21169r1_rule,STIG-ID|NET-MCAST-010,Vuln-ID|V-19189"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @PIM_INTERFACE@ replaced with "FastEther0/3" in field "context".
  context     : "interface FastEther0/3"
# Note: Variable @MCAST_ADMIN_SCOPED_BOUNDARY@ replaced with "MCAST_ADMIN_SCOPED_BOUNDARY" in field "item".
  item        : "ip multicast boundary MCAST_ADMIN_SCOPED_BOUNDARY"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-010 - No Admin-local or Site-local boundary - ip access-list standard - 'deny 239'"
  info        : "The administrator must ensure that multicast routers are configured to establish boundaries for Admin-local or Site-local scope multicast traffic.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective'-that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.

 Administrative scoped multicast addresses are locally assigned and are to be used exclusively by the enterprise network or enclave. Hence, administrative scoped multicast traffic must not cross the perimeter of the enclave in either direction. Admin-local scope could be used to contain multicast traffic to a portion of an enclave or within a site. This can make it more difficult for a malicious user to access sensitive traffic if the traffic is restricted to links that the user does not have access to. Admin-local scope is encouraged for any multicast traffic within a network that is intended for network management as well as control plane traffic that must reach beyond link-local destinations.

 NOTE: Change 'MCAST_ADMIN_SCOPED_BOUNDARY' to the filter used to effect multicast traffic outside of the administratively scoped IPv4 multicast space."
  solution    : "Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The scope of IPv6 multicast packets are determined by the scope value where 4 is Admin-local and 5 is Site-local. Configure the necessary boundary to ensure packets addressed to these administratively scoped multicast addresses do not cross the applicable administrative boundaries."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|III,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,PCI-DSSv3.2|1.2.1,Rule-ID|SV-21169r1_rule,STIG-ID|NET-MCAST-010,Vuln-ID|V-19189"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MCAST_ADMIN_SCOPED_BOUNDARY@ replaced with "MCAST_ADMIN_SCOPED_BOUNDARY" in field "context".
  context     : "ip access-list standard MCAST_ADMIN_SCOPED_BOUNDARY"
  item        : "deny 239\.255\.0\.0 0\.255\.255\.255"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-010 - No Admin-local or Site-local boundary - ip access-list standard - 'permit 224'"
  info        : "The administrator must ensure that multicast routers are configured to establish boundaries for Admin-local or Site-local scope multicast traffic.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective'-that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.

 Administrative scoped multicast addresses are locally assigned and are to be used exclusively by the enterprise network or enclave. Hence, administrative scoped multicast traffic must not cross the perimeter of the enclave in either direction. Admin-local scope could be used to contain multicast traffic to a portion of an enclave or within a site. This can make it more difficult for a malicious user to access sensitive traffic if the traffic is restricted to links that the user does not have access to. Admin-local scope is encouraged for any multicast traffic within a network that is intended for network management as well as control plane traffic that must reach beyond link-local destinations.

 NOTE: Change 'MCAST_ADMIN_SCOPED_BOUNDARY' to the filter used to effect multicast traffic outside of the administratively scoped IPv4 multicast space."
  solution    : "Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The scope of IPv6 multicast packets are determined by the scope value where 4 is Admin-local and 5 is Site-local. Configure the necessary boundary to ensure packets addressed to these administratively scoped multicast addresses do not cross the applicable administrative boundaries."
  reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|III,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,PCI-DSSv3.2|1.2.1,Rule-ID|SV-21169r1_rule,STIG-ID|NET-MCAST-010,Vuln-ID|V-19189"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @MCAST_ADMIN_SCOPED_BOUNDARY@ replaced with "MCAST_ADMIN_SCOPED_BOUNDARY" in field "context".
  context     : "ip access-list standard MCAST_ADMIN_SCOPED_BOUNDARY"
  item        : "permit 224\.0\.0\.0 15\.255\.255\.255"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-MCAST-010 - No Admin-local or Site-local boundary - 'ipv6 multicast boundary scope 5'"
  info        : "The administrator must ensure that multicast routers are configured to establish boundaries for Admin-local or Site-local scope multicast traffic.

 A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be 'convex from a routing perspective'-that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. As stated in the DoD IPv6 IA Guidance for MO3, 'One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces.

 Administrative scoped multicast addresses are locally assigned and are to be used exclusively by the enterprise network or enclave. Hence, administrative scoped multicast traffic must not cross the perimeter of the enclave in either direction. Admin-local scope could be used to contain multicast traffic to a portion of an enclave or within a site. This can make it more difficult for a malicious user to access sensitive traffic if the traffic is restricted to links that the user does not have access to. Admin-local scope is encouraged for any multicast traffic within a network that is intended for network management as well as control plane traffic that must reach beyond link-local destinations.

 NOTE: Change 'PIM_INTERFACE' to the multicase boundary interface for your organization."
  solution    : "Local Scope range is 239.255.0.0/16 and can expand into the reserved ranges 239.254.0.0/16 and 239.253.0.0/16 if 239.255.0.0/16 is exhausted. The scope of IPv6 multicast packets are determined by the scope value where 4 is Admin-local and 5 is Site-local. Configure the necessary boundary to ensure packets addressed to these administratively scoped multicast addresses do not cross the applicable administrative boundaries."
  reference   : "800-171|3.13.1,800-53|SC-7(16),8500.2|ECSC-1,CAT|III,CSF|PR.PT-4,ITSG-33|SC-7(16),NIAv2|GS8d,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,Rule-ID|SV-21169r1_rule,STIG-ID|NET-MCAST-010,Vuln-ID|V-19189"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
# Note: Variable @PIM_INTERFACE@ replaced with "FastEther0/3" in field "context".
  context     : "interface FastEther0/3"
  item        : "ipv6 multicast boundary scope 5"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-009 - The switch must be configured to use 802.1x authentication on host facing access switch ports. 'radius-server host'"
  info        : "The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports. The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN. Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected. After authentication is successful, normal traffic can pass through the port. Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection."
  solution    : "Configure 802.1 x authentication on all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. Configure MAB on those switch ports connected to devices that do not support an 802.1x supplicant."
  reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|8.1,Rule-ID|SV-42190r5_rule,STIG-ID|NET-NAC-009,TBA-FIISB|27.1,Vuln-ID|V-5626"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "radius-server host ([^ ]+)"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-009 - The switch must be configured to use 802.1x authentication on host facing access switch ports. 'aaa new-model'"
  info        : "The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports. The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN. Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected. After authentication is successful, normal traffic can pass through the port. Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection."
  solution    : "Configure 802.1 x authentication on all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. Configure MAB on those switch ports connected to devices that do not support an 802.1x supplicant."
  reference   : "800-171|3.1.1,800-171|3.3.1,800-171|3.3.2,800-171|3.5.1,800-53|AC-3,800-53|AU-2,800-53|IA-2,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.10.2(c),CN-L3|8.1.4.1(a),CN-L3|8.1.4.11(b),CN-L3|8.1.4.2(a),CN-L3|8.1.4.2(f),CN-L3|8.1.4.3(a),CN-L3|8.5.3.1,CN-L3|8.5.4.1(a),CSF|PR.AC-1,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ISO/IEC-27001|A.9.4.5,ITSG-33|AC-3,ITSG-33|AU-2,ITSG-33|IA-2,NESA|M1.2.2,NESA|M5.5.1,NESA|T2.3.8,NESA|T4.2.1,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM11a,NIAv2|AM11b,NIAv2|AM11c,NIAv2|AM11d,NIAv2|AM11e,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM3,NIAv2|AM7,NIAv2|AM8,NIAv2|SS29,NIAv2|SS30,NIAv2|VL8,PCI-DSSv3.2|8.1,Rule-ID|SV-42190r5_rule,STIG-ID|NET-NAC-009,SWIFT-CSCv1|6.4,TBA-FIISB|31.1,TBA-FIISB|35.1,TBA-FIISB|36.1,Vuln-ID|V-5626"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "aaa new-model"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-009 - The switch must be configured to use 802.1x authentication on host facing access switch ports. 'aaa authentication'"
  info        : "The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports. The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN. Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected. After authentication is successful, normal traffic can pass through the port. Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection."
  solution    : "Configure 802.1 x authentication on all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. Configure MAB on those switch ports connected to devices that do not support an 802.1x supplicant."
  reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|8.1,Rule-ID|SV-42190r5_rule,STIG-ID|NET-NAC-009,TBA-FIISB|27.1,Vuln-ID|V-5626"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "aaa authentication dot1x default group radius"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-009 - The switch must be configured to use 802.1x authentication on host facing access switch ports. 'system-auth-control'"
  info        : "The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports. The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN. Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected. After authentication is successful, normal traffic can pass through the port. Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection."
  solution    : "Configure 802.1 x authentication on all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. Configure MAB on those switch ports connected to devices that do not support an 802.1x supplicant."
  reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,PCI-DSSv3.2|2.2.4,Rule-ID|SV-42190r5_rule,STIG-ID|NET-NAC-009,TBA-FIISB|27.1,Vuln-ID|V-5626"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "dot1x system-auth-control"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-009 - The switch must be configured to use 802.1x authentication on host facing access switch ports. '802.1x authentication'"
  info        : "The IEEE 802.1x standard is a client-server based access control and authentication protocol that restricts unauthorized clients from connecting to a local area network through host facing switch ports. The authentication server authenticates each client connected to to a switch port before making any services available to the client from the LAN. Unless the client is successfully authenticated, 802.1x access control allows only Extensible Authentication Protocol over LAN (EAPOL) traffic through the port to which the client is connected. After authentication is successful, normal traffic can pass through the port. Without the use of 802.1x, a malicious user could use the switch port to connect an unauthorized piece of computer or other network device to inject or steal data from the network without detection.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "Configure 802.1 x authentication on all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. Configure MAB on those switch ports connected to devices that do not support an 802.1x supplicant."
  reference   : "800-53|IA-3,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-42190r5_rule,STIG-ID|NET-NAC-009,TBA-FIISB|27.1,Vuln-ID|V-5626"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface .+"
  item        : "(switchport mode|dot1x).*"
  severity    : MEDIUM
</item>

<report type:"WARNING">
  description : "NET-NAC-031"
  info        : "The switch must only allow a maximum of one registered MAC address per access port.

 Limiting the number of registered MAC addresses on a switch access port can help prevent a CAM table overflow attack. This type of attack lets an attacker exploit the hardware and memory limitations of a switch.  If there are enough entries stored in a CAM table before the expiration of other entries, no new entries can be accepted into the CAM table. An attacker will able to flood the switch with mostly invalid MAC addresses until the CAM table's resources have been depleted. When there are no more resources, the switch has no choice but to flood all ports within the VLAN with all incoming traffic. This happens because the switch cannot find the switch port number for a corresponding MAC address within the CAM table, allowing the switch to become a hub and traffic to be monitored.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that all non-managed authentication ports only allow one MAC address for non VOIP/VTC implementations. Some organizations may employ a green initiative where a single LAN drop is shared among several devices and is called 'hot-desking', which is related to conservation of office space and teleworking. Hot-desking is where several people are assigned to work at the same desk at different times, each user with their own PC. In this case, a different MAC address needs to be permitted for each PC that is connecting to the LAN drop in the workspace.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configuring port-security on the Cisco switch access port interface will automatically set the maximum number of registered MAC addresses to one. The value will not show up in the configuration of the switch itself. You must run the command 'Switch# show port-security interface' where interface is the specific switchport of interest."
  reference   : "8500.2|DCSP-1,CAT|II,Rule-ID|SV-49133r1_rule,STIG-ID|NET-NAC-031,Vuln-ID|V-18566"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-NAC-032 - Switchport does not shutdown on a violation"
  info        : "The IAO will ensure that all switchports configured using MAC port security will shutdown upon receiving a frame with a different layer 2 source address than what has been configured or learned for port security.

 The Port Security feature remembers the Ethernet MAC address connected to the switch port and allows only that MAC address to communicate on that port. If any other MAC address tries to communicate through the port, port security will disable the port.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored."
  solution    : "Configure the port to shutdown when insecure hosts are connected to the wall jack."
  reference   : "800-53|SI-4(7),8500.2|DCSP-1,CAT|III,CSF|DE.CM-1,CSF|DE.CM-6,CSF|DE.CM-7,CSF|DE.DP-2,CSF|ID.RA-1,CSF|PR.IP-8,CSF|RS.AN-1,ITSG-33|SI-4(7),PCI-DSSv3.2|2.2.4,Rule-ID|SV-20109r1_rule,STIG-ID|NET-NAC-032,TBA-FIISB|49.3.3,Vuln-ID|V-18565"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface (.*[Ee]thernet)"
  item        : "switchport port-security violation shutdown"
</item>

<report type:"WARNING">
  description : "NET-SRVFRM-003 - ACLs must restrict access to server VLANs"
  info        : "Server VLAN interfaces must be protected by restrictive ACLs using a deny-by-default security posture.

 Protecting data sitting in a server VLAN is necessary and can be accomplished using access control lists on VLANs provisioned for servers.  Without proper access control of traffic entering or leaving the server VLAN, potential threats such as a denial of service, data corruption, or theft could occur, resulting in the inability to complete mission requirements by authorized users.

 NOTE: This check requires manual verification as to whether or not server VLANS have ACLs defined with a deny-by-default security posture assigned to the appropriate interface(s) if applicable.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure an ACL to protect the server VLAN interface.  The ACL must be in a deny-by-default security posture."
  reference   : "8500.2|ECND-1,8500.2|ECSC-1,CAT|II,Rule-ID|SV-20061r3_rule,STIG-ID|NET-SRVFRM-003,Vuln-ID|V-18522"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-SRVFRM-004 - ACLs do not protect against compromised servers"
  info        : "The IAO will ensure the Server Farm infrastructure is secured by ACLs on VLAN interfaces that restrict data originating from one server farm segment destined to another server farm segment.

 ACLs on VLAN interfaces do not protect against compromised servers. The Server farm vlans need to protect the servers located on one subnet from servers located on another subnet. Protecting a client's data from other clients is necessary and can be accomplished using VLAN provisioning, layer 3 filtering and content filtering at the Server Farm entry point. Restricting protocol, source and destination traffic via filters is an option; however additional security practices such as content filtering are required. The Server farm private vlans need to protect the servers located on one subnet from servers located on another subnet.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires a review of the firewall protecting the server farm. Vlan configurations should have a filter that secures the servers located on the vlan segment.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Review the filter and ensure access from other server segments is denied unless necessary for application operation. The intent of the policy should be to protect servers from a server that has been compromised by an intruder."
  reference   : "8500.2|ECND-1,CAT|II,Rule-ID|SV-20062r1_rule,STIG-ID|NET-SRVFRM-004,Vuln-ID|V-18523"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-TUNL-012 - Tunnel Default Router Configured"
  info        : "Default routes must not be directed to the tunnel entry point.

Routing in the network containing the tunnel entry point must be configured to direct the intended traffic into the tunnel. Depending on the router products used this may be done by creating routes to a tunnel by name, by address, or by interface.

If multiple tunnels are defined or IPv6 interfaces, you must be selective with static routes, policy based routing, or even let the interior gateway protocol (IGP) make the decision since a ipv4 or ipv6 address has been configured on the tunnel. The key is the administrator should carefully plan and configure or let the IGP determine what goes into each tunnel.

 NOTE: This check requires manual verification to identify the tunnel endpoints, then review all routing devices to ensure the tunnel entry point is not used as a default route.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  info        : "http://www.cisco.com/c/en/us/td/docs/ios/12_2/qos/configuration/guide/fqos_c/qcfpbr.html"
  solution    : "The SA must carefully plan and configure or let IGP determine what goes into each tunnel."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-20504r2_rule,STIG-ID|NET-TUNL-012,Vuln-ID|V-18790"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-TUNL-017 - ISATAP tunnels must terminate at interior router"
  info        : "ISATAP tunnels must terminate at an interior router.

 ISATAP is an automatic tunnel mechanism that does not provide authentication such as IPSec. As a result of this limitation, ISATAP is thought of as a tool that is used inside the enclave among trusted hosts, which would limit it to internal attacks. ISATAP is a service versus a product, and is readily available to most users. If a user knows the ISATAP router IP address, they can essentially get onto the IPv6 intranet. To control the vulnerability of this tunnel mechanism, it is critical to control the use of protocol 41 and use IPv4 filters to control what IPv4 nodes can send protocol 41 packets to an ISATAP router interface. Although the ISATAP tunneling mechanism is similar to other automatic tunneling mechanisms, such as IPv6 6to4 tunneling, ISATAP is designed for transporting IPv6 packets between sites within an enclave, not between enclaves.

 NOTE: This check requires manual verification that the ISATAP tunnel is terminate at the Intra Enclave Security Zone.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Terminate ISATAP tunnels at the infrastructure router to prohibit tunneled traffic from exiting the enclave perimeter prior to inspection by the IDS, IPS, or firewall."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-16068r2_rule,STIG-ID|NET-TUNL-017,Vuln-ID|V-15288"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-TUNL-034 - L2TPv3 sessions are not authenticated - encapsulation check"
  info        : "The administrator must ensure the that all L2TPv3 sessions are authenticated prior to transporting traffic.

 L2TPv3 sessions can be used to transport layer-2 protocols across an IP backbone. These protocols were intended for link-local scope only and are therefore less defended and not as well-known. As stated in DoD IPv6 IA Guidance for MO3 (S4-C7-1), the L2TP tunnels can also carry IP packets that are very difficult to filter because of the additional encapsulation. Hence, it is imperative that L2TP sessions are authenticated prior to transporting traffic.

 Review the router or multi-layer switch configuration and determine if L2TPv3 has been configured to provide transport across an IP network. If it has been configured, verify that the L2TPv3 session requires authentication."
  solution    : "Configure L2TPv3 to use authentication for any peering sessions."
  reference   : "800-171|3.13.8,800-53|SC-8(1),8500.2|ECSC-1,CAT|II,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|2.2.5,Rule-ID|SV-40556r1_rule,STIG-ID|NET-TUNL-034,SWIFT-CSCv1|2.1,TBA-FIISB|29.1,Vuln-ID|V-30744"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  item        : "encapsulation l2tpv3"
</item>

<item>
  type        : CONFIG_CHECK
  description : "NET-TUNL-034 - L2TPv3 sessions are not authenticated - authentication check"
  info        : "The administrator must ensure the that all L2TPv3 sessions are authenticated prior to transporting traffic.

 L2TPv3 sessions can be used to transport layer-2 protocols across an IP backbone. These protocols were intended for link-local scope only and are therefore less defended and not as well-known. As stated in DoD IPv6 IA Guidance for MO3 (S4-C7-1), the L2TP tunnels can also carry IP packets that are very difficult to filter because of the additional encapsulation. Hence, it is imperative that L2TP sessions are authenticated prior to transporting traffic.

 Review the router or multi-layer switch configuration and determine if L2TPv3 has been configured to provide transport across an IP network. If it has been configured, verify that the L2TPv3 session requires authentication."
  solution    : "Configure L2TPv3 to use authentication for any peering sessions."
  reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-40556r1_rule,STIG-ID|NET-TUNL-034,SWIFT-CSCv1|2.3,Vuln-ID|V-30744"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "l2tp-class ([^ ]+)"
  item        : "authentication"
</item>

<report type:"WARNING">
  description : "NET-VLAN-002 - Disabled ports are not kept in an unused VLAN."
  info        : "The IAO/NSO will ensure disabled ports are placed in an unused VLAN (do not use VLAN1).

 It is possible that a disabled port that is assigned to a user or management VLAN becomes enabled by accident or by an attacker and as a result gains access to that VLAN as a member.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that all ports not in use are assigned to the unused VLAN ID specific to your organization.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Assign all disabled ports to an unused VLAN. Do not use VLAN1."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-3973r2_rule,STIG-ID|NET-VLAN-002,Vuln-ID|V-3973"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<item>
  type        : CONFIG_CHECK
  description : "NET-VLAN-004 - VLAN 1 is being used as a user VLAN - 'no ip address'."
  info        : "The IAO/NSO will ensure VLAN1 is not used for user VLANs.

 In a VLAN-based network, switches use VLAN1 as the default VLAN for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)-all untagged traffic. As a consequence, VLAN 1 may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored."
  solution    : "Best practices for VLAN-based networks is to prune unnecessary ports from gaining access to VLAN1 as well as the management VLAN, and to separate in-band management, device protocol, and data traffic."
  reference   : "800-53|SC-3(2),8500.2|DCCS-1,CAT|II,ITSG-33|SC-3(2),PCI-DSSv3.2|2.2.4,Rule-ID|SV-3971r2_rule,STIG-ID|NET-VLAN-004,SWIFT-CSCv1|2.3,Vuln-ID|V-3971"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface VLAN1$"
  item        : "no ip address"
</item>

<item>
  type        : CONFIG_CHECK_NOT
  description : "NET-VLAN-004 - VLAN 1 is being used as a user VLAN - 'shutdown'."
  info        : "The IAO/NSO will ensure VLAN1 is not used for user VLANs.

 In a VLAN-based network, switches use VLAN1 as the default VLAN for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)-all untagged traffic. As a consequence, VLAN 1 may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored."
  solution    : "Best practices for VLAN-based networks is to prune unnecessary ports from gaining access to VLAN1 as well as the management VLAN, and to separate in-band management, device protocol, and data traffic."
  reference   : "800-171|3.1.3,800-53|AC-4(21),8500.2|DCCS-1,CAT|II,CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-5,CSF|PR.PT-4,NIAv2|NS10,NIAv2|NS11,PCI-DSSv3.2|2.2.3,PCI-DSSv3.2|2.2.4,Rule-ID|SV-3971r2_rule,STIG-ID|NET-VLAN-004,Vuln-ID|V-3971"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
  context     : "interface VLAN1$"
  item        : "no shutdown"
</item>

<report type:"WARNING">
  description : "NET-VLAN-005 - VLAN 1 traffic traverses across unnecessary trunk"
  info        : "The IAO/NSO will ensure VLAN1 is pruned from all trunk and access ports that do not require it.

 VLAN 1 is a special VLAN that tags and handles most of the control plane traffic such as Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)all VLAN 1 tagged traffic. VLAN 1 is enabled on all trunks and ports by default. With larger campus networks, care needs to be taken about the diameter of the VLAN 1 STP domain; instability in one part of the network could affect VLAN 1, thereby influencing control-plane stability and therefore STP stability for all other VLANs.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification to review the switch configuration and note any ports assigned to VLAN1. A show vlan command can also be used to verify what ports are assigned to VLAN1.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Best practice for VLAN-based networks is to prune unnecessary ports from gaining access to VLAN1 and insure that it does not traverse trunks not requiring VLAN1 traffic."
  reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-3972r2_rule,STIG-ID|NET-VLAN-005,Vuln-ID|V-3972"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-006 - The VLAN1 is being used for management traffic."
  info        : "The IAO/NSO will ensure VLAN1 is not used for in-band management traffic. A dedicated management VLAN or VLANs will be defined to keep management traffic separate from user data and control plane traffic.

 All ports, including the internal sc0 interface, are configured by default to be members of VLAN 1. In a VLAN-based network, switches use VLAN1 as the default VLAN for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Cisco Discovery Protocol (CDP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)all untagged traffic. As a consequence, VLAN 1 may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification. If switch clustering is used, review the configuration of the VLAN command switch and look for the command cluster management-vlan. The new management VLAN ID follows this command.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance.

 For unclustered switches, review the configuration of each switch. All ports, including the internal management interface (sc0), are configured by default to be members of VLAN 1. The management VLAN can be identified by its switch virtual interface (SVI) defined that contains the IP address for the internal management interface."
  solution    : "Best practices for VLAN-based networks is create a dedicated management VLAN, prune unnecessary ports from gaining access to VLAN1 as well as the management VLAN, and to separate in-band management, device protocol, and data traffic."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-5628r2_rule,STIG-ID|NET-VLAN-006,Vuln-ID|V-5628"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-007 - Ensure trunking is disabled on all access ports."
  info        : "The IAO/NSO will ensure trunking is disabled on all access ports (do not configure trunk on, desirable, non-negotiate, or auto-only off).

 Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victims MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attackers VLAN ID (probably the well known and omnipresent VLAN1) is stripped off by the switch, and the inner tag that will have the victims VLAN ID is used by the switch as the next hop and sent out the trunk port.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that trunking is disabled on all access ports.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Disable trunking on all access ports."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-5623r2_rule,STIG-ID|NET-VLAN-007,Vuln-ID|V-5623"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-008 - A dedicated VLAN is required for all trunk ports."
  info        : "The IAS/NSO will ensure that the native VLAN is assigned to a VLAN ID other than the default VLAN for all 802.1q trunk links.

 VLAN hopping can be initiated by an attacker who has access to a switch port belonging to the same VLAN as the native VLAN of the trunk link connecting to another switch in which the victim is connected to. If the attacker knows the victim's MAC address, it can forge a frame with two 802.1q tags and a layer 2 header with the destination address of the victim. Since the frame will ingress the switch from a port belonging to its native VLAN, the trunk port connecting to victim's switch will simply remove the outer tag because native VLAN traffic is to be untagged. The switch will forward the frame unto the trunk link unaware of the inner tag with a VLAN ID for which the victim's switchport is a member of.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that a native trunk VLAN is assigned to all trunk ports.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "To ensure the integrity of the trunk link and prevent unauthorized access, the native VLAN of the trunk port should be changed from the default VLAN1 to its own unique VLAN. The native VLAN must be the same on both ends of the trunk link; otherwise traffic could accidently leak between broadcast domains."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-5622r2_rule,STIG-ID|NET-VLAN-008,Vuln-ID|V-5622"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-009 - Access switchports are assigned to the native VLAN"
  info        : "The IAO/NSO will ensure access switchports are not assigned to the native VLAN.

 Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victim's MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attacker's VLAN ID (probably the well known and omnipresent VLAN1) is stripped off by the switch, and the inner tag that will have the victim's VLAN ID is used by the switch as the next hop and sent out the trunk port.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification that all access ports are not assigned to a native VLAN.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "To insure the integrity of the trunk link and prevent unauthorized access, the native VLAN of the trunk port should be changed from the default VLAN1 to its own unique VLAN. Access switchports must never be assigned to the native VLAN."
  reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-3984r2_rule,STIG-ID|NET-VLAN-009,Vuln-ID|V-3984"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-023 - Restricted VLAN not assigned to non-802.1x device."
  info        : "Printers must be assigned to a VLAN that is not shared by unlike devices.

 Aspects of hardening the network wall plate may include traffic filtering or restrictions on connectivity to enforce a device-, community of interest-, or user-specific security policy. For example, if a printer were plugged into a switch port, it would be prudent to ensure that only printer traffic is allowed on that switch port. If the printer is unplugged and a substitute device other than a printer is plugged into that switch port, the substitute device should not be able to communicate arbitrarily with other devices because only printer traffic is allowed on that switch port.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification to review the device configuration to determine if a VLAN has been established for printers.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Create a VLAN on the device for print type devices and assign printers to the VLAN ID."
  reference   : "8500.2|DCSP-1,CAT|III,Rule-ID|SV-20088r2_rule,STIG-ID|NET-VLAN-023,Vuln-ID|V-18544"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

<report type:"WARNING">
  description : "NET-VLAN-024 - Restricted VLAN not assigned to non-802.1x device."
  info        : "The SA will ensure a packet filter is implemented to filter the enclave traffic to and from printer VLANs to allow only print traffic.

 A firewall rule set can filter network traffic within the printer VLAN to only expected printer protocols. The SA managing the local enclave should identify the printer port traffic within the enclave. Ports commonly used by printers are typically tcp port 515, 631, 1782 and tcp ports 9100, 9101, 9102 but others are used throughout the industry. The SA can review RFC 1700 Port Assignments and review printer vendor documents for the filter rule-set.

 NOTE: This check is derived from the L3 switch guidance, if the scan target is a router the check can be ignored.
 NOTE: This check requires manual verification to determine if a printer VLAN is present. An ACL or firewall rule set can filter network traffic within the printer VLAN to only expected printer protocols. The SA managing the local enclave should identify the printer port traffic within the enclave.
 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Define the filter on the VLAN ACL or build a firewall ruleset to accomplish the requirment."
  reference   : "8500.2|ECND-2,CAT|II,Rule-ID|SV-20089r2_rule,STIG-ID|NET-VLAN-024,Vuln-ID|V-18545"
  see_also    : "https://iasecontent.disa.mil/stigs/zip/U_Network_Infrastructure_Router_L3_Switch_V8R29_STIG.zip"
</report>

</check_type>
