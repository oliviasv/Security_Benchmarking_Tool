#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.23 $
# $Date: 2020/04/08 $
#
# Description	: This .audit file is written again the Center for Internet Security Configuration Benchmark For AIX 7.1 v1.1.0.
#
# 		https://workbench.cisecurity.org/files/528
#
# NOTE		: Some queries in this .audit require site-specific data to be known to the query in order to function properly.
# 		Please note the following queries and edit their values accordingly.
#
# 		4.11.20 - Account running scan must be able to su to root to access root's PATH.
# 		4.12.19 - Account running scan must be able to su to root to access root's PATH.
#
#<ui_metadata>
#<display_name>CIS IBM AIX 7.1 L2 v1.1.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>IBM AIX 7.1 L2</name>
#  <version>1.1.0</version>
#  <link>https://workbench.cisecurity.org/files/528</link>
#</spec>
#<labels>unix,cis,aix,aix_7.1</labels>
#<variables>
#  <variable>
#    <name>SYSLOG_SERVER_IP_ADDRESS</name>
#    <default>192.168.1.1</default>
#    <description>Primary syslog server IP address</description>
#    <info>For improved checks, the syslog check is compared against a specific syslog server in the environment.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      system        : "AIX"
      type          : CMD_EXEC
      description   : "AIX Version 7, Release 1 or greater, found"
      cmd           : "/usr/bin/uname -svr"
      expect        : "^AIX [1-9][0-9]* 7[\\s]*$"
      dont_echo_cmd : YES
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS AIX 7.1 Benchmark v1.1.0 Level 2"
      info        : "https://workbench.cisecurity.org/files/528

This audit checks the testable level 2 guidance in the CIS IBM AIX 7.1 Benchmark document.

Level-II Benchmark recommendations exhibit one or more of the following characteristics:
 o are intended for environments or use cases where security is paramount
 o acts as defense in depth measure
 o may negatively inhibit the utility or performance of the technology

NOTE : Please read the .audit header before running a compliance scan. Please review the header notes as some queries may not behave as anticipated due to unique environmental variables that may be present on your system(s).
Thank you.
Tenable Network Security, Inc."
    </report>

##
## 3.1 - AIX Security Expert - Password Policy
##
##
## 3.2 - AIX Security Expert - Login Policy
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.1 system account lockdown - daemon login"
      info        : "This change disables direct login access for the daemon user account.

This change disables direct local and remote login to the daemon user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the daemon user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable daemon user access-

 chuser login=false rlogin=false daemon"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login daemon"
      expect      : "^[\\s]*daemon[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.1 system account lockdown - daemon rlogin"
      info        : "This change disables direct login access for the daemon user account.

This change disables direct local and remote login to the daemon user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the daemon user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable daemon user access-

 chuser login=false rlogin=false daemon"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin daemon"
      expect      : "^[\\s]*daemon[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.2 system account lockdown - bin login"
      info        : "This change disables direct login access for the bin user account.

This change disables direct local and remote login to the bin user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the bin user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable bin user access-

 chuser login=false rlogin=false bin"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login bin"
      expect      : "^bin[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.2 system account lockdown - bin rlogin"
      info        : "This change disables direct login access for the bin user account.

This change disables direct local and remote login to the bin user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the bin user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable bin user access-

 chuser login=false rlogin=false bin"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin bin"
      expect      : "^bin[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.3 system account lockdown - sys login"
      info        : "This change disables direct login access for the sys user account.

This change disables direct local and remote login to the sys user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the sys user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable sys user access-

 chuser login=false rlogin=false sys"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login sys"
      expect      : "^sys[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.3 system account lockdown - sys rlogin"
      info        : "This change disables direct login access for the sys user account.

This change disables direct local and remote login to the sys user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the sys user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable sys user access-

 chuser login=false rlogin=false sys"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin sys"
      expect      : "^sys[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.4 system account lockdown - adm login"
      info        : "This change disables direct login access for the adm user account.

This change disables direct local and remote login to the adm user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the adm user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable admuser access-

 chuser login=false rlogin=false adm"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login adm"
      expect      : "^adm[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.4 system account lockdown - adm rlogin"
      info        : "This change disables direct login access for the adm user account.

This change disables direct local and remote login to the adm user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the adm user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable admuser access-

 chuser login=false rlogin=false adm"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin adm"
      expect      : "^adm[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.5 system account lockdown - nobody login"
      info        : "This change disables direct login access for the nobody user account.

This change disables direct local and remote login to the nobody user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the nobody user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable nobody user access-

 chuser login=false rlogin=false nobody"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login nobody"
      expect      : "^nobody[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.5 system account lockdown - nobody rlogin"
      info        : "This change disables direct login access for the nobody user account.

This change disables direct local and remote login to the nobody user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the nobody user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable nobody user access-

 chuser login=false rlogin=false nobody"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin nobody"
      expect      : "^nobody[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.6 system account lockdown - uucp login"
      info        : "This change disables direct login access for the uucp user account.

This change disables direct local and remote login to the uucp user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the uucp user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable uucp user access-

 chuser login=false rlogin=false uucp"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login uucp"
      expect      : "^uucp[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.6 system account lockdown - uucp rlogin"
      info        : "This change disables direct login access for the uucp user account.

This change disables direct local and remote login to the uucp user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the uucp user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable uucp user access-

 chuser login=false rlogin=false uucp"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin uucp"
      expect      : "^uucp[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.7 system account lockdown - lpd login"
      info        : "This change disables direct login access for the lpd user account.

This change disables direct local and remote login to the lpd user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the lpd user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable lpduser access-

 chuser login=false rlogin=false lpd"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a login lpd"
      expect      : "^lpd[\\s]+login[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.2.1.7 system account lockdown - lpd rlogin"
      info        : "This change disables direct login access for the lpd user account.

This change disables direct local and remote login to the lpd user account. It is recommended that a password is not set on this account to ensure that the only access is via su from the root account.

There should not be a requirement to log in as the lpd user directly. All users should be given unique logon ids to ensure traceability and accountability."
      solution    : "Change the login and remote login user flags to disable lpduser access-

 chuser login=false rlogin=false lpd"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsuser -a rlogin lpd"
      expect      : "^lpd[\\s]+rlogin[\\s]*=[\\s]*false[\\s]*$"
    </custom_item>

##
## 3.3 - AIX Security Expert - System Services Management
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.1 /etc/inittab - qdaemon"
      info        : "This is the printing scheduling daemon that manages the submission of print jobs to piobe.

If there is not a requirement to support local or remote printing, remove the qdaemon entry from/etc/inittab."
      solution    : "In /etc/inittab, remove the qdaemon entry-

 rmitab qdaemon"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*qdaemon:"
      expect      : "^[\\s]*qdaemon:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.2 /etc/inittab - lpd"
      info        : "The lpd daemon accepts remote print jobs from other systems.

If there is not a requirement for the system to act as a remote print server for other servers, remove the lpd entry."
      solution    : "In /etc/inittab, remove the lpd entry-

 rmitab lpd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*lpd:"
      expect      : "^[\\s]*lpd:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.3 /etc/inittab - piobe"
      info        : "The piobe daemon is the I/O back end for the printing process, handling the job scheduling and spooling.

If there is not a requirement for the system to support either local or remote printing, remove the piobe entry."
      solution    : "In /etc/inittab, remove the piobe entry-

 rmitab piobe"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*piobe:"
      expect      : "^[\\s]*piobe:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.4 /etc/inittab - dt"
      info        : "This entry executes the CDE startup script which starts the AIX Common Desktop Environment.

If there is not an lft connected to the system and there are no other X11 clients that require CDE, remove the dt entry."
      solution    : "In /etc/inittab, remove the dt entry-

 rmitab dt"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|2S,NIAv2|SS13a,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*dt:"
      expect      : "^[\\s]*dt:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.5 /etc/inittab - rcnfs"
      info        : "The rcnfs entry starts the NFS daemons during system boot.

NFS is a service with numerous historical vulnerabilities and should not be enabled unless there is no alternative. If NFS serving is required, then read-only exports are recommended and no filesystem or directory should be exported with root access. Unless otherwise required the NFS daemons will be disabled."
      solution    : "Use the rmitab command to remove the NFS start-up script from /etc/inittab-

 rmitab rcnfs"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*rcnfs:"
      expect      : "^[\\s]*rcnfs:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.6 /etc/rc.tcpip - sendmail"
      info        : "This entry starts the sendmail daemon on system startup. This means that the system can operate as a mail server.

sendmail is a service with many historical vulnerabilities and where possible should be disabled. If the system is not required to operate as a mail server i.e. sending, receiving or processing e-mail, comment out the sendmail entry."
      solution    : "In /etc/rc.tcpip, comment out the sendmail entry-

 chrctcp -d sendmail"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/lib/sendmail"
      expect      : "^[\\s]*start[\\s]+/usr/lib/sendmail"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.7 /etc/rc.tcpip - snmpd"
      info        : "This entry starts the snmpd daemon on system startup. This allows remote monitoring of network and server configuration.

The snmpd daemon is used by many 3rd party applications to monitor the health of the system. If snmpd is not required, it is recommended that it is disabled."
      solution    : "In /etc/rc.tcpip, comment out the snmpd entry-

 chrctcp -d snmpd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/snmpd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/snmpd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.8 /etc/rc.tcpip - dhcpcd"
      info        : "This entry starts the dhcpcd daemon on system startup. The dhcpcd deamon receives address and configuration information from the DHCP server.

The dhcpcd daemon is the DHCP client that receives address and configuration information from the DHCP server. This must be disabled if DHCP is not used to serve IP address to the local system."
      solution    : "In /etc/rc.tcpip, comment out the dhcpcd entry-

 chrctcp -d dhcpcd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/dhcpcd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/dhcpcd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.9 /etc/rc.tcpip - dhcprd"
      info        : "This entry starts the dhcprd daemon on system startup. The dhcprd daemon listens for broadcast packets, receives them, and forwards them to the appropriate server.

The dhcprd daemon is the DHCP relay deamon that forwards the DHCP and BOOTP packets in the network. You must disable this service if DHCP is not enabled in the network."
      solution    : "In /etc/rc.tcpip, comment out the dhcprd entry-

 chrctcp -d dhcprd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/dhcprd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/dhcprd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.10 /etc/rc.tcpip - dhcpsd"
      info        : "This entry starts the dhcpsd daemon on system startup. The dhcpsd deamon is the DHCP server that serves addresses and configuration information to DHCP clients in the network.

The dhcpsd daemon is the DHCP server that serves addresses and configuration information to DHCP clients in the network. You must disable this service if the server is not a DHCP server."
      solution    : "In /etc/rc.tcpip, comment out the dhcpsd entry-

 chrctcp -d dhcpsd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/dhcpsd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/dhcpsd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.11 /etc/rc.tcpip - autoconf6"
      info        : "This entry starts autoconf6 on system startup. This is to automatically configure IPv6 interfaces at boot time.

authoconf6 is used to automatically configure IPv6 interfaces at boot time. Running this service may allow other hosts on the same physical subnet to connect via IPv6, even when the network does not support it. You must disable this unless you utilize IPv6 on the server."
      solution    : "In /etc/rc.tcpip, comment out the autoconf6 entry-

 chrctcp -d autoconf6"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/autoconf6"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/autoconf6"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.12 /etc/rc.tcpip - gated"
      info        : "This entry starts the gated daemon system startup. This daemon provides gateway routing functions for protocols such as RIP and SNMP.

The gated daemon provides gateway routing functions for protocols such as RIP and SNMP.  It is recommended that this daemon is disabled, unless the server is functioning as a network router."
      solution    : "In /etc/rc.tcpip, comment out the gated entry-

 chrctcp -d gated"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/gated"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/gated"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.13 /etc/rc.tcpip - mrouted"
      info        : "This entry starts the mrouted daemon at system startup. This daemon is an implementation of the multicast routing protocol.

The mrouted daemon is an implementation of the multicast routing protocol. It is recommended that this daemon is disabled, unless the server is functioning as a multicast router."
      solution    : "In /etc/rc.tcpip, comment out the mrouted entry-

 chrctcp -d mrouted"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/mrouted"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/mrouted"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.14 /etc/rc.tcpip - named"
      info        : "This entry starts the named daemon at system startup. This is the server for the DNS protocol and controls domain name resolution for its clients.

The named daemon is the server for the DNS protocol and controls domain name resolution for its clients. It is recommended that this daemon is disabled, unless the server is functioning as a DNS server.This entry starts the named daemon at system startup. This is the server for the DNS protocol and controls domain name resolution for its clients."
      solution    : "In /etc/rc.tcpip, comment out the named entry-

 chrctcp -d named"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/named"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/named"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.15 /etc/rc.tcpip - routed"
      info        : "This entry starts the routed daemon at system startup. The routed daemonmanages the network routing tables in the kernel.

The routed daemon manages the network routing tables in the kernel. It is recommended that this daemon is disabled, unless the server is functioning as a network router."
      solution    : "In /etc/rc.tcpip, comment out the routed entry-

 chrctcp -d routed"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/routed"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/routed"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.16 /etc/rc.tcpip - rwhod"
      info        : "This entry starts the rwhod daemon at system startup. This is the remote WHO service.

The rwhod daemon is the remote WHO service, which collects and broadcasts status information to peer servers on the same network. It is recommended that this daemon is disabled, unless it is required."
      solution    : "In /etc/rc.tcpip, comment out the rwhod entry-

 chrctcp -d rwhod"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/rwhod"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/rwhod"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.17 /etc/rc.tcpip - timed"
      info        : "This entry starts the timed daemon at system startup. This is the old UNIX time service.

The timed daemon is the old UNIX time service. You must disable this service and use xntp, if time synchronization is required in your environment."
      solution    : "In /etc/rc.tcpip, comment out the timed entry-

 chrctcp -d timed"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/timed"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/timed"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.18 /etc/rc.tcpip - dpid2"
      info        : "This entry starts the dpid2 daemon on system startup. The dpid2 daemon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as hostmibd, to talk to a SNMP v1 agent that follows SNMP MUX protocol.

The dpid2 deamon acts as a protocol converter, which enables DPI (SNMP v2) sub-agents, such as hostmibd, to talk to a SNMP v1 agent that follows SNMP MUX protocol. Unless the server hosts an SNMP agent, it is recommended that dpid2 is disabled."
      solution    : "In /etc/rc.tcpip, comment out the dpid2 entry-

 chrctcp -d dpid2"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/dpid2"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/dpid2"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.19 /etc/rc.tcpip - hostmibd"
      info        : "This entry starts the hostmibd daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP.

The hostmibd daemon is a dpi2 sub-agent which manages a number of MIB variables. If snmpd is not required, it is recommended that it is disabled.The specific MIB variables which are managed by hostmibd are defined by RFC 2790.  Further details relating to these MIBS can be found in the URL below-

 http-//pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds2/hostmibd.htm?resultof=%22%68%6f%73%74%6d%69%62%64%22%20"
      solution    : "In /etc/rc.tcpip, comment out the hostmibd entry-

 chrctcp -d hostmibd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/hostmibd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/hostmibd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.20 /etc/rc.tcpip - snmpmibd"
      info        : "This entry starts the snmpmibd daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP.

The snmpmibd daemon is a dpi2 sub-agent which manages a number of MIB variables. If snmpd is not required, it is recommended that it is disabled.The specific MIB variables which are managed by snmpmibd are defined by numerous RFCs.  Further details relating to these MIBS can be found in the URL below-

 http-//pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds5/snmpmibd.htm?resultof=%22%73%6e%6d%70%6d%69%62%64%22%20"
      solution    : "In /etc/rc.tcpip, comment out the snmpmibd entry-

 chrctcp -d snmpmibd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/snmpmibd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/snmpmibd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.21 /etc/rc.tcpip - aixmibd"
      info        : "This entry starts the aixmibd daemon on system startup. This is a dpi2 sub-agent that may be required if the server runs SNMP.

The aixmibd daemon is a dpi2 sub-agent which manages a number of MIB variables. If snmpd is not required, it is recommended that it is disabled.The aixmibd collects data from an AIX specific MIB. Further details relating to this MIB can be found in the URL below-

 http-//pic.dhe.ibm.com/infocenter/aix/v7r1/topic/com.ibm.aix.cmds/doc/aixcmds1/aixmibd.htm?resultof=%22%61%69%78%6d%69%62%64%22%20"
      solution    : "In /etc/rc.tcpip, comment out the aixmibd entry-

 chrctcp -d aixmibd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/aixmibd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/aixmibd"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.22 /etc/rc.tcpip - ndpd-host"
      info        : "This entry starts ndpd-host on system startup. This is the Neighbor Discovery Protocol (NDP) daemon, required in IPv6.

The ndpd-host is the NDP deamon for the server. Unless the server utilizes IPv6, this is not required and should be disabled."
      solution    : "In /etc/rc.tcpip, comment out the ndpd-host entry-

 chrctcp -d ndpd-host"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/ndpd-host"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/ndpd-host"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.23 /etc/rc.tcpip - ndpd-router"
      info        : "This entry starts ndpd-router on system startup. This manages the Neighbor Discovery Protocol (NDP) for non kernel activities, required in IPv6.

The ndpd-router manages NDP for non-kernel activities. Unless the server utilizes IPv6, this is not required and should be disabled."
      solution    : "In /etc/rc.tcpip, comment out the ndpd-router entry-

 chrctcp -d ndpd-router"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/ndpd-router"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/ndpd-router"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.28 /etc/inetd.conf - cmsd"
      info        : "This entry starts the cmsd service when required. This is a calendar and appointment service.

The cmsd service is utilized by CDE to provide calendar functionality. If CDE is not required, this service should be disabled."
      solution    : "In /etc/inetd.conf, comment out the cmsd entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'cmsd' -p 'sunrpc_udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*cmsd[\\s]"
      expect      : "^[\\s]*cmsd[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.29 /etc/inetd.conf - ttdbserver"
      info        : "This entry starts the ttdbserver servicewhen required. It is not a pre-requisite service for CDE, which is fully functional when it is disabled.

The ttdbserver service is the tool-talk database service for CDE. This service runs as root and should be disabled. Unless required the ttdbserver service will be disabled."
      solution    : "In /etc/inetd.conf, comment out the ttdbserver entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'ttdbserver' -p 'sunrpc_tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*ttdbserver[\\s]"
      expect      : "^[\\s]*ttdbserver[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.30 /etc/inetd.conf - uucp"
      info        : "This entry starts the uucp service when required. This service facilitates file copying between networked servers.

The uucp (UNIX to UNIX Copy Program), service allows users to copy files between networked machines. Unless an application or process requires UUCP this should be disabled."
      solution    : "In /etc/inetd.conf, comment out the uucp entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'uucp' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*uucp[\\s]"
      expect      : "^[\\s]*uucp[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.31 /etc/inetd.conf - time"
      info        : "This entry starts the time service when required. This service can be used to synchronize system clocks.

The time service is an obsolete process used to synchronize system clocks at boot time.  This has been superseded by NTP, which should be use if time synchronization is necessary. Unless required the time service will be disabled."
      solution    : "In /etc/inetd.conf, comment out the time entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'udp'
chsubserver -r inetd -C /etc/inetd.conf -d -v 'time' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*time[\\s]"
      expect      : "^[\\s]*time[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.33 /etc/inetd.conf - talk"
      info        : "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.

This talk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the talk service will be disabled"
      solution    : "In /etc/inetd.conf, comment out the talk entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'talk' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*talk[\\s]"
      expect      : "^[\\s]*talk[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.34 /etc/inetd.conf - ntalk"
      info        : "This entry starts the talkd daemon when required. This service establishes a two-way communication link between two users, either locally or remotely.

This ntalk service is used to establish an interactive two-way communication link between two UNIX users. It is unlikely that there would be a requirement to run this type of service on a UNIX system. Unless required the ntalk service will be disabled."
      solution    : "In /etc/inetd.conf, comment out the ntalk entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'ntalk' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*ntalk[\\s]"
      expect      : "^[\\s]*ntalk[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.38 /etc/inetd.conf - dtspc"
      info        : "This entry starts the dtspc service when required. This service is used in response to a CDE client request.

The dtspc service deals with the CDE interface of the X11 daemon. It is started automatically by the inetd daemon in response to a CDE client requesting a process to be started on the daemon's host. This makes it vulnerable to buffer overflow attacks, which may allow an attacker to gain root privileges on a host. This service must be disabled unless it is absolutely required."
      solution    : "In /etc/inetd.conf, comment out the dtspc entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'dtspc' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*dtspc[\\s]"
      expect      : "^[\\s]*dtspc[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.40 /etc/inetd.conf - pcnfsd"
      info        : "This entry starts the pcnfsd daemon when required. This service is an authentication and printing program, which uses NFS to provide file transfer services.

The pcnfsd service is an authentication and printing program, which uses NFS to provide file transfer services. This service is vulnerable and exploitable and permits the machine to be compromised both locally and remotely. If PC NFS clients are required within the environment, Samba is recommended as an alternative software solution. The pcnfsd daemon predates Microsoft's release of SMB specifications. This service should therefore be disabled."
      solution    : "In /etc/inetd.conf, comment out the pcnfsd entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'pcnfsd' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*pcnfsd[\\s]"
      expect      : "^[\\s]*pcnfsd[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.41 /etc/inetd.conf - rstatd"
      info        : "This entry starts the rstatd daemon when required. This service is used to provide kernel statistics and other monitorable parameters such as CPU usage, system uptime, network usage etc.

The rstatd service is used to provide kernel statistics and other monitorable parameters pertinent to the system such as- CPU usage, system uptime, network usage etc. An attacker may use this information in a DoS attack. This service should be disabled."
      solution    : "In /etc/inetd.conf, comment out the rstatd entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'rstatd' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*rstatd[\\s]"
      expect      : "^[\\s]*rstatd[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.42 /etc/inetd.conf - rusersd"
      info        : "This entry starts the rsusersd daemon when required. This service provides a list of current users active on a system.

The rusersd service runs as root and provides a list of current users active on a system.  An attacker may use this service to learn valid account names on the system. This is not an essential service and should be disabled."
      solution    : "In /etc/inetd.conf, comment out the rusersd entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'rusersd' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*rusersd[\\s]"
      expect      : "^[\\s]*rusersd[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.43 /etc/inetd.conf - rwalld"
      info        : "This entry starts the rwalld daemon when required. This service allows remote users to broadcast system wide messages.

The rwalld service allows remote users to broadcast system wide messages. The service runs as root and should be disabled unless absolutely necessary."
      solution    : "In /etc/inetd.conf, comment out the rwalld entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'rwalld' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*rwalld[\\s]"
      expect      : "^[\\s]*rwalld[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.45 /etc/inetd.conf - klogin"
      info        : "This entry starts the kloginservice when required. This is a kerberized login service, which provides a higher degree of security over traditional rlogin and telnet.

The klogin service offers a higher degree of security than traditional rlogin or telnet by eliminating most clear-text password exchanges on the network. However, it is still not as secure as SSH, which encrypts all traffic. If you use kloginto login to a system, the password is not sent in clear text; however, if you suto another user, that password exchange is open to detection from network-sniffing programs. The recommendation is to utilize SSH wherever possible instead of klogin.If the klogin service is used, you must use the latest kerberos version available and make sure that all the latest patches are installed."
      solution    : "In /etc/inetd.conf, comment out the klogin entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'klogin' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*klogin[\\s]"
      expect      : "^[\\s]*klogin[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.46 /etc/inetd.conf - kshell"
      info        : "This entry starts the kshell service when required. This is a kerberized remote shell service, which provides a higher degree of security over traditional rsh.

The kshell service offers a higher degree of security than traditional rsh services.  However, it still does not use encrypted communications. The recommendation is to utilize SSH wherever possible instead of kshell.If the kshell service is used, you should use the latest kerberos version available and must make sure that all the latest patches are installed."
      solution    : "In /etc/inetd.conf, comment out the kshell entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'kshell' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*kshell[\\s]"
      expect      : "^[\\s]*kshell[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.47 /etc/inetd.conf - rquotad"
      info        : "This entry starts the rquotad service when required. This allows NFS clients to enforce disk quotas on locally mounted filesystems.

The rquotad serviceallows NFS clients to enforce disk quotas on file systems that are mounted on the local system. This service should be disabled if it is not required."
      solution    : "In /etc/inetd.conf, comment out the rquotad entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'rquotad' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*rquotad[\\s]"
      expect      : "^[\\s]*rquotad[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.48 /etc/inetd.conf - tftp"
      info        : "This entry starts the tftp service when required.

The tftp service allows remote systems to download or upload files to the tftp server without any authentication. It is therefore a service that should not run, unless needed. One of the main reasons for requiring this service to be activated is if the host is a NIM master.  However, the service can be enabled and then disabled once a NIM operation has completed, rather than left running permanently."
      solution    : "In /etc/inetd.conf, comment out the tftp entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'tftp' -p 'udp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*tftp[\\s]"
      expect      : "^[\\s]*tftp[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.49 /etc/inetd.conf - imap2"
      info        : "This entry starts the imap2 service when required.

The imap2 service orInternet Message Access Protocol (IMAP) supports the IMAP4 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required."
      solution    : "In /etc/inetd.conf, comment out the imap2 entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'imap2' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*imap2[\\s]"
      expect      : "^[\\s]*imap2[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.50 /etc/inetd.conf - pop3"
      info        : "This entry starts the pop3 service when required.

The pop3 service provides a pop3 server. It supports the pop3 remote mail access protocol. It works with sendmail and bellmail. This service should be disabled if it is not required."
      solution    : "In /etc/inetd.conf, comment out the pop3 entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'pop3' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*pop3[\\s]"
      expect      : "^[\\s]*pop3[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.3.52 /etc/inetd.conf - instsrv"
      info        : "This entry starts the instsrv service when required.

The instsrv service is part of the Network Installation Tools, used for servicing servers running AIX 3.2. This service should be disabled."
      solution    : "In /etc/inetd.conf, comment out the instsrv entry-

 chsubserver -r inetd -C /etc/inetd.conf -d -v 'instsrv' -p 'tcp'"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inetd.conf"
      regex       : "^[\\s]*instsrv[\\s]"
      expect      : "^[\\s]*instsrv[\\s]"
    </custom_item>

##
## 3.4 - AIX Security Expert - Disabling Remote Services
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.1 Remote command lockdown - rcp"
      info        : "Removes all permissions from the remote service commands- rsh, rlogin and rcp.

This effectively disables the following commands, for all users-

 /usr/bin/rcp
/usr/bin/rlogin
/usr/bin/rsh

These remote services send usernames and passwords in clear text and should not be used.  Unless required these binaries will be disabled for all users. The SSH suite of commands should be utilized to provide equivalent functionality"
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/bin/rcp"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/bin/rcp"
      mask        : "777"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.1 Remote command lockdown - rsh"
      info        : "Removes all permissions from the remote service commands- rsh, rlogin and rcp.

This effectively disables the following commands, for all users-

 /usr/bin/rcp
/usr/bin/rlogin
/usr/bin/rsh

These remote services send usernames and passwords in clear text and should not be used.  Unless required these binaries will be disabled for all users. The SSH suite of commands should be utilized to provide equivalent functionality"
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/bin/rsh"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/bin/rsh"
      mask        : "777"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.1 Remote command lockdown - rlogin"
      info        : "Removes all permissions from the remote service commands- rsh, rlogin and rcp.

This effectively disables the following commands, for all users-

 /usr/bin/rcp
/usr/bin/rlogin
/usr/bin/rsh

These remote services send usernames and passwords in clear text and should not be used.  Unless required these binaries will be disabled for all users. The SSH suite of commands should be utilized to provide equivalent functionality"
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/bin/rlogin"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/bin/rlogin"
      mask        : "777"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.2 Remote daemon lockdown - rlogind"
      info        : "Removes all permissions from the remote service daemons- , rlogind, rshd and also tftpd.

This effectively disables the following daemons, for all users-

 /usr/sbin/rlogind
/usr/sbin/rshd
/usr/sbin/tftpd

These remote services both send and receive usernames and passwords in clear text and should not be used. Unless required these daemons will be disabled for all users."
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/sbin/rlogind"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/sbin/rlogind"
      mask        : "777"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.2 Remote daemon lockdown - rshd"
      info        : "Removes all permissions from the remote service daemons- , rlogind, rshd and also tftpd.

This effectively disables the following daemons, for all users-

 /usr/sbin/rlogind
/usr/sbin/rshd
/usr/sbin/tftpd

These remote services both send and receive usernames and passwords in clear text and should not be used. Unless required these daemons will be disabled for all users."
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/sbin/rshd"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/sbin/rshd"
      mask        : "777"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "3.4.2 Remote daemon lockdown - tftpd"
      info        : "Removes all permissions from the remote service daemons- , rlogind, rshd and also tftpd.

This effectively disables the following daemons, for all users-

 /usr/sbin/rlogind
/usr/sbin/rshd
/usr/sbin/tftpd

These remote services both send and receive usernames and passwords in clear text and should not be used. Unless required these daemons will be disabled for all users."
      solution    : "Use the chmod command to remove all permissions on the remote services-

 chmod ugo= /usr/sbin/tftpd"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/usr/sbin/tftpd"
      mask        : "777"
    </custom_item>

##
## 3.5 - AIX Security Expert - Automated Authentication
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.5.1 Removal of .rhosts and .netrc files - .rhosts"
      info        : "This recommendation removes all instances of .rhosts and.netrc files from the system.

The .rhosts and .netrc files can be used to circumvent normal login or change control procedures. The existence of such files, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication. Unless required these files will be removed from all user home directories."
      solution    : "Remove the .rhosts and .netrc files from all user home directories-

 find / -name '.rhosts' -exec rm {} \;"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/awk -F: '{if (system(\"test -f \"$6\"/.rhosts\") == 0) { print $6; f++; } } END { if(f<1) print \"none\" }' /etc/passwd"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.5.1 Removal of .rhosts and .netrc files - .netrc"
      info        : "This recommendation removes all instances of .rhosts and.netrc files from the system.

The .rhosts and .netrc files can be used to circumvent normal login or change control procedures. The existence of such files, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication. Unless required these files will be removed from all user home directories."
      solution    : "Remove the .rhosts and .netrc files from all user home directories-

 find / -name '.netrc' -exec rm {} \;"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/awk -F: '{if (system(\"test -f \"$6\"/.netrc\") == 0) { print $6; f++; } } END { if(f<1) print \"none\" }' /etc/passwd"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.5.2 Removal of entries from /etc/hosts.equiv"
      info        : "This process removes all entries from the /etc/hosts.equiv file.

The /etc/hosts.equiv file can be used to circumvent normal login or change control procedures. The existence of this file, with the relevant entries, can allow remote user access to a system bypassing local user and password authentication. Unless required all entries will be removed from this file."
      solution    : "Remove all entries from the /etc/hosts.equiv file-

 sed '/^\s*$/d; s/^\(\s*[^#].*\)/#\1/' /etc/hosts.equiv > /etc/hosts.equiv.work
mv hosts.equiv.work hosts.equiv
chown root:system /etc/hosts.equiv
chmod 644 /etc/hosts.equiv

Note- the above command removes blank lines and comments out any non commented entries."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/hosts.equiv"
      regex       : "^[\\s]*[^#].*"
      expect      : "^[\\s]*[^#].*"
    </custom_item>

##
## 3.6 - AIX Security Expert - TCP/IP Hardening
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.1 TCP/IP Tuning - ipsrcrouteforward"
      info        : "The ipsrcrouteforward parameter determines whether or not the system forwards IPV4 source-routed packets.

The ipsrcrouteforward will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall."
      solution    : "In /etc/tunables/nextboot, add the ipsrcrouteforward entry-

 no -p -o ipsrcrouteforward=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipsrcrouteforward[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipsrcrouteforward[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.2 TCP/IP Tuning - ipignoreredirects"
      info        : "The ipignoreredirects parameter determines whether or not the system will process IP redirects.

The ipignoreredirectswill be set to 1, to prevent IP re-directs being processed by the system."
      solution    : "In /etc/tunables/nextboot, add the ipignoreredirects entry-

 no -p -o ipignoreredirects=1

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipignoreredirects[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipignoreredirects[\\s]+=[\\s]+1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.3 TCP/IP Tuning - clean_partial_conns"
      info        : "The clean_partial_conns parameter determines whether or not the system is open to SYN attacks. This parameter, when enabled, clears down connections in the SYN RECEIVED state after a set period of time. This attempts to stop DoS attacks when a hacker may flood a system with SYN flag set packets.

The clean_partial_connsparameter will be set to 1, to clear down pending SYN received connections after a set period of time."
      solution    : "In /etc/tunables/nextboot, add the clean_partial_conns entry-

 no -p -o clean_partial_conns=1

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"clean_partial_conns[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*clean_partial_conns[\\s]+=[\\s]+1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.4 TCP/IP Tuning - ipsrcroutesend"
      info        : "The ipsrcroutesend parameter determines whether or not the system can send source-routed packets.

The ipsrcroutesend parameter will be set to 0, to ensure that any local applications cannot send source routed packets."
      solution    : "In /etc/tunables/nextboot, add the ipsrcroutesend entry-

 no -p -o ipsrcroutesend=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipsrcroutesend[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipsrcroutesend[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.5 TCP/IP Tuning - ipforwarding"
      info        : "The ipforwarding parameter determines whether or not the system forwards TCP/IP packets.

The ipforwarding parameter will be set to 0, to ensure that redirected packets do not reach remote networks. This should only be enabled if the system is performing the function of an IP router. This is typically handled by a dedicated network device."
      solution    : "In /etc/tunables/nextboot, add the ipforwarding entry-

 no -p -o ipforwarding=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipforwarding[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipforwarding[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.6 TCP/IP Tuning - ipsendredirects"
      info        : "The ipsendredirects parameter determines whether or not the system forwards re-directed TCP/IP packets.

The ipsendredirects parameter will be set to 0, to ensure that redirected packets do not reach remote networks."
      solution    : "In /etc/tunables/nextboot, add the ipsendredirects entry-

 no -p -o ipsendredirects=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipsendredirects[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipsendredirects[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.7 TCP/IP Tuning - ip6srcrouteforward"
      info        : "The ip6srcrouteforward parameter determines whether or not the system forwards IPV6 source-routed packets.

The ip6srcrouteforward parameter will be set to 0, to prevent source-routed packets being forwarded by the system. This would prevent a hacker from using source-routed packets to bridge an external facing server to an internal LAN, possibly even through a firewall."
      solution    : "In /etc/tunables/nextboot, add the ip6srcrouteforward entry-

 no -p -o ip6srcrouteforward=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ip6srcrouteforward[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ip6srcrouteforward[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.8 TCP/IP Tuning - directed_broadcast"
      info        : "The directed_broadcast parameter determines whether or not the system allows a directed broadcast to a network gateway.

The directed_broadcast parameter will be set to 0, to prevent directed broadcasts being sent network gateways. This would prevent a redirected packet from reaching a remote network."
      solution    : "In /etc/tunables/nextboot, add the directed_broadcast entry-

 no -p -o directed_broadcast=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(9),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.PT-4,ITSG-33|SC-7(9),LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"directed_broadcast[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*directed_broadcast[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.9 TCP/IP Tuning - tcp_pmtu_discover"
      info        : "The tcp_pmtu_discover parameter controls whether TCP MTU discovery is enabled.

The tcp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When tcp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks."
      solution    : "In /etc/tunables/nextboot, add the tcp_pmtu_discover entry-

 no -p -o tcp_pmtu_discover=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"tcp_pmtu_discover[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*tcp_pmtu_discover[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.10 TCP/IP Tuning - bcastping"
      info        : "The bcastping parameter determines whether the system responds to ICMP echo packets sent to the broadcast address.

The bcastping parameterwill be set to 0. This means that the system will not respond to ICMP packets sent to the broadcast address. By default, when this is enabled the system is susceptible to smurf attacks, where a hacker utilizes this tool to send a small number of ICMP echo packets. These packets can generate huge numbers of ICMP echo replies and seriously affect the performance of the targeted host and network. This parameter will be disabled to ensure protection from this type of attack."
      solution    : "In /etc/tunables/nextboot, add the bcastping entry-

 no -p -o bcastping=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"bcastping[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*bcastping[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.11 TCP/IP Tuning - icmpaddressmask"
      info        : "The icmpaddressmask parameter determines whether the system responds to an ICMP address mask ping.

The icmpaddressmask parameter will be set to 0, This means that the system will not respond to ICMP address mask request pings. By default, when this is enabled the system is susceptible to source routing attacks. This is typically a feature performed by a device such as a network router and should not be enabled within the operating system."
      solution    : "In /etc/tunables/nextboot, add the icmpaddressmask entry-

 no -p -o icmpaddressmask=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-171|3.13.5,800-53|SC-7,CN-L3|8.1.10.6(j),CSF|DE.CM-1,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7,LEVEL|2S,NESA|T4.5.4,NIAv2|GS1,NIAv2|GS2a,NIAv2|GS2b,PCI-DSS|2.2.4,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"icmpaddressmask[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*icmpaddressmask[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.12 TCP/IP Tuning - udp_pmtu_discover"
      info        : "The udp_pmtu_discover parameter controls whether MTU discovery is enabled.

The udp_pmtu_discover parameter will be set to 0. The idea of MTU discovery is to avoid packet fragmentation between remote networks. This is achieved by discovering the network route and utilizing the smallest MTU size within that path when transmitting packets. When udp_pmtu_discover is enabled, it leaves the system vulnerable to source routing attacks."
      solution    : "In /etc/tunables/nextboot, add the udp_pmtu_discover entry-

 no -p -o udp_pmtu_discover=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"udp_pmtu_discover[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*udp_pmtu_discover[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.13 TCP/IP Tuning - ipsrcrouterecv"
      info        : "The ipsrcrouterecv parameter determines whether the system accepts source routed packets.

The ipsrcrouterecv parameter will be set to 0, This means that the system will not accept source routed packets. By default, when this is enabled the system is susceptible to source routing attacks."
      solution    : "In /etc/tunables/nextboot, add the ipsrcrouterecv entry-

 no -p -o ipsrcrouterecv=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"ipsrcrouterecv[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*ipsrcrouterecv[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.14 TCP/IP Tuning - nonlocsrcroute"
      info        : "The nonlocsrcroute parameter determines whether the system allows source routed packets to be addressed to hosts outside of the LAN.

The nonlocsrcroute parameter will be set to 0. This means that the system will not allow source routed packets to be addressed to hosts outside of the LAN. By default, when this is enabled the system is susceptible to source routing attacks."
      solution    : "In /etc/tunables/nextboot, add the nonlocsrcroute entry-

 no -p -o nonlocsrcroute=0

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"nonlocsrcroute[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*nonlocsrcroute[\\s]+=[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.15 TCP/IP Tuning - tcp_tcpsecure"
      info        : "The tcp_tcpsecure parameter value determines if the system is protected from three specific vulnerabilities-
 o Fake SYN - This is used to terminate an established connection. A tcp_tcpsecure value of 1 protects the system from this vulnerability.
 o Fake RST - As above, this is used to terminate an established connection. A tcp_tcpsecure value of 2 protects the system from this vulnerability.
 o Fake data - A hacker may inject fake data into an established connection. A tcp_tcpsecure value of 4 protects the system from this vulnerability.

The tcp_tcpsecure parameterwill be set to 7. This means that the system will be protected from any connection reset and data integrity attacks."
      solution    : "In /etc/tunables/nextboot, add the tcp_tcpsecure entry-

 no -p -o tcp_tcpsecure=7

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"tcp_tcpsecure[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*tcp_tcpsecure[\\s]+=[\\s]+7[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.16 TCP/IP Tuning - sockthresh"
      info        : "The sockthresh parameter value determines what percentage of the total memory allocated to networking, set via thewall, can be used for sockets.

The sockthresh parameter will be set to 60. This means that 60% of network memory can be used to service new socket connections, the remaining 40% is reserved for existing sockets. This ensures a quality of service for existing connections."
      solution    : "In /etc/tunables/nextboot, add the sockthresh entry-

 no -p -o sockthresh=60

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"sockthresh[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*sockthresh[\\s]+=[\\s]+60[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.17 TCP/IP Tuning - rfc1323"
      info        : "The rfc1323 parameter determines whether the TCP window sizes (tcp_sendspace and tcp_recvspace) can be greater than 64KB.

The rfc1323 parameterwill be set to 1. This means that the system will allow the TCP windows sizes to exceed 64KB. This is a requirement for high performance networks, particularly those which utilize large MTU sizes."
      solution    : "In /etc/tunables/nextboot, add the rfc1323 entry-

 no -p -o rfc1323=1

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"rfc1323[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*rfc1323[\\s]+=[\\s]+1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.18 TCP/IP Tuning - tcp_sendspace"
      info        : "The tcp_sendspace parameter sets the socket buffer size for sending data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.

The tcp_sendspace parameter will be set to 262144. This means that the system default socket buffer size for sending data will be 262KB. This is the minimum recommendation for modern high performance networks."
      solution    : "In /etc/tunables/nextboot, add the tcp_sendspace entry-

 no -p -o tcp_sendspace=262144

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"tcp_sendspace[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*tcp_sendspace[\\s]+=[\\s]+(26214[4-9]|2621[5-9][0-9]|262[2-9][0-9]{2}|26[3-9][0-9]{3}|2[7-9][0-9]{4}|[3-9][0-9]{5}|[1-9][0-9]{6,})[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.19 TCP/IP Tuning - tcp_recvspace"
      info        : "The tcp_recvspace parameter sets the socket buffer size for receiving data. This recommendation changes the default size, but many adapters have specific buffer sizes implemented within the device driver. These are typically 64KB or greater.

The tcp_recvspace parameter will be set to 262144. This means that the system default socket buffer size for receiving data will be 262KB. This is the minimum recommendation for modern high performance networks."
      solution    : "In /etc/tunables/nextboot, add the tcp_recvspace entry-

 no -p -o tcp_recvspace=262144

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"tcp_recvspace[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*tcp_recvspace[\\s]+=[\\s]+(26214[4-9]|2621[5-9][0-9]|262[2-9][0-9]{2}|26[3-9][0-9]{3}|2[7-9][0-9]{4}|[3-9][0-9]{5}|[1-9][0-9]{6,})[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.20 TCP/IP Tuning - tcp_mssdflt"
      info        : "The tcp_mssdflt parameter sets the maximum segment size for communication to a remote network. This parameter is only relevant if MTU discovery is disabled, which is recommended in this benchmark.

The tcp_mssdflt parameter will be set to 1448 . This value reflects the packet size minus the TCP/IP headers."
      solution    : "In /etc/tunables/nextboot, add the tcp_mssdflt entry-

 no -p -o tcp_mssdflt=1448

This makes the change permanent by adding the entry into /etc/tunables/nextboot."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/no -a | /usr/bin/grep \"tcp_mssdflt[[:blank:]]=[[:blank:]]\""
      expect      : "^[\\s]*tcp_mssdflt[\\s]+=[\\s]+1448[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.21 TCP/IP Tuning - nfs_use_reserved_ports - portcheck"
      info        : "The portcheck and nfs_use_reserved_ports parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).

The portcheck and nfs_use_reserved_ports parameters will both be set to 1. This value means that NFS client requests that do not originate from the privileged ports range (ports less than 1024) will be ignored by the local system."
      solution    : "In /etc/tunables/nextboot, add the portcheck and nfs_use_reserved_ports entries-

 nfso -p -o portcheck=1

This makes the change permanent by adding the entry into /etc/tunables/nextboot"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/nfso -a | /usr/bin/grep \"portcheck[[:blank:]]=[[::blank::]]\""
      expect      : "^[\\s]*portcheck[\\s]+=[\\s]+1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.6.21 TCP/IP Tuning - nfs_use_reserved_ports - nfs_use_reserved_ports"
      info        : "The portcheck and nfs_use_reserved_ports parameters force the NFS server process on the local system to ignore NFS client requests that do not originate from the privileged ports range (ports less than 1024).

The portcheck and nfs_use_reserved_ports parameters will both be set to 1. This value means that NFS client requests that do not originate from the privileged ports range (ports less than 1024) will be ignored by the local system."
      solution    : "In /etc/tunables/nextboot, add the portcheck and nfs_use_reserved_ports entries-

 nfso -p -o nfs_use_reserved_ports=1

This makes the change permanent by adding the entry into /etc/tunables/nextboot"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/nfso -a | /usr/bin/grep \"nfs_use_reserved_ports[[:blank:]]=[[::blank::]]\""
      expect      : "^[\\s]*nfs_use_reserved_ports[\\s]+=[\\s]+1[\\s]*$"
    </custom_item>

##
## 3.7 - AIX Security Expert - Miscellaneous Enhancements
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK_NOT
      description : "3.7.1 Miscellaneous Enhancements - crontab access - cron.deny does not exist"
      info        : "This change creates a cron.allow file with a root user entry and removes the cron.deny file, if it exists.

This ensures that only the root user has the ability to create a crontab. A hacker may exploit use of the crontab to execute programs or processes automatically. Limiting access to the root account only reduces this risk."
      solution    : "Create the /var/adm/cron/cron.allow file and remove /var/adm/cron/cron.deny (if it exists)-

 print 'root
adm' > /var/adm/cron/cron.allow
rm /var/adm/cron/cron.deny"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,LEVEL|2S,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|7.2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/cron/cron.deny"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "3.7.1 Miscellaneous Enhancements - crontab access - root exists in cron.allow"
      info        : "This change creates a cron.allow file with a root user entry and removes the cron.deny file, if it exists.

This ensures that only the root user has the ability to create a crontab. A hacker may exploit use of the crontab to execute programs or processes automatically. Limiting access to the root account only reduces this risk."
      solution    : "Create the /var/adm/cron/cron.allow file and remove /var/adm/cron/cron.deny (if it exists)-

print 'root
adm' > /var/adm/cron/cron.allow
rm /var/adm/cron/cron.deny"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|7.2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/cron/cron.allow"
      regex       : "^root$"
      expect      : "^root$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "3.7.1 Miscellaneous Enhancements - crontab access - adm exists in cron.allow"
      info        : "This change creates a cron.allow file with a root user entry and removes the cron.deny file, if it exists.

This ensures that only the root user has the ability to create a crontab. A hacker may exploit use of the crontab to execute programs or processes automatically. Limiting access to the root account only reduces this risk."
      solution    : "Create the /var/adm/cron/cron.allow file and remove /var/adm/cron/cron.deny (if it exists)-

print 'root
adm' > /var/adm/cron/cron.allow
rm /var/adm/cron/cron.deny"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|7.2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/cron/cron.allow"
      regex       : "^adm$"
      expect      : "^adm$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK_NOT
      description : "3.7.2 Miscellaneous Enhancements - at access - at.deny does not exist"
      info        : "This change creates an at.allow file with a root user entry and removes the at.deny file, if it exists.

This ensures that only the root user has the ability to schedule jobs through the at command. A hacker may exploit use of at to execute programs or processes automatically.  Limiting access to the root account only reduces this risk."
      solution    : "Create the /var/adm/cron/at.allow file and remove /var/adm/cron/at.deny (if it exists)-

 echo 'root' > /var/adm/cron/at.allow
rm /var/adm/cron/at.deny"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,LEVEL|2S,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|7.2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/cron/at.deny"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "3.7.2 Miscellaneous Enhancements - at access - root exists in at.allow"
      info        : "This change creates an at.allow file with a root user entry and removes the at.deny file, if it exists.

This ensures that only the root user has the ability to schedule jobs through the at command. A hacker may exploit use of at to execute programs or processes automatically.  Limiting access to the root account only reduces this risk."
      solution    : "Create the /var/adm/cron/at.allow file and remove /var/adm/cron/at.deny (if it exists)-

echo 'root' > /var/adm/cron/at.allow
rm /var/adm/cron/at.deny"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|7.2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/cron/at.allow"
      regex       : "^root$"
      expect      : "^root$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.7 Miscellaneous Enhancements - default umask"
      info        : "This changes the default user umask in /etc/security/user.

The default user umask will be set to 027. This means that the default file creation permissions give read and write access to the user, read access to the group and no access to other. The default directory creation permissions give read, write and execute access to the user, read and execute to the group and no access to other. This is the recommended umask setting, as world access should be explicitly defined and not added during default creation. Where possible, access to files and directories should be managed via group membership and ACL's, rather than opening up directory structures for world access. In particular, world write access should be avoided.

Consideration should be given to further securing the default user umask by implementing 077. This means that only the user has read/write access to the files and directories they create. Group and/or world access would need to be explicitly defined.

As part of this change all explicitly defined umask user settings are removed (if using the customized XML file)."
      solution    : "Add the umask attribute to the default user stanza in /etc/security/user-

 chsec -f /etc/security/user -s default -a umask=027"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lssec -f /etc/security/user -s default -a umask"
      expect      : "^default[\\s]+umask[\\s]*=[\\s]*[27]7[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.8 Miscellaneous Enhancements - disabling core dumps - /etc/security/limits core"
      info        : "This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.

The creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker.

The commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits."
      solution    : "Change the default user stanza attributes core and core_hard in /etc/security/limits and the set the fullcore kernel parameter to false-

 chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0
chdev -l sys0 -a fullcore=false"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lssec -f /etc/security/limits -s default -a core"
      expect      : "^default[\\s]+core[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.8 Miscellaneous Enhancements - disabling core dumps - /etc/security/limits core_hard"
      info        : "This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.

The creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker.

The commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits."
      solution    : "Change the default user stanza attributes core and core_hard in /etc/security/limits and the set the fullcore kernel parameter to false-

 chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0
chdev -l sys0 -a fullcore=false"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lssec -f /etc/security/limits -s default -a core_hard"
      expect      : "^default[\\s]+core_hard[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.8 Miscellaneous Enhancements - disabling core dumps - kernel parameter"
      info        : "This change disables core dumps in the default user stanza of /etc/security/limits and also ensures the fullcore kernel parameter is set to false.

The creation of core dumps can reveal pertinent system information, potentially even passwords, within the core file. The ability to create a core dump is also a vulnerability to be exploited by a hacker.

The commands below disable core dumps by default, but they may be specifically enabled for a particular user in /etc/security/limits."
      solution    : "Change the default user stanza attributes core and core_hard in /etc/security/limits and the set the fullcore kernel parameter to false-

 chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0
chdev -l sys0 -a fullcore=false"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/lsattr -El sys0 -a fullcore"
      expect      : "^fullcore[\\s]+false[\\s]+Enable[\\s]+full[\\s]+CORE[\\s]+dump[\\s]+True[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.9 Miscellaneous Enhancements - AIX Auditing - /audit exists"
      info        : "This recommendation configures AIX auditing in bin mode.

AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.

Further information regarding the setup and management of AIX accounting and auditing can be found in the 'Accounting and Auditing for AIX 5L Redbook'-

 http-//www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf"
      solution    : "Configure AIX auditing in-line with the High Level AIX Security Expert policy.Create a /audit filesystem, at least 100 MB in size-

 mklv -y <LV name> -t jfs2 -u 1 -c 1 rootvg 1 hdisk0
 crfs -v jfs2 -d auditlv -m /audit -A yes -t no
 mount /audit"
      reference   : "800-171|3.3.8,800-171|3.4.2,800-53|AU-9,800-53|CM-6,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.10.6(d),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSCv6|3.1,CSF|PR.IP-1,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,ITSG-33|CM-6,LEVEL|2S,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.2.1,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/mount | /usr/bin/grep audit | awk '{ print } END { if (NR == 0) { print \"none\" }}'"
      expect      : "[\\s]/audit[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.9 Miscellaneous Enhancements - AIX Auditing - /etc/security/audit/config update"
      info        : "This recommendation configures AIX auditing in bin mode.

AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.

Further information regarding the setup and management of AIX accounting and auditing can be found in the 'Accounting and Auditing for AIX 5L Redbook'-

 http-//www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf"
      solution    : "Reflect the following configuration in the /etc/security/audit/config file-

 vi /etc/security/audit/config

Add in-

start:

 binmode = on
 streammode = off
bin:
 trail = /audit/trail
 bin1 = /audit/bin1
 bin2 = /audit/bin2
 binsize = 10240
 cmds = /etc/security/audit/bincmds

Add the auditing entries for root and all other users below the pre-defined audit classes-users-

 root = general,SRC,mail,cron,tcpip,ipsec,lvm
 <user 1> = general,SRC,cron,tcpip
 <user 2> = general,SRC,cron,tcpip
 etc."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.5.1,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/awk 'BEGIN {x=0;a[\"start:-binmode\"] = \"^on$\"; a[\"start:-streammode\"] = \"^off$\"; a[\"bin:-trail\"] = \"^/audit/trail$\"; a[\"bin:-bin1\"] = \"^/audit/bin1$\"; a[\"bin:-bin2\"] = \"^/audit/bin2$\"; a[\"bin:-binsize\"] = \"^10240$\"; a[\"bin:-cmds\"] = \"^/etc/security/audit/bincmds$\"; a[\"users:-root\"] = \"^general\"} /^[^ ]+:$/ { sec=$1 } { if ($3 ~ a[sec\"-\"$1]) delete a[sec\"-\"$1] } END { for (i in a) x++; if (x > 0) { print \"failed\" } else { print \"pass\" } }' /etc/security/audit/config"
      expect      : "^pass$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.9 Miscellaneous Enhancements - AIX Auditing - auditclasses update"
      info        : "This recommendation configures AIX auditing in bin mode.

AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.

Further information regarding the setup and management of AIX accounting and auditing can be found in the 'Accounting and Auditing for AIX 5L Redbook'-

 http-//www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf"
      solution    : "Update the /usr/lib/security/mkuser.default auditclasses entry to ensure that auditing is set up for any newly created users-

 chsec -f /usr/lib/security/mkuser.default -s user -a auditclasses=general,SRC,cron,tcpip"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lssec -f /usr/lib/security/mkuser.default -s user -a auditclasses"
      expect      : "^user[\\s]+auditclasses[\\s]*=[\\s]*general,SRC,cron,tcpip[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "3.7.9 Miscellaneous Enhancements - AIX Auditing - cron audit rotation"
      info        : "This recommendation configures AIX auditing in bin mode.

AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.

Further information regarding the setup and management of AIX accounting and auditing can be found in the 'Accounting and Auditing for AIX 5L Redbook'-

 http-//www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf"
      solution    : "A cron job is implemented to monitor the free space in /audit, running hourly, to ensure that /audit does not fill up. If /audit is greater than 90% used, /audit/trail is moved to /audit/trailOneLevelBack-

 crontab -e

Add in-

0 * * * * /etc/security/aixpert/bin/cronaudit

NOTE- The implementation of a script to suit internal security policy is recommended to further enhance the log rotation process."
      reference   : "800-53|AU-11,CIP|007-6-R4,CSF|PR.PT-1,HIPAA|164.312(b),ITSG-33|AU-11,LEVEL|2S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7,PCI-DSS|10.7,SANS-CSC|14-2"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/crontab -l | /usr/bin/grep \"cronaudit\" | awk '{ print } END { if (NR == 0) { print \"none\" }}'"
      expect      : "^[^#][0-9\\s\\*]+[\\s]+/etc/security/aixpert/bin/cronaudit[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "3.7.9 Miscellaneous Enhancements - AIX Auditing - audit startup"
      info        : "This recommendation configures AIX auditing in bin mode.

AIX auditing provides a framework within which to capture pertinent system and security related information, such as failed login attempts, cron usage etc. It is recommended that auditing is enabled as part of a group of measures designed to provide enhanced logging of system and security changes.

Further information regarding the setup and management of AIX accounting and auditing can be found in the 'Accounting and Auditing for AIX 5L Redbook'-

 http-//www.redbooks.ibm.com/redbooks/pdfs/sg246396.pdf"
      solution    : "Add the audit startup command into /etc/inittab-

 mkitab 'audit:2:boot:audit start > /dev/console 2>&1 # Start audit'"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[\\s]*audit:"
      expect      : "^[\\s]*audit:"
    </custom_item>

##
## 4.1 - Non AIX Security Expert Recommendations - Configuring syslog
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "4.1.1 Configuring syslog - local logging - /var/adm/authlog"
      info        : "This recommendation implements a local syslog configuration.

Establishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date."
      solution    : "Create the authlog file and make it readable by root only-

 touch /var/adm/authlog
 chown root:system /var/adm/authlog
 chmod u=rw,go= /var/adm/authlog"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,HIPAA|164.312(b),ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|10.5.1,SANS-CSC|12-11,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/authlog"
      owner       : "root"
      mask        : "177"
      group       : "system"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "4.1.1 Configuring syslog - local logging - /var/adm/syslog"
      info        : "This recommendation implements a local syslog configuration.

Establishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date."
      solution    : "Create the syslog file-

 touch /var/adm/syslog
 chmod u=rw,g=r,o= /var/adm/syslog"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,HIPAA|164.312(b),ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|10.5.1,SANS-CSC|12-11,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/syslog"
      mask        : "137"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.1.1 Configuring syslog - local logging - auth.info in /etc/syslog.conf"
      info        : "This recommendation implements a local syslog configuration.

Establishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date."
      solution    : "Explicitly define a log file for the auth.info output in /etc/syslog.conf-

 printf 'auth.info\\t\\t/var/adm/authlog rotate time 1w files 4
' >> /etc/syslog.conf

NOTE- This ensures that remote login, sudo or su attempts are logged separately.

Refresh syslogd to force the daemon to read the edited /etc/syslog.conf-

 refresh -s syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|12-11,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/syslog.conf"
      regex       : "^auth[\\.]info	"
      expect      : "^auth[\\.]info	+/var/adm/authlog[\\s]+rotate[\\s]+time[\\s]+1w[\\s]+files[\\s]+4[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.1.1 Configuring syslog - local logging - *.info/auth.none in /etc/syslog.conf"
      info        : "This recommendation implements a local syslog configuration.

Establishing a logging process via syslog provides system and security administrators with pertinent information relating to: login, mail, daemon, user and kernel activity. The recommendation is to enable local syslog logging, with a weekly rotation policy in a four weekly cycle. The log rotation isolates historical data which can be reviewed retrospectively if an issue is uncovered at a later date."
      solution    : "Create an entry in /etc/syslog.conf to capture all other output of level info or higher, excluding authentication information, as this is to be captured within /var/adm/authlog-

 printf '*.info;auth.none\\t/var/adm/syslog rotate time 1w files 4
' >> /etc/syslog.conf

Refresh syslogd to force the daemon to read the edited /etc/syslog.conf-

 refresh -s syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|12-11,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/syslog.conf"
      regex       : "^[\\*][\\.]info;auth[\\.]none	"
      expect      : "^[\\*][\\.]info;auth[\\.]none	+/var/adm/syslog[\\s]+rotate[\\s]+time[\\s]+1w[\\s]+files[\\s]+4[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.1.2 Configuring syslog - remote logging - auth.info in /etc/syslog.conf"
      info        : "This recommendation implements a remote syslog configuration.

To further enhance the local syslog logging process, it is recommended that syslog information, in particular that generated by the auth facility, is logged remotely. This recommendation assumes that a remote and secure syslog server is available on the network. If this is not the case, please skip to the next recommendation.

The primary reason for logging remotely is to provide an un-editable audit trail of system access. If a hacker were to access a system and gain super user authority it would be easy to edit local files and remove all traces of access, providing the system administrator with no way of identifying the individual or group responsible. If the log data is sent remotely at the point of access, these remote logs can then be reconciled with local data to identify tampered and altered files. The logs can also be used as evidence in any subsequent prosecution."
      info        : "Note: Update the value of SYSLOG_SERVER_IP_ADDRESS with the appropriate value for the local environment."
      solution    : "Explicitly define a remote host for auth.info data in /etc/syslog.conf (enter the remote host IP address in the example below)-
 printf 'auth.info\\t\\tSYSLOG_SERVER_IP_ADDRESS
' >> /etc/syslog.conf

NOTE- This ensures that remote login, sudo or su attempts are logged separately.

Refresh syslogd to force the daemon to read the edited /etc/syslog.conf-

 refresh -s syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.5.3,SANS-CSC|14-7,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*auth[\\.]info	"
# Note: Variable @SYSLOG_SERVER_IP_ADDRESS@ replaced with "192.168.1.1" in field "expect".
      expect      : "^[\\s]*auth[\\.]info	+192.168.1.1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.1.2 Configuring syslog - remote logging - *.info;auth.none in /etc/syslog.conf"
      info        : "This recommendation implements a remote syslog configuration.

To further enhance the local syslog logging process, it is recommended that syslog information, in particular that generated by the auth facility, is logged remotely. This recommendation assumes that a remote and secure syslog server is available on the network. If this is not the case, please skip to the next recommendation.

The primary reason for logging remotely is to provide an un-editable audit trail of system access. If a hacker were to access a system and gain super user authority it would be easy to edit local files and remove all traces of access, providing the system administrator with no way of identifying the individual or group responsible. If the log data is sent remotely at the point of access, these remote logs can then be reconciled with local data to identify tampered and altered files. The logs can also be used as evidence in any subsequent prosecution."
      info        : "Note: Update the value of SYSLOG_SERVER_IP_ADDRESS with the appropriate value for the local environment."
      solution    : "Create a remote host entry in /etc/syslog.conf to capture all other output of level info or higher (enter the remote host IP address in the example below)-

 printf '*.info;auth.none\\tSYSLOG_SERVER_IP_ADDRESS
' >> /etc/syslog.conf

Refresh syslogd to force the daemon to read the edited /etc/syslog.conf-

 refresh -s syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.5.3,SANS-CSC|14-7,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*[\\*][\\.]info;auth[\\.]none	"
# Note: Variable @SYSLOG_SERVER_IP_ADDRESS@ replaced with "192.168.1.1" in field "expect".
      expect      : "^[\\s]*[\\*][\\.]info;auth[\\.]none	+192.168.1.1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.1.3 Configuring syslog - remote messages"
      info        : "This recommendation prevents the local syslogd daemon from accepting messages from other hosts on the network.

Apart from a central syslog server, all other hosts should not accept remote syslog messages. By default the syslogd daemon accepts all remote syslog messages as no authentication is required. This means that a hacker could flood a server with syslog messages and potentially fill up the /var filesystem."
      solution    : "If the server does not act as a central syslog server, suppress the logging of messages originating from remote servers-

 chssys -s syslogd -a '-r'

Re-cycle syslogd to activate the configuration change-

 stopsrc -s syslogd
 startsrc -s syslogd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lssrc -S -s syslogd"
      expect      : "^[\\s]*syslogd:[^:]*:[^:]*-r[^:]*:"
    </custom_item>

##
## 4.2 - Non AIX Security Expert Recommendations - Secure Remote Access
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.2.1 Configuring SSH - installation - openssh"
      info        : "The recommendation is to install OpenSSH and OpenSSL libraries from the expansion pack media, or the IBM supported packages downloaded from the internet.

This is the preferred mechanism for remote client access as it provides socket level encryption, via OpenSSL. If any clear text password service is required for legacy connections the two services may sit side by side, with SSH utilized wherever possible.  Ideally, SSH should be the only available remote access mechanism.

If the software is not available from the expansion pack media, download from the following locations.
 o OpenSSH - http://sourceforge.net/projects/openssh-aix/files/?source=navbar
 o OpenSSL - https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp

NOTE- A login is required to download OpenSSL.

If the Secure By Default option was selected when installing AIX, both SSH and SSL will already have been installed as part of this process."
      solution    : "Place the OpenSSH and OpenSSL software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f openssl,openssh.license,openssh.base,openssh.man.en_US,openssh.msg.en_US -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,HIPAA|164.312(e)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,LEVEL|2S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,PCI-DSS|2.2.3,PCI-DSS|2.3,SANS-CSC|3-7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep \"openssh\""
      expect      : "^[\\s]+openssh\\.base\\."
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.2.1 Configuring SSH - installation - openssl"
      info        : "The recommendation is to install OpenSSH and OpenSSL libraries from the expansion pack media, or the IBM supported packages downloaded from the internet.

This is the preferred mechanism for remote client access as it provides socket level encryption, via OpenSSL. If any clear text password service is required for legacy connections the two services may sit side by side, with SSH utilized wherever possible.  Ideally, SSH should be the only available remote access mechanism.

If the software is not available from the expansion pack media, download from the following locations.
 o OpenSSH - http://sourceforge.net/projects/openssh-aix/files/?source=navbar
 o OpenSSL - https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp

NOTE- A login is required to download OpenSSL.

If the Secure By Default option was selected when installing AIX, both SSH and SSL will already have been installed as part of this process."
      solution    : "Place the OpenSSH and OpenSSL software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f openssl,openssh.license,openssh.base,openssh.man.en_US,openssh.msg.en_US -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,HIPAA|164.312(e)(1),ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,LEVEL|2S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,PCI-DSS|2.2.3,PCI-DSS|2.3,SANS-CSC|3-7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep \"openssl\""
      expect      : "^[\\s]+openssl\\.base[\\s]*"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "4.2.1 Configuring SSH - installation - start at IPL"
      info        : "The recommendation is to install OpenSSH and OpenSSL libraries from the expansion pack media, or the IBM supported packages downloaded from the internet.

This is the preferred mechanism for remote client access as it provides socket level encryption, via OpenSSL. If any clear text password service is required for legacy connections the two services may sit side by side, with SSH utilized wherever possible.  Ideally, SSH should be the only available remote access mechanism.

If the software is not available from the expansion pack media, download from the following locations.
 o OpenSSH - http://sourceforge.net/projects/openssh-aix/files/?source=navbar
 o OpenSSL - https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp

NOTE- A login is required to download OpenSSL.

If the Secure By Default option was selected when installing AIX, both SSH and SSL will already have been installed as part of this process."
      solution    : "Place the OpenSSH and OpenSSL software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f openssl,openssh.license,openssh.base,openssh.man.en_US,openssh.msg.en_US -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,PCI-DSS|2.3,SANS-CSC|3-7,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.d/rc2.d/Ssshd"
      owner       : "root"
      mask        : "222"
      group       : "system"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.2.8 Configuring SSH - disallow host based authentication"
      info        : "The recommendation is to edit the /etc/ssh/sshd_config file to ensure that host-based authentication is disallowed.

Using host-based authentication, any user on a trusted host can log into another host on which this feature is enabled. Since this feature depends only on system authentication and not on user authentication, it must be disabled."
      solution    : "Edit the /etc/ssh/sshd_config file to ensure that host based authentication is disallowed-

 vi /etc/ssh/sshd_config

Replace-

 #HostbasedAuthentication no

With-

 HostbasedAuthentication no

Re-cycle the sshd daemon to pick up the configuration changes-

 stopsrc -s sshd
 startsrc -s sshd"
      reference   : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CSF|PR.AC-1,HIPAA|164.312(d),ITSG-33|AC-14,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.3,NESA|T5.6.1,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*HostbasedAuthentication[\\s]+no[\\s]*$"
      expect      : "^[\\s]*HostbasedAuthentication[\\s]+no[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.2.10 Configuring SSH - removal of .shosts files"
      info        : "The recommendation is to remove any existing .shosts files from all user home directories.

The existence of .shosts files in a user home directory, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method, these files, if they exist, should be removed."
      solution    : "List out all of the existing .shost files-

 find / -name '.shosts' -print

Review the list of .shost files and remove them individually, or all at once-

 Individually- rm (full pathname)
 All at once- find / -name '.shosts' -exec rm {} \;"
      reference   : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.3,NESA|T5.6.1,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/awk -F: '{if (system(\"test -f \"$6\"/.shosts\") == 0) { print $6; f++; } } END { if(f<1) print \"none\" }' /etc/passwd"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK_NOT
      description : "4.2.11 Configuring SSH - removal of /etc/shosts.equiv"
      info        : "The recommendation is to remove the /etc/shosts.equiv file.

The existence of a /etc/shosts.equiv file, combined with the correct SSH parameter can allow passwordless authentication between servers. As previous recommendations in this section disable this authentication method these files, if they exist, should be removed."
      solution    : "Review the content of the /etc/shosts.equiv file-

 cat /etc/shosts.equiv

If the file exists-

 rm /etc/shosts.equiv"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/shosts.equiv"
    </custom_item>

##
## 4.3 - Non AIX Security Expert Recommendations - Sendmail Configuration
##
##
## 4.4 - Non AIX Security Expert Recommendations - Common Desktop Environment (CDE)
##

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "AIX"
          type        : CMD_EXEC
          description : "Verify CDE is installed."
          cmd         : "/usr/bin/lslpp -L | /usr/bin/grep -i CDE"
          expect      : "^[\\s]*X11\\.Dt\\."
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "AIX"
          type        : CMD_EXEC
          description : "4.4.1 CDE - de-installing CDE"
          info        : "The recommendation is to de-install CDE from the system, assuming that it is not required and is already installed.

CDE has a history of security problems and should be disabled.NOTE- If CDE is required, it is vital to patch the software and consider TCP Wrappers to further enhance security."
          solution    : "Identity if CDE is already installed-

 lslpp -L | grep -i CDE

If there are CDE filesets installed - de-install them if CDE is not required.

For each fileset preview the de-installation-

 installp -up <fileset name>

Review the fileset removal preview output, paying particular attention to the other pre-requisites that will also be removed. Typically only X11.Dt filesets should be de-installed as pre-requisites.

Once reviewed, de-install the fileset and pre-requisites-

 installp -ug <fileset name>

NOTE- Repeat until all CDE filesets are de-installed"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|2S,NIAv2|SS13a,PCI-DSS|2.2.5,SANS-CSC|11-4,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          cmd         : "/usr/bin/lslpp -L | /usr/bin/grep -i CDE | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'"
          expect      : "^none$"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK_NOT
          description : "4.4.2 CDE - disabling dtlogin"
          info        : "Do not start CDE automatically on system boot.

The implementation of the customized aixpert XML file disables CDE if there is not a graphical console attached to the system. If there is a graphical console or the XML file has not been executed, consider disabling CDE anyway."
          solution    : "Disable CDE start up-

 /usr/dt/bin/dtconfig -d

NOTE- If CDE is not installed the command will not be found"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|2S,NIAv2|SS13a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/inittab"
          regex       : "^[\\s]*dt:"
          expect      : "^[\\s]*dt:"
        </custom_item>

        <custom_item>
          system        : "AIX"
          type          : FILE_CONTENT_CHECK
          description   : "4.4.4 CDE - remote GUI login disabled"
          info          : "The XDMCP service allows remote systems to start local X login sessions.

The XDMCP service should be disabled unless there is a requirement to allow remote X servers to start login sessions. If the ability to host remote X servers is not required, disable the service."
          solution      : "Copy /usr/dt/config/Xconfig to /etc/dt/config if it does not already exist-

 ls -l /etc/dt/config/Xconfig

If the file does not exist, create it-

 mkdir -p /etc/dt/config
 cp /usr/dt/config/Xconfig /etc/dt/config

Disable remote X sessions from being started-

 vi /etc/dt/config/Xconfig

Replace-

 # Dtlogin.requestPort: 0

With-

 Dtlogin.requestPort: 0"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/528"
          file          : "/etc/dt/config/Xconfig"
          regex         : "DtLogin.requestPort"
          expect        : "^[\\s]*DtLogin[\\.]requestPort:[\\s]+0[\\s]*$"
          file_required : NO
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "4.4.1 CDE - de-installing CDE"
          info        : "The recommendation is to de-install CDE from the system, assuming that it is not required and is already installed.

        CDE has a history of security problems and should be disabled.NOTE- If CDE is required, it is vital to patch the software and consider TCP Wrappers to further enhance security."
          solution    : "Identity if CDE is already installed-

        lslpp -L | grep -i CDE

        If there are CDE filesets installed - de-install them if CDE is not required.

        For each fileset preview the de-installation-

        installp -up <fileset name>

        Review the fileset removal preview output, paying particular attention to the other pre-requisites that will also be removed. Typically only X11.Dt filesets should be de-installed as pre-requisites.

        Once reviewed, de-install the fileset and pre-requisites-

        installp -ug <fileset name>

        NOTE- Repeat until all CDE filesets are de-installed"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|2S,NIAv2|SS13a,PCI-DSS|2.2.5,SANS-CSC|11-4,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.4.2 CDE - disabling dtlogin"
          info        : "Do not start CDE automatically on system boot.

        The implementation of the customized aixpert XML file disables CDE if there is not a graphical console attached to the system. If there is a graphical console or the XML file has not been executed, consider disabling CDE anyway."
          solution    : "Disable CDE start up-

        /usr/dt/bin/dtconfig -d

        NOTE- If CDE is not installed the command will not be found"
          reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,LEVEL|2S,NIAv2|SS13a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.4.4 CDE - remote GUI login disabled"
          info        : "The XDMCP service allows remote systems to start local X login sessions.

        The XDMCP service should be disabled unless there is a requirement to allow remote X servers to start login sessions. If the ability to host remote X servers is not required, disable the service."
          solution    : "Copy /usr/dt/config/Xconfig to /etc/dt/config if it does not already exist-

        ls -l /etc/dt/config/Xconfig

        If the file does not exist, create it-

        mkdir -p /etc/dt/config
        cp /usr/dt/config/Xconfig /etc/dt/config

        Disable remote X sessions from being started-

        vi /etc/dt/config/Xconfig

        Replace-

        # Dtlogin.requestPort: 0

        With-

        Dtlogin.requestPort: 0"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>
      </else>
    </if>

##
## 4.5 - Non AIX Security Expert Recommendations - NFS
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.5.1 NFS - de-install NFS client"
      info        : "De-install NFS client if the server does not remotely mount NFS shares.

NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed."
      solution    : "Ensure that there are no current NFS client mounts-

 mount |grep 'nfs'
 cat /etc/filesystems |grep 'nfs'

The above commands should yield no output.De-install the NFS client software-
 installp -u bos.net.nfs.client"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.5,SANS-CSC|11-4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.net.nfs.client | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.5.2 NFS - de-install NFS server - server installed"
      info        : "De-install NFS server if the server does not act as an NFS server to remote clients.

NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed."
      solution    : "Ensure that there are no current NFS exports-

 cat /etc/exports

The above command should yield no output. Or the file should not exist.

De-install the NFS sever software-

 installp -u bos.net.nfs.server"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.net.nfs.server | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK_NOT
      description : "4.5.2 NFS - de-install NFS server - /etc/exports"
      info        : "De-install NFS server if the server does not act as an NFS server to remote clients.

NFS is frequently exploited to gain unauthorized access to file and directories. Unless the server needs to act as an NFS server or client, the filesets should be de-installed."
      solution    : "Ensure that there are no current NFS exports-

 cat /etc/exports

If there was an empty /etc/exports file, remove it-

 rm /etc/exports"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/exports"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "AIX"
          type        : FILE_CHECK
          description : "Verify if /etc/exports exists"
          file        : "/etc/exports"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK
          description : "4.5.5 NFS - restrict NFS access"
          info        : "Only allow explicitly defined host access to NFS exported filesystems and directories.

The NFS server should be configured to only allow explicitly defined hosts to mount filesystems from the server. If an unauthorized host is denied the permission to mount a filesystem, then the unauthorized users on that host will not be able to access the server's files.The default value of access allows any machine to mount any exported filesystems/directories."
          solution    : "Ensure that all exports defined in /etc/exports have explicit client access options which clearly define the host or hosts allowed access-

Review the content of /etc/exports and that all exports have explicit access lists-

 cat /etc/exports

Ensure that each NFS export has an explicit access line, for example-

 /usr/spool/mail -access=symmachine

If the file is updated, to reflect client access changes, update the current NFS export options-

 exportfs -a"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/exports"
          regex       : "^[\\s]*[^#]+"
          expect      : "^[\\s]*[^#]+access=[A-Za-z1-2]"
          required    : NO
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK
          description : "4.5.7 NFS - secure NFS"
          info        : "For each NFS export, ensure that the secure option is selected.

Secure NFS uses DES encryption or Kerberos to authenticate hosts involved in RPC transactions. RPC is a protocol used by NFS to communicate requests between hosts.

Secure NFS mitigates attempts by an attacker to spoof RPC requests by encrypting the time stamp in the RPC requests. A receiver successfully decrypts the time stamp and confirms that it is correct. This serves as a confirmation that the RPC request came from a trusted host."
          solution    : "Use smitty to change/validate this value for all NFS exported filesystems-

 smitty chnfsexp

For each filesystem, as defined in the F4 list. There are five security methods which can be used to define different security access methods for different clients-

 Security method 1 [sys,krb5p,krb5i,krb5,d> +
 * Mode to export directory read-write +
 Hostname list. If exported read-mostly []
 Hosts & netgroups allowed client access []
 Hosts allowed root access []

The security method options are-

 sys - UNIX authentication
 dh - DES authentication
 none - Use the anonymous ID if it has a value other than -1
 krb5 - Kerberos. Authentication only
 krb5i - Kerberos. Authentication and integrity
 krb5p - Authentication, integrity, and privacy

Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options-

 exportfs -a"
          reference   : "800-53|SI-7(6),CSF|PR.DS-6,LEVEL|2S,PCI-DSS|2.2.4,SWIFT-CSCv1|6.2"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/exports"
          regex       : "^[\\s]*[^#]+"
          expect      : "^[\\s]*[^#]+sec=(sys|dh|krb5|krb5i|krb5p)"
          required    : NO
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "4.5.5 NFS - restrict NFS access"
          info        : "Only allow explicitly defined host access to NFS exported filesystems and directories.

  The NFS server should be configured to only allow explicitly defined hosts to mount filesystems from the server. If an unauthorized host is denied the permission to mount a filesystem, then the unauthorized users on that host will not be able to access the server's files.The default value of access allows any machine to mount any exported filesystems/directories."
          solution    : "Ensure that all exports defined in /etc/exports have explicit client access options which clearly define the host or hosts allowed access-

  Review the content of /etc/exports and that all exports have explicit access lists-

  cat /etc/exports

  Ensure that each NFS export has an explicit access line, for example-

  /usr/spool/mail -access=symmachine

  If the file is updated, to reflect client access changes, update the current NFS export options-

  exportfs -a"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.5.7 NFS - secure NFS"
          info        : "For each NFS export, ensure that the secure option is selected.

  Secure NFS uses DES encryption or Kerberos to authenticate hosts involved in RPC transactions. RPC is a protocol used by NFS to communicate requests between hosts.

  Secure NFS mitigates attempts by an attacker to spoof RPC requests by encrypting the time stamp in the RPC requests. A receiver successfully decrypts the time stamp and confirms that it is correct. This serves as a confirmation that the RPC request came from a trusted host."
          solution    : "Use smitty to change/validate this value for all NFS exported filesystems-

  smitty chnfsexp

  For each filesystem, as defined in the F4 list. There are five security methods which can be used to define different security access methods for different clients-

  Security method 1 [sys,krb5p,krb5i,krb5,d> +
  * Mode to export directory read-write +
  Hostname list. If exported read-mostly []
  Hosts & netgroups allowed client access []
  Hosts allowed root access []

  The security method options are-

  sys - UNIX authentication
  dh - DES authentication
  none - Use the anonymous ID if it has a value other than -1
  krb5 - Kerberos. Authentication only
  krb5i - Kerberos. Authentication and integrity
  krb5p - Authentication, integrity, and privacy

  Once all exported filesystems have been successfully validated or changed, re-export the filesystems and directories to activate the new options-

  exportfs -a"
          reference   : "800-53|SI-7(6),CSF|PR.DS-6,LEVEL|2S,PCI-DSS|2.2.4,SWIFT-CSCv1|6.2"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>
      </else>
    </if>

##
## 4.6 - Non AIX Security Expert Recommendations - NIS
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.6.1 NIS - de-install NIS client"
      info        : "If NIS is not used in the environment, disable the NIS client and de-install the software.

As NIS is extremely insecure, the NIS client packages must be removed from the system unless absolutely needed."
      solution    : "Ensure that all of the NIS daemons are inactive-

 stopsrc -g yp

De-install the NIS client software-

 installp -u bos.net.nis.client"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.5,SANS-CSC|11-4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.net.nis.client | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.6.2 NIS - de-install NIS server"
      info        : "If NIS is not used in the environment, disable the NIS server and de-install the software.

As NIS is extremely insecure, the NIS server packages must be removed from the system unless absolutely needed."
      solution    : "Ensure that all of the NIS daemons are inactive-
 stopsrc -g yp

De-install the NIS server software-

 installp -u bos.net.nis.server"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.net.nis.server | /usr/bin/awk '{ print } END { if (NR==0) print \"none\" }'"
      expect      : "^none$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.6.3 NIS - remove NIS markers from password and group files - /etc/passwd"
      info        : "If NIS has been de-installed in the environment, or has historically been used, ensure the + markers are removed from/etc/passwd and /etc/group.

The + entries in /etc/passwd and /etc/group were used as markers to insert data from a NIS map. These entries may provide an avenue for attackers to gain privileged access on the system. The + entries must be deleted if they still exist."
      solution    : "Examine the /etc/passwd and /etc/group files-

 grep '^+' /etc/passwd /etc/group

If the above command yields output, delete the + line-

 vi /etc/passwd
 vi /etc/group"
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,LEVEL|2S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|2.2.4,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/passwd"
      regex       : "^\\+"
      expect      : "^\\+"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.6.3 NIS - remove NIS markers from password and group files - /etc/group"
      info        : "If NIS has been de-installed in the environment, or has historically been used, ensure the + markers are removed from/etc/passwd and /etc/group.

The + entries in /etc/passwd and /etc/group were used as markers to insert data from a NIS map. These entries may provide an avenue for attackers to gain privileged access on the system. The + entries must be deleted if they still exist."
      solution    : "Examine the /etc/passwd and /etc/group files-

 grep '^+' /etc/passwd /etc/group

If the above command yields output, delete the + line-

 vi /etc/passwd
 vi /etc/group"
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,LEVEL|2S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,PCI-DSS|2.2.4,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/group"
      regex       : "^\\+"
      expect      : "^\\+"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "AIX"
          type        : CMD_EXEC
          description : "Check that NIS is installed"
          cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.net.nis.server | /usr/bin/awk '{ print } END { if (NR==0) print \"nis server is not installed\" }'"
          expect      : "^[\\s]*bos\.net\.nis\.server[\\s]+"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "AIX"
          type        : FILE_CHECK
          description : "4.6.4 NIS - restrict NIS server communication - file permissions"
          info        : "If NIS must be used in the environment, limit access to the NIS data to specific subnets.

By default the NIS server will authenticate all IP addresses if the /var/yp/securenets file does not exist, or exists without any subnets defined. The /var/yp/securenets file contains a list of subnets that are considered trusted and are allowed to access NIS data using the ypservand ypxfrd daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the /etc/passwdfile. Hence, it is recommended that the /var/yp/securenets file is configured to restrict access."
          solution    : "Create and secure the /var/yp/securenets file (if it does not already exist)-

 touch /var/yp/securenets
 chmod u=rw,go= /var/yp/securenets
 chown root:system /var/yp/securenets

Stop and start NIS to implement the configuration changes-
 stopsrc -g yp
 startsrc -g yp"
          reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/var/yp/securenets"
          owner       : "root"
          mask        : "177"
          group       : "system"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK
          description : "4.6.4 NIS - restrict NIS server communication - review contents"
          info        : "If NIS must be used in the environment, limit access to the NIS data to specific subnets.

By default the NIS server will authenticate all IP addresses if the /var/yp/securenets file does not exist, or exists without any subnets defined. The /var/yp/securenets file contains a list of subnets that are considered trusted and are allowed to access NIS data using the ypservand ypxfrd daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the /etc/passwdfile. Hence, it is recommended that the /var/yp/securenets file is configured to restrict access."
          solution    : "Edit the file-

 vi /var/yp/securenets

Add the allowed subnets-255.255.255.0 128.311.10.0

NOTE- The format of the file is netmask netaddr as shown in the example above. Explicitly define all valid network subnets (one entry per line).

Stop and start NIS to implement the configuration changes-
 stopsrc -g yp
 startsrc -g yp"
          reference   : "800-171|3.1.3,800-53|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|AC-4,LEVEL|2S,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSS|2.2.4,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/var/yp/securenets"
          regex       : "^[\\s]*[^#]+"
          expect      : "^[\\s]*[0-9]{1,3}[\\.][0-9]{1,3}[\\.][0-9]{1,3}[\\.][0-9]{1,3}[\\s]+[0-9]{1,3}[\\.][0-9]{1,3}[\\.][0-9]{1,3}[\\.][0-9]{1,3}[\\s]*$"
          required    : YES
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "4.6.4 NIS - restrict NIS server communication - file permissions"
          info        : "If NIS must be used in the environment, limit access to the NIS data to specific subnets.

  By default the NIS server will authenticate all IP addresses if the /var/yp/securenets file does not exist, or exists without any subnets defined. The /var/yp/securenets file contains a list of subnets that are considered trusted and are allowed to access NIS data using the ypservand ypxfrd daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the /etc/passwdfile. Hence, it is recommended that the /var/yp/securenets file is configured to restrict access."
          solution    : "Create and secure the /var/yp/securenets file (if it does not already exist)-

  touch /var/yp/securenets
  chmod u=rw,go= /var/yp/securenets
  chown root:system /var/yp/securenets

  Stop and start NIS to implement the configuration changes-
  stopsrc -g yp
  startsrc -g yp"
          reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.6.4 NIS - restrict NIS server communication - review contents"
          info        : "If NIS must be used in the environment, limit access to the NIS data to specific subnets.

  By default the NIS server will authenticate all IP addresses if the /var/yp/securenets file does not exist, or exists without any subnets defined. The /var/yp/securenets file contains a list of subnets that are considered trusted and are allowed to access NIS data using the ypservand ypxfrd daemons. This is a user-created file that resides on a NIS master server and any slave servers. Without configuring this file, anyone with knowledge of the NIS server address and the domain name, can obtain NIS served data, including the contents of the /etc/passwdfile. Hence, it is recommended that the /var/yp/securenets file is configured to restrict access."
          solution    : "Edit the file-

  vi /var/yp/securenets

  Add the allowed subnets-255.255.255.0 128.311.10.0

  NOTE- The format of the file is netmask netaddr as shown in the example above. Explicitly define all valid network subnets (one entry per line).

  Stop and start NIS to implement the configuration changes-
  stopsrc -g yp
  startsrc -g yp"
          reference   : "800-171|3.1.3,800-53|AC-4,CN-L3|8.1.10.2(c),CSF|DE.AE-1,CSF|ID.AM-3,CSF|PR.AC-4,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ITSG-33|AC-4,LEVEL|2S,NESA|T4.2.1,NESA|T4.5.1,NESA|T4.5.3,NESA|T4.5.4,NESA|T5.4.6,NESA|T5.7.2,NESA|T7.5.2,NESA|T7.6.4,NIAv2|GS11a,NIAv2|GS12a,NIAv2|GS14a,NIAv2|GS15a,NIAv2|GS16a,NIAv2|NS13a,NIAv2|NS13b,NIAv2|NS13c,NIAv2|NS14,NIAv2|SS23,NIAv2|SS27a,NIAv2|SS27b,NIAv2|SS32,PCI-DSS|2.2.4,SWIFT-CSCv1|2.1,SWIFT-CSCv1|2.4"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>
      </else>
    </if>

##
## 4.7 - Non AIX Security Expert Recommendations - SNMP
##

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "AIX"
          type        : FILE_CHECK
          description : "Verify SNMP configuration file exists."
          file        : "/etc/snmpd.conf"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK_NOT
          description : "4.7.1 SNMP - disable private community string"
          info        : "If snmpd is required within the environment, disable the private community string.

In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security."
          solution    : "Create a backup of /etc/snmpd.conf-

 cp -p /etc/snmpd.conf /etc/snmpd.conf.pre_cis

Edit the file-

 vi /etc/snmpd.conf

Comment out the private entry-

 #community private 128.0.0.1 255.255.255.255 readWrite"
          reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSS|2.1,SANS-CSC|12-4"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/snmpd.conf"
          regex       : "^[\\s]*community[\\s]+private([\\s]+.*)*[\\s]*$"
          expect      : "^[\\s]*community[\\s]+private([\\s]+.*)*[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK_NOT
          description : "4.7.2 SNMP - disable system community string"
          info        : "If snmpd is required within the environment, disable the system community string.

In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security."
          solution    : "Edit the file-

 vi /etc/snmpd.conf

Comment out the system entry-

 #community system 127.0.0.1 255.255.255.255 readWrite 1.17.2"
          reference   : "800-171|3.1.5,800-53|AC-6,CIP|007-6-R1,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/snmpd.conf"
          regex       : "^[\\s]*community[\\s]+system([\\s]+.*)*[\\s]*$"
          expect      : "^[\\s]*community[\\s]+system([\\s]+.*)*[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK_NOT
          description : "4.7.3 SNMP - disable public community string"
          info        : "If snmpd is required within the environment, disable or change the public community string.

The public community string can be polled by remote SNMP devices and pertinent information can be read or changed on the host. The public community string should but commented out, or if SNMP is a required service the public community name should be changed to be a combination of letters, numbers and special characters to enhance security."
          solution    : "Edit the file-

 vi /etc/snmpd.conf

Comment out the public entry-

 #community public"
          reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R1,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/snmpd.conf"
          regex       : "^[\\s]*community[\\s]+public([\\s]+.*)*[\\s]*$"
          expect      : "^[\\s]*community[\\s]+public([\\s]+.*)*[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK_NOT
          description : "4.7.4 SNMP - disable Readwrite community access"
          info        : "If snmpd is required within the environment, disable readWrite permissions for all active community strings.

If SNMP is required, none of the available community strings should have global readWrite permissions defined. This would allow any remote client to query and to set system configuration parameters. SNMP readWrite communities must be disabled unless absolutely necessary. If a readWrite community is enabled, then access must be granted to only trusted machines in your network. As SNMP uses community names as part of authentication, you must ensure that all community names are greater than six characters and is a mix of characters, numbers, and special characters."
          solution    : "Identify if there are any currently configured community strings-

 grep '^community[[-blank-]]' /etc/snmpd.conf

If there are active community strings, edit the configuration file-

 vi /etc/snmpd.conf

Replace all instances of-

 community <community name> <IP addresses> <netmask> [ readWrite <view>]

With-

 community <community name> <IP addresses> <netmask> [ readOnly <view>]"
          reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/snmpd.conf"
          regex       : "^[\\s]*community[\\s]+[^#]*[\\s]+readWrite[\\s]+"
          expect      : "^[\\s]*community[\\s]+[^#]*[\\s]+readWrite[\\s]+"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK
          description : "4.7.5 SNMP - restrict community access"
          info        : "If snmpd is required within the environment, implement IP access restrictions on the available community strings.

If SNMP is required, IP access restrictions should be put into place to limit which hosts or networks subnets are able to remotely poll the server."
          solution    : "Identify if there are any currently configured community strings-

 grep '^community[[-blank-]]' /etc/snmpd.conf

If there are active community strings, edit the configuration file-

 vi /etc/snmpd.conf

Implement IP access restrictions to ALL of the available community names e.g.-

 community tivoli 192.132.10.0 255.255.255.0 readOnly

The format of each line should reflect-

 community <community name> <IP addresses> <netmask> [ <permissions> <view>]"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/snmpd.conf"
          regex       : "^[\\s]*community[\\s]+"
          expect      : "^[\\s]*community[\\s]+[^\\s#]+[\\s]+[0-9A-Fa-f:\\.]{7,128}[\\s]+[0-9A-Fa-f:\\.]{1,15}([\\s]+.*)*[\\s]*$"
          required    : NO
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "4.7.1 SNMP - disable private community string"
          info        : "If snmpd is required within the environment, disable the private community string.

        In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security."
          solution    : "Create a backup of /etc/snmpd.conf-

        cp -p /etc/snmpd.conf /etc/snmpd.conf.pre_cis

        Edit the file-

        vi /etc/snmpd.conf

        Comment out the private entry-

        #community private 128.0.0.1 255.255.255.255 readWrite"
          reference   : "800-171|3.5.2,800-53|IA-5,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSS|2.1,SANS-CSC|12-4"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.7.2 SNMP - disable system community string"
          info        : "If snmpd is required within the environment, disable the system community string.

        In AIX, two SNMP community names, private and system, are enabled with read/write privileges, but are allowed access only from localhost connections. As these SNMP names are the default, they must not be used. Any SNMP community name should be a combination of letters, numbers and special characters to enhance security."
          solution    : "Edit the file-

        vi /etc/snmpd.conf

        Comment out the system entry-

        #community system 127.0.0.1 255.255.255.255 readWrite 1.17.2"
          reference   : "800-171|3.1.5,800-53|AC-6,CIP|007-6-R1,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.7.3 SNMP - disable public community string"
          info        : "If snmpd is required within the environment, disable or change the public community string.

        The public community string can be polled by remote SNMP devices and pertinent information can be read or changed on the host. The public community string should but commented out, or if SNMP is a required service the public community name should be changed to be a combination of letters, numbers and special characters to enhance security."
          solution    : "Edit the file-

        vi /etc/snmpd.conf

        Comment out the public entry-

        #community public"
          reference   : "800-171|3.5.2,800-53|IA-5,CIP|007-6-R1,CN-L3|7.1.2.7(d),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,LEVEL|2S,NESA|T5.2.1,NESA|T5.2.3,NESA|T5.5.2,NESA|T5.5.3,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.7.4 SNMP - disable Readwrite community access"
          info        : "If snmpd is required within the environment, disable readWrite permissions for all active community strings.

        If SNMP is required, none of the available community strings should have global readWrite permissions defined. This would allow any remote client to query and to set system configuration parameters. SNMP readWrite communities must be disabled unless absolutely necessary. If a readWrite community is enabled, then access must be granted to only trusted machines in your network. As SNMP uses community names as part of authentication, you must ensure that all community names are greater than six characters and is a mix of characters, numbers, and special characters."
          solution    : "Identify if there are any currently configured community strings-

        grep '^community[[-blank-]]' /etc/snmpd.conf

        If there are active community strings, edit the configuration file-

        vi /etc/snmpd.conf

        Replace all instances of-

        community <community name> <IP addresses> <netmask> [ readWrite <view>]

        With-

        community <community name> <IP addresses> <netmask> [ readOnly <view>]"
          reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.7.5 SNMP - restrict community access"
          info        : "If snmpd is required within the environment, implement IP access restrictions on the available community strings.

        If SNMP is required, IP access restrictions should be put into place to limit which hosts or networks subnets are able to remotely poll the server."
          solution    : "Identify if there are any currently configured community strings-

        grep '^community[[-blank-]]' /etc/snmpd.conf

        If there are active community strings, edit the configuration file-

        vi /etc/snmpd.conf

        Implement IP access restrictions to ALL of the available community names e.g.-

        community tivoli 192.132.10.0 255.255.255.0 readOnly

        The format of each line should reflect-

        community <community name> <IP addresses> <netmask> [ <permissions> <view>]"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.1,SANS-CSC|12-4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>
      </else>
    </if>

##
## 4.8 - Non AIX Security Expert Recommendations - Securing inetd
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.8.1 inetd - disabling inetd"
      info        : "If all of services run and managed by inetd are disabled, disable the inetd daemon itself.

If all inetd services are disabled, then there is no need to start the daemon at boot time. An administrator can manually start the inetd service post-IPL, if any of the inetd controlled services are required."
      solution    : "Review any active inetd services-

 refresh -s inetd
 lssrc -ls inetd

NOTE- If there are active services and the services are required, do not disable inetd. Skip to the next section and consider the implementation of TCP Wrappers to secure access to these active services. If the active services are not required disable them via the chsubserver command.

Disable inetd if there are no active services-

 chrctcp -d inetd
 stopsrc -s inetd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.5,SANS-CSC|11-4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/inetd"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/inetd"
    </custom_item>

##
## 4.9 - Non AIX Security Expert Recommendations - Portmap Lockdown
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.9.1 /etc/rc.tcpip - portmap"
      info        : "If all RPC services are disabled, disable the portmap daemon itself.

If all RPC services are disabled, then there is no need to start the portmap daemon at boot time. An administrator can manually start portmap post-IPL, if any of the RPC services are required."
      solution    : "Review any active RPC services-

 rpcinfo -p localhost

NOTE- If there are active RPC services and the services are required, do not disable portmap.

Disable portmap if there are no active RPC services-

 chrctcp -d portmap
 stopsrc -s portmap"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/rc.tcpip"
      regex       : "^[\\s]*start[\\s]+/usr/sbin/portmap"
      expect      : "^[\\s]*start[\\s]+/usr/sbin/portmap"
    </custom_item>

##
## 4.10 - Non AIX Security Expert Recommendations - TCP Wrappers
##

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "AIX"
          type        : CMD_EXEC
          description : "Verify TCP Wrappers is installed."
          cmd         : "/usr/bin/lslpp -L | /usr/bin/grep \"netsec.options\" | /usr/bin/grep \"tcpwrapper\""
          expect      : "^[\\s]+netsec[\\.]options[\\.]tcpwrapper[\\.]base"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "AIX"
          type        : CMD_EXEC
          description : "4.10.1 TCP Wrappers - installing TCP Wrappers"
          info        : "The recommendation is to install and configure TCP Wrappers if there are active inetd controlled services on the system.

TCP Wrappers is a freely available IP packet filtering facility. It provides for greater and more specific control over local network services and the hosts that are allowed to access them. It also makes use of the standard syslog facility to track local network use."
          solution    : "Identity any active inetd services-\
 refresh -s inetd
 lssrc -ls inetd

If there are any active TCP or UDP services, download and install the TCP Wrappers software- TCP Wrappers is bundled on the AIX media expansion cdrom.

Alternatively, the source code may be downloaded and compiled from- ftp://ftp.porcupine.org/pub/security.

NOTE- Ensure that the latest version is downloaded.

The installation example below assumes that the AIX media expansion pack cdrom has been used as the source of the software.

Place the TCP Wrappers software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f netsec.options.tcpwrapper,netsec.options.idprotocol -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
          reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,CSF|PR.PT-3,HIPAA|164.312(e)(1),ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
          see_also    : "https://workbench.cisecurity.org/files/528"
          cmd         : "/usr/bin/lslpp -L | /usr/bin/grep \"netsec.options\""
          expect      : "^[\\s]+netsec[\\.]options[\\.]tcpwrapper[\\.]base"
        </custom_item>

        <custom_item>
          system      : "AIX"
          type        : FILE_CONTENT_CHECK
          description : "4.10.4 TCP Wrappers - wrapping inetd services"
          info        : "If TCP Wrappers have been installed because there are active inetd services, these services must utilize TCP Wrappers to restrict host access.

By limiting access to the server, you reduce your exposure to threats from attackers on remote systems. Therefore any active inetd controlled service which cannot be disabled should be restricted so that it can only be used by trusted hosts."
          solution    : "Prior to implementing this recommendation it is important that hosts.deny and hosts.allow files have been created.

For each active TCP and UDP inetd service, change the entry in /etc/inetd.conf, so that tcpd is executed.

Copy the current /etc/inetd.conf file for reversion purposes-

 cp -p /etc/inetd.conf /etc/inetd.conf.pre_tcp_wrappers

For example, to utilize TCP Wrappers on the telnet service, edit-

 vi /etc/inetd.conf

Change-

 telnet stream tcp6 nowait root /usr/sbin/telnetd telnetd

To-

 telnet stream tcp nowait root /usr/sbin/tcpd telnetd

Repeat the change for other services."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,HIPAA|164.312(e)(1),ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
          file        : "/etc/inetd.conf"
          regex       : "^[\\s]*[^#][^\\s]+"
          expect      : "^[\\s]*[^\\s]+[\\s]+[^\\s]+[\\s]+[^\\s]+[\\s]+[^\\s]+[\\s]+[^\\s]+[\\s]+/usr/sbin/tcpd[\\s]+.*[\\s]*$"
          required    : NO
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "4.10.1 TCP Wrappers - installing TCP Wrappers"
          info        : "The recommendation is to install and configure TCP Wrappers if there are active inetd controlled services on the system.

  TCP Wrappers is a freely available IP packet filtering facility. It provides for greater and more specific control over local network services and the hosts that are allowed to access them. It also makes use of the standard syslog facility to track local network use."
          solution    : "Identity any active inetd services-\
  refresh -s inetd
  lssrc -ls inetd

  If there are any active TCP or UDP services, download and install the TCP Wrappers software- TCP Wrappers is bundled on the AIX media expansion cdrom.

  Alternatively, the source code may be downloaded and compiled from- ftp://ftp.porcupine.org/pub/security.

  NOTE- Ensure that the latest version is downloaded.

  The installation example below assumes that the AIX media expansion pack cdrom has been used as the source of the software.

  Place the TCP Wrappers software into a convenient location, such as /tmp and install via-

  /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f netsec.options.tcpwrapper,netsec.options.idprotocol -c -N -g -X -G -Y

  NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
          reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,CSF|PR.PT-3,HIPAA|164.312(e)(1),ITSG-33|SC-7(12),LEVEL|2S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|2.2.4"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>

        <report type:"PASSED">
          description : "4.10.4 TCP Wrappers - wrapping inetd services"
          info        : "If TCP Wrappers have been installed because there are active inetd services, these services must utilize TCP Wrappers to restrict host access.

  By limiting access to the server, you reduce your exposure to threats from attackers on remote systems. Therefore any active inetd controlled service which cannot be disabled should be restricted so that it can only be used by trusted hosts."
          solution    : "Prior to implementing this recommendation it is important that hosts.deny and hosts.allow files have been created.

  For each active TCP and UDP inetd service, change the entry in /etc/inetd.conf, so that tcpd is executed.

  Copy the current /etc/inetd.conf file for reversion purposes-

  cp -p /etc/inetd.conf /etc/inetd.conf.pre_tcp_wrappers

  For example, to utilize TCP Wrappers on the telnet service, edit-

  vi /etc/inetd.conf

  Change-

  telnet stream tcp6 nowait root /usr/sbin/telnetd telnetd

  To-

  telnet stream tcp nowait root /usr/sbin/tcpd telnetd

  Repeat the change for other services."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,HIPAA|164.312(e)(1),ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/528"
        </report>
      </else>
    </if>

##
## 4.11 - Non AIX Security Expert Recommendations - Permissions and Ownership
##
##
## 4.12 - Non AIX Security Expert Recommendations - Miscellaneous Configuration Changes
##

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.1 Miscellaneous Config - serial port restriction"
      info        : "The recommendation is to disable the login capability of all connected tty devices.

It is recommended that the login capability for all serial ports is disabled, so that unauthorized users cannot attach modems or remote access devices to these ports and bypass any network access control.If the environment utilizes tty devices to facilitate user connections. This recommendation may be ignored."
      solution    : "Create a list of active tty ports-

 lsitab -a |egrep 'respawn:/usr/sbin/getty|on:/usr/sbin/getty'

If any tty devices are returned from the previous output, lock down each any unrequired devices via-

 chitab 'tty2:2:off:/usr/sbin/getty /dev/tty2'

NOTE- Replace tty2 with the relevant port."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS15a,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^[A-Za-z0-9_]+:[0-9]+:(respawn|on):/usr/sbin/getty"
      expect      : "^[A-Za-z0-9_]+:[0-9]+:(respawn|on):/usr/sbin/getty"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.2 Miscellaneous Config - disable i4ls"
      info        : "The recommendation is to disable the i4ls license manager. This is typically used for C and Cobol license management.

It is recommended that the i4ls license manager is disabled. The license manager is needed for C and Cobol compilers etc. If the environment supports NCS and a license server is required, a node locked license server should be used instead."
      solution    : "Identify if i4ls is enabled-

 lsitab i4ls

If the command above yields output, remove via-

 rmitab i4ls"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^i4ls:"
      expect      : "^i4ls:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.3 Miscellaneous Config - disable NCS"
      info        : "The recommendation is to disable Network Computing System (NCS). It provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing.

NCS is an implementation of the Network Computing Architecture developed to provide tools for designing, implementing, and supporting applications requiring distributed data and distributed computing. It is recommended that NCS is disabled, unless it is required within the environment."
      solution    : "Identify if NCS is enabled-

 lsitab -a | grep '/etc/rc.ncs' | cut -f1 -d:

If the command above yields output, remove via-

 rmitab rcncs

NOTE- If the output from the lsitab command was not rcncs, substitute that above."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^rcncs:"
      expect      : "^rcncs:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.4 Miscellaneous Config - disable httpdlite"
      info        : "The recommendation is to disable httpdlite. This is a web server which provides on-line documentation.

httpdlite is the Lite NetQuestion Web server software for online documentation. It is recommended that this software is disabled, unless it is required in the environment.

NOTE- The man command does not need this to work correctly."
      solution    : "Identify if httpdlite is enabled-

 lsitab httpdlite

If the command above yields output, remove via-

 rmitab httpdlite"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^httpdlite:"
      expect      : "^httpdlite:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.5 Miscellaneous Config - disable pmd"
      info        : "The recommendation is to disable pmd. This is the power management service that turns the machine off if it has been idle for a specific amount of time.

pmd is the power management service that turns the machine off if it has been idle for a specific amount of time. This recommendation is to disable this service."
      solution    : "Identify if pmd is enabled-

 lsitab pmd

If the command above yields output, remove via-

 rmitab pmd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^pmd:"
      expect      : "^pmd:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.12.6 Miscellaneous Config - disable writesrv"
      info        : "The recommendation is to disable writesrv. This allows users to chat using the system write facility on a terminal.

writesrv allows users to chat using the system write facility on a terminal. The recommendation is that this service must be disabled."
      solution    : "Identify if writesrv is enabled-

 lsitab writesrv

If the command above yields output, remove via-

 rmitab writesrv"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|2S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/inittab"
      regex       : "^writesrv:"
      expect      : "^writesrv:"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.12.7 Miscellaneous Config - block talk/write - /etc/profile"
      info        : "The recommendation is to block talk and write. This allows connected users to chat within terminal sessions.

The recommendation is to block attempts to use the write or talk commands. This improves the security of the tty device. However, there are two exceptions:
 1. The super user can write to anyone
 2. If you are logged in as the same user who has turned the messages off, you can write to the super user"
      solution    : "Disable talk and write for ALL shells-

 echo 'mesg n' >> /etc/profile"
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/profile"
      regex       : "^[\\s]*mesg"
      expect      : "^[\\s]*mesg[\\s]+n[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.12.7 Miscellaneous Config - block talk/write - /etc/csh.login"
      info        : "The recommendation is to block talk and write. This allows connected users to chat within terminal sessions.

The recommendation is to block attempts to use the write or talk commands. This improves the security of the tty device.However, there are two exceptions-1. The super user can write to anyone 2. If you are logged in as the same user who has turned the messages off, you can write to the super user"
      solution    : "Disable talk and write for ALL shells-

 echo 'mesg n' >> /etc/csh.login"
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.2,SANS-CSC|11-1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/etc/csh.login"
      regex       : "^[\\s]*mesg"
      expect      : "^[\\s]*mesg[\\s]+n[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.12.8 Miscellaneous Config - enable sar accounting - install sar"
      info        : "The recommendation is to enable sar performance accounting. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.

System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis.There may be 3rd party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored."
      solution    : "Prior to configuring sar reporting, ensure that the bos.acct fileset is installed-

 lslpp -L bos.acct

NOTE- The bos.acct fileset should be listed, along with the currently installed version.

If the software is not installed, install from the relevant AIX media pack-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f bos.acct -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep bos.acct"
      expect      : "^[\\s]*bos[\\.]acct[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.12.8 Miscellaneous Config - enable sar accounting - crontab statistics gathering"
      info        : "The recommendation is to enable sar performance accounting. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.

System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis.There may be 3rd party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored."
      solution    : "Edit the adm user crontab-

 vi /var/spool/cron/crontabs/adm

NOTE- There are commented out example system activity report lines. Review and tailor to the needs of the environment-

 #=================================================================
 # SYSTEM ACTIVITY REPORTS
 # 8am-5pm activity reports every 20 mins during weekdays.
 # activity reports every an hour on Saturday and Sunday.
 # 6pm-7am activity reports every an hour during weekdays.
 # Daily summary prepared at 18-05.
 #=================================================================
 #0 8-17 * * 1-5 /usr/lib/sa/sa1 1200 3 &
 #0 * * * 0,6 /usr/lib/sa/sa1 &
 #0 18-7 * * 1-5 /usr/lib/sa/sa1 &
 #5 18 * * 1-5 /usr/lib/sa/sa2 -s 8-00 -e 18-01 -i 3600 -ubcwyaqvm &

NOTE- Change and uncomment the lines where appropriate. Refer to the sar documentation for further guidance"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/spool/cron/crontabs/adm"
      regex       : "^[\\s]*((\\*|[0-9,-]+)[\\s]+){5}/usr/lib/sa/sa1[\\s]"
      expect      : "^[\\s]*((\\*|[0-9,-]+)[\\s]+){5}/usr/lib/sa/sa1[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CHECK
      description : "4.12.8 Miscellaneous Config - enable sar accounting - directory"
      info        : "The recommendation is to enable sar performance accounting. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.

System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis.There may be 3rd party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored."
      solution    : "Create the reporting directory structure and apply the appropriate permissions-

 mkdir -p /var/adm/sa
 chown adm:adm /var/adm/sa
 chmod u=rwx,go=rx /var/adm/sa"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,HIPAA|164.312(b),ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/adm/sa"
      owner       : "adm"
      mask        : "022"
      group       : "adm"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : FILE_CONTENT_CHECK
      description : "4.12.8 Miscellaneous Config - enable sar accounting - crontab daily reporting"
      info        : "The recommendation is to enable sar performance accounting. This will provide a normal performance baseline which will help identify unusual performance patterns, created through potential attacks via a password cracking program being executed or through a DoS attack etc.

System accounting gathers periodic baseline system data, such as CPU utilization and disk I/O. Once a normal baseline for the system has been established, unauthorized activities, such as a password cracking being executed and activity outside of normal usage hours may be detected due to departure from the normal system performance baseline. It is recommended that the collection script is run on an hourly basis, every day, to help to detect any anomalies. It is also important to generate and review the system activity report on a daily basis.There may be 3rd party tools, or in-house written scripts in place which perform a similar function. In this instance this recommendation can be ignored."
      solution    : "Edit the adm user crontab-

 vi /var/spool/cron/crontabs/adm

NOTE- There are commented out example system activity report lines. Review and tailor to the needs of the environment-

 #=================================================================
 # SYSTEM ACTIVITY REPORTS
 # 8am-5pm activity reports every 20 mins during weekdays.
 # activity reports every an hour on Saturday and Sunday.
 # 6pm-7am activity reports every an hour during weekdays.
 # Daily summary prepared at 18-05.
 #=================================================================
 #0 8-17 * * 1-5 /usr/lib/sa/sa1 1200 3 &
 #0 * * * 0,6 /usr/lib/sa/sa1 &
 #0 18-7 * * 1-5 /usr/lib/sa/sa1 &
 #5 18 * * 1-5 /usr/lib/sa/sa2 -s 8-00 -e 18-01 -i 3600 -ubcwyaqvm &

NOTE- Change and uncomment the lines where appropriate. Refer to the sar documentation for further guidance"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,HIPAA|164.312(b),ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|2S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|10.2,SANS-CSC|14-2,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      file        : "/var/spool/cron/crontabs/adm"
      regex       : "^[\\s]*((\\*|[0-9,-]+)[\\s]+){5}/usr/lib/sa/sa2[\\s]"
      expect      : "^[\\s]*((\\*|[0-9,-]+)[\\s]+){5}/usr/lib/sa/sa2[\\s]"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.12.9 Miscellaneous Config - /etc/ftpusers"
      info        : "The /etc/ftpusers is a configuration file used by ftp daemon. It contains a list of users who are not allowed to access the system via ftp.

The /etc/ftpusers file contains a list of users who are not allowed to access the system via ftp. All users with a UID less than 200 should typically be added into the file."
      solution    : "List all users with a UID less than 200 to the /etc/ftpusers file-

 lsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d- | while read NAME;
 do
 if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] > /dev/null 2>&1;
 then
 echo 'Would add $NAME to /etc/ftpusers'
 fi
 done

NOTE- Review the list of users.

Add all relevant users with a UID of less that 200 to the /etc/ftpusers file-

 lsuser -c ALL | grep -v ^#name |grep -v root | cut -f1 -d- | while read NAME;
 do
 if [ `lsuser -f $NAME | grep id | cut -f2 -d=` -lt 200 ] > /dev/null 2>&1;
 then
 echo $NAME >> /etc/ftpusers
 fi
 done"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|2S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/awk -F: '$3 < 200 { print $1 }' /etc/passwd | while read NAME; do if [ `/usr/bin/egrep \"^$NAME\$\" /etc/ftpusers | wc -l` -ne 1 ]; then echo \"$NAME is missing/duplicated\"; fi; done | /usr/bin/awk '{print} END {if (NR==0) print \"none\"}'"
      expect      : "^none$"
    </custom_item>

##
## 4.13 - Non AIX Security Expert Recommendations - Encrypted Filesystems (EFS)
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.13.1 EFS - implementation - CLiC installed"
      info        : "The recommendation, if there is a requirement for file based encryption, is to utilize EFS.

The use of EFS further enhances the file and directory security within AIX. If there are sensitive or confidential files, encryption provides that extra level of security in the event of an accidental chmod which may allow read or write access to other users.The encryption operates at the filesystem level and each file is encrypted with a separate key. From a user perspective the encryption is transparent as the key can be automatically loaded during login."
      solution    : "There are two pre-requisite requirements for EFS, it requires RBAC and the installation of the CLiC cryptographic fileset. The fileset is located on the expansion pack, shipped with the AIX media.Place the CLiC software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f clic.rte -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above.

Load the CLiC kernel extension-

 /usr/lib/methods/loadkclic

As the EFS administrator, create the initial keystore. This is typically the root user-

 efsenable -a

An EFS enabled filesystem can be created with the following command-

 chfs -v jfs2 -g <vg_name> -m </filesystem> -a size=<size> -a efs=yes

To enable EFS for an existing filesystem-

 chfs -a efs=yes </filesystem>

To encrypt a file, load your keystore via-

 efskeymgr -o ksh

Then encrypt via-

 efsmgr -c AES_192_ECB -e <filename>

To decrypt-

 efsmgr -d <filename>

Further details regarding planning and implementation of EFS can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fefs_efs.htm

NOTE- The configuration of EFS is completely dependant on the unique requirements of a given environment."
      reference   : "800-171|3.13.16,800-53|SC-28,CN-L3|8.1.4.7(b),CN-L3|8.1.4.8(b),CSF|PR.DS-1,HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28,LEVEL|2S,SANS-CSC|17-1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/lslpp -L | /usr/bin/grep clic"
      expect      : "^[\\s]+clic\\.rte\\."
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.13.1 EFS - implementation - CLiC kernel extension loaded"
      info        : "The recommendation, if there is a requirement for file based encryption, is to utilize EFS.

The use of EFS further enhances the file and directory security within AIX. If there are sensitive or confidential files, encryption provides that extra level of security in the event of an accidental chmod which may allow read or write access to other users.The encryption operates at the filesystem level and each file is encrypted with a separate key. From a user perspective the encryption is transparent as the key can be automatically loaded during login."
      solution    : "There are two pre-requisite requirements for EFS, it requires RBAC and the installation of the CLiC cryptographic fileset. The fileset is located on the expansion pack, shipped with the AIX media.Place the CLiC software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f clic.rte -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above.

Load the CLiC kernel extension-

 /usr/lib/methods/loadkclic

As the EFS administrator, create the initial keystore. This is typically the root user-

 efsenable -a

An EFS enabled filesystem can be created with the following command-

 chfs -v jfs2 -g <vg_name> -m </filesystem> -a size=<size> -a efs=yes

To enable EFS for an existing filesystem-

 chfs -a efs=yes </filesystem>

To encrypt a file, load your keystore via-

 efskeymgr -o ksh

Then encrypt via-

 efsmgr -c AES_192_ECB -e <filename>

To decrypt-

 efsmgr -d <filename>

Further details regarding planning and implementation of EFS can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fefs_efs.htm

NOTE- The configuration of EFS is completely dependant on the unique requirements of a given environment."
      reference   : "800-171|3.13.16,800-53|SC-28(1),CSCv6|13.2,CSF|PR.DS-1,HIPAA|164.312(e)(2)(ii),ITSG-33|SC-28(1),LEVEL|2S,SANS-CSC|17-1,TBA-FIISB|28.1"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/genkex | grep crypto/clickext | awk '{ print } END { if (NR == 0) print \"none\" }'"
      expect      : "[\\s]/usr/lib/drivers/crypto/clickext[\\s]*$"
    </custom_item>

##
## 4.14 - Non AIX Security Expert Recommendations - Privileged Command Management
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.14.1 PCM - sudo"
      info        : "The recommendation is to install and configure sudo, to reflect the privileged command access requirements of all users of the system.

Privileged command access should be limited to and defined by a user's individual needs.  Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.The choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1+ only, it is recommended that enhanced RBAC is used as the tool of choice. Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC.

The sudo software is packaged as an RPM by IBM and is available on the AIX Toolbox for LINUX media, or via download from the following location-

 http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/download.html"
      solution    : "Place the sudo software into a convenient location, such as /tmp and install via-

 /usr/lib/instl/sm_inst installp_cmd -a -Q -d /tmp -f sudo -c -N -g -X -G -Y

NOTE- If the software is not located in /tmp, reflect the actual location in the command above.

Once installed refer to the sudo man page for information regarding the creation of a custom /etc/sudoers file. It is recommended that, to reduce rule complexity, privileges are assigned at a group level wherever possible-

 http://www.gratisoft.us/sudo/man/sudo.html

NOTE- The configuration of sudo is completely dependant on the unique requirements of a given environment.

All editing of the /etc/sudoers file must be performed by the following command-

 visudo

Once the /etc/sudoers file has been successfully created, validate the syntax of the file-

 visudo -c"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|2.2.4,SANS-CSC|12-14"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/bin/rpm -q sudo"
      expect      : "^sudo-[\\d\\.]+"
    </custom_item>

    <report type:"WARNING">
      description : "4.14.2 PCM - enhanced RBAC"
      info        : "The recommendation is to configure RBAC to reflect the privileged command access requirements for all users of the system. RBAC is a default component of AIX 7.1.

Privileged command access should be limited to and defined by a user's individual needs.  Access to a root command prompt should limited, wherever possible, to minimize the risk of inadvertent or deliberate misuse of the account.

The choice between sudo and enhanced RBAC revolves around whether or not the environment is heterogeneous in nature, running different flavors of UNIX, or perhaps different versions of AIX. It may be that sudo is the standard tool of choice for managing privileged command access across an entire UNIX estate. However, if the environment is AIX 6.1+ only, it is recommended that enhanced RBAC is used as the tool of choice. Some implementations however may benefit from a combined approach, utilizing both sudo and enhanced RBAC.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Enhanced RBAC improves on its legacy implementation by allowing greater flexibility around command lists and authorization definitions, which can be customized. The definitions are also saved to a kernel table rather than in flat files, which improves security.

The implementation of RBAC is role based, allowing users to be specifically granted access to the privileged commands they need to perform their day to day tasks. The tool can be used to replace sudo in many instances, or indeed to work alongside it.

A successful implementation may also allow the root account to be deprecated.

The RBAC definition files-

 /etc/security/privcmds
 /etc/security/privfiles
 /etc/security/privdevs

The command used to list the active RBAC definitions, i.e. those loaded into the kernel-

 lskst

The command used to update RBAC definitions in the kernel table-

 setkst

Further details regarding planning and implementation of RBAC can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Frbac_in_aix.htm

NOTE- The configuration of enhanced RBAC is completely dependant on the unique requirements of a given environment."
      reference   : "800-53|AC-3,CSF|PR.AC-4,LEVEL|2NS,PCI-DSS|2.2.4,SANS-CSC|12-14"
      see_also    : "https://workbench.cisecurity.org/files/528"
    </report>

##
## 4.15 - Non AIX Security Expert Recommendations - Trusted Execution (TE)
##

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.15.1 TE - implementation - TE"
      info        : "The recommendation is to implement TE to protect the system from Trojan horse style attacks.  TE provides a robust system integrity checking process.

One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible.There is a pre-requisite requirement to install CLiC and SSL software."
      solution    : "It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.

The tsd.dat file contains the important security attributes relating to all of the managed files-

 cat /etc/security/tsd/tsd.dat

NOTE- The trustchk command is used to manage the entries in this file.

To enable TE, firstly enable online checking of executables and shell scripts-

 trustchk -p CHKEXEC=ON
 trustchk -p CHKSCRIPT=ON

Stop the execution or loading of binaries and files into memory when the integrity checks fail-

 trustchk -p STOP_ON_CHKFAIL=ON

Enable online TE based on the policy selections above-

 trustchk -p TE=ON

To set a Trusted Execution Path or TEP-

 trustchk -p TEP=<PATH variable>

Enable the TEP-

 trustchk -p TEP=ON

NOTE- Commands will not be executed if they reside outside of the TEP.

Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm

NOTE- The configuration of TE is dependant on the unique requirements of a given environment."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-7(6),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF|PR.DS-6,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2S,NIAv2|GS8a,PCI-DSS|2.2.4,SANS-CSC|3-8,SWIFT-CSCv1|6.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/trustchk -p TE 2>&1"
      expect      : "^[\\s]*TE[\\s]*=[\\s]*ON[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.15.1 TE - implementation - CHKEXEC"
      info        : "The recommendation is to implement TE to protect the system from Trojan horse style attacks.  TE provides a robust system integrity checking process.

One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible.There is a pre-requisite requirement to install CLiC and SSL software."
      solution    : "It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.

The tsd.dat file contains the important security attributes relating to all of the managed files-

 cat /etc/security/tsd/tsd.dat

NOTE- The trustchk command is used to manage the entries in this file.

To enable TE, firstly enable online checking of executables and shell scripts-

 trustchk -p CHKEXEC=ON
 trustchk -p CHKSCRIPT=ON

Stop the execution or loading of binaries and files into memory when the integrity checks fail-

 trustchk -p STOP_ON_CHKFAIL=ON

Enable online TE based on the policy selections above-

 trustchk -p TE=ON

To set a Trusted Execution Path or TEP-

 trustchk -p TEP=<PATH variable>

Enable the TEP-

 trustchk -p TEP=ON

NOTE- Commands will not be executed if they reside outside of the TEP.

Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm

NOTE- The configuration of TE is dependant on the unique requirements of a given environment."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-7(6),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF|PR.DS-6,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2S,NIAv2|GS8a,PCI-DSS|2.2.4,SANS-CSC|3-8,SWIFT-CSCv1|6.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/trustchk -p CHKEXEC 2>&1"
      expect      : "^[\\s]*CHKEXEC[\\s]*=[\\s]*ON[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.15.1 TE - implementation - CHKSCRIPT"
      info        : "The recommendation is to implement TE to protect the system from Trojan horse style attacks.  TE provides a robust system integrity checking process.

One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible.There is a pre-requisite requirement to install CLiC and SSL software."
      solution    : "It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.

The tsd.dat file contains the important security attributes relating to all of the managed files-

 cat /etc/security/tsd/tsd.dat

NOTE- The trustchk command is used to manage the entries in this file.

To enable TE, firstly enable online checking of executables and shell scripts-

 trustchk -p CHKEXEC=ON
 trustchk -p CHKSCRIPT=ON

Stop the execution or loading of binaries and files into memory when the integrity checks fail-

 trustchk -p STOP_ON_CHKFAIL=ON

Enable online TE based on the policy selections above-

 trustchk -p TE=ON

To set a Trusted Execution Path or TEP-

 trustchk -p TEP=<PATH variable>

Enable the TEP-

 trustchk -p TEP=ON

NOTE- Commands will not be executed if they reside outside of the TEP.

Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm

NOTE- The configuration of TE is dependant on the unique requirements of a given environment."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-7(6),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF|PR.DS-6,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2S,NIAv2|GS8a,PCI-DSS|2.2.4,SANS-CSC|3-8,SWIFT-CSCv1|6.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/trustchk -p CHKSCRIPT 2>&1"
      expect      : "^[\\s]*CHKSCRIPT[\\s]*=[\\s]*ON[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.15.1 TE - implementation - STOP_ON_CHKFAIL"
      info        : "The recommendation is to implement TE to protect the system from Trojan horse style attacks.  TE provides a robust system integrity checking process.

One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible.There is a pre-requisite requirement to install CLiC and SSL software."
      solution    : "It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.

The tsd.dat file contains the important security attributes relating to all of the managed files-

 cat /etc/security/tsd/tsd.dat

NOTE- The trustchk command is used to manage the entries in this file.

To enable TE, firstly enable online checking of executables and shell scripts-

 trustchk -p CHKEXEC=ON
 trustchk -p CHKSCRIPT=ON

Stop the execution or loading of binaries and files into memory when the integrity checks fail-

 trustchk -p STOP_ON_CHKFAIL=ON

Enable online TE based on the policy selections above-

 trustchk -p TE=ON

To set a Trusted Execution Path or TEP-

 trustchk -p TEP=<PATH variable>

Enable the TEP-

 trustchk -p TEP=ON

NOTE- Commands will not be executed if they reside outside of the TEP.

Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm

NOTE- The configuration of TE is dependant on the unique requirements of a given environment."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-7(6),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF|PR.DS-6,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2S,NIAv2|GS8a,PCI-DSS|2.2.4,SANS-CSC|3-8,SWIFT-CSCv1|6.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/trustchk -p STOP_ON_CHKFAIL 2>&1"
      expect      : "^[\\s]*STOP_ON_CHKFAIL[\\s]*=[\\s]*ON[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "AIX"
      type        : CMD_EXEC
      description : "4.15.1 TE - implementation - TEP"
      info        : "The recommendation is to implement TE to protect the system from Trojan horse style attacks.  TE provides a robust system integrity checking process.

One of the common ways a hacker infiltrates a system is through file tampering or the use of a Trojan horse. The implementation of TE can provide a number of integrity checks prior to loading a program into memory, any deviations can also be highlighted when programs and files are validated offline. This ensures that the programs executed are those which are intended to be and not malicious code masquerading as a true program.When a discrepancy is identified it is classified as either minor or major. A minor discrepancy is automatically reset to the value defined in the TSD. In the event of a major discrepancy the file access permissions are changed to make the file inaccessible.There is a pre-requisite requirement to install CLiC and SSL software."
      solution    : "It is recommended that TE is configured in online mode. This provides real time protection against Trojan horse attacks.

The tsd.dat file contains the important security attributes relating to all of the managed files-

 cat /etc/security/tsd/tsd.dat

NOTE- The trustchk command is used to manage the entries in this file.

To enable TE, firstly enable online checking of executables and shell scripts-

 trustchk -p CHKEXEC=ON
 trustchk -p CHKSCRIPT=ON

Stop the execution or loading of binaries and files into memory when the integrity checks fail-

 trustchk -p STOP_ON_CHKFAIL=ON

Enable online TE based on the policy selections above-

 trustchk -p TE=ON

To set a Trusted Execution Path or TEP-

 trustchk -p TEP=<PATH variable>

Enable the TEP-

 trustchk -p TEP=ON

NOTE- Commands will not be executed if they reside outside of the TEP.

Further details regarding planning and implementation of TE can be found within the IBM AIX 7.1 Infocentre-

 http://pic.dhe.ibm.com/infocenter/aix/v7r1/index.jsp?topic=%2Fcom.ibm.aix.security%2Fdoc%2Fsecurity%2Fbos_trusted_execution.htm

NOTE- The configuration of TE is dependant on the unique requirements of a given environment."
      reference   : "800-171|3.14.2,800-171|3.14.4,800-171|3.14.5,800-53|SI-3,800-53|SI-7(6),CN-L3|7.1.3.6(b),CN-L3|8.1.10.5(b),CN-L3|8.1.10.7(a),CN-L3|8.1.10.7(b),CN-L3|8.1.4.5,CN-L3|8.1.9.6(a),CN-L3|8.1.9.6(b),CSF|DE.CM-4,CSF|DE.DP-3,CSF|PR.DS-6,HIPAA|164.308(a)(5)(ii)(B),ISO/IEC-27001|A.12.2.1,ITSG-33|SI-3,LEVEL|2S,NIAv2|GS8a,PCI-DSS|2.2.4,SANS-CSC|3-8,SWIFT-CSCv1|6.2,TBA-FIISB|49.2.1,TBA-FIISB|49.2.2,TBA-FIISB|49.3.1,TBA-FIISB|49.3.2,TBA-FIISB|50.2.1,TBA-FIISB|51.2.4,TBA-FIISB|51.2.7"
      see_also    : "https://workbench.cisecurity.org/files/528"
      cmd         : "/usr/sbin/trustchk -p TEP 2>&1"
      expect      : "^[\\s]*TEP[\\s]*=[\\s]*ON[\\s]*$"
    </custom_item>

##
## 4.16 - Non AIX Security Expert Recommendations - General Permissions Management
##

    <item>
      system      : "AIX"
      description : "4.16.1 General Permissions Management - suid and sgid files and programs"
      info        : "The system is audited for both suid and sgid files and programs.

An audit should be performed on the system to search for the presence of both suid and sgid files and programs. In order to prevent these files from being potentially exploited the suid and sgid permissions should be removed wherever possible.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the currently mounted filesystems-

 mount

Un-mount all non-local filesystems and cdrom media-

 unmount <mount point>

If there are non-local filesystems which cannot be un-mounted, use the following to find all suid and sgidfiles on local JFS/JFS2 filesystems only-

 find / \( -fstype jfs -o -fstype jfs2 \) \( -perm -04000 -o -perm -02000 \) -type f -ls

If all non-local filesystems have been un-mounted-

 find / \( -perm -04000 -o -perm -02000 \) -type f -ls

Review the files and where possible, use the chmod command to remove the appropriate suid or sgid bits-

 chmod u-s <file>
 chmod g-s <file>"
      reference   : "800-53|AC-6(8),CSF|PR.AC-4,LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      name        : "find_suid_sgid_files"
      basedir     : "/"
      severity    : MEDIUM
    </item>

    <item>
      system      : "AIX"
      description : "4.16.2 General Permissions Management - un-owned files and directories"
      info        : "The system is audited for un-owned files and directories.

An audit should be performed on the system to search for the presence of un-owned files and directories. All files and directories should have a valid owner and group.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the currently mounted filesystems-

 mount

Un-mount all non-local filesystems and cdrom media-

 unmount <mount point>

If there are non-local filesystems which cannot be un-mounted, use the following command to find all un-owned files and directories on local JFS/JFS2 filesystems only-

 find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls

If all non-local filesystems have been un-mounted-

 find / \( -type d -o -type f \) \( -nouser -o -nogroup \) -ls

NOTE- An un-owned file or directory is referred to via the GID or UID as it cannot be translated to a user or group name in /etc/group or /etc/passwd. This is typically caused by removing users or groups from the system.

Remediate the un-owned file and directory list-

 chown <owner> <file>
 chgrp <group> <file>"
      reference   : "800-53|AC-16(3),CSF|PR.AC-4,ITSG-33|AC-16(3),LEVEL|2S,PCI-DSS|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/528"
      name        : "find_orphan_files"
      basedir     : "/"
      severity    : MEDIUM
    </item>

    <item>
      system      : "AIX"
      description : "4.16.3 General Permissions Management - world writable directories"
      info        : "The system is audited for world writable files and directories.

An audit should be performed on the system to search for the presence of world writable files and directories. Files and directories should only be world writable when absolutely necessary.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the currently mounted filesystems-mount
 Un-mount all non-local filesystems and cdrom media-

 unmount <mount point>

If there are non-local filesystems which cannot be un-mounted, use the following to find all world writable files and directories on local JFS/JFS2 filesystems only-

 find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls

If all non-local filesystems have been un-mounted-

 find / \( -type d -o -type f \) -perm -o+w -ls

Review the world writable files and directories and where possible, if the application configuration allows, remove access via-

 chmod o-w <dir or file>

If a directory must retain world writable access, ensure that sticky bit is set so that users can only remove the files they create-

 chmod o+t <dir>

NOTE- This will retain world writable permissions, but add a sticky bit to the directory."
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.2.4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      name        : "find_world_writeable_directories"
      severity    : MEDIUM
    </item>

    <item>
      system      : "AIX"
      description : "4.16.3 General Permissions Management - world writable files"
      info        : "The system is audited for world writable files and directories.

An audit should be performed on the system to search for the presence of world writable files and directories. Files and directories should only be world writable when absolutely necessary.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the currently mounted filesystems-mount
 Un-mount all non-local filesystems and cdrom media-

 unmount <mount point>

If there are non-local filesystems which cannot be un-mounted, use the following to find all world writable files and directories on local JFS/JFS2 filesystems only-

 find / \( -fstype jfs -o -fstype jfs2 \) \( -type d -o -type f \) -perm -o+w -ls

If all non-local filesystems have been un-mounted-

 find / \( -type d -o -type f \) -perm -o+w -ls

Review the world writable files and directories and where possible, if the application configuration allows, remove access via-

 chmod o-w <dir or file>

If a directory must retain world writable access, ensure that sticky bit is set so that users can only remove the files they create-

 chmod o+t <dir>

NOTE- This will retain world writable permissions, but add a sticky bit to the directory."
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|2S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,PCI-DSS|2.2.4,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/528"
      name        : "find_world_writeable_files"
      severity    : MEDIUM
    </item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS AIX 7.1 Benchmark v1.1.0 Level 2"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/528"
    </report>
  </else>
</if>

</check_type>
