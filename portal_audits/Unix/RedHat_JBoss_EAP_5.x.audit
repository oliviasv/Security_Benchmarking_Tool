#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.20 $
# $Date: 2020/07/14 $
#
# Description   :  This benchmark provides security guidance on JBoss EAP 5 running on Red Hat Enterprise Linux.
#                  The .audit is based on SCAP 1.1 content available here :
#
#                   https://fedorahosted.org/scap-security-guide/raw-attachment/wiki/downloads/JBossEAP_5.x_SCAP_v1.0.zip
#
#<ui_metadata>
#<display_name>Redhat JBoss EAP 5.x</display_name>
#<spec>
#  <type>SCAP</type>
#  <name>JBoss EAP 5.x</name>
#  <version>1.0.0</version>
#  <link>https://fedorahosted.org/scap-security-guide/raw-attachment/wiki/downloads/JBossEAP_5.x_SCAP_v1.0.zip</link>
#</spec>
#<labels>unix,jboss,agent</labels>
#<variables>
#  <variable>
#    <name>JBOSS_HOME</name>
#    <default>/usr/jboss/jboss-5.0.GA</default>
#    <description>JBOSS Home</description>
#    <info>The path to the JBOSS_HOME environment variable</info>
#  </variable>
#  <variable>
#    <name>PROFILE</name>
#    <default>Default</default>
#    <description>Jboss Profile</description>
#    <info>Server Profile</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<report type:"PASSED">
  description : "Red Hat Security Benchmark JBoss Enterprise Application Platform 5.x"
  info        : "This .audit was developed from SCAP content developed by Red Hat, Inc. for use by JBoss Enterprise Application Platform 5.x Administrators"
  see_also    : "https://fedorahosted.org/scap-security-guide/raw-attachment/wiki/downloads/JBossEAP_5.x_SCAP_v1.0.zip"
</report>

<report type:"WARNING">
  description : "1.1 JBoss Enterprise Application Platform should be a vendor supported version"
  info        : "Evaluated JBoss installation must be a vendor supported version of JBoss Enterprise Application Platform 5. Red Hat typically offers full and production support for the first 7 years following a release. Extended support options can be negotiated with the vendor directly through a separate subscription. Organizations using JBoss EAP must use a vendor supported version with an active support contract.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-53|CM-6,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|I"
</report>

<custom_item>
  system      : "Linux"
  type        : CMD_EXEC
  description : "1.1/1.2 - JBoss Enterprise Application Platform/Ensure Java Runtime Environment in use is a supported version"
  info        : "Evaluated JBoss installation must be a vendor supported version of JBoss Enterprise Application Platform 5. Red Hat typically offers full and production support for the first 7 years following a release. Extended support options can be negotiated with the vendor directly through a separate subscription. Organizations using JBoss EAP must use a vendor supported version with an active support contract."
  reference   : "800-171|3.4.1,800-53|CM-8,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|I,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "cmd".
  cmd         : "/usr/jboss/jboss-5.0.GA/bin/run.sh --version"
  expect      : ""
</custom_item>

<report type:"WARNING">
  description : "1.2 Ensure all configurations are made to the appropriate server profile"
  info        : "Production environments should utilize the production server profile. Development and test environments should choose the profile that best fits their needs.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-53|CM-6,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|III"
  solution    : "Ensure that all configuration changes and deployments are made to the appropriate server profile. Production environments should utilize the production server profile. Development and test environments should choose the profile that best fits their needs."
</report>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "1.4 Ensure Technology Preview components are disabled in production environments"
  info        : "Remove the PicketLink technology preview folder. By default, this folder is included at the same level as the JBoss-as folder. If you leave the picketlink folder as originally shipped in the EAP binary, PicketLink is unable to be launched, and subsequently interact with the certified configuration."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/../picketlink"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "Delete the JBOSS_HOME/picketlink/ folder."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "1.5 Disable Hot Deployment in production"
  info        : "Hot deployment should be disabled on production servers. Hot Deployment allows for automatic deployment of Java applications by simply placing Java applications into the deploy directory."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove file 'JBOSS_HOME/server/Default/deploy/hdscanner-jboss-beans.xml'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/hdscanner-jboss-beans.xml"
</custom_item>

<report type:"WARNING">
  description : "1.6 Production applications should not implement the default SRPVerifierStore interface for the Secure Remote Password (SRP) protocol"
  info        : "The SRP protocol is a public key exchange protocol similar to Diffie-Hellman. The default implementation of the SRPVerifierStore interface is not recommended for a production security environment because it requires all password hash information to be available as a file of serialized objects.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-53|CM-6,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|III"
  solution    : "Application developers should not use the default implementation for SRPVerifierStore, and should extend it to avoid the use of serialized password objects."
</report>

<report type:"WARNING">
  description : "1.7 Declare an EJB authorization policy for deployed applications"
  info        : "When configuring your application specific security policy, you must declare one (or more) of the following authorization modules in the security domain <policy-module> element.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-53|AC-3,800-53|AC-4,8500.2|EBBD-1,8500.2|EBBD-2,8500.2|EBBD-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|II"
  solution    : "Applications deploying their own security policies must specify one of the following <policy-module> within their 'code' attributes:

  <application-policy name=\"demo\">
	<authorization>
	<policy-module code=\"org.JBoss.security.authorization.modules.JACCAuthorizationModule\"></policy-module>
	</authorization>
</application-policy>"
</report>

<report type:"WARNING">
  description : "1.9 Ensure appropriate DefaultDS is enabled"
  info        : "Create a default data store file for the desired database. Templates are located in JBOSS_HOME/docs/examples/jca.

  NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  reference   : "800-53|SC-4,8500.2|ECRC-1,CAT|III"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Create a default DS file for the desired database at JBOSS_HOME/server/Default/deploy/DefaultDS.xml. Examples of this file are located in JBOSS_HOME/docs/examples/jca. The DefaultDS must not be a HSQLDB."
</report>

<if>
  <condition type:"AND">
    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "Ensure default HSQLDB is disabled - 'JBOSS_HOME/server/Default/deploy/hsqldb-ds.xml'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/hsqldb-ds.xml"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
      description : "Ensure default HSQLDB is disabled - JBOSS_HOME/common/lib/hsqldb.jar"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/common/lib/hsqldb.jar"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
      description : "Ensure default HSQLDB is disabled - JBOSS_HOME/common/lib/hsqldb-plugin.jar"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/common/lib/hsqldb-plugin.jar"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "Ensure default HSQLDB is disabled - JBOSS_HOME/server/Default/deploy/messaging/hsqldb-persistence-service.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/messaging/hsqldb-persistence-service.xml"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "1.11 Ensure default HSQLDB is disabled"
      info        : "The default development HSQL database included with JBoss should be removed."
      reference   : "800-53|SC-4,8500.2|ECRC-1,CAT|III"
    </report>
  </then>

  <else>
    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "1.11 Ensure default HSQLDB is disabled - 'JBOSS_HOME/server/Default/deploy/hsqldb-ds.xml'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/hsqldb-ds.xml"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECRC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Delete the HSLQDB database files: JBOSS_HOME/server/Default/deploy/hsqldb-ds.xml"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
      description : "1.11 Ensure default HSQLDB is disabled - 'JBOSS_HOME/common/lib/hsqldb.jar'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/common/lib/hsqldb.jar"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECRC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      solution    : "Delete the HSLQDB database files: JBOSS_HOME/common/lib/hsqldb.jar"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
      description : "1.11 Ensure default HSQLDB is disabled - 'JBOSS_HOME/common/lib/hsqldb-plugin.jar'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/common/lib/hsqldb-plugin.jar"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECRC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      solution    : "Delete the HSLQDB database files: JBOSS_HOME/common/lib/hsqldb-plugin.jar"
    </custom_item>

    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "1.11 Ensure default HSQLDB is disabled - 'JBOSS_HOME/server/Default/deploy/messaging/hsqldb-persistence-service.xml'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/messaging/hsqldb-persistence-service.xml"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECRC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Delete the HSLQDB database files: JBOSS_HOME/server/Default/deploy/messaging/hsqldb-persistence-service.xml"
    </custom_item>
  </else>
</if>

<custom_item>
  type        : AUDIT_XML
  description : "1.12 Ensure HSQLDB Security Domain is removed - 'HsqlDbRealm = false'"
# Note: Variable @PROFILE@ replaced with "Default" in field "info".
  info        : "The security domain for HsqlDbRealm should be removed from the JBOSS_HOME/server/Default/conf/login-config.xml file."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt    : "<xsl:template  match=\"policy\">"
  xsl_stmt    : "HsqlDbRealm = <xsl:value-of select=\"boolean(/policy/application-policy[@name='HsqlDbRealm']/@name)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "HsqlDbRealm = .+"
  expect      : "HsqlDbRealm = [Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-53|SC-4,8500.2|ECRC-1,CAT|III"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove the security domain for HsqlDbRealm in the JBOSS_HOME/server/Default/conf/login-config.xml file as shown."
  solution    : "Security domains for testing new jca framework
  <application-policy name = \"HsqlDbRealm\">
	<authentication>
		<login-module code = \"org.JBoss.resource.security.ConfiguredIdentityLoginModule\" flag = \"required\">
		<module-option name = \"principal\">sa</module-option>
		<module-option name = \"userName\">cctest</module-option>
		<module-option name = \"password\">cc1248</module-option>
		<module-option name = \"managedConnectionFactoryName\">JBoss.jca:service=LocalTxCM,name=DefaultDS</module-option>
		</login-module>
	</authentication>
 </application-policy>"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.14 - Ensure Oracle Database persistence plugin is set correctly - 'DatabasePersistencePlugin'"
# Note: Variable @PROFILE@ replaced with "Default" in field "info".
  info        : "When using the Oracle Database as the DefaultDS, the database persistence plugin definition must be updated in JBOSS_HOME/server/Default/deploy/ejb2-timer-service.xml."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb2-timer-service.xml"
  xsl_stmt    : "<xsl:template  match=\"server\">"
  xsl_stmt    : "DatabasePersistencePlugin = <xsl:value-of select=\"/server/mbean[@code='org.jboss.ejb.txtimer.DatabasePersistencePolicy']/attribute[@name='DatabasePersistencePlugin']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  reference   : "800-53|CM-6,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|III"
  regex       : "DatabasePersistencePlugin = .+"
  not_expect  : "org.jboss.ejb.txtimer.GeneralPurposeDatabasePersistencePlugin"
  solution    : "If DefaultDS is a Oracle Database then DatabasePersistencePlugin should be set to 'org.JBoss.ejb.txtimer.OracleDatabasePersistencePlugin'"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "1.15 - Ensure IBM JRE 1.6 is configured correctly - 'policy.provider = sun.security.provider.PolicyFile'"
  info        : "When IBM JRE 1.6 is configured as the Java Runtime Environment, the following configuration changes must be made to ensure compatibility between JBoss EAP and IBM JRE. IBM JRE 1.6 uses a default policy provider which does not work correctly with the JBoss Enterprise Application Platform security policy. The IBM JRE must be reconfigured to use the standard policy provider."
  file        : "JAVA_HOME/jre/lib/security/java.security"
  regex       : "^[^#]*policy.provider[\s]*=.+"
  expect      : "policy.provider[\s]*=[\s]*sun.security.provider.PolicyFile"
  reference   : "800-53|CM-6,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|II"
  solution    : "When IBM JRE 1.6 is configured as the Java Runtime Environment, the following configuration changes must be made for compatibility:"
  solution    : "Edit the file JAVA_HOME/jre/lib/security/java.security and set the value of policy.provider to sun.security.provider.PolicyFile"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.17 The allRolesMode must be configured to 'strict' - 'allRolesMode = strict'"
# Note: Variable @PROFILE@ replaced with "Default" in field "info".
  info        : "The allRolesMode within JBOSS_HOME/server/Default/deploy/jbossweb.sar/server.xml must be set to strict for production environments. This requires the authenticated user to be assigned to one of the web-app/security-role/role-name roles in order to be authorized."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jbossweb.sar/server.xml"
  xsl_stmt    : "<xsl:template  match=\"Server\">"
  xsl_stmt    : "allRolesMode = <xsl:value-of select=\"/Server/Service/Engine[@name='jboss.web']/Realm/@allRolesMode\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "allRolesMode = .+"
  expect      : "allRolesMode = strict"
  reference   : "800-53|AC-3,800-53|AC-6,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,8500.2|ECLP-1,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Update allRolesAttribute for the <Realm> element with className=\"org.jboss.web.tomcat.security.JBossWebRealm\" in JBOSS_HOME/server/Default/deploy/jbossweb.sar/server.xml. Set the attribute value to \"strict\". By default, the allRolesAttribute is set to \"authOnly\". For example:"
  solution    : "&lt;Realm className=\"org.jboss.web.tomcat.security.JBossWebRealm\" certificatePrincipal=\"org.jboss.security.auth.certs.SubjectDNMapping\" allRolesMode=\"strict\" /&gt;"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'jmx-console principal != sa'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt    : "<xsl:template  match=\"policy\">"
  xsl_stmt    : "principal = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module/module-option[@name='principal']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "principal = .+"
  not_expect  : "principal = sa"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/server/Default/conf/login-config.xml."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'jmx-console userName != sa'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt    : "<xsl:template  match=\"policy\">"
  xsl_stmt    : "userName = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module/module-option[@name='userName']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "userName = .+"
  not_expect  : "userName = sa"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/
server/Default/conf/login-config.xml."
</custom_item>

<custom_item>
  type         : AUDIT_XML
  description  : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'jmx-console password != empty'"
  info         : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file         : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt     : "<xsl:template  match=\"policy\">"
  xsl_stmt     : "principal = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module/module-option[@name='password']/text()\"/>"
  xsl_stmt     : "</xsl:template>"
  regex        : "password ="
  expect       : "password = .+"
  reference    : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution     : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/
server/Default/conf/login-config.xml."
  check_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'JBossWS principal != sa'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt    : "<xsl:template  match=\"policy\">"
  xsl_stmt    : "principal = <xsl:value-of select=\"/policy/application-policy[@name='JBossWS']/authentication/login-module/module-option[@name='principal']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "principal = .+"
  not_expect  : "principal = sa"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/server/Default/conf/login-config.xml."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'JBossWS userName != sa'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt    : "<xsl:template  match=\"policy\">"
  xsl_stmt    : "userName = <xsl:value-of select=\"/policy/application-policy[@name='JBossWS']/authentication/login-module/module-option[@name='userName']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "userName = .+"
  not_expect  : "userName = sa"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/
server/Default/conf/login-config.xml."
</custom_item>

<custom_item>
  type         : AUDIT_XML
  description  : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'JBossWS password != empty'"
  info         : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file         : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
  xsl_stmt     : "<xsl:template  match=\"policy\">"
  xsl_stmt     : "principal = <xsl:value-of select=\"/policy/application-policy[@name='JBossWS']/authentication/login-module/module-option[@name='password']/text()\"/>"
  xsl_stmt     : "</xsl:template>"
  regex        : "password ="
  expect       : "password = .+"
  reference    : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution     : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/
server/Default/conf/login-config.xml."
  check_option : CAN_BE_NULL
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'jbossws-users.properties - kermit'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/jbossws-users.properties"
  regex       : "^[^#]*kermit"
  expect      : "^[^#]*kermit"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/server/Default/conf/props/jbossws-users.properties"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'jmx-console-users.properties - admin'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/jmx-console-users.properties"
  regex       : "^[^#]*admin"
  expect      : "^[^#]*admin"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME/server/Default/conf/props/jmx-console-users.properties"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "1.19 - Remove, rename, or comment out the default user accounts from production servers - 'messaging-users.properties - guest'"
  info        : "Remove, rename, or comment out the default user accounts defined in .properties files and login-config.xml"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/messaging-users.properties"
  regex       : "^[^#]*guest"
  expect      : "^[^#]*guest"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Remove, rename, or comment out the default user accounts in the default <application-policy> elements located within the configuration file: JBOSS_HOME//server/Default/conf/props/messaging-users.properties"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.20 - Remove default roles from production servers - 'jmx-console default role != JBossAdmin|HttpInvoker|friend|guest'"
  info        : "Remove, rename, or comment out the default role definitions in the default <application-policy> elements"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war/WEB-INF/web.xml"
  xsl_stmt    : "<xsl:template match=\"web-app\">"
  xsl_stmt    : "default role = <xsl:value-of select=\"/web-app/security-constraint/auth-constraint/role-name\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "default role = .+"
  not_expect  : "default role = (JBossAdmin|HttpInvoker|friend|guest)"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure the default role assignments have been removed, renamed, or commented out from the default properties files located in JBOSS_HOME/server/Default/conf/props/"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.20 - Remove default roles from production servers - 'console-mgr default role != JBossAdmin|HttpInvoker|friend|guest'"
  info        : "Remove, rename, or comment out the default role definitions in the default <application-policy> elements"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management/console-mgr.sar/web-console.war/WEB-INF/web.xml"
  xsl_stmt    : "<xsl:template match=\"web-app\">"
  xsl_stmt    : "default role = <xsl:value-of select=\"/web-app/security-constraint/auth-constraint/role-name\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "default role = .+"
  not_expect  : "default role = (JBossAdmin|HttpInvoker|friend|guest)"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
  solution    : "Ensure the default role assignments have been removed, renamed, or commented out from the default properties files located in JBOSS_HOME/server/[PROFILE
]/conf/props/"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.20 - Remove default roles from production servers - 'admin-console default role != JBossAdmin|HttpInvoker|friend|guest'"
  info        : "Remove, rename, or comment out the default role definitions in the default <application-policy> elements"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/admin-console.war/WEB-INF/web.xml"
  xsl_stmt    : "<xsl:template match=\"web-app\">"
  xsl_stmt    : "default role = <xsl:value-of select=\"/web-app/security-constraint/auth-constraint/role-name\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "default role = .+"
  not_expect  : "default role = (JBossAdmin|HttpInvoker|friend|guest)"
  reference   : "800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,8500.2|IATS-1,8500.2|IATS-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure the default role assignments have been removed, renamed, or commented out from the default properties files located in JBOSS_HOME/server/Default/conf/props/"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "1.22 DefaultCacheTimeout must be configured properly for active security domains - 'DefaultCacheTimeout <= 1800'"
  info        : "Security domains in use must use DefaultCacheTimeout less than or equal to 1800 seconds.
If you want to disable caching of security credentials, set this to 0 to force authentication to occur every time. This has no affect if the AuthenticationCacheJndiName has been changed from the default value."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-service.xml"
  xsl_stmt    : "<xsl:template  match=\"server\">"
  xsl_stmt    : "DefaultCacheTimeout = <xsl:value-of select=\"/server/mbean[@code='org.jboss.security.plugins.JaasSecurityManagerService' and @name='jboss.security:service=JaasSecurityManager']/attribute[@name='DefaultCacheTimeout']/text()\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "DefaultCacheTimeout = .+"
  expect      : "DefaultCacheTimeout = ([0-9]|[0-9][0-9]|[0-9][0-9][0-9]|1[0-7][0-9][0-9]|1800)"
  reference   : "800-53|SC-23,800-53|SC-8,800-53|SC-9,8500.2|ECTM-1,8500.2|ECTM-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Open the JaasSecurityManagerService Mbean configuration file located at JBOSS_HOME/server/Default/conf/jboss-service.xml"
  solution    : "Find the element <mbean code=\"org.jboss.security.plugins.JaasSecurityManagerService\" name=\"jboss.security:service=JaasSecurityManager\">"
  solution    : "Change the <DefaultCacheTimeout> to 1800 or less."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
  description : "1.23 snmp-adaptor.sar must not be deployed - 'JBOSS_HOME/server/Default/deploy/snmp-adaptor.sar'"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCCS-1,8500.2|DCCS-2,8500.2|DCCT-1,8500.2|DCPP-1,8500.2|DCSS-1,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
# Note: Variable @PROFILE@ replaced with "Default" in field "info".
  info        : "The file JBOSS_HOME/server/Default/deploy/snmp-adaptor.sar should not exist. snmp-adaptor.sar is the default deployment package for JBoss SNMP.  The manager implements SNMP using joeSNMP, supporting only SNMP versions 1 and 2."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/snmp-adaptor.sar"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Delete the directory JBOSS_HOME/server/Default/deploy/snmp-adaptor.sar/"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "2.1 Configure Java Security Manager to use an environment specific policy - 'JAVA_OPTS -Djava.security.manager -Djava.security.policy'"
  info        : "The Java Security Manager is a crucial piece of the Java security infrastructure. JBoss Enterprise Application Platform should be configured to load a Java security policy that has been vetted for use in the environment. This precludes the use of the simple default policy that ships with JBoss, but does not preclude the use of preconfigured policy files like the security policy designed for use in a Common Criteria environment (See JBoss Common Criteria Configuration Guide for details)."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/bin/run.conf"
  regex       : "\(\(\?:#*)JAVA_OPTS=\"\\$JAVA_OPTS -Djava\.security\.manager -Djava\.security\.policy==.*\"\)"
  expect      : "\(\(\?:#*)JAVA_OPTS=\"\\$JAVA_OPTS -Djava\.security\.manager -Djava\.security\.policy==.*\"\)"
  reference   : "800-53|SA-13,CAT|II"
  solution    : "To load an environment specific security policy, simply append the following line to JBOSS_HOME/bin/run.conf or JBOSS_HOME/bin/run.conf.bat as appropriate (depending on the host operating system)."
  solution    : "JAVA_OPTS=\"\$JAVA_OPTS -Djava.security.manager -Djava.security.policy==[PATH TO POLICY FILE]\""
  solution    : "NOTE: Using a prepackaged policy file is acceptable, as long as the policy file has been reviewed for compatibility and security within the current environment."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.23 Ensure Security Audit Appender is enabled - 'Audit Appender = true'"
  info        : "The Security Audit Appender must be enabled. The Security Audit Appender and the Security Audit Provider category together set up the audit infrastructure that allows deployed applications to easily audit authentication and authorization events."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "Audit Appender = <xsl:value-of select=\"boolean(/log4j:configuration/appender[@name='AUDIT']/@name)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Audit Appender = .+"
  expect      : "Audit Appender = [Tt][Rr][Uu][Ee]"
  reference   : "800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure the Security Audit Appender is defined within JBOSS_HOME/server/Default/conf/jboss-log4j.xml. By default, the Security Audit Appender exists and just needs to be uncommented."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.24 Ensure Security Audit Provider is enabled - 'Audit Provider = true'"
  info        : "The Security Audit Provider category must be enabled for production environments. The Security Audit Appender and the Security Audit Provider category together set up the audit infrastructure that allows deployed applications to easily audit authentication and authorization events."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "Audit Provider = <xsl:value-of select=\"boolean(/log4j:configuration/category[@name='org.jboss.security.audit.providers.LogAuditProvider']/@name)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Audit Provider = .+"
  expect      : "Audit Provider = [Tt][Rr][Uu][Ee]"
  reference   : "800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure the Security Audit Provider category is defined within JBOSS_HOME/server/Default/conf/jboss-log4j.xml. By default, the Security Audit Provider category exists and just needs to be uncommented."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.25 Ensure Configure SecurityInterceptor logging level is set correctly - 'org.jboss.ejb.plugins.SecurityInterceptor = true'"
  info        : "Production environments of JBoss require enhanced auditing on the SecurityInterceptor class."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "org.jboss.ejb.plugins.SecurityInterceptor = <xsl:value-of select=\"boolean(/log4j:configuration/category[@name='org.jboss.ejb.plugins.SecurityInterceptor']/priority[@value='TRACE']/@value)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "org.jboss.ejb.plugins.SecurityInterceptor = .+"
  expect      : "org.jboss.ejb.plugins.SecurityInterceptor = [Tt][Rr][Uu][Ee]"
  reference   : "800-53|AU-12,8500.2|ECAT-1,8500.2|ECAT-2,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure a category is defined for SecurityInterceptor class with a priority of TRACE within JBOSS_HOME/server/Default/conf/jboss-log4j.xml."
  solution    : "&lt;category name=\"org.jboss.ejb.plugins.SecurityInterceptor\"&gt;
	&lt;priority value=\"TRACE\" /&gt;
	&lt;appender-ref ref=\"AUDIT\" /&gt;
&lt;/category&gt;"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.26 Ensure logging is enabled for Microcontainer bootstrap operations - 'SecurityInterceptor logging level = true'"
  info        : "Production environments of JBoss require auditing for Microcontainer bootstrap operations."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "SecurityInterceptor logging level = <xsl:value-of select=\"boolean(/log4j:configuration/category[@name='org.jboss.bootstrap.microcontainer']/priority[@value='INFO']/@value)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "SecurityInterceptor logging level = .+"
  expect      : "SecurityInterceptor logging level = [Tt][Rr][Uu][Ee]"
  reference   : "800-53|AU-12,800-53|AU-3,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECLC-1,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Set the priority and appender-ref levels for the Microcontainer bootstrap by adding the <category> block as specified to JBOSS_HOME/server/Default/conf/jboss-log4j.xml."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.27 - Ensure logging is enabled for web-based requests if required by deployed applications - 'AccessLogValve = true'"
  info        : "In the event that application requirements dictate additional logging for web-based requests, the AccessLogValve should be enabled."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jbossweb.sar/server.xml"
  xsl_stmt    : "<xsl:template  match=\"Server\">"
  xsl_stmt    : "AccessLogValve = <xsl:value-of select=\"boolean(/Server/Service/Engine/Host/Valve[@className='org.apache.catalina.valves.AccessLogValve'])\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "AccessLogValve = .+"
  expect      : "AccessLogValve = true"
  reference   : "800-53|AU-12,800-53|AU-3,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,8500.2|ECAT-1,8500.2|ECAT-2,8500.2|ECLC-1,CAT|II"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Ensure the following <Valve> exists within: JBOSS_HOME/server/Default/deploy/jbossweb.sar/server.xml. By default, this <Valve> simply needs to be uncommented."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.28 Ensure all required information is displayed in &lt;layout&gt; - 'ConversionPattern = \%d \%-5p \\[\%c\\] \\(\%t:\%x\\) \%m\%n'"
  info        : "The Security Audit Appender must log all identified information."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "ConversionPattern = <xsl:value-of select=\"/log4j:configuration/appender[@name='AUDIT']/layout[@class='org.apache.log4j.PatternLayout']/param[@name='ConversionPattern']/@value\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "ConversionPattern = .+"
  expect      : "ConversionPattern = \%d \%-5p \\[\%c\\] \\(\%t:\%x\\) \%m\%n"
  reference   : "800-171|3.4.1,800-53|CM-8,8500.2|ECAR-2,8500.2|ECAT-1,CAT|III,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "Enable server startup and shutdown events by making the following change to JBOSS_HOME/server/Default/conf/jboss-log4j.xml. Update the ConversionPattern parameter in the Security Audit Appender to show thread information by replacing the default ConversionPattern with the pattern below:"
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "2.29 Production applications should not log output to the JBoss console - 'JBoss console output log = false'"
  info        : "Turn off console logging in production. Console logging in a production environment is a needless drain on system resources."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jboss-log4j.xml"
  xsl_stmt    : "<xsl:template  match=\"log4j:configuration\">"
  xsl_stmt    : "JBoss console output log = <xsl:value-of select=\"boolean(/log4j:configuration/root/appender-ref[@ref='CONSOLE']/@ref)\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "JBoss console output log = .+"
  expect      : "JBoss console output log = [Ff][Aa][Ll][Ss][Ee]"
  reference   : "800-53|AU-9,8500.2|ECTB-1,8500.2|ECTP-1,CAT|III"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "In order to prevent JBoss from logging to console, open the JBOSS_HOME/server/Default/conf/jboss-log4j.xml file. Next, remove or comment out the &lt;appender-ref&gt; element with a ref attribute value of 'CONSOLE'. This &lt;appender-ref&gt; element will be a child of the &lt;root&gt; element, typically located near the end of the document."
  solution    : "&lt;root&gt;
&lt;!--Set the root logger priority via a system property. Note this is parsed by log4j,
so the full JBoss system property format is not supported; e.g.
setting a default via ${jboss.server.log.threshold:WARN} will not work.--&gt;
	&lt;priority value=\"${jboss.server.log.threshold}\"/&gt;
		&lt;!-- appender-ref ref=\"CONSOLE\"/ --&gt;
	&lt;appender-ref ref=\"ASYNC\"/&gt;
&lt;/root&gt;"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "2.31 - Deny the JBoss process owner console access"
  info        : "The JBoss Application Server process owner should not have interactive console login access"
  file        : "/etc/passwd"
  regex       : "^jboss:x:"
  expect      : "jboss:x:[0-9]+:[0-9]+::.+:/sbin/nologin"
  reference   : "800-171|3.1.5,800-53|AC-6,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
  solution    : "To prevent users from gaining interactive access to the system console, simply ensure that they are assigned no shell interpreter via the /etc/passwd file. For instance, a properly configured passwd entry for the JBoss account owner may resemble this:"
  solution    : "jboss:x:494:494:JBossAS:/var/lib/jbossas:/sbin/nologin"
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "2.32/2.33 - Set JBoss file ownership/permissions"
  info        : "All JBoss Enterprise Application Platform files within JBOSS_HOME should be owned by the JBoss process owner account"
  info        : "NOTE: Update {JBOSS_Process_Account_Owner} to the appropriate JBoss process owner account"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/*"
  owner       : "{JBOSS_Process_Account_Owner}"
  mask        : "033"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "On Red Hat and Linux, use chown to ensure the JBoss process owner owns all JBoss configuration files (JBOSS_HOME and subdirectories); JBoss administrators may be the group owners."
</custom_item>

<if>
  <condition type:"OR">
    <custom_item>
      type        : FILE_CHECK_NOT
      description : "3.1 Ensure JMX Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.1 Ensure JMX Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = true"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "3.1 Ensure JMX Console is either secured or removed  - 'java:/jaas/jmx-console = true'"
      info        : "The JMX Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : FILE_CHECK_NOT
      description : "3.1 Ensure JMX Console is either secured or removed - 'java:/jaas/jmx-console = true' - jmx-console.war"
      info        : "The JMX Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      solution    : "This rule can be made compliant by either:"
      solution    : "Remove the JBoss JMX Console from deployment."
      solution    : "or"
      solution    : "First, ensure that an &lt;application-policy&gt; element is defined that requires authentication. Default policies exist for jmx-console and web-console. Example of a satisfactory element:"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Next, check the JBOSS_HOME/server/Default/deploy/jmx-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain requiring authentication has been referenced (example: &lt;security-domain&gt;java:/jaas/jmx-console&lt;/security-domain&gt;). If no &lt;security-domain&gt; element exists, add it as a child of &lt;jboss-web&gt;."
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Next, review the JBOSS_HOME/server/Default/deploy/jmx-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow side channel access to malicious users."
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Finally, configure the usersProperties defined in the application policy to manage accounts. Example editing JBOSS_HOME/server/Default/conf/props/jmx-console-users.properties:"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.1 Ensure JMX Console is either secured or removed - 'java:/jaas/jmx-console = true'"
      info        : "The JMX Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = [Tt][Rr][Uu][Ee]"
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
      solution    : "This rule can be made compliant by either:"
      solution    : "Remove the JBoss JMX Console from deployment."
      solution    : "or"
      solution    : "First, ensure that an &lt;application-policy&gt; element is defined that requires authentication. Default policies exist for jmx-console and web-console. Example of a satisfactory element:"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Next, check the JBOSS_HOME/server/Default/deploy/jmx-console.war/WEB-INF/jboss-web.xml file to ensure that a security domain requiring authentication has been referenced (example: &lt;security-domain&gt;java:/jaas/jmx-console&lt;/security-domain&gt;). If no &lt;security-domain&gt; element exists, add it as a child of &lt;jboss-web&gt;."
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Next, review the JBOSS_HOME/server/Default/deploy/jmx-console.war/WEB-INF/web.xml. The &lt;security-constraint&gt; must not contain the default limitations on HTTP verbs. For example: &lt;http-method&gt;GET&lt;/http-method&gt; or &lt;http-method&gt;POST&lt;/http-method&gt;. The default limitations were shown to allow side channel access to malicious users."
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Finally, configure the usersProperties defined in the application policy to manage accounts. Example editing JBOSS_HOME/server/Default/conf/props/jmx-console-users.properties:"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      type        : FILE_CHECK_NOT
      description : "Ensure Web Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/admin-console.war"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "Ensure Web Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/admin-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = true"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "3.2 Ensure Web Console is either secured or removed - 'JBOSS_HOME/server/Default/deploy/admin-console.war'"
      info        : "The Web Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "3.2 Ensure Web Console is either secured or removed - 'JBOSS_HOME/server/Default/deploy/admin-console.war'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/admin-console.war"
      info        : "The Web Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      solution    : "This rule can be made compliant by either:"
      solution    : "Require authorization for access to the JBoss Web Console."
      solution    : "or"
      solution    : "Remove the JBoss Web Console from deployment."
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.2 Ensure Web Console is either secured or removed - 'java:/jaas/jmx-console = true'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/admin-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = [Tt][Rr][Uu][Ee]"
      info        : "The Web Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
      solution    : "This rule can be made compliant by either:"
      solution    : "Require authorization for access to the JBoss Web Console."
      solution    : "or"
      solution    : "Remove the JBoss Web Console from deployment."
    </custom_item>
  </else>
</if>

<if>
  <condition type:"OR">
    <custom_item>
      type        : FILE_CHECK_NOT
      description : "Ensure Admin Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "Ensure Admin Console is either secured or removed"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management/console-mgr.sar/web-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"jboss-web\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = true"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "3.3 Ensure Admin Console is either secured or removed"
      info        : "The Administration Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : FILE_CHECK_NOT
# Note: Variable @PROFILE@ replaced with "Default" in field "description".
      description : "3.3 Ensure Admin Console is either secured or removed - 'JBOSS_HOME/server/Default/deploy/management'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management"
      info        : "The Administration Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      solution    : "This rule can be made compliant by either:"
      solution    : "Require authorization for access to the JBoss Administration Console."
      solution    : "or"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "To remove the Administration Console from deployment, delete the exploded SAR located here: JBOSS_HOME/server/Default/deploy/admin-console.war/"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.3 Ensure Admin Console is either secured or removed - 'java:/jaas/jmx-console = true'"
      info        : "The Administration Console application must be secured so it is accessible by trusted administrators only. If this condition is not met, the application must be removed (deleted) from deployment."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management/console-mgr.sar/web-console.war/WEB-INF/jboss-web.xml"
      xsl_stmt    : "<xsl:template  match=\"jboss-web\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/jboss-web/security-domain/text())\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = [Tt][Rr][Uu][Ee]"
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
      solution    : "This rule can be made compliant by either:"
      solution    : "Require authorization for access to the JBoss Administration Console."
      solution    : "or"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "To remove the Administration Console from deployment, delete the exploded SAR located here: JBOSS_HOME/server/Default/deploy/admin-console.war/"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : AUDIT_XML
      description : "3.4 The JMXInvokerServlet servlet must be secured against web attacks"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml"
      xsl_stmt    : "<xsl:template  match=\"web-app\">"
      xsl_stmt    : "http-method,GET = <xsl:value-of select=\"boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'GET')])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "http-method,GET = .+"
      expect      : "http-method,GET = false"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be secured against web attacks - POST"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml"
      xsl_stmt    : "<xsl:template  match=\"web-app\">"
      xsl_stmt    : "http-method,'POST' = <xsl:value-of select=\"boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'POST')])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "http-method,'POST' = .+"
      expect      : "http-method,'POST' = false"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "3.4 The JMXInvokerServlet servlet must be secured against web attacks"
      info        : "The httpha-invoker.sar found in the deploy directory is a service that provides RMI/HTTP access for EJBs and the JNDI Naming service. By default older JBoss versions ship with a default set of &lt;http-method&gt; that allow attackers to bypass the security policy for JMX Invoker."
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : AUDIT_XML
      description : "3.4 The JMXInvokerServlet servlet must be secured against web attacks - 'http-method,GET = false'"
      info        : "The httpha-invoker.sar found in the deploy directory is a service that provides RMI/HTTP access for EJBs and the JNDI Naming service. By default older JBoss versions ship with a default set of &lt;http-method&gt; that allow attackers to bypass the security policy for JMX Invoker."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml"
      xsl_stmt    : "<xsl:template  match=\"web-app\">"
      xsl_stmt    : "http-method,GET = <xsl:value-of select=\"boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'GET')])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "http-method,GET = .+"
      expect      : "http-method,GET = false"
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Within the JBOSS_HOME/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml file, the following lines must be removed from the web-app/security-constraint/web-resource-collection node:"
      solution    : "&lt;http-method&gt;GET&lt;/http-method&gt;&lt;http-method&gt;POST&lt;/http-method&gt;"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.4 The JMXInvokerServlet servlet must be secured against web attacks - 'http-method,'POST' = false'"
      info        : "The httpha-invoker.sar found in the deploy directory is a service that provides RMI/HTTP access for EJBs and the JNDI Naming service. By default older JBoss versions ship with a default set of &lt;http-method&gt; that allow attackers to bypass the security policy for JMX Invoker."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml"
      xsl_stmt    : "<xsl:template  match=\"web-app\">"
      xsl_stmt    : "http-method,'POST' = <xsl:value-of select=\"boolean(/web-app/security-constraint/web-resource-collection[contains(http-method,'POST')])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "http-method,'POST' = .+"
      expect      : "http-method,'POST' = false"
      reference   : "800-53|AC-3,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Within the JBOSS_HOME/server/Default/deploy/httpha-invoker.sar/invoker.war/WEB-INF/web.xml file, the following lines must be removed from the web-app/security-constraint/web-resource-collection node:"
      solution    : "&lt;http-method&gt;GET&lt;/http-method&gt; &lt;http-method&gt;POST&lt;/http-method&gt;"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-invoker-service.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthenticationInterceptor' and @securityDomain='java:/jaas/jmx-console'])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = true"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "usersProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "usersProperties = .+"
      expect      : "usersProperties = props/jmx-console-users.properties"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "rolesProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "rolesProperties = .+"
      expect      : "rolesProperties = props/jmx-console-roles.properties"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "3.5 The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
      reference   : "800-53|IA-2,800-53|IA-3,8500.2|EBRU-1,8500.2|IAGA-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : AUDIT_XML
      description : "3.5 The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication - 'java:/jaas/jmx-console = true'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-invoker-service.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "java:/jaas/jmx-console = <xsl:value-of select=\"boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthenticationInterceptor' and @securityDomain='java:/jaas/jmx-console'])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "java:/jaas/jmx-console = .+"
      expect      : "java:/jaas/jmx-console = true"
      reference   : "800-53|IA-2,800-53|IA-3,8500.2|EBRU-1,8500.2|IAGA-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.5 JMXInvokerServlet configuration - 'usersProperties = props/jmx-console-users.properties'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "usersProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "usersProperties = .+"
      expect      : "usersProperties = props/jmx-console-users.properties"
      reference   : "800-53|IA-2,800-53|IA-3,8500.2|EBRU-1,8500.2|IAGA-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.5 JMXInvokerServlet servlet configuration - 'rolesProperties = props/jmx-console-roles.properties'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. This interface must be made unavailable to unprivileged users which can be done by using the org.jboss.jmx.connector.invoker.AuthenticationInterceptor interceptor for performing identification and authentication using JAAS."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "rolesProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "rolesProperties = .+"
      expect      : "rolesProperties = props/jmx-console-roles.properties"
      reference   : "800-53|IA-2,800-53|IA-3,8500.2|EBRU-1,8500.2|IAGA-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>
  </else>
</if>

<if>
  <condition type:"AND">
    <custom_item>
      type        : AUDIT_XML
      description : "JMXInvokerServlet servlet configuration - 'org.jboss.jmx.connector.invoker.RolesAuthorization = true'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-invoker-service.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "org.jboss.jmx.connector.invoker.RolesAuthorization = <xsl:value-of select=\"boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthorizationInterceptor' and @authorizingClass='org.jboss.jmx.connector.invoker.RolesAuthorization'])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "org.jboss.jmx.connector.invoker.RolesAuthorization = .+"
      expect      : "org.jboss.jmx.connector.invoker.RolesAuthorization = true"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "usersProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "usersProperties = .+"
      expect      : "usersProperties = props/jmx-console-users.properties"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "rolesProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "rolesProperties = .+"
      expect      : "rolesProperties = props/jmx-console-roles.properties"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "3.6 The JMXInvokerServlet servlet must be configured to prevent unprivileged access using authentication"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization."
      reference   : "800-53|AC-3,800-53|AC-6,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,8500.2|ECLP-1,CAT|I"
    </report>
  </then>

  <else>
    <custom_item>
      type        : AUDIT_XML
      description : "3.6 JMXInvokerServlet configuration  - 'org.jboss.jmx.connector.invoker.RolesAuthorization = true'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-invoker-service.xml"
      xsl_stmt    : "<xsl:template  match=\"server\">"
      xsl_stmt    : "org.jboss.jmx.connector.invoker.RolesAuthorization = <xsl:value-of select=\"boolean(/server/mbean/xmbean/operation[contains(name,'invoke')]/descriptors/interceptors/interceptor[@code='org.jboss.jmx.connector.invoker.AuthorizationInterceptor' and @authorizingClass='org.jboss.jmx.connector.invoker.RolesAuthorization'])\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "org.jboss.jmx.connector.invoker.RolesAuthorization = .+"
      expect      : "org.jboss.jmx.connector.invoker.RolesAuthorization = true"
      reference   : "800-53|AC-3,800-53|AC-6,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,8500.2|ECLP-1,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.6 JMXInvokerServlet configuration - 'usersProperties = props/jmx-console-users.properties'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "usersProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='usersProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "usersProperties = .+"
      expect      : "usersProperties = props/jmx-console-users.properties"
      reference   : "800-53|AC-3,800-53|AC-6,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,8500.2|ECLP-1,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>

    <custom_item>
      type        : AUDIT_XML
      description : "3.6 JMXInvokerServlet configuration - 'rolesProperties = props/jmx-console-roles.properties'"
      info        : "The jmx-invoker-service.xml is a service that exposes the JMX MBeanServer interface via an RMI compatible interface using the RMI/JRMP detached invoker service. Access control for authenticated users must be configured using the interceptors of either org.jboss.jmx.connector.invoker.RolesAuthorization or org.jboss.jmx.connector.invoker.ExternalizableRolesAuthorization."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
      file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/login-config.xml"
      xsl_stmt    : "<xsl:template  match=\"policy\">"
      xsl_stmt    : "rolesProperties = <xsl:value-of select=\"/policy/application-policy[@name='jmx-console']/authentication/login-module[@code='org.jboss.security.auth.spi.UsersRolesLoginModule' and @flag='required']/module-option[@name='rolesProperties']/text()\"/>"
      xsl_stmt    : "</xsl:template>"
      regex       : "rolesProperties = .+"
      expect      : "rolesProperties = props/jmx-console-roles.properties"
      reference   : "800-53|AC-3,800-53|AC-6,8500.2|ECAN-1,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECCR-2,8500.2|ECIC-1,8500.2|ECLP-1,CAT|I"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
      solution    : "Open JBOSS_HOME/server/Default/deploy/jmx-invoker-service.xml, and ensure the &lt;operation&gt; element with child element &lt;name&gt;invoke&lt;/name&gt; also contains the following &lt;interceptor&gt;:"
    </custom_item>
  </else>
</if>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb3-connectors-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb3-connectors-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb3-interceptors-aop.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb3-interceptors-aop.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb3-timerservice-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb3-timerservice-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'profile-service-secured.jar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/profile-service-secured.jar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb2-container-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb2-container-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb2-timer-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/ejb2-timer-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'jboss-ejb3-endpoint-deployer.jar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/jboss-ejb3-endpoint-deployer.jar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.2 - Unused features should be disabled or deleted: Enterprise Java Beans (EJB) Services - 'ejb3-deployers-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/ejb3-deployers-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.3 - Unused features should be disabled or deleted: Universal Unique Identifier (UUID) Generator - 'uuid-key-generator.sar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/uuid-key-generator.sar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "In order to completely disable the this component, Delete this directory:

JBOSS_HOME/server/Default/deploy/uuid-key-generator.sar"
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.4 - Unused features should be disabled or deleted: Java Message Service (JMS) - 'messaging-roles.properties'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/messaging-roles.properties"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.4 - Unused features should be disabled or deleted: Java Message Service (JMS) - 'messaging-users.properties'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/messaging-users.properties"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.4 - Unused features should be disabled or deleted: Java Message Service (JMS) - 'messaging'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/messaging"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.4 - Unused features should be disabled or deleted: Java Message Service (JMS) - 'quartz-ra.rar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/quartz-ra.rar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.4 - Unused features should be disabled or deleted: Java Message Service (JMS) - 'messaging-definitions-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/messaging-definitions-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.5 - Unused features should be disabled or deleted: JBoss Mail - 'mail-ra.rar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/mail-ra.rar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.5 - Unused features should be disabled or deleted: JBoss Mail - 'mail-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/mail-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.6 - Unused features should be disabled or deleted: JBoss Scheduling - 'schedule-manager-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/schedule-manager-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.6 - Unused features should be disabled or deleted: JBoss Scheduling - 'scheduler-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/scheduler-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.7 - Unused features should be disabled or deleted: Hypersonic SQL Database (HSQLDB) - 'hsqldb-ds.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/hsqldb-ds.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.7 - Unused features should be disabled or deleted: Hypersonic SQL Database (HSQLDB) - 'hsqldb.jar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/common/lib/hsqldb.jar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.7 - Unused features should be disabled or deleted: Hypersonic SQL Database (HSQLDB) - 'hsqldb-persistence-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/messaging/hsqldb-persistence-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.7 - Unused features should be disabled or deleted: Hypersonic SQL Database (HSQLDB) - 'data/hypersonic'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/data/hypersonic"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.8 - Unused features should be disabled or deleted: BeanShell (BSH) Deployer - 'bsh.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/bsh.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jax-ws-catalog.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/jax-ws-catalog.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jbossws-roles.properties'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/jbossws-roles.properties"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jbossws-users.properties'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/conf/props/jbossws-users.properties"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jbossws.sar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jbossws.sar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jbossws-console.war'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jbossws-console.war"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.9 - Unused features should be disabled or deleted: JBossWS - 'jbossws.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/jbossws.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.10 - Unused features should be disabled or deleted: Seam - 'seam.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/seam.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.10 - Unused features should be disabled or deleted: Seam - 'webbeans.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/webbeans.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.11 - Unused features should be disabled or deleted: JBoss Internet Inter-ORB Protocol (IIOP) - 'webbeans.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/webbeans.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.11 - Unused features should be disabled or deleted: JBoss Internet Inter-ORB Protocol (IIOP) - 'iiop-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/iiop-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.11 - Unused features should be disabled or deleted: JBoss Internet Inter-ORB Protocol (IIOP) - 'ejb3-iiop-deployers-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deployers/ejb3.deployer/META-INF/ejb3-iiop-deployers-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.11 - Unused features should be disabled or deleted: JBoss Internet Inter-ORB Protocol (IIOP) - 'jacorb.jar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/lib/jacorb.jar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'xnio.deployer'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/alldeployers/xnio.deployer"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'hibernate-deployer-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/alldeployers/hibernate-deployer-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'jboss-xa-jdbc.rar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jboss-xa-jdbc.rar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'jmx-console.war'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-console.war"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'profileservice-jboss-beans.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/profileservice-jboss-beans.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'sqlexception-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/sqlexception-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'xnio-provider.jar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/xnio-provider.jar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.12 - Unused features should be disabled or deleted: Miscellaneous - 'deploy/management'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/management"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.13 - Unused features should be disabled or deleted: HTTP Invokers - 'http-invoker.sar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/http-invoker.sar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.13 - Unused features should be disabled or deleted: HTTP Invokers - 'httpha-invoker.sar'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/httpha-invoker.sar"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.14 - Unused features should be disabled or deleted: Java Management Extensions (JMX) Invoker - 'jmx-invoker-service.xml'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/jmx-invoker-service.xml"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "7.15 - Unused features should be disabled or deleted: Pooled Invoker - 'jboss:service=invoker,type=pooled = false'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/legacy-invokers-service.xml"
  xsl_stmt    : "<xsl:template  match=\"server\">"
  xsl_stmt    : "jboss:service=invoker,type=pooled = <xsl:value-of select=\"boolean(/server/mbean[@name='jboss:service=invoker,type=pooled'])\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "jboss:service=invoker,type=pooled = .+"
  expect      : "jboss:service=invoker,type=pooled = false"
  reference   : "800-53|CM-7,8500.2|DCPP-1,CAT|III"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "In order to completely disable this component, take the following actions:

In JBOSS_HOME/server/Default/deploy/legacy-invokers-service.xml, Delete the <mbean> with name attribute of \"jboss:service=invoker,type=pooled\""
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "7.16 - Unused features should be disabled or deleted: Java Remote Method Protocol (JRMP) Invoker - 'jboss:service=invoker,type=jmrp = false'"
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/legacy-invokers-service.xml"
  xsl_stmt    : "<xsl:template  match=\"server\">"
  xsl_stmt    : "jboss:service=invoker,type=jmrp = <xsl:value-of select=\"boolean(/server/mbean[@name='jboss:service=invoker,type=jmrp'])\"/>"
  xsl_stmt    : "</xsl:template>"
  regex       : "jboss:service=invoker,type=jmrp = .+"
  expect      : "jboss:service=invoker,type=jmrp = false"
  reference   : "800-53|CM-7,8500.2|DCPP-1,CAT|III"
# Note: Variable @PROFILE@ replaced with "Default" in field "solution".
  solution    : "In order to completely disable this component, take the following actions:

In JBOSS_HOME/server/Default/deploy/legacy-invokers-service.xml, Delete the <mbean> with name attribute of \"jboss:service=invoker,type=jmrp\""
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.14 - Unused features should be disabled or deleted: Java Management Extensions (JMX) Invoker - 'deploy-hasingleton'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy-hasingleton"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.14 - Unused features should be disabled or deleted: Java Management Extensions (JMX) Invoker - 'farm'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/farm"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "7.14 - Unused features should be disabled or deleted: Java Management Extensions (JMX) Invoker - 'deploy/cluster'"
  info        : "Features and services not in use should be removed."
# Note: Variable @JBOSS_HOME@ replaced with "/usr/jboss/jboss-5.0.GA" in field "file".
# Note: Variable @PROFILE@ replaced with "Default" in field "file".
  file        : "/usr/jboss/jboss-5.0.GA/server/Default/deploy/cluster"
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
  solution    : "In order to completely disable this component, Delete the file."
</custom_item>

</check_type>
