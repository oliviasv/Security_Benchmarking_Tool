#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
#
# @PROFESSIONALFEED@
#
# $Revision: 1.35 $
# $Date: 2020/07/14 $
#
# Description	: This is based on the CIS FreeBSD Benchmark v1.0.5
# 	  (FreeBSD 4.10 and above)
# 	  Copyright 2001-2005, The Center for Internet Security
# 	  https://workbench.cisecurity.org/files/632
#
#<ui_metadata>
#<display_name>CIS FreeBSD v1.0.5</display_name>
#<spec>
#  <type>CIS</type>
#  <name>FreeBSD</name>
#  <version>1.0.5</version>
#  <link>https://workbench.cisecurity.org/files/632</link>
#</spec>
#<labels>unix,cis,freebsd,freebsd_10.5,agent</labels>
#<variables>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>All activities performed on this system will be monitored.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Verify that FreeBSD 4.X or higher is installed"
      cmd         : "uname -rs"
      expect      : "FreeBSD[\\s]+([4-9]|1[0-9])\."
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS FreeBSD Benchmark v1.0.5"
      see_also    : "https://workbench.cisecurity.org/files/632"
    </report>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.2. Enable SSH (Protocol 2)"
      info             : "This check reports a problem if sshd_config parameter Protocol is not set and placed after Host"
      reference        : "800-53|CM-7,CIP|007-6-R1,CSF|PR.IP-1,CSF|PR.PT-3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ssh/sshd_config"
      regex            : "^[\\s]*Protocol\\s2$"
      expect           : "Protocol\\s2"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.2. Enable SSH (PermitRootLogin)"
      info             : "This check reports a problem if sshd_config paramter allows root login"
      reference        : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ssh/sshd_config"
      regex            : "^[\\s]*PermitRootLogin\\sno$"
      expect           : "PermitRootLogin[\\s]+no"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.2. Enable SSH (Banner)"
      info             : "This check fails if Banner is not set"
      reference        : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ssh/sshd_config"
      regex            : "^[\\s]*Banner[\\s]"
      expect           : "Banner"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "1.2. Enable SSH (/etc/ssh/sshd_config)"
      info        : "Check if /etc/ssh/sshd_config is chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/ssh/sshd_config"
      owner       : "root"
      mask        : "177"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.2. Enable SSH (sshd_enable)"
      info             : "This check reports if SSH is enabled on system boot in rc.conf"
      reference        : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*sshd_enable=.*YES.*"
      expect           : "sshd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CHECK
      description      : "1.3. Enable TCP Wrappers and a host based firewall (/etc/hosts.allow)"
      info             : "This check fails if /etc/hosts.allow is not found"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/hosts.allow"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.3. Enable TCP Wrappers and a host based firewall (inetd_enable)"
      info             : "This check fails if wrappers are not turned on"
      reference        : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*inetd_enable=.*YES.*"
      expect           : "inetd_enable=.*YES.*"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.3. Enable TCP Wrappers and a host based firewall (inetd_flags)"
      info             : "This check fails if flags are not set"
      reference        : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*inetd_flags=.*Wwl -C60.*"
      expect           : "inetd_flags=.*Wwl -C60.*"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.3. Enable TCP Wrappers and a host based firewall (firewall_enable)"
      info             : "This check fails if a host-based firewall is not turned on"
      reference        : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*firewall_enable=.*YES.*"
      expect           : "firewall_enable=.*YES.*"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "1.3. Enable TCP Wrappers and a host based firewall (ipfw_load)"
      info             : "This check fails if a host-based firewall has not been added to /boot/loader.conf"
      reference        : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/boot/loader.conf"
      regex            : "^[\\s]*ipfw_load=.*YES.*"
      expect           : "ipfw_load=.*YES.*"
      required         : YES
      search_locations : "/boot"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.1. Disable all inetd daemons"
      info             : "This check will fail if /etc/inetd.conf has enabled daemons"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*[a-zA-Z0-9]"
      expect           : ".*"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.2. Only enable telnetd if absolutely necessary"
      info             : "This checks fails if telnet is on in /etc/inetd.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*telnet[\\s]"
      expect           : "^[\\s]*telnet[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.3. Only enable ftpd if absolutely necessary"
      info             : "This checks fails if FTP is on in /etc/inetd.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*ftp[\\s]"
      expect           : "^[\\s]*ftp[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.4. Only enable rlogin/rsh/rcp if absolutely necessary (shell)"
      info             : "This check fails if shell is on in /etc/inetd.conf -- this allows rlogin, rsh and rcp to be in place"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*shell[\\s]"
      expect           : "^[\\s]*shell[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.4. Only enable rlogin/rsh/rcp if absolutely necessary (login)"
      info             : "This check fails if login is on in /etc/inetd.conf -- this allows rlogin, rsh and rcp to be in place"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*login[\\s]"
      expect           : "^[\\s]*login[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.5. Only enable TFTP if absolutely necessary"
      info             : "This checks fails if TFTP is on in /etc/inetd.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*tftp[\\s]"
      expect           : "^[\\s]*tftp[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.6. Only enable finger if absolutely necessary"
      info             : "This checks fails if finger is on in /etc/inetd.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/inetd.conf"
      regex            : "^[\\s]*finger[\\s]"
      expect           : "^[\\s]*finger[\\s]"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.7. Only enable Kerberos-related daemons if absolutely necessary (kerberos5_enable)"
      info             : "This checks fails if kerberos 5 is on in /etc/rc.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*kerberos5_enable=.*YES.*"
      expect           : "kerberos5_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.7. Only enable Kerberos-related daemons if absolutely necessary (kadmind5_server_enable)"
      info             : "This checks fails if kerberos 5 is on in /etc/rc.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*kadmind5_server_enable=.*YES.*"
      expect           : "kadmind5_server_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "2.7. Only enable Kerberos-related daemons if absolutely necessary (kpasswdd_server_enable)"
      info             : "This checks fails if kerberos 5 is on in /etc/rc.conf"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*kpasswdd_server_enable=.*YES.*"
      expect           : "kpasswdd_server_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "2.8. Minimize the inetd.conf file"
      info        : "Check for owner and permissions /etc/inetd.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/inetd.conf"
      owner       : "root"
      mask        : "333"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.1. Disable login prompts on serial ports (ttyd0)"
      info             : "This checks if login is allowed on serial port ttyd0. It should be off to prevent users from connecting terminals to serial ports"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "ttyd0.*"
      expect           : "ttyd0.*dialup.*off.*secure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.1. Disable login prompts on serial ports (ttyd1)"
      info             : "This checks if login is allowed on serial port ttyd1. It should be off to prevent users from connecting terminals to serial ports"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "ttyd1.*"
      expect           : "ttyd1.*dialup.*off.*secure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.1. Disable login prompts on serial ports (ttyd2)"
      info             : "This checks if login is allowed on serial port ttyd2. It should be off to prevent users from connecting terminals to serial ports"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "ttyd2.*"
      expect           : "ttyd2.*dialup.*off.*secure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.1. Disable login prompts on serial ports (ttyd3)"
      info             : "This check reports if login is allowed on serial port ttyd3. It should be off to prevent users from connecting terminals to serial ports"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "ttyd3.*"
      expect           : "ttyd3.*dialup.*off.*secure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.2. Set password on single user console"
      info             : "This check will fail if a password is not set for single user console"
      reference        : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "^[\\s]*console.*"
      expect           : "^[\\s]*console.*insecure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CONTENT_CHECK
      description : "3.3. Set daemon umask (/etc/* umask)"
      info        : "Check for a good umask in all rc files"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/*"
      regex       : "^[\\s]*umask[\\s]+022$"
      expect      : "^[\\s]*umask[\\s]+022$"
      ignore      : "/etc/periodic/*"
      ignore      : "/etc/profile"
      ignore      : "/etc/csh.login"
      ignore      : "/etc/csh.cshrc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CONTENT_CHECK
      description : "3.3. Set daemon umask (/usr/local/etc/rc.d umask)"
      info        : "Check for a good umask in all rc files"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/usr/local/etc/rc.d"
      regex       : "^[\\s]*umask[\\s]+022$"
      expect      : "^[\\s]*umask[\\s]+022$"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CONTENT_CHECK
      description : "3.3. Set daemon umask (/usr/local/etc/rc.d/* umask)"
      info        : "Check for a good umask in all rc files"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/usr/local/etc/rc.d/*"
      regex       : "^[\\s]*umask[\\s]+022$"
      expect      : "^[\\s]*umask[\\s]+022$"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CONTENT_CHECK
      description : "3.3. Set daemon umask (/etc/periodic/* umask)"
      info        : "Check for a good umask in all rc files"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/periodic/*"
      regex       : "^[\\s]*umask[\\s]+077$"
      expect      : "^[\\s]*umask[\\s]+077$"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.4. Prevent syslogd from accepting messages from the network"
      info             : "This checks if syslogd -s is turned on, -s hinders syslogd from interacting with the network"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*syslogd_flags.*-s.*"
      expect           : "syslogd_flags=.*-s.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.5. Disable the email server if possible (sendmail_enable)"
      info             : "This checks if sendmail is set to yes. Sendmail should be off if not necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*sendmail_enable=.*YES*"
      expect           : "sendmail_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.5. Disable the email server if possible (sendmail_submit_enable)"
      info             : "This checks sendmail_submit_enable it is set to yes by default. It should be turned off if sendmail is not necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*sendmail_submit_enable=.*NO*"
      expect           : "sendmail_submit_enable=.*NO.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.5. Disable the email server if possible (sendmail_outbound_enable)"
      info             : "This checks sendmail_outbound_enable it is set to yes by default. It should be turned off if sendmail is not necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*sendmail_outbound_enable=.*NO*"
      expect           : "sendmail_outbound_enable=.*NO.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.5. Disable the email server if possible (sendmail_msp_queue_enable)"
      info             : "This checks sendmail_msp_queue_enable it is set to yes by default. It should be turned off if sendmail is not necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*sendmail_msp_queue_enable=.*NO*"
      expect           : "sendmail_msp_queue_enable=.*NO.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.6. Only enable BIND if absolutely necessary"
      info             : "This checks if named is enabled. Only enable BIND if necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*named_enable.*YES*"
      expect           : "named_enable.*YES*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.7. Only enable other RPC-based services if absolutely necessary (rpc_lockd_enable)"
      info             : "This checks if rpc lockd service is enabled. Only enable if rpc-based services are necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*rpc_lockd_enable=.*YES*"
      expect           : "rpc_lockd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.7. Only enable other RPC-based services if absolutely necessary (rpc_statd_enable)"
      info             : "This checks if rpc statd service is enabled. Only enable if rpc-based services are necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*rpc_statd_enable=.*YES*"
      expect           : "rpc_statd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.7. Only enable other RPC-based services if absolutely necessary (rpcbind_enable)"
      info             : "This checks if rpc bind service is enabled. Only enable if rpc-based services are necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*rpcbind_enable=.*YES*"
      expect           : "rpcbind_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.8. Only enable the NFS server if absolutely necessary (nfs_server_enable)"
      info             : "This checks if nfs server is enabled. Only enable if nfs server is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nfs_server_enable=.*YES*"
      expect           : "nfs_server_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.8. Only enable the NFS server if absolutely necessary (mountd_enable)"
      info             : "This checks if mountd is enabled. Only enable if nfs server is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*mountd_enable=.*YES*"
      expect           : "mountd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.9. Only enable NFS client processes if absolutely necessary"
      info             : "This checks if nfs client is enabled. Only enable if absolutely necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nfs_client_enable=.*YES*"
      expect           : "nfs_client_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "3.10. Block NFS connections to non-privileged ports"
      info             : "This checks if nfs reserved port only is enabled. It should be set to yes to block nfs connections to non-privileged ports"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nfs_reserved_port_only=.*YES*"
      expect           : "nfs_reserved_port_only=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.11. Block non-privileged mountd requests"
      info             : "This checks if weak mountd authentication is enabled. It should be set to no to block non-privileged mountd requests"
      reference        : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*weak_mountd_authentication=.*YES*"
      expect           : "weak_mountd_authentication=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.12. Only enable NIS if absolutely necessary (nis_server_enable)"
      info             : "This checks if nis server is enabled. It should only be enabled if nis is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nis_server_enable=.*YES*"
      expect           : "nis_server_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.12. Only enable NIS if absolutely necessary (nis_ypxfrd_enable)"
      info             : "This checks if nis ypxfrd is enabled. It should only be enabled if nis is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nis_ypxfrd_enable=.*YES*"
      expect           : "nis_ypxfrd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.12. Only enable NIS if absolutely necessary (nis_yppasswdd_enable)"
      info             : "This checks if nis yppasswdd is enabled. It should only be enabled if nis is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nis_yppasswdd_enable=.*YES*"
      expect           : "nis_yppasswdd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.12. Only enable NIS if absolutely necessary (rpc_ypupdated_enable)"
      info             : "This checks if rpc ypupdated is enabled. It should only be enabled if nis is necessary"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*rpc_ypupdated_enable=.*YES*"
      expect           : "rpc_ypupdated_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.13. Only enable NIS client daemons if absolutely necessary (nis_client_enable)"
      info             : "This check reports if nis client is enabled. It should only be on if this machine acts as a NIS server for the network"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nis_client_enable=.*YES*"
      expect           : "nis_client_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.13. Only enable NIS client daemons if absolutely necessary (nis_ypset_enable)"
      info             : "This checks if nis ypset is enabled. It should only be on if this machine acts as a NIS server for the network"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*nis_ypset_enable=.*YES*"
      expect           : "nis_ypset_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK_NOT
      description      : "3.14. Only enable the printer daemons if absolutely necessary"
      info             : "This checks if a printer is enabled. If not needed it should be disabled"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*lpd_enable=.*YES*"
      expect           : "lpd_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "4.1. Disable core dumps"
      info             : "This checks if core dumps are disabled. Core dumps may contain sensitive data"
      reference        : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*kern.coredump=0"
      expect           : "kern.coredump=0"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "4.2. Set a default secure level"
      info             : "This check reports if secure level not equal to 1 -warning- modules may not be loaded into a running kernel and may not be able to patch a system without going to single user mode with this setting"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*kern.securelevel=1"
      expect           : "kern.securelevel=1"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "4.3. Block users from viewing unowned processes"
      info             : "This check reports if users can gather info on processes they do not own"
      reference        : "800-171|3.1.7,800-53|AC-6,CSF|PR.AC-4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*.*security.bsd.see_other_uids=0"
      expect           : "^[\\s]*security.bsd.see_other_uids=0"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "4.4. Block users from viewing processes in other groups"
      info             : "This check reports if users see processes in other groups 4.4"
      reference        : "800-171|3.1.7,800-53|AC-6,CSF|PR.AC-4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*.*security.bsd.see_other_gids=0"
      expect           : "^[\\s]*security.bsd.see_other_gids=0"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.1. Capture ftpd and inetd information"
      info        : "Check for /var/log/debug.log so ftpd and inetd is captured. This is enabled by default"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/debug.log"
      owner       : "root"
      mask        : "177"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.2. Enable system accounting (/var/account/acct)"
      info        : "Check for /var/account/acct default"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/account/acct"
      owner       : "root"
      mask        : "133"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.2. Enable system accounting (accounting_enable)"
      info             : "This check reports if accounting is turned on"
      reference        : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/rc.conf"
      regex            : "^[\\s]*accounting_enable=.*YES.*"
      expect           : "accounting_enable=.*YES.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.3. Enable logging of packets received on closed ports (net.inet.tcp.log_in_vain)"
      info             : "This checks logging on closed TCP ports. It should be enabled to log failed connection attempts"
      reference        : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*net.inet.tcp.log_in_vain=.*1.*"
      expect           : "net.inet.tcp.log_in_vain=.*1.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.3. Enable logging of packets received on closed ports (net.inet.udp.log_in_vain)"
      info             : "This checks logging on closed UDP ports. It should be enabled to log failed connection attempts"
      reference        : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/sysctl.conf"
      regex            : "^[\\s]*net.inet.udp.log_in_vain=.*1.*"
      expect           : "net.inet.udp.log_in_vain=.*1.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/mess*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/mess*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/lpd-errs)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/lpd-errs"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/slip.log*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/slip.log*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/sendmail.s*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/sendmail.s*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/auth.lo*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/auth.lo*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/maillo*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/maillo*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.4. Set permissions on system log files (/var/log/ppp.lo*)"
      info        : "The following file should not be world readable and can be chmod to 600"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/log/ppp.lo*"
      owner       : "root"
      mask        : "177"
    </custom_item>

    <custom_item>
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/amd.log)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 644 for /var/log/adm.log"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/amd.log.*644.*"
      expect           : ".*/var/log/amd.log.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/lpd-errs)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 644 for /var/log/lpd-errs"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/lpd-errs.*644.*"
      expect           : ".*/var/log/lpd-errs.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/messages)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 644 for /var/log/messages"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/messages.*644.*"
      expect           : ".*/var/log/messages.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/daily.log)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/daily.log"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/daily.log.*640.*"
      expect           : ".*/var/log/daily.log.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/maillog)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/maillog"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/maillog.*640.*"
      expect           : ".*/var/log/maillog.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/monthly.log)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/monthly.log"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/monthly.log.*640.*"
      expect           : ".*/var/log/monthly.log.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/ppp.log)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/ppp.log"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/ppp.log.*640.*"
      expect           : ".*/var/log/ppp.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/sendmail.st)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/sendmail.st"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/sendmail.st.*640.*"
      expect           : ".*/var/log/sendmail.st.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "5.5. Configure newsyslog for secure file permissions (/var/log/slip.log)"
      info             : "This check will fail if /etc/newsyslog.conf has permissions of 640 for /var/log/slip.log"
      reference        : "800-171|3.3.8,800-171|3.3.9,800-53|AU-9(4),CN-L3|8.1.4.3(d),CSF|PR.PT-1,ITSG-33|AU-9(4),NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,SWIFT-CSCv1|5.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/newsyslog.conf"
      regex            : "^[\\s]*/var/log/slip.log.*640.*"
      expect           : ".*/var/log/slip.log.*600"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "5.6. Configure periodic log files (/etc/periodic.conf)"
      info        : "Check for /etc/periodic.conf to make sure it is there"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/periodic.conf"
      owner       : "root"
      mask        : "133"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      type             : FILE_CONTENT_CHECK
      description      : "5.6. Configure periodic log files (daily_output)"
      info             : "This checks /etc/periodic.conf file for daily_output=/var/log/daily.log"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/periodic.conf"
      regex            : "^[\\s]*daily_output=/var/log/daily.log"
      expect           : ".*daily_output=/var/log/daily.log"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "6.1. Add nosuid option to /etc/fstab"
      info             : "This check reports if /etc/fstab does not mount cdroms nosuid"
      reference        : "800-171|3.1.7,800-53|AC-6(10),CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/fstab"
      regex            : "^[\\s]*.*dev.*acd0.*cdrom.*nosuid.*"
      expect           : ".*dev.*acd0.*cdrom.*nosuid.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "6.2. Verify passwd, master.passwd, and group file permissions (/etc/passwd)"
      info        : "Permission and ownership check /etc/passwd"
      reference   : "800-53|IA-5(6),CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/passwd"
      owner       : "root"
      mask        : "133"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "6.2. Verify passwd, master.passwd, and group file permissions (/etc/group)"
      info        : "Permission and ownership check /etc/group"
      reference   : "800-53|IA-5(6),CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/group"
      owner       : "root"
      mask        : "133"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "6.2. Verify passwd, master.passwd, and group file permissions (/etc/pwd.db)"
      info        : "Permission and ownership check /etc/pwd.db"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/pwd.db"
      owner       : "root"
      mask        : "133"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "6.2. Verify passwd, master.passwd, and group file permissions (/etc/master.passwd)"
      info        : "Permission and ownership check /etc/master.passwd"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/master.passwd"
      owner       : "root"
      mask        : "177"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "6.2. Verify passwd, master.passwd, and group file permissions (/etc/spwd.db)"
      info        : "Permission and ownership check /etc/spwd.db"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/spwd.db"
      owner       : "root"
      mask        : "177"
      group       : "wheel"
    </custom_item>

    <item>
      description : "6.3. Set sticky bit on world writable directories"
      info        : "This check finds all the directories that are world writeable and whose sticky bit is not set"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_world_writeable_directories"
      basedir     : "/"
    </item>

    <item>
      description : "6.4. Find world writable files"
      info        : "Search for world-writeable files"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_world_writeable_files"
      basedir     : "/"
    </item>

    <item>
      description : "6.5. Find SUID and SGID files (/usr/bin)"
      info        : "Search for SUID/SGID files"
      reference   : "800-53|AC-6(8),CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_suid_sgid_files"
      basedir     : "/usr/bin"
    </item>

    <item>
      description : "6.5. Find SUID and SGID files (/usr/sbin)"
      info        : "Search for SUID/SGID files"
      reference   : "800-53|AC-6(8),CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_suid_sgid_files"
      basedir     : "/usr/sbin"
    </item>

    <item>
      description : "6.5. Find SUID and SGID files (/usr/compat/)"
      info        : "Search for SUID/SGID files"
      reference   : "800-53|AC-6(8),CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_suid_sgid_files"
      basedir     : "/usr/compat/"
    </item>

    <item>
      description : "6.6. User home directories should be kept private"
      info        : "Check home permissions"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "accounts_bad_home_permissions"
      mask        : "7077"
      basedir     : "/usr/home/*/"
    </item>

    <item>
      description : "6.7. Find 'Unowned' Files and Directories"
      info        : "This check finds all files that are 'orphaned' (i.e.: whose owner is an invalid UID or GID)"
      reference   : "800-53|AC-16(3),CSF|PR.AC-4,ITSG-33|AC-16(3)"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "find_orphan_files"
      basedir     : "/"
    </item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.1. Remove weak authentication services from PAM (/etc/pam.d/rsh)"
      info             : "This checks if weak authentication is not deactivated in /etc/pam.d/rsh, remove weak authentication from pam"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/pam.d/rsh"
      regex            : "^[\\s]*.*auth.*pam_nologin.so.*"
      expect           : ".*auth.*pam_deny.so.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.1. Remove weak authentication services from PAM (/etc/pam.d/rexecd)"
      info             : "This checks if weak authentication is not deactivated in /etc/pam.d/rexecd, remove weak authentication from pam"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/pam.d/rexecd"
      regex            : "^[\\s]*.*auth.*pam_nologin.so.*"
      expect           : ".*auth.*pam_deny.so.*"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.4. Restrict at/cron to authorized users (/var/cron/allow)"
      info             : "This checks /var/cron/allow for root"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/var/cron/allow"
      regex            : "^[\\s]*root$"
      expect           : "root"
      required         : YES
      search_locations : "/var/cron"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.4. Restrict at/cron to authorized users (/var/at/at.allow)"
      info             : "This checks /var/at/at.allow for root"
      reference        : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/var/at/at.allow"
      regex            : "^[\\s]*root$"
      expect           : "root"
      required         : YES
      search_locations : "/var/at"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "7.4. Restrict at/cron to authorized users (/etc/crontab permissions)"
      info        : "File /etc/crontab should have permissions of 640"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/crontab"
      owner       : "root"
      mask        : "137"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "7.4. Restrict at/cron to authorized users (/var/cron/allow permissions)"
      info        : "Check if /var/cron/allow exists. Only users in this file are allowed access to the crontab utilities"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/cron/allow"
      owner       : "root"
      mask        : "377"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "7.4. Restrict at/cron to authorized users (/var/at/at.allow permissions)"
      info        : "Check if /var/at/at.allow exists. Only users in this file are allowed access to the at utilities"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/var/at/at.allow"
      owner       : "root"
      mask        : "377"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : BANNER_CHECK
      description : "7.5. Create warning banners for the system (/etc/motd)"
      info        : "This checks if Authorized Use Only is in /etc/motd, warning #messages assist in prosecution"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/motd"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "7.5. Create warning banners for the system (/etc/motd permissions)"
      info        : "Check if /etc/motd is permissions are 644"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/motd"
      owner       : "root"
      mask        : "133"
      required    : YES
      group       : "wheel"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.6. Remove the X wrapper and enable xdm"
      info             : "This checks if xdm is enabled in /etc/ttys -warning- if you do enable it then delete wrapper pkg also -warning- if /usr/X11R6/bin/xdm does not exist - do not turn on"
      reference        : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/ttys"
      regex            : "^[\\s]*.*/usr/X11R6/bin/xdm.*off secure"
      expect           : ".*/usr/X11R6/bin/xdm.*on secure"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "7.7. Prevent xdm from listening on port 6000/TCP"
      info             : "Check if X11 server is installed. If it is, disable xdm ability to accept connections on port 6000"
      reference        : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/X11/xdm/Xservers"
      regex            : "^[\\s]*-nolisten tcp.*"
      expect           : "-nolisten tcp"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.1. Block system accounts"
      info             : "This check will fail if uucp is not set to /sbin/nologin -warning- should not be set if uucp is used"
      reference        : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/passwd"
      regex            : "^[\\s]*.*uucp.*/usr/local/libexec/uucp/uucico"
      expect           : "uucp.*/sbin/nologin"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CONTENT_CHECK_NOT
      description : "8.2. Verify that accounts either have a password or are disabled"
      info        : "Verify That There Are No Accounts With Empty Password Fields"
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/etc/master.passwd"
      regex       : ".+::[0-9]+:[0-9]+::[0-9]"
      expect      : ".+::[0-9]+:[0-9]+::[0-9]"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.3. Set account expiration parameters on all active user accounts"
      info             : "This will check /etc/login.conf for maxpassword age (checks for 91 days or less)"
      reference        : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/login.conf"
      regex            : "^[\\s]*:passwordtime.*"
      expect           : "^[\\s]*:passwordtime=([1-9]|[1-8][0-9]|9[0-1])d"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.4. Create default adduser.conf file"
      info             : "This will check /etc/adduser.conf for upwexpire=91d or less"
      reference        : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/adduser.conf"
      regex            : "upwexpire.*"
      expect           : "upwexpire=91d|=90d|=89d|=88d|=87d|=86d|=85d|=84d|=83d|=82d|=81d|=80d|=79d|=78d|=77d|=76d|=75d|=74d|=73d|=72d|=71d|=70d|=69d|=68d|=67d|=65d|=64d|=63d|=62d|=61d|=60d|=59d|=58d|=57d|=56d|=55d|=54d|=53d|=52d|=51d|=50d|=49d|=48d|=47d|=46d|=45d|=44d|=43d|=42d|=41d|=40d|=39d|=38d|=37d|=36d|=35d|=34d|=33d|=32d|=31d|=30d|=29d|=28d|=27d|=26d|=25d|=24d|=23d|=22d|=21d|=20d|=19d|=18d|=17d|=16d|=15d|=14d|=13d|=12d|=11d|=10d|=9d|=8d|=7d|=6d|=5d|=4d|=3d|=2d|=1d"
      required         : YES
      search_locations : "/etc"
    </custom_item>

    <item>
      description : "8.5. Remove the toor user."
      info        : "Check for toor"
      info        : "8.6. Verify that root is the only user with UID 0"
      info        : "Check for root only"
      reference   : "800-171|3.1.5,800-53|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,SWIFT-CSCv1|1.2"
      see_also    : "https://workbench.cisecurity.org/files/632"
      name        : "passwd_zero_uid"
    </item>

    <custom_item>
      system      : "FreeBSD"
      type        : FILE_CHECK
      description : "8.7. No user dot-files should be world writable"
      info        : "Check for group or world-writeable dotfiles in home directory"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/632"
      file        : "/home/*/.*"
      mask        : "002"
      required    : NO
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/etc/login.conf)"
      info             : "This checks /etc/login.conf for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/login.conf"
      regex            : "^[\\s]*umask=077$"
      expect           : "umask=077"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/etc/profile)"
      info             : "This checks /etc/profile for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/profile"
      regex            : "^[\\s]*umask=077$"
      expect           : "umask=077"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/etc/csh.login)"
      info             : "This checks /etc/csh.login for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/csh.login"
      regex            : "^[\\s]*umask=077$"
      expect           : "umask=077"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/etc/csh.cshrc)"
      info             : "This checks /etc/csh.cshrc for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/csh.cshrc"
      regex            : "^[\\s]*umask=077$"
      expect           : "umask=077"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/usr/share/skel/dot.cshrc)"
      info             : "This checks /usr/share/skel/dot.cshrc for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/usr/share/skel/dot.cshrc"
      regex            : "^[\\s]*umask.*77$"
      expect           : "umask.*77"
      required         : NO
      search_locations : "/usr"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.8. Set default umask for users (/usr/share/skel/dot.shrc)"
      info             : "This checks /usr/share/skel/dot.shrc for umask 22. It should be set to 077"
      reference        : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/usr/share/skel/dot.shrc"
      regex            : "^[\\s]*umask.*77$"
      expect           : "umask.*77"
      required         : NO
      search_locations : "/usr"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.9. Set 'mesg n' as the default for all users (/etc/profile)"
      info             : "This checks if mesg n is set in /etc/profile to strengthen tty. Setting to 'n' will block users from the write or talk utilities"
      reference        : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/profile"
      regex            : "^[\\s]*mesg n"
      expect           : "mesg n"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.9. Set 'mesg n' as the default for all users (/etc/csh.login)"
      info             : "This checks if mesg n is set in /etc/csh.login to strengthen tty. Setting to 'n' will block users from the write or talk utilities"
      reference        : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/csh.login"
      regex            : "^[\\s]*mesg n"
      expect           : "mesg n"
      required         : NO
      search_locations : "/etc"
    </custom_item>

    <custom_item>
      system           : "FreeBSD"
      type             : FILE_CONTENT_CHECK
      description      : "8.10. Use Blowfish encryption for all users by default"
      info             : "This checks if Blowfish is the default encryption algorithm"
      reference        : "800-171|3.5.10,800-53|IA-5(1),CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
      see_also         : "https://workbench.cisecurity.org/files/632"
      file             : "/etc/login.conf"
      regex            : "^[\\s]*passwd_format=blf"
      expect           : "passwd_format=blf"
      required         : NO
      search_locations : "/etc"
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS FreeBSD Benchmark v1.0.5"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/632"
    </report>
  </else>
</if>

</check_type>
