#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.24 $
# $Date: 2020/07/14 $
#
# Description	: This .audit file is written again the Center for Internet
# 	  Security benchmark for Red Hat Enterprise Linux 5, version 2.2.0 .
# 	  https://workbench.cisecurity.org/files/214
#
#
# NOTE		: The following sections utilize sample IP addresses and require adjustment to reflect the target environment :
# 	  3.6 Configure Network Time Protocol (NTP) 'server'
# 	  4.5.2 Create /etc/hosts.allow
#
#
# NOTE		: The following sections address queries which are commented out for listed reasons :
#
# 	  Disabled due to potentially long runtime :
# 	  1.2.7 Verify Package Integrity Using RPM
#
# 	  Required only if IPv6 is in use :
# 	  4.4.1.1 Disable IPv6 Router Advertisements
# 	  4.4.1.2 Disable IPv6 Redirect Acceptance
# 	  4.7 Enable IP6tables
#
# 	  These two queries are mutually exclusive depending on if a target is a designated loghost or not :
# 	  5.1.4 Accept Remote syslog Messages Only on Designated Log Hosts 'loghost'
# 	  5.1.4 Accept Remote syslog Messages Only on Designated Log Hosts 'non-loghost'
#
# NOTE		: Some queries in this .audit require site-specific data to be known to the query in order to function properly.
# 	  Please note the following queries and edit their values accordingly.
# 	  5.1.3 Configure syslog to Send Logs to a Remote Log Host
# 	  5.1.4 Accept Remote syslog Messages Only on Designated Log Hosts 'loghost'
# 	  5.2.5 Configure rsyslog to Send Logs to a Remote Log Host
# 	  6.2.14 Set SSH Banner
# 	  8.2 Set GNOME Warning Banner
#
#<ui_metadata>
#<display_name>CIS Red Hat Enterprise Linux 5 L1 v2.2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Red Hat Enterprise Linux 5 L1</name>
#  <version>2.2.0</version>
#  <link>https://workbench.cisecurity.org/files/214</link>
#</spec>
#<labels>unix,cis,redhat,enterprise,linux,rhel,rhel_5,agent</labels>
#<benchmark_refs>LEVEL,CSCv6</benchmark_refs>
#<variables>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>192\.168\.0\.1</default>
#    <description>NTP server address</description>
#    <info>The IP address or FQDN of the Network Time Protocol (NTP) server for your organization.</info>
#  </variable>
#  <variable>
#    <name>HOSTS_ALLOW_NETWORK</name>
#    <default>192\.0\.2\.0\\/255\.255\.255\.0</default>
#    <description>Hosts.allow network entry</description>
#    <info>The IP address and network mask allowed access to the system as it appears in hosts.allow. If all systems are allowed use 'ALL'.</info>
#  </variable>
#  <variable>
#    <name>SYSLOG_SERVER</name>
#    <default>@@loghost\.example\.com</default>
#    <description>Syslog host address</description>
#    <info>The IP address or FQDN of the central syslog server for your organization as it appears in rsyslog.conf.</info>
#  </variable>
#  <variable>
#    <name>BANNER_FILE</name>
#    <default>\\/etc\\/issue</default>
#    <description>Banner file</description>
#    <info>The full path to the SSH banner file as it appears in sshd_config. The banner file contains the text that is sent to each new SSH connection.</info>
#  </variable>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>All activities performed on this system will be monitored.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "Red Hat 5 is installed"
      file        : "/etc/redhat-release"
      regex       : "Red Hat Enterprise Linux Server release 5"
      expect      : "Red Hat Enterprise Linux Server release 5"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS Red Hat EL 5 v2.2.0"
    </report>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.1/1.1.2 /tmp Partition"
      info        : "1.1.1 Create Separate Partition for /tmp"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "1.1.2 Set nodev option for /tmp Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "1.1.1 - For new installations, check the box to 'Review and modify partitioning' and create a separate partition for /tmp. For systems that were previously installed, use the Logical Volume Manager (LVM) to create partitions.
1.1.2 - Edit the /etc/fstab file and add nodev to the fourth field (mounting options). See the fstab(5) manual page for more information. # mount -o remount,nodev /tmp"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14161-4,CCE|CCE-14412-1,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/tmp[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/tmp[\\s].*,nodev"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.3 Set nosuid option for /tmp Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options). See the fstab(5) manual page for more information."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14940-1,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/tmp[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/tmp[\\s].*,nosuid"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.4 Set noexec option for /tmp Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/fstab file and add noexec to the fourth field (mounting options). See the fstab(5) manual page for more information.# mount -o remount,noexec /tmp"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14412-1,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/tmp[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/tmp[\\s].*,noexec"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.5 Create Separate Partition for /var"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "For new installations, check the box to 'Review and modify partitioning' and create a separate partition for /var.For systems that were previously installed, use the Logical Volume Manager (LVM) to create partitions."
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-14777-7,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/var[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/var[\\s]"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.6 Bind Mount the /var/tmp directory to /tmp"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# mount --bind /tmp /var/tmp and edit the /etc/fstab file to contain the following line - /tmp /var/tmp none bind 0 0"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-14584-7,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*\/tmp[\\s]+\/var/tmp[\\s]+none[\\s]+.*"
      expect      : "^[\\s]*\/tmp[\\s]+\/var/tmp[\\s]+none[\\s]+bind[\\s]+0[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.7 Create Separate Partition for /var/log"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "For new installations, check the box to 'Review and modify partitioning' and create a separate partition for /var/log. For systems that were previously installed, use the Logical Volume Manager (LVM) to create partitions."
      reference   : "800-53|AU-4,CCE|CCE-14011-1,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/var\/log[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/var\/log[\\s]"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.8 Create Separate Partition for /var/log/audit"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "For new installations, check the box to 'Review and modify partitioning' and create a
separate partition for /var/log/audit. For systems that were previously installed, use the
Logical Volume Manager (LVM) to create partitions."
      reference   : "800-53|AU-4,CCE|CCE-14171-3,CSCv6|6.3,CSF|PR.DS-4,CSF|PR.PT-1,ITSG-33|AU-4,NESA|T3.3.1,NESA|T3.6.2,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/var\/log/audit[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/var\/log/audit[\\s]"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.9/1.1.10 /home Partition"
      info        : "1.1.9 Create Separate Partition for /home"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "1.1.10 Add nodev Option to /home"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "1.1.9 - For new installations, check the box to 'Review and modify partitioning' and create a separate partition for /home
 1.1.10 - Edit the /etc/fstab file and add nodev to the fourth field (mounting options). See the fstab(5) manual page for more information.# mount -o remount,nodev /home.
 For systems that were previously installed, use the Logical Volume Manager (LVM) to create partitions."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14559-9,CCE|CCE-4249-9,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/home[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/home[\\s].*,nodev"
    </custom_item>

    <custom_item>
      system          : "Linux"
      type            : FILE_CONTENT_CHECK
      description     : "1.1.11 Add nodev Option to Removable Media Partitions"
      info            : "Configuration Level : Level-I"
      info            : "OS Default : N/A"
      info            : "Reboot Required : No"
      info            : "Scorable Item : No"
      solution        : "Edit the /etc/fstab file and add 'nodev' to the fourth field (mounting options). Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5)manual page for more information."
      reference       : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-3522-0,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also        : "https://workbench.cisecurity.org/files/214"
      file            : "/etc/fstab"
      regex           : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s]"
      expect          : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s].*,nodev"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "Linux"
      type            : FILE_CONTENT_CHECK
      description     : "1.1.12 Add noexec Option to Removable Media Partitions"
      info            : "Configuration Level : Level-I"
      info            : "OS Default : N/A"
      info            : "Reboot Required : No"
      info            : "Scorable Item : No"
      solution        : "Edit the /etc/fstab file and add noexec to the fourth field (mounting options). Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information."
      reference       : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-4275-4,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also        : "https://workbench.cisecurity.org/files/214"
      file            : "/etc/fstab"
      regex           : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s]"
      expect          : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s].*,noexec"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "Linux"
      type            : FILE_CONTENT_CHECK
      description     : "1.1.13 Add nosuid Option to Removable Media Partitions"
      info            : "Configuration Level : Level-I"
      info            : "OS Default : N/A"
      info            : "Reboot Required : No"
      info            : "Scorable Item : No"
      solution        : "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options). Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information."
      reference       : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-4042-8,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also        : "https://workbench.cisecurity.org/files/214"
      file            : "/etc/fstab"
      regex           : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s]"
      expect          : "^[\\s]*.*[\\s]+\/m.*\/(floppy|cdrom|corder)[\\s].*,nosuid"
      string_required : NO
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.14 Add nodev Option to /dev/shm Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/fstab file and add nodev to the fourth field (mounting options of entries that have mount points that contain /dev/shm). See the fstab(5) manual page for more information.# mount -o remount,nodev /dev/shm"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-15007-8,CSCv6|3.1,CSF|PR.AC-4,LEVEL|1S,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/dev\/shm[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/dev\/shm[\\s].*,nodev"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.15 Add nosuid Option to /dev/shm Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/fstab file and add nosuid to the fourth field (mounting options). Look for entries that have mount points that contain /dev/shm. See the fstab(5) manual page for more information.# mount -o remount,nosuid /dev/shm"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14306-5,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/dev\/shm[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/dev\/shm[\\s].*,nosuid"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.1.16 Add noexec Option to /dev/shm Partition"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/fstab file and add noexec to the fourth field (mounting options). Look for entries that have mount points that contain /dev/shm. See the fstab(5) manual page for more information.# mount -o remount,noexec /dev/shm"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14927-8,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/fstab"
      regex       : "^[\\s]*.*[\\s]+\/dev\/shm[\\s]"
      expect      : "^[\\s]*.*[\\s]+\/dev\/shm[\\s].*,noexec"
    </custom_item>

    <item>
      description : "1.1.17 Set Sticky Bit on All World-Writable Directories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# find / -type d -perm -0002 2>/dev/null | chmod a+t"
      reference   : "800-171|3.1.5,800-53|AC-6,CCE|CCE-3399-3,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "find_world_writeable_directories"
    </item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.7 Use the Latest OS Release"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      reference   : "800-171|3.4.1,800-53|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/redhat-release"
      regex       : "^[^#]*Red Hat Enterprise Linux Server"
      expect      : "5\.([4-9]|1[0-1])"
    </custom_item>

    <report type:"WARNING">
      description : "1.2.1 Configure Connection to the RHN RPM Repositories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "If your system is not listed on the RHN site as a registered system, run the Red Hat Network Registration tool as follows-# rhn registerFollow the prompts on the screen. If successful, the system will appear on the RHN web site and be subscribed to one or more software update channels. Additionally, a new daemon, rhnsd, will be enabled."
      see_also    : "https://workbench.cisecurity.org/files/214"
    </report>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "1.2.2 Verify Red Hat GPG Key is Installed"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : N/A"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "Compare the GPG fingerprint with the one from Red Hat's web site at http-//www.redhat.com/security/team/key. The following command can be used to print the installed release key's fingerprint, which is actually contained in the file referenced below-# gpg --quiet --with-fingerprint /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-releaseMore information on package signing is also available at https-//access.redhat.com/security/team/key."
      reference     : "800-53|SI-7(6),CCE|CCE-14440-2,CSF|PR.DS-6,SWIFT-CSCv1|6.2"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/bin/rpm -q --queryformat \"%{SUMMARY}\\n\" gpg-pubkey"
      expect        : "^gpg\\(Red Hat, Inc\. \\(release key\\)? \\<security@redhat\.com\\>\\)$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.2.3 Verify that gpgcheck is Globally Activated"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/yum.conf file and set the gpgcheck to 1 as follows-gpgcheck=1"
      reference   : "800-53|SI-7(6),CCE|CCE-14914-6,CSF|PR.DS-6,SWIFT-CSCv1|6.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/yum.conf"
      regex       : "^[\\s]*gpgcheck[\\s]*="
      expect      : "^[\\s]*gpgcheck[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <report type:"WARNING">
      description : "1.2.6 Obtain Software Package Updates with yum"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "# yum update"
      see_also    : "https://workbench.cisecurity.org/files/214"
    </report>

#<custom_item>
# system	: "Linux"
# type		: CMD_EXEC
# description	: "1.2.7 Verify Package Integrity Using RPM"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : N/A"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "Address unexpected discrepancies identified in the audit step."
# reference	: "CCE|CCE-14931-0"
# see_also	: "https://workbench.cisecurity.org/files/214"
# cmd		: "/bin/rpm -qVa | /bin/awk '$2 != \"c\" { print $0 }'"
# expect	: ""
# dont_echo_cmd	: YES
# severity	: HIGH
#</custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "1.5.1/1.5.2 /etc/grub.conf Permissions and Ownership"
      info        : "1.5.1 Set User/Group Owner on /etc/grub.conf"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "1.5.2 Set Permissions on /etc/grub.conf"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "1.5.1 -# chown root-root /etc/grub.conf
 1.5.2 - # chmod og-rwx /etc/grub.conf"
      reference   : "800-53|SI-7(9),CCE|CCE-3923-0,CCE|CCE-4144-2,CCE|CCE-4197-0,CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSCv6|3.1,CSF|PR.DS-6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/grub.conf"
      owner       : "root"
      mask        : "177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.5.3 Set Boot Loader Password"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "#!/bin/bash
                  grub-md5-crypt | tee /tmp/$$
                  x=`tail -1 /tmp/$$`
                  /bin/rm -f /tmp/$$
                  ed /etc/grub.conf << END > /dev/null 2>&1
                  g/^password/d
                  $
                  ?^#?
                  a
                  password --md5 $x
                  .
                  w
                  q
                  END"
      reference   : "800-53|SI-7(9),CCE|CCE-3818-2,CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSF|PR.DS-6"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/grub.conf"
      regex       : "^[\\s]*password --md5 .+"
      expect      : "password --md5 .+"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.5.4 Require Authentication for Single-User Mode"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Add the following to /etc/inittab-~-S-wait-/sbin/sulogin"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-4241-6,CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/inittab"
      regex       : "^[\\s]*~:S:wait:/sbin/sulogin"
      expect      : "~:S:wait:/sbin/sulogin[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.5.5 Disable Interactive Boot"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "Set the PROMPT parameter in /etc/sysconfig/init to no."
      reference   : "800-53|SI-7(9),CCE|CCE-4245-7,CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSF|PR.DS-6"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysconfig/init"
      regex       : "^[\\s]*PROMPT[\\s]*="
      expect      : "^[\\s]*PROMPT[\\s]*=[\\s]*[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.1 Restrict Core Dumps '/etc/security/limits.conf - * hard core 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "Add the following line to the /etc/security/limits.conf file.* hard core 0Add the following line to the /etc/sysctl.conf file. fs.suid_dumpable = 0"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/security/limits.conf"
      regex       : "^\\*[\\s]+hard[\\s]+core"
      expect      : "^\\*[\\s]+hard[\\s]+core[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.1 Restrict Core Dumps '/etc/sysctl.conf - fs.suid_dumpable = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "Add the following line to the /etc/security/limits.conf file.* hard core 0Add the following line to the /etc/sysctl.conf file. fs.suid_dumpable = 0"
      reference   : "800-171|3.1.7,800-53|AC-6,CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*fs.suid_dumpable[\\s]*="
      expect      : "^[\\s]*fs.suid_dumpable[\\s]*=[\\s]*0"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.2 Configure ExecShield 'kernel.exec-shield = 1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "Add the following line to the /etc/sysctl.conf file.kernel.exec-shield = 1"
      reference   : "800-171|3.4.7,800-53|CM-7(2),CCE|CCE-4168-1,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*kernel\.exec-shield[\\s]*"
      expect      : "^[\\s]*kernel\.exec-shield[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.3 Enable Randomized Virtual Memory Region Placement 'kernel.randomize_va_space = 2'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      solution    : "Add the following line to the /etc/sysctl.conf file.kernel.randomize_va_space = 2"
      reference   : "800-53|SC-30,CCE|CCE-4146-7,ITSG-33|SC-30"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*kernel\.randomize_va_space[\\s]*"
      expect      : "^[\\s]*kernel\.randomize_va_space[\\s]*=[\\s]*2[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "1.6.4 Enable XD/NX Support on 32-bit x86 Systems 'kernel-PAE'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      info        : "NOTE : The kernel-PAE package should not be installed on older systems that do not support the XD or NX bit, as this may prevent them"
      info        : "from booting."
      solution    : "# yum install kernel-PAE"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "kernel-PAE-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.4 Enable XD/NX Support on 32-bit x86 Systems 'cpuinfo'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : Yes"
      info        : "NOTE : Systems that are using the 64-bit x86 kernel package do not need to install the kernel-PAE package because the 64-bit x86 kernel"
      info        : "already includes this support."
      solution    : "# yum install kernel-PAE"
      reference   : "800-53|SI-16"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/proc/cpuinfo"
      regex       : "^[\\s]*flags[\\s]*:"
      expect      : "^[\\s]*flags[\\s]*:.*[\\s](nx.*[\\s]pae|pae.*[\\s]nx)"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "1.6.5 Disable Prelink 'PRELINKING=no'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit /etc/sysconfig/prelink and set PRELINKING=no-PRELINKING=no
                   Note- If the feature is changed from yes to no, run /usr/sbin/prelink -ua to revert binaries and libraries to their original context before prelinking."
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysconfig/prelink"
      regex       : "^[\\s]*PRELINKING[\\s]*=[\\s]*"
      expect      : "^[\\s]*PRELINKING[\\s]*=[\\s]*no[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.1 Remove telnet-server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase telnet-server"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3390-2,CCE|CCE-4330-7,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "telnet-server-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.2 Remove telnet Clients"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase telnet"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3390-2,CCE|CCE-4330-7,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "telnet-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.3 Remove rsh-server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase rsh-server"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-4308-3,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "rsh-server-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.4 Remove rsh"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase rsh"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3537-8,CCE|CCE-3974-3,CCE|CCE-4141-8,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "rsh-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.5 Remove NIS Client"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase ypbind"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3705-1,CCE|CCE-4348-9,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "ypbind-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.6 Remove NIS Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase ypserv"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3705-1,CCE|CCE-4348-9,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "ypserv-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.7 Remove tftp"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase tftp"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3916-4,CCE|CCE-4273-9,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "tftp-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.8 Remove tftp-server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase tftp-server"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CCE|CCE-3916-4,CCE|CCE-4273-9,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.2,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "tftp-server-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.9 Remove talk"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Enabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase talk"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "talk-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.1.10 Remove talk-server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase talk-server"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "talk-server-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.12 Disable chargen-dgram"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the chargen-dgram service by running the following command-# chkconfig chargen-dgram off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "chargen-dgram"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.13 Disable chargen-stream"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the chargen-stream service by running the following command-
                   # chkconfig chargen-stream off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "chargen-stream"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.14 Disable daytime-dgram"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the daytime-dgram service by running the following command-# chkconfig daytime-dgram off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "daytime-dgram"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.15 Disable daytime-stream"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the daytime-stream service by running the following command-# chkconfig daytime-stream off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "daytime-stream"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.16 Disable echo-dgram"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the echo-dgram service by running the following command-# chkconfig echo-dgram off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "echo-dgram"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.17 Disable echo-stream"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the echo-stream service by running the following command-# chkconfig echo-stream off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "echo-stream"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : XINETD_SVC
      description : "2.1.18 Disable tcpmux-server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Disabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Disable the tcpmux-server service by running the following command-
                  # chkconfig tcpmux-server off3 Special Purpose Services
                  This section describes services that are installed on servers that specifically need to runthese services. If any of these services are not required, it is recommended that they bedisabled or deleted from the system to reduce the potential attack surface."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "tcpmux-server"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Set Daemon umask"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Add the following line to the /etc/sysconfig/init file.umask 027"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysconfig/init"
      regex       : "^[\\s]*umask[\\s]+027[\\s]*"
      expect      : "^[\\s]*umask[\\s]+027[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.3 Remove X Windows '/etc/inittab- id:3:initdefault:'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit /etc/inittab set default runlevel as follows-s/-5-/-3-/Uninstall the X Windows System-# yum groupremove 'X Window System'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/inittab"
      regex       : "^[\\s]*id:"
      expect      : "^[\\s]*id:3:initdefault:[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.3 Remove X Windows 'X Window System'"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : N/A"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "Edit /etc/inittab set default runlevel as follows-s/-5-/-3-/Uninstall the X Windows System-# yum groupremove 'X Window System'"
      reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/usr/bin/yum grouplist 2>&1 | /bin/awk '/Installed/,/Available/' | /bin/grep 'X Window System'"
      expect        : ""
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.1.1 Disable Avahi Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chkconfig avahi-daemon offIn addition, edit the /etc/sysconfig/network file and remove zeroconf."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "avahi-daemon"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Linux"
          type        : PROCESS_CHECK
          description : "avahi on"
          name        : "avahi-daemon"
          status      : ON
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Linux"
          type        : FILE_CONTENT_CHECK
          description : "3.1.2 Service Only via Required Protocol 'IPv4-only - use-ipv6=no'"
          info        : "Configuration Level : Level-I"
          info        : "OS Default : N/A"
          info        : "Reboot Required : No"
          info        : "Scorable Item : No"
          info        : "NOTE : Per CIS, this setting is for IPv4-only systems."
          solution    : "Edit the /etc/avahi/avahi-daemon.conf file to use the appropriate protocol for your
                     environment.#if only using IPv4, disable IPv6 with this line-
                     use-ipv6=no
                     #if only using IPv6, disable IPv4 with this line-
                     use-ipv4=no"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/214"
          file        : "/etc/avahi/avahi-daemon.conf"
          regex       : "^[\\s]*use-ipv6"
          expect      : "^[\\s]*use-ipv6=no[\\s]*$"
        </custom_item>

        <custom_item>
          system      : "Linux"
          type        : FILE_CONTENT_CHECK
          description : "3.1.2 Service Only via Required Protocol 'IPv6-only - use-ipv4=no'"
          info        : "Configuration Level : Level-I"
          info        : "OS Default : N/A"
          info        : "Reboot Required : No"
          info        : "Scorable Item : No"
          info        : "NOTE : Per CIS, this setting is for IPv6-only systems."
          solution    : "Edit the /etc/avahi/avahi-daemon.conf file to use the appropriate protocol for your
                  environment.#if only using IPv4, disable IPv6 with this line-
                  use-ipv6=no
                  #if only using IPv6, disable IPv4 with this line-
                  use-ipv4=no"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/214"
          file        : "/etc/avahi/avahi-daemon.conf"
          regex       : "^[\\s]*use-ipv4"
          expect      : "^[\\s]*use-ipv4=no[\\s]*$"
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.3 Check Responses TTL Field 'check-response-ttl=yes'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : Yes"
          solution      : "Edit the /etc/avahi/avahi-daemon.conf file and add the following line to the [server] section-check-response-ttl=yes"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[server\\]/,/check-response-ttl/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*check-response-ttl=yes[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.4 Prevent Other Programs from Using Avahi's Port 'disallow-other-stacks=yes'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Edit the /etc/avahi/avahi-daemon.conf file and add the following line-
                   disallow-other-stacks=yes"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[server\\]/,/disallow-other-stacks/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*disallow-other-stacks=yes[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.5 Disable Publishing 'disable-publishing=yes'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Disable publishing in the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
                   grep '^disable-publishing=yes' /etc/avahi/avahi-daemon.conf
                   if [ $? -ne 0 ]
                   then
                   ed /etc/avahi/avahi-daemon.conf <<END
                   g/ disable-publishing=yes /d
                   /^\[publish]/
                   a
                   disable-publishing =yes
                   .
                   w
                   q
                   END
                   fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/disable-publishing/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*disable-publishing=yes[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.6 Restrict Published Information (if publishing is required) 'disable-user-service-publishing=yes'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Restrict publishing by editing the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
grep '^disable-user-service-publishing=yes' /etc/avahi/avahi-daemon.conf
if [ $? -ne 0 ]
then
ed /etc/avahi/avahi-daemon.conf << END
g/ disable-publishing=yes /d
/^\[publish]/
a
disable-publishing=yes
publish-address=no
publish-binfo=no
publish-workstation=no
publish-domain=no
.
w
q
END
fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/disable-user-service-publishing/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*disable-user-service-publishing=yes[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.6 Restrict Published Information (if publishing is required) 'publish-address=no'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Restrict publishing by editing the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
grep '^disable-user-service-publishing=yes' /etc/avahi/avahi-daemon.conf
if [ $? -ne 0 ]
then
ed /etc/avahi/avahi-daemon.conf << END
g/ disable-publishing=yes /d
/^\[publish]/
a
disable-publishing=yes
publish-address=no
publish-binfo=no
publish-workstation=no
publish-domain=no
.
w
q
END
fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/publish-address/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*publish-address=no[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.6 Restrict Published Information (if publishing is required) 'publish-binf=no'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Restrict publishing by editing the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
grep '^disable-user-service-publishing=yes' /etc/avahi/avahi-daemon.conf
if [ $? -ne 0 ]
then
ed /etc/avahi/avahi-daemon.conf << END
g/ disable-publishing=yes /d
/^\[publish]/
a
disable-publishing=yes
publish-address=no
publish-binfo=no
publish-workstation=no
publish-domain=no
.
w
q
END
fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/publish-binfo/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*publish-binfo=no[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.6 Restrict Published Information (if publishing is required) 'publish-workstation=no'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Restrict publishing by editing the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
grep '^disable-user-service-publishing=yes' /etc/avahi/avahi-daemon.conf
if [ $? -ne 0 ]
then
ed /etc/avahi/avahi-daemon.conf << END
g/ disable-publishing=yes /d
/^\[publish]/
a
disable-publishing=yes
publish-address=no
publish-binfo=no
publish-workstation=no
publish-domain=no
.
w
q
END
fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/publish-workstation/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*publish-workstation=no[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>

        <custom_item>
          system        : "Linux"
          type          : CMD_EXEC
          description   : "3.1.6 Restrict Published Information (if publishing is required) 'publish-domain=no'"
          info          : "Configuration Level : Level-I"
          info          : "OS Default : N/A"
          info          : "Reboot Required : No"
          info          : "Scorable Item : No"
          solution      : "Restrict publishing by editing the /etc/avahi/avahi-daemon.conf file as follows-#!/bin/bash
grep '^disable-user-service-publishing=yes' /etc/avahi/avahi-daemon.conf
if [ $? -ne 0 ]
then
ed /etc/avahi/avahi-daemon.conf << END
g/ disable-publishing=yes /d
/^\[publish]/
a
disable-publishing=yes
publish-address=no
publish-binfo=no
publish-workstation=no
publish-domain=no
.
w
q
END
fi"
          reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/214"
          cmd           : "/bin/awk '/^[\\s]*\\[publish\\]/,/publish-domain/' /etc/avahi/avahi-daemon.conf"
          expect        : "^[\\s]*publish-domain=no[\\s]*$"
          dont_echo_cmd : YES
        </custom_item>
      </then>
    </if>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.4 Disable Print Server - CUPS"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Enabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig cups off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "cups"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.5 Remove DHCP Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase dhcp"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "dhcp-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.6 Configure Network Time Protocol (NTP) 'restrict default kod nomodify nopeer notrap noquery'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Add the following lines to /etc/ntp.conf-# Script to fix /etc/ntp.conf
cp /etc/ntp.conf /tmp/ntp.conf.$$
egrep -v '(restrict default|restrict -6 default)' /tmp/ntp.conf.$$ > /etc/ntp.conf
ed /etc/ntp.conf << END
0a
restrict default kod nomodify nopeer notrap noquery
restrict -6 default kod nomodify nopeer notrap noquery
.
w
q
END Also, make sure /etc.ntp.conf has an NTP server specified-server <ntp-server>Note- <ntp-server> is the IP address or hostname of a trusted time server. Configuring an
NTP server is outside the scope of this benchmark."
      reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ntp.conf"
      regex       : "^[\\s]*restrict[\\s]+default[\\s]"
      expect      : "^[\\s]*restrict[\\s]+default[\\s]+kod[\\s]+nomodify[\\s]+nopeer[\\s]+notrap[\\s]+noquery[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.6 Configure Network Time Protocol (NTP) 'restrict -6 default kod nomodify nopeer notrap noquery'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Add the following lines to /etc/ntp.conf-# Script to fix /etc/ntp.conf
cp /etc/ntp.conf /tmp/ntp.conf.$$
egrep -v '(restrict default|restrict -6 default)' /tmp/ntp.conf.$$ > /etc/ntp.conf
ed /etc/ntp.conf << END
0a
restrict default kod nomodify nopeer notrap noquery
restrict -6 default kod nomodify nopeer notrap noquery
.
w
q
END Also, make sure /etc.ntp.conf has an NTP server specified-server <ntp-server>Note- <ntp-server> is the IP address or hostname of a trusted time server. Configuring an
NTP server is outside the scope of this benchmark."
      reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ntp.conf"
      regex       : "^[\\s]*restrict[\\s]+-6[\\s]"
      expect      : "^[\\s]*restrict[\\s]+-6[\\s]+default[\\s]+kod[\\s]+nomodify[\\s]+nopeer[\\s]+notrap[\\s]+noquery[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.6 Configure Network Time Protocol (NTP) 'server aaa.bbb.ccc.ddd'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : "NOTE : This query uses sample IP space and should be changed to reflect the target environment."
      solution    : "Add the following lines to /etc/ntp.conf-# Script to fix /etc/ntp.conf
cp /etc/ntp.conf /tmp/ntp.conf.$$
egrep -v '(restrict default|restrict -6 default)' /tmp/ntp.conf.$$ > /etc/ntp.conf
ed /etc/ntp.conf << END
0a
restrict default kod nomodify nopeer notrap noquery
restrict -6 default kod nomodify nopeer notrap noquery
.
w
q
END Also, make sure /etc.ntp.conf has an NTP server specified-server <ntp-server>Note- <ntp-server> is the IP address or hostname of a trusted time server. Configuring an
NTP server is outside the scope of this benchmark."
      reference   : "800-171|3.3.7,800-53|AU-8(1),CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ntp.conf"
      regex       : "^[\\s]*server[\\s]"
# Note: Variable @NTP_SERVER@ replaced with "192\\.168\\.0\\.1" in field "expect".
      expect      : "^[\\s]*server[\\s]+192\\.168\\.0\\.1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.6 Configure Network Time Protocol (NTP) 'OPTIONS=-u ntp:ntp -p /var/run/ntpd.pid'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Add the following lines to /etc/ntp.conf-# Script to fix /etc/ntp.conf
cp /etc/ntp.conf /tmp/ntp.conf.$$
egrep -v '(restrict default|restrict -6 default)' /tmp/ntp.conf.$$ > /etc/ntp.conf
ed /etc/ntp.conf << END
0a
restrict default kod nomodify nopeer notrap noquery
restrict -6 default kod nomodify nopeer notrap noquery
.
w
q
END Also, make sure /etc.ntp.conf has an NTP server specified-server <ntp-server>Note- <ntp-server> is the IP address or hostname of a trusted time server. Configuring an
NTP server is outside the scope of this benchmark."
      reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysconfig/ntpd"
      regex       : "^[\\s]*OPTIONS="
      expect      : "^[\\s]*OPTIONS[\\s]*=[\\s]*[\"]-u[\\s]+ntp:ntp[\\s]+-p[\\s]+/var/run/ntpd\.pid[\"][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.7 Remove LDAP"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "If LDAP is running on the system and is not needed, remove it as follows-# yum erase openldap-servers"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "openldap-servers-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.8 Disable NFS and RPC 'nfslock'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig nfslock off
# chkconfig rpcgssd off
# chkconfig rpcidmapd off
# chkconfig portmap off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "nfslock"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.8 Disable NFS and RPC 'rpcgssd'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig nfslock off
# chkconfig rpcgssd off
# chkconfig rpcidmapd off
# chkconfig portmap off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "rpcgssd"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.8 Disable NFS and RPC 'rpcidmapd'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig nfslock off
# chkconfig rpcgssd off
# chkconfig rpcidmapd off
# chkconfig portmap off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "rpcidmapd"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "3.8 Disable NFS and RPC 'portmap'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig nfslock off
# chkconfig rpcgssd off
# chkconfig rpcidmapd off
# chkconfig portmap off"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "portmap"
      levels      : "0123456"
      status      : OFF
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.9 Remove DNS Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase bind"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "bind-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.10 Remove FTP Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# yum erase vsftpd"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "vsftpd-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.11 Remove HTTP Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase httpd"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "httpd-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.12 Remove Dovecot (IMAP and POP3 services)"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase dovecot"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "dovecot-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.13 Remove Samba"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase samba"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "samba-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.14 Remove HTTP Proxy Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase squid"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "squid-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "3.15 Remove SNMP Server"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not Installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum erase net-snmp"
      reference   : "800-171|3.4.8,800-53|CM-7(4),CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "net-snmp-0.0.0-0"
      operator    : "lt"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.16 Configure Mail Transfer Agent for Local-Only Mode 'O DaemonPortOptions=Port=smtp, Addr=127.0.0.1, Name=MTA'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit /etc/mail/sendmail.cf and add the following line to the Options section. If the line
already exists, change it to look like the line below.O DaemonPortOptions=Port=smtp, Addr=127.0.0.1, Name=MTA
# Execute the following command to restart sendmail
# service sendmail restart
4 Network Configuration and Firewalls This section provides guidance for secure network and firewall configuration."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/mail/sendmail.cf"
      regex       : "^O[\\s]*DaemonPortOptions[\\s]*="
      expect      : "^O[\\s]*DaemonPortOptions[\\s]*=[\\s]*Port[\\s]*=[\\s]*smtp,[\\s]*Addr[\\s]*=[\\s]*127\.0\.0\.1,[\\s]*Name=MTA[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.1.1 Disable IP Forwarding 'net.ipv4.ip_forward = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.ip_forward parameter to 0 in /etc/sysctl.conf: net.ipv4.ip_forward=0"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-3561-8,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.ip_forward[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.ip_forward[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.1.2 Disable Send Packet Redirects 'net.ipv4.conf.all.send_redirects = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.send_redirects and net.ipv4.conf.default.send_redirects parameters to 0 in /etc/sysctl.conf:
net.ipv4.conf.all.send_redirects=0
net.ipv4.conf.default.send_redirects=0"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4151-7,CCE|CCE-4155-8,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.all\.send_redirects[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.all\.send_redirects[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.1.2 Disable Send Packet Redirects 'net.ipv4.conf.send_redirects = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.send_redirects and net.ipv4.conf.default.send_redirects parameters to 0 in /etc/sysctl.conf:
net.ipv4.conf.all.send_redirects=0
net.ipv4.conf.default.send_redirects=0"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4151-7,CCE|CCE-4155-8,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.default\.send_redirects[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.default\.send_redirects[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.1 Disable Source Routed Packet Acceptance 'net.ipv4.conf.all.accept_source_route = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.accept_source_route and net.ipv4.conf.default.accept_source_route parameters to 0 in /etc/sysctl.conf:
net.ipv4.conf.all.accept_source_route=0
net.ipv4.conf.default.accept_source_route=0
Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0
 /sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0
 /sbin/sysctl -w net.ipv4.route.flush=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4091-5,CCE|CCE-4236-6,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.all\.accept_source_route[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.all\.accept_source_route[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.1 Disable Source Routed Packet Acceptance 'net.ipv4.conf.default.accept_source_route = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.accept_source_route and net.ipv4.conf.default.accept_source_route parameters to 0 in /etc/sysctl.conf:
net.ipv4.conf.all.accept_source_route=0
net.ipv4.conf.default.accept_source_route=0
Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0
 /sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0
 /sbin/sysctl -w net.ipv4.route.flush=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4091-5,CCE|CCE-4236-6,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.default\.accept_source_route[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.default\.accept_source_route[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.2 Disable ICMP Redirect Acceptance 'net.ipv4.conf.all.accept_redirects = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.accept_redirects and net.ipv4.conf.default.accept_redirects parameters to 0 in /etc/sysctl.conf:
 net.ipv4.conf.all.accept_redirects=0
 net.ipv4.conf.default.accept_redirects=0

 Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0
 /sbin/sysctl -w net.ipv4.conf.default.ac"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4186-3,CCE|CCE-4217-6,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.all\.accept_redirects[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.all\.accept_redirects[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.2 Disable ICMP Redirect Acceptance 'net.ipv4.conf.default.accept_redirects = 0'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.accept_redirects and net.ipv4.conf.default.accept_redirects parameters to 0 in /etc/sysctl.conf:
 net.ipv4.conf.all.accept_redirects=0
 net.ipv4.conf.default.accept_redirects=0

 Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0
 /sbin/sysctl -w net.ipv4.conf.default.ac"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4186-3,CCE|CCE-4217-6,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.default\.accept_redirects[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.default\.accept_redirects[\\s]*=[\\s]*0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.4 Log Suspicious Packets 'net.ipv4.conf.all.log_martians = 1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.conf.all.log_martians and net.ipv4.conf.default.log_martians parameters to 1 in /etc/sysctl.conf:
net.ipv4.conf.all.log_martians=1
net.ipv4.conf.default.log_martians=1

Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.conf.all.log_martians=1
 /sbin/sysctl -w net.ipv4.conf.default.log_martians=1
 /sbin/sysctl -w net.ipv4.route.flush=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4320-8,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ISO/IEC-27001|A.12.4.1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.conf\.all\.log_martians[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.conf\.all\.log_martians[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.5 Enable Ignore Broadcast Requests 'net.ipv4.icmp_echo_ignore_broadcasts = 1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.icmp_echo_ignore_broadcasts parameter to 1 in /etc/sysctl.conf:
 net.ipv4.icmp_echo_ignore_broadcasts=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-3644-2,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.icmp_echo_ignore_broadcasts[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.icmp_echo_ignore_broadcasts[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.6 Enable Bad Error Message Protection 'net.ipv4.icmp_ignore_bogus_error_responses = 1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.icmp_ignore_bogus_error_responses parameter to 1 in /etc/sysctl.conf:
net.ipv4.icmp_ignore_bogus_error_responses=1

Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
 /sbin/sysctl -w net.ipv4.route.flush=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4133-5,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net\.ipv4\.icmp_ignore_bogus_error_responses[\\s]*="
      expect      : "^[\\s]*net\.ipv4\.icmp_ignore_bogus_error_responses[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.2.8 Enable TCP SYN Cookies 'net.ipv4.tcp_syncookies = 1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the net.ipv4.tcp_syncookies parameter to 1 in /etc/sysctl.conf:
 net.ipv4.tcp_syncookies=1

 Modify active kernel parameters to match:
 /sbin/sysctl -w net.ipv4.tcp_syncookies=1"
      reference   : "800-171|3.13.1,800-171|3.4.2,800-53|CM-6,800-53|SC-7(12),CCE|CCE-4265-5,CN-L3|8.1.10.6(d),CSCv6|9.2,CSF|PR.IP-1,ITSG-33|CM-6,ITSG-33|SC-7(12),NESA|T3.2.1,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/sysctl.conf"
      regex       : "^[\\s]*net.ipv4.tcp_syncookies[\\s]*="
      expect      : "^[\\s]*net.ipv4.tcp_syncookies[\\s]*=[\\s]*1[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.1 Deactivate Wireless Interfaces"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : N/A"
      info          : "Reboot Required : No"
      info          : "Scorable Item : No"
      info          : "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      info          : "NOTE : Per CIS, any wireless interface found should be downed :"
      info          : " ifdown <interface>"
      info          : "and the config script removed:"
      info          : " rm /etc/sysconfig/network-scripts/ifcfg-<interface>"
      solution      : "Use the following commands to list all interfaces and identify devices with wireless
interfaces. Once identified, shutdown the interface and remove it.
# ifconfig -a.
# iwconfig
# ifdown interface
# rm /etc/sysconfig/network-scripts/ifcfg-"
      reference     : "800-53|AC-18(3),CCE|CCE-4276-2,CSCv6|15.8,CSF|PR.PT-4,ITSG-33|AC-18(3),SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/sbin/iwconfig"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.4.2 Disable IPv6 'options ipv6 disable=1'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      solution    : "# echo options ipv6 'disable=1' >> /etc/modprobe.conf"
      reference   : "800-171|3.13.1,800-171|3.4.6,800-171|3.4.7,800-53|CM-7,800-53|SC-7(12),CCE|CCE-3562-6,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSCv6|9.2,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,ITSG-33|SC-7(12),NIAv2|AM38,NIAv2|SS13b,NIAv2|SS13d,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,NIAv2|SS26,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/modprobe.conf"
      regex       : "^[\\s]*options[\\s]+ipv6[\\s]"
      expect      : "^[\\s]*options[\\s]+ipv6[\\s]+[\"]disable[\\s]*=[\\s]*1[\"][\\s]*$"
    </custom_item>

#<custom_item>
# system		: "Linux"
# type		: FILE_CONTENT_CHECK
# description	: "4.4.1.1 Disable IPv6 Router Advertisements 'net.ipv6.conf.default.accept_ra = 0'"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : N/A"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "Set the net.ipv6.conf.all.accept_ra and net.ipv6.conf.default.accept_ra parameter
#to 0 in /etc/sysctl.conf-net.ipv6.conf.all.accept_ra=0
#net.ipv6.conf.default.accept_ra=0Modify active kernel parameters to match-# /sbin/sysctl -w net.ipv6.conf.all.accept_ra=0
# /sbin/sysctl -w net.ipv6.conf.default.accept_ra=0
# /sbin/sysctl -w net.ipv6.route.flush=1"
# reference	: "CCE|CCE-4269-7"
# see_also	: "https://workbench.cisecurity.org/files/214"
# file		: "/etc/sysctl.conf"
# regex		: "^[\\s]*net\.ipv6\.conf\.default\.accept_ra[\\s]*="
# expect		: "^[\\s]*net\.ipv6\.conf\.default\.accept_ra[\\s]*=[\\s]*0[\\s]*$"
#</custom_item>
#<custom_item>
# system		: "Linux"
# type		: FILE_CONTENT_CHECK
# description	: "4.4.1.2 Disable IPv6 Redirect Acceptance 'net.ipv6.conf.default.accept_redirect = 0'"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : N/A"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "Set the net.ipv6.conf.all.accept_redirects and
# net.ipv6.conf.default.accept_redirects parameters to 0 in /etc/sysctl.conf-net.ipv6.conf.all.accept_redirects=0
# net.ipv6.conf.default.accept_redirects=0Modify active kernel parameters to match-# /sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0
# /sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0
# /sbin/sysctl -w net.ipv6.route.flush=1"
# reference	: "CCE|CCE-4313-3"
# see_also	: "https://workbench.cisecurity.org/files/214"
# file		: "/etc/sysctl.conf"
# regex		: "^[\\s]*net\.ipv6\.conf\.default\.accept_redirects[\\s]*="
# expect		: "^[\\s]*net\.ipv6\.conf\.default\.accept_redirects[\\s]*=[\\s]*0[\\s]*$"
#</custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "4.5.1 Install TCP Wrappers"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Not installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum install tcp_wrappersTo verify if a service supports TCP Wrappers, run the following command-# ldd | grep libwrap.soIf there is any output, then the service supports TCP Wrappers."
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "tcp_wrappers-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.5.2 Create /etc/hosts.allow 'ALL:aaa.bbb.ccc.ddd/www.xxx.yyy.zzz"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      info        : "NOTE : This query uses sample IP space and should be changed to reflect the target environment."
      solution    : "Create /etc/hosts.allow-# echo 'ALL- aaa.bbb.ccc.ddd/www.xxx.yyy.zzz, aaa.bbb.ccc.ddd/www.xxx.yyy.zzz, ...' \ >/etc/hosts.allowwhere each <net>/<mask> combination (for example, '192.168.1.0/255.255.255.0') represents one network block in use by your organization that requires access to this
system."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7(5),NIAv2|GS7b,NIAv2|NS25"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/hosts.allow"
      regex       : "^[\\s]*ALL[\\s]*:"
# Note: Variable @HOSTS_ALLOW_NETWORK@ replaced with "192\\.0\\.2\\.0\\\\/255\\.255\\.255\\.0" in field "expect".
      expect      : "^[\\s]*ALL[\\s]*:[\\s]*192\\.0\\.2\\.0\\\\/255\\.255\\.255\\.0[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "4.5.3 Verify Permissions on /etc/hosts.allow"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Run the following command to determine the permissions on the /etc/hosts.allow file.# /bin/ls -l /etc/hosts.allow -rw-r--r-- 1 root root 2055 Jan 30 16-30 /etc/hosts.allow"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/hosts.allow"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.5.4 Create /etc/hosts.deny"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Create /etc/hosts.deny-# echo 'ALL- ALL' >> /etc/hosts.deny"
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7(5),NIAv2|GS7b,NIAv2|NS25"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/hosts.deny"
      regex       : "^[\\s]*ALL[\\s]*:"
      expect      : "^[\\s]*ALL[\\s]*:[\\s]*ALL[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "4.5.5 Verify Permissions on /etc/hosts.deny"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Installed"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If the permissions of the /etc/hosts.deny file are incorrect, run the following command to correct them-# /bin/chmod 644 /etc/hosts.deny"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/hosts.deny"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : CHKCONFIG
      description : "4.7 Enable IPtables"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# service iptables restart # chkconfig iptables on"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4189-7,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "iptables"
      levels      : "2345"
      status      : ON
    </custom_item>

#<custom_item>
# system		: "Linux"
# type		: CHKCONFIG
# description	: "4.8 Enable IP6tables"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : N/A"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "# service ip6tables restart # chkconfig ip6tables on5 Logging and AuditingThe items in this section describe how to configure logging, log monitoring, and auditing, using tools included with RHEL5.It is recommended that rsyslog be used for logging (with logwatch providing summarization) and auditd be used for auditing (with aureport providing summarization) to automatically monitor logs for intrusion attempts and other suspicious system behavior.In addition to the local log files created by the steps in this section, it is also recommended that sites collect copies of their system logs on a secure, centralized log server via an encrypted connection. Not only does centralized logging help sites correlate events that may be occurring on multiple systems, but having a second copy of the system log information may be critical after a system compromise where the attacker has modified the local log files on the affected system(s). If a log correlation system is deployed, configure it to process the logs described in this section.Because it is often necessary to correlate log information from many different systems (particularly after a security incident) it is recommended that the time be synchronized among systems and devices connected to the local network. The standard Internet protocol for time synchronization is the Network Time Protocol (NTP), which is supported by most network-ready devices. See the ntpd(8) manual page for more information on configuring NTP. It is important that all logs described in this section be monitored on a regular basis and correlated to determine trends. A seemingly innocuous entry in one log could be more significant when compared to an entry in another log. Although it is recommended that rsyslog be used for logging, guidance for configuring syslog is provided in for sites where rsyslog does not meet the requirements.Note on log file permissions- There really isn't a 'one size fits all' solution to the permissions on log files. Many sites utilize group permissions so that administrators who are in a defined security group, such as 'wheel' do not have to elevate privileges to root in order to read log files. Also, if a third party log aggregation tool is used, it may need to have group permissions to read the log files, which is preferable to having it run setuid to root. Therefore, there are two remediation and audit steps for log file permissions. One is for systems that do not have a secured group method implemented that only permits root to read the log files (root-root 600). The other is for sites that do have such a setup and are designated as root-securegrp 640 where securegrp is the defined security group (in some cases wheel)."
# reference	: "CCE|CCE-4167-3"
# see_also	: "https://workbench.cisecurity.org/files/214"
# service	: "ip6tables"
# levels		: "2345"
# status		: ON
#</custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.6.1 Disable DCCP 'install dccp /bin/true'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      solution    : "# echo 'install dccp /bin/true' >> /etc/modprobe.confImpact-OS Default- N/A"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CCE|CCE-14268-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/modprobe.conf"
      regex       : "^[\\s]*install[\\s]+dccp[\\s]"
      expect      : "^[\\s]*install[\\s]+dccp[\\s]+/bin/true[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.6.2 Disable SCTP 'install sctp /bin/true'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      solution    : "# echo 'install sctp /bin/true' >> /etc/modprobe.conf"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CCE|CCE-14132-5,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/modprobe.conf"
      regex       : "^[\\s]*install[\\s]+sctp[\\s]"
      expect      : "^[\\s]*install[\\s]+sctp[\\s]+/bin/true[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.6.3 Disable RDS 'install rds /bin/true'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      solution    : "# echo 'install rds /bin/true' >> /etc/modprobe.conf"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CCE|CCE-14027-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/modprobe.conf"
      regex       : "^[\\s]*install[\\s]+rds[\\s]"
      expect      : "^[\\s]*install[\\s]+rds[\\s]+/bin/true[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "4.6.4 Disable TIPC 'install tipc /bin/true'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : Yes"
      info        : "Scorable Item : No"
      solution    : "# echo 'install tipc /bin/true' >> /etc/modprobe.conf"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CCE|CCE-14911-2,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/modprobe.conf"
      regex       : "^[\\s]*install[\\s]+tipc[\\s]"
      expect      : "^[\\s]*install[\\s]+tipc[\\s]+/bin/true[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.1 Configure /etc/syslog.conf 'auth,user'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/syslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*auth,user\.\\*[\\s]"
      expect      : "^[\\s]*auth,user\.\\*[\\s]+\\/var\\/log\\/messages[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.1 Configure /etc/syslog.conf 'kern'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/syslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*kern\.\\*[\\s]"
      expect      : "^[\\s]*kern\.\\*[\\s]+\\/var\\/log\\/kern\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.1 Configure /etc/syslog.conf 'daemon'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/syslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*daemon\.\\*[\\s]"
      expect      : "^[\\s]*daemon\.\\*[\\s]+\\/var\\/log\\/daemon\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.1 Configure /etc/syslog.conf 'syslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/syslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*syslog\.\\*[\\s]"
      expect      : "^[\\s]*syslog\.\\*[\\s]+\\/var\\/log\\/syslog[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.1 Configure /etc/syslog.conf 'unused'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/syslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
      regex       : "^[\\s]*lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6\.\\*[\\s]"
      expect      : "^[\\s]*lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6\.\\*[\\s]+\\/var\\/log\\/unused\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.1.2 Create and Set Permissions on syslog Log Files '/var/log/messages'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "For sites that have not implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands-# touch <LOGFILE> # chown root-root <LOGFILE> # chmod og-rwx <LOGFILE>For sites that have implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <LOGFILE> # chown root-<securegrp> <LOGFILE> # chmod g-wx,o-rwx <LOGFILE>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/messages"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.1.2 Create and Set Permissions on syslog Log Files '/var/log/kern.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "For sites that have not implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands-# touch <LOGFILE> # chown root-root <LOGFILE> # chmod og-rwx <LOGFILE>For sites that have implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <LOGFILE> # chown root-<securegrp> <LOGFILE> # chmod g-wx,o-rwx <LOGFILE>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/kern.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.1.2 Create and Set Permissions on syslog Log Files '/var/log/daemon.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "For sites that have not implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands-# touch <LOGFILE> # chown root-root <LOGFILE> # chmod og-rwx <LOGFILE>For sites that have implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <LOGFILE> # chown root-<securegrp> <LOGFILE> # chmod g-wx,o-rwx <LOGFILE>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/daemon.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.1.2 Create and Set Permissions on syslog Log Files '/var/log/syslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "For sites that have not implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands-# touch <LOGFILE> # chown root-root <LOGFILE> # chmod og-rwx <LOGFILE>For sites that have implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <LOGFILE> # chown root-<securegrp> <LOGFILE> # chmod g-wx,o-rwx <LOGFILE>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/syslog"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.1.2 Create and Set Permissions on syslog Log Files '/var/log/unused.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "For sites that have not implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands-# touch <LOGFILE> # chown root-root <LOGFILE> # chmod og-rwx <LOGFILE>For sites that have implemented a secure admin group- For each LOGFILE listed in the /etc/syslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <LOGFILE> # chown root-<securegrp> <LOGFILE> # chmod g-wx,o-rwx <LOGFILE>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/unused.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.1.3 Configure syslog to Send Logs to a Remote Log Host '*.* @loghost.example.com'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/syslog.conf file and add the following line (where logfile.example.com is the name of your central log host).*.* @loghost.example.com # Execute the following command to restart syslogd # pkill -HUP syslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/syslog.conf"
# Note: Variable @SYSLOG_SERVER@ replaced with "@@loghost\\.example\\.com" in field "regex".
      regex       : "@@loghost\\.example\\.com"
# Note: Variable @SYSLOG_SERVER@ replaced with "@@loghost\\.example\\.com" in field "expect".
      expect      : "^[\\s]*\\*\.\\*[\\s]+@@loghost\\.example\\.com[\\s]*$"
    </custom_item>

#<custom_item>
# system		: "Linux"
# type		: FILE_CONTENT_CHECK
# description	: "5.1.4 Accept Remote syslog Messages Only on Designated Log Hosts 'loghost'"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : No"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "For each host designated as a log host, edit the /etc/sysconfig/syslog file and add the following line-SYSLOGD_OPTIONS='-m 0 -r -s <LOGHOST> ' # Execute the following command to restart syslogd # pkill -HUP syslogdFor hosts that are not designated log hosts, edit the /etc/sysconfig/syslog file and add the following line-SYSLOGD_OPTIONS='-m 0' # Execute the following command to restart syslogd # pkill -HUP syslogd"
# see_also	: "https://workbench.cisecurity.org/files/214"
# file		: "/etc/sysconfig/syslog"
# regex		: "^[\\s]*SYSLOGD_OPTIONS"
# expect		: "^[\\s]*SYSLOGD_OPTIONS=[\"]-m 0 -r -s LOGHOST[\"][\\s]*$"
#</custom_item>
#<custom_item>
# system		: "Linux"
# type		: FILE_CONTENT_CHECK
# description	: "5.1.4 Accept Remote syslog Messages Only on Designated Log Hosts 'non-loghost'"
# info		: "Configuration Level : Level-I"
# info		: "OS Default : No"
# info		: "Reboot Required : No"
# info		: "Scorable Item : No"
# solution       : "For each host designated as a log host, edit the /etc/sysconfig/syslog file and add the following line-SYSLOGD_OPTIONS='-m 0 -r -s <LOGHOST> ' # Execute the following command to restart syslogd # pkill -HUP syslogdFor hosts that are not designated log hosts, edit the /etc/sysconfig/syslog file and add the following line-SYSLOGD_OPTIONS='-m 0' # Execute the following command to restart syslogd # pkill -HUP syslogd"
# see_also	: "https://workbench.cisecurity.org/files/214"
# file		: "/etc/sysconfig/syslog"
# regex		: "^[\\s]*SYSLOGD_OPTIONS"
# expect		: "^[\\s]*SYSLOGD_OPTIONS=[\"]-m 0[\"][\\s]*$"
#</custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "5.2.1 Install the rsyslog package"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# yum install rsyslog"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      rpm         : "rsyslog-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      type        : CHKCONFIG
      description : "5.2.2 Activate the rsyslog Service 'syslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig syslog off # chkconfig rsyslog on"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "syslog"
      levels      : "123456"
      status      : OFF
    </custom_item>

    <custom_item>
      type        : CHKCONFIG
      description : "5.2.2 Activate the rsyslog Service 'rsyslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# chkconfig syslog off # chkconfig rsyslog on"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "rsyslog"
      levels      : "2345"
      status      : ON
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.3 Configure /etc/rsyslog.conf 'auth,user /var/log/messages'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/rsyslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*auth,user\.\\*[\\s]"
      expect      : "^[\\s]*auth,user\.\\*[\\s]+\\/var\\/log\\/messages[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.3 Configure /etc/rsyslog.conf 'kern /var/log/kern.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/rsyslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*kern\.\\*[\\s]"
      expect      : "^[\\s]*kern\.\\*[\\s]+\\/var\\/log\\/kern\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.3 Configure /etc/rsyslog.conf 'daemon /var/log/daemon.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/rsyslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*daemon\.\\*[\\s]"
      expect      : "^[\\s]*daemon\.\\*[\\s]+\\/var\\/log\\/daemon\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.3 Configure /etc/rsyslog.conf 'syslog /var/log/syslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/rsyslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*syslog\.\\*[\\s]"
      expect      : "^[\\s]*syslog\.\\*[\\s]+\\/var\\/log\\/syslog\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.3 Configure /etc/rsyslog.conf 'lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6 /var/log/unused.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the following lines in the /etc/rsyslog.conf file as appropriate for your environment-auth,user.* /var/log/messages kern.* /var/log/kern.log daemon.* /var/log/daemon.log syslog.* /var/log/syslog lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.* /var/log/unused.log # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6\.\\*[\\s]"
      expect      : "^[\\s]*lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6\.\\*[\\s]+\\/var\\/log\\/unused\.log[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.2.4 Create and Set Permissions on rsyslog Log Files '/var/log/messages'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For sites that have not implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands-# touch <logfile> # chown root-root <logfile> # chmod og-rwx <logfile>For sites that have implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <logfile> # chown root- <logfile> # chmod g-wx,o-rwx <logfile>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/messages"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.2.4 Create and Set Permissions on rsyslog Log Files '/var/log/kern.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For sites that have not implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands-# touch <logfile> # chown root-root <logfile> # chmod og-rwx <logfile>For sites that have implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <logfile> # chown root- <logfile> # chmod g-wx,o-rwx <logfile>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/kern.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.2.4 Create and Set Permissions on rsyslog Log Files '/var/log/daemon.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For sites that have not implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands-# touch <logfile> # chown root-root <logfile> # chmod og-rwx <logfile>For sites that have implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <logfile> # chown root- <logfile> # chmod g-wx,o-rwx <logfile>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/daemon.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.2.4 Create and Set Permissions on rsyslog Log Files '/var/log/syslog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For sites that have not implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands-# touch <logfile> # chown root-root <logfile> # chmod og-rwx <logfile>For sites that have implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <logfile> # chown root- <logfile> # chmod g-wx,o-rwx <logfile>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/syslog"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "5.2.4 Create and Set Permissions on rsyslog Log Files '/var/log/unused.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For sites that have not implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands-# touch <logfile> # chown root-root <logfile> # chmod og-rwx <logfile>For sites that have implemented a secure admin group-Create the /var/log/ directory and for each <logfile> listed in the /etc/rsyslog.conf file, perform the following commands (where <securegrp> is the name of the security group)-# touch <logfile> # chown root- <logfile> # chmod g-wx,o-rwx <logfile>"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/var/log/unused.log"
      owner       : "root"
      mask        : "7177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.5 Configure rsyslog to Send Logs to a Remote Log Host '*.* @@loghost.example.com'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/rsyslog.conf file and add the following line (where logfile.example.com is the name of your central log host).*.* @@loghost.example.com # Execute the following command to restart rsyslogd # pkill -HUP rsyslogdNote- The double 'at' sign (@@) directs rsyslog to use TCP to send log messages to the server, which is a more reliable transport mechanism than the default UDP protocol."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
# Note: Variable @SYSLOG_SERVER@ replaced with "@@loghost\\.example\\.com" in field "regex".
      regex       : "@@loghost\\.example\\.com"
# Note: Variable @SYSLOG_SERVER@ replaced with "@@loghost\\.example\\.com" in field "expect".
      expect      : "^[\\s]*\\*\.\\*[\\s]+@@loghost\\.example\\.com[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.6 Accept Remote rsyslog Messages Only on Designated Log Hosts '$ModLoad imtcp.so'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For hosts that are designated as log hosts, edit the /etc/rsyslog.conf file and add or modify the following lines-$ModLoad imtcp.so $InputTCPServerRun 514 # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*[\$]ModLoad[\\s]"
      expect      : "^[\\s]*[\$]ModLoad[\\s]+imtcp\.so[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.2.6 Accept Remote rsyslog Messages Only on Designated Log Hosts '$InputTCPServerRun 514'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "For hosts that are designated as log hosts, edit the /etc/rsyslog.conf file and add or modify the following lines-$ModLoad imtcp.so $InputTCPServerRun 514 # Execute the following command to restart rsyslogd # pkill -HUP rsyslogd"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/rsyslog.conf"
      regex       : "^[\\s]*[\$]InputTCPServerRun[\\s]"
      expect      : "^[\\s]*[\$]InputTCPServerRun[\\s]+514[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/messages'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/messages"
      expect      : "[\\s]*/var/log/messages[\\s]*"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/secure'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/secure"
      expect      : "[\\s]*/var/log/secure[\\s]*"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/maillog'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/maillog"
      expect      : "[\\s]*/var/log/maillog[\\s]*"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/spooler'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/spooler"
      expect      : "[\\s]*/var/log/spooler[\\s]*"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/boot.log'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/boot.log"
      expect      : "[\\s]*/var/log/boot.log[\\s]*"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "5.4 Configure logrotate - '/var/log/cron'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/logrotate.d/syslog file to include appropriate system logs-/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CCE|CCE-4182-2,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/logrotate.d/syslog"
      regex       : "[\\s]*/var/log/cron"
      expect      : "[\\s]*/var/log/cron[\\s]*"
    </custom_item>

    <custom_item>
      type        : CHKCONFIG
      description : "6.1.2 Enable cron Daemon"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Enabled"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chkconfig crond on"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4324-0,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      service     : "crond"
      levels      : "2345"
      status      : ON
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.3 Set User/Group Owner and Permission on /etc/anacrontab"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/anacrontab # chmod og-rwx /etc/anacrontab"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/anacrontab"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.4 Set User/Group Owner and Permission on /etc/crontab"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/crontab # chmod og-rwx /etc/crontab"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-3626-9,CCE|CCE-3851-3,CCE|CCE-4388-5,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/crontab"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.5 Set User/Group Owner and Permission on /etc/cron.hourly"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/cron.hourly # chmod og-rwx /etc/cron.hourly"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-3983-4,CCE|CCE-4054-3,CCE|CCE-4106-1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.hourly"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.6 Set User/Group Owner and Permission on /etc/cron.daily"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/cron.daily # chmod og-rwx /etc/cron.daily"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-3481-9,CCE|CCE-4022-0,CCE|CCE-4450-3,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.daily"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.7 Set User/Group Owner and Permission on /etc/cron.weekly"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/cron.weekly # chmod og-rwx /etc/cron.weekly"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-3833-1,CCE|CCE-4203-6,CCE|CCE-4331-5,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.weekly"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.8 Set User/Group Owner and Permission on /etc/cron.monthly"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/cron.monthly # chmod og-rwx /etc/cron.monthly"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4251-5,CCE|CCE-4322-4,CCE|CCE-4441-2,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.monthly"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.9 Set User/Group Owner and Permission on /etc/cron.d"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# chown root-root /etc/cron.d # chmod og-rwx /etc/cron.d"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4212-7,CCE|CCE-4250-7,CCE|CCE-4380-2,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.d"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK_NOT
      description : "6.1.10/6.1.11 at/cron Access '/etc/at.deny'"
      info        : "6.1.10 Restrict at Daemon '/etc/at.deny'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "6.1.11 Restrict at/cron to Authorized Users"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# rm /etc/at.deny
# touch /etc/at.allow
# chown root-root /etc/at.allow
# chmod og-rwx /etc/at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14466-7,CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/at.deny"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.10/6.1.11 at/cron Access '/etc/at.allow'"
      info        : "6.1.10 Restrict at Daemon"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "6.1.11 Restrict at/cron to Authorized Users"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# rm /etc/at.deny
# touch /etc/at.allow
# chown root-root /etc/at.allow
# chmod og-rwx /etc/at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CCE|CCE-14466-7,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/at.allow"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK_NOT
      description : "6.1.11 Restrict at/cron to Authorized Users '/etc/cron.deny'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# /bin/rm /etc/cron.deny
# /bin/rm /etc/at.deny
# chmod og-rwx /etc/cron.allow
# chmod og-rwx /etc/at.allow
# chown root-root /etc/cron.allow
# chown root-root /etc/at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.deny"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.1.11 Restrict at/cron to Authorized Users '/etc/cron.allow'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# /bin/rm /etc/cron.deny
# /bin/rm /etc/at.deny
# chmod og-rwx /etc/cron.allow
# chmod og-rwx /etc/at.allow
# chown root-root /etc/cron.allow
# chown root-root /etc/at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/cron.allow"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.1 Set SSH Protocol to 2"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-Protocol 2"
      reference   : "800-53|CM-7,CCE|CCE-4245-7,CIP|007-6-R1,CSF|PR.IP-1,CSF|PR.PT-3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*Protocol[\\s]"
      expect      : "^[\\s]*Protocol[\\s]+2[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.2 Set LogLevel to INFO"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-LogLevel INFO"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*LogLevel[\\s]"
      expect      : "^[\\s]*LogLevel[\\s]+[iI][nN][fF][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "6.2.3 Set Permissions on /etc/ssh/sshd_config"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Run the following command to determine the user and group ownership on the
/etc/ssh/sshd_config file.
# /bin/ls -l /etc/ssh/sshd_config
-rw-r--r-- 1 root root 762 Sep 23 002 /etc/ssh/sshd_config"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-3495-9,CCE|CCE-3958-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.4 Disable SSH X11 Forwarding"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-X11Forwarding no"
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*X11Forwarding[\\s]"
      expect      : "^[\\s]*X11Forwarding[\\s]+[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.5 Set SSH MaxAuthTries to 4 or Less"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-MaxAuthTries 4"
      reference   : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*MaxAuthTries[\\s]"
      expect      : "^[\\s]*MaxAuthTries[\\s]+[1-4][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.6 Set SSH IgnoreRhosts to Yes"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-IgnoreRhosts yes"
      reference   : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CCE|CCE-4250-7,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.6.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*IgnoreRhosts[\\s]"
      expect      : "^[\\s]*IgnoreRhosts[\\s]+[yY][eE][sS][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.7 Set SSH HostbasedAuthentication to No"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-HostbasedAuthentication no"
      reference   : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CCE|CCE-4251-5,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,NESA|T5.2.3,NESA|T5.6.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*HostbasedAuthentication[\\s]"
      expect      : "^[\\s]*HostbasedAuthentication[\\s]+[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.8 Disable SSH Root Login"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-PermitRootLogin no"
      reference   : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17,CCE|CCE-4252-3,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,SWIFT-CSCv1|5.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PermitRootLogin[\\s]"
      expect      : "^[\\s]*PermitRootLogin[\\s]+[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.9 Set SSH PermitEmptyPasswords to No"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-PermitEmptyPasswords no"
      reference   : "800-171|3.5.2,800-53|IA-5,CCE|CCE-4256-4,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PermitEmptyPasswords[\\s]"
      expect      : "^[\\s]*PermitEmptyPasswords[\\s]+[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.10 Do Not Allow Users to Set Environment Options 'PermitUserEnvironment no'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-PermitUserEnvironment no"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4265-5,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*PermitUserEnvironment[\\s]"
      expect      : "^[\\s]*PermitUserEnvironment[\\s]+[nN][oO][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.11 Use Only Approved Ciphers in Counter Mode 'Ciphers aes128-ctr,aes192-ctr,aes256-ctr'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-Ciphers aes128-ctr,aes192-ctr,aes256-ctr"
      reference   : "800-171|3.13.11,800-53|SC-13,CCE|CCE-4269-7,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*Ciphers[\\s]"
      expect      : "^[\\s]*Ciphers[\\s]+(,?aes128-ctr|,?aes192-ctr|,?aes256-ctr){3}[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.12 Set Idle Timeout Interval for User Login 'ClientAliveInterval <= 300'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
ClientAliveInterval 300
ClientAliveCountMax 0"
      reference   : "800-171|3.1.11,800-53|AC-12,CCE|CCE-4247-3,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*ClientAliveInterval[\\s]"
      expect      : "^[\\s]*ClientAliveInterval[\\s]+([1-9]|[1-9][0-9]|[1-2][0-9][0-9]|300)[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.12 Set Idle Timeout Interval for User Login 'ClientAliveCountMax'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
ClientAliveInterval 300
ClientAliveCountMax 0"
      reference   : "800-171|3.1.11,800-53|AC-12,CCE|CCE-4247-3,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*ClientAliveCountMax[\\s]"
      expect      : "^[\\s]*ClientAliveCountMax[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "6.2.13 Limit Access via SSH 'AllowUsers/Groups, DenyUsers/Groups'"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : No"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      info          : "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-AllowUsers <userlist>
AllowGroups <grouplist>
DenyUsers <userlist>
DenyGroups <grouplist>"
      reference     : "800-53|AC-6(7),CSF|PR.AC-4,ISO/IEC-27001|A.9.2.5,NESA|M1.1.3,NESA|T5.1.1"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/bin/egrep -i '(Allow|Deny)(Users|Groups)' /etc/ssh/sshd_config"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.14 Set SSH Banner 'Banner /etc/issue'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows:
 Banner /etc/issue.net"
      reference   : "800-171|3.1.9,800-53|AC-8,CCE|CCE-4260-6,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*Banner[\\s]"
# Note: Variable @BANNER_FILE@ replaced with "\\\\/etc\\\\/issue" in field "expect".
      expect      : "^[\\s]*Banner[\\s]+\\\\/etc\\\\/issue[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.2.15 Enable SSH UsePrivilegeSeparation 'UsePrivilegeSeparation yes'"
      info        : "Configuration Level : Level-I"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-UsePrivilegeSeparation yes
 Note- UsePrivilegeSeparation defaults to yes if not present in configuration."
      reference   : "800-171|3.4.2,800-53|CM-6,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*UsePrivilegeSeparation[\\s]"
      expect      : "^[\\s]*UsePrivilegeSeparation[\\s]+yes"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.3.1 Set Password Creation Requirement Parameters Using pam_cracklib 'password required'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the pam_cracklib.so parameters as follows in /etc/pam.d/system-auth-password required pam_cracklib.so try_first_pass retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1"
      reference   : "800-171|3.1.8,800-53|AC-7,CIP|007-6-R5,CN-L3|8.1.4.1(b),CSCv6|16.7,HIPAA|164.308(a)(5)(ii)(D),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/pam.d/system-auth"
      regex       : "^[\\s]*password[\\s]+required[\\s]+pam_cracklib\.so[\\s]"
      expect      : "^[\\s]*password[\\s]+required[\\s]+pam_cracklib\.so[\\s]+try_first_pass[\\s]+retry=3[\\s]+minlen=14[\\s]+dcredit=-1[\\s]+ucredit=-1[\\s]+ocredit=-1[\\s]+lcredit=-1[\\s]*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.3.2 Set Lockout for Failed Password Attempts 'auth required pam_tally2.so deny=5 onerr=fail'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "# sed -i '5i\auth\trequired\pam_tally2.so deny=5 onerr=fail' /etc/pam.d/system-authNote- If a user has been locked out because they have reached the maximum consecutive failure count defined by deny= is the pam_tally2.so module, the user can be unlocked by issuing the command /usr/sbin/pam_tally2 -u --reset=0. This command sets the failed tally count to 0, effectively unlocking the userid."
      reference   : "800-171|3.1.8,800-53|AC-7,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/pam.d/system-auth"
      regex       : "^[\\s]*auth[\\s]+required[\\s]+pam_tally2.so[\\s]"
      expect      : "^[\\s]*auth[\\s]+required[\\s]+pam_tally2.so[\\s]+deny=5[\\s]+onerr=fail[\\s]*$"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Linux"
          type        : FILE_CONTENT_CHECK
          description : "/etc/pam.d/system-auth contains 'auth requisite pam_deny.so'"
          file        : "/etc/pam.d/system-auth"
          regex       : "^[\\s]*auth[\\s]+requisite[\\s]+pam_deny\\.so"
          expect      : "^[\\s]*auth[\\s]+requisite[\\s]+pam_deny\\.so[\\s]*$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Linux"
          type        : FILE_CONTENT_CHECK
          description : "6.3.3 Use pam_deny.so to Deny Services 'auth requisite pam_deny.so' or 'include system-auth'"
          info        : "Configuration Level : Level-I
OS Default : N/A
Reboot Required : No
Scorable Item : No"
          solution    : "Edit PAM aware services as shown below. For example the sshd service would be modified by editing the /etc/pam.d/sshd file as shown-auth requisite pam_deny.soNote- Perform this action for every service that provides authentication and supports PAM."
          reference   : "800-171|3.5.2,800-53|IA-5,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3"
          see_also    : "https://workbench.cisecurity.org/files/214"
          file        : "/etc/pam.d/*"
          regex       : "^[\\s]*(auth[\\s]+requisite[\\s]+pam_deny\\.so|auth[\\s]+include[\\s]+system-auth)"
          expect      : "^[\\s]*(auth[\\s]+requisite[\\s]+pam_deny\\.so|auth[\\s]+include[\\s]+system-auth)[\\s]*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Linux"
          type        : FILE_CONTENT_CHECK
          description : "6.3.3 Use pam_deny.so to Deny Services 'auth requisite pam_deny.so' /etc/pam.d/*"
          info        : "Configuration Level : Level-I
OS Default : N/A
Reboot Required : No
Scorable Item : No"
          solution    : "Edit PAM aware services as shown below. For example the sshd service would be modified by editing the /etc/pam.d/sshd file as shown-auth requisite pam_deny.soNote- Perform this action for every service that provides authentication and supports PAM."
          reference   : "800-171|3.5.2,800-53|IA-5,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3"
          see_also    : "https://workbench.cisecurity.org/files/214"
          file        : "/etc/pam.d/*"
          regex       : "^[\\s]*auth[\\s]+requisite[\\s]+pam_deny\\.so"
          expect      : "^[\\s]*auth[\\s]+requisite[\\s]+pam_deny\\.so[\\s]*$"
          ignore      : "/etc/pam.d/system-auth"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.3.3 Use pam_deny.so to Deny Services 'auth requisite pam_deny.so' /etc/pam.d/sshd"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Edit PAM aware services as shown below. For example the sshd service would be modified by editing the /etc/pam.d/sshd file as shown-auth requisite pam_deny.soNote- Perform this action for every service that provides authentication and supports PAM."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/pam.d/sshd"
      regex       : "^[\\s]*auth[\\s]+requisite[\\s]"
      expect      : "^[\\s]*auth[\\s]+requisite[\\s]+pam_deny.so[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "6.3.4 Upgrade Password Hashing Algorithm to SHA-512"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : N/A"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "Perform the following to configure the system as recommended-# authconfig --passalgo=sha512 --updateNote- If it is determined that the password algorithm being used is not SHA-512, once it is
changed, it is recommended that all userID's be immediately expired and forced to change
their passwords on next login. To accomplish that, the following commands can be used.
Any system accounts that need to be expired should be carefully done separately by the
system administrator to prevent any potential problems.# cat /etc/passwd | awk -F- '( $3 >=500 && $1 != 'nfsnobody' ) { print $1 }' | xargs -
n 1 chage -d 0"
      reference     : "800-171|3.5.10,800-53|IA-5(1),CSCv6|16.13,CSCv6|16.14,CSF|PR.AC-1,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|CY6,PCI-DSSv3.1|8.2.1,PCI-DSSv3.2|8.2.1,SWIFT-CSCv1|4.1,TBA-FIISB|26.1"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/usr/sbin/authconfig --test | /bin/grep hashing"
      expect        : "[sS][hH][aA]512"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.3.5 Limit Password Reuse 'password sufficient pam_unix.o <existing options> remember=5'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the pam_unix.so remember parameter to 5 in /etc/pam.d/system_auth-password sufficient pam_unix.so remember=5"
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/pam.d/system-auth"
      regex       : "^[\\s]*password[\\s]+sufficient[\\s]+pam_unix.so[\\s]"
      expect      : "^[\\s]*password[\\s]+sufficient[\\s]+pam_unix.so[\\s]+.*[\\s]+remember=5[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "6.4 Restrict root Login to System Console"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : N/A"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      info          : "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "Remove entries for any consoles that are not in a physically secure location."
      reference     : "800-53|AC-6(3),CCE|CCE-3485-0,CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),NESA|T5.1.1,NESA|T5.5.4,SWIFT-CSCv1|5.1"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/bin/cat /etc/securetty"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "6.5 Restrict Access to the su Command '/etc/pam.d/su - auth required pam_wheel.so use_uid'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the pam_wheel.so parameters as follows in /etc/pam.d/su-auth required pam_wheel.so use_uidSet the proper list of users to be included in the wheel group in /etc/groups.7 User Accounts and EnvironmentThis section provides guidance on setting up secure defaults for system and user accounts and their environment. Guidance for monitoring these settings and others that may change over time is provided in Section 10 System Maintenance."
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/pam.d/su"
      regex       : "^[\\s]*auth[\\s]+required[\\s]+pam_wheel.so[\\s]"
      expect      : "^[\\s]*auth[\\s]+required[\\s]+pam_wheel.so[\\s]+use_uid[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "6.5 Restrict Access to the su Command '/etc/group - wheel:x:10:root, <user list>'"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : No"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "Set the pam_wheel.so parameters as follows in /etc/pam.d/su-auth required pam_wheel.so use_uidSet the proper list of users to be included in the wheel group in /etc/groups.7 User Accounts and EnvironmentThis section provides guidance on setting up secure defaults for system and user accounts and their environment. Guidance for monitoring these settings and others that may change over time is provided in Section 10 System Maintenance."
      reference     : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/bin/grep ^wheel: /etc/group"
      expect        : "^wheel:x:10:root(,|$)"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : GRAMMAR_CHECK
      description : "7.2/9.2.17 System Accounts and UIDs"
      info        : "7.2 Disable System Accounts"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : "9.2.17 Check That Reserved UIDs Are Assigned to System Accounts"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Accounts that have been locked are prohibited from running commands on the system.
Such accounts are not able to login to the system nor are they able to use scheduled
execution facilities such as cron. To make sure system accounts cannot be accessed, using
the following script-#!/bin/bash
for user in ` awk -F- ' ($3 < 500) {print $1 }' /etc/passwd; do
if [ $user != 'root' ]
then
/usr/sbin/usermod -L $user
if [ $user != 'sync' && $user != 'shutdown' && $user != 'halt' ]
then
/usr/sbin/usermod -s /sbin/nologin $user
fi
fi
done"
      reference   : "800-171|3.1.5,800-53|AC-6,CCE|CCE-4060-0,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/passwd"
      regex       : "^[A-Za-z0-9_-]+:x:([1-9]:|[0-9][0-9]:|[0-4][0-9]{2}:)[0-9]+:[-A-Za-z0-9_ \/-]*:[-A-Za-z0-9_\/-]+:/sbin/nologin"
      regex       : "^[A-Za-z0-9_-]+:x:([0-9]{4,}|[5-9][0-9]{2}):[0-9]+:[-A-Za-z0-9_ \/-]*:[-A-Za-z0-9_\/]+:.*"
      regex       : "^root:x:0:0:root:/root:/bin/bash"
    </custom_item>

    <item>
      description : "7.1.1 Set Password Expiration Days '1-90'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the PASS_MAX_DAYS parameter to 90 in /etc/login.defs-PASS_MAX_DAYS 90Modify active user parameters to match-# chage --maxdays 90 <user>"
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "max_password_age"
      value       : "1..90"
    </item>

    <item>
      description : "7.1.2 Set Password Change Minimum Number of Days '7+'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the PASS_MIN_DAYS parameter to 7 in /etc/login.defs-PASS_MIN_DAYS 7Modify active user parameters to match-# chage --mindays 7 <user>"
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "min_password_age"
      value       : "7..MAX"
    </item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "7.1.3 Set Password Expiring Warning Days 'PASS_WARN_AGE >= 7'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs-PASS_WARN_AGE 7Modify active user parameters to match-# chage --warndays 7 <user>"
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/login.defs"
      regex       : "^[\\s]*PASS_WARN_AGE[\\s]+"
      expect      : "^[\\s]*PASS_WARN_AGE[\\s]+([7-9]|[1-9][0-9][0-9]?)[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "7.3 Set Default Group for root Account"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : No"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "# usermod -g 0 root"
      reference     : "800-171|3.1.5,800-53|AC-6(5),CCE|CCE-4060-0,CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,SWIFT-CSCv1|1.2"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/usr/bin/id -g root"
      expect        : "^0$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "7.4 Set Default umask for Users '/etc/bashrc - umask 077'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/bashrc and /etc/profile.d/cis.sh files (and the appropriate files for any
other shell supported on your system) and add the following the UMASK parameter as
shown-umask 77"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CCE|CCE-4060-0,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/bashrc"
      regex       : "^[\\s]*[uU][mM][aA][sS][kK][\\s]"
      expect      : "^[\\s]*[uU][mM][aA][sS][kK][\\s]+=[\\s]+077[\\s]*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : FILE_CONTENT_CHECK
      description   : "7.4 Set Default umask for Users '/etc/profile.d/* - umask 077'"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : No"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "Edit the /etc/bashrc and /etc/profile.d/cis.sh files (and the appropriate files for any
other shell supported on your system) and add the following the UMASK parameter as
shown-umask 77"
      reference     : "800-171|3.1.1,800-53|AC-3(4),CCE|CCE-4060-0,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4)"
      see_also      : "https://workbench.cisecurity.org/files/214"
      file          : "/etc/profile.d/*"
      regex         : "^[\\s]*[uU][mM][aA][sS][kK][\\s]"
      expect        : "^[\\s]*[uU][mM][aA][sS][kK][\\s]+077[\\s]*$"
      file_required : NO
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "7.5 Lock Inactive User Accounts 'INACTIVE=35'"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : No"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "# useradd -D -f 35"
      reference     : "800-53|AC-2(3),CCE|CCE-4060-0,CIP|004-6-R5,CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),NIAv2|AM26,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4,TBA-FIISB|36.2.2"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/usr/sbin/useradd -D | /bin/grep INACTIVE"
      expect        : "^INACTIVE=35$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : BANNER_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/motd'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.1.9,800-53|AC-8,CCE|CCE-4060-0,ITSG-33|AC-8,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/motd"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : BANNER_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/issue'"
      info        : "OS Default : No

      Reboot Required : No"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.1.9,800-53|AC-8,CCE|CCE-4060-0,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : BANNER_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/issue.net'"
      info        : "OS Default : No

      Reboot Required : No"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.1.9,800-53|AC-8,CCE|CCE-4060-0,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue.net"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/motd perms'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4060-0,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/motd"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/issue perms'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4060-0,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "8.1.1 Set Warning Banner for Standard Login Services '/etc/issue.net perms'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/motd
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue
# echo 'Authorized uses only. All activity may be \
monitored and reported.' > /etc/issue.net
# chown root-root /etc/motd
# chmod 644 /etc/motd
# chown root-root /etc/issue
# chmod 644 /etc/issue
# chown root-root /etc/issue.net
# chmod 644 /etc/issue.net"
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4060-0,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue.net"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "8.1.2 Remove OS Information from Login Warning Banners '/etc/issue'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/motd, /etc/issue and /etc/issue.net files and remove any lines containing \m, \r, \s or \v."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue"
      regex       : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
      expect      : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "8.1.2 Remove OS Information from Login Warning Banners '/etc/motd'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/motd, /etc/issue and /etc/issue.net files and remove any lines containing \m, \r, \s or \v."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/motd"
      regex       : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
      expect      : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "8.1.2 Remove OS Information from Login Warning Banners '/etc/issue.net'"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : No"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Edit the /etc/motd, /etc/issue and /etc/issue.net files and remove any lines containing \m, \r, \s or \v."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/issue.net"
      regex       : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
      expect      : "(\\\\v|\\\\r|\\\\m|\\[\\s])"
    </custom_item>

    <custom_item>
      system       : "Linux"
      type         : BANNER_CHECK
      description  : "8.2 Set GNOME Warning Banner"
      info         : "OS Default : No

      Reboot Required : No"
      solution     : "Edit the file /usr/share/gdm/themes/RHEL/RHEL.xml and add the following statements after the two (2) pixmap blocks.

<item type='rect' id='custom-banner'>
<pos anchor='nw' x='20%' y='10' width='80%' height='100%'/>
<box>
<item type='label'>
<normal font='Sans Bold 9' color='#ffffff'/>
<text>
Insert the text of your warning banner here.
</text>
</item>
</box>
</item>"
      reference    : "800-171|3.1.9,800-53|AC-8,CCE|CCE-4188-9,ITSG-33|AC-8,LEVEL|1NS,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e"
      see_also     : "https://workbench.cisecurity.org/files/214"
      file         : "/usr/share/gdm/themes/RHEL/RHEL.xml"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content      : "All activities performed on this system will be monitored."
      is_substring : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.1.2/9.1.6 /etc/passwd Permissions and Ownership"
      info        : "9.1.2 Verify Permissions on /etc/passwd"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.1.6 Verify User/Group Ownership on /etc/passwd"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If the permissions of the /etc/passwd file are incorrect, run the following command to
correct them-# /bin/chmod 644 /etc/passwd"
      reference   : "800-53|IA-5(6),CCE|CCE-3495-9,CCE|CCE-3566-7,CCE|CCE-3958-6,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/passwd"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.1.3/9.1.7 /etc/shadow Permissions and Ownership"
      info        : "9.1.3 Verify Permissions on /etc/shadow"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.1.7 Verify User/Group Ownership on /etc/shadow"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If the permissions of the /etc/shadow file are incorrect, run the following command to correct them-# /bin/chmod 400 /etc/shadow"
      reference   : "800-53|IA-5(6),CCE|CCE-3918-0,CCE|CCE-3988-3,CCE|CCE-4130-1,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/shadow"
      owner       : "root"
      mask        : "377"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.1.4/9.1.8 /etc/gshadow Ownership and Permissions"
      info        : "9.1.4 Verify Permissions on /etc/gshadow"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.1.8 Verify User/Group Ownership on /etc/gshadow"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If the permissions of the /etc/gshadow file are incorrect, run the following command to correct them-# /bin/chmod 400 /etc/gshadow"
      reference   : "800-53|IA-5(6),CCE|CCE-3932-1,CCE|CCE-4064-2,CCE|CCE-4210-1,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/gshadow"
      owner       : "root"
      mask        : "377"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.1.5/9.1.9 /etc/group Ownership and Permissions"
      info        : "9.1.5 Verify Permissions on /etc/group"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.1.9 Verify User/Group Ownership on /etc/group"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If the permissions of the /etc/group file are incorrect, run the following command to correct them-# /bin/chmod 644 /etc/group"
      reference   : "800-53|IA-5(6),CCE|CCE-3276-3,CCE|CCE-3883-6,CCE|CCE-3967-7,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/group"
      owner       : "root"
      mask        : "133"
      group       : "root"
    </custom_item>

    <item>
      description : "9.1.10 Find World Writable Files"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Removing write access for the 'other' category (chmod o-w <filename>) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file."
      reference   : "800-171|3.1.5,800-53|AC-6,CCE|CCE-14794-2,CCE|CCE-3795-2,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "find_world_writeable_files"
    </item>

    <item>
      description : "9.1.11/9.1.12 Unowned and Ungrouped Files and Directories"
      info        : "9.1.11 Find Un-owned Files and Directories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.1.12 Find Un-grouped Files and Directories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate."
      reference   : "800-53|AC-16(3),CCE|CCE-3573-3,CCE|CCE-4223-4,CSF|PR.AC-4,ITSG-33|AC-16(3)"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "find_orphan_files"
    </item>

    <item>
      description : "9.1.13/9.1.14 SUID/SGID Files and Use"
      info        : "9.1.13 Find SUID System Executables"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      info        : ""
      info        : "9.1.14 Find SGID System Executables"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : No"
      solution    : "Ensure that no rogue set-UID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the the integrity of these binaries as described below-# rpm -V `rpm -qf /usr/bin/sudo` .......T /usr/bin/sudo SM5....T /usr/bin/sudoedit"
      reference   : "800-53|AC-6(8),CCE|CCE-14340-4,CSF|PR.AC-4"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "find_suid_sgid_files"
    </item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "9.2.1 Ensure Password Fields are Not Empty"
      info          : "Configuration Level : Level-I"
      info          : "OS Default : Yes"
      info          : "Reboot Required : No"
      info          : "Scorable Item : Yes"
      solution      : "If any accounts in the /etc/passwd file do not have a password, run the following command to lock the account until it can be determined why it does not have a password-# /usr/bin/passwd -l <username>Also, check to see if the account is logged in and investigate what it is being used for to determine if it needs to be forced off."
      reference     : "800-171|3.5.7,800-53|IA-5,CCE|CCE-4238-2,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also      : "https://workbench.cisecurity.org/files/214"
      cmd           : "/bin/cat /etc/shadow | /bin/awk -F : '($2 == \"\") { print $1 \" does not have a password.\"}'"
      expect        : ""
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.2.2 Verify No Legacy '+' Entries Exist in /etc/passwd File"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.5.1,800-53|IA-2,CCE|CCE-4114-5,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/passwd"
      regex       : "^[\\s]*\\+:"
      expect      : "^[\\s]*\\+:"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.2.3 Verify No Legacy '+' Entries Exist in /etc/shadow File"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.5.1,800-53|IA-2,CCE|CCE-14071-5,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/shadow"
      regex       : "^[\\s]*\\+:"
      expect      : "^[\\s]*\\+:"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.2.4 Verify No Legacy '+' Entries Exist in /etc/group File"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.5.1,800-53|IA-2,CCE|CCE-14675-3,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "/etc/group"
      regex       : "^[\\s]*\\+:"
      expect      : "^[\\s]*\\+:"
    </custom_item>

    <item>
      description : "9.2.5 Verify No UID 0 Accounts Exist Other Than root"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Delete any other entries that are displayed."
      reference   : "800-171|3.1.5,800-53|AC-6(5),CCE|CCE-4009-7,CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,SWIFT-CSCv1|1.2"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "passwd_zero_uid"
    </item>

    <item>
      description : "9.2.6 Ensure root PATH Integrity"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : Yes"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Correct or justify any items discovered in the Audit step."
      reference   : "800-171|3.4.7,800-53|CM-7(2),CCE|CCE-3301-9,CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "dot_in_root_path_variable"
    </item>

    <item>
      description : "9.2.7/9.2.14 Home Directory Permissions and Ownwership"
      info        : "9.2.7 Check Permissions on User Home Directories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.2.14 Check User Home Directory Ownership"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CCE|CCE-4090-7,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "accounts_bad_home_permissions"
      mask        : "027"
    </item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.2.8 Check User Dot File Permissions"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "~/.*"
      mask        : "0002"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "9.2.9 Check Permissions on User .netrc Files"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "~/.netrc"
      mask        : "0077"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK_NOT
      description : "9.2.10 Check for Presence of User .rhosts Files"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "~/.rhosts"
    </custom_item>

    <item>
      description : "9.2.11 Check Groups in /etc/passwd"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found."
      reference   : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "passwd_invalid_gid"
    </item>

    <item>
      description : "9.2.12/9.2.13 User Home Directory Assigment and Existence"
      info        : "9.2.12 Check That Users Are Assigned Home Directories"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      info        : ""
      info        : "9.2.13 Check That Defined Home Directories Exist"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      solution    : "If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users without an assigned home directory should be removed or assigned a home directory as appropriate."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "accounts_without_home_dir"
    </item>

    <item>
      description : "9.2.15 Check for Duplicate UIDs"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "passwd_duplicate_uid"
    </item>

    <item>
      description : "9.2.16 Check for Duplicate GIDs"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "group_duplicate_gid"
    </item>

    <item>
      description : "9.2.18 Check for Duplicate User Names"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "passwd_duplicate_username"
    </item>

    <item>
      description : "9.2.19 Check for Duplicate Group Names"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/214"
      name        : "group_duplicate_name"
    </item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK_NOT
      description : "9.2.20 Check for Presence of User .netrc Files"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-53|IA-5(7),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-1,ITSG-33|IA-5(7),PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "~/.netrc"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK_NOT
      description : "9.2.21 Check for Presence of User .forward Files"
      info        : "Configuration Level : Level-I"
      info        : "OS Default : N/A"
      info        : "Reboot Required : No"
      info        : "Scorable Item : Yes"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/214"
      file        : "~/.forward"
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS Red Hat EL 5 v2.2.0"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</check_type>
