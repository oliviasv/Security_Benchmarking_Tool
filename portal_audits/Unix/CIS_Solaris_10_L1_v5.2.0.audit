#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.19 $
# $Date: 2020/04/17 $
#
# Description: This .audit is designed against the CIS Benchmark
#        for Solaris 10 v5.2.0 based on: https://workbench.cisecurity.org/files/614
#
#
# NOTE		: The following audit will need to be edited for your organization by replacing
# 	  HOSTS_ALLOW_NETWORK with the network block in use at your organization.
# 	  2.4 Configure TCP Wrappers
#
#<ui_metadata>
#<display_name>CIS Solaris 10 L1 v5.2</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Solaris 10 L1</name>
#  <version>5.2.0</version>
#  <link>https://workbench.cisecurity.org/files/614</link>
#</spec>
#<labels>unix,cis,solaris,solaris_10</labels>
#<variables>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>All activities performed on this system will be monitored.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#  </variable>
#  <variable>
#    <name>HOSTS_ALLOW_NETWORK</name>
#    <default>192\.0\.2\.0\\/255\.255\.255\.0</default>
#    <description>Hosts.allow network entry</description>
#    <info>The IP address and network mask allowed access to the system as it appears in hosts.allow. If all systems are allowed use 'ALL'.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"OR">
    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "Solaris 10 is installed"
      file        : "/etc/release"
      regex       : ".*Solaris[\\s]+10"
      expect      : ".*Solaris[\\s]+10"
    </custom_item>

    <custom_item>
      type          : CMD_EXEC
      description   : "Solaris 10 installed - uname"
      cmd           : "/usr/bin/uname -a | /usr/bin/awk '{print$3}'"
      expect        : "5\\.10"
      dont_echo_cmd : YES
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Solaris_10_L1_v5.2.0.audit Level 1"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "1.1 Use the Latest OS Release - Check if Solaris 10 10/09 release is installed"
      info        : "Periodically, Oracle releases updates to the Solaris 10 operating system to support new hardware platforms, deliver new functionality as well as bundle together a set of patches that can be tested as a unit."
      solution    : "Obtain and install the latest update of the Solaris 10 OS software."
      reference   : "800-171|3.4.1,800-53|CM-8,CN-L3|8.1.10.2(a),CN-L3|8.1.10.2(b),CSF|DE.CM-7,CSF|ID.AM-1,CSF|ID.AM-2,CSF|PR.DS-3,ISO/IEC-27001|A.8.1.1,ITSG-33|CM-8,LEVEL|1NS,NESA|T1.2.1,NESA|T1.2.2,NIAv2|NS35"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/release"
      regex       : "Solaris 10 [0-9]+\/[0-9]+"
      expect      : "Solaris 10 [0-9]+/(09|1[0-9])"
    </custom_item>

    <report type:"WARNING">
      description : "1.2 Apply Latest OS Patches"
      info        : "During the patch cluster installation process, administrators may ignore individual patches that fail to install returning either code 2 (indicates that the patch has already been installed on the system) or code 8 (the patch applies to an operating system package which is not installed on the machine). If a patch install fails with any other return code, consult the patch installation log in /var/sadm/install_data.

Note that in addition to installing the Patch Clusters as described above, administrators may wish to also check the Solaris<osrel>.PatchReport file (available from the same FTP site as the patch clusters) for additional security or functionality patches that may be required on the local system. Administrators are also encouraged to check the individual README files provided with each patch for further information and post-install instructions. Automated tools for maintaining current patch levels are also available, such as the Oracle Patch Manager tool ('man smpatch' for more info).

Note that best practices recommend verifying the integrity of downloaded software and patches using file or package signatures. Failure to do so may result in the system being compromised by a 'Trojan Horse' created by an attacker with unauthorized access to the archive site. Oracle provides digital signatures for its patches.

Note: This recommendation applies to all zones.

Installing the latest available patches provides protection from exploitation of known vulnerabilities that have been patched.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create a directory to extract the patches. Make sure this directory is owned by root and mode 755, such as /var/tmp/patches. Obtain OraclePatch Cluster from http://sunsolve.sun.com/show.do?target=patches/patch-access and look for the Recommended Patch Clusters. The downloaded file will, by default, be named <osrel>_Recommended_CPU_YYYY.MM.zip, where <osrel> is the Solaris OS release number. Download the Patch Cluster into /var/tmp/patches using the following commands:
# mkdir /var/tmp/patches
# chmod 755 /var/tmp/patches
# cd /var/tmp/patches

Once the patch cluster is downloaded, extract and install the patches using the following commands:
# unzip -qq *_Recommended.zip
# cd *_SunAlert_Patch_Cluster
# ./installcluster --<passcode>
# cd ..
# rm -rf *_Recommended*

The <passcode> may be found in the patch cluster README file and is required to ensure the README has been read."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/614"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : PKG_CHECK
      description : "1.3 Install Solaris Encryption Kit - Check if Package SUNWcrman is installed"
      info        : "The Solaris 10 Encryption Kit contains kernel modules that implement various encryption algorithms for IPsec and Kerberos, utilities that encrypt and decrypt files from the command line, and libraries with functions that application programs call to perform encryption.

The Encryption Kit enables larger key sizes (> 128) of the following algorithms -
AES (128, 192, and 256-bit key sizes) Blowfish (32 to 448-bit key sizes in 8-bit increments) RCFOUR/RC4 (8 to 2048-bit key sizes)

Please see the documentation included with the package for more information. Regulations on the export of encryption software are subject to change. This action is not needed for systems running Solaris 10 08/07 and newer as the Solaris 10 Encryption Kit is installed by default. Do not use this software download on systems running Solaris 10 08/07 or newer versions of the operating system.

Note - If you are installing the Encryption Kit on Solaris 10 11/06 or older versions of the Solaris OS, the package will also install SUNWcrman. On newer versions, the manual pages are included in the system manual pages by default."
      solution    : "For Solaris 10 11/06 or older versions of the Solaris OS, obtain the Solaris 10 Encryption Kit from https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_SMISite/ en_US/-/USD/ViewProductDetail-Start?ProductRef=Sol10-GA-Encryption-G-F@CDSCDS_ SMI
After downloading the software, to implement this action, execute the following commands -

unzip -qq sol-10-encrypt-GA-iso.zip
lofiadm -a `pwd`/sol-10-encrypt-GA.iso /dev/lofi/1
mount -F hsfs -o ro /dev/lofi/1 /mnt

Note that the device returned in the step above is the one to be used in the next step.

mount -F hsfs -o ro /dev/lofi/1 /mnt
cd /mnt/Encryption_10/`uname -p`/Packages
pkgadd -d . all [respond to pkgadd questions]
cd
umount /mnt
lofiadm -d /dev/lofi/1"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      required    : YES
      pkg         : "SUNWcrman"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : PKG_CHECK
      description : "1.3 Install Solaris Encryption Kit - Check if Package SUNWcry is installed"
      info        : "The Solaris 10 Encryption Kit contains kernel modules that implement various encryption algorithms for IPsec and Kerberos, utilities that encrypt and decrypt files from the command line, and libraries with functions that application programs call to perform encryption.

The Encryption Kit enables larger key sizes (> 128) of the following algorithms -
AES (128, 192, and 256-bit key sizes) Blowfish (32 to 448-bit key sizes in 8-bit increments) RCFOUR/RC4 (8 to 2048-bit key sizes)

Please see the documentation included with the package for more information. Regulations on the export of encryption software are subject to change. This action is not needed for systems running Solaris 10 08/07 and newer as the Solaris 10 Encryption Kit is installed by default. Do not use this software download on systems running Solaris 10 08/07 or newer versions of the operating system.

Note - If you are installing the Encryption Kit on Solaris 10 11/06 or older versions of the Solaris OS, the package will also install SUNWcrman. On newer versions, the manual pages are included in the system manual pages by default."
      solution    : "For Solaris 10 11/06 or older versions of the Solaris OS, obtain the Solaris 10 Encryption Kit from https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_SMISite/ en_US/-/USD/ViewProductDetail-Start?ProductRef=Sol10-GA-Encryption-G-F@CDSCDS_ SMI
After downloading the software, to implement this action, execute the following commands -

unzip -qq sol-10-encrypt-GA-iso.zip
lofiadm -a `pwd`/sol-10-encrypt-GA.iso /dev/lofi/1
mount -F hsfs -o ro /dev/lofi/1 /mnt
Note that the device returned in the step above is the one to be used in the next step.
mount -F hsfs -o ro /dev/lofi/1 /mnt
cd /mnt/Encryption_10/`uname -p`/Packages
pkgadd -d . all [respond to pkgadd questions]
cd
umount /mnt
lofiadm -d /dev/lofi/1"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      required    : YES
      pkg         : "SUNWcry"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : PKG_CHECK
      description : "1.3 Install Solaris Encryption Kit - Check if Package SUNWcryr is installed"
      info        : "The Solaris 10 Encryption Kit contains kernel modules that implement various encryption algorithms for IPsec and Kerberos, utilities that encrypt and decrypt files from the command line, and libraries with functions that application programs call to perform encryption.

The Encryption Kit enables larger key sizes (> 128) of the following algorithms -
AES (128, 192, and 256-bit key sizes) Blowfish (32 to 448-bit key sizes in 8-bit increments) RCFOUR/RC4 (8 to 2048-bit key sizes)

Please see the documentation included with the package for more information. Regulations on the export of encryption software are subject to change. This action is not needed for systems running Solaris 10 08/07 and newer as the Solaris 10 Encryption Kit is installed by default. Do not use this software download on systems running Solaris 10 08/07 or newer versions of the operating system.

Note - If you are installing the Encryption Kit on Solaris 10 11/06 or older versions of the Solaris OS, the package will also install SUNWcrman. On newer versions, the manual pages are included in the system manual pages by default."
      solution    : "For Solaris 10 11/06 or older versions of the Solaris OS, obtain the Solaris 10 Encryption Kit from https://cds.sun.com/is-bin/INTERSHOP.enfinity/WFS/CDS-CDS_SMISite/ en_US/-/USD/ViewProductDetail-Start?ProductRef=Sol10-GA-Encryption-G-F@CDSCDS_ SMI
After downloading the software, to implement this action, execute the following commands -

unzip -qq sol-10-encrypt-GA-iso.zip
lofiadm -a `pwd`/sol-10-encrypt-GA.iso /dev/lofi/1
mount -F hsfs -o ro /dev/lofi/1 /mnt
Note that the device returned in the step above is the one to be used in the next step.
mount -F hsfs -o ro /dev/lofi/1 /mnt
cd /mnt/Encryption_10/`uname -p`/Packages
pkgadd -d . all [respond to pkgadd questions]
cd
umount /mnt
lofiadm -d /dev/lofi/1"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      required    : YES
      pkg         : "SUNWcryr"
    </custom_item>

#
## 2.Restrict Services
##
#

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.1 Disable Local CDE ToolTalk Database Server  - Make sure that /network/rpc/cde-ttdbserver:tcp is disabled"
      info           : "The ToolTalk service enables independent CDE applications to communicate with each other without having direct knowledge of each other. Applications create and send ToolTalk messages to communicate with each other. The ToolTalk service receives these messages, determines the recipients, and then delivers the messages to the appropriate applications."
      solution       : "To disable the ToolTalk service, run the following command-
 svcadm disable svc:/network/rpc/cde-ttdbserver:tcp"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/cde-ttdbserver:tcp"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.2 Disable Local CDE Calendar Manager  - Make sure that /network/rpc/cde-calendar-manager is disabled"
      info           : "CDE Calendar Manager is an appointment and resource scheduling tool. CDE Calendar Manager can help you schedule and keep track of your daily appointments. Upon request, Calendar Manager can send you reminders in advance of your appointments. If you place the CDE Calendar Manager in local only mode, users on other computers will not be able to attach to the system calendar manager and look at the local users calendar."
      solution       : "To disable the CDE Calendar Manager service, run the following command-
svcadm disable svc:/network/rpc/cde-calendar-manager:default"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/cde-calendar-manager:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.3 Disable Local Graphical Login Environment  - Make sure that /application/graphical-login/cde-login is disabled"
      info           : "The CDE login service provides the capability of logging into the system using an Xwindows type interface from the console. If XDMCP remote session access to a machine is not required at all, but graphical login access for the console is required, leave the service in local-only mode. If there is no requirement for graphical services on the console, disable this service. Run this command from the command-line interface as disabling it will kill any active graphical sessions.
CDE login manager is just one of two available in the Solaris OS, the other being the GNOME Display Manager which is not enabled by default in Solaris."
      solution       : "To disable graphical login access from the console, run the following command-
 svcadm disable svc:/application/graphical-login/cde-login"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/graphical-login/cde-login:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.3 Disable Local Graphical Login Environment  - Make sure that /application/graphical-login/gdm2-login is disabled"
      info           : "The CDE login service provides the capability of logging into the system using an Xwindows type interface from the console. If XDMCP remote session access to a machine is not required at all, but graphical login access for the console is required, leave the service in local-only mode. If there is no requirement for graphical services on the console, disable this service. Run this command from the command-line interface as disabling it will kill any active graphical sessions.
CDE login manager is just one of two available in the Solaris OS, the other being the GNOME Display Manager which is not enabled by default in Solaris."
      solution       : "To disable graphical login access from the console, run the following command-
 svcadm disable svc:/application/graphical-login/cde-login"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "gdm2-login:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.4 Disable Local Web Console  - Make sure that /system/webconsole:console is disabled"
      info           : "The Java Web Console (smcwebserver(1M)) provides a common location for users to access web-based system management applications."
      solution       : "Perform the following to disable the Java Web Console-
 svcadm disable svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "system/webconsole:console"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.5 Disable Local WBEM  - Make sure that application/management/wbem is disabled"
      info           : "Web-Based Enterprise Management (WBEM) is a set of management and Internet technologies. Solaris WBEM Services software provides WBEM services in the Solaris OS, including secure access and manipulation of management data. The software includes a Solaris platform provider that enables management applications to access information about managed resources such as devices and software in the Solaris OS. WBEM is used by the Solaris Management Console (SMC)."
      solution       : "To disable Web-Based Enterprise Management, run the following command-
 svcadm disable svc:/application/management/wbem"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/management/wbem:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.1.6 Disable Local BSD Print Protocol Adapter  - Make sure that /application/print/rfc1179 is disabled"
      info           : "RFC 1179 describes the Berkeley system based line printer protocol. The service is used to control local Berkeley system based print spooling. It listens on port 515 for incoming print jobs. Secure by default limits access to the line printers by only allowing print jobs to be initiated from the local system. If the machine does not have locally attached printers, disable this service. Note that this service is not required for printing to a network printer.

Note - In Solaris 10, Update 8, this service is disabled by netservices limited if the service /application/print/server is disabled."
      solution       : "To disable local Berkeley system based print spooling, run the following command-
 svcadm disable svc:/application/print/rfc1179"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/print/rfc1179:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.1 Disable RPC Encryption Key  - Make sure that /network/rpc/keyserv is disabled"
      info           : "The keyserv process is only required for sites that are using Oracle's Secure RPC mechanism. The most common uses for Secure RPC on Solaris machines are NIS+ and 'secure NFS', which uses the Secure RPC mechanism to provide higher levels of security than the standard NFS protocols. Do not confuse 'secure NFS' with sites that use Kerberos authentication as a mechanism for providing higher levels of NFS security. 'Kerberized' NFS does not require the keyserv process to be running."
      solution       : "To disable the keyserv process, run the following command-
 svcadm disable svc:/network/rpc/keyserv"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/keyserv:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.2 Disable NIS Server Daemons  - Make sure that /network/nis/server is disabled"
      info           : "These daemons are only required on systems that are acting as an NIS server for the local site. Typically there are only a small number of NIS servers on any given network. These services are disabled by default unless the system has been previously configured to act as a NIS server."
      solution       : "No action is necessary to disable NIS server daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following commands -
svcadm disable svc:/network/nis/server
svcadm disable svc:/network/nis/passwd
svcadm disable svc:/network/nis/update
svcadm disable svc:/network/nis/xfr"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nis/server:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.2 Disable NIS Server Daemons  - Make sure that /network/nis/passwd is disabled"
      info           : "These daemons are only required on systems that are acting as an NIS server for the local site. Typically there are only a small number of NIS servers on any given network. These services are disabled by default unless the system has been previously configured to act as a NIS server."
      solution       : "No action is necessary to disable NIS server daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following commands -
svcadm disable svc:/network/nis/server
svcadm disable svc:/network/nis/passwd
svcadm disable svc:/network/nis/update
svcadm disable svc:/network/nis/xfr"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nis/passwd:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.2 Disable NIS Server Daemons  - Make sure that /network/nis/update is disabled"
      info           : "These daemons are only required on systems that are acting as an NIS server for the local site. Typically there are only a small number of NIS servers on any given network. These services are disabled by default unless the system has been previously configured to act as a NIS server."
      solution       : "No action is necessary to disable NIS server daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following commands -
svcadm disable svc:/network/nis/server
svcadm disable svc:/network/nis/passwd
svcadm disable svc:/network/nis/update
svcadm disable svc:/network/nis/xfr"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nis/update:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.2 Disable NIS Server Daemons  - Make sure that /network/nis/xfr is disabled"
      info           : "These daemons are only required on systems that are acting as an NIS server for the local site. Typically there are only a small number of NIS servers on any given network. These services are disabled by default unless the system has been previously configured to act as a NIS server."
      solution       : "No action is necessary to disable NIS server daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following commands -
svcadm disable svc:/network/nis/server
svcadm disable svc:/network/nis/passwd
svcadm disable svc:/network/nis/update
svcadm disable svc:/network/nis/xfr"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nis/xfr:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.3 Disable NIS Client Daemons  - Make sure that /network/nis/client is disabled"
      info           : "If the local site is not using the NIS naming service to distribute system and user configuration information, this service may be disabled. This service is disabled by default unless the NIS service has been configured on the system."
      solution       : "No action is necessary to disable NIS client daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following command -
svcadm disable svc:/network/nis/client"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nis/client:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.4 Disable NIS+ daemons - Make sure that /network/rpc/nisplus is disabled"
      info           : "NIS+ was designed to be a more secure version of NIS. However, the use of NIS+ has been deprecated by Oracle and customers are encouraged to use LDAP as an alternative naming service. This service is disabled by default unless the NIS+ service has been configured on the system."
      solution       : "No action is necessary to disable NIS+ daemons unless they have been specifically enabled by the administrator. If so, they may be disabled using the following command-
svcadm disable svc:/network/rpc/nisplus"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/nisplus:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.5 Disable LDAP Cache Manager - Make sure that /network/ldap/client is disabled"
      info           : "If the local site is not currently using LDAP as a naming service, there is no need to keep LDAP-related daemons running on the local machine. This service is disabled by default unless LDAP client services have been configured on the system. If a naming service is required, users are encouraged to use LDAP instead of NIS/NIS+."
      solution       : "No action is necessary to disable the LDAP cache manager unless it has been specifically enabled by the administrator. To disable the LDAP cache manager, run the following command-
svcadm disable svc:/network/ldap/client"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/ldap/client:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.6 Disable Kerberos TGT Expiration Warning - Make sure that /network/security/ktkt_warn is disabled"
      info           : "While Kerberos can be a security enhancement, if the local site is not currently using Kerberos then there is no need to have the Kerberos TGT expiration warning enabled."
      solution       : "To disable the Kerberos TGT expiration warning, run the following command-
svcadm disable svc:/network/security/ktkt_warn"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/security/ktkt_warn:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.7 Disable Generic Security Services (GSS) daemons - Make sure that /network/rpc/gss is disabled"
      info           : "The GSS API is a security abstraction layer that is designed to make it easier for developers to integrate with different authentication schemes. It is most commonly used in applications for sites that use Kerberos for network authentication, though it can also allow applications to interoperate with other authentication schemes.

Note - Since this service uses Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when this service is turned on. This daemon will be taken offline if rpcbind is disabled. For more information see Item 2.3.14."
      solution       : "To disable the GSS API, run the following command-
svcadm disable svc:/network/rpc/gss"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/gss:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.8 Disable Volume Manager - Make sure that system/filesystem/volfs is disabled"
      info           : "The volume manager automatically mounts external devices for users whenever the device is attached to the system. These devices include CD-R, CD-RW, floppies, DVD, USB and 1394 mass storage devices. See the vold (1M) manual page for more details.

Note - Since this service uses Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when this service is turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service"
      solution       : "To disable vold, run the following command-
svcadm disable svc:/system/filesystem/volfs
svcadm disable svc:/network/rpc/smserver"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "system/filesystem/volfs:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.8 Disable Volume Manager - Make sure that network/rpc/smserver is disabled"
      info           : "The volume manager automatically mounts external devices for users whenever the device is attached to the system. These devices include CD-R, CD-RW, floppies, DVD, USB and 1394 mass storage devices. See the vold (1M) manual page for more details.

Note - Since this service uses Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when this service is turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service"
      solution       : "To disable vold, run the following command-
svcadm disable svc:/system/filesystem/volfs
svcadm disable svc:/network/rpc/smserver"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/smserver:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "Silent check to determine if it is Solaris 10 >= 08/07"
          file        : "/etc/release"
          regex       : "Solaris 10 [0-9]+/(0[7-9]|[1-9][0-9])+"
          expect      : "Solaris 10 [0-9]+/(0[7-9]|[1-9][0-9])+"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.9 Disable Samba Support - Make sure that /network/samba is disabled. Note this check is only applicable for Solaris 10 >= 8/07"
          info           : "Solaris includes the popular open source Samba server for providing file and print services to Windows-based systems. This allows a Solaris system to act as a file or print server on a Windows network, and even act as a Domain Controller (authentication server) to older Windows operating systems. Note that on Solaris releases prior to 11/06 the file /etc/sfw/smb.conf does not exist and the service will not be started by default even on newer releases."
          solution       : "To disable Samba, run the appropriate command for your Solaris OS level -
Solaris 10 <= 11/06
/etc/init.d/samba stop
mv /etc/sfw/smb.conf /etc/sfw/smb.conf.CIS"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "network/samba:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "Silent check to determine if it is Solaris 10 <= 11/06"
          file        : "/etc/release"
          regex       : "Solaris 10 [0-9]+/(0[0-6])"
          expect      : "Solaris 10 [0-9]+/(0[0-6])"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK_NOT
          description : "2.2.9 Disable Samba Support - Make sure that /etc/sfw/smb.conf does not exist. Note this check is only applicable for Solaris 10 >= 11/06"
          info        : "Solaris includes the popular open source Samba server for providing file and print services to Windows-based systems. This allows a Solaris system to act as a file or print server on a Windows network, and even act as a Domain Controller (authentication server) to older Windows operating systems. Note that on Solaris releases prior to 11/06 the file /etc/sfw/smb.conf does not exist and the service will not be started by default even on newer releases."
          solution    : "To disable Samba, run the appropriate command for your Solaris OS level -
Solaris 10 <= 11/06
/etc/init.d/samba stop
mv /etc/sfw/smb.conf /etc/sfw/smb.conf.CIS"
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/etc/sfw/smb.conf"
        </custom_item>
      </then>
    </if>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.10 Disable automount daemon - Make sure that /system/filesystem/autofs is disabled."
      info           : "The automount daemon is normally used to automatically mount NFS file systems from remote file servers when needed. However, the automount daemon can also be configured to mount local (loopback) file systems as well, which may include local user home directories, depending on the system configuration.

Sites that have local home directories configured via the automount daemon in this fashion will need to ensure that this daemon is running for Oracle's Solaris Management Console administrative interface to function properly. If the automount daemon is not running, the mount points created by SMC will not be mounted.

Note - Since this service uses Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when this service is turned on. For more information see Item 2.3.14 Disable Local RPC Portmapping Service."
      solution       : "To disable the automount daemon, run the following command-
 svcadm disable svc:/system/filesystem/autofs"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "system/filesystem/autofs:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "2.2.11 Disable Apache services - Make sure that /etc/apache/httpd.conf does not exist. Note this check is only applicable for Apache 1.x"
      info        : "The action in this section describes disabling the Apache 1.x and 2.x web servers provided with Solaris 10. Both services are disabled by default. Run control scripts for Apache 1 and the NCA web servers still exist, but the services will only be started if the respective configuration files have been set up appropriately, and these configuration files do not exist by default.
Even if the system is a Web server, the local site may choose not to use the Web server provided with Solaris in favor of a locally developed and supported Web environment. If the machine is a Web server, the administrator is encouraged to search the Web for additional documentation on Web server security."
      solution    : "To disable Apache, run the appropriate command for the version installed-
Apache 1.x-
/etc/init.d/apache stop # mv /etc/apache/httpd.conf /etc/apache/httpd.conf.CIS
Apache 2.x-
svcadm disable svc:/network/http:apache2"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/apache/httpd.conf"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.11 Disable Apache services - Make sure that network/http:apache2 is disabled."
      info           : "The action in this section describes disabling the Apache 1.x and 2.x web servers provided with Solaris 10. Both services are disabled by default. Run control scripts for Apache 1 and the NCA web servers still exist, but the services will only be started if the respective configuration files have been set up appropriately, and these configuration files do not exist by default.
Even if the system is a Web server, the local site may choose not to use the Web server provided with Solaris in favor of a locally developed and supported Web environment. If the machine is a Web server, the administrator is encouraged to search the Web for additional documentation on Web server security."
      solution       : "To disable Apache, run the appropriate command for the version installed-
Apache 1.x-
/etc/init.d/apache stop # mv /etc/apache/httpd.conf /etc/apache/httpd.conf.CIS
Apache 2.x-
svcadm disable svc:/network/http:apache2"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/http:apache2"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "Silent check to check if its a Solaris 10 <= 11/06"
          file        : "/etc/release"
          regex       : "Solaris 10 [0-9]+/(0[0-6])"
          expect      : "Solaris 10 [0-9]+/(0[0-6])"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that /system/metainit is disabled - Solaris 10 <= 11/06"
          info           : "Note this check is only applicable for Solaris 10 <= 11/06

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
svcadm disable svc:/system/metainit
svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "system/metainit:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>

        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that /platform/sun4u/mpxio-upgrade is disabled"
          info           : "Note this check is only applicable for Solaris 10 <= 11/06

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
svcadm disable svc:/system/metainit
svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "platform/sun4u/mpxio-upgrade:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>

        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that system/mdmonitor is disabled - Solaris 10 <= 11/06"
          info           : "Note this check is only applicable for Solaris 10 <= 11/06

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
svcadm disable svc:/system/metainit
svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "system/mdmonitor:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "Silent check to determine if it is Solaris 10 >= 08/07"
          file        : "/etc/release"
          regex       : "Solaris 10 [0-9]+/(0[7-9]|[1-9][0-9])+"
          expect      : "Solaris 10 [0-9]+/(0[7-9]|[1-9][0-9])+"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that /system/metainit is disabled - Solaris 10 >= 8/07"
          info           : "Note this check is only applicable for Solaris 10 >= 8/07

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
 svcadm disable svc:/system/metainit
 svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "system/metainit:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>

        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that /system/device/mpxio-upgrade is disabled"
          info           : "Note this check is only applicable for Solaris 10 >= 8/07

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
svcadm disable svc:/system/metainit
svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "system/device/mpxio-upgrade:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>

        <custom_item>
          system         : "SunOS"
          type           : SVC_PROP
          description    : "2.2.12 Disable Solaris Volume Manager Services - Make sure that system/mdmonitor is disabled - Solaris 10 >= 8/07"
          info           : "Note this check is only applicable for Solaris 10 >= 8/07

The Solaris Volume Manager, formerly known as Solstice DiskSuite, provides functionality for managing disk storage, disk arrays, etc. However, many systems without large storage arrays do not require that these services be enabled or may be using an alternate volume manager rather than the bundled SVM functionality. This service is disabled by default in the OS."
          solution       : "To disable the Solaris Volume Manager, run the following commands-
svcadm disable svc:/system/metainit
svcadm disable svc:/system/mdmonitor
In addition, run the appropriate command for the Solaris 10 level that you are running-
Solaris 10 <= 11/06
svcadm disable svc:/platform/sun4u/mpxio-upgrade
Solaris 10 >= 8/07
svcadm disable svc:/system/device/mpxio-upgrade"
          reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
          see_also       : "https://workbench.cisecurity.org/files/614"
          service        : "system/mdmonitor:default"
          regex          : "disabled"
          property       : "restarter/state"
          svcprop_option : CAN_BE_NULL
        </custom_item>
      </then>
    </if>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.13 Disable Solaris Volume Manager GUI - Make sure that /network/rpc/mdcomm is disabled."
      info           : "The Solaris Volume Manager, formerly Solstice DiskSuite, provides software RAID capability for Solaris systems.

This functionality can either be controlled via the GUI administration tools provided with the operating system, or via the command line. However, the GUI tools cannot function without several daemons listed in Item 2.3.12 Disable Solaris Volume Manager Services enabled.

If you have disabled Solaris Volume Manager Services, also disable the Solaris Volume Manager GUI.

Note - Since these services use Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when these services are turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service."
      solution       : "To disable the GUI administration tools for the Solaris Volume Manager, run the following commands-
svcadm disable svc:/network/rpc/mdcomm
svcadm disable svc:/network/rpc/meta
svcadm disable svc:/network/rpc/metamed
svcadm disable svc:/network/rpc/metamh"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/mdcomm:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.13 Disable Solaris Volume Manager GUI - Make sure that network/rpc/meta is disabled."
      info           : "The Solaris Volume Manager, formerly Solstice DiskSuite, provides software RAID capability for Solaris systems.

This functionality can either be controlled via the GUI administration tools provided with the operating system, or via the command line. However, the GUI tools cannot function without several daemons listed in Item 2.3.12 Disable Solaris Volume Manager Services enabled.

If you have disabled Solaris Volume Manager Services, also disable the Solaris Volume Manager GUI.

Note - Since these services use Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when these services are turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service."
      solution       : "To disable the GUI administration tools for the Solaris Volume Manager, run the following commands-
svcadm disable svc:/network/rpc/mdcomm
svcadm disable svc:/network/rpc/meta
svcadm disable svc:/network/rpc/metamed
svcadm disable svc:/network/rpc/metamh"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/meta:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.13 Disable Solaris Volume Manager GUI - Make sure that network/rpc/metamed is disabled."
      info           : "The Solaris Volume Manager, formerly Solstice DiskSuite, provides software RAID capability for Solaris systems.

This functionality can either be controlled via the GUI administration tools provided with the operating system, or via the command line. However, the GUI tools cannot function without several daemons listed in Item 2.3.12 Disable Solaris Volume Manager Services enabled.

If you have disabled Solaris Volume Manager Services, also disable the Solaris Volume Manager GUI.

Note - Since these services use Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when these services are turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service."
      solution       : "To disable the GUI administration tools for the Solaris Volume Manager, run the following commands-
svcadm disable svc:/network/rpc/mdcomm
svcadm disable svc:/network/rpc/meta
svcadm disable svc:/network/rpc/metamed
svcadm disable svc:/network/rpc/metamh"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/metamed:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.13 Disable Solaris Volume Manager GUI - Make sure that network/rpc/metamh is disabled."
      info           : "The Solaris Volume Manager, formerly Solstice DiskSuite, provides software RAID capability for Solaris systems.

This functionality can either be controlled via the GUI administration tools provided with the operating system, or via the command line. However, the GUI tools cannot function without several daemons listed in Item 2.3.12 Disable Solaris Volume Manager Services enabled.

If you have disabled Solaris Volume Manager Services, also disable the Solaris Volume Manager GUI.

Note - Since these services use Oracle's standard RPC mechanism, it is important that the system's RPC portmapper (rpcbind) also be enabled when these services are turned on. For more information see Item 2.3.14 Disable Local RPC Port Mapping Service."
      solution       : "To disable the GUI administration tools for the Solaris Volume Manager, run the following commands-
svcadm disable svc:/network/rpc/mdcomm
svcadm disable svc:/network/rpc/meta
svcadm disable svc:/network/rpc/metamed
svcadm disable svc:/network/rpc/metamh"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/metamh:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.2.14 Disable Local RPC Port Mapping Service - Make sure that network/rpc/bind is disabled."
      info           : "RPC-based services are typically deployed to use very weak or non-existent authentication and yet may share very sensitive information. Unless one of the services is required on this machine, it is best to disable RPC-based tools completely. If you are unsure whether or not a particular third-party application requires RPC services, consult with the application vendor."
      solution       : "To disable local RPC port mapping service, run the following command-
svcadm disable svc:/network/rpc/bind

If you want to restrict access to this service, but not disable it completely, consider using a host-based firewall such as ipfilter(5) to control what hosts are allowed to access this daemon. Alternatively, TCP Wrappers support can be enabled in the daemon with the commands-
svccfg -s svc:/network/rpc/bind setprop \ config/enable_tcpwrappers = true
svcadm refresh rpc/bind"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/bind:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/cde-printinfo:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1NS,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/cde-printinfo:default"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
      value          : "disabled"
    </custom_item>

# See also :
#
# http://opensolaris.org/os/community/security/projects/sbd/sbd_design/
# http://opensolaris.org/os/community/security/projects/sbd/sbd_toi.pdf
# According to the above document, cde-printinfo:default should be disabled, but "netservices limited"
# does not disable it. You may disable it manually by running: "svcadm disable application/cde-printinfo:default"
# which will cause the check directly below to pass.
#

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/cde-spc:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/cde-spc:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/management/dmi:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/management/dmi:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/management/sma:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited


Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/management/sma:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/management/snmpdx:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/management/snmpdx:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/management/seaport:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/management/seaport:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/graphical-login/cde-login is only limited to local connections"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/graphical-login/cde-login"
      property       : "dtlogin/args"
      svcprop_option : CAN_BE_NULL
      value          : "\\ -udpPort\\ 0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that network/rpc/cde-ttdbserver:tcp is only limited to local connections"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "network/rpc/cde-ttdbserver:tcp"
      regex       : "ticotsord"
      property    : "inetd/proto"
    </custom_item>

    <custom_item>
# See also : http://uw714doc.sco.com/en/man/html.7sock/ticlts.7sock.html
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that network/rpc/cde-calendar-manager is only limited to local connections"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "network/rpc/cde-calendar-manager"
      regex       : "(ticlts|datagram_v)"
      property    : "inetd/proto"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that application/print/rfc1179:default is only limited to local connections"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      info        : "To set this item you will need to utilize inetadm, otherwise it does not exist by default on a Solaris system. Example: \"inetadm -m svc:/application/print/rfc1179:default bind_addr=localhost\""
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "application/print/rfc1179:default"
      regex       : "localhost"
      property    : "inetd/bind_addr"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that /network/rpc/bind only allows local connections (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "/network/rpc/bind"
      property       : "config/local_only"
      svcprop_option : CAN_BE_NULL
      value          : "true"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that system/system-log only allows local connections (netservices limited)"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "/system/system-log"
      property    : "config/log_from_remote"
      value       : "false"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that /network/smtp:sendmail only allows local connections (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "/network/smtp:sendmail"
      property       : "config/local_only"
      svcprop_option : CAN_BE_NULL
      value          : "true"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that system/webconsole:console only allows local connections (netservices limited)"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "/system/webconsole:console"
      property    : "options/tcp_listen"
      value       : "false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that application/management/wbem only allows local connections (netservices limited)"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "/application/management/wbem"
      property    : "options/tcp_listen"
      value       : "false"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/x11/x11-server only allows local connections (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/x11/x11-server"
      property       : "options/tcp_listen"
      svcprop_option : CAN_BE_NULL
      value          : "false"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/x11/xfs:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/x11/xfs:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that application/print/ipp-listener:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "application/print/ipp-listener:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
#  http://www.sun.com/bigadmin/content/selfheal/smf-quickstart.jsp
#  As per the above link following can be interchangeably used
#  network/rpc/meta or network/rpc/meta:default
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/meta is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/meta:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/metamed:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/metamed:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/metamh:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/metamh:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/mdcomm:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/mdcomm:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/rstat:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/rstat:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/telnet:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/telnet:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/status:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/status:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/rpc/rusers:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/rpc/rusers:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/nlockmgr:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/nlockmgr:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/client:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/client:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/server:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/server:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/rquota:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/rquota:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/cbd:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/cbd:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/nfs/mapid:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/nfs/mapid:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/ftp:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/ftp:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/finger:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/finger:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/login:rlogin is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/login:rlogin"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "2.3 Establish a Secure Baseline - Make sure that network/shell:default is disabled (netservices limited)"
      info           : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution       : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/shell:default"
      regex          : "disabled"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.3 Establish a Secure Baseline - Make sure that network/ssh:default is enabled (netservices limited)"
      info        : "Starting with Solaris 10 11/06, Oracle has provided an option for new installations to install the system as 'Secure By Default (SBD).'

Use of this installation option provides a secure system base in which the only network service that is enabled for remote access is Secure Shell (ssh). Some services, such as sendmail(1M) and syslogd(1M), are enabled for local connections only.

Users who are upgrading to this release or who wish to establish a secure baseline may invoke the SBD settings by running the netservices(1M) command. SBD settings will not be reversed by applying patches."
      solution    : "To establish a hardened OS baseline as recommended by Oracle, run the netservices (1M) command as follows-
netservices limited

Note - At present, there is a known bug that prevents webconsole from refreshing after 'netservices limited' is run-
6555726 svc:/system/webconsole SMF service doesn't have a refresh method
Until a patch is available, this bug requires that an extra step be performed to restart the webconsole as follows-
svcadm restart svc:/system/webconsole:console"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "network/ssh:default"
      regex       : "online"
      property    : "restarter/state"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "2.4 Configure TCP Wrappers - Make sure that /etc/hosts.deny does exist."
      info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/hosts.deny"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "2.4 Configure TCP Wrappers - Make sure that /etc/hosts.allow does exist."
      info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/hosts.allow"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "2.4 Configure TCP Wrappers - Allow localhost."
      info        : "This check will need to be configured according to your organization's network block

TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7(5),LEVEL|1S,NIAv2|GS7b,NIAv2|NS25"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/hosts.allow"
      regex       : "^ *[^#]*ALL.*"
# Note: Variable @HOSTS_ALLOW_NETWORK@ replaced with "192\\.0\\.2\\.0\\\\/255\\.255\\.255\\.0" in field "expect".
      expect      : "ALL: localhost,192\\.0\\.2\\.0\\\\/255\\.255\\.255\\.0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "2.4 Configure TCP Wrappers - Deny access to this server from all networks"
      info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.13.1,800-171|3.13.6,800-53|SC-7(5),CN-L3|7.1.2.2(c),CSF|PR.PT-4,ITSG-33|SC-7(5),LEVEL|1S,NIAv2|GS7b,NIAv2|NS25"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/hosts.deny"
      regex       : "^ *[^#]*ALL.*"
      expect      : "ALL: ALL"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.4 Configure TCP Wrappers - enable tcp_wrappers for inetd"
      info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "inetd"
      property    : "defaults/tcp_wrappers"
      value       : "true"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "2.4 Configure TCP Wrappers - enable tcp_wrappers for rpc/bind. Note: This check is recommended by CIS, but not required."
      info        : "TCP Wrappers is a host-based access control system that allows administrators to control who has access to various network services based on the IP address of the remote end of the connection. TCP Wrappers also provide logging information via syslog about both successful and unsuccessful connections. Rather than enabling TCP Wrappers for all services with 'inetadm -M ...', the administrator has the option of enabling TCP Wrappers for individual services with 'inetadm -m 'svcname' tcp_wrappers=TRUE', where 'svcname' is the name of the specific service that uses TCP Wrappers."
      solution    : "Please refer to the remediation steps on page 36 of the CIS document."
      reference   : "800-171|3.13.1,800-53|SC-7(12),CIP|007-6-R1,CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "rpc/bind"
      property    : "config/enable_tcpwrappers"
      value       : "true"
    </custom_item>

#
## 3.Kernel Tuning
##
#

    <report type:"WARNING">
      description : "3.1.1 Modify Network Parameters"
      info        : "Network device drivers have parameters that can be set to provide stronger security settings, depending on environmental needs. This section describes modifications to network parameters for IP, ARP and TCP.

The settings described in this section meet most functional needs while providing additional security against common network attacks. However, it is important to understand the needs of your particular environment to determine if these settings are appropriate for you.

Note:

The items that are Solaris 10 defaults include:
ip_forward_directed_broadcasts
ip_forward_src_routed
ip6_forward_src_routed
ip_respond_to_timestamp
ip_respond_to_timestamp_broadcast
ip_respond_to_address_mask_broadcast
ip6_send_redirects
tcp_rev_src_routes

The items that are NOT Solaris 10 defaults include:
arp_cleanup_interval
ip_ire_arp_interval
ip_ignore_redirect
ip6_ignore_redirect
ip_respond_to_echo_broadcast
ip_strict_dst_mutihoming
ip6_strict_dst_multihoming
ip_send_redirects
tcp_conn_req_max_q0
tcp_conn_req_max_q
tcp_extra_priv_ports_add

Note that we are creating a new script that will be executed at boot time to reconfigure the network parameters described in this section. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. The cis_netconfig.sh script that follows is a compilation of all the network parameter settings in this section. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Oracle is moving away from legacy run control scripts in /etc/init.d in favor of using SMF services.

Rationale:
Modifying these network parameters as recommended protects against certain common network attacks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "cat > cis_netconfig.sh << END
#!/sbin/sh
ndd -set /dev/ip ip_forward_src_routed 0
ndd -set /dev/ip ip6_forward_src_routed 0
ndd -set /dev/tcp tcp_rev_src_routes 0
ndd -set /dev/ip ip_forward_directed_broadcasts 0
ndd -set /dev/tcp tcp_conn_req_max_q0 4096
ndd -set /dev/tcp tcp_conn_req_max_q 1024
ndd -set /dev/ip ip_respond_to_timestamp 0
ndd -set /dev/ip ip_respond_to_timestamp_broadcast 0
ndd -set /dev/ip ip_respond_to_address_mask_broadcast 0
ndd -set /dev/ip ip_respond_to_echo_multicast 0
ndd -set /dev/ip ip6_respond_to_echo_multicast 0
ndd -set /dev/ip ip_respond_to_echo_broadcast 0
ndd -set /dev/arp arp_cleanup_interval 60000
ndd -set /dev/ip ip_ire_arp_interval 60000
ndd -set /dev/ip ip_ignore_redirect 1
ndd -set /dev/ip ip6_ignore_redirect 1
ndd -set /dev/tcp tcp_extra_priv_ports_add 6112
ndd -set /dev/ip ip_strict_dst_multihoming 1
ndd -set /dev/ip ip6_strict_dst_multihoming 1
ndd -set /dev/ip ip_send_redirects 0
ndd -set /dev/ip ip6_send_redirects 0
END
chmod +x cis_netconfig.sh

Place the script in /lib/svc/method.

Appendix 11.9 contains a script to create an SMF service to run all the network commands described in the following sub-sections. If the SMF service is created as described in Appendix 11.9, execute the following command for it to take effect:
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date. A
description for each network parameter seeting is included in the following sections."
      reference   : "LEVEL|1NS"
    </report>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.2 Disable Source Packet Forwarding - Check ip_forward_src_routed value. Expected value: 0."
      info        : "The ip_forward_src_routed and ip6_forward_src_routed parameters control whether IPv4/IPv6 forwards packets with source IPv4/IPv6 routing options

Note - These settings will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml
When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_forward_src_routed 0
IPv6-
ndd -set /dev/ip ip6_forward_src_routed 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_forward_src_routed"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.2 Disable Source Packet Forwarding - Check ip6_forward_src_routed value. Expected value: 0."
      info        : "The ip_forward_src_routed and ip6_forward_src_routed parameters control whether IPv4/IPv6 forwards packets with source IPv4/IPv6 routing options

Note - These settings will NOT persist between reboots.
Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_forward_src_routed 0
IPv6-
ndd -set /dev/ip ip6_forward_src_routed 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip6_forward_src_routed"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.3 Disable Broadcast Packet Forwarding - Check ip_forward_directed_broadcasts value. Expected value: 0."
      info        : "The ip_forward_directed_broadcasts parameter controls whether or not Solaris forwards broadcast packets for a specific network if it is directly connected to the machine.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_forward_directed_broadcasts 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_forward_directed_broadcasts"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.4 Disable Response to ICMP Timestamp Requests - Check ip_respond_to_timestamp value. Expected value: 0."
      info        : "The ip_respond_to_timestamp parameter controls whether or not to respond to ICMP timestamp requests.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_respond_to_timestamp 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_respond_to_timestamp"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.5 Disable Response to ICMP Broadcast Timestamp Requests - Check ip_respond_to_timestamp_broadcast value. Expected value: 0."
      info        : "The ip_respond_to_timestamp_broadcast parameter controls whether or not to respond to ICMP broadcast timestamp requests.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_respond_to_timestamp_broadcast 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_respond_to_timestamp_broadcast"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.6 Disable Response to ICMP Netmask Requests - Check ip_respond_to_address_mask_broadcast value. Expected value: 0."
      info        : "The ip_respond_to_address_mask_broadcast parameter controls whether or not to respond to ICMP netmask requests, typically sent by diskless clients when booting.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_respond_to_address_mask_broadcast 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_respond_to_address_mask_broadcast"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.7 Disable ICMPv6 Redirect Messages - Check ip6_send_redirects value. Expected value: 1."
      info        : "The ip6_send_redirects parameter controls whether or not IPv6 sends out ICMPv6 redirect messages.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip6_send_redirects 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip6_send_redirects"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.8 Disable Response to Broadcast ICMPv4 Echo Request - Check ip_respond_to_echo_broadcast value. Expected value: 0."
      info        : "The ip_respond_to_echo_broadcast parameter controls whether or not IPv4 responds to a broadcast ICMPv4 echo request.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_respond_to_echo_broadcast 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_respond_to_echo_broadcast"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.9 Disable Response to Multicast Echo Request - Check ip_respond_to_echo_multicast value. Expected value: 0."
      info        : "The ip6_respond_to_echo_multicast and ip_respond_to_echo_multicast parameters control whether or not IPv6 or IPv4 responds to a multicast IPv6 or IPv4 echo request.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_respond_to_echo_multicast 0
IPv6-
ndd -set /dev/ip ip6_respond_to_echo_multicast 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_respond_to_echo_multicast"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.9 Disable Response to Multicast Echo Request - Check ip6_respond_to_echo_multicast value. Expected value: 0."
      info        : "The ip6_respond_to_echo_multicast and ip_respond_to_echo_multicast parameters control whether or not IPv6 or IPv4 responds to a multicast IPv6 or IPv4 echo request.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_respond_to_echo_multicast 0
IPv6-
ndd -set /dev/ip ip6_respond_to_echo_multicast 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip6_respond_to_echo_multicast"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.10 Set Interval for Scanning IRE_CACHE - Check ip_ire_arp_interval value. Expected value: 60000."
      info        : "The ip_ire_arp_interval parameter determines the intervals in which Solaris scans the IRE_CACHE (IP Resolved Entries) and deletes entries that are more than one scan old. This interval is used for solicited arp entries, not un-solicited which are handled by arp_cleanup_interval.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml
When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_ire_arp_interval 60000"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_ire_arp_interval"
      expect      : "60000"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.11 Ignore ICMP Redirect Messages - Check ip_ignore_redirect value. Expected value: 1."
      info        : "The ip_ignore_redirect and ip6_ignore_redirect parameters determine if redirect messages will be ignored. ICMP redirect messages cause a host to re-route packets and could be used in a DoS attack. The default value for this is 0. Setting this parameter to 1 causes redirect messages to be ignored.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_ignore_redirect 1
IPv6-
ndd -set /dev/ip ip6_ignore_redirect 1"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_ignore_redirect"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.11 Ignore ICMP Redirect Messages - Check ip6_ignore_redirect value. Expected value: 1."
      info        : "The ip_ignore_redirect and ip6_ignore_redirect parameters determine if redirect messages will be ignored. ICMP redirect messages cause a host to re-route packets and could be used in a DoS attack. The default value for this is 0. Setting this parameter to 1 causes redirect messages to be ignored.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_ignore_redirect 1
IPv6-
ndd -set /dev/ip ip6_ignore_redirect 1"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip6_ignore_redirect"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.12 Set Strict Multihoming - Check ip_strict_dst_multihoming value. Expected value: 1."
      info        : "The ip_strict_dst_multihoming and ip6_strict_dst_multihoming parameters determines whether a packet arriving on a non -forwarding interface can be accepted for an IP address that is not explicitly configured on that interface. If ip_forwarding is enabled, or xxx:ip_forwarding (where xxx is the interface name) for the appropriate interfaces is enabled, then this parameter is ignored because the packet is actually forwarded.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml
When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_strict_dst_multihoming 1
IPv6-
ndd -set /dev/ip ip6_strict_dst_multihoming 1"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_strict_dst_multihoming"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.12 Set Strict Multihoming - Check ip6_strict_dst_multihoming value. Expected value: 1."
      info        : "The ip_strict_dst_multihoming and ip6_strict_dst_multihoming parameters determines whether a packet arriving on a non -forwarding interface can be accepted for an IP address that is not explicitly configured on that interface. If ip_forwarding is enabled, or xxx:ip_forwarding (where xxx is the interface name) for the appropriate interfaces is enabled, then this parameter is ignored because the packet is actually forwarded.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
IPv4-
ndd -set /dev/ip ip_strict_dst_multihoming 1
IPv6-
ndd -set /dev/ip ip6_strict_dst_multihoming 1"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip6_strict_dst_multihoming"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.13 Disable ICMPv4 Redirect Messages - Check ip_send_redirects value. Expected value: 0."
      info        : "The ip_send_redirects parameter controls whether or not IPv4 sends out ICMPv4 redirect messages.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/ip ip_send_redirects 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/ip ip_send_redirects"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.14 Set ARP Cleanup Interval - Check arp_cleanup_interval value. Expected value: 60000."
      info        : "The arp_cleanup_interval parameter controls the length of time, in milliseconds, that an unsolicited Address Resolution Protocal (ARP) request remains in the ARP cache.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml
When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/arp arp_cleanup_interval 60000"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/arp arp_cleanup_interval"
      expect      : "60000"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.15 Disable TCP Reverse IP Source Routing - Check tcp_rev_src_routes value. Expected value: 0."
      info        : "The tcp_rev_src_routes parameter determines if TCP reverses the IP source routing option for incoming connections. If set to 0, TCP does not reverse IP source. If set to 1, TCP does the normal reverse source routing. The default setting is 0.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/tcp tcp_rev_src_routes 0"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/tcp tcp_rev_src_routes"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.16 Set Maximum Number of Half-open TCP Connections - Check tcp_conn_req_max_q0 value. Expected value: 4096."
      info        : "The tcp_conn_req_max_q0 parameter determines how many half-open TCP connections can exist for a port. This setting is closely related with tcp_conn_req_max_q.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/tcp tcp_conn_req_max_q0 4096"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/tcp tcp_conn_req_max_q0"
      expect      : "4096"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.17 Set Maximum Number of Incoming Connections - Check tcp_conn_req_max_q value. Expected value: 1024."
      info        : "The tcp_conn_req_max_q parameter determines the maximum number of incoming connections that can be accepted on a port. This setting is closely related with tcp_conn_req_max_q0.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml
When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/tcp tcp_conn_req_max_q 1024"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/tcp tcp_conn_req_max_q"
      expect      : "1024"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "3.1.18 Lock down dtspcd(8) - Check tcp_extra_priv_ports_add value. Expected value: 6112."
      info        : "The tcp_extra_priv_ports_add parameter adds a non-privileged port to the privileged port list.

Note - This setting will NOT persist between reboots.

Appendix B contains a script to create an SMF service to run the commands. If the SMF service is created as described in Appendix B, execute the following command for it to take effect-
cp cis_netconfig.sh /lib/svc/method
chmod 750 /lib/svc/method/cis_netconfig.sh
svccfg import cis_netconfig.xml

When the service is enabled or system is rebooted, the cis_netconfig.sh script will be executed and the appropriate network parameters will be updated. Store the file in /var/svc/manifest/site if it has to be re-imported into the system at a later date."
      solution    : "See the notes in Item 3.4 Modify Network Parameters regarding a master script that will be executed at boot time to reconfigure various network parameters. The file cis_netconfig.xml is an SMF manifest for the cis_netconfig service. Once imported into the SMF database, the cis_netconfig.sh script will run on every system reboot to set the network parameters appropriately. Shown below is the ndd command that controls this particular parameter, but it does not persist between system reboots, which is the reason for creating the master script. Edit the script for the particular needs of your organization and place the script in /lib/svc/method.
ndd -set /dev/tcp tcp_extra_priv_ports_add 6112"
      reference   : "800-171|3.13.1,800-53|SC-7,CSCv6|9.2,ITSG-33|SC-7,LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/ndd -get /dev/tcp tcp_extra_priv_ports"
      expect      : "6112"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_GLOB_PATTERN is set to /var/cores/core_%n_%f_%u_%g_%t_%p"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_GLOB_PATTERN\\s*=\\s*.*"
      expect      : "COREADM_GLOB_PATTERN\\s*=\\s*/var/cores/core_%n_%f_%u_%g_%t_%p"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_GLOB_CONTENT is set to default"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_GLOB_CONTENT\\s*=\\s*.*"
      expect      : "COREADM_GLOB_CONTENT\\s*=\\s*[Dd][Ee][Ff][Aa][Uu][Ll][Tt]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_INIT_PATTERN is set to core"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_INIT_PATTERN\\s*=\\s*.*"
      expect      : "COREADM_INIT_PATTERN\\s*=\\s*[Cc][Oo][Rr][Ee]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_INIT_CONTENT is set to default"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_INIT_CONTENT\\s*=\\s*.*"
      expect      : "COREADM_INIT_CONTENT\\s*=\\s*[Dd][Ee][Ff][Aa][Uu][Ll][Tt]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_GLOB_ENABLED is set to yes"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_GLOB_ENABLED\\s*=\\s*.*"
      expect      : "COREADM_GLOB_ENABLED\\s*=\\s*[Yy][Ee][Ss]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_PROC_ENABLED is set to no"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_PROC_ENABLED\\s*=\\s*.*"
      expect      : "COREADM_PROC_ENABLED\\s*=\\s*[Nn][Oo]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_GLOB_SETID_ENABLED is set to yes"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_GLOB_SETID_ENABLED\\s*=\\s*.*"
      expect      : "COREADM_GLOB_SETID_ENABLED\\s*=\\s*[Yy][Ee][Ss]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_PROC_SETID_ENABLED is set to no"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_PROC_SETID_ENABLED\\s*=\\s*.*"
      expect      : "COREADM_PROC_SETID_ENABLED\\s*=\\s*[Nn][Oo]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if COREADM_GLOB_LOG_ENABLED is set to yes"
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/coreadm.conf"
      regex       : "COREADM_GLOB_LOG_ENABLED\\s*=\\s*.*"
      expect      : "COREADM_GLOB_LOG_ENABLED\\s*=\\s*[Yy][Ee][Ss]"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "3.2 Restrict Core Dumps to Protected Directory - Check if permissions for /var/cores are OK."
      info        : "The action described in this section creates a protected directory to store core dumps and also causes the system to create a log entry whenever a regular process dumps core."
      solution    : "To restrict core files to a protected directory, run the following commands-
mkdir -p /var/cores
chown root:root /var/cores
chmod 700 /var/cores
coreadm -g /var/cores/core_%n_%f_%u_%g_%t_%p \ -e log -e global -e global-setid \ -d process -d proc-setid

If the local site chooses, dumping of core files can be completely disabled with the following command-
coreadm -d global -d global-setid -d process \ -d proc-setid"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/cores"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
# Check if NX bit is set, by running following command, dmesg | grep features.
# un 28 11:00:05 sec1 unix: [ID 126719 kern.info] features: 1176fdf<cpuid,cmp,sse3,nx,asysc,sse2,sse,pat,cx8,pae,mca,mmx,cmov,pge,mtrr,msr,tsc,lgpg>
# See also : http://blogs.sun.com/gbrunett/entry/solaris_non_executable_stack_overview
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.3 Enable Stack Protection - Makes sure 'noexec_user_stack' is set to 1 in /etc/system. Note: Only applicable if NX bit is set."
      info        : "Buffer overflow exploits have been the basis for many highly publicized compromises and defacements of large numbers of Internet connected systems. Many of the automated tools in use by system attackers exploit well-known buffer overflow problems in vendor-supplied and third-party software."
      solution    : "Please refer to the remediation steps on page 62 of the CIS document."
      reference   : "800-53|SI-16,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/system"
      regex       : "^ *[^#]*set\\s*noexec_user_stack\\s*=.*"
      expect      : "set\\s*noexec_user_stack\\s*=\\s*1"
    </custom_item>

    <custom_item>
# Check if NX bit is set, by running following command, dmesg | grep features.
# jun 28 11:00:05 sec1 unix: [ID 126719 kern.info] features: 1176fdf<cpuid,cmp,sse3,nx,asysc,sse2,sse,pat,cx8,pae,mca,mmx,cmov,pge,mtrr,msr,tsc,lgpg>
# See also : http://blogs.sun.com/gbrunett/entry/solaris_non_executable_stack_overview
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.3 Enable Stack Protection - Makes sure 'noexec_user_stack_log' is set to 1 in /etc/system. Note: Only applicable if NX bit is set."
      info        : "Buffer overflow exploits have been the basis for many highly publicized compromises and defacements of large numbers of Internet connected systems. Many of the automated tools in use by system attackers exploit well-known buffer overflow problems in vendor-supplied and third-party software."
      solution    : "Please refer to the remediation steps on page 62 of the CIS document."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/system"
      regex       : "^ *[^#]*set\\s*noexec_user_stack_log\\s*=.*"
      expect      : "set\\s*noexec_user_stack_log\\s*=\\s*1"
    </custom_item>

    <custom_item>
# Based upon RFC 1948 sequence number generation, unique-per-connection-ID.
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "3.4 Enable Strong TCP Sequence Number Generation - Enforce Strong TCP Sequence Number Generation setting (TCP_STRONG_ISS = 2)."
      info        : "The variable TCP_STRONG_ISS sets the mechanism for generating the order of TCP packets. If an attacker can predict the next sequence number, it is possible to inject fraudulent packets into the data stream to hijack the session. Solaris supports three sequence number methods-
0 = Old-fashioned sequential initial sequence number generation.
1 = Improved sequential generation, with random variance in increment.
2 = RFC 1948 sequence number generation, unique-per-connection-ID."
      solution    : "Run the following commands to set TCP_STRONG_ISS to use RFC 1948 sequence number generation-

cd /etc/default
awk '/TCP_STRONG_ISS=/ { $1 = 'TCP_STRONG_ISS=2' }; \ { print }' inetinit > inetinit.new
 mv inetinit.new inetinit
pkgchk -f -n -p /etc/default/inetinit
ndd -set /dev/tcp tcp_strong_iss 2"
      reference   : "800-171|3.13.1,800-53|SC-7(12),CSCv6|9.2,ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/inetinit"
      regex       : "^ *[^#]*TCP_STRONG_ISS\\s*=.*"
      expect      : "TCP_STRONG_ISS\\s*=\\s*2"
    </custom_item>

# For a more complete discussion of these parameters and their effect on the security of the system,
# see: http://blogs.sun.com/security/entry/reference_security_blueprints and http://www.sun.com/blueprints/0603/816-5240.pdf.

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "3.5 Disable Network Routing - Make sure that ipv4-forwarding is disabled"
      info           : "The network routing daemon, in.routed, manages network routing tables. If enabled, it periodically supplies copies of the system's routing tables to any directly connected hosts and networks and picks up routes supplied to it from other networks and hosts."
      solution       : "Run the following commands to disable routing. This action is unnecessary unless it was manually enabled by the administrator or the system was previously used as a network gateway.
routeadm -d ipv4-forwarding -d ipv6-forwarding
routeadm -d ipv4-routing -d ipv6-routing
routeadm -u"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "svc:/network/ipv4-forwarding:default"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
      value          : "disabled"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "3.5 Disable Network Routing - Make sure that ipv6-forwarding is disabled"
      info           : "The network routing daemon, in.routed, manages network routing tables. If enabled, it periodically supplies copies of the system's routing tables to any directly connected hosts and networks and picks up routes supplied to it from other networks and hosts."
      solution       : "Run the following commands to disable routing. This action is unnecessary unless it was manually enabled by the administrator or the system was previously used as a network gateway.
routeadm -d ipv4-forwarding -d ipv6-forwarding
routeadm -d ipv4-routing -d ipv6-routing
routeadm -u"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "svc:/network/ipv6-forwarding:default"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
      value          : "disabled"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "3.5 Disable Network Routing - Make sure that ipv4-routing is disabled"
      info           : "The network routing daemon, in.routed, manages network routing tables. If enabled, it periodically supplies copies of the system's routing tables to any directly connected hosts and networks and picks up routes supplied to it from other networks and hosts."
      solution       : "Run the following commands to disable routing. This action is unnecessary unless it was manually enabled by the administrator or the system was previously used as a network gateway.
routeadm -d ipv4-forwarding -d ipv6-forwarding
routeadm -d ipv4-routing -d ipv6-routing
routeadm -u"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/routing/route:default"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
      value          : "disabled"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "3.5 Disable Network Routing - Make sure that ipv6-routing is disabled"
      info           : "The network routing daemon, in.routed, manages network routing tables. If enabled, it periodically supplies copies of the system's routing tables to any directly connected hosts and networks and picks up routes supplied to it from other networks and hosts."
      solution       : "Run the following commands to disable routing. This action is unnecessary unless it was manually enabled by the administrator or the system was previously used as a network gateway.
routeadm -d ipv4-forwarding -d ipv6-forwarding
routeadm -d ipv4-routing -d ipv6-routing
routeadm -u"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/routing/ripng:default"
      property       : "restarter/state"
      svcprop_option : CAN_BE_NULL
      value          : "disabled"
    </custom_item>

#
## 4.Logging
##
#

    <custom_item>
# Using CMD_EXEC instead of SVC_PROP as svcprop returns incorrect results for tcp_trace on Solaris 10
# http://mail.opensolaris.org/pipermail/smf-discuss/2007-January/003292.html
      system      : "SunOS"
      type        : CMD_EXEC
      description : "4.1 Enable inetd Connection Logging - Make sure that tcp_trace is set to true"
      info        : "The inetd process starts Internet standard services and the 'tracing' feature can be used to log information about the source of any network connections seen by the daemon."
      solution    : "Run the following commands to enable inetd connection logging-
inetadm -M tcp_trace=true
svcadm refresh svc:/network/inetd"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/inetadm -p"
      regex       : "tcp_trace\\s*=.*"
      expect      : "tcp_trace\\s*=\\s*(TRUE|true)"
    </custom_item>

    <custom_item>
      system         : "SunOS"
      type           : SVC_PROP
      description    : "4.2 Enable FTP daemon Logging - Make sure that exec is set to /usr/sbin/in.ftpd -a -l -d"
      info           : "Information about FTP sessions will be logged via syslogd (1M), but the system must be configured to capture these messages."
      solution       : "Run the following command to enable FTP daemon logging-
inetadm -m svc:/network/ftp \ exec='/usr/sbin/in.ftpd -a -l -d'"
      reference      : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also       : "https://workbench.cisecurity.org/files/614"
      service        : "network/ftp:default"
      regex          : "/usr/sbin/in.ftpd.+-a.+ -l.+-d"
      property       : "inetd_start/exec"
      svcprop_option : CAN_BE_NULL
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "4.3 Enable Debug Level Daemon Logging/4.4 Capture syslog AUTH Messages - Check if svc:/system/system-log is online"
      info        : "If the FTP service is installed and enabled on the system, Item 4.2 Enable FTP daemon Logging enables the 'debugging' (-d) and connection logging (-l) flags to track FTP activity on the system. Similarly, the tracing (-t) option to inetd was enabled in Item 4.1 Enable inetd Connection Logging."
      solution    : "Please refer to the remediation steps on page 67 of the CIS document."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "system/system-log:default"
      property    : "restarter/state"
      value       : "online"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.3 Enable Debug Level Daemon Logging - Check if daemon.debug is set to /var/log/connlog"
      info        : "If the FTP service is installed and enabled on the system, Item 4.2 Enable FTP daemon Logging enables the 'debugging' (-d) and connection logging (-l) flags to track FTP activity on the system. Similarly, the tracing (-t) option to inetd was enabled in Item 4.1 Enable inetd Connection Logging."
      solution    : "Please refer to the remediation steps on page 67 of the CIS document."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/syslog.conf"
      regex       : "^ *[^#]*daemon\.debug.*"
      expect      : "daemon\.debug\\s*/var/log/connlog"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "4.3 Enable Debug Level Daemon Logging - Check if permissions for /var/log/connlog are OK."
      info        : "If the FTP service is installed and enabled on the system, Item 4.2 Enable FTP daemon Logging enables the 'debugging' (-d) and connection logging (-l) flags to track FTP activity on the system. Similarly, the tracing (-t) option to inetd was enabled in Item 4.1 Enable inetd Connection Logging."
      solution    : "Please refer to the remediation steps on page 67 of the CIS document."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/log/connlog"
      owner       : "root"
      mask        : "177"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.4 Capture syslog AUTH Messages - Check if auth.info is set to var/log/authlog"
      info        : "By default, Solaris systems do not capture logging information that is sent to the LOG_AUTH facility."
      solution    : "Please refer to the remediation steps on page 69 of the CIS document."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/syslog.conf"
      regex       : "^ *[^#]*auth\.info.*"
      expect      : "auth\.info\\s*/var/log/authlog"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "4.5 Enable Login Records - Check if permissions for /var/adm/loginlog are OK."
      info        : "If the file /var/adm/loginlog exists, it will capture failed login attempt messages with the login name, tty specification, and time. This file does not exist by default and must be manually created."
      solution    : "Perform the following to implement the recommended state-
touch /var/adm/loginlog
chown root:sys /var/adm/loginlog
chmod 600 /var/adm/loginlog
logadm -w loginlog -C 13 /var/adm/loginlog"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/adm/loginlog"
      owner       : "root"
      mask        : "177"
      group       : "sys"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.5 Enable Login Records - Check if loginlog in /etc/logadm.conf is appropiately set"
      info        : "If the file /var/adm/loginlog exists, it will capture failed login attempt messages with the login name, tty specification, and time. This file does not exist by default and must be manually created."
      solution    : "Perform the following to implement the recommended state-
touch /var/adm/loginlog
chown root:sys /var/adm/loginlog
chmod 600 /var/adm/loginlog
logadm -w loginlog -C 13 /var/adm/loginlog"
      reference   : "800-53|AU-11,CIP|007-6-R4,CSF|PR.PT-1,ITSG-33|AU-11,LEVEL|1S,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,PCI-DSSv3.1|10.7,PCI-DSSv3.2|10.7"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/logadm.conf"
      regex       : "^[^#]*loginlog[\\s]+-C[\\s]+13[\\s]+/var/adm/loginlog"
      expect      : "^[^#]*loginlog[\\s]+-C[\\s]+13[\\s]+/var/adm/loginlog"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/login
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.6 Capture All Failed Login Attempts - Check if SYSLOG_FAILED_LOGINS is set to 0 in /etc/default/login."
      info        : "The SYS_FAILED_LOGINS variable is used to determine how many failed login attempts occur before a failed login message is logged. Setting the value to 0 will cause a failed login message on every failed login attempt."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/SYSLOG_FAILED_LOGINS=/ \ { $1 = 'SYSLOG_FAILED_LOGINS=0' }; \ { print }' login >login.new
mv login.new login # pkgchk -f -n -p /etc/default/login"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/login"
      regex       : "^ *[^#]*SYSLOG_FAILED_LOGINS.*"
      expect      : "SYSLOG_FAILED_LOGINS\\s*=\\s*0"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/cron
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.7 Enable cron Logging - Check if CRONLOG is set to yes in /etc/default/cron."
      info        : "Setting the CRONLOG parameter to YES in the /etc/default/cron file causes information to be logged for every cron job that gets executed on the system. This setting is the default for Solaris."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/CRONLOG=/ { $1 = 'CRONLOG=YES' }; \ { print }' cron > cron.new
mv cron.new cron
pkgchk -f -n -p /etc/default/cron
chown root:root /var/cron/log
chmod go-rwx /var/cron/log"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/cron"
      regex       : "^ *[^#]*CRONLOG.*"
      expect      : "CRONLOG\\s*=\\s*(YES|yes|Yes)"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "4.7 Enable cron Logging - Check if permissions for /var/cron/log are OK."
      info        : "Setting the CRONLOG parameter to YES in the /etc/default/cron file causes information to be logged for every cron job that gets executed on the system. This setting is the default for Solaris."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/CRONLOG=/ { $1 = 'CRONLOG=YES' }; \ { print }' cron > cron.new
mv cron.new cron
pkgchk -f -n -p /etc/default/cron
chown root:root /var/cron/log
chmod go-rwx /var/cron/log"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/cron/log"
      owner       : "root"
      mask        : "077"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : SVC_PROP
      description : "4.8 Enable System Accounting - Check if svc:/system/sar is online"
      info        : "System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 20 minutes. The data may be accessed with the sar command, or by reviewing the nightly report files named /var/adm/sa/sar*.

Note - The sys id must be added to /etc/cron.allow to run the system accounting commands."
      solution    : "Perform the following to implement the recommended state-

svcadm enable -r svc:/system/sar
EDITOR=ed crontab -e sys << END_ENTRIES \$a 0,20,40 * * * * /usr/lib/sa/sa1 45 23 * * * /usr/lib/sa/sa2 -s 0:00 -e 23:59 -i 1200 -A . w q END_ENTRIES
chown sys:sys /var/adm/sa/*
chmod go-wx /var/adm/sa/*

Note - This data is only archived for one week before being automatically removed by the regular nightly cron job. Administrators may wish to archive the /var/adm/sa directory on a regular basis to preserve this data for longer periods.

The sys account must be permitted to use the cron(1M) facility for system accounting to function properly. See Item 6.9 Restrict at/cron to Authorized Users."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      service     : "system/sar:default"
      property    : "restarter/state"
      value       : "online"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "4.8 Enable System Accounting - Check for files in /var/adm/sa"
      info        : "System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 20 minutes. The data may be accessed with the sar command, or by reviewing the nightly report files named /var/adm/sa/sar*.

Note - The sys id must be added to /etc/cron.allow to run the system accounting commands."
      solution    : "Perform the following to implement the recommended state-
svcadm enable -r svc:/system/sar
EDITOR=ed crontab -e sys << END_ENTRIES \$a 0,20,40 * * * * /usr/lib/sa/sa1 45 23 * * * /usr/lib/sa/sa2 -s 0:00 -e 23:59 -i 1200 -A . w q END_ENTRIES
chown sys:sys /var/adm/sa/*
chmod go-wx /var/adm/sa/*

Note - This data is only archived for one week before being automatically removed by the regular nightly cron job. Administrators may wish to archive the /var/adm/sa directory on a regular basis to preserve this data for longer periods.

The sys account must be permitted to use the cron(1M) facility for system accounting to function properly. See Item 6.9 Restrict at/cron to Authorized Users."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/adm/sa/*"
    </custom_item>

    <custom_item>
# Look at the crontab regex pattern for user 'sys'
# System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 20 minutes
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.8 Enable System Accounting - Check if contents of /var/spool/cron/crontabs/sys (/usr/lib/sa/sa1)are OK."
      info        : "System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 20 minutes. The data may be accessed with the sar command, or by reviewing the nightly report files named /var/adm/sa/sar*.

Note - The sys id must be added to /etc/cron.allow to run the system accounting commands."
      solution    : "Perform the following to implement the recommended state-
svcadm enable -r svc:/system/sar
EDITOR=ed crontab -e sys << END_ENTRIES \$a 0,20,40 * * * * /usr/lib/sa/sa1 45 23 * * * /usr/lib/sa/sa2 -s 0:00 -e 23:59 -i 1200 -A . w q END_ENTRIES
chown sys:sys /var/adm/sa/*
chmod go-wx /var/adm/sa/*

Note - This data is only archived for one week before being automatically removed by the regular nightly cron job. Administrators may wish to archive the /var/adm/sa directory on a regular basis to preserve this data for longer periods.

The sys account must be permitted to use the cron(1M) facility for system accounting to function properly. See Item 6.9 Restrict at/cron to Authorized Users."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/var/spool/cron/crontabs/sys"
      regex       : "^ *[^#].*/usr/lib/sa/sa1"
      expect      : "0,20,40.*/usr/lib/sa/sa1"
    </custom_item>

    <custom_item>
# Look at the crontab regex pattern for user 'sys'
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.8 Enable System Accounting - Check if contents of /var/spool/cron/crontabs/sys (/usr/lib/sa/sa2) are OK."
      info        : "System accounting gathers baseline system data (CPU utilization, disk I/O, etc.) every 20 minutes. The data may be accessed with the sar command, or by reviewing the nightly report files named /var/adm/sa/sar*.

Note - The sys id must be added to /etc/cron.allow to run the system accounting commands."
      solution    : "Perform the following to implement the recommended state-
svcadm enable -r svc:/system/sar
EDITOR=ed crontab -e sys << END_ENTRIES \$a 0,20,40 * * * * /usr/lib/sa/sa1 45 23 * * * /usr/lib/sa/sa2 -s 0:00 -e 23:59 -i 1200 -A . w q END_ENTRIES
chown sys:sys /var/adm/sa/*
chmod go-wx /var/adm/sa/*

Note - This data is only archived for one week before being automatically removed by the regular nightly cron job. Administrators may wish to archive the /var/adm/sa directory on a regular basis to preserve this data for longer periods.

The sys account must be permitted to use the cron(1M) facility for system accounting to function properly. See Item 6.9 Restrict at/cron to Authorized Users."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      file        : "/var/spool/cron/crontabs/sys"
      regex       : "^ *[^#]*/usr/lib/sa/sa2"
      expect      : "45 23.*/usr/lib/sa/sa2 -s 0:00 -e 23:59 -i 1200 -A"
    </custom_item>

#
# Note that DoD installations have much more stringent auditing requirements than those
# listed here. DoD guidelines require "flags:lo,ad,cc,fw,-fc,-fd,-fr" to be
# set in the audit_control file. Note that "-fr" in particular can cause extremely
# large audit trails to be generated.

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "4.9 Enable Kernel Level Auditing - Check audit condition is set to auditing"
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/auditconfig -getcond"
      expect      : "^audit\\s*condition\\s*=\\s*auditing"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "4.9 Enable Kernel Level Auditing - Check audit policies is set to arge,argv,cnt"
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/auditconfig -getpolicy"
      expect      : "^audit\\s*policies\\s*=\\s*arge,argv,cnt"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.9 Enable Kernel Level Auditing, Check if 'flags:lo,ad,cc' is set in /etc/security/audit_control."
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/audit_control"
      regex       : "^ *[^#]*flags:lo,ad,cc"
      expect      : "flags:lo,ad,cc"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.9 Enable Kernel Level Auditing, Check if 'naflags:lo,ad,ex' is set in /etc/security/audit_control."
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/audit_control"
      regex       : "^ *[^#]*naflags:lo,ad,ex"
      expect      : "naflags:lo,ad,ex"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.9 Enable Kernel Level Auditing, Check if 'minfree:20' is set in /etc/security/audit_control."
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-53|AU-5(1),CN-L3|7.1.3.7(e),CSF|PR.PT-1,ITSG-33|AU-5(1),LEVEL|1S,NESA|T3.3.1,TBA-FIISB|37.3.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/audit_control"
      regex       : "^ *[^#]*minfree:20"
      expect      : "minfree:20"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "4.9 Enable Kernel Level Auditing, Check if 'root:lo,ad:no' is set in /etc/security/audit_user."
      info        : "Kernel-level auditing provides information on commands and system calls that are executed on the local system. The audit trail may be reviewed with the praudit command. Note that enabling kernel-level auditing on Solaris disables the automatic mounting of external devices via the Solaris volume manager daemon (vold)."
      solution    : "Please refer to the CIS document, page 74 for the remediation steps for this check"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/audit_user"
      regex       : "^ *[^#]*root:lo,ad:no"
      expect      : "root:lo,ad:no"
    </custom_item>

#
## 5.File/Directory Permissions/Access
##
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "5.1 Set daemon umask - Check if CMASK is set to 022 in /etc/default/init."
      info        : "The umask (1) utility overrides the file mode creation mask as specified by the CMASK value in the /etc/default/init file. The most permissive file permission is mode 666 (777 for executable files). The CMASK value subtracts from this value. For example, if CMASK is set to a value of 022, files created will have a default permission of 644 (755 for executables). See the umask (1) manual page for a more detailed description.

Note - There are some known bugs in the following daemons that are impacted by changing the CMASK parameter from its default setting: (Note: Current or future patches may have resolved these issues. Consult with your Oracle Support representative)
6299083 picld i initialise picld_door file with wrong permissions after JASS
4791006 ldap_cachemgr initialise i ldap_cache_door file with wrong permissions
6299080 nscd i initialise name_service_door file with wrong permissions after JASS
The ldap_cachemgr issue has been fixed but the others are still unresolved. While not directly related to this, there is another issue related to 077 umask settings-
2125481 in.lpd failed to print files when the umask is set 077"
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/^CMASK=/ { $1 = 'CMASK=022' } { print }' init >init.new
mv init.new init
pkgchk -f -n -p /etc/default/init"
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/init"
      regex       : "^ *[^#]*CMASK\\s*=.*"
      expect      : "CMASK\\s*=\\s*022"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/init
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "5.2 Restrict Set-UID on User Mounted Devices - Check if nosuid option is set in /etc/rmmount.conf."
      info        : "If the volume manager (vold) is enabled to permit users to mount external devices, the administrator can force these file systems to be mounted with the nosuid option to prevent users from bringing set-UID programs onto the system via CD-ROMs, floppy disks, USB drives or other removable media."
      solution    : "Perform the following to implement the recommended state-
if [ ! '`grep -v '^#' /etc/rmmount.conf |\ grep -- '-o nosuid'`' ]; then fs=`awk '($1 == 'ident') && ($2 != 'pcfs') \ { print $2 }' /etc/rmmount.conf` echo mount \* $fs -o nosuid >>/etc/rmmount.conf fi"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/rmmount.conf"
      regex       : "^ *[^#]*mount\\s*.*"
      expect      : "mount\\s*.*nosuid"
    </custom_item>

    <item>
      description : "5.3 Set Sticky Bit on World Writable Directories"
      info        : "When the so-called sticky bit (set with chmod +t) is set on a directory, then only the owner of a file may remove that file from the directory (as opposed to the usual behavior where anybody with write access to that directory may remove the file).

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "To set the sticky bit on a directory, run the following command-
 chmod +t [directory name]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "find_world_writeable_directories"
      severity    : MEDIUM
    </item>

#
## 6.System Access, Authentication, and Authorization
##
#
#
# This check has been modified from the CIS Benchmark as it may be a typo in the benchmark since the 'Host' option
# only exists in the ssh_config file and not in the sshd_config file.
# This issue has been reported to CIS as well.
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.1.1 Configure SSH - Check if Host * is set in /etc/ssh/ssh_config."
      info        : "SSH is a secure, encrypted replacement for common login services such as telnet, ftp, rlogin, rsh, and rcp."
      solution    : "Please refer to the CIS document, page 79 for the remediation steps for this check."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1NS,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ssh/ssh_config"
      regex       : "^ *[^#]*Host\\s*.*"
      expect      : "Host\\s*\\*"
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.2 Set SSH Protocol to 2 - Check if Protocol is set to 2 and not commented for client."
      info            : "SSH supports two different and incompatible protocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to security issues. SSH2 is more advanced and secure.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^Protocol/ { $2 = '2' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "CIP|007-6-R1,LEVEL|1S"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*Protocol[\\s]+"
      expect          : "^[\\s]*Protocol[\\s]+2[\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.1.3 Disable SSH X11 Forwarding - Check if X11Forwarding is set to no and not commented for the server."
      info        : "The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections."
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^ X11Forwarding / { $2 = 'no' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*X11Forwarding[\\s]+"
      expect      : "^[\\s]*X11Forwarding[\\s]+[Nn][Oo][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.1.4 Set SSH MaxAuth Tries to 3 - Check if MaxAuthTries is set to 3 or lower and not commented for the server."
      info        : "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. The default value is 6.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^ MaxAuthTries/ { $2 = '3' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference   : "800-171|3.1.8,800-53|AC-7,CSCv6|16.7,ITSG-33|AC-7,LEVEL|1S,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*MaxAuthTries[\\s]+"
      expect      : "^[\\s]*MaxAuthTries[\\s]+[0-3][\\s]*$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.1.5 Set SSH MaxAuthTriesLog to 0 - Check if MaxAuthTriesLog is set to 0 and not commented for the server."
      info        : "The MaxAuthTriesLog parameter specifies the maximum number of failed authorization attempts before a syslog error message is generated. The default value is 3.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^ MaxAuthTriesLog/ { $2 = '0' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*MaxAuthTriesLog[\\s]+"
      expect      : "^[\\s]*MaxAuthTriesLog[\\s]+0[\\s]*$"
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.6 Set SSH IgnoreRhosts to yes - Check if IgnoreRhosts is set to yes and not commented for the server."
      info            : "The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used in RhostsRSAAuthentication or HostbasedAuthentication.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^ IgnoreRhosts/ { $2 = 'yes' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,LEVEL|1S,NESA|T5.2.3,NESA|T5.6.1"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*IgnoreRhosts[\\s]+"
      expect          : "^[\\s]*IgnoreRhosts[\\s]+[Yy][Ee][Ss][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.7 Set SSH RhostsAuthentication to no - Check if RhostsAuthentication is set to no and not commented for the server."
      info            : "The RhostsAuthentication parameter specifies if authentication using rhosts or /etc/hosts.equiv is permitted. The default is no.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^RhostsAuthentication/ { $2 = 'no' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,LEVEL|1S,NESA|T5.2.3,NESA|T5.6.1"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*RhostsAuthentication[\\s]+"
      expect          : "^[\\s]*RhostsAuthentication[\\s]+[Nn][Oo][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.8 Set SSH RhostsRSAAuthentication to no - Check if RhostsRSAAuthentication is set to no and not commented for the server."
      info            : "The RhostsRSAAuthentication parameter specifies if rhosts or /etc/hosts.equiv authentication together with successful RSA host authentication is permitted. The default is no.

Note that this parameter only applies to SSH protocol version 1.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^ RhostsRSAAuthentication/ { $2 = 'no' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "800-171|3.13.11,800-53|AC-14,800-53|SC-13,CSF|PR.DS-5,ITSG-33|AC-14,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T5.6.1,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*RhostsRSAAuthentication[\\s]+"
      expect          : "^[\\s]*RhostsRSAAuthentication[\\s]+[Nn][Oo][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.9 Disable SSH root Login - Check if PermitRootLogin is set to no and not commented for the server."
      info            : "The PermitRootLogin parameter specifies if the root user can log in using ssh(1). The default is no.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^PermitRootLogin/ { $2 = 'no' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,LEVEL|1S,SWIFT-CSCv1|5.1"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*PermitRootLogin[\\s]+"
      expect          : "^[\\s]*PermitRootLogin[\\s]+[Nn][Oo][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "SunOS"
      type            : FILE_CONTENT_CHECK
      description     : "6.1.10 Set SSH PermitEmptyPasswords to no - Check if PermitEmptyPasswords is set to no and not commented for the server"
      info            : "The PermitEmptyPasswords parameter specifies if the server allows login to accounts with empty password strings.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution        : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^PermitEmptyPasswords/ { $2 = 'no' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference       : "800-171|3.5.2,800-53|IA-5,CSF|PR.AC-1,ITSG-33|IA-5,LEVEL|1S,NESA|T5.2.3"
      see_also        : "https://workbench.cisecurity.org/files/614"
      file            : "/etc/ssh/sshd_config"
      regex           : "^[\\s]*PermitEmptyPasswords[\\s]+"
      expect          : "^[\\s]*PermitEmptyPasswords[\\s]+[Nn][Oo][\\s]*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.1.11 Set SSH Banner - Check if Banner is not commented and set to /etc/issue for the server"
      info        : "The Banner parameter specifies a file whose contents must sent to the remote user before authentication is permitted. By default, no banner is displayed.

Note - If you will be editing all the SSH parameters, use the script in section 6.1 Configure SSH."
      solution    : "Edit the /etc/ssh/sshd_config file to set the parameter as follows-
awk '/^#Banner/ { $1 = 'Banner' } \ { print }' /etc/ssh/sshd_config > /etc/ssh/sshd_config.new
/usr/bin/mv /etc/ssh/sshd_config.new /etc/ssh/sshd_config
/usr/sbin/pkgchk -f -n -p /etc/ssh/sshd_config
/usr/sbin/svcadm restart svc:/network/ssh"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ssh/sshd_config"
      regex       : "^[\\s]*Banner"
      expect      : "^[\\s]*Banner[\\s]+/etc/issue[\\s]*$"
    </custom_item>

#
# pkgchk -f -n -p /etc/ssh/sshd_config
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.2 Disable login: Prompts on Serial Ports - Check if x is added to the flag field for ttyb"
      info        : "The pmadm command provides service administration for the lower level of the Service Access Facility hierarchy and can be used to disable the ability to login on a particular port."
      solution    : "Perform the following to implement the recommended state-
pmadm -d -p zsmon -s ttya
pmadm -d -p zsmon -s ttyb"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/saf/zsmon/_pmtab"
      regex       : "^ *[^#]*ttyb:u[x]*:root:.+"
      expect      : "ttyb:ux:root:.+"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.2 Disable login: Prompts on Serial Ports - Check if x is added to the flag field for ttya"
      info        : "The pmadm command provides service administration for the lower level of the Service Access Facility hierarchy and can be used to disable the ability to login on a particular port."
      solution    : "Perform the following to implement the recommended state-
pmadm -d -p zsmon -s ttya
pmadm -d -p zsmon -s ttyb"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/saf/zsmon/_pmtab"
      regex       : "^ *[^#]*ttya:u[x]*:root:.+"
      expect      : "ttya:ux:root:.+"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.3 Disable 'nobody' Access for RPC Encryption Key Storage Service - Check if 'ENABLE_NOBODY_KEYS' is set to NO."
      info        : "The keyserv process, if enabled, stores user keys that are utilized with Sun's Secure RPC mechanism."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/ENABLE_NOBODY_KEYS=/ \ { $1 = 'ENABLE_NOBODY_KEYS=NO' } { print }' keyserv >keyserv.new
mv keyserv.new keyserv
pkgchk -f -n -p /etc/default/keyserv"
      reference   : "800-171|3.13.10,800-171|3.4.2,800-53|CM-6,800-53|SC-12,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ISO/IEC-27001|A.10.1.2,ITSG-33|CM-6,ITSG-33|SC-12,LEVEL|1S,NESA|T3.2.1,NESA|T7.4.1,NESA|T7.4.2,NIAv2|CY2,NIAv2|CY8,NIAv2|CY9,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/keyserv"
      regex       : "^ *[^#]*ENABLE_NOBODY_KEYS.*"
      expect      : "ENABLE_NOBODY_KEYS\\s*=\\s*[Nn][Oo]"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/keyserv
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "6.4 Disable .rhosts Support in /etc/pam.conf"
      info        : "Used in conjunction with the BSD-style 'r-commands' (rlogin, rsh, rcp), .rhosts files implement a weak form of authentication based on the network address or host name of the remote computer (which can be spoofed by a potential attacker to exploit the local system)."
      solution    : "Perform the following to implement the recommended state-
cd /etc
sed -e 's/^.*pam_rhosts_auth/#&/' < /etc/pam.conf > pam.conf.new
mv pam.conf.new pam.conf
pkgchk -f -n -p /etc/pam.conf"
      reference   : "800-171|3.5.2,800-53|AC-14,800-53|IA-5,CSF|PR.AC-1,ITSG-33|AC-14,ITSG-33|IA-5,LEVEL|1S,NESA|T5.2.3,NESA|T5.6.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/pam.conf"
      regex       : "^ *[^#]*rhosts_auth.*"
      expect      : "pam_rhosts_auth"
    </custom_item>

#
# pkgchk -f -n -p /etc/pam.conf
#

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "6.5 Restrict FTP Use - Check if file /etc/ftpd/ftpusers exists."
          file        : "/etc/ftpd/ftpusers"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : GRAMMAR_CHECK
          description : "6.5 Restrict FTP Use - Audit the list of users in /etc/ftpd/ftpusers."
          info        : "If FTP is permitted to be used on the system, the file /etc/ftpd/ftpusers is used to specify a list of users who are not allowed to access the system via FTP."
          solution    : "Add the system accounts to the /etc/ftpd/ftpusers file as shown below -
cd /etc/ftpd
for user in adm bin daemon gdm listen lp noaccess \ nobody nobody4 nuucp postgres root smmsp svctag \ sys uucp webservd do echo $user >> ftpusers done
sort -u ftpusers > ftpusers.new
mv ftpusers.new ftpusers
pkgchk -f -n -p /etc/ftpd/ftpusers"
          reference   : "800-171|3.1.6,800-53|AC-6(2),CSF|PR.AC-4,ITSG-33|AC-6(2),LEVEL|1S,NESA|T5.1.1"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/etc/ftpd/ftpusers"
          regex       : "root"
          regex       : "daemon"
          regex       : "bin"
          regex       : "sys"
          regex       : "adm"
          regex       : "lp"
          regex       : "uucp"
          regex       : "nuucp"
          regex       : "smmsp"
          regex       : "listen"
          regex       : "gdm"
          regex       : "webservd"
          regex       : "nobody"
          regex       : "noaccess"
          regex       : "nobody4"
          regex       : "postgres"
          regex       : "svctag"
          regex       : "^[#]+"
        </custom_item>
      </then>
    </if>

#
# pkgchk -f -n -p /etc/ftpd/ftpusers
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.6 Set Delay between Failed Login Attempts to 4."
      info        : "The SLEEPTIME variable in the /etc/default/login file controls the number of seconds to wait before printing the 'login incorrect' message when a bad password is provided."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/SLEEPTIME=/ { $1 = 'SLEEPTIME=4' } { print }' login >login.new
mv login.new login
pkgchk -f -n -p /etc/default/login"
      reference   : "800-171|3.1.8,800-53|AC-7,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,LEVEL|1S,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/login"
      regex       : "^ *[^#]*SLEEPTIME.*"
      expect      : "SLEEPTIME\\s*=\\s*([4-9][0-9]*|[0-9][0-9]+)"
    </custom_item>

# pkgchk -f -n -p /etc/default/login

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : PKG_CHECK
          description : "CDE - Check if Package SUNWdtwm is installed"
          required    : YES
          pkg         : "SUNWdtwm"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "6.7 Set Default Screen Lock for CDE Users - Check if 'dtsession*saverTimeout' is set to 10."
          info          : "The default timeout for keyboard/mouse inactivity is 30 minutes before a password-protected screen saver is invoked by the CDE session manager."
          solution      : "Run the following commands to set the default inactivity timeout to a value appropriate for your environment.
for file in /usr/dt/config/*/sys.resources; do dir=`dirname $file | sed s/usr/etc/` mkdir -m 755 -p $dir echo 'dtsession*saverTimeout: 10' >>$dir/sys.resources echo 'dtsession*lockTimeout: 10' >>$dir/sys.resources chown root:sys $dir/sys.resources chmod 444 $dir/sys.resources done"
          reference     : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/dt/config/*/sys.resources"
          regex         : "^ *[^#]*dtsession\\*saverTimeout:.*"
          expect        : "dtsession\\*saverTimeout:\\s+10"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "6.7 Set Default Screen Lock for CDE Users - Check if 'dtsession*lockTimeout:' is set to 10."
          info          : "The default timeout for keyboard/mouse inactivity is 30 minutes before a password-protected screen saver is invoked by the CDE session manager."
          solution      : "Run the following commands to set the default inactivity timeout to a value appropriate for your environment.
for file in /usr/dt/config/*/sys.resources; do dir=`dirname $file | sed s/usr/etc/` mkdir -m 755 -p $dir echo 'dtsession*saverTimeout: 10' >>$dir/sys.resources echo 'dtsession*lockTimeout: 10' >>$dir/sys.resources chown root:sys $dir/sys.resources chmod 444 $dir/sys.resources done"
          reference     : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/dt/config/*/sys.resources"
          regex         : "^ *[^#]*dtsession\\*lockTimeout:.*"
          expect        : "dtsession\\*lockTimeout:\\s+10"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CHECK
          description   : "6.7 Set Default Screen Lock for CDE Users - Check if file permissions for files under /etc/dt/config/*/sys.resources are OK."
          info          : "The default timeout for keyboard/mouse inactivity is 30 minutes before a password-protected screen saver is invoked by the CDE session manager."
          solution      : "Run the following commands to set the default inactivity timeout to a value appropriate for your environment.
for file in /usr/dt/config/*/sys.resources; do dir=`dirname $file | sed s/usr/etc/` mkdir -m 755 -p $dir echo 'dtsession*saverTimeout: 10' >>$dir/sys.resources echo 'dtsession*lockTimeout: 10' >>$dir/sys.resources chown root:sys $dir/sys.resources chmod 444 $dir/sys.resources done"
          reference     : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/dt/config/*/sys.resources"
          owner         : "root"
          mask          : "333"
          file_required : NO
          group         : "sys"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "6.7 Set Default Screen Lock for CDE Users - CDE package was not found"
          info        : "The default timeout for keyboard/mouse inactivity is 30 minutes before a password-protected screen saver is invoked by the CDE session manager."
          solution    : "Run the following commands to set the default inactivity timeout to a value appropriate for your environment.
for file in /usr/dt/config/*/sys.resources; do dir=`dirname $file | sed s/usr/etc/` mkdir -m 755 -p $dir echo 'dtsession*saverTimeout: 10' >>$dir/sys.resources echo 'dtsession*lockTimeout: 10' >>$dir/sys.resources chown root:sys $dir/sys.resources chmod 444 $dir/sys.resources done"
          reference   : "LEVEL|1S"
          see_also    : "https://workbench.cisecurity.org/files/614"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : PKG_CHECK
          description : "GNOME - Check if Package SUNWgnome-display-mgr is installed"
          required    : YES
          pkg         : "SUNWgnome-display-mgrX"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "6.8 Set Default Screen Lock for GNOME Users - Check if timeout is set to 0:10:00 in /usr/openwin/lib/app-defaults/XScreenSaver."
          info          : "The default timeout is 30 minutes of keyboard and mouse inactivity before a password-protected screen saver is invoked by the Xscreensaver application used in the GNOME windowing environment.
Note - Presently, the file /usr/openwin/lib/app-defaults/XScreenSaver is not marked volatile, so the pkgchk command produces an error for this item. The following bug has been filed in relation to this-
6255740 XScreenSaver global property file should be marked as volatile"
          solution      : "Perform the following to implement the recommended state-
cd /usr/openwin/lib/app-defaults
awk '/^\*timeout:/ { $2 = '0:10:00' } /^\*lockTimeout:/ { $2 = '0:00:00' } /^\*lock:/ { $2 = 'True' } { print }' XScreenSaver >XScreenSaver.new
mv XScreenSaver.new XScreenSaver
pkgchk -f -n -p /usr/openwin/lib/app-defaults/XScreenSaver"
          reference     : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/openwin/lib/app-defaults/XScreenSaver"
          regex         : "^\\*timeout:\\s*.*"
          expect        : "^\\*timeout:\\s*0:10:00$"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "6.8 Set Default Screen Lock for GNOME Users - Check if lockTimeout is set to 0:00:00 in /usr/openwin/lib/app-defaults/XScreenSaver."
          info          : "The default timeout is 30 minutes of keyboard and mouse inactivity before a password-protected screen saver is invoked by the Xscreensaver application used in the GNOME windowing environment.

Note - Presently, the file /usr/openwin/lib/app-defaults/XScreenSaver is not marked volatile, so the pkgchk command produces an error for this item. The following bug has been filed in relation to this-
6255740 XScreenSaver global property file should be marked as volatile"
          solution      : "Perform the following to implement the recommended state-
cd /usr/openwin/lib/app-defaults
awk '/^\*timeout:/ { $2 = '0:10:00' } /^\*lockTimeout:/ { $2 = '0:00:00' } /^\*lock:/ { $2 = 'True' } { print }' XScreenSaver >XScreenSaver.new
mv XScreenSaver.new XScreenSaver
pkgchk -f -n -p /usr/openwin/lib/app-defaults/XScreenSaver"
          reference     : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/openwin/lib/app-defaults/XScreenSaver"
          regex         : "^\\*lockTimeout:\\s*.*"
          expect        : "^\\*lockTimeout:\\s*0:00:00"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "6.8 Set Default Screen Lock for GNOME Users - Check if lock is set to true in /usr/openwin/lib/app-defaults/XScreenSaver."
          info          : "The default timeout is 30 minutes of keyboard and mouse inactivity before a password-protected screen saver is invoked by the Xscreensaver application used in the GNOME windowing environment.

Note - Presently, the file /usr/openwin/lib/app-defaults/XScreenSaver is not marked volatile, so the pkgchk command produces an error for this item. The following bug has been filed in relation to this-
6255740 XScreenSaver global property file should be marked as volatile"
          solution      : "Perform the following to implement the recommended state-
cd /usr/openwin/lib/app-defaults
awk '/^\*timeout:/ { $2 = '0:10:00' } /^\*lockTimeout:/ { $2 = '0:00:00' } /^\*lock:/ { $2 = 'True' } { print }' XScreenSaver >XScreenSaver.new
mv XScreenSaver.new XScreenSaver
pkgchk -f -n -p /usr/openwin/lib/app-defaults/XScreenSaver"
          reference     : "800-171|3.1.10,800-53|AC-11,CN-L3|8.1.4.1(b),CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,LEVEL|1S,NIAv2|AM23c,NIAv2|AM23d"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/usr/openwin/lib/app-defaults/XScreenSaver"
          regex         : "^\\*lock:\\s*"
          expect        : "^\\*lock:\\s*([Tt][Rr][Uu][Ee])"
          file_required : NO
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "6.8 Set Default Screen Lock for GNOME Users - GNOME package was not found"
          info        : "The default timeout is 30 minutes of keyboard and mouse inactivity before a password-protected screen saver is invoked by the Xscreensaver application used in the GNOME windowing environment.

Note - Presently, the file /usr/openwin/lib/app-defaults/XScreenSaver is not marked volatile, so the pkgchk command produces an error for this item. The following bug has been filed in relation to this-
6255740 XScreenSaver global property file should be marked as volatile"
          solution    : "Perform the following to implement the recommended state-
cd /usr/openwin/lib/app-defaults
awk '/^\*timeout:/ { $2 = '0:10:00' } /^\*lockTimeout:/ { $2 = '0:00:00' } /^\*lock:/ { $2 = 'True' } { print }' XScreenSaver >XScreenSaver.new
mv XScreenSaver.new XScreenSaver
pkgchk -f -n -p /usr/openwin/lib/app-defaults/XScreenSaver"
          reference   : "LEVEL|1S"
          see_also    : "https://workbench.cisecurity.org/files/614"
        </report>
      </else>
    </if>

#
# pkgchk -f -n -p /usr/openwin/lib/app-defaults/XScreenSaver
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "6.9 Restrict at/cron To Authorized Users - should pass if /etc/cron.d/cron.deny does not exist."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,LEVEL|1S,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/cron.d/cron.deny"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "6.9 Restrict at/cron To Authorized Users - should pass if /etc/cron.d/at.deny does not exist."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-4,LEVEL|1S,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/cron.d/at.deny"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.9 Restrict at/cron To Authorized Users - should pass if 'root' exists in /etc/cron.d/cron.allow."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSF|PR.AC-4,LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/cron.d/cron.allow"
      regex       : "root"
      expect      : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "6.9 Restrict at/cron To Authorized Users - should pass if /etc/cron.d/at.allow does not contain any scheduled jobs."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.6,800-53|AC-6,CSF|PR.AC-4,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/bin/wc -l /etc/cron.d/at.allow | /usr/bin/awk '{ print $1 }'"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "6.9 Restrict at/cron To Authorized Users - should pass if /etc/cron.d/cron.allow permissions are OK."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSCv6|3.1,CSF|PR.AC-4,LEVEL|1S,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/cron.d/cron.allow"
      owner       : "root"
      mask        : "377"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "6.9 Restrict at/cron To Authorized Users - should pass if /etc/cron.d/at.allow permissions are OK."
      info        : "The cron.allow and at.allow files are a list of users who are allowed to run the crontab and at commands to submit jobs to be run at scheduled intervals."
      solution    : "Perform the following to implement the recommended state-
cd /etc/cron.d
mv cron.deny cron.deny.cis
mv at.deny at.deny.cis
echo root > cron.allow
cp /dev/null at.allow
chown root:root cron.allow at.allow
chmod 400 cron.allow at.allow"
      reference   : "800-171|3.1.7,800-53|AC-6(10),CSCv6|3.1,CSF|PR.AC-4,LEVEL|1S,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/cron.d/at.allow"
      owner       : "root"
      mask        : "377"
      group       : "root"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.10 Restrict root Login to System Console - Check if 'CONSOLE' in /etc/default/login is set to /dev/console."
      info        : "Privileged access to the system via the root account must be accountable to a particular user. The system console is supposed to be protected from unauthorized access and is the only location where it is considered acceptable to permit the root account to login directly, in the case of system emergencies. This is the default configuration for Solaris."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/CONSOLE=/ { print 'CONSOLE=/dev/console'; next }; \ { print }' login >login.new
mv login.new login
pkgchk -f -n -p /etc/default/login"
      reference   : "800-53|AC-6(3),CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),LEVEL|1S,NESA|T5.1.1,NESA|T5.5.4,SWIFT-CSCv1|5.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/login"
      regex       : "^ *[^#]*CONSOLE\\s*=.*"
      expect      : "CONSOLE\\s*=\\s*/dev/console"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/login
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.11 Set Retry Limit for Account Lockout - Check if 'RETRIES' in /etc/default/login is set to 3."
      info        : "The RETRIES parameter is the number of failed login attempts a user is allowed before being disconnected from the system and forced to reconnect. When LOCK_AFTER_RETRIES is set in /etc/security/policy.conf, then the user's account is locked after this many failed retries (the account can only be unlocked by the administrator using the command:passwd -u <username>"
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/RETRIES=/ { $1 = 'RETRIES=3' } { print }' login >login.new
mv login.new login
pkgchk -f -n -p /etc/default/login
cd /etc/security
awk '/LOCK_AFTER_RETRIES=/ \ { $1 = 'LOCK_AFTER_RETRIES=YES' } { print }' policy.conf >policy.conf.new
mv policy.conf.new policy.conf
pkgchk -f -n -p /etc/security/policy.conf

Be careful when enabling these settings as they can create a denial-of-service situation for legitimate users and applications. Account lockout can be disabled for specific users via the usermod command. For example, the following command disables account lock specifically for the oracle account-
usermod -K lock_after_retries=no oracle

By default the root account is exempt from account lockout."
      reference   : "800-171|3.1.8,800-53|AC-7,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,LEVEL|1S,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/login"
      regex       : "^ *[^#]*RETRIES\\s*=.*"
      expect      : "RETRIES\\s*=\\s*3"
    </custom_item>

#
# pkgchk -f -n -p /etc/default/login
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "6.11 Set Retry Limit for Account Lockout, Check if 'LOCK_AFTER_RETRIES' in /etc/default/login is set to YES"
      info        : "The RETRIES parameter is the number of failed login attempts a user is allowed before being disconnected from the system and forced to reconnect. When LOCK_AFTER_RETRIES is set in /etc/security/policy.conf, then the user's account is locked after this many failed retries (the account can only be unlocked by the administrator using the command:passwd -u <username>"
      solution    : "Perform the following to implement the recommended state-
cd /etc/default
awk '/RETRIES=/ { $1 = 'RETRIES=3' } { print }' login >login.new
mv login.new login
pkgchk -f -n -p /etc/default/login
cd /etc/security
awk '/LOCK_AFTER_RETRIES=/ \ { $1 = 'LOCK_AFTER_RETRIES=YES' } { print }' policy.conf >policy.conf.new
mv policy.conf.new policy.conf
pkgchk -f -n -p /etc/security/policy.conf

Be careful when enabling these settings as they can create a denial-of-service situation for legitimate users and applications. Account lockout can be disabled for specific users via the usermod command. For example, the following command disables account lock specifically for the oracle account-
usermod -K lock_after_retries=no oracle

By default the root account is exempt from account lockout."
      reference   : "800-171|3.1.8,800-53|AC-7,CN-L3|8.1.4.1(b),CSCv6|16.7,ITSG-33|AC-7,LEVEL|1S,NESA|T5.5.1,NIAv2|AM24,TBA-FIISB|36.2.4,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/policy.conf"
      regex       : "^ *[^#]*LOCK_AFTER_RETRIES\\s*=.*"
      expect      : "LOCK_AFTER_RETRIES\\s*=\\s*([Yy][Ee][Ss])"
    </custom_item>

#
# pkgchk -f -n -p /etc/security/policy.conf
#

    <if>
      <condition type:"OR">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "6.12 Set EEPROM Security Mode and Log Failed Access - Check if system is SPARC Note: This check is for SPARC only"
          cmd         : "/usr/bin/uname -a"
          regex       : "([Ss][Pp][Aa][Rr][Cc])"
          expect      : "([Ss][Pp][Aa][Rr][Cc])"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "6.12 Set EEPROM Security Mode and Log Failed Access - SPARC only. Should *not* be 'security-mode=none'."
          info        : "Oracle SPARC systems support the use of a EEPROM password for the console."
          solution    : "See page 97 of the CIS document for remediation instructions."
          reference   : "800-171|3.1.5,800-53|AC-6(1),CSF|PR.AC-4,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(1),LEVEL|1NS,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,SWIFT-CSCv1|5.1"
          see_also    : "https://workbench.cisecurity.org/files/614"
          cmd         : "eeprom security-mode"
          expect      : "^security-mode\\s*=\\s*(command|full)"
        </custom_item>
      </then>
    </if>

#
# NOTE: By default the UFS file system is referenced, if you are running ZFS please change '/boot/' to '/rpool/boot/'.

    <if>
      <condition type:"OR">
        <custom_item>
          system      : "SunOS"
          type        : CMD_EXEC
          description : "6.13 Secure the GRUB Menu - Check if system is x86/x86_64 Note: This check is for x86/x86_64 only"
          cmd         : "/usr/bin/uname -a"
          regex       : "i386"
          expect      : "i386"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "6.13 Secure the GRUB Menu - Check if 'password' is set in /boot/grub/menu.lst. Note: This check only checks if password is set"
          info        : "GRUB is a boot loader for x86/x64 based systems that permits loading an OS image from any location. Oracle x86 systems support the use of a GRUB Menu password for the console."
          solution    : "Perform the following to implement the recommended state-
/boot/grub/bin/grub grub> md5crypt Password- [enter desired boot loader password] Encrypted: [enter md5 password string] grub> [enter control-C (^C)]
The actual menu.lst file to be used varies depending upon whether ZFS or UFS is used as the root file system. If a ZFS filesystem is being used, then edit the file /rpool/boot/grub/menu.lst. Otherwise edit the file /boot/grub/menu.lst. Add the following line to the menu.lst file above the entries added by bootadm-
password -md5 [enter md5 password string generated above]
Next, add the keyword lock to the Solaris failsafe boot entry as in the following example: title Solaris failsafe lock
Last, ensure the menu.lst file can only be read by the root user:
(UFS)
chmod 600 /boot/grub/menu.lst (ZFS)
chmod 600 /rpool/boot/grub/menu.lst"
          reference   : "800-53|SI-7(9),CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSF|PR.DS-6,LEVEL|1NS"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/boot/grub/menu.lst"
          regex       : "^ *[^#]*password -md5.*"
          expect      : "password -md5 .+"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "6.13 Secure the GRUB Menu - Check if 'lock' command is set after failsafe section"
          info        : "Note: Please ensure 'lock' command is located after 'title Solaris failsafe' in file  /boot/grub/menu.lst. Nessus can only verify existence/non-existence of 'lock' command.

GRUB is a boot loader for x86/x64 based systems that permits loading an OS image from any location. Oracle x86 systems support the use of a GRUB Menu password for the console."
          solution    : "Perform the following to implement the recommended state-
/boot/grub/bin/grub grub> md5crypt Password- [enter desired boot loader password] Encrypted: [enter md5 password string] grub> [enter control-C (^C)]
The actual menu.lst file to be used varies depending upon whether ZFS or UFS is used as the root file system. If a ZFS filesystem is being used, then edit the file /rpool/boot/grub/menu.lst. Otherwise edit the file /boot/grub/menu.lst. Add the following line to the menu.lst file above the entries added by bootadm-
password -md5 [enter md5 password string generated above]
Next, add the keyword lock to the Solaris failsafe boot entry as in the following example: title Solaris failsafe lock
Last, ensure the menu.lst file can only be read by the root user:
(UFS)
chmod 600 /boot/grub/menu.lst (ZFS)
chmod 600 /rpool/boot/grub/menu.lst"
          reference   : "800-53|SI-7(9),CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSF|PR.DS-6,LEVEL|1NS"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/boot/grub/menu.lst"
          regex       : "^ *[^#]*lock"
          expect      : "lock$"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CHECK
          description : "6.13 Secure the GRUB Menu - should pass if /boot/grub/menu.lst permissions are OK."
          info        : "GRUB is a boot loader for x86/x64 based systems that permits loading an OS image from any location. Oracle x86 systems support the use of a GRUB Menu password for the console."
          solution    : "Perform the following to implement the recommended state-
/boot/grub/bin/grub grub> md5crypt Password- [enter desired boot loader password] Encrypted: [enter md5 password string] grub> [enter control-C (^C)]
The actual menu.lst file to be used varies depending upon whether ZFS or UFS is used as the root file system. If a ZFS filesystem is being used, then edit the file /rpool/boot/grub/menu.lst. Otherwise edit the file /boot/grub/menu.lst. Add the following line to the menu.lst file above the entries added by bootadm-
password -md5 [enter md5 password string generated above]
Next, add the keyword lock to the Solaris failsafe boot entry as in the following example: title Solaris failsafe lock
Last, ensure the menu.lst file can only be read by the root user:
(UFS)
chmod 600 /boot/grub/menu.lst (ZFS)
chmod 600 /rpool/boot/grub/menu.lst"
          reference   : "800-53|SI-7(9),CN-L3|8.1.2.3,CN-L3|8.1.4.6,CSCv6|3.1,CSF|PR.DS-6,LEVEL|1NS,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/boot/grub/menu.lst"
          mask        : "177"
        </custom_item>
      </then>
    </if>

#
## 7.User Accounts and Environments
##
#

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'daemon' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*daemon:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "daemon:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'bin' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*bin:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "bin:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'bin' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*bin:x:.*"
      expect      : "bin:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'nuucp' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*nuucp:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "nuucp:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'nuucp' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*nuucp:x:.*"
      expect      : "nuucp:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'smmsp' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*smmsp:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "smmsp:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'smmsp' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*smmsp:x:.*"
      expect      : "smmsp:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'gdm' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*gdm:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "gdm:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'gdm' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*gdm:x:.*"
      expect      : "gdm:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'listen' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*listen:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "listen:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'listen' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*listen:x:.*"
      expect      : "listen:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'webservd' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*webservd:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "webservd:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'webservd' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*webservd:x:.*"
      expect      : "webservd:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'nobody' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*nobody:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "nobody:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'nobody' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*nobody:x:.*"
      expect      : "nobody:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'noaccess' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*noaccess:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "noaccess:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'noaccess' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*noaccess:x:.*"
      expect      : "noaccess:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'nobody4' is locked."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*nobody4:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "nobody4:.*[LK].*[NP]*:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'nobody4' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*nobody4:x:.*"
      expect      : "nobody4:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'sys' disallows password login"
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*sys:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "sys:NP:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'adm' disallows password login"
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*adm:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "adm:NP:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'adm' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*adm:x:.*"
      expect      : "adm:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'lp' disallows password login."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*lp:.*:.*:.*:.*:.*:.*:.*:"
      expect      : "lp:NP:.*:.*:.*:.*:.*:.*:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'lp' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*lp:x:.*"
      expect      : "lp:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'uucp' disallows password login."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*uucp:.*"
      expect      : "uucp:NP:.*"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'uucp' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*uucp:x:.*"
      expect      : "uucp:x:.+:/usr/bin/false"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - Ensure account 'postgres' disallows password login."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[\\s\\t]*postgres:.*"
      expect      : "postgres:NP:.*"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.1 Disable System Accounts - should pass if the default shell for 'postgres' is set to /usr/bin/false."
      info        : "There are a number of accounts provided with the Solaris OS that are used to manage applications and are not intended to provide an interactive shell."
      solution    : "Accounts that have been locked are prohibited from running commands on the system. Such accounts are not able to login to the system nor are they able to use scheduled execution facilities such as cron. To lock an account, use the command-
passwd -l [username]"
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[\\s\\t]*postgres:x:.*"
      expect      : "postgres:x:.+:/usr/bin/false"
    </custom_item>

# Need one more audit_login_account for active accounts. Check for max passwd age, min passwd age, warn passwd age, passwd length.

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.2 Set Password Expiration Parameters on Active Accounts - Check MAXWEEKS is set to 13"
      info        : "Many organizations require users to change passwords on a regular basis.

Note - Since /etc/default/passwd sets defaults in terms of number of weeks (even though the actual values on user accounts are kept in terms of days), it is probably best to choose interval values that are multiples of 7.

Actions for this item do not work on accounts stored on network directories such as LDAP."
      solution    : "Please refer to the remediation steps on page 102 of the CIS document."
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MAXWEEKS\\s*=.*"
      expect      : "MAXWEEKS\\s*=\\s*13$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.2 Set Password Expiration Parameters on Active Accounts - Check MINWEEKS is set to 1"
      info        : "Many organizations require users to change passwords on a regular basis.

Note - Since /etc/default/passwd sets defaults in terms of number of weeks (even though the actual values on user accounts are kept in terms of days), it is probably best to choose interval values that are multiples of 7.

Actions for this item do not work on accounts stored on network directories such as LDAP."
      solution    : "Please refer to the remediation steps on page 102 of the CIS document."
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINWEEKS\\s*=.+"
      expect      : "MINWEEKS\\s*=\\s*1$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.2 Set Password Expiration Parameters on Active Accounts - Check WARNWEEKS is set to 4"
      info        : "Many organizations require users to change passwords on a regular basis.

Note - Since /etc/default/passwd sets defaults in terms of number of weeks (even though the actual values on user accounts are kept in terms of days), it is probably best to choose interval values that are multiples of 7.

Actions for this item do not work on accounts stored on network directories such as LDAP."
      solution    : "Please refer to the remediation steps on page 102 of the CIS document."
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*WARNWEEKS\\s*=.*"
      expect      : "WARNWEEKS\\s*=\\s*4$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check PASSLENGTH is set to 8"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*PASSLENGTH\\s*=.*"
      expect      : "PASSLENGTH\\s*=\\s*8$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check NAMECHECK is set to YES"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*NAMECHECK\\s*=.*"
      expect      : "NAMECHECK\\s*=\\s*(YES|Yes|yes)"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check HISTORY is set to 10"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.8,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*HISTORY\\s*=.*"
      expect      : "HISTORY\\s*=\\s*10$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check MINDIFF is set to 3"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM22d,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINDIFF\\s*=.*"
      expect      : "MINDIFF\\s*=\\s*3$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - MINALPHA is set to 2"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINALPHA\\s*=.*"
      expect      : "MINALPHA\\s*=\\s*2$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check MINUPPER is set to 1"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINUPPER\\s*=.*"
      expect      : "MINUPPER\\s*=\\s*1$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check MINLOWER is set to 1"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINLOWER\\s*=.*"
      expect      : "MINLOWER\\s*=\\s*1$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - MINNONALPHA is set to 1"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MINNONALPHA\\s*=.*"
      expect      : "MINNONALPHA\\s*=\\s*1$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check MAXREPEATS is set to 0"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*MAXREPEATS\\s*=.+"
      expect      : "MAXREPEATS\\s*=\\s*0$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - WHITESPACE is set to YES"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*WHITESPACE\\s*=.*"
      expect      : "WHITESPACE\\s*=\\s*([Yy][Ee][Ss])"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check DICTIONDBDIR is set to /var/passwd"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*DICTIONDBDIR\\s*=.*"
      expect      : "DICTIONDBDIR\\s*=\\s*/var/passwd"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.3 Set Strong Password Creation Policies - Check DICTIONLIST is set to /usr/share/lib/dict/words"
      info        : "Password policies are designed to force users to make better password choices when selecting their passwords."
      solution    : "Please refer to the remediation steps on page 104 of the CIS document."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/passwd"
      regex       : "^ *[^#]*DICTIONLIST\\s*=.*"
      expect      : "DICTIONLIST\\s*=\\s*/usr/share/lib/dict/words"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.4 Set Default Group for root Account"
      info        : "For Solaris 9 and earlier, the default group for the root account is the 'other' group, which may be shared by many other accounts on the system. Solaris 10 has adopted GID 0 (group 'root') as default group for the root account."
      solution    : "Perform the following to implement the recommended state-
passmgmt -m -g 0 root"
      reference   : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "root:x:0:.*"
      expect      : "root:x:0:0:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.5 Change Home Directory for root Account"
      info        : "By default, the Solaris OS root user's home directory is '/'.

Note - If the user logs into GNOME, the directories 'Desktop' and 'Documents' will also be created under /. Move these directories into /root, if they exist."
      solution    : "Perform the following to implement the recommended state-
mkdir -m 700 /root
mv -i /.?* /root/
passmgmt -m -h /root root"
      reference   : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "root:x:0:0:Super-User:.*:.*"
      expect      : "root:x:0:0:Super-User:/root:.*"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "7.5 Change Home Directory for root Account - Check /root permissions."
      info        : "By default, the Solaris OS root user's home directory is '/'.

Note - If the user logs into GNOME, the directories 'Desktop' and 'Documents' will also be created under /. Move these directories into /root, if they exist."
      solution    : "Perform the following to implement the recommended state-
mkdir -m 700 /root
mv -i /.?* /root/
passmgmt -m -h /root root"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/root"
      mask        : "077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.6 Set Default umask for Users, Check if 'UMASK' is set to 077."
      info        : "The default umask(1) determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod(1) command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files (.profile, .cshrc, etc.) in their home directories."
      solution    : "Please refer to the remediation steps on page 106 of the CIS document."
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/login"
      regex       : "^ *[^#]*UMASK\\s*=.*"
      expect      : "UMASK\\s*=\\s*077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.6 Set Default umask for Users - Check if 'umask' is set to 077 - Check /etc/profile."
      info        : "The default umask(1) determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod(1) command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files (.profile, .cshrc, etc.) in their home directories."
      solution    : "Please refer to the remediation steps on page 106 of the CIS document."
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/profile"
      regex       : "^ *[^#]*umask.*"
      expect      : "umask 077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.6 Set Default umask for Users - Check if 'umask' is set to 077 - Check /etc/.login."
      info        : "The default umask(1) determines the permissions of files created by users. The user creating the file has the discretion of making their files and directories readable by others via the chmod(1) command. Users who wish to allow their files and directories to be readable by others by default may choose a different default umask by inserting the umask command into the standard shell configuration files (.profile, .cshrc, etc.) in their home directories."
      solution    : "Please refer to the remediation steps on page 106 of the CIS document."
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/.login"
      regex       : "^ *[^#]*umask"
      expect      : "umask 077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.7 Set Default umask for FTP Users - Check if 'defumask' is set to 077."
      info        : "If FTP is permitted, set the umask value to apply to files created by the FTP server."
      solution    : "Please refer to the remediation steps on page 107 of the CIS document."
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ftpd/ftpaccess"
      regex       : "^ *[^#]*defumask.*"
      expect      : "defumask 077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.8 Set 'mesg n' as Default for All Users in /etc/profile"
      info        : "The 'mesg n' command blocks attempts to use the write or talk commands to contact users at their terminals, but has the side effect of slightly strengthening permissions on the user's tty device.

Note - Setting mesg n for all users may cause 'mesg- cannot change mode' to be displayed when using su - <user>."
      solution    : "Please refer to the remediation steps on page 108 of the CIS document."
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/profile"
      regex       : "^ *[^#]*mesg.*"
      expect      : "mesg n"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.8 Set 'mesg n' as Default for All Users in /etc/.login"
      info        : "The 'mesg n' command blocks attempts to use the write or talk commands to contact users at their terminals, but has the side effect of slightly strengthening permissions on the user's tty device.

Note - Setting mesg n for all users may cause 'mesg- cannot change mode' to be displayed when using su - <user>."
      solution    : "Please refer to the remediation steps on page 108 of the CIS document."
      reference   : "800-171|3.4.2,800-53|CM-6,CIP|007-6-R1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/.login"
      regex       : "^ *[^#]*mesg.*"
      expect      : "mesg n"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.9 Lock Inactive User Accounts - Check if definact is set to 35."
      info        : "Guidelines published by the U.S. Department of Defense specify that user accounts must be locked out after 35 days of inactivity. This number may vary based on the particular site's policy.

Note - To set the default for creating user accounts to expire after 35 days of inactivity, use the command-
useradd -D -f 35

This will create or modify the file /usr/sadm/defadduser with an entry definact=35 (or whatever you set it to for your site's policy)."
      solution    : "Please refer to the remediation steps on page 109 of the CIS document."
      reference   : "800-53|AC-2(3),CIP|004-6-R5,CN-L3|7.1.3.2(e),CN-L3|8.1.4.2(c),CSCv6|16.1,CSCv6|16.6,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ISO/IEC-27001|A.9.2.6,ITSG-33|AC-2(3),LEVEL|1S,NIAv2|AM26,PCI-DSSv3.1|8.1.4,PCI-DSSv3.2|8.1.4,TBA-FIISB|36.2.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/usr/sadm/defadduser"
      regex       : "definact\\s*=\\s*[0-9]+"
      expect      : "definact\\s*=\\s*35$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.10 Ensure Password Encryption Uses SHA algorithms 'CRYPT_DEFAULT'"
      info        : "Solaris supports several different algorithms for password storage, including unix crypt, SHA256 and SHA512. The CRYPT_DEFAULT determines the default encryption algorithm used, while CRYPT_ALGORITHMS_ALLOW determines algorithms allowed by the system for new passwords.

By default Solaris uses the old unix crypt algorithm for password storage. Unix crypt is easy to crack with readily available tools. Using a more advanced algorithm decreases the capability of cracking passwords on the system."
      solution    : "Edit the /etc/security/policy.conf file and set the CRYPT_DEFAULT setting as follows: CRYPT_DEFAULT=6"
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/policy.conf"
      regex       : "^CRYPT_DEFAULT\\s*=\\s*[0-9]+"
      expect      : "^CRYPT_DEFAULT\\s*=\\s*6$"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "7.10 Ensure Password Encryption Uses SHA algorithms 'CRYPT_ALGORITHMS_ALLOW'"
      info        : "Solaris supports several different algorithms for password storage, including unix crypt, SHA256 and SHA512. The CRYPT_DEFAULT determines the default encryption algorithm used, while CRYPT_ALGORITHMS_ALLOW determines algorithms allowed by the system for new passwords.

By default Solaris uses the old unix crypt algorithm for password storage. Unix crypt is easy to crack with readily available tools. Using a more advanced algorithm decreases the capability of cracking passwords on the system."
      solution    : "Edit the /etc/security/policy.conf file and set the CRYPT_ALGORITHMS_ALLOW setting as follows: CRYPT_ALGORITHMS_ALLOW=5,6"
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/security/policy.conf"
      regex       : "^CRYPT_ALGORITHMS_ALLOW\\s*=\\s*[0-9]+"
      expect      : "^CRYPT_ALGORITHMS_ALLOW\\s*=\\s*5,6$"
    </custom_item>

#
## 8.Warning Banners
##
#

    <custom_item>
      system      : "SunOS"
      type        : BANNER_CHECK
      description : "8.1 Create Warnings for Standard Login Services - Check if /etc/motd is set appropriately."
      info        : "The contents of the /etc/issue file are displayed prior to the login prompt on the system's console and serial devices, and also prior to logins via telnet. /etc/motd is generally displayed after all successful logins, no matter where the user is logging in from, but is thought to be less useful because it only provides notification to the user after the machine has been accessed."
      solution    : "Perform the following to implement the recommended state-
echo 'Authorized uses only. All activity may be \ monitored and reported.' > /etc/motd
echo 'Authorized uses only. All activity may be \ monitored and reported.' > /etc/issue
pkgchk -f -n -p /etc/motd
chown root:root /etc/issue
chmod 644 /etc/issue"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/motd"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : BANNER_CHECK
      description : "8.1 Create warnings for Standard Login Services - Check if /etc/issue is set appropriately."
      info        : "The contents of the /etc/issue file are displayed prior to the login prompt on the system's console and serial devices, and also prior to logins via telnet. /etc/motd is generally displayed after all successful logins, no matter where the user is logging in from, but is thought to be less useful because it only provides notification to the user after the machine has been accessed."
      solution    : "Perform the following to implement the recommended state-
echo 'Authorized uses only. All activity may be \ monitored and reported.' > /etc/motd
echo 'Authorized uses only. All activity may be \ monitored and reported.' > /etc/issue
pkgchk -f -n -p /etc/motd
chown root:root /etc/issue
chmod 644 /etc/issue"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/issue"
# Note: Variable @BANNER_TEXT@ replaced with "All activities performed on this system will be monitored." in field "content".
      content     : "All activities performed on this system will be monitored."
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : PKG_CHECK
          description : "CDE - Check if Package SUNWdtwm is installed"
          required    : YES
          pkg         : "SUNWdtwm"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "8.2 Create Warning Banner for CDE Users - Check if 'Dtlogin*greeting.labelString' is set appropriately."
          info          : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution      : "Please refer to the remediation steps on page 112 of the CIS document."
          reference     : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/etc/dt/config/*/Xresources"
          regex         : "^ *[^#!]*Dtlogin.*greeting\.labelString:.*"
          expect        : "Dtlogin.*greeting\.labelString: Authorized uses only"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK
          description   : "8.2 Create Warning Banner for CDE Users - Check if 'Dtlogin*greeting.persLabelString' is set appropriately."
          info          : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution      : "Please refer to the remediation steps on page 112 of the CIS document."
          reference     : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/etc/dt/config/*/Xresources"
          regex         : "^ *[^#!]*Dtlogin.*greeting\.persLabelString:.*"
          expect        : "Dtlogin.*greeting\.persLabelString: All activity may be monitored"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK_NOT
          description   : "8.2 Create Warning Banner for CDE Users - Check if 'Dtlogin*greeting.labelString' is not set to default string."
          info          : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution      : "Please refer to the remediation steps on page 112 of the CIS document."
          reference     : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/etc/dt/config/*/Xresources"
          regex         : "^[^#!]*Dtlogin.*greeting\.labelString:.*"
          expect        : "Dtlogin.*greeting\.labelString:.*Welcome.*"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CONTENT_CHECK_NOT
          description   : "8.2 Create Warning Banner for CDE Users - Check if 'Dtlogin*greeting.persLabelString' is not set to default string."
          info          : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution      : "Please refer to the remediation steps on page 112 of the CIS document."
          reference     : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/etc/dt/config/*/Xresources"
          regex         : "^ *[^#!]*Dtlogin.*greeting\.persLabelString:.*"
          expect        : "Dtlogin.*greeting\.persLabelString:.*Welcome.*"
          file_required : NO
        </custom_item>

        <custom_item>
          system        : "SunOS"
          type          : FILE_CHECK
          description   : "8.2 Create Warning Banner for CDE Users - Check if file permissions for files under /etc/dt/config/*/Xresources are OK."
          info          : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution      : "Please refer to the remediation steps on page 112 of the CIS document."
          reference     : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also      : "https://workbench.cisecurity.org/files/614"
          file          : "/etc/dt/config/*/Xresources"
          owner         : "root"
          mask          : "133"
          file_required : NO
          group         : "sys"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "8.2 Create Warning Banner for CDE Users - CDE package was not found"
          info        : "The Common Desktop Environment (CDE) provides a uniform desktop environment for users across diverse Unix platforms."
          solution    : "Please refer to the remediation steps on page 112 of the CIS document."
          reference   : "LEVEL|1S"
          see_also    : "https://workbench.cisecurity.org/files/614"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "SunOS"
          type        : PKG_CHECK
          description : "Gnome - Check if Package SUNWgnome-display-mgr is installed"
          required    : YES
          pkg         : "SUNWgnome-display-mgr"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "8.3 Create Warnings Banner for GNOME Users - Check if Greeter is set to /usr/bin/gdmlogin"
          info        : "The GNOME Display Manager is used for login session management. See the manual page gdm(1) for more information."
          solution    : "Perform the following to implement the recommended state-
cd /etc/X11/gdm
awk '/^#?Greeter=/ \ { print 'Greeter=/usr/bin/gdmlogin'; next } /^#?Welcome=/ \
{ print 'Welcome=Authorized uses only!\\n' \ 'All activity may be monitored ' \ 'and reported.' next } { print }' gdm.conf > gdm.conf.new
mv gdm.conf.new gdm.conf
pkgchk -f -n -p /etc/X11/gdm/gdm.conf"
          reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/etc/X11/gdm/gdm.conf"
          regex       : "^ *[^#]*Greeter.*"
          expect      : "Greeter\=/usr/bin/gdmlogin"
        </custom_item>

        <custom_item>
          system      : "SunOS"
          type        : FILE_CONTENT_CHECK
          description : "8.3 Create Warning Banner for GNOME Users - Check if banner is set correctly"
          info        : "The GNOME Display Manager is used for login session management. See the manual page gdm(1) for more information."
          solution    : "Perform the following to implement the recommended state-
cd /etc/X11/gdm
awk '/^#?Greeter=/ \ { print 'Greeter=/usr/bin/gdmlogin'; next } /^#?Welcome=/ \
{ print 'Welcome=Authorized uses only!\\n' \ 'All activity may be monitored ' \ 'and reported.' next } { print }' gdm.conf > gdm.conf.new
mv gdm.conf.new gdm.conf
pkgchk -f -n -p /etc/X11/gdm/gdm.conf"
          reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
          see_also    : "https://workbench.cisecurity.org/files/614"
          file        : "/etc/X11/gdm/gdm.conf"
          regex       : "^ *[^#]*Welcome.*"
          expect      : "Welcome\\=Authorized uses only\!.*"
        </custom_item>
      </then>

      <else>
        <report type:"PASSED">
          description : "8.3 Create Warning Banner for GNOME Users - CDE package was not found"
          info        : "The GNOME Display Manager is used for login session management. See the manual page gdm(1) for more information."
          solution    : "Perform the following to implement the recommended state-
cd /etc/X11/gdm
awk '/^#?Greeter=/ \ { print 'Greeter=/usr/bin/gdmlogin'; next } /^#?Welcome=/ \
{ print 'Welcome=Authorized uses only!\\n' \ 'All activity may be monitored ' \ 'and reported.' next } { print }' gdm.conf > gdm.conf.new
mv gdm.conf.new gdm.conf
pkgchk -f -n -p /etc/X11/gdm/gdm.conf"
          reference   : "LEVEL|1S"
          see_also    : "https://workbench.cisecurity.org/files/614"
        </report>
      </else>
    </if>

    <custom_item>
# Note		: This check is only applicable to Solaris system 2.6 or later.
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "8.4 Create warnings for FTP daemon - Check if /etc/ftpd/banner.msg is set appropriately. Applicable only for Solaris 2.6 or later"
      info        : "The action for this item sets a warning message for FTP users before they log in."
      solution    : "Perform the following to implement the recommended state-
echo Authorized uses only. All activity may \ be monitored and reported. > /etc/ftpd/banner.msg
chown root:root /etc/ftpd/banner.msg
chmod 444 /etc/ftpd/banner.msg"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ftpd/banner.msg"
      regex       : "^ *[^#]*Authorized uses only. All activity may be monitored and reported"
      expect      : "Authorized uses only. All activity may be monitored and reported"
    </custom_item>

    <custom_item>
# Note		: The contents of the /etc/ftpd/banner.msg file are sent to clients before they log in.
      system      : "SunOS"
      type        : FILE_CHECK
      description : "8.4 Create warnings for FTP daemon - Check if permissions for /etc/ftpd/banner.msg are OK. Applicable only for Solaris 2.6 or later"
      info        : "The action for this item sets a warning message for FTP users before they log in."
      solution    : "Perform the following to implement the recommended state-
echo Authorized uses only. All activity may \ be monitored and reported. > /etc/ftpd/banner.msg
chown root:root /etc/ftpd/banner.msg
chmod 444 /etc/ftpd/banner.msg"
      reference   : "800-171|3.1.9,800-53|AC-8,CSCv6|3.1,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/ftpd/banner.msg"
      owner       : "root"
      mask        : "333"
      group       : "root"
    </custom_item>

    <custom_item>
# This check should fail if the BANNER setting in telnetd is not null
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK
      description : "8.5 Check Banner Setting for telnet is Null"
      info        : "The BANNER variable in the file /etc/default/telnetd can be used to display text before the telnet login prompt. Traditionally, it has been used to display the OS level of the target system."
      solution    : "Perform the following to implement the recommended state-
cd /etc/default awk '/BANNER=/ { $1 = 'BANNER=' }; \ { print }' telnetd >telnetd.new
mv telnetd.new telnetd
pkgchk -f -n -p /etc/default/telnetd"
      reference   : "800-171|3.1.9,800-53|AC-8,ITSG-33|AC-8,LEVEL|1S,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,TBA-FIISB|45.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/default/telnetd"
      regex       : "^ *[^#]*BANNER\=.*"
      expect      : "^ *[^#]*BANNER\=([^A-Za-z0-9_-][^A-Za-z0-9_-]|)$"
    </custom_item>

#
# 9. System Maintenance
#

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "9.1 Check for Remote Consoles using 'consadm' command line utility"
      info        : "The consadm command can be used to select or display alternate console devices."
      solution    : "Perform the following to implement the recommended state-
/usr/sbin/consadm [-d device...]"
      reference   : "800-53|AC-6(3),CSF|PR.AC-4,ISO/IEC-27001|A.9.1.2,ISO/IEC-27001|A.9.4.4,ITSG-33|AC-6(3),LEVEL|1S,NESA|T5.1.1,NESA|T5.5.4,SWIFT-CSCv1|5.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/sbin/consadm -p"
      expect      : ""
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "9.2 Verify System File Permissions - /etc/shadow File Permissions."
      info        : "The pkgchk command checks the accuracy of installed files as well as the integrity of directory structures and files."
      solution    : "To force the default setting, use the -f option as follows-
pkgchk -f -n -p /etc/shadow"
      reference   : "800-53|IA-5(6),CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),LEVEL|1NS,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      owner       : "root"
      mask        : "377"
      group       : "sys"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "9.2 Verify System File Permissions - /etc/passwd File Permissions."
      info        : "The pkgchk command checks the accuracy of installed files as well as the integrity of directory structures and files."
      solution    : "To force the default setting, use the -f option as follows-
pkgchk -f -n -p /etc/shadow"
      reference   : "800-53|IA-5(6),CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5(6),LEVEL|1NS,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|5.4,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      owner       : "root"
      mask        : "133"
      group       : "sys"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "9.3 Ensure Password Fields are Not Empty - Verify no accounts are returned by 'logins -p'"
      info        : "An account with an empty password field means that anybody may log in as that user without providing a password at all (assuming that PASSREQ=NO in /etc/default/login)."
      solution    : "Use the passwd -l command to lock accounts that are not permitted to execute commands (shown by *LK* in the password field). Use the passwd -N command for accounts that do not use a password to login but must execute commands (shown by NP in the password field)."
      reference   : "800-171|3.5.7,800-53|IA-5(1),CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5(1),LEVEL|1S,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/bin/logins -p"
      expect      : ""
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.4 Verify No Legacy '+' Entries Exist in passwd, shadow, and group Files - Check for passwd"
      info        : "The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on Solaris systems, but may exist in files that have been imported from other platforms."
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.5.1,800-53|IA-2,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),CSF|PR.AC-1,ITSG-33|IA-2,LEVEL|1S,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM14b,NIAv2|AM2,NIAv2|AM8,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/passwd"
      regex       : "^[+]:"
      expect      : "^[+]:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.4 Verify No Legacy '+' Entries Exist in passwd, shadow, and group Files - Check for shadow."
      info        : "The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on Solaris systems, but may exist in files that have been imported from other platforms."
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/shadow"
      regex       : "^[+]:"
      expect      : "^[+]:"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CONTENT_CHECK_NOT
      description : "9.4 Verify No Legacy '+' Entries Exist in passwd, shadow, and group Files - Check for group"
      info        : "The character + in various files used to be markers for systems to insert data from NIS maps at a certain point in a system configuration file. These entries are no longer required on Solaris systems, but may exist in files that have been imported from other platforms."
      solution    : "Delete these entries if they exist."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "/etc/group"
      regex       : "^[+]:"
      expect      : "^[+]:"
    </custom_item>

    <item>
      description : "9.5 Verify that no UID 0 accounts exist other than root"
      info        : "Any account with UID 0 has superuser privileges on the system."
      solution    : "Delete any other entries that are displayed.

Finer granularity access control for administrative access can be obtained by using Oracle's Role-Based Access Control (RBAC) system.

RBAC configurations can be monitored via the /etc/user_attr file to make sure that privileges are managed appropriately."
      reference   : "800-171|3.1.5,800-53|AC-6(5),CN-L3|8.1.10.6(a),CSCv6|5.1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.3,ITSG-33|AC-6(5),LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.6.1,NIAv2|AM32,NIAv2|AM33,NIAv2|VL3a,SWIFT-CSCv1|1.2"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "passwd_zero_uid"
    </item>

    <item>
      description : "9.6 Ensure root PATH Integrity, No '.' In root's $PATH"
      info        : "The root user can execute any command on the system and could be fooled into executing programs unemotionally if the PATH is not set correctly."
      solution    : "Correct or justify any items discovered in the Audit step."
      reference   : "800-171|3.4.7,800-53|CM-7(2),CSCv6|8.4,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7(2),LEVEL|1S,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "dot_in_root_path_variable"
    </item>

    <item>
      description : "9.6 Ensure root PATH Integrity, No Group/World-Writable Directory In root's $PATH"
      info        : "The root user can execute any command on the system and could be fooled into executing programs unemotionally if the PATH is not set correctly."
      solution    : "Correct or justify any items discovered in the Audit step."
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1S,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "writeable_dirs_in_root_path_variable"
    </item>

    <item>
      description : "9.7 Check Permissions on User Home Directories - Should Be Mode 750 or More Restrictive"
      info        : "Please audit the results of this check and take action in accordance with corporate policy.

While the system administrator can establish secure permissions for users' home directories, the users can easily override these."
      solution    : "Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "accounts_bad_home_permissions"
      mask        : "027"
    </item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "9.8 Check User Dot File Permissions. Please audit the results of this check and take action in accordance with corporate policy."
      info        : "While the system administrator can establish secure permissions for users' 'dot' files, the users can easily override these."
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "~/.*"
      mask        : "0022"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK
      description : "9.9 Check Permissions on User .netrc Files. Please audit the results of this check and take action in accordance with corporate policy."
      info        : "While the system administrator can establish secure permissions for users' .netrc files, the users can easily override these."
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc file permissions and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "~/.netrc"
      mask        : "0077"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "9.10 Check for Presence of User .rhosts Files"
      info        : "While no .rhosts files are shipped with Solaris, users can easily create them."
      solution    : "It may be useful to run this audit check and, if any users have .rhosts files, determine why they have them."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "~/.rhosts"
    </custom_item>

    <item>
      description : "9.11 Check Groups in /etc/passwd"
      info        : "Over time, system administration errors and changes can lead to groups being defined in /etc/passwd but not in /etc/group."
      solution    : "Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found."
      reference   : "800-171|3.1.1,800-53|AC-2,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ISO/IEC-27001|A.9.2.1,ITSG-33|AC-2,LEVEL|1S,NESA|T5.2.1,NESA|T5.2.2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "passwd_invalid_gid"
    </item>

    <item>
      description : "9.12 Check That Users Are Assigned Home Directories"
      info        : "The /etc/passwd file defines a home directory that the user is placed in upon login. If there is no defined home directory, the user will be placed in '/' and will not be able to write any files or have local environment variables set."
      solution    : "Based on the results of the Audit script, perform the appropriate action for your environment (e.g. delete unneeded users or assign them a home directory)."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "accounts_without_home_dir"
    </item>

    <item>
      description : "9.13 Check That Defined Home Directories Exist"
      info        : "Users can be defined to have a home directory in /etc/passwd, even if the directory does not actually exist."
      solution    : "If any users' home directories do not exist, create them and make sure the respective user owns the directory."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,LEVEL|1S,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "passwd_duplicate_home"
    </item>

    <item>
      description : "9.14 Check User Home Directory Ownership"
      info        : "The user home directory is space defined for the particular user to set local environment variables and to store personal files."
      solution    : "Change the ownership any home directories that are not owned by the defined user to the correct user."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "accounts_bad_home_permissions"
    </item>

    <item>
      description : "9.15 Check for Duplicate UIDs"
      info        : "Although the useradd program will not let you create a duplicate User ID (UID), it is possible for an administrator to manually edit the /etc/passwd file and change the UID field."
      solution    : "Based on the results of the script, establish unique UIDs and review all files owned by the shared UID to determine which UID they are supposed to belong to."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,LEVEL|1S,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "passwd_duplicate_uid"
    </item>

    <item>
      description : "9.16 Check for Duplicate GIDs"
      info        : "Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field."
      solution    : "Based on the results of the script, establish unique GIDs and review all files owned by the shared GID to determine which group they are supposed to belong to."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,LEVEL|1S,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "group_duplicate_gid"
    </item>

    <custom_item>
      system        : "SunOS"
      type          : CMD_EXEC
      description   : "9.17 Check That Reserved UIDs Are Assigned to System Accounts"
      info          : "Traditionally, Unix systems establish \"reserved\" UIDs (0-99 range) that are intended for system accounts."
      solution      : "Based on the results of the script, change any UIDs that are in the reserved range to one that is in the user range. Review all files owned by the reserved UID to determine which UID they are supposed to belong to."
      reference     : "800-53|AC-16(3),CSF|PR.AC-4,ITSG-33|AC-16(3),LEVEL|1S"
      see_also      : "https://workbench.cisecurity.org/files/614"
      cmd           : "/usr/bin/getent passwd | /usr/bin/egrep -v '^(root|daemon|bin|sys|adm|lp|uucp|nuucp|smmsp|listen|gdm|webservd|postgres|svctag|nobody|noaccess|nobody4|unknown):' | /usr/bin/awk -F: '$3 < 100 {print $1\" \"$3;accts++ } END { if (accts < 1) print \"none\" }'"
      expect        : "none"
      dont_echo_cmd : YES
    </custom_item>

    <item>
      description : "9.18 Check for Duplicate User Names"
      info        : "Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name."
      solution    : "Based on the results of the script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,LEVEL|1S,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "passwd_duplicate_username"
    </item>

    <item>
      description : "9.19 Check for Duplicate Group Names"
      info        : "Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name."
      solution    : "Based on the results of the script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,CN-L3|7.1.2.7(b),CN-L3|8.1.4.1(a),CSF|PR.AC-1,ITSG-33|IA-4,LEVEL|1S,NESA|T5.5.2,NIAv2|AM14a,SWIFT-CSCv1|5"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "group_duplicate_name"
    </item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "9.20 Check for presence of user .netrc files - Checks for the presence of .netrc files in home directories."
      info        : "The .netrc file contains data for logging into a remote host for file transfers via FTP."
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc files and determine the action to be taken in accordance with site policy."
      reference   : "800-53|IA-5(7),CIP|007-6-R1,CSCv6|9.1,CSF|PR.AC-1,ITSG-33|IA-5(7),LEVEL|1S,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3,TBA-FIISB|26.1"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "~/.netrc"
    </custom_item>

    <custom_item>
      system      : "SunOS"
      type        : FILE_CHECK_NOT
      description : "9.21 Check for presence of user .forward files - Checks for the presence of .forward files in home directories."
      info        : "The .forward file specifies an email address to forward the user's mail to."
      solution    : "Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .forward files and determine the action to be taken in accordance with site policy."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      file        : "~/.forward"
    </custom_item>

    <item>
      description : "9.22 Find World Writable Files"
      info        : "Unix-based systems support variable settings to control access to files. World writable files are the least secure. See the chmod(2) man page for more information.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Removing write access for the 'other' category (chmod o-w <filename>) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file."
      reference   : "800-171|3.1.5,800-53|AC-6,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CN-L3|8.1.10.6(a),CN-L3|8.1.4.2(d),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,LEVEL|1NS,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1,TBA-FIISB|31.4.2,TBA-FIISB|31.4.3"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "find_world_writeable_files"
      basedir     : "/"
      severity    : MEDIUM
    </item>

    <item>
      description : "9.23 Find SUID/SGID System Executables"
      info        : "The owner of a file can set the file's permissions to run with the owner's or group's permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID/SGID program is to enable users to perform functions (such as changing their password) that require root privileges.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Ensure that no rogue set-UID programs have been introduced into the system. Digital signatures on Solaris set-UID binaries can be verified with the elfsign utility-
 elfsign verify -e /usr/bin/su"
      reference   : "800-53|AC-6(8),CSF|PR.AC-4,LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "find_suid_sgid_files"
      basedir     : "/"
      severity    : MEDIUM
    </item>

    <item>
      description : "9.24 Find Un-owned Files and Directories"
      info        : "Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system.

      NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate. Note that the Solaris OS distribution is shipped with all files appropriately owned."
      reference   : "800-53|AC-16(3),CSF|PR.AC-4,ITSG-33|AC-16(3),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      name        : "find_orphan_files"
      basedir     : "/"
      severity    : MEDIUM
    </item>

    <custom_item>
      system      : "SunOS"
      type        : CMD_EXEC
      description : "9.25 Find Files and Directories with Extended Attributes. Files will be displayed with an INFO tag if found"
      info        : "Extended attributes are implemented as files in a 'shadow' file system that is not generally visible via normal administration commands without special arguments.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Investigate any files found. Note that Solaris does not ship with files that have extended attributes."
      reference   : "800-171|3.1.1,800-53|AC-3(4),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(4),LEVEL|1S"
      see_also    : "https://workbench.cisecurity.org/files/614"
      cmd         : "/usr/bin/find / \\( -fstype nfs -o -fstype cachefs -o -fstype ctfs -o -fstype mntfs -o -fstype objfs -o -fstype proc \\) -prune -o -xattr -print 2>&1"
      expect      : ""
      severity    : MEDIUM
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Solaris_10_L1_v5.2.0.audit Level 1"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</check_type>
