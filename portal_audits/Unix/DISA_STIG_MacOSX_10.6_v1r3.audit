#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.30 $
# $Date: 2020/07/28 $
#
# Description : This .audit file is based on DISA STIG guidelines for Mac OS X 10.6 Version 1, Release 3
#
# 			The benchmark can be downloaded from:
#
# 			http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip
#
# NOTE			: Some queries in this .audit require site-specific data to be known to the query in order to function properly.  Please note the following
# 			queries and edit their values accordingly.
#
# 			GEN001220 M6 - All system files, programs, and directories must be owned by a system account
# 			GEN001240 M6 - System files, programs, and directories must be group-owned by a system group
# 			GEN001375 M6 - For systems using DNS resolution, at least two name servers must be configured
# 			OSX00155 M6 - Remote logging must be enabled
# 			OSX00195 M6 - The Software Update Server URL must be assigned to an organizational value
#
#<ui_metadata>
#<display_name>DISA STIG Apple Mac OSX 10.6 v1r3</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Apple Mac OSX 10.6</name>
#  <version>1.3.0</version>
#  <link>http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip</link>
#</spec>
#<labels>unix,disa,macosx,macosx_10,macosx_10.6,agent</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#  </variable>
#  <variable>
#    <name>SYSTEM_ACCOUNT</name>
#    <default>_sshd</default>
#    <description>System files owning account</description>
#    <info>System files should be owned by root or a system account</info>
#  </variable>
#  <variable>
#    <name>SYSTEM_GROUP</name>
#    <default>_sshd</default>
#    <description>System files owning group</description>
#    <info>Restricting permissions will protect the files from unauthorized modification</info>
#  </variable>
#  <variable>
#    <name>NAME_SERVER_1</name>
#    <default>192\\.168\\.1\\.1</default>
#    <description>Primary DNS Server</description>
#    <info>This is the IP address of the primary DNS server for your organization</info>
#  </variable>
#  <variable>
#    <name>NAME_SERVER_2</name>
#    <default>192\\.168\\.1\\.2</default>
#    <description>Secondary DNS Server</description>
#    <info>This is the IP address of the secondary DNS server for your organization</info>
#  </variable>
#  <variable>
#    <name>LOG_SERVER</name>
#    <default>example\\.log\\.server</default>
#    <description>Logging Server</description>
#    <info>This is the IP address or hostname assigned to your organization's central logging server</info>
#  </variable>
#  <variable>
#    <name>SOFTWARE_UPDATE_URL</name>
#    <default>http://su.example.com:8088/index.sucatalog</default>
#    <description>Software Update URL</description>
#    <info>This is the URL which should be used by the system for it's update information</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>time\\.nist\\.gov</default>
#    <description>NTP Server</description>
#    <info>This is the IP address or hostname of your organization's trusted time server</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "Check if OS X 10.6 is installed"
      cmd         : "/usr/bin/defaults read /System/Library/CoreServices/SystemVersion ProductVersion"
      expect      : "^10\\.6\\.[0-9]*"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_MacOSX_10.6_v1r3.audit"
    </report>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "GEN000800 M6 - The system must prohibit the reuse of passwords to 15 iterations"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep usingHistory"
          expect      : "^[^u][^s][^i][^n][^g][^H][^i][^s][^t][^o][^r][^y]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "GEN000800 M6 - The system must prohibit the reuse of passwords to 15 iterations - 'Managed usingHistory = 15'"
          info        : "If a user, or root, used the same password continuously or was allowed to change it back shortly after being forced to change it to something else, it would provide a potential intruder with the opportunity to keep guessing at the user's password until it was guessed correctly."
          solution    : "Open a terminal session and use the following command to set the value for usingHistory.

sudo pwpolicy -n -setglobalpolicy 'usingHistory=15'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'usingHistory=15'"
          reference   : "800-171|3.5.8,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CCI|CCI-000200,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,Rule-ID|SV-38632r1_rule,SANS-CSC|10,SANS-CSC|16,STIG-ID|GEN000800-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-4084"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep usingHistory"
          expect      : "^usingHistory\\s*=\\s*(1[0-5]|[1-9"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "GEN000800 M6 - The system must prohibit the reuse of passwords to 15 iterations - 'Local usingHistory = 15'"
          info        : "If a user, or root, used the same password continuously or was allowed to change it back shortly after being forced to change it to something else, it would provide a potential intruder with the opportunity to keep guessing at the user's password until it was guessed correctly."
          solution    : "Open a terminal session and use the following command to set the value for usingHistory.

sudo pwpolicy -n -setglobalpolicy 'usingHistory=15'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'usingHistory=15'"
          reference   : "800-171|3.5.8,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CCI|CCI-000200,CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM22c,PCI-DSSv3.1|8.2.5,PCI-DSSv3.2|8.2.5,Rule-ID|SV-38632r1_rule,SANS-CSC|10,SANS-CSC|16,STIG-ID|GEN000800-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.3,Vuln-ID|V-4084"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep usingHistory"
          expect      : "^usingHistory\\s*=\\s*15"
        </custom_item>
      </else>
    </if>

    <item>
      system      : "Darwin"
      description : "GEN000880 M6 - The root account must be the only account having a UID of '0' - 'other users'"
      info        : "If an account has a UID of '0', it has root authority. Multiple accounts with a UID of '0' afford more opportunity for potential intruders to guess a password for a privileged account."
      solution    : "Edit the /etc/passwd file and change the UID of the duplicate to an unused UID."
      reference   : "800-171|3.5.5,800-171|3.5.6,800-53|IA-4,8500.2|ECLP-1,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CCI|CCI-000366,CN-L3|7.1.2.7(b),CSF|PR.AC-1,ITSG-33|IA-4,NESA|T5.5.2,NIAv2|AM14a,Rule-ID|SV-37848r1_rule,SANS-CSC|11,STIG-ID|GEN000880-M6,SWIFT-CSCv1|5,Vuln-ID|V-773"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "passwd_duplicate_uid"
    </item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK
      description     : "GEN001140 M6 - System files and directories must not have uneven access permissions - '/etc'"
      info            : "Discretionary access control is undermined if users, other than a file owner, have greater access permissions to system files and directories than the owner."
      solution        : "Use the 'chmod' command to set the mode of files with uneven permissions so the owners do not have less permission than group or world users."
      reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37853r1_rule,SANS-CSC|15,STIG-ID|GEN001140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-784"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/etc"
      check_uneveness : YES
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK
      description     : "GEN001140 M6 - System files and directories must not have uneven access permissions - '/bin'"
      info            : "Discretionary access control is undermined if users, other than a file owner, have greater access permissions to system files and directories than the owner."
      solution        : "Use the 'chmod' command to set the mode of files with uneven permissions so the owners do not have less permission than group or world users."
      reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37853r1_rule,SANS-CSC|15,STIG-ID|GEN001140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-784"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/bin"
      check_uneveness : YES
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK
      description     : "GEN001140 M6 - System files and directories must not have uneven access permissions - '/usr/bin'"
      info            : "Discretionary access control is undermined if users, other than a file owner, have greater access permissions to system files and directories than the owner."
      solution        : "Use the 'chmod' command to set the mode of files with uneven permissions so the owners do not have less permission than group or world users."
      reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37853r1_rule,SANS-CSC|15,STIG-ID|GEN001140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-784"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/usr/bin"
      check_uneveness : YES
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK
      description     : "GEN001140 M6 - System files and directories must not have uneven access permissions - '/sbin'"
      info            : "Discretionary access control is undermined if users, other than a file owner, have greater access permissions to system files and directories than the owner."
      solution        : "Use the 'chmod' command to set the mode of files with uneven permissions so the owners do not have less permission than group or world users."
      reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37853r1_rule,SANS-CSC|15,STIG-ID|GEN001140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-784"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/sbin"
      check_uneveness : YES
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK
      description     : "GEN001140 M6 - System files and directories must not have uneven access permissions - '/usr/sbin'"
      info            : "Discretionary access control is undermined if users, other than a file owner, have greater access permissions to system files and directories than the owner."
      solution        : "Use the 'chmod' command to set the mode of files with uneven permissions so the owners do not have less permission than group or world users."
      reference       : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37853r1_rule,SANS-CSC|15,STIG-ID|GEN001140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-784"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/usr/sbin"
      check_uneveness : YES
    </custom_item>

    <item>
      system      : "Darwin"
      description : "GEN001160 M6 - All files and directories must have a valid owner"
      info        : "Non-ownership files and directories may be unintentionally inherited if a user is assigned the same UID as the UID of the non-ownership files."
      solution    : "Determine the legitimate owner of the files and use the 'chown' command to set the owner and group to the correct value. If the legitimate owner cannot be determined, examine the files to determine their origin and the reason for their lack of an owner/group."
      reference   : "800-53|AC-16,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ITSG-33|AC-16,Rule-ID|SV-38181r1_rule,SANS-CSC|11,STIG-ID|GEN001160-M6,Vuln-ID|V-785"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "find_orphan_files"
      find_option : "nouser"
    </item>

    <item>
      system      : "Darwin"
      description : "GEN001170 M6 - All files and directories must have a valid group owner"
      info        : "Files without a valid group owner may be unintentionally inherited if a group is assigned the same GID as the GID of the files without a valid group owner."
      solution    : "Use the following command to change the group owner for each file without a valid group owner.

chgrp <a-valid-group> <path>/<file-without-a-valid-group-owner>"
      reference   : "800-53|AC-16,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.AC-4,ITSG-33|AC-16,Rule-ID|SV-38187r1_rule,SANS-CSC|11,STIG-ID|GEN001170-M6,Vuln-ID|V-22312"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "find_orphan_files"
      find_option : "nogroup"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001180 M6 - All network services daemon files must have mode 0755 or less permissive - '/usr/sbin/*'"
      info        : "Restricting permission on daemons will protect them from unauthorized modification and possible system compromise."
      solution    : "Open a terminal session and use the following command to change the mode of the network services daemon.

chmod 755 <path of network services daemon file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-37882r1_rule,SANS-CSC|15,STIG-ID|GEN001180-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-786"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/*"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001190 M6 - All network services daemon files must not have extended ACLs - '/usr/sbin/*'"
      info        : "Restricting permission on daemons will protect them from unauthorized modification and possible system compromise."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /usr/sbin/ <file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,PCI-DSS|2.2.3,Rule-ID|SV-38070r1_rule,SANS-CSC|15,STIG-ID|GEN001190-M6,Vuln-ID|V-22313"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/sbin | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001200 M6 - All system command files must have mode 0755 or less permissive - '/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to change the mode for system command files to remove group and world write permissions.

chmod go-w <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37987r2_rule,STIG-ID|GEN001200-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-794"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/bin/*"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001200 M6 - All system command files must have mode 0755 or less permissive - '/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to change the mode for system command files to remove group and world write permissions.
chmod go-w <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37987r2_rule,STIG-ID|GEN001200-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-794"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/sbin/*"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001200 M6 - All system command files must have mode 0755 or less permissive - '/usr/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to change the mode for system command files to remove group and world write permissions.
chmod go-w <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37987r2_rule,STIG-ID|GEN001200-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-794"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/*"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001200 M6 - All system command files must have mode 0755 or less permissive - '/usr/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to change the mode for system command files to remove group and world write permissions.
chmod go-w <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37987r2_rule,STIG-ID|GEN001200-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-794"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/*"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001210 M6 - System command files must not have extended ACLs - '/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <path/file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38072r1_rule,STIG-ID|GEN001210-M6,Vuln-ID|V-22314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /bin | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001210 M6 - System command files must not have extended ACLs - '/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <path/file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38072r1_rule,STIG-ID|GEN001210-M6,Vuln-ID|V-22314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /sbin | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001210 M6 - System command files must not have extended ACLs - '/usr/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <path/file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38072r1_rule,STIG-ID|GEN001210-M6,Vuln-ID|V-22314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/bin | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001210 M6 - System command files must not have extended ACLs - '/usr/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <path/file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38072r1_rule,STIG-ID|GEN001210-M6,Vuln-ID|V-22314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/sbin | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001220 M6 - All system files, programs, and directories must be owned by a system account - '/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      info        : "NOTE: Update the SYSTEM_ACCOUNT value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the owner of system files, programs, and directories to a system account.

chown root <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37988r1_rule,STIG-ID|GEN001220-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-795"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/bin/*"
# Note: Variable @SYSTEM_ACCOUNT@ replaced with "_sshd" in field "owner".
      owner       : "root" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001220 M6 - All system files, programs, and directories must be owned by a system account - '/usr/bin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      info        : "NOTE: Update the SYSTEM_ACCOUNT value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the owner of system files, programs, and directories to a system account.

chown root <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37988r1_rule,STIG-ID|GEN001220-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-795"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/*"
# Note: Variable @SYSTEM_ACCOUNT@ replaced with "_sshd" in field "owner".
      owner       : "root" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001220 M6 - All system files, programs, and directories must be owned by a system account - '/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      info        : "NOTE: Update the SYSTEM_ACCOUNT value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the owner of system files, programs, and directories to a system account.

chown root <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37988r1_rule,STIG-ID|GEN001220-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-795"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/sbin/*"
# Note: Variable @SYSTEM_ACCOUNT@ replaced with "_sshd" in field "owner".
      owner       : "root" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001220 M6 - All system files, programs, and directories must be owned by a system account - '/usr/sbin'"
      info        : "Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths."
      info        : "NOTE: Update the SYSTEM_ACCOUNT value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the owner of system files, programs, and directories to a system account.

chown root <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37988r1_rule,STIG-ID|GEN001220-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-795"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/*"
# Note: Variable @SYSTEM_ACCOUNT@ replaced with "_sshd" in field "owner".
      owner       : "root" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001240 M6 - System files, programs, and directories must be group-owned by a system group - '/bin'"
      info        : "Restricting permissions will protect the files from unauthorized modification."
      info        : "NOTE: Update the SYSTEM_GROUP value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the group ownership of system files, programs, and directories to a system group.

chgrp wheel <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37989r1_rule,STIG-ID|GEN001240-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-796"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/bin/*"
# Note: Variable @SYSTEM_GROUP@ replaced with "_sshd" in field "group".
      group       : "wheel" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001240 M6 - System files, programs, and directories must be group-owned by a system group - '/usr/bin'"
      info        : "Restricting permissions will protect the files from unauthorized modification."
      info        : "NOTE: Update the SYSTEM_GROUP value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the group ownership of system files, programs, and directories to a system group.

chgrp wheel <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37989r1_rule,STIG-ID|GEN001240-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-796"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/*"
# Note: Variable @SYSTEM_GROUP@ replaced with "_sshd" in field "group".
      group       : "wheel" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001240 M6 - System files, programs, and directories must be group-owned by a system group - '/sbin'"
      info        : "Restricting permissions will protect the files from unauthorized modification."
      info        : "NOTE: Update the SYSTEM_GROUP value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the group ownership of system files, programs, and directories to a system group.

chgrp wheel <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37989r1_rule,STIG-ID|GEN001240-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-796"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/sbin/*"
# Note: Variable @SYSTEM_GROUP@ replaced with "_sshd" in field "group".
      group       : "wheel" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001240 M6 - System files, programs, and directories must be group-owned by a system group - '/usr/sbin'"
      info        : "Restricting permissions will protect the files from unauthorized modification."
      info        : "NOTE: Update the SYSTEM_GROUP value with the appropriate systems' account values for the local environment"
      solution    : "Open a terminal session and enter the following command to change the group ownership of system files, programs, and directories to a system group.

chgrp wheel <path/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37989r1_rule,STIG-ID|GEN001240-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-796"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/*"
# Note: Variable @SYSTEM_GROUP@ replaced with "_sshd" in field "group".
      group       : "wheel" || "_sshd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001260 M6 - System log files must have mode 644 or less permissive - '/var/log'"
      info        : "If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value."
      solution    : "Open a terminal session and enter the following command to change the mode of the system log file(s).

chmod 644 <path/to/system log file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CCI|CCI-001314,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37890r1_rule,SANS-CSC|14,STIG-ID|GEN001260-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-787"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/log/*"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001260 M6 - System log files must have mode 644 or less permissive - '/var/audit'"
      info        : "If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value."
      solution    : "Open a terminal session and enter the following command to change the mode of the system log file(s).

chmod 644 <path/to/system log file>"
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECTP-1,CAT|II,CCI|CCI-001314,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CSCv6|3.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37890r1_rule,SANS-CSC|14,STIG-ID|GEN001260-M6,Vuln-ID|V-787"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/audit/*"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001270 M6 - System log files must not have extended ACLs, except as needed to support authorized software - '/var/log/*'"
      info        : "If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value. Authorized software may be given log file access through the use of extended ACLs when needed and configured to provide the least privileges required."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /var/log<file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,8500.2|ECTP-1,CAT|II,CCI|CCI-001314,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38073r1_rule,STIG-ID|GEN001270-M6,Vuln-ID|V-22315"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /var/log | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001280 M6 - Manual page files must have mode 0644 or less permissive - '/usr/share/man/*'"
      info        : "If manual pages are compromised, misleading information could be inserted causing actions to possibly compromise the system."
      solution    : "Open a terminal session and enter the following command to set the mode of the manual page files to 0644 or less permissive.

 chmod 0644 /usr/share/man"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|III,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37910r1_rule,SANS-CSC|15,STIG-ID|GEN001280-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-792"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/share/man/*"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001290 M6 - All manual page files must not have extended ACLs - '/usr/share/man/*'"
      info        : "If manual pages are compromised, misleading information could be inserted causing actions to possibly compromise the system."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -RN /usr/share/man"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|III,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38074r1_rule,SANS-CSC|15,STIG-ID|GEN001290-M6,Vuln-ID|V-22316"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/share/man | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001300 M6 - Library files must have mode 0755 or less permissive - '/System/Library/Frameworks'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to change the mode of library files to 0755 or less permissive.

chmod 0755 <path/to/library-file>

NOTE- Library files should have an extension of '.a' or '.so', possibly followed by a version number. Frameworks are directories that may already contain files with more restrictive permissions than 755 and thus should not have their modes changed to 755 recursively."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|DCSL-1,CAT|II,CCI|CCI-001499,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37911r1_rule,SANS-CSC|3,STIG-ID|GEN001300-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-793"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x /System/Library/Frameworks -type f -perm +022 | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001300 M6 - Library files must have mode 0755 or less permissive - '/Library/Frameworks'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to change the mode of library files to 0755 or less permissive.

chmod 0755 <path/to/library-file>

NOTE- Library files should have an extension of '.a' or '.so', possibly followed by a version number. Frameworks are directories that may already contain files with more restrictive permissions than 755 and thus should not have their modes changed to 755 recursively."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|DCSL-1,CAT|II,CCI|CCI-001499,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37911r1_rule,SANS-CSC|3,STIG-ID|GEN001300-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-793"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x /Library/Frameworks -type f -perm +022 | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001300 M6 - Library files must have mode 0755 or less permissive - '/usr/lib'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to change the mode of library files to 0755 or less permissive.

chmod 0755 <path/to/library-file>

NOTE- Library files should have an extension of '.a' or '.so', possibly followed by a version number. Frameworks are directories that may already contain files with more restrictive permissions than 755 and thus should not have their modes changed to 755 recursively."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|DCSL-1,CAT|II,CCI|CCI-001499,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37911r1_rule,SANS-CSC|3,STIG-ID|GEN001300-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-793"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x /usr/lib -type f -perm +022 | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001300 M6 - Library files must have mode 0755 or less permissive - '/usr/local/lib'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to change the mode of library files to 0755 or less permissive.

chmod 0755 <path/to/library-file>

NOTE- Library files should have an extension of '.a' or '.so', possibly followed by a version number. Frameworks are directories that may already contain files with more restrictive permissions than 755 and thus should not have their modes changed to 755 recursively."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|DCSL-1,CAT|II,CCI|CCI-001499,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37911r1_rule,SANS-CSC|3,STIG-ID|GEN001300-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-793"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x /usr/local/lib -type f -perm +022 | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001310 M6 - All library files must not have extended ACLs - '/System/Library/Frameworks'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -RN /System/Library/Frameworks /Library/Frameworks /usr/lib /usr/local/lib"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38075r1_rule,SANS-CSC|12,STIG-ID|GEN001310-M6,Vuln-ID|V-22317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /System/Library/Frameworks | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001310 M6 - All library files must not have extended ACLs - '/Library/Frameworks'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -RN /System/Library/Frameworks /Library/Frameworks /usr/lib /usr/local/lib"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38075r1_rule,SANS-CSC|12,STIG-ID|GEN001310-M6,Vuln-ID|V-22317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /Library/Frameworks | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001310 M6 - All library files must not have extended ACLs - '/usr/lib'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -RN /System/Library/Frameworks /Library/Frameworks /usr/lib /usr/local/lib"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38075r1_rule,SANS-CSC|12,STIG-ID|GEN001310-M6,Vuln-ID|V-22317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/lib | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001310 M6 - All library files must not have extended ACLs - '/usr/local/lib'"
      info        : "Unauthorized access could destroy the integrity of the library files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -RN /System/Library/Frameworks /Library/Frameworks /usr/lib /usr/local/lib"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-001499,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38075r1_rule,SANS-CSC|12,STIG-ID|GEN001310-M6,Vuln-ID|V-22317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /usr/local/lib | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001362 M6 - The /etc/resolv.conf file must be owned by root"
      info        : "The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to set the owner of the resolv.conf file.

chown root /etc/resolv.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38077r1_rule,SANS-CSC|12,SANS-CSC|15,STIG-ID|GEN001362-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22319"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/resolv.conf"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001363 M6 - The /etc/resolv.conf file must be group-owned by wheel"
      info        : "The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to set the group ownership of the resolv.conf file.

chgrp wheel /etc/resolv.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38078r1_rule,SANS-CSC|15,STIG-ID|GEN001363-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22320"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/resolv.conf"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001364 M6 - The /etc/resolv.conf file must have mode 0644 or less permissive"
      info        : "The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to set permissions on the file.

chmod 644 /etc/resolv.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38079r1_rule,SANS-CSC|15,STIG-ID|GEN001364-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22321"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/resolv.conf"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001365 M6 - The /etc/resolv.conf file must not have an extended ACL"
      info        : "The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/resolv.conf"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38081r1_rule,SANS-CSC|15,STIG-ID|GEN001365-M6,Vuln-ID|V-22322"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/resolv.conf | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001362 M6 - The /etc/hosts file must be owned by root"
      info        : "The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to set the owner of the resolv.conf file.

chown root /etc/resolv.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38077r1_rule,SANS-CSC|15,STIG-ID|GEN001362-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22319"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/hosts"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001367 M6 - The /etc/hosts file must be group-owned by wheel"
      info        : "The /etc/hosts file (or equivalent) configures local host name to IP address mappings typically taking precedence over DNS resolution. If this file is maliciously modified, it could cause the failure or compromise of security functions requiring name resolution, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to set the group to root.

chgrp wheel /etc/hosts"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38083r1_rule,SANS-CSC|15,STIG-ID|GEN001367-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22324"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/hosts"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001368 M6 - The /etc/hosts file must have mode 0644 or less permissive"
      info        : "The /etc/hosts file (or equivalent) configures local host name to IP address mappings typically taking precedence over DNS resolution. If this file is maliciously modified, it could cause the failure or compromise of security functions requiring name resolution, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and use the following command to set the mode of the etc/hosts file.

chmod 644 /etc/hosts"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38085r1_rule,SANS-CSC|15,STIG-ID|GEN001368-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22325"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/hosts"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001369 M6 - The /etc/hosts file must not have an extended ACL"
      info        : "The /etc/hosts file (or equivalent) configures local host name to IP address mappings typically taking precedence over DNS resolution. If this file is maliciously modified, it could cause the failure or compromise of security functions requiring name resolution, such as time synchronization, centralized authentication, and remote system logging."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/hosts"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38086r1_rule,SANS-CSC|15,STIG-ID|GEN001369-M6,Vuln-ID|V-22326"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/hosts | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN001375 M6 - For systems using DNS resolution, at least two name servers must be configured"
          file        : "/etc/resolv.conf"
# Note: Variable @NAME_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.1" in field "regex".
          regex       : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.1"
# Note: Variable @NAME_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.1" in field "expect".
          expect      : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.1\\s*$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN001375 M6 - For systems using DNS resolution, at least two name servers must be configured - 'first name server is configured'"
          info        : "To provide availability for name resolution services, multiple redundant name servers are mandated.  A failure in name resolution could lead to the failure of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging."
          info        : "NOTE: Update the value for NAME_SERVER_2 to the appropriate value for the local environment"
          solution    : "Open a terminal  session and use the following command to edit the /etc/resolv.conf and add additional 'nameserver' lines until at least two are present.

sudo pico /etc/resolv.conf"
          reference   : "800-53|SC-20,8500.2|ECSC-1,CAT|III,CCI|CCI-001182,ITSG-33|SC-20,Rule-ID|SV-38766r1_rule,SANS-CSC|19,STIG-ID|GEN001375-M6,Vuln-ID|V-22331"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/resolv.conf"
# Note: Variable @NAME_SERVER_2@ replaced with "192\\\\.168\\\\.1\\\\.2" in field "regex".
          regex       : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.2"
# Note: Variable @NAME_SERVER_2@ replaced with "192\\\\.168\\\\.1\\\\.2" in field "expect".
          expect      : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.2\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN001375 M6 - For systems using DNS resolution, at least two name servers must be configured - 'second name server is configured'"
          info        : "To provide availability for name resolution services, multiple redundant name servers are mandated.  A failure in name resolution could lead to the failure of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging."
          info        : "NOTE: Update the value for NAME_SERVER_1 to the appropriate value for the local environment"
          solution    : "Open a terminal  session and use the following command to edit the /etc/resolv.conf and add additional 'nameserver' lines until at least two are present.

sudo pico /etc/resolv.conf"
          reference   : "800-53|SC-20,8500.2|ECSC-1,CAT|III,CCI|CCI-001182,ITSG-33|SC-20,Rule-ID|SV-38766r1_rule,SANS-CSC|19,STIG-ID|GEN001375-M6,Vuln-ID|V-22331"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/resolv.conf"
# Note: Variable @NAME_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.1" in field "regex".
          regex       : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.1"
# Note: Variable @NAME_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.1" in field "expect".
          expect      : "^\\s*[Nn][Aa][Mm][Ee][Ss][Ee][Rr][Vv][Ee][Rr]\\s+192\\\\.168\\\\.1\\\\.1\\s*$"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001378 M6 - The /etc/passwd file must be owned by root"
      info        : "The /etc/passwd file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to set the owner to root.

chown root /etc/passwd"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38087r1_rule,SANS-CSC|15,STIG-ID|GEN001378-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-22332"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/passwd"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001379 M6 - The /etc/passwd file must be group-owned by wheel"
      info        : "The /etc/passwd file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel /etc/passwd"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38088r1_rule,SANS-CSC|15,STIG-ID|GEN001379-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-22333"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/passwd"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001380 M6 - The /etc/passwd file must have mode 0644 or less permissive"
      info        : "If the password file is writable by a group owner or the world, the risk of password file compromise is increased. The password file contains the list of accounts on the system and associated information."
      solution    : "Open a terminal session and enter the following command to set the permissions for the password file.

chmod 644 /etc/passwd"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37990r1_rule,SANS-CSC|15,STIG-ID|GEN001380-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-798"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/passwd"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001390 M6 - The /etc/passwd file must not have an extended ACL"
      info        : "File system ACLs can provide access to files beyond what is allowed by the mode numbers of the files.  The /etc/passwd file contains the list of local system accounts. It is vital to system security and must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/passwd"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38089r1_rule,SANS-CSC|15,STIG-ID|GEN001390-M6,Vuln-ID|V-22334"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/passwd | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001391 M6 - The /etc/group file must be owned by root"
      info        : "The /etc/group file is critical to system security and must be owned by a privileged user.  The group file contains a list of system groups and associated information."
      solution    : "Open a terminal session and enter the following command to set the owner to root.

chown root /etc/group"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38090r1_rule,SANS-CSC|15,STIG-ID|GEN001391-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-22335"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/group"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001392 M6 - The /etc/group file must be group-owned by wheel"
      info        : "The /etc/group file is critical to system security and must be protected from unauthorized modification.  The group file contains a list of system groups and associated information."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel /etc/group"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38091r1_rule,SANS-CSC|15,STIG-ID|GEN001392-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-22336"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/group"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001393 M6 - The /etc/group file must have mode 0644 or less permissive"
      info        : "The /etc/group file is critical to system security and must be protected from unauthorized modification.  The group file contains a list of system groups and associated information."
      solution    : "Open a terminal session and enter the following command to set the mode of the /etc/group file.

chmod 644 /etc/group"
      reference   : "800-53|IA-5,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-1,ITSG-33|IA-5,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38092r1_rule,SANS-CSC|15,STIG-ID|GEN001393-M6,SWIFT-CSCv1|5.4,TBA-FIISB|26.1,Vuln-ID|V-22337"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/group"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001394 M6 - The /etc/group file must not have an extended ACL"
      info        : "The /etc/group file is critical to system security and must be protected from unauthorized modification.  The group file contains a list of system groups and associated information."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/group"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38093r1_rule,SANS-CSC|15,STIG-ID|GEN001394-M6,Vuln-ID|V-22338"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -la /etc/group | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001490 M6 - User home directories must not have extended ACLs - '/Users/*'"
      info        : "Excessive permissions on home directories allow unauthorized access to user files."
      solution    : "Open a terminal session and enter the following command to set the permissions.

chmod -N <user home directory with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|III,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38094r1_rule,SANS-CSC|15,STIG-ID|GEN001490-M6,Vuln-ID|V-22350"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lLd /Users | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <item>
      system      : "Darwin"
      description : "GEN001540 M6 - All files and directories contained in interactive user home directories must be owned by the home directory's owner"
      info        : "If users do not own the files in their directories, unauthorized users may be able to access them. Additionally, if files are not owned by the user, this could be an indication of system compromise."
      solution    : "Open a terminal session and enter the following command to change the ownership of files and directories in user home directories to the owner of the home directory.

chown <account-owner> <filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|III,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38182r1_rule,SANS-CSC|15,STIG-ID|GEN001540-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-914"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "accounts_bad_home_permissions"
    </item>

    <item>
      system      : "Darwin"
      description : "GEN001550 M6 - All files contained in user home directories must be group-owned by a group where the home directory's owner is a member"
      info        : "If a user's files are group-owned by a group where the user is not a member, unintended users may be able to access them."
      solution    : "chgrp <group with user as member> <file with bad group ownership>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38215r1_rule,SANS-CSC|15,STIG-ID|GEN001550-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22351"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "accounts_bad_home_group_permissions"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001570 M6 - All files and directories contained in user home directories must not have extended ACLs"
      info        : "Excessive permissions allow unauthorized access to user files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <user file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38095r1_rule,SANS-CSC|15,STIG-ID|GEN001570-M6,Vuln-ID|V-22352"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x /Users -exec ls -lLd {} \\; | /usr/bin/grep '^[-d][-r][-w][-xSs][-r][-w][-xSs][-r][-w][-xSsTt]\+' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001580 M6 - All run control scripts must have mode 0755 or less permissive - '/System/Library/LaunchDaemons'"
      info        : "If the startup files are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to set the mode of the run control script file.

chmod 755 <startup file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38013r1_rule,SANS-CSC|15,STIG-ID|GEN001580-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-906"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/LaunchDaemons/*"
      mask        : "022"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001580 M6 - All run control scripts must have mode 0755 or less permissive - '/System/Library/LaunchAgents'"
      info        : "If the startup files are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to set the mode of the run control script file.

chmod 755 <startup file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38013r1_rule,SANS-CSC|15,STIG-ID|GEN001580-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-906"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/LaunchAgents/*"
      mask        : "022"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001580 M6 - All run control scripts must have mode 0755 or less permissive - '/Library/LaunchAgents'"
      info        : "If the startup files are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to set the mode of the run control script file.

chmod 755 <startup file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38013r1_rule,SANS-CSC|15,STIG-ID|GEN001580-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-906"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/Library/LaunchAgents/*"
      mask        : "022"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001580 M6 - All run control scripts must have mode 0755 or less permissive - '/Library/LaunchDaemons'"
      info        : "If the startup files are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to set the mode of the run control script file.

chmod 755 <startup file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38013r1_rule,SANS-CSC|15,STIG-ID|GEN001580-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-906"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/Library/LaunchDaemons/*"
      mask        : "022"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001590 M6 - Launch control scripts must not have extended ACLs - '/System/Library/LaunchDaemons'"
      info        : "If the launch control scripts are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <launch control script with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38096r1_rule,SANS-CSC|15,STIG-ID|GEN001590-M6,Vuln-ID|V-22353"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /System/Library/LaunchDaemons | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001590 M6 - Launch control scripts must not have extended ACLs - '/System/Library/LaunchAgents'"
      info        : "If the launch control scripts are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <launch control script with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38096r1_rule,SANS-CSC|15,STIG-ID|GEN001590-M6,Vuln-ID|V-22353"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /System/Library/LaunchAgents | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001590 M6 - Launch control scripts must not have extended ACLs - '/Library/LaunchDaemons'"
      info        : "If the launch control scripts are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <launch control script with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38096r1_rule,SANS-CSC|15,STIG-ID|GEN001590-M6,Vuln-ID|V-22353"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /Library/LaunchDaemons | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001590 M6 - Launch control scripts must not have extended ACLs - '/Library/LaunchAgents'"
      info        : "If the launch control scripts are writable by other users, they could modify to insert malicious commands into the startup files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <launch control script with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38096r1_rule,SANS-CSC|15,STIG-ID|GEN001590-M6,Vuln-ID|V-22353"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /Library/LaunchAgents | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001660 M6 - All system start-up files must be owned by root"
      info        : "System start-up files not owned by root could lead to system compromise by allowing malicious users or applications to modify them for unauthorized purposes.  This could lead to system and network compromise."
      solution    : "Open a terminal session and enter the following command to reset the ownership to the original installation settings.

diskutil repairPermissions /"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37845r1_rule,SANS-CSC|15,STIG-ID|GEN001660-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4089"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions / | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN001680 M6 - All system start-up files must be group-owned by root, sys, bin, other, or system"
      info        : "If system start-up files do not have a group owner of root or a system group, the files may be modified by malicious users or intruders.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Open a terminal session and enter the following command to reset the file ownership to their original settings.

diskutil repairPermissions /"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38018r1_rule,SANS-CSC|15,STIG-ID|GEN001680-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4090"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions / | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001720 M6 - All global initialization files must have mode 0644 or less permissive - '/etc/bashrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to set the mode on the global initialization files.

chmod 644 /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38058r1_rule,SANS-CSC|15,STIG-ID|GEN001720-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11981"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/bashrc"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001720 M6 - All global initialization files must have mode 0644 or less permissive - '/etc/csh.cshrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to set the mode on the global initialization files.

chmod 644 /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38058r1_rule,SANS-CSC|15,STIG-ID|GEN001720-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11981"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.cshrc"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001720 M6 - All global initialization files must have mode 0644 or less permissive - '/etc/csh.login'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to set the mode on the global initialization files.

chmod 644 /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38058r1_rule,SANS-CSC|15,STIG-ID|GEN001720-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11981"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.login"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001720 M6 - All global initialization files must have mode 0644 or less permissive - '/etc/csh.logout'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to set the mode on the global initialization files.

chmod 644 /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38058r1_rule,SANS-CSC|15,STIG-ID|GEN001720-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11981"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.logout"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001720 M6 - All global initialization files must have mode 0644 or less permissive - '/etc/profile'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to set the mode on the global initialization files.

chmod 644 /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38058r1_rule,SANS-CSC|15,STIG-ID|GEN001720-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11981"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/profile"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001740 M6 - All global initialization files must be owned by root - '/etc/bashrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the owner of the global initialization files.

chown root /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38060r1_rule,SANS-CSC|15,STIG-ID|GEN001740-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11982"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/bashrc"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001740 M6 - All global initialization files must be owned by root - '/etc/csh.cshrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the owner of the global initialization files.

chown root /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38060r1_rule,SANS-CSC|15,STIG-ID|GEN001740-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11982"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.cshrc"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001740 M6 - All global initialization files must be owned by root - '/etc/csh.login'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the owner of the global initialization files.

chown root /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38060r1_rule,SANS-CSC|15,STIG-ID|GEN001740-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11982"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.login"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001740 M6 - All global initialization files must be owned by root - '/etc/csh.logout'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the owner of the global initialization files.

chown root /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38060r1_rule,SANS-CSC|15,STIG-ID|GEN001740-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11982"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.logout"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001740 M6 - All global initialization files must be owned by root - '/etc/profile'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the owner of the global initialization files.

chown root /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38060r1_rule,SANS-CSC|15,STIG-ID|GEN001740-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11982"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/profile"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001760 M6 - All global initialization files must be group-owned by wheel - '/etc/bashrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to the group wheel provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and use the following command to set the group ownership of the global initialization files.

chgrp wheel /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38061r1_rule,SANS-CSC|15,STIG-ID|GEN001760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11983"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/bashrc"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001760 M6 - All global initialization files must be group-owned by wheel - '/etc/csh.cshrc'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to the group wheel provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and use the following command to set the group ownership of the global initialization files.

chgrp wheel /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38061r1_rule,SANS-CSC|15,STIG-ID|GEN001760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11983"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.cshrc"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001760 M6 - All global initialization files must be group-owned by wheel - '/etc/csh.login'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to the group wheel provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and use the following command to set the group ownership of the global initialization files.

chgrp wheel /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38061r1_rule,SANS-CSC|15,STIG-ID|GEN001760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11983"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.login"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001760 M6 - All global initialization files must be group-owned by wheel - '/etc/csh.logout'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to the group wheel provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and use the following command to set the group ownership of the global initialization files.

chgrp wheel /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38061r1_rule,SANS-CSC|15,STIG-ID|GEN001760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11983"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/csh.logout"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN001760 M6 - All global initialization files must be group-owned by wheel - '/etc/profile'"
      info        : "Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to the group wheel provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and use the following command to set the group ownership of the global initialization files.

chgrp wheel /etc/<filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38061r1_rule,SANS-CSC|15,STIG-ID|GEN001760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-11983"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/profile"
      group       : "wheel"
    </custom_item>

    <item>
      system      : "Darwin"
      description : "GEN001860 M6 - All local initialization files must be owned by the user or root"
      info        : "Local initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon."
      solution    : "Open a terminal session and enter the following command to change the ownership of the start-up and login files in the user's directory to the user or root, as appropriate. Examine each user's home directory and verify all filenames beginning with '.' are owned by the owner of the directory or root. If they are not, use the chown command to change the owner to the user and research the reasons why the owners were not assigned as required.

chown <username> </directory/filename>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38010r1_rule,SANS-CSC|15,STIG-ID|GEN001860-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-904"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "home_dir_localization_files_user_check"
      file        : ".login"
      file        : ".cshrc"
      file        : ".logout"
      file        : ".profile"
      file        : ".bash_profile"
      file        : ".bashrc"
      file        : ".bash_logout"
      file        : ".env"
      file        : ".dtprofile"
      file        : ".dispatch"
      file        : ".emacs"
      file        : ".exrc"
      file        : ".dt"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002000 M6 - There must be no .netrc files on the system"
      info        : "Unencrypted passwords for remote FTP servers may be stored in .netrc files.  Policy requires passwords be encrypted in storage and not used in access scripts."
      solution    : "To remove the .netrc file(s) enter the following command.

rm .netrc"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CCI|CCI-000196,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38002r1_rule,SANS-CSC|10,STIG-ID|GEN002000-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-913"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x / -type f -name .netrc | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002200 M6 - All shell files must be owned by root - '/etc/shells'"
      info        : "If shell files are owned by users other than root or bin, they could be modified by intruders or malicious users to perform unauthorized actions."
      solution    : "Open a terminal session and enter the following command to change the ownership of the shell file with incorrect ownership.

chown root <shell>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-38014r1_rule,SANS-CSC|15,STIG-ID|GEN002200-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-921"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /etc/shells | /usr/bin/xargs -n1 ls -lL | /usr/bin/grep -v '^[-d][r-][w-][x-][r-][w-][x-][r-][w-][x-][ ]*[0-9]*[ ]*[Rr][Oo][Oo][Tt]' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002220 M6 - All shell files must have mode 0755 or less permissive - '/etc/shells'"
      info        : "Shells with world/group write permissions give the ability to maliciously modify the shell to obtain unauthorized access."
      solution    : "Open a terminal session and enter the following command to set the mode.

chmod 0755 <shell file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|I,CCI|CCI-000225,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-38015r1_rule,SANS-CSC|15,STIG-ID|GEN002220-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-922"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /etc/shells | /usr/bin/xargs -n1 ls -lL | /usr/bin/grep -v '^-[r-][w-][x-][r-]-[x-][r-]-[x-]' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002230 M6 - All shell files must not have extended ACLs - '/etc/shells'"
      info        : "Shells with world/group-write permissions give the ability to maliciously modify the shell to obtain unauthorized access."
      solution    : "Open a terminal session and use the following command to remove the extended ACLs.

chmod -N <shell file with extended ACL>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38098r1_rule,SANS-CSC|15,STIG-ID|GEN002230-M6,Vuln-ID|V-22366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /etc/shells | /usr/bin/xargs -n1 ls -lL | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002280 M6 - Device files and directories must only be writable by users with a system account or as configured by the vendor"
      info        : "System device files in writable directories could be modified, removed, or used by an unprivileged user to control system hardware."
      solution    : "Open a terminal session and enter the following command to set the mode of the device file.

chmod 755 <device file>"
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECCD-1,8500.2|ECCD-2,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-38017r1_rule,SANS-CSC|15,STIG-ID|GEN002280-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-924"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x / -perm -2 -a \( -type b -o -type c \)| /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002500 M6 - Failing to set the sticky bit on the public directories allows unauthorized users to delete files in the directory structure"
      info        : "Failing to set the sticky bit on the public directories allows unauthorized users to delete files in the directory structure.

The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage (e.g., /tmp) and for directories requiring global read/write access."
      solution    : "Open a terminal session and enter the following command to set the sticky bit on all public directories.

chmod 1777 <public directory missing the sticky bit>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|III,CCI|CCI-000366,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37991r1_rule,SANS-CSC|11,STIG-ID|GEN002500-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-806"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x / -type d -perm -002 -exec ls -ld {} \\; | /usr/bin/grep -v '^[-d][-r][-w][-xS][-r][-w][-xS][-r][-w][Tt]' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002520 M6 - All public directories must be owned by root or an application account"
      info        : "If a public directory has the sticky bit set and is not owned by a privileged UID, unauthorized users may be able to modify files created by others.

The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage (e.g., /tmp) and for directories requiring global read/write access."
      solution    : "Open a terminal session and enter the following command to change the owner of public directories to root or an application account.

chown root /tmp

(Replace root with an application user and/or '/tmp' with another public directory as necessary.)"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|2.2.4,PCI-DSSv3.2|7.1.2,Rule-ID|SV-37993r1_rule,SANS-CSC|15,STIG-ID|GEN002520-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-807"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x / -type d -perm -002 -exec ls -ld {} \\; | /usr/bin/grep -v '^[-d][-r][-w][-xS][-r][-w][-xS][-r][-w][Tt][+@]*[ ]*[0-9]*[ ]*[Rr][Oo][Oo][Tt]' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN002680 M6 - System audit logs must be owned by root - '/var/audit/*'"
      info        : "Failure to give ownership of system audit log files to root provides the designated owner and unauthorized users with the potential to access sensitive information."
      solution    : "Open a terminal session and use the following command to change the owner of the file.

chown root /var/audit/<filename>"
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECTP-1,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CSCv6|3.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38619r1_rule,SANS-CSC|14,STIG-ID|GEN002680-M6,Vuln-ID|V-812"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/audit/*"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN002690 M6 - System audit logs must be group-owned by wheel - '/var/audit/*'"
      info        : "Sensitive system and user information could provide a malicious user with enough information to penetrate further into the system."
      solution    : "Open a terminal session and enter the following command to change group ownership of the file.

chgrp wheel /var/audit/ <audit file>"
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECLP-1,8500.2|ECTP-1,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CSCv6|3.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38144r1_rule,SANS-CSC|14,STIG-ID|GEN002690-M6,Vuln-ID|V-22702"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/audit/*"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN002700 M6 - System audit logs must have mode 640 or less permissive - '/var/audit/*'"
      info        : "If a user can write to the audit logs, audit trails can be modified or destroyed and system intrusion may not be detected.  System audit logs are those files generated from the audit system and do not include activity, error, or other log files created by application software."
      solution    : "Open a terminal session and use the following command to set the permissions of the audit log file.

chmod 640 /var/audit <filename>"
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECTP-1,CAT|II,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CSCv6|3.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38622r1_rule,SANS-CSC|14,STIG-ID|GEN002700-M6,Vuln-ID|V-813"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/audit/*"
      mask        : "137"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002710 M6 - All system audit files must not have extended ACLs - '/var/audit/*'"
      info        : "If a user can write to the audit logs, then audit trails can be modified or destroyed and system intrusion may not be detected."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N </var/audit/ file with extended ACL>"
      reference   : "800-171|3.1.1,800-171|3.3.8,800-171|3.3.9,800-53|AC-3,800-53|AU-9,8500.2|ECTP-1,CAT|II,CCI|CCI-000163,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ITSG-33|AC-3,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-38102r1_rule,SANS-CSC|14,STIG-ID|GEN002710-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-22369"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -Ll /var/audit | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002718 M6 - System audit tool executables must not have extended ACLs - '/usr/sbin/audit'"
      info        : "To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected."
      solution    : "Open a terminal session and use the following command to remove the extended ACLs.

chmod -N <audit file with extended ACL>"
      reference   : "800-171|3.1.1,800-171|3.3.8,800-171|3.3.9,800-53|AC-3,800-53|AU-9,8500.2|ECLP-1,CAT|III,CCI|CCI-001493,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ITSG-33|AC-3,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-38103r1_rule,SANS-CSC|14,STIG-ID|GEN002718-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-22373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/audit | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002718 M6 - System audit tool executables must not have extended ACLs - '/usr/sbin/auditd'"
      info        : "To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected."
      solution    : "Open a terminal session and use the following command to remove the extended ACLs.

chmod -N <audit file with extended ACL>"
      reference   : "800-171|3.1.1,800-171|3.3.8,800-171|3.3.9,800-53|AC-3,800-53|AU-9,8500.2|ECLP-1,CAT|III,CCI|CCI-001493,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ITSG-33|AC-3,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-38103r1_rule,SANS-CSC|14,STIG-ID|GEN002718-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-22373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/auditd | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002718 M6 - System audit tool executables must not have extended ACLs - '/usr/sbin/auditreduce'"
      info        : "To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected."
      solution    : "Open a terminal session and use the following command to remove the extended ACLs.

chmod -N <audit file with extended ACL>"
      reference   : "800-171|3.1.1,800-171|3.3.8,800-171|3.3.9,800-53|AC-3,800-53|AU-9,8500.2|ECLP-1,CAT|III,CCI|CCI-001493,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ITSG-33|AC-3,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-38103r1_rule,SANS-CSC|14,STIG-ID|GEN002718-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-22373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/auditreduce | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002718 M6 - System audit tool executables must not have extended ACLs - '/usr/sbin/praudit'"
      info        : "To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected."
      solution    : "Open a terminal session and use the following command to remove the extended ACLs.

chmod -N <audit file with extended ACL>"
      reference   : "800-171|3.1.1,800-171|3.3.8,800-171|3.3.9,800-53|AC-3,800-53|AU-9,8500.2|ECLP-1,CAT|III,CCI|CCI-001493,CSF|PR.AC-4,CSF|PR.PT-1,CSF|PR.PT-3,ITSG-33|AC-3,ITSG-33|AU-9,NESA|M1.2.2,NESA|M5.2.3,NESA|M5.5.2,Rule-ID|SV-38103r1_rule,SANS-CSC|14,STIG-ID|GEN002718-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-22373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/praudit | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN002990 M6 - The cron.allow file must not have an extended ACL - '/private/var/at/cron.allow'"
      info        : "A cron.allow file that is readable and/or writable by other than root could allow potential intruders and malicious users to use the file contents to help discern information, such as who is allowed to execute cron programs, which could be harmful to overall system and network security."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /private/var/at/cron.allow"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38105r1_rule,SANS-CSC|15,STIG-ID|GEN002990-M6,Vuln-ID|V-22384"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /private/var/at/cron.allow | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003050 M6 - Crontab files must be group-owned by wheel, cron, or the crontab creator's primary group - '/usr/sbin/cron'"
      info        : "To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel <crontab file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38107r1_rule,SANS-CSC|15,STIG-ID|GEN003050-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22385"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/cron"
      group       : "wheel" || "cron"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003050 M6 - Crontab files must be group-owned by wheel, cron, or the crontab creator's primary group - '/usr/lib/cron'"
      info        : "To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel <crontab file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38107r1_rule,SANS-CSC|15,STIG-ID|GEN003050-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22385"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/lib/cron"
      group       : "wheel" || "cron"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003050 M6 - Crontab files must be group-owned by wheel, cron, or the crontab creator's primary group - '/usr/bin/crontab'"
      info        : "To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel <crontab file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38107r1_rule,SANS-CSC|15,STIG-ID|GEN003050-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22385"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/crontab"
      group       : "wheel" || "cron"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003050 M6 - Crontab files must be group-owned by wheel, cron, or the crontab creator's primary group - '/private/var/at/cron.deny'"
      info        : "To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured."
      solution    : "Open a terminal session and enter the following command to set the group to wheel.

chgrp wheel <crontab file>"
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38107r1_rule,SANS-CSC|15,STIG-ID|GEN003050-M6,Vuln-ID|V-22385"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/private/var/at/cron.deny"
      group       : "wheel" || "cron"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003090 M6 - Crontab files must not have extended ACLs - '/usr/sbin/cron'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.  ACLs on crontab files may provide unauthorized access to the files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab file>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38110r1_rule,SANS-CSC|15,STIG-ID|GEN003090-M6,Vuln-ID|V-22386"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/cron | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003090 M6 - Crontab files must not have extended ACLs - '/usr/lib/cron'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.  ACLs on crontab files may provide unauthorized access to the files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab file>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38110r1_rule,SANS-CSC|15,STIG-ID|GEN003090-M6,Vuln-ID|V-22386"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/lib/cron | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003090 M6 - Crontab files must not have extended ACLs - '/usr/bin/crontab'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.  ACLs on crontab files may provide unauthorized access to the files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab file>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38110r1_rule,SANS-CSC|15,STIG-ID|GEN003090-M6,Vuln-ID|V-22386"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/bin/crontab | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003090 M6 - Crontab files must not have extended ACLs - '/private/var/at/cron.deny'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.  ACLs on crontab files may provide unauthorized access to the files."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab file>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38110r1_rule,SANS-CSC|15,STIG-ID|GEN003090-M6,Vuln-ID|V-22386"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /private/var/at/cron.deny | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003110 M6 - Cron and crontab directories must not have extended ACLs - '/usr/sbin/cron'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured. ACLs on cron and crontab directories may provide unauthorized access to these directories. Unauthorized modifications to these directories or their contents may result in the addition of unauthorized cron jobs or deny service to authorized cron jobs."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab directory>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38112r1_rule,SANS-CSC|15,STIG-ID|GEN003110-M6,Vuln-ID|V-22387"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -ld /usr/sbin/cron | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003110 M6 - Cron and crontab directories must not have extended ACLs - '/usr/lib/cron'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured. ACLs on cron and crontab directories may provide unauthorized access to these directories. Unauthorized modifications to these directories or their contents may result in the addition of unauthorized cron jobs or deny service to authorized cron jobs."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab directory>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38112r1_rule,SANS-CSC|15,STIG-ID|GEN003110-M6,Vuln-ID|V-22387"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -ld /usr/lib/cron | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003110 M6 - Cron and crontab directories must not have extended ACLs - '/usr/bin/crontab'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured. ACLs on cron and crontab directories may provide unauthorized access to these directories. Unauthorized modifications to these directories or their contents may result in the addition of unauthorized cron jobs or deny service to authorized cron jobs."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab directory>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38112r1_rule,SANS-CSC|15,STIG-ID|GEN003110-M6,Vuln-ID|V-22387"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -ld /usr/bin/crontab | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003110 M6 - Cron and crontab directories must not have extended ACLs - '/private/var/at/cron.deny'"
      info        : "To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured. ACLs on cron and crontab directories may provide unauthorized access to these directories. Unauthorized modifications to these directories or their contents may result in the addition of unauthorized cron jobs or deny service to authorized cron jobs."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N <crontab directory>"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38112r1_rule,SANS-CSC|15,STIG-ID|GEN003110-M6,Vuln-ID|V-22387"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -ld /private/var/at/cron.deny | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003210 M6 - The cron.deny file must not have an extended ACL - '/private/var/at/cron.deny'"
      info        : "If there are excessive file permissions for the cron.deny file, sensitive information could be viewed or edited by unauthorized users."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /private/var/at/cron.deny"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38115r1_rule,SANS-CSC|15,STIG-ID|GEN003210-M6,Vuln-ID|V-22389"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -l /private/var/at/cron.deny | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003250 M6 - The cron.allow file must be group-owned by wheel - '/private/var/at/cron.allow'"
      info        : "If the group of the cron.allow is not set to wheel, the possibility exists for an unauthorized user to view or edit the list of users permitted to use cron. Unauthorized modification of this file could cause Denial of Service to authorized cron users or provide unauthorized users with the ability to run cron jobs."
      solution    : "Open a terminal session and enter the following command.

chgrp wheel /private/var/at/cron.allow"
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38117r1_rule,SANS-CSC|15,STIG-ID|GEN003250-M6,Vuln-ID|V-22391"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/private/var/at/cron.allow"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003270 M6 - The cron.deny file must be group-owned by wheel - '/private/var/at/cron.deny'"
      info        : "The cron daemon control files and restricts the scheduling of automated tasks and must be protected. Unauthorized modification of the cron.deny file could result in Denial of Service to authorized cron users or could provide unauthorized users with the ability to run cron jobs."
      solution    : "Open a terminal session and enter the following command to set the group.

chgrp wheel /private/var/at/cron.deny"
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38119r1_rule,SANS-CSC|15,STIG-ID|GEN003270-M6,Vuln-ID|V-22394"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/private/var/at/cron.deny"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003400 M6 - The 'at' directory must have mode 0755 or less permissive - '/var/at'"
      info        : "If the 'at' directory has a mode more permissive than 0755, unauthorized users could be allowed to view or to edit files containing sensitive information within the 'at' directory. Unauthorized modifications could result in Denial of Service to authorized 'at' jobs."
      solution    : "Open a terminal session and enter the following command to set the mode of the 'at' directory to 755.

chmod 755 /var/at"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38019r1_rule,SANS-CSC|15,STIG-ID|GEN003400-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4364"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/at"
      mask        : "022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003420 M6 - The 'at' directory must be owned by root, bin, or sys - '/var/at'"
      info        : "If the owner of the 'at' directory is not root, bin, or sys, unauthorized users could be allowed to view or edit files containing sensitive information within the directory."
      solution    : "Open a terminal session and enter the following command to set the owner to root.

chown root /var/at"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38021r1_rule,SANS-CSC|15,STIG-ID|GEN003420-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4365"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/at"
      owner       : "root" || "bin" || "sys"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "GEN003440 M6 - 'At' jobs must not set the umask to a value less restrictive than 077 - '/var/at/spool/*'"
      info        : "The umask controls the default access mode assigned to newly created files. An umask of 077 limits new files to mode 700 or less permissive. Although umask is often represented as a 4-digit number, the first digit representing special access modes is typically ignored or required to be '0'."
      solution    : "Open a terminal session and edit 'at' jobs or referenced scripts to remove 'umask' commands setting umask to a value less restrictive than 077."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38022r1_rule,SANS-CSC|15,STIG-ID|GEN003440-M6,Vuln-ID|V-4366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/at/spool/*"
      regex       : "^[^#]*[Uu][Mm][Aa][Ss][Kk]"
      expect      : "0[0-7][0-7]$"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003480 M6 - The at.deny file must be owned by root, bin, or sys - '/var/at/at.deny'"
      info        : "If the owner of the at.deny file is not set to root, bin, or sys, unauthorized users could be allowed to view or edit sensitive information contained within the file."
      solution    : "Open a terminal session and enter the following command to set the owner of the at.deny file.

chown root /var/at/at.deny"
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.AC-4,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38024r1_rule,SANS-CSC|15,STIG-ID|GEN003480-M6,Vuln-ID|V-4368"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/var/at/at.deny"
      owner       : "root" || "sys" || "bin"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003510 M6 - Kernel core dumps must be disabled unless needed - 'kern.coredump=0'"
      info        : "Kernel core dumps may contain the full contents of system memory at the time of the crash. Kernel core dumps may consume a considerable amount of disk space and may result in Denial of Service by exhausting the available space on the target file system. The kernel core dump process may increase the amount of time a system is unavailable due to a crash. Kernel core dumps can be useful for kernel debugging."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following entry.

kern.coredump=0

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.AC-4,Rule-ID|SV-38198r1_rule,SANS-CSC|15,STIG-ID|GEN003510-M6,Vuln-ID|V-22404"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep kern.coredump"
      expect      : "\\s*kern\.coredump\\s*=\\s*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003602 M6 - The system must not process Internet Control Message Protocol (ICMP) timestamp requests - 'net.inet.icmp.timestamp:1'"
      info        : "The processing of ICMP timestamp requests increases the attack surface of the system."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.icmp.timestamp=1

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|III,CCI|CCI-001551,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,Rule-ID|SV-38200r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003602-M6,Vuln-ID|V-22409"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.icmp.timestamp"
      expect      : "\\s*net\.inet\.icmp\.timestamp\\s*:\\s*1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003603 M6 - System must not respond to ICMP (ICMPv4) echoes to a broadcast address - 'net.inet.icmp.bmcastecho:1'"
      info        : "Responding to broadcast ICMP echoes facilitates network mapping and provides a vector for amplification attacks."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.icmp.bmcastecho=1

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001551,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,Rule-ID|SV-38201r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003603-M6,Vuln-ID|V-22410"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.icmp.bmcastecho"
      expect      : "\\s*net\.inet\.icmp\.bmcastecho\\s*:\\s*1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003606 M6 - The system must prevent local applications from generating source-routed packets - 'net.inet.ip.sourceroute:0'"
      info        : "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.ip.sourceroute=0

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001551,CSCv6|9.2,ITSG-33|SC-7,Rule-ID|SV-38202r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003606-M6,Vuln-ID|V-22413"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.ip.sourceroute"
      expect      : "\\s*net\.inet\.ip\.sourceroute\\s*:\\s*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003607 M6 - The system must not accept source-routed IPv4 packets - 'net.inet.ip.accept_sourceroute:0'"
      info        : "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the handling of source-routed traffic destined to the system itself, not to traffic forwarded by the system to another, such as when IPv4 forwarding is enabled and the system is functioning as a router."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.ip.accept_sourceroute=0

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001551,CSCv6|9.2,ITSG-33|SC-7,Rule-ID|SV-38203r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003607-M6,Vuln-ID|V-22414"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.ip.accept_sourceroute"
      expect      : "\\s*net\.inet\.ip\.accept_sourceroute\\s*:\\s*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003609 M6 - The system must ignore IPv4 ICMP redirect messages - 'net.inet.icmp.drop_redirect:0'"
      info        : "ICMP redirect messages are used by routers to inform hosts of a more direct route existing for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.icmp.drop_redirect=0

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001503,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,Rule-ID|SV-38204r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003609-M6,Vuln-ID|V-22416"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.icmp.drop_redirect"
      expect      : "\\s*net\.inet\.icmp\.drop_redirect\\s*:\\s*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003610 M6 - The system must not send IPv4 ICMP redirects - 'net.inet.ip.redirect:0'"
      info        : "ICMP redirect messages are used by routers to inform hosts of a more direct route existing for a particular destination. These messages contain information from the system's route table possibly revealing portions of the network topology."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.ip.redirect=0

NOTE- If the sysctl.conf file does not exist use the following command to create one.
touch /etc/sysctl.conf"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001551,CSCv6|9.2,ITSG-33|SC-7,Rule-ID|SV-38205r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003610-M6,Vuln-ID|V-22417"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.ip.redirect"
      expect      : "\\s*net\.inet\.ip\.redirect\\s*:\\s*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003760 M6 - The services file must be owned by root or bin - '/etc/services'"
      info        : "Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the ownership of the services file.

chown root /etc/services"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37996r1_rule,SANS-CSC|15,SANS-CSC|17,STIG-ID|GEN003760-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-823"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/services"
      owner       : "root" || "bin"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003770 M6 - The services file must be group-owned by wheel - '/etc/services'"
      info        : "Failure to give ownership of system configuration files to a system group provides the designated owner and unauthorized users with the potential to change the system configuration which could weaken the system's security posture."
      solution    : "Open a terminal session and enter the following command to set the group.

chgrp wheel /etc/services"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38122r1_rule,SANS-CSC|15,STIG-ID|GEN003770-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22427"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/services"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003780 M6 - The services file must have mode 0644 or less permissive - '/etc/services'"
      info        : "The services file is critical to the proper operation of network services and must be protected from unauthorized modification.  Unauthorized modification could result in the failure of network services."
      solution    : "Open a terminal session and enter the following command to set the mode of the services file.

chmod 0644 /etc/services"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37997r1_rule,SANS-CSC|15,STIG-ID|GEN003780-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-824"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/services"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003790 M6 - The services file must not have an extended ACL - '/etc/services'"
      info        : "The services file is critical to the proper operation of network services and must be protected from unauthorized modification.  If the services file has an extended ACL, it may be possible for unauthorized users to modify the file.  Unauthorized modification could result in the failure of network services."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/services"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38124r1_rule,SANS-CSC|15,STIG-ID|GEN003790-M6,Vuln-ID|V-22428"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/services | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003820 M6 - The rsh daemon must not be running - 'Disabled=1;'"
      info        : "The rshd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service."
      solution    : "Open a terminal session and use the following command to disable rshd.

launchctl unload -w /System/Library/LaunchDaemons/shell.plist

NOTE- This command is being run to adjust the overrides file; unloading errors are normal, repeat the check to verify."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|EBRU-1,CAT|I,CCI|CCI-000068,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-38052r1_rule,SANS-CSC|7,STIG-ID|GEN003820-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4687"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /var/db/launchd.db/com.apple.launchd/overrides com.apple.rshd"
      expect      : "^\\s*[Dd]isabled\\s*=\\s*1\\s*;\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003840 M6 - The rexec daemon must not be running - 'Disabled=1;'"
      info        : "The rexecd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service."
      solution    : "Open a terminal session and use the following command to set the rexec status.

launchctl unload -w /System/Library/LaunchDaemons/exec.plist

NOTE- This command is being run to adjust the overrides file; unloading errors are normal, repeat the check to verify."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|EBRP-1,8500.2|ECSC-1,CAT|I,CCI|CCI-001435,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-38054r1_rule,SANS-CSC|7,STIG-ID|GEN003840-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4688"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /var/db/launchd.db/com.apple.launchd/overrides com.apple.rexecd"
      expect      : "^\\s*[Dd]isabled\\s*=\\s*1\\s*;\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003850 M6 - The telnet daemon must not be running - 'Disabled=1;'"
      info        : "The telnet daemon provides a typically unencrypted remote access service which does not provide for the confidentiality and integrity of user passwords or the remote session.  If a privileged user were to log on using this service, the privileged user password could be compromised."
      solution    : "Open a terminal session and use the following command to disable telnet.

launchctl unload -w /System/Library/LaunchDaemons/telnet.plist

NOTE- This command is being run to adjust the overrides file; unloading errors are normal, repeat the check to verify."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,CAT|I,CCI|CCI-000197,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-38213r1_rule,SANS-CSC|10,STIG-ID|GEN003850-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-24386"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /var/db/launchd.db/com.apple.launchd/overrides com.apple.telnetd"
      expect      : "^\\s*[Dd]isabled\\s*=\\s*1\\s*;\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN003860 M6 - The system must not have the finger service active - 'Disabled = 1'"
      info        : "The finger service provides information about the system's users to network clients. This information could expose information to be used in subsequent attacks."
      solution    : "Open a terminal session and use the following command to disable finger.

launchctl unload -w /System/Library/LaunchDaemons/finger.plist

NOTE- This command is being run to adjust the overrides file; unloading errors are normal, repeat the check to verify."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|DCPP-1,8500.2|EBRU-1,CAT|III,CCI|CCI-001551,CN-L3|7.1.3.5(c),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-38057r2_rule,SANS-CSC|15,STIG-ID|GEN003860-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4701"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /System/Library/LaunchDaemons/finger Disabled"
      expect      : "^\\s*1\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003960 M6 - The traceroute command owner must be root - '/usr/sbin/traceroute'"
      info        : "If the traceroute command owner has not been set to root, an unauthorized user could use this command to obtain knowledge of the network topology inside the firewall. This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise."
      solution    : "Open a terminal session and enter the following command to set the owner of the traceroute command.

chown root /usr/sbin/traceroute"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38026r1_rule,SANS-CSC|15,STIG-ID|GEN003960-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4369"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/traceroute"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN003980 M6 - The traceroute command must be group-owned by wheel - '/usr/sbin/traceroute'"
      info        : "If the group owner of the traceroute command has not been set to a system group, unauthorized users could have access to the command and use it to gain information regarding a network's topology inside of the firewall. This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise."
      solution    : "Open a terminal session and enter the following command to set the group ownership of the traceroute command.

chgrp wheel /usr/sbin/traceroute"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38027r1_rule,SANS-CSC|15,STIG-ID|GEN003980-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4370"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/traceroute"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN004000 M6 - The traceroute file must have mode 0700 or less permissive - '/usr/sbin/traceroute'"
      info        : "If the mode of the traceroute executable is more permissive than 0700, malicious code could be inserted by an attacker and triggered whenever the traceroute command is executed by authorized users. Additionally, if an unauthorized user is granted executable permissions to the traceroute command, it could be used to gain information about the network topology behind the firewall. This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise."
      solution    : "Open a terminal session and enter the following command to set the mode of the traceroute command.

chmod 700 /usr/sbin/traceroute"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38028r1_rule,SANS-CSC|15,STIG-ID|GEN004000-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4371"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/sbin/traceroute"
      mask        : "077"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN004010 M6 - The traceroute file must not have an extended ACL - '/usr/sbin/traceroute'"
      info        : "If an extended ACL exists on the traceroute executable file, it may provide unauthorized users with access to the file. Malicious code could be inserted by an attacker and triggered whenever the traceroute command is executed by authorized users. Additionally, if an unauthorized user is granted executable permissions to the traceroute command, it could be used to gain information about the network topology behind the firewall. This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /usr/sbin/traceroute"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,PCI-DSS|2.2.3,Rule-ID|SV-38127r1_rule,SANS-CSC|15,STIG-ID|GEN004010-M6,Vuln-ID|V-22437"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /usr/sbin/traceroute | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN004370 M6 - The aliases file must be group-owned by wheel - '/etc/aliases'"
      info        : "If the alias file is not group-owned by a system group, an unauthorized user may modify the file to add aliases to run malicious code or redirect email."
      solution    : "Open a terminal session and enter the following command to set the group.

chgrp wheel /etc/aliases"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38128r1_rule,SANS-CSC|15,STIG-ID|GEN004370-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22438"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/aliases"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN004390 M6 - The alias file must not have an extended ACL - '/etc/aliases'"
      info        : "Excessive permissions on the aliases file may permit unauthorized modification.  If the alias file is modified by an unauthorized user, they may modify the file to run malicious code or redirect email."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/aliases"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38131r1_rule,SANS-CSC|15,STIG-ID|GEN004390-M6,Vuln-ID|V-22439"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/aliases | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN004580 M6 - The system must not use .forward files"
      info        : "The .forward file allows users to automatically forward mail to another system. Use of .forward files could allow the unauthorized forwarding of mail and could potentially create mail loops which could degrade system performance."
      solution    : "Open a terminal session and enter the following command to remove .forward files from the system.

rm <path of .forward files>"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-38005r1_rule,SANS-CSC|11,STIG-ID|GEN004580-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4385"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/find -x / -type f -name .forward | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN005280 M6 - The system must not have the UUCP service active - 'Disabled = 1'"
      info        : "The UUCP utility is designed to assist in transferring files, executing remote commands, and sending email between UNIX systems over phone lines and direct connections between systems. The UUCP utility is a primitive and arcane system with many security issues. There are alternate data transfer utilities/products that can be configured to more securely transfer data by providing for authentication, as well as encryption."
      solution    : "Open a terminal session and use the following command to disable uucp.

launchctl unload -w /System/Library/LaunchDaemons/com.apple.uucp.plist

NOTE- This command is being run to adjust the overrides file; unloading errors are normal, repeat the check to verify."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001436,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-38055r1_rule,SANS-CSC|7,STIG-ID|GEN005280-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4696"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /System/Library/LaunchDaemons/com.apple.uucp Disable"
      expect      : "^\\s*1\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN005395 M6 - The /etc/syslog.conf file must not have an extended ACL - '/etc/syslog.conf'"
      info        : "Unauthorized users must not be allowed to access or modify the /etc/syslog.conf file."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/syslog.conf"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38133r1_rule,SANS-CSC|15,STIG-ID|GEN005395-M6,Vuln-ID|V-22454"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/syslog.conf | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN005400 M6 - The /etc/syslog.conf file must be owned by root - '/etc/syslog.conf'"
      info        : "If the /etc/syslog.conf file is not owned by root, unauthorized users could be allowed to view, edit, or delete important system messages handled by the syslog facility."
      solution    : "Open a terminal session and use the following command to set the owner of the syslog.conf file.

chown root /etc/syslog.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38030r1_rule,SANS-CSC|15,STIG-ID|GEN005400-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4393"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/syslog.conf"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN005420 M6 - The /etc/syslog.conf file must be group-owned by wheel - '/etc/syslog.conf'"
      info        : "If the group owner of /etc/syslog.conf is not root, bin, or sys, unauthorized users could be permitted to view, edit, or delete important system messages handled by the syslog facility."
      solution    : "Open a terminal session and enter the following command to set the group ownership of the syslog.conf file.

chgrp wheel /etc/syslog.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38051r1_rule,SANS-CSC|15,STIG-ID|GEN005420-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-4394"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/syslog.conf"
      group       : "wheel"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "ciphers exist in sshd_config"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005505 M6 - The SSH daemon must be configured to only use FIPS 140-2 approved ciphers - 'CIPHERS does not include ARCFOUR/BLOWFISH/CAST'"
          info        : "DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' to remove any ciphers not starting with '3DES' or 'AES'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39360r1_rule,SANS-CSC|7,STIG-ID|GEN005505-M6,Vuln-ID|V-22458"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "\\s*([Aa][Rr][Cc][Ff][Oo][Uu][Rr]|[Bb][Ll][Oo][Ww][Ff][Ii][Ss][Hh]|[Cc][Aa][Ss][Tt])"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005505 M6 - The SSH daemon must be configured to only use FIPS 140-2 approved ciphers - 'CIPHERS configured'"
          info        : "DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' to remove any ciphers not starting with '3DES' or 'AES'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39360r1_rule,SANS-CSC|7,STIG-ID|GEN005505-M6,Vuln-ID|V-22458"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "ciphers exist in sshd_config"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005506 M6 - The SSH daemon must be configured to not use CBC ciphers - 'CIPHERS does not include -CBC'"
          info        : "The Cipher-Block Chaining (CBC) mode of encryption as implemented in the SSHv2 protocol is vulnerable to chosen plaintext attacks and must not be used."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' and remove any ciphers ending with 'CBC'. If necessary, add a Ciphers line."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39364r1_rule,SANS-CSC|11,STIG-ID|GEN005506-M6,Vuln-ID|V-22459"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "-[Cc][Bb][Cc]"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005506 M6 - The SSH daemon must be configured to not use CBC ciphers - 'CIPHERS configured'"
          info        : "The Cipher-Block Chaining (CBC) mode of encryption as implemented in the SSHv2 protocol is vulnerable to chosen plaintext attacks and must not be used."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' and remove any ciphers ending with 'CBC'. If necessary, add a Ciphers line."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39364r1_rule,SANS-CSC|11,STIG-ID|GEN005506-M6,Vuln-ID|V-22459"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005507 M6 - The SSH daemon must use Message Authentication Codes (MACs) employing FIPS 140-2 approved cryptographic hash algorithms"
          file        : "/etc/sshd_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "^[Mm][Aa][Cc][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005507 M6 - SSH MACs must use FIPS 140-2 approved algorithms - 'MACS doesn't include HMAC-MD5/HMAC-RIPEMD160/HMAC-SHA1-96/HMAC-MD5-96'"
          info        : "DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' and remove any MACs other than 'hmac-sha1'.  If there is no MACs line in '/etc/sshd_config', add 'MACs hmac-sha1' to the file.

Restart the SSH daemon for the changes to take effect."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-001453,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39369r2_rule,SANS-CSC|7,STIG-ID|GEN005507-M6,Vuln-ID|V-22460"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "([Hh][Mm][Aa][Cc]-[Mm][Dd]5|[Hh][Mm][Aa][Cc]-[Rr][Ii][Pp][Ee][Mm][Dd]160|[Hh][Mm][Aa][Cc]-[Ss][Hh][Aa]1-96|[Hh][Mm][Aa][Cc]-[Mm][Dd]5-96)"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005507 M6 - SSH Server MACs use FIPS 140-2 approved algorithms - 'MACS doesn't include HMAC-MD5/HMAC-RIPEMD160/HMAC-SHA1-96/HMAC-MD5-96'"
          info        : "DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions."
          solution    : "Open a terminal session and edit the SSH daemon configuration file '/etc/sshd_config' and remove any MACs other than 'hmac-sha1'.  If there is no MACs line in '/etc/sshd_config', add 'MACs hmac-sha1' to the file.

Restart the SSH daemon for the changes to take effect."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-001453,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39369r2_rule,SANS-CSC|7,STIG-ID|GEN005507-M6,Vuln-ID|V-22460"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/sshd_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "^[Mm][Aa][Cc][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "ciphers configued in ssh_config"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005510 M6 - The SSH client must be configured to only use FIPS 140-2 approved ciphers - 'CIPHERS does not include ARCFOUR/BLOWFISH/CAST'"
          info        : "DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any ciphers not starting with '3DES' or 'AES'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39371r1_rule,SANS-CSC|7,STIG-ID|GEN005510-M6,Vuln-ID|V-22461"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "\\s*([Aa][Rr][Cc][Ff][Oo][Uu][Rr]|[Bb][Ll][Oo][Ww][Ff][Ii][Ss][Hh]|[Cc][Aa][Ss][Tt])"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005510 M6 - The SSH client must be configured to only use FIPS 140-2 approved ciphers - 'CIPHERS configured'"
          info        : "DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any ciphers not starting with '3DES' or 'AES'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-000068,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39371r1_rule,SANS-CSC|7,STIG-ID|GEN005510-M6,Vuln-ID|V-22461"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "ciphers configured in ssh_config"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005511 M6 - The SSH client must be configured to not use CBC-based ciphers - 'CIPHERS does not include -CBC'"
          info        : "The Cipher-Block Chaining (CBC) mode of encryption as implemented in the SSHv2 protocol is vulnerable to chosen plaintext attacks and must not be used."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any ciphers ending with 'CBC'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39374r1_rule,SANS-CSC|11,STIG-ID|GEN005511-M6,Vuln-ID|V-22462"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "-[Cc][Bb][Cc]"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005511 M6 - The SSH client must be configured to not use CBC-based ciphers - 'CIPHERS configured'"
          info        : "The Cipher-Block Chaining (CBC) mode of encryption as implemented in the SSHv2 protocol is vulnerable to chosen plaintext attacks and must not be used."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any ciphers ending with 'CBC'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39374r1_rule,SANS-CSC|11,STIG-ID|GEN005511-M6,Vuln-ID|V-22462"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
          expect      : "^[Cc][Ii][Pp][Hh][Ee][Rr][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005512 M6 - SSH client MACs use FIPS 140-2 approved algorithms"
          file        : "/etc/ssh_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "^[Mm][Aa][Cc][Ss]\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK_NOT
          description : "GEN005512 M6 - SSH client MACs use FIPS 140-2 approved algorithms - 'MACS doesn't include HMAC-MD5/HMAC-RIPEMD160/HMAC-SHA1-96/HMAC-MD5-96'"
          info        : "DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any MACs other than 'hmac-sha1'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-001453,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39376r1_rule,SANS-CSC|7,STIG-ID|GEN005512-M6,Vuln-ID|V-22463"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "([Hh][Mm][Aa][Cc]-[Mm][Dd]5|[Hh][Mm][Aa][Cc]-[Rr][Ii][Pp][Ee][Mm][Dd]160|[Hh][Mm][Aa][Cc]-[Ss][Hh][Aa]1-96|[Hh][Mm][Aa][Cc]-[Mm][Dd]5-96)"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CONTENT_CHECK
          description : "GEN005512 M6 - SSH client MACs use FIPS 140-2 approved algorithms - 'MACS configured'"
          info        : "DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions."
          solution    : "Open a terminal session and edit the SSH client configuration file '/etc/ssh_config' and remove any MACs other than 'hmac-sha1'."
          reference   : "800-171|3.13.11,800-53|SC-13,8500.2|DCNR-1,CAT|II,CCI|CCI-001453,CSF|PR.DS-5,ITSG-33|SC-13,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,Rule-ID|SV-39376r1_rule,SANS-CSC|7,STIG-ID|GEN005512-M6,Vuln-ID|V-22463"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/etc/ssh_config"
          regex       : "^[Mm][Aa][Cc][Ss]\\s*="
          expect      : "^[Mm][Aa][Cc][Ss]\\s*="
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN005600 M6 - IP forwarding for IPv4 must not be enabled, unless the system is a router - 'net.inet.ip.fw.enable:0'"
      info        : "If the system is configured for IP forwarding and is not a designated router, it could be used to bypass network security by providing a path for communication not filtered by network devices."
      solution    : "Open a terminal session and edit the /etc/sysctl.conf file and add the following line.

net.inet.ip.fw.enable=0"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-000366,CSCv6|9.2,ITSG-33|SC-7,Rule-ID|SV-38186r1_rule,SANS-CSC|11,STIG-ID|GEN005600-M6,Vuln-ID|V-12023"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/sysctl -a | /usr/bin/grep net.inet.ip.fw.enable"
      expect      : "^\\s*net\.inet\.ip\.fw\.enable\\s*:\\s*0\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN005900 M6 - The nosuid option must be enabled on all NFS client mounts"
      info        : "Enabling the nosuid mount option prevents the system from granting owner or group-owner privileges to programs with the suid or sgid bit set. If the system does not restrict this access, users with unprivileged access to the local system may be able to acquire privileged access by executing suid or sgid files located on the mounted NFS file system."
      solution    : "Open a terminal session and edit /etc/auto_master and add the 'nosuid' option at the end of the line that begins with /net.

In the same terminal session, edit /etc/fstab and add the 'nosuid' option to any lines for NFS mounts.

Remount the NFS file systems to make the change take effect."
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECPA-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,Rule-ID|SV-38158r2_rule,SANS-CSC|15,STIG-ID|GEN005900-M6,Vuln-ID|V-936"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/sbin/mount -t nfs | /usr/bin/egrep -v \"nosuid\" | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <report type:"WARNING">
      description : "GEN006000 M6 - The system must not have a public Instant Messaging (IM) client installed"
      info        : "Public IM systems are not approved for use and may result in the unauthorized distribution of information. IM clients provide a way for a user to send a message to one or more users in real time. Additional capabilities may include file transfer and support for distributed game playing. Communication between clients and associated directory services are managed through messaging servers. Commercial IM clients include AOL Instant Messenger (AIM), MSN Messenger, and Yahoo! Messenger.

IM clients present a security issue when the clients route messages through public servers. The obvious implication is for potentially sensitive information to be intercepted or altered in the course of transmission. This same issue is associated with the use of public email servers. In order to reduce the potential for disclosure of sensitive Government information and to ensure the validity of official Government information, IM clients connecting to public IM services will not be installed. Clients used to access internal or DoD-controlled IM services are permitted.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Uninstall the IM client from the system, or configure the client to only connect to DoD-approved IM services."
      reference   : "800-53|SC-15,8500.2|ECIM-1,CAT|II,CCI|CCI-000366,Rule-ID|SV-38067r1_rule,STIG-ID|GEN006000-M6,Vuln-ID|V-12024"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "GEN006040 M6 - The system must not have any peer-to-peer file-sharing application installed"
      info        : "Peer-to-peer file-sharing software can result in the unintentional exfiltration of information.  There are also many legal issues associated with these types of utilities including copyright infringement or other intellectual property issues.  The ASD Memo 'Use of Peer-to-Peer (P2P) File-Sharing Applications across the DoD' states the following-

'P2P file-sharing applications are authorized for use on DOD networks with approval by the appropriate Designated Approval Authority (DAA).  Documented requirements, security architecture, configuration management process, and a training program for users are all requirements within the approval process.  The unauthorized use of application or services, including P2P applications, is prohibited, and such applications or services must be eliminated.'

Peer-to-peer applications include, but are not limited to-

-Napster,
-Kazaa,
-ARES,
-Limewire,
-IRC Chat Relay, and
-BitTorrent.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Uninstall the peer-to-peer file sharing application(s) from the system."
      reference   : "800-53|AC-17,8500.2|DCPD-1,8500.2|ECSC-1,CAT|II,CCI|CCI-001436,Rule-ID|SV-38068r1_rule,SANS-CSC|7,STIG-ID|GEN006040-M6,Vuln-ID|V-12025"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN006100 M6 - The /etc/smb.conf file must be owned by root - '/etc/smb.conf'"
      info        : "The /etc/smb.conf file allows access to other machines on the network and grants permissions to certain users.  If it is owned by another user, the file may be maliciously modified and the Samba configuration could be compromised."
      solution    : "Open a terminal session and enter the following command to set the owner of the smb.conf file to root.

chown root /etc/smb.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38183r1_rule,SANS-CSC|15,STIG-ID|GEN006100-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-1027"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/smb.conf"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN006140 M6 - The /etc/smb.conf file must have mode 0644 or less permissive - '/etc/smb.conf'"
      info        : "If the smb.conf file has excessive permissions, the file may be maliciously modified and the Samba configuration could be compromised."
      solution    : "Open a terminal session and enter the following command to set the mode of the smb.conf file.

chmod 644 /etc/smb.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38184r1_rule,SANS-CSC|15,STIG-ID|GEN006140-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-1028"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/smb.conf"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN006150 M6 - The /etc/smb.conf file must not have an extended ACL - '/etc/smb.conf'"
      info        : "Excessive permissions could endanger the security of the Samba configuration file and, ultimately, the system and network."
      solution    : "Open a terminal session and enter the following command to remove the extended ACLs.

chmod -N /etc/smb.conf"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38135r1_rule,SANS-CSC|15,STIG-ID|GEN006150-M6,Vuln-ID|V-22497"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/smb.conf | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN006565 M6 - The system package management tool must be used to verify system software periodically"
      info        : "Verification using the system package management tool can be used to determine that system software has not been tampered with.

This requirement is not applicable to systems not using package management tools."
      solution    : "Open a terminal session and enter the following command to reset the permissions to the original installation settings.
diskutil repairPermissions /"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECAT-1,CAT|II,CCI|CCI-000366,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38138r1_rule,STIG-ID|GEN006565-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22506"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions / | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN006570 M6 - The file integrity tool must be configured to verify ACLs"
      info        : "ACLs can provide permissions beyond those permitted through the file mode and must be verified by file integrity tools."
      solution    : "Open a terminal session and enter the following command to reset the permissions to the original installation settings.

diskutil repairPermissions /"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECAT-1,CAT|III,CCI|CCI-001297,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38139r1_rule,STIG-ID|GEN006570-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22507"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions / | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN006571 M6 - The file integrity tool must be configured to verify extended attributes"
      info        : "Extended attributes in file systems are used to contain arbitrary data and file metadata potentially having security implications."
      solution    : "Open a terminal session and enter the following command to remove extended attributes.

diskutil repairPermissions /"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECAT-1,CAT|III,CCI|CCI-001297,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38141r1_rule,STIG-ID|GEN006571-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22508"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions / | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN008060 M6 - The /etc/openldap/ldap.conf (or equivalent) file must have mode 0644 or less permissive - '/etc/openldap/ldap.conf'"
      info        : "LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to set permissions on the file.

chmod 644 /etc/openldap/ldap.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38142r1_rule,SANS-CSC|15,STIG-ID|GEN008060-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22559"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/openldap/ldap.conf"
      mask        : "133"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN008080 M6 - The /etc/openldap/ldap.conf (or equivalent) file must be owned by root - '/etc/openldap/ldap.conf'"
      info        : "LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to set the owner to root.

chown root /etc/openldap/ldap.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38155r1_rule,SANS-CSC|15,STIG-ID|GEN008080-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22560"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/openldap/ldap.conf"
      owner       : "root"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "GEN008100 M6 - The /etc/openldap/ldap.conf (or equivalent) file must be group-owned by wheel - '/etc/openldap/ldap.conf'"
      info        : "LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification."
      solution    : "Open a terminal session and use the following command to set the group owner of the file.

chgrp wheel /etc/openldap/ldap.conf"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38156r1_rule,SANS-CSC|15,STIG-ID|GEN008100-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-22561"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/openldap/ldap.conf"
      group       : "wheel"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "GEN008120 M6 - The /etc/openldap/ldap.conf (or equivalent) file must not have an extended ACL - '/etc/openldap/ldap.conf'"
      info        : "LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification."
      solution    : "Open a terminal session and enter the following command to remove the ACLs.

chmod -RN /etc/openldap/ldap.conf"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECLP-1,CAT|II,CCI|CCI-000225,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-38157r1_rule,SANS-CSC|15,STIG-ID|GEN008120-M6,Vuln-ID|V-22562"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/ls -lL /etc/openldap/ldap.conf | /usr/bin/grep [-d][-r][-w][-xS][-r][-w][-xS][-r][-w][-xST]\+ | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <report type:"WARNING">
      description : "GEN008540 M6 - The system's local firewall must implement a deny-all, allow-by-exception policy"
      info        : "A local firewall protects the system from exposing unnecessary or undocumented network services to the local enclave.  If a system within the enclave is compromised, firewall protection on an individual system continues to protect it from attack.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Configure the system's local firewall to implement a deny-all, allow-by-exception policy."
      reference   : "800-53|SC-7,8500.2|ECSC-1,CAT|II,CCI|CCI-001109,Rule-ID|SV-39384r1_rule,SANS-CSC|11,STIG-ID|GEN008540-M6,Vuln-ID|V-22583"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00010 M6 - Unnecessary packages must not be installed"
      info        : "Removing unused packages frees disk space and reduces the risk of attackers finding vulnerabilities in unused components.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the packages installed using the following command.
pkgutil / --pkgs
Determine if the installed packages are needed. If not, verify any dependencies and use the rm command to remove them."
      reference   : "800-171|3.4.8,800-53|CM-7,8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.4,Rule-ID|SV-37149r1_rule,SANS-CSC|3,STIG-ID|OSX00010-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25187"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/pkgutil / --pkgs | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00015 M6 - Administrator accounts must be created with difficult-to-guess names"
      info        : "The administrator account has unlimited privileges to the system. Creating a complex name improves the protection of this account and the system. Do not use administrator; do not use the name of the machine, etc.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Select Finder.
2. Select Applications.
3. Select System Preferences.
4. Select Accounts.
5. Rename or recreate accounts with difficult-to-guess names."
      reference   : "800-171|3.1.1,800-53|AC-2,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS|2.1,Rule-ID|SV-37153r1_rule,SANS-CSC|16,STIG-ID|OSX00015-M6,Vuln-ID|V-25200"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/dscl . -readall /Users | /usr/bin/egrep -i 'RealName: ([Aa]dministrator|[Aa]dmin|[Rr]oot|[Mm]anager|[Ss]uperuser|[Oo]perator|[Ss]ysadm|[Ss]upervisor)'"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00020 M6 - A maximum password age must be set"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxMinutesUntilChangePassword"
          expect      : "^[^Mm][^Aa][^Xx][^Mm][^Ii][^Nn][^Uu][^Tt][^Ee][^Ss][^Uu][^Nn][^Tt][^Ii][^Ll][^Cc][^Hh][^Aa][^Nn][^Gg][^Pp][^Aa][^Ss][^Ss][^Ww][^Oo][^Rr][^Dd]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00020 M6 - A maximum password age must be set - 'Managed maxMinutesUntilChangePassword >= 86400 or 0'"
          info        : "The longer a password is in use, the greater the opportunity for someone to gain unauthorized knowledge of the passwords. Further, scheduled changing of passwords hinders the ability of unauthorized system users to crack passwords and gain access to a system."
          solution    : "Open a terminal session and use the following command to set the value for maxMinutesUntilChangePassword.

sudo pwpolicy -n -setglobalpolicy 'maxMinutesUntilChangePassword=86400'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'maxMinutesUntilChangePassword=86400'"
          reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-37158r1_rule,SANS-CSC|16,STIG-ID|OSX00020-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-25204"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxMinutesUntilChangePassword"
          expect      : "^max[Mm]inutes[Uu]ntil[Cc]hange[Pp]assword\\s*=\\s*(0|86[4-9][0-9][0-9]|8[7-9][0-9][0-9][0-9]|9[0-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9][0-9]+)\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00020 M6 - A maximum password age must be set - 'Local maxMinutesUntilChangePassword >= 86400 or 0'"
          info        : "The longer a password is in use, the greater the opportunity for someone to gain unauthorized knowledge of the passwords. Further, scheduled changing of passwords hinders the ability of unauthorized system users to crack passwords and gain access to a system."
          solution    : "Open a terminal session and use the following command to set the value for maxMinutesUntilChangePassword.

sudo pwpolicy -n -setglobalpolicy 'maxMinutesUntilChangePassword=86400'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'maxMinutesUntilChangePassword=86400'"
          reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-37158r1_rule,SANS-CSC|16,STIG-ID|OSX00020-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-25204"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxMinutesUntilChangePassword"
          expect      : "^max[Mm]inutes[Uu]ntil[Cc]hange[Pp]assword\\s*=\\s*(0|86[4-9][0-9][0-9]|8[7-9][0-9][0-9][0-9]|9[0-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9][0-9]+)\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00030 M6 - A minimum password length must be set"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minChars"
          expect      : "^[^Mm][^Ii][^Nn][^Cc][^Hh][^Aa][^Rr][^Ss]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00030 M6 - A minimum password length must be set - 'Managed minChars >= 15'"
          info        : "Information systems not protected with strong password schemes including passwords of minimum length provide the opportunity for anyone to crack the password and gain access to the system, and cause the device, information, or the local network to be compromised or a Denial of Service."
          solution    : "Open a terminal session and use the following command to set the value for minimum password length.
sudo pwpolicy -n -setglobalpolicy 'minChars=15'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'minChars=15'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-37172r1_rule,SANS-CSC|16,STIG-ID|OSX00030-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25230"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minChars"
          expect      : "^[Mm][Ii][Nn][Cc][Hh][Aa][Rr][Ss]\\s*=\\s*(1[5-9]|[2-9][0-9]+)\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00030 M6 - A minimum password length must be set - 'Local minChars >= 15'"
          info        : "Information systems not protected with strong password schemes including passwords of minimum length provide the opportunity for anyone to crack the password and gain access to the system, and cause the device, information, or the local network to be compromised or a Denial of Service."
          solution    : "Open a terminal session and use the following command to set the value for minimum password length.
sudo pwpolicy -n -setglobalpolicy 'minChars=15'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'minChars=15'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-37172r1_rule,SANS-CSC|16,STIG-ID|OSX00030-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25230"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minChars"
          expect      : "^[Mm][Ii][Nn][Cc][Hh][Aa][Rr][Ss]\\s*=\\s*(1[5-9]|[2-9][0-9]+)\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00036 M6 - Complex passwords must contain Alphabetic Character"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresAlpha"
          expect      : "^[^Rr][^Ee][^Qq][^Uu][^Ii][^Rr][^Ee][^Ss][^Aa][^Ll][^Pp][^Hh][^Aa]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00036 M6 - Complex passwords must contain Alphabetic Character - 'Managed requiresAlpha = 1'"
          info        : "Configure the local system to verify newly created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Sites are responsible for installing password complexity software complying with the current DoD requirements."
          solution    : "Open a terminal session and run the following command.

sudo pwpolicy -n -setglobalpolicy 'requiresAlpha=1'

For non-managed systems the path /Local/Default would need to be added to the command, an example would be- sudo pwpolicy -n /Local/Default -setglobalpolicy 'requiresAlpha=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-38603r1_rule,SANS-CSC|16,STIG-ID|OSX00036-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-29437"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresAlpha"
          expect      : "^[Rr][Ee][Qq][Uu][Ii][Rr][Ee][Ss][Aa][Ll][Pp][Hh][Aa]\\s*=\\s*1\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00036 M6 - Complex passwords must contain Alphabetic Character - 'Local requiresAlpha = 1'"
          info        : "Configure the local system to verify newly created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Sites are responsible for installing password complexity software complying with the current DoD requirements."
          solution    : "Open a terminal session and run the following command.

sudo pwpolicy -n -setglobalpolicy 'requiresAlpha=1'

For non-managed systems the path /Local/Default would need to be added to the command, an example would be- sudo pwpolicy -n /Local/Default -setglobalpolicy 'requiresAlpha=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-38603r1_rule,SANS-CSC|16,STIG-ID|OSX00036-M6,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-29437"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresAlpha"
          expect      : "^[Rr][Ee][Qq][Uu][Ii][Rr][Ee][Ss][Aa][Ll][Pp][Hh][Aa]\\s*=\\s*1\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00038 M6 - Complex passwords must contain a Symbolic Character"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresSymbol"
          expect      : "^[^Rr][^Ee][^Qq][^Uu][^Ii][^Rr][^Ee][^Ss][^Ss][^Yy][^Mm][^Bb][^Oo][^Ll]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00038 M6 - Complex passwords must contain a Symbolic Character - 'Managed requiresSymbol = 1'"
          info        : "Configure the local system to verify newly created passwords conform to the DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Sites are responsible for installing password complexity software that complies with current DoD requirements."
          solution    : "Open a terminal session and run the following command.

sudo pwpolicy -n -setglobalpolicy 'requiresSymbol=1'

For non-managed systems the path /Local/Default would need to be added to the command, an example would be- sudo pwpolicy -n /Local/Default -setglobalpolicy 'requiresSymbol=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-38607r1_rule,SANS-CSC|16,STIG-ID|OSX00038-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-29439"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresSymbol"
          expect      : "^[Rr][Ee][Qq][Uu][Ii][Rr][Ee][Ss][Ss][Yy][Mm][Bb][Oo][Ll]\\s*=\\s*1\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00038 M6 - Complex passwords must contain a Symbolic Character - 'Local requiresSymbol = 1'"
          info        : "Configure the local system to verify newly created passwords conform to the DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters. Sites are responsible for installing password complexity software that complies with current DoD requirements."
          solution    : "Open a terminal session and run the following command.

sudo pwpolicy -n -setglobalpolicy 'requiresSymbol=1'

For non-managed systems the path /Local/Default would need to be added to the command, an example would be- sudo pwpolicy -n /Local/Default -setglobalpolicy 'requiresSymbol=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-38607r1_rule,SANS-CSC|16,STIG-ID|OSX00038-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-29439"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep requiresSymbol"
          expect      : "^[Rr][Ee][Qq][Uu][Ii][Rr][Ee][Ss][Ss][Yy][Mm][Bb][Oo][Ll]\\s*=\\s*1\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00040 M6 - Newly created password content must be checked"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep passwordCannotBeName"
          expect      : "^[^Pp][^Aa][^Ss][^Ss][^Ww][^Oo][^Rr][^Dd][^Cc][^Aa][^Nn][^Nn][^Oo][^Tt][^Bb][^Ee][^Nn][^Aa][^Mm][^Ee]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00040 M6 - Newly created password content must be checked - 'Managed passwordCannotBeName = 1'"
          info        : "Configure the local system to verify newly created passwords do not contain user's account name or parts of the user's full name exceeding two consecutive characters."
          solution    : "Open a terminal session and use the following command to set the value for 'password cannot be name'.
sudo pwpolicy -n -setglobalpolicy 'passwordCannotBeName=1'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'passwordCannotBeName=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-37177r1_rule,SANS-CSC|16,STIG-ID|OSX00040-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25238"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep passwordCannotBeName"
          expect      : "^[Pp][Aa][Ss][Ss][Ww][Oo][Rr][Dd][Cc][Aa][Nn][Nn][Oo][Tt][Bb][Ee][Nn][Aa][Mm][Ee]\\s*=\\s*1\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00040 M6 - Newly created password content must be checked - 'Local passwordCannotBeName = 1'"
          info        : "Configure the local system to verify newly created passwords do not contain user's account name or parts of the user's full name exceeding two consecutive characters."
          solution    : "Open a terminal session and use the following command to set the value for 'password cannot be name'.
sudo pwpolicy -n -setglobalpolicy 'passwordCannotBeName=1'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'passwordCannotBeName=1'"
          reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-37177r1_rule,SANS-CSC|16,STIG-ID|OSX00040-M6,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25238"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep passwordCannotBeName"
          expect      : "^[Pp][Aa][Ss][Ss][Ww][Oo][Rr][Dd][Cc][Aa][Nn][Nn][Oo][Tt][Bb][Ee][Nn][Aa][Mm][Ee]\\s*=\\s*1\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00045 M6 - Account lockout duration must be properly configured"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minutesUntilFailedLoginReset"
          expect      : "^[^Mm][^Ii][^Nn][^Uu][^Tt][^Ee][^Ss][^Uu][^Nn][^Tt][^Ii][^Ll][^Ff][^Aa][^Ii][^Ll][^Ee][^Dd][^Ll][^Oo][^Gg][^Ii][^Nn][^Rr][^Ee][^Ss][^Ee][^Tt]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00045 M6 - Account lockout duration must be properly configured - 'Managed minutesUntilFailedLoginReset = 0'"
          info        : "This parameter specifies the amount of time that must pass between two successive login attempts to ensure a lockout will occur. The smaller this value is, the less effective the account lockout feature will be in protecting the local system."
          solution    : "Open a terminal session and use the following command to set the value for account lockout duration.
sudo pwpolicy -n -setglobalpolicy 'minutesUntilFailedLoginReset=0'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'minutesUntilFailedLoginReset=0'"
          reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-37184r1_rule,SANS-CSC|16,STIG-ID|OSX00045-M6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-25240"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minutesUntilFailedLoginReset"
          expect      : "^[Mm][Ii][Nn][Uu][Tt][Ee][Ss][Uu][Nn][Tt][Ii][Ll][Ff][Aa][Ii][Ll][Ee][Dd][Ll][Oo][Gg][Ii][Nn][Rr][Ee][Ss][Ee][Tt]\\s*=\\s*0\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00045 M6 - Account lockout duration must be properly configured - 'Local minutesUntilFailedLoginReset = 0'"
          info        : "This parameter specifies the amount of time that must pass between two successive login attempts to ensure a lockout will occur. The smaller this value is, the less effective the account lockout feature will be in protecting the local system."
          solution    : "Open a terminal session and use the following command to set the value for account lockout duration.
sudo pwpolicy -n -setglobalpolicy 'minutesUntilFailedLoginReset=0'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'minutesUntilFailedLoginReset=0'"
          reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-37184r1_rule,SANS-CSC|16,STIG-ID|OSX00045-M6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-25240"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep minutesUntilFailedLoginReset"
          expect      : "^[Mm][Ii][Nn][Uu][Tt][Ee][Ss][Uu][Nn][Tt][Ii][Ll][Ff][Aa][Ii][Ll][Ee][Dd][Ll][Oo][Gg][Ii][Nn][Rr][Ee][Ss][Ee][Tt]\\s*=\\s*0\\s*$"
        </custom_item>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00050 M6 - Account lockout threshold must be properly configured"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxFailedLoginAttempts"
          expect      : "^[^Mm][^Aa][^Xx][^Ff][^Aa][^Ii][^Ll][^Ee][^Dd][^Ll][^Oo][^Gg][^Ii][^Nn][^Aa][^Tt][^Tt][^Ee][^Mm][^Pp][^Tt][^Ss]"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00050 M6 - Account lockout threshold must be properly configured - 'Managed maxFailedLoginAttempts <= 3'"
          info        : "The account lockout feature, when enabled, prevents brute-force password attacks on the system. The higher this value is, the less effective the account lockout feature will be in protecting the local system. The number of incorrect logon attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user logon."
          solution    : "Open a terminal session and use the following command to set the value for account lockout threshold.
sudo pwpolicy -n -setglobalpolicy 'maxFailedLoginAttempts=3'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'maxFailedLoginAttempts=3'"
          reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-37186r1_rule,SANS-CSC|16,STIG-ID|OSX00050-M6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-25241"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxFailedLoginAttempts"
          expect      : "^[Mm][Aa][Xx][Ff][Aa][Ii][Ll][Ee][Dd][Ll][Oo][Gg][Ii][Nn][Aa][Tt][Tt][Ee][Mm][Pp][Tt][Ss]\\s*=\\s*[1-3]\\s*$"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00050 M6 - Account lockout threshold must be properly configured - 'Local maxFailedLoginAttempts <= 3'"
          info        : "The account lockout feature, when enabled, prevents brute-force password attacks on the system. The higher this value is, the less effective the account lockout feature will be in protecting the local system. The number of incorrect logon attempts should be reasonably small to minimize the possibility of a successful password attack, while allowing for honest errors made during a normal user logon."
          solution    : "Open a terminal session and use the following command to set the value for account lockout threshold.
sudo pwpolicy -n -setglobalpolicy 'maxFailedLoginAttempts=3'

NOTE- For non-managed system, use the following command.

pwpolicy -n /Local/Default -setglobalpolicy 'maxFailedLoginAttempts=3'"
          reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-37186r1_rule,SANS-CSC|16,STIG-ID|OSX00050-M6,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-25241"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy | /usr/bin/tr \" \" \"\n\" | /usr/bin/grep maxFailedLoginAttempts"
          expect      : "^[Mm][Aa][Xx][Ff][Aa][Ii][Ll][Ee][Dd][Ll][Oo][Gg][Ii][Nn][Aa][Tt][Tt][Ee][Mm][Pp][Tt][Ss]\\s*=\\s*[1-3]\\s*$"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00055 M6 - All application software must be current"
      info        : "Major software vendors release security patches and hot fixes to their products when security vulnerabilities are discovered. It is essential these updates be applied in a timely manner to prevent unauthorized persons from exploiting identified vulnerabilities. If the application software is no longer supported it should be updated or removed."
      solution    : "Install current software updates and patches.

NOTE- Do not enable Automatic Updating as this will conflict with V-25298."
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|VIVM-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-37190r1_rule,SANS-CSC|4,STIG-ID|OSX00055-M6,SWIFT-CSCv1|2.2,Vuln-ID|V-25251"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/softwareupdate --list --all | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00060 M6 - Wi-Fi support software must be disabled - '/System/Library/Extensions/IO80211Family.kext does not exist'"
      info        : "Many organizations restrict the use of wireless technology in their network environment. However, most Mac computers have wireless capability built-in and simply turning it off may not meet the organization's wireless technology restrictions. Components may need to be removed from Mac OS X to disable them from being turned on in System Preferences. Although wireless technology gives a network more flexibility with its users, it can also cause security vulnerabilities most may be unaware of. It is recommended wherever possible, wireless access is disabled for security reasons. IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands.

srm -rf /System/Library/Extensions/IO80211Family.kext

touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|11.1,Rule-ID|SV-37193r1_rule,SANS-CSC|3,STIG-ID|OSX00060-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25252"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/IO80211Family.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00065 M6 - Bluetooth support software must be disabled - '/System/Library/Extensions/IOBluetoothFamily.kext does not exist'"
      info        : "Bluetooth technology and associated devices are susceptible to general wireless networking threats, such as Denial of Service attacks, eavesdropping, man-in-the-middle attacks, message modification, and resource misappropriation. Remove Bluetooth support for peripherals such as keyboards, mice, or phones. This task requires administrator privileges. IMPORTANT- Repeat these instructions every time a system update is installed. Support should be removed at kext level."
      solution    : "Open a terminal session and enter the following commands to remove the files.

srm -rf /System/Library/Extensions/IOBluetoothFamily.kext

srm -rf /System/Library/Extensions/IOBluetoothHIDDriver.kext

sudo touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37198r1_rule,SANS-CSC|3,STIG-ID|OSX00065-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25253"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/IOBluetoothFamily.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00065 M6 - Bluetooth support software must be disabled - '/System/Library/Extensions/IOBluetoothHIDDriver.kext does not exist'"
      info        : "Bluetooth technology and associated devices are susceptible to general wireless networking threats, such as Denial of Service attacks, eavesdropping, man-in-the-middle attacks, message modification, and resource misappropriation. Remove Bluetooth support for peripherals such as keyboards, mice, or phones. This task requires administrator privileges. IMPORTANT- Repeat these instructions every time a system update is installed. Support should be removed at kext level."
      solution    : "Open a terminal session and enter the following commands to remove the files.

srm -rf /System/Library/Extensions/IOBluetoothFamily.kext

srm -rf /System/Library/Extensions/IOBluetoothHIDDriver.kext

sudo touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37198r1_rule,SANS-CSC|3,STIG-ID|OSX00065-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25253"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/IOBluetoothHIDDriver.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 M6 - Audio recording support software must be disabled - '/System/Library/Extensions/AppleUSBAudio.kext does not exist'"
      info        : "A computer might be in an environment where recording devices, such as cameras or microphones are not permitted. Protect the organization's privacy by disabling these devices. Remove support for the audio subsystem. This may disable audio playback. IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands.

srm -rf /System/Library/Extensions/AppleUSBAudio.kext

srm -rf /System/Library/Extensions/IOAudioFamily.kext

touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-38509r1_rule,SANS-CSC|3,STIG-ID|OSX00070-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/AppleUSBAudio.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 M6 - Audio recording support software must be disabled - '/System/Library/Extensions/IOAudioFamily.kext does not exist'"
      info        : "A computer might be in an environment where recording devices, such as cameras or microphones are not permitted. Protect the organization's privacy by disabling these devices. Remove support for the audio subsystem. This may disable audio playback. IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands.

srm -rf /System/Library/Extensions/AppleUSBAudio.kext

srm -rf /System/Library/Extensions/IOAudioFamily.kext

touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-38509r1_rule,SANS-CSC|3,STIG-ID|OSX00070-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/IOAudioFamily.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00075 M6 - Video recording support software must be disabled - '/System/Library/Extensions/Apple_iSight.kext does not exist'"
      info        : "A computer might be in an environment where recording devices, such as cameras or microphones, are not permitted. Protect the organization's privacy by disabling these devices. Remove support for an external or built-in iSight camera.
NOTE- The support for external iSight cameras should be removed on all machines. Removing only support for internal iSight cameras would still leave support for external cameras available. An Apple Authorized Technician can also remove the built-in video camera hardware from an Apple computer.
IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files.

sudo srm -rf /System/Library/Extensions/Apple_iSight.kext
sudo srm -rf /System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext

sudo touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37201r1_rule,SANS-CSC|3,STIG-ID|OSX00075-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25255"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/Apple_iSight.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00075 M6 - Video recording software must be disabled - 'AppleUSBVideoSupport.kext does not exist'"
      info        : "A computer might be in an environment where recording devices, such as cameras or microphones, are not permitted. Protect the organization's privacy by disabling these devices. Remove support for an external or built-in iSight camera.
NOTE- The support for external iSight cameras should be removed on all machines. Removing only support for internal iSight cameras would still leave support for external cameras available. An Apple Authorized Technician can also remove the built-in video camera hardware from an Apple computer.
IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files.

sudo srm -rf /System/Library/Extensions/Apple_iSight.kext
sudo srm -rf /System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext

sudo touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37201r1_rule,SANS-CSC|3,STIG-ID|OSX00075-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25255"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00090 M6 - Infrared (IR) support must be removed - '/System/Library/Extensions/AppleIRController.kext does not exist'"
      info        : "To prevent unauthorized users from controlling a computer through the infrared receiver, remove IR hardware support. This task requires administrator privileges. An Apple Authorized Technician can also remove IR hardware from an Apple computer.
IMPORTANT- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the file.

srm -rf /System/Library/Extensions/AppleIRController.kext

sudo touch /System/Library/Extensions

NOTE- Repeat these instructions every time a system update is installed."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37206r1_rule,SANS-CSC|3,STIG-ID|OSX00090-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25258"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/Extensions/AppleIRController.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00095 M6 - An Extensible Firmware Interface (EFI) password must be used - 'security-mode command'"
      info        : "When a computer starts up, it first starts Extensible Firmware Interface (EFI). EFI is the
software link between the motherboard hardware and the software operating system.
EFI determine which partition or disk to load Mac OS X from. It also determines
whether the user can enter single-user mode. Not setting a password for EFI is a possible point of intrusion. Protecting it from unauthorized access can prevent attackers from gaining access to a computer."
      solution    : "Log in with an administrator account and open the Firmware Password Utility (located on the Mac OS X installation disc in /Applications/Utilities/).

Click New.

Select 'Require password to start this computer from another source'.

In the Password and Verify fields, enter a new EFI password and click OK.

Close the Firmware Password Utility."
      reference   : "800-53|SI-7,8500.2|ECSC-1,CAT|I,CSF|PR.DS-6,PCI-DSS|2.2.3,Rule-ID|SV-38510r1_rule,SANS-CSC|3,STIG-ID|OSX00095-M6,Vuln-ID|V-25259"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/nvram -p"
      expect      : "security-mode.+command"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00100 M6 - Access warning for the login window must be present - 'LoginwindowText is configured'"
      info        : "Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources. A login window or Terminal access warning can be used to provide notice of a computer's ownership, to warn against unauthorized access, or to remind authorized users of their consent to monitoring."
      solution    : "Open a terminal session and enter the following command.
sudo defaults write /Library/Preferences/com.apple.loginwindow LoginwindowText 'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions-

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests-not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

Log off the system and verify the banner is displayed at the login screen."
      reference   : "800-171|3.1.9,800-53|AC-8,8500.2|ECWM-1,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-38556r1_rule,SANS-CSC|7,STIG-ID|OSX00100-M6,Vuln-ID|V-25260"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow LoginwindowText"
      expect      : "^.You are accessing a U\.S\. Government \(USG\) Information System \(IS\) that is provided for USG-authorized use only\.\\n+By using this IS \(which includes any device attached to this IS\), you consent to the following conditions:\\n+-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct \(PM\), law enforcement \(LE\), and counterintelligence \(CI\) investigations\.\\n+-At any time, the USG may inspect and seize data stored on this IS\.\\n+-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose\.\\n+-This IS includes security measures \(e\.g\., authentication and access controls\) to protect USG interests.+not for your personal benefit or privacy\.\\n+-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants\. Such communications and work product are private and confidential\. See User Agreement for details\..$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : BANNER_CHECK
      description : "OSX00105 M6 - Access warning for the command line must be present - 'LoginwindowText is configured'"
      info        : "Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources. When a user opens a terminal locally or connects to the computer remotely, the user sees the access warning."
      solution    : "1. Open a terminal session
2. Verify the /etc/motd file exists. If not, use the touch command to create the file.
3. Edit the file and enter the appropriate DoD warning banner information.
4. Save the file.
5. Open a new terminal session and verify the banner is displayed."
      reference   : "800-171|3.1.9,800-53|AC-8,8500.2|ECWM-1,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-38513r1_rule,SANS-CSC|7,STIG-ID|OSX00105-M6,Vuln-ID|V-25261"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/motd"
# Note: Variable @BANNER_TEXT@ replaced with "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." in field "content".
      content     : "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00110 M6 - sudo usage must be restricted to a single terminal, and for only one instance - '/etc/sudoers - Defaults tty_tickets exists'"
      info        : "Do not allow direct root login because the logs cannot identify which administrator logged in. Instead, log in using accounts with administrator privileges, and then use the sudo command to perform actions as root. These limit the use of the sudo command to a single command per authentication and also ensure, even if a timeout is activated, that later sudo commands are limited to the terminal in which authentication occurred."
      solution    : "Open a terminal session and enter the following commands to set the values in the /etc/sudoers file.

VISUAL=pico visudo

Enter the following two lines in the file.

Defaults tty_tickets
Defaults timestamp_timeout=0

Save and exit the file."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii),PCI-DSS|2.2.3,Rule-ID|SV-38614r1_rule,SANS-CSC|3,STIG-ID|OSX00110-M6,Vuln-ID|V-25262"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/sudoers"
      regex       : "^\\s*[Dd]efaults[\\s\\t]+tty_tickets"
      expect      : "^\\s*[Dd]efaults[\\s\\t]+tty_tickets\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00110 M6 - sudo usage must be restricted to a single terminal, and for only one instance - '/etc/sudoers - Defaults timestamp_timeout=0'"
      info        : "Do not allow direct root login because the logs cannot identify which administrator logged in. Instead, log in using accounts with administrator privileges, and then use the sudo command to perform actions as root. These limit the use of the sudo command to a single command per authentication and also ensure, even if a timeout is activated, that later sudo commands are limited to the terminal in which authentication occurred."
      solution    : "Open a terminal session and enter the following commands to set the values in the /etc/sudoers file.

VISUAL=pico visudo

Enter the following two lines in the file.

Defaults tty_tickets
Defaults timestamp_timeout=0

Save and exit the file."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii),PCI-DSS|2.2.3,Rule-ID|SV-38614r1_rule,SANS-CSC|3,STIG-ID|OSX00110-M6,Vuln-ID|V-25262"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/sudoers"
      regex       : "^\\s*[Dd]efaults[\\s\\t]+timestamp_timeout\\s*="
      expect      : "^\\s*[Dd]efaults[\\s\\t]+timestamp_timeout\\s*=\\s*0\\s*$"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00120 M6 - LDAPv3 access must be securely configured (if it is used)"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00120 M6 - LDAPv3 access must be securely configured (if it is used)"
          info        : "When configuring LDAPv3, do not add DHCP-supplied LDAP servers to automatic search policies if the network the computer is running on is not secure. If the network is unsecure, someone can create a rogue DHCP. Use authentication when connecting to LDAPv3 directories; disable clear text passwords for all LDAPv3 directories; digitally sign all LDAPv3 packets (requires Kerberos); encrypt all LDAPv3 packets (requires SSL or Kerberos); and block man-in-the-middle attacks (requires Kerberos)."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Use authentication when connecting'."
          reference   : "800-53|IA-3,8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38516r1_rule,SANS-CSC|17,STIG-ID|OSX00120-M6,Vuln-ID|V-25264"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep -A1 '[Pp]ort [Nn]umber' | /usr/bin/egrep -v '([Pp]ort|[Ss][Ss][Ll]|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00115 M6 - LDAPv3 access must be securely configured (if it is used)"
          info        : "When configuring LDAPv3, do not add DHCP supplied LDAP servers to automatic search policies if the network the computer is running on is not secure. If the network is unsecure, someone can create a rogue DHCP."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click the Connection tab and select 'Encrypt using SSL'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38514r1_rule,SANS-CSC|17,STIG-ID|OSX00115-M6,Vuln-ID|V-25263"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep '[Ss][Ss][Ll]' | /usr/bin/egrep -v '^[ ]*[Ss][Ss][Ll][ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00120 M6 - LDAP Authentication must use authentication when connecting to LDAPv3"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00120 M6 - Clear text passwords for all LDAPv3 directories must be disabled"
          info        : "When configuring LDAPv3, do not add DHCP-supplied LDAP servers to automatic search policies if the network the computer is running on is not secure. If the network is unsecure, someone can create a rogue DHCP. Use authentication when connecting to LDAPv3 directories; disable clear text passwords for all LDAPv3 directories; digitally sign all LDAPv3 packets (requires Kerberos); encrypt all LDAPv3 packets (requires SSL or Kerberos); and block man-in-the-middle attacks (requires Kerberos)."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Use authentication when connecting'."
          reference   : "800-53|IA-3,8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38516r1_rule,SANS-CSC|17,STIG-ID|OSX00120-M6,Vuln-ID|V-25264"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A1 '[Ss]earch[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Ss]econds' | /usr/bin/egrep -v '([Ss]earch[ ]+[Tt]imeout|[Ss]ecure[ ]+[Uu]se|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00120 M6 - LDAP Authentication must use authentication when connecting to LDAPv3"
          info        : "When configuring LDAPv3, do not add DHCP-supplied LDAP servers to automatic search policies if the network the computer is running on is not secure. If the network is unsecure, someone can create a rogue DHCP. Use authentication when connecting to LDAPv3 directories; disable clear text passwords for all LDAPv3 directories; digitally sign all LDAPv3 packets (requires Kerberos); encrypt all LDAPv3 packets (requires SSL or Kerberos); and block man-in-the-middle attacks (requires Kerberos)."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Use authentication when connecting'."
          reference   : "800-53|IA-3,8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38516r1_rule,SANS-CSC|17,STIG-ID|OSX00120-M6,Vuln-ID|V-25264"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep '^[ ]*\\\"[Ss]ecure[ ]+[Uu]se\\\"[ ]*=' | /usr/bin/egrep -v '^[ ]*\\\"[Ss]ecure[ ]+[Uu]se\\\"[ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00121 M6 - Clear text passwords for all LDAPv3 directories must be disabled"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00121 M6 - Clear text passwords for all LDAPv3 directories must be disabled"
          info        : "Allowing passwords to be transmitted over the network in clear text could allow an attacker to monitor the network and capture the password packets.  This clear text function must be disabled when accessing LDAPv3 directories."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click the Security tab and select 'Disable clear text passwords'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38573r1_rule,SANS-CSC|17,STIG-ID|OSX00121-M6,Vuln-ID|V-25557"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A3 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep -v '([Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes|[Ll]ocal[ ]+[Ss]ecurity[ ]+[Ll]evel|[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle|[Nn]o[ ]+[Cc]lear[Tt]ext[ ]+[Aa]uthentications|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00121 M6 - Clear text passwords for all LDAPv3 directories must be disabled - No ClearText Authentications = 1"
          info        : "Allowing passwords to be transmitted over the network in clear text could allow an attacker to monitor the network and capture the password packets.  This clear text function must be disabled when accessing LDAPv3 directories."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click the Security tab and select 'Disable clear text passwords'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|I,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38573r1_rule,SANS-CSC|17,STIG-ID|OSX00121-M6,Vuln-ID|V-25557"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A3 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep '^[ ]*\\\"[Nn]o[ ]+[Cc]lear[Tt]ext[ ]+[Aa]uthentications\\\"[ ]*=' | /usr/bin/egrep -v '^[ ]*\\\"[Nn]o[ ]+[Cc]lear[Tt]ext[ ]+[Aa]uthentications\\\"[ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00122 M6 - All LDAPv3 packets must be digitally signed"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00122 M6 - All LDAPv3 packets must be digitally signed"
          info        : "To protect the data between the client and LDAPv3 directory the traffic should be digitally signed."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Digitally sign all packets (requires Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38575r1_rule,SANS-CSC|17,STIG-ID|OSX00122-M6,Vuln-ID|V-25559"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A5 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep -v '([Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes|[Ll]ocal[ ]+[Ss]ecurity[ ]+[Ll]evel|[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle|[Nn]o[ ]+[Cc]lear[Tt]ext[ ]+[Aa]uthentications|[Pp]acket[ ]+[Ee]ncryption|[Pp]acket[ ]+[Ss]igning|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00122 M6 - All LDAPv3 packets must be digitally signed - Packet Signing = 1"
          info        : "To protect the data between the client and LDAPv3 directory the traffic should be digitally signed."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Digitally sign all packets (requires Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38575r1_rule,SANS-CSC|17,STIG-ID|OSX00122-M6,Vuln-ID|V-25559"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A5 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep '^[ ]*\\\"[Pp]acket[ ]+[Ss]igning\\\"[ ]*=' | /usr/bin/egrep -v '^[ ]*\\\"[Pp]acket[ ]+[Ss]igning\\\"[ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00123 M6 - All LDAPv3 packets must be encrypted"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00123 M6 - All LDAPv3 packets must be encrypted"
          info        : "All traffic between the client and the LDAPv3 should be encrypted to ensure confidentiality of data."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Encrypt all packets (requires SSL or Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38577r1_rule,SANS-CSC|17,STIG-ID|OSX00123-M6,Vuln-ID|V-25561"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A4 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep -v '([Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes|[Ll]ocal[ ]+[Ss]ecurity[ ]+[Ll]evel|[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle|[Nn]o[ ]+[Cc]lear[Tt]ext[ ]+[Aa]uthentications|[Pp]acket[ ]+[Ee]ncryption|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00123 M6 - All LDAPv3 packets must be encrypted - Packet Encryption = 1"
          info        : "All traffic between the client and the LDAPv3 should be encrypted to ensure confidentiality of data."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click on Security tab and select 'Encrypt all packets (requires SSL or Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38577r1_rule,SANS-CSC|17,STIG-ID|OSX00123-M6,Vuln-ID|V-25561"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A4 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep '^[ ]*\\\"[Pp]acket[ ]+[Ee]ncryption\\\"[ ]*=' | /usr/bin/egrep -v '^[ ]*\\\"[Pp]acket[ ]+[Ee]ncryption\\\"[ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00124 M6 - LDAPv3 must block man-in-the-middle attacks"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/grep 'Configuration UUID' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "\\s*.[Cc]onfiguration\\s+[Uu][Uu][Ii][Dd].\\s*="
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00124 M6 - LDAPv3 must block man-in-the-middle attacks"
          info        : "To prevent LDAPv3 man-in-the middle attacks the system must be properly configured."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click the Security tab and select 'Block man-in-the-middle attacks (requires Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38578r1_rule,SANS-CSC|17,STIG-ID|OSX00124-M6,Vuln-ID|V-25563"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A2 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep -v '([Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes|[Ll]ocal[ ]+[Ss]ecurity[ ]+[Ll]evel|[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle|--)' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>

        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00124 M6 - LDAPv3 must block man-in-the-middle attacks - Man in the Middle = 1"
          info        : "To prevent LDAPv3 man-in-the middle attacks the system must be properly configured."
          solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Show Advanced Options button.
Click Services tab.
Click the Lock and enter the password to unlock the options (if needed).
Click the LDAPv3 service.
Click the Pencil icon.
Highlight the Server Name/Configuration Name.
Click Edit.
Click the Security tab and select 'Block man-in-the-middle attacks (requires Kerberos)'."
          reference   : "800-53|IA-3,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,CSF|PR.AC-1,ITSG-33|IA-3,NESA|T5.4.3,Rule-ID|SV-38578r1_rule,SANS-CSC|17,STIG-ID|OSX00124-M6,Vuln-ID|V-25563"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/DSLDAPv3PlugInConfig | /usr/bin/egrep -A2 '[Ii]dle[ ]+[Tt]imeout[ ]+[Ii]n[ ]+[Mm]inutes' | /usr/bin/egrep '^[ ]*\\\"[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle\\\"[ ]*=' | /usr/bin/egrep -v '^[ ]*\\\"[Mm]an[ ]+[Ii]n[ ]+[Tt]he[ ]+[Mm]iddle\\\"[ ]*=[ ]*1' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
          expect      : "none"
        </custom_item>
      </then>
    </if>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00125 M6 - Active Directory Access must be securely configured"
      info        : "The 'Allow administration by' setting should not be used in sensitive environments. It can cause unintended privilege escalation issues because any member of the group specified will have administrator privileges on a computer."
      solution    : "Open Finder.
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Services tab.
Double Click on Active Directory.
Click on Show Advanced Options.
Click on Administrative tab and deselect 'Allow administration by' option."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-38518r1_rule,SANS-CSC|17,STIG-ID|OSX00125-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-25265"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/DirectoryService/ActiveDirectory | /usr/bin/egrep '[Aa][Dd][ ]+[Aa]llow[ ]+[Dd]omain[ ]+[Aa]dmin' | /usr/bin/egrep -v '^[ ]*\\\"[Aa][Dd][ ]+[Aa]llow[ ]+[Dd]omain[ ]+[Aa]dmin\\\"[ ]*=[ ]*0' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <item>
      system      : "Darwin"
      description : "OSX00135 M6 - POSIX access permissions must be assigned based on user categories"
      info        : "POSIX access permissions must be assigned based on user categories. Changing permissions on a user's home directory from 750 to 700 will disable Apple file sharing. User's home directory POSIX permissions should be set to 700."
      solution    : "Open a terminal session and enter the following command.

sudo chmod 700 <user's home directory>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-37208r1_rule,SANS-CSC|3,STIG-ID|OSX00135-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25267"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      name        : "accounts_bad_home_permissions"
      mask        : "077"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00140 M6 - Security auditing must be enabled - 'com.apple.auditd is loaded'"
      info        : "Auditing is the capture and maintenance of information about security-related events. Auditing helps determine the causes and the methods used for successful and failed access attempts."
      solution    : "Open a terminal session and run the following command.

sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.auditd.plist"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-38520r1_rule,SANS-CSC|14,STIG-ID|OSX00140-M6,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25268"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.auditd"
      expect      : "^.*\\s+com\.apple\.auditd\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00145 M6 - Security auditing must be configured - 'FLAGS = LO,AD,-ALL,-FR,FD,FM,^-FA,^-FC,^-CL'"
      info        : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions, and analyze compromises or attacks that have occurred, has begun, or is about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised. Without an audit trail providing information as to what occurred and if it was successful or unsuccessful, it is difficult to analyze a series of events to determine the steps used by an attacker to compromise a system or network, or what exactly happened that led to a Denial of Service. Collecting data such as the successful and unsuccessful events is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution    : "Open a terminal session and edit the /etc/security/audit_control file.
Find the line beginning with 'flags'.
Replace that line with the following- flags-lo,ad,-all,-fr,fd,fm,^-fa,^-fc,^-cl.
Save the file."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-38521r1_rule,SANS-CSC|14,STIG-ID|OSX00145-M6,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25269"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/security/audit_control"
      regex       : "^\\s*[Ff][Ll][Aa][Gg][Ss]\\s*:"
      expect      : "^\\s*[Ff][Ll][Aa][Gg][Ss]\\s*:\\s*[Ll][Oo],[Aa][Dd],-[Aa][Ll][Ll],-[Ff][Rr],[Ff][Dd],[Ff][Mm],\\^-[Ff][Aa],\\^-[Ff][Cc],\\^-[Cc][Ll]\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00150 M6 - Local logging must be enabled"
      info        : "Logging is essential for tracking system events, in the event of unauthorized access, logs may contain information about how and when the access occurred. Ensure logging is enabled and log files are properly rotated. The default configuration in /etc/newsyslog.conf is used to configure local logging in the /var/log folder. The computer is set to rotate log files using the periodic launchd job according to time intervals specified in the /etc/newsyslog.conf file."
      solution    : "Open a terminal session and edit the following file and set the count value(s) to '14'.

/etc/newsyslog.conf"
      reference   : "800-53|AU-11,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,Rule-ID|SV-38522r1_rule,SANS-CSC|14,STIG-ID|OSX00150-M6,Vuln-ID|V-25270"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/newsyslog.conf"
      regex       : "^\\s*\/[A-Za-z0-9/.]+\\s+[0-9]{3}\\s+[0-9]+"
      expect      : "^\\s*[A-Za-z0-9/.]+\\s+[0-9]{3}\\s+14"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00155 M6 - Remote logging must be enabled"
      info        : "In addition to local logging, remote logging must also be enabled. Local logs can be altered if the computer is compromised. Remote logging mitigates the risk of having the logs altered."
      info        : "NOTE: Update LOG_SERVER with the address of the syslog server for the local environment"
      solution    : "Open a terminal session and enter the following command.

sudo pico /etc/syslog.conf

Add the following line to the top of the file, replacing 'your.log.server' with the name or IP address of the log server, and keeping all other lines intact.
*.* @your.log.server
Exit, saving changes.
Reboot the system."
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CSF|PR.PT-1,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-38523r1_rule,SANS-CSC|14,STIG-ID|OSX00155-M6,Vuln-ID|V-25271"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/syslog.conf"
      regex       : "^\\s*\\*\.\\*\\s+@"
# Note: Variable @LOG_SERVER@ replaced with "example\\\\.log\\\\.server" in field "expect".
      expect      : "^\\s*\\*\.\\*\\s+@example\\\\.log\\\\.server\\s*$"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00160 M6 - An antivirus tool must be installed"
      info        : "Installing antivirus tools helps prevent virus infection on a computer, and helps prevent a computer from becoming a host used to spread viruses to other computers. These tools quickly identify suspicious content and compare them to known malicious content. See the https-//www.cybercom.mil web site for approved antivirus tools.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Install an approved antivirus tool on the system."
      reference   : "8500.2|ECVP-1,CAT|I,Rule-ID|SV-38524r1_rule,SANS-CSC|5,STIG-ID|OSX00160-M6,Vuln-ID|V-25272"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00165 M6 - Prevent root login must be securely configured in /etc/sshd_config - 'PermitRootLogin NO'"
      info        : "Prevents logging in as root through SSH. This should be set for all SSH methods of authenticating."
      solution    : "Open a terminal session and enter the following command.

sudo pico /etc/sshd_config

Edit the value 'PermitRootLogin' and set it to 'No'.
Save the file."
      reference   : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17,8500.2|COBR-1,8500.2|ECPA-1,CAT|II,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,PCI-DSS|2.2.3,Rule-ID|SV-38525r1_rule,SANS-CSC|12,SANS-CSC|8,STIG-ID|OSX00165-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-25273"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/sshd_config"
      regex       : "^\\s*[Pp][Ee][Rr][Mm][Ii][Tt][Rr][Oo][Oo][Tt][Ll][Oo][Gg][Ii][Nn]\\s+"
      expect      : "^\\s*[Pp][Ee][Rr][Mm][Ii][Tt][Rr][Oo][Oo][Tt][Ll][Oo][Gg][Ii][Nn]\\s+[Nn][Oo]\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00170 M6 - Login Grace Time must be securely configured in /etc/sshd_config - 'LoginGraceTime < 30'"
      info        : "This setting controls the time allowed to authenticate over an SSH connection. It is recommended the value be set to 30 seconds or less. By allowing a connection to stay open for longer periods of time could allow an attacker to take advantage of the port."
      solution    : "Open a terminal session and enter the following command.

sudo pico /etc/sshd_config

Edit the value 'LoginGraceTime' and set it to '30'.
Save the file."
      reference   : "800-171|3.1.11,800-53|AC-12,8500.2|ECSC-1,CAT|III,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,Rule-ID|SV-38526r1_rule,SANS-CSC|3,STIG-ID|OSX00170-M6,Vuln-ID|V-25274"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/sshd_config"
      regex       : "^\\s*[Ll][Oo][Gg][Ii][Nn][Gg][Rr][Aa][Cc][Ee][Tt][Ii][Mm][Ee]\\s+"
      expect      : "^\\s*[Ll][Oo][Gg][Ii][Nn][Gg][Rr][Aa][Cc][Ee][Tt][Ii][Mm][Ee]\\s+(30|[1-2][0-9]|[0-9])\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00175 M6 - /etc/sshd_config - Protocol version must be securely configured - 'Protocol 2'"
      info        : "Restricts OpenSSH so it uses only SSH Protocol 2. This should be set for all SSH methods of authenticating."
      solution    : "1. Open a terminal session and enter the following command.

sudo pico /etc/sshd_config

2. Edit the value 'Protocol' and set it to '2'.
3. Save the file."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,Rule-ID|SV-37209r1_rule,SANS-CSC|3,STIG-ID|OSX00175-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25275"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/sshd_config"
      regex       : "^\\s*[Pp][Rr][Oo][Tt][Oo][Cc][Oo][Ll]\\s+"
      expect      : "^\\s*[Pp][Rr][Oo][Tt][Oo][Cc][Oo][Ll]\\s+2\\s*$"
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CONTENT_CHECK
      description     : "OSX00180 M6 - SSH must not allow empty passwords - 'PermitEmptyPasswords NO'"
      info            : "Denies access to accounts without passwords. This should be set for all SSH methods of authenticating."
      solution        : "Open a terminal session and edit the following file.

/etc/sshd_config

Set the value of PermitEmptyPasswords to No."
      reference       : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSS|2.2.3,Rule-ID|SV-40699r1_rule,SANS-CSC|3,STIG-ID|OSX00180-M6,Vuln-ID|V-25276"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/etc/sshd_config"
      regex           : "^\\s*[Pp][Ee][Rr][Mm][Ii][Tt][Ee][Mm][Pp][Tt][Yy][Pp][Aa][Ss][Ss][Ww][Oo][Rr][Dd][Ss]\\s+"
      expect          : "^\\s*[Pp][Ee][Rr][Mm][Ii][Tt][Ee][Mm][Pp][Tt][Yy][Pp][Aa][Ss][Ss][Ww][Oo][Rr][Dd][Ss]\\s+[Nn][Oo]\\s*$"
      string_required : NO
    </custom_item>

    <custom_item>
      system          : "Darwin"
      type            : FILE_CHECK_NOT
      description     : "OSX00190 M6 - The MobileMe preference pane must be removed from System Preferences - 'MobileMe.prefPane does not exist'"
      info            : "Remove the MobileMe preference pane from System Preferences. MobileMe is a suite of Internet tools capable of synchronizing data and other important information while an individual is away from the computer, sensitive environments do not use MobileMe. If critical data must be stored, only store it on a local computer. Data should only be transferred over a secure network connection to a secure internal server. If MobileMe is used, enable it only for user accounts without access to critical data. It is not recommended to enable MobileMe for administrator or root user accounts."
      solution        : "Open a terminal session and enter the following command to remove the file.

sudo rm -R /System/Library/PreferencePanes/MobileMe.prefPane"
      reference       : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-38527r1_rule,SANS-CSC|3,STIG-ID|OSX00190-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25278"
      see_also        : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file            : "/System/Library/PreferencePanes/MobileMe.prefPane"
      string_required : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00195 M6 - The Software Update Server URL must be assigned to an organizational value - 'CatalogURL is configured'"
      info        : "A computer can look for software updates on an internal software update server (SUS). Using an internal software update server reduces the amount of data transferred outside of the network. The organization can control which updates can be installed on a computer."
      info        : "NOTE: Update the SOFTWARE_UPDATE_URL variable with the appropriate value for the local environment"
      solution    : "Open a terminal session and enter the following command.

defaults write com.apple.SoftwareUpdate CatalogURL 'new_SUS_URL'

(Where 'new_SUS_URL' is the URL or the address of the appropriate government SUS to be used.)"
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|VIVM-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,NIAv2|NS26b,Rule-ID|SV-38528r1_rule,SANS-CSC|4,STIG-ID|OSX00195-M6,SWIFT-CSCv1|2.2,Vuln-ID|V-25279"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate CatalogURL"
# Note: Variable @SOFTWARE_UPDATE_URL@ replaced with "http://su.example.com:8088/index.sucatalog" in field "expect".
      expect      : "http://su.example.com:8088/index.sucatalog"
    </custom_item>

    <custom_item>
      system        : "Darwin"
      type          : CMD_EXEC
      description   : "OSX00200 M6 - The ability for administrative accounts to unlock screen saver must be disabled"
      info          : "The default setting creates a possible point of attack, because the more users in the admin group the more dependent on those users to protect their user names and passwords. By changing the rule in 'system.login.screensaver' to 'authenticatesession-owner', users of the admin group cannot unlock the screen saver.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "Open a terminal session and edit the following file.

/etc/authorization

Change 'authenticate-session-owner-or-admin ' to 'authenticate-session-owner' in the 'system.login.screensaver' key.
Save the file."
      reference     : "800-171|3.1.5,800-53|AC-6,8500.2|ECPA-1,8500.2|PESL-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-37214r1_rule,SANS-CSC|12,STIG-ID|OSX00200-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-25280"
      see_also      : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd           : "/bin/cat /etc/authorization | /usr/bin/grep -C9 system.login.screensaver | grep authenticate-session-owner-or-admin | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect        : "none"
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00215 M6 - Setuid bit must be removed from Apple Remote Desktop - 'ARDAgent'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 755 /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38223r1_rule,SANS-CSC|3,STIG-ID|OSX00215-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25283"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"
      mask        : "4022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00255 M6 - The setuid bit must be removed from the IPC Statistics - '/usr/bin/ipcs'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 511 /usr/bin/ipcs"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38233r1_rule,SANS-CSC|3,STIG-ID|OSX00255-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25291"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/ipcs"
      mask        : "4266"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00260 M6 - The setuid bit from Remote Access (unsecure) must be removed - '/bin/rcp'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 555 /bin/rcp"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38235r1_rule,SANS-CSC|3,STIG-ID|OSX00260-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25292"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/bin/rcp"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00265 M6 - The setuid bit from rlogin must be removed - '/usr/bin/rlogin'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 555 /usr/bin/rlogin"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38237r1_rule,SANS-CSC|3,STIG-ID|OSX00265-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25293"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/rlogin"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00270 M6 - The setuid bit from Remote Access shell (unsecure) must be removed - '/usr/bin/rsh'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 555 /usr/bin/rsh"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38238r1_rule,SANS-CSC|3,STIG-ID|OSX00270-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25294"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/bin/rsh"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00275 M6 - The setuid bit from System Activity Reporting must be removed - '/usr/lib/sa/sadc'"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "Open a terminal session and enter the following command.

chmod 555 /usr/lib/sa/sadc"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-38239r1_rule,SANS-CSC|3,STIG-ID|OSX00275-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25295"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/usr/lib/sa/sadc"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00280 M6 - The correct date and time must be set"
      info        : "Correct date and time settings are required for authentication protocols, like Kerberos. Incorrect date and time settings can cause security issues."
      solution    : "1. Open System Preferences->Date&Time Panel.
2. Set the correct date and time."
      reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,CAT|III,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-38529r1_rule,SANS-CSC|3,STIG-ID|OSX00280-M6,Vuln-ID|V-25296"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/systemsetup -getdate -gettime"
      expect      : ""
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00285 M6 - A secure time server must be referenced - 'server is configured'"
      info        : "Correct date and time settings are required for authentication protocols, like Kerberos. Incorrect date and time settings can cause security issues. Date and time preferences can be used to set the date and time based on a Network Time Protocol (NTP) server. If you require automatic date and time, use a trusted, internal NTP server."
      info        : "NOTE: Update NTP_SERVER with the appropriate value for the local environment"
      solution    : "1. Open System Preferences> Date & Time Panel.
2. Select 'Set date & time automatically'.
3. In the box for the time server, type either the URL or IP address of a valid federal government NTP server or local domain controller."
      reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4,Rule-ID|SV-38530r1_rule,SANS-CSC|3,STIG-ID|OSX00285-M6,Vuln-ID|V-25297"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/ntp.conf"
      regex       : "^[\\s\\t]*server[\\s\\t]+"
# Note: Variable @NTP_SERVER@ replaced with "time\\\\.nist\\\\.gov" in field "expect".
      expect      : "^[\\s\\t]*server[\\s\\t]+time\\\\.nist\\\\.gov"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00290 M6 - The Auto Update feature must be disabled - 'Automatic Check Is OFF'"
      info        : "By disabling automatic updates, updates can be downloaded and tested in a non-production environment before they are distributed to the production workstations. This reduces the risk of accidental or malicious software updates being applied before they are properly tested."
      solution    : "Open a terminal session and enter the following command to disable the auto update feature.

softwareupdate --schedule off"
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|ECSC-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,NIAv2|NS26b,Rule-ID|SV-38531r1_rule,SANS-CSC|3,STIG-ID|OSX00290-M6,SWIFT-CSCv1|2.2,Vuln-ID|V-25298"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/softwareupdate --schedule"
      expect      : "[Aa][Uu][Tt][Oo][Mm][Aa][Tt][Ii][Cc]\\s+[Cc][Hh][Ee][Cc][Kk]\\s+[Ii][Ss]\\s+[Oo][Ff][Ff]\\s*$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00295 M6 - The guest account must be disabled - 'AuthenticationAuthority: ;basic;'"
      info        : "The guest account is used to give a user temporary access to a computer. The guest account should be disabled by default because it does not require a password to login on the computer. If this account is enabled and is not securely configured malicious users can gain access to a computer without the use of a password."
      solution    : "1. Open System Preferences->Accounts Panel.
2. Click on Guest Account.
3. Deselect 'Allow guests to login to this computer'."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|IAAC-1,CAT|II,CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSS|2.1,PCI-DSS|2.2.3,Rule-ID|SV-37218r1_rule,SANS-CSC|16,STIG-ID|OSX00295-M6,Vuln-ID|V-25299"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/dscl . -read /Users/Guest AuthenticationAuthority"
      expect      : "AuthenticationAuthority: ;basic;|.*\(eDSRecordNotFound\).*"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00300 M6 - Shared folders must be disabled - 'guestAccess = 0'"
      info        : "Whether or not the guest account itself is enabled, disable guest account access to shared files and folders by deselecting the 'Allow guest to connect to shared folders' checkbox. If the guest account is permitted to access shared folders, an attacker can easily attempt to access shared folders without a password."
      solution    : "1. Open System Preferences->Accounts Panel.
2. Click on Guest Account.
3. Deselect 'Allow Guests to connect to shared folders'."
      reference   : "800-171|3.1.1,800-53|AC-2,8500.2|ECAN-1,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS|2.2.3,Rule-ID|SV-37219r1_rule,SANS-CSC|15,SANS-CSC|3,STIG-ID|OSX00300-M6,Vuln-ID|V-25300"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.AppleFileServer guestAccess"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00310 M6 - Login window must be properly configured - 'SHOWFULLNAME = 1'"
      info        : "If not properly configured, the logon screen provides a list of local user names available for logon. A user could use this information to attempt to login as a different user."
      solution    : "1. Open System Preferences->Accounts Panel.
2. Select Login Options.
3. Set 'Display login window as-' to 'Name & password'."
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,PCI-DSS|2.2.3,Rule-ID|SV-37221r1_rule,SANS-CSC|3,STIG-ID|OSX00310-M6,Vuln-ID|V-25302"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00320 M6 - Input menu must not be shown in login window - 'showInputMenu = 0'"
      info        : "Showing input in the login window could compromise the integrity of the information, and could also allow someone shoulder surfing to gain unauthorized access to the system."
      solution    : "1. Open System Preferences->Accounts Panel.
2. Select Login Options.
3. Deselect 'Show input menu in login window' to disable this option."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|IAAC-1,CAT|I,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-37225r1_rule,SANS-CSC|16,STIG-ID|OSX00320-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25304"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow showInputMenu"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00325 M6 - The system must be configured to not show password hints - 'RetriesUntilHint = 0'"
      info        : "Providing information in the password hint field could compromise the integrity of the password. Showing password hint could allow someone shoulder surfing to gain information leading to unauthorized access to the system."
      solution    : "1. Open System Preferences->Accounts Panel.
2. Select Login Options.
3. Deselect 'Show password hints' to disable this option."
      reference   : "800-171|3.5.11,800-53|IA-6,8500.2|IAAC-1,CAT|I,ITSG-33|IA-6,NESA|T5.5.1,PCI-DSS|2.2.3,Rule-ID|SV-37226r1_rule,SANS-CSC|16,STIG-ID|OSX00325-M6,Vuln-ID|V-25305"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00330 M6 - Fast User Switching must be disabled - 'MultipleSessionEnabled = 0'"
      info        : "Fast User Switching allows multiple users to log in simultaneously. This makes it difficult to track user actions and allows users to run malicious applications in the background while another user is using the computer."
      solution    : "Open System Preferences->Accounts Panel.
Select Login Options.
Deselect 'Show fast user switching menu as' to disable this option."
      reference   : "800-53|AC-10,8500.2|IAAC-1,CAT|II,ITSG-33|AC-10,NESA|T5.5.1,PCI-DSS|2.2.2,Rule-ID|SV-37229r1_rule,SANS-CSC|16,STIG-ID|OSX00330-M6,Vuln-ID|V-25306"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/.GlobalPreferences MultipleSessionEnabled"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00335 M6 - The password-related hint field must not be used - 'RetriesUntilHint = 0'"
      info        : "If a hint is provided, the user is presented with the hint after three failed authentication attempts. Password-related information provided in the field could compromise the integrity of the password. Adding contact information for your organization's technical support is convenient and does not compromise password integrity."
      solution    : "1. Open System Preferences -> Accounts Panel, for each account.
2. Click 'reset password' (Change Password for current user).
3. Remove any data in the password hints field.
NOTE- The password hints field may include contact information for the organization's technical support."
      reference   : "800-171|3.5.11,800-53|IA-6,8500.2|IAAC-1,CAT|I,ITSG-33|IA-6,NESA|T5.5.1,PCI-DSS|2.2.3,Rule-ID|SV-38532r1_rule,SANS-CSC|16,STIG-ID|OSX00335-M6,Vuln-ID|V-25307"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00340 M6 - Automatic actions must be disabled for blank CDs - 'action=1;'"
      info         : "To secure CDs and DVDs, do not allow the computer to perform automatic actions when the user inserts a disc. When disabling automatic actions in System Preferences, these actions must be disabled for every user account on the computer."
      solution     : "Open a terminal session and enter the following command.

defaults write /Library/Preferences/com.apple.digihub com.apple.digihub.blank.cd.appeared -dict action 1"
      reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37230r1_rule,SANS-CSC|3,STIG-ID|OSX00340-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25308"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "\\s*action\\s*=\\s*1;"
      plist_item   : "com.apple.digihub.blank.cd.appeared"
      plist_name   : "com.apple.digihub"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00341 M6 - Automatic actions must be disabled for blank DVDs - 'action=1;'"
      info         : "To secure CDs and DVDs (blank), do not allow the computer to perform automatic actions when the user inserts a disc. When disabling automatic actions in System Preferences, these actions must be disabled for every user account on the computer."
      solution     : "Open a terminal session and enter the following command.

defaults write /Library/Preferences/com.apple.digihub com.apple.digihub.blank.dvd.appeared -dict action 1"
      reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37333r1_rule,SANS-CSC|3,STIG-ID|OSX00341-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25606"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "\\s*action\\s*=\\s*1;"
      plist_item   : "com.apple.digihub.blank.dvd.appeared"
      plist_name   : "com.apple.digihub"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00345 - Automatic actions must be disabled for music CDs - 'action=1;'"
      info         : "To secure CDs and DVDs (music), do not allow the computer to perform automatic actions when the user inserts a disc. When disabling automatic actions in System Preferences, these actions must be disabled for every user account on the computer."
      solution     : "Open System Preferences - > CDs and DVDs.
Set 'When you insert a music CD' to 'Ignore'."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-37231r1_rule,SANS-CSC|3,STIG-ID|OSX00345,SWIFT-CSCv1|2.3,Vuln-ID|V-25309"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "\\s*action\\s*=\\s*1;"
      plist_item   : "com.apple.digihub.cd.music.appeared"
      plist_name   : "com.apple.digihub"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00350 M6 - Automatic actions must be disabled for picture CDs - 'action=1;'"
      info         : "To secure CDs and DVDs, do not allow the computer to perform automatic actions when the user inserts a disc. When disabling automatic actions in System Preferences, these actions must be disabled for every user account on the computer."
      solution     : "Open System Preferences - > CDs and DVDs.
Set 'When you insert a picture CD' to 'Ignore'."
      reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37235r1_rule,SANS-CSC|3,STIG-ID|OSX00350-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25310"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "\\s*action\\s*=\\s*1;"
      plist_item   : "com.apple.digihub.cd.picture.appeared"
      plist_name   : "com.apple.digihub"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00355 M6 - Automatic actions must be disabled for video DVDs - 'action=1;'"
      info         : "To secure CDs and DVDs, do not allow the computer to perform automatic actions when the user inserts a disc. When disabling automatic actions in System Preferences, these actions must be disabled for every user account on the computer."
      solution     : "Open System Preferences - > CDs and DVDs.
Set 'When you insert a video DVD' to 'Ignore'."
      reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37236r1_rule,SANS-CSC|3,STIG-ID|OSX00355-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25311"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "\\s*action\\s*=\\s*1;"
      plist_item   : "com.apple.digihub.dvd.video.appeared"
      plist_name   : "com.apple.digihub"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00360 M6 - System must have a password-protected screen saver configured to DoD requirements - 'idleTime < 900'"
      info         : "User needs to configure a password-protected screen saver to prevent unauthorized users from accessing unattended computers. A short inactivity interval should also be set to decrease the amount of time the unattended computer is unlocked."
      solution     : "Open System Preferences->Desktop & Screen Saver.
Select the screen saver tab.
Set the 'Start screen saver' slider to 15 minutes or less."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-38533r1_rule,STIG-ID|OSX00360-M6,Vuln-ID|V-25312"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "[A-Za-z0-9_-]+\\s*=\\s*(900|[2-8][0-9][0-9]|1[8-9][0-9])$"
      byhost       : YES
      plist_item   : "idleTime"
      plist_name   : "com.apple.screensaver"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00375 M6 - The ability to use corners to disable the screen saver must be disabled - 'Top-Right corner does not disable screensaver'"
      info         : "A computer should require authentication when waking from sleep or screen saver. Expose & Spaces preferences can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen. Do not configure a corner to disable the screen saver."
      solution     : "Open System Preferences->Expose & Spaces, Expose pane.
Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-37242r1_rule,STIG-ID|OSX00375-M6,Vuln-ID|V-25317"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      not_regex    : "6"
      plist_item   : "wvous-tr-corner"
      plist_name   : "com.apple.dock"
      plist_option : CAN_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00375 M6 - The ability to use corners to disable the screen saver must be disabled - 'Top-Left corner does not disable screensaver'"
      info         : "A computer should require authentication when waking from sleep or screen saver. Expose & Spaces preferences can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen. Do not configure a corner to disable the screen saver."
      solution     : "Open System Preferences->Expose & Spaces, Expose pane.
Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-37242r1_rule,STIG-ID|OSX00375-M6,Vuln-ID|V-25317"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      not_regex    : "6"
      plist_item   : "wvous-tl-corner"
      plist_name   : "com.apple.dock"
      plist_option : CAN_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00375 M6 - The ability to use corners to disable the screen saver must be disabled - 'Bottom-Right corner does not disable screensaver'"
      info         : "A computer should require authentication when waking from sleep or screen saver. Expose & Spaces preferences can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen. Do not configure a corner to disable the screen saver."
      solution     : "Open System Preferences->Expose & Spaces, Expose pane.
Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-37242r1_rule,STIG-ID|OSX00375-M6,Vuln-ID|V-25317"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      not_regex    : "6"
      plist_item   : "wvous-br-corner"
      plist_name   : "com.apple.dock"
      plist_option : CAN_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00375 M6 - The ability to use corners to disable the screen saver must be disabled - 'Bottom-Left corner does not disable screensaver'"
      info         : "A computer should require authentication when waking from sleep or screen saver. Expose & Spaces preferences can be configured to disable the screen saver by moving the mouse cursor to a corner of the screen. Do not configure a corner to disable the screen saver."
      solution     : "Open System Preferences->Expose & Spaces, Expose pane.
Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-37242r1_rule,STIG-ID|OSX00375-M6,Vuln-ID|V-25317"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      not_regex    : "6"
      plist_item   : "wvous-bl-corner"
      plist_name   : "com.apple.dock"
      plist_option : CAN_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00380 M6 - Bluetooth devices must not be allowed to wake the computer - 'BluetoothSystemWakeEnable = 0'"
      info         : "If Bluetooth is not required, turn it off. If Bluetooth is necessary, disable allowing Bluetooth devices to awake the computer."
      solution     : "Open System Preferences -> Bluetooth.
Click Advanced.
Deselect 'Allow Bluetooth devices to wake this computer'."
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|ECSC-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NIAv2|AM23e,PCI-DSS|2.2.3,Rule-ID|SV-38535r1_rule,SANS-CSC|3,STIG-ID|OSX00380-M6,Vuln-ID|V-25318"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "0"
      byhost       : YES
      plist_item   : "BluetoothSystemWakeEnable"
      plist_name   : "com.apple.Bluetooth"
      plist_option : CAN_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00385 M6 - Unused hardware devices must be disabled for AirPort - 'No Airport network services are loaded'"
      info        : "It is recommended to disable unused hardware devices listed in Network preferences. Enabled, unused devices (such as AirPort and Bluetooth) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer."
      solution    : "Open System Preferences - > Network.
From the list of hardware devices, select AirPort.
Set this service to 'Off' by clicking the gear sign and selecting 'Turn service off'.
Remove service if required by site requirements by clicking the minus sign."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-37245r1_rule,SANS-CSC|3,STIG-ID|OSX00385-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25320"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/networksetup -getairportpower AirPort"
      expect      : "^\\s*[Aa]ir[Pp]ort\\s+[Pp]ower\\s+\\([Aa]ir[Pp]ort\\):\\s*[Oo][Ff][Ff]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00390 M6 - Unused hardware devices must be disabled for Bluetooth - 'No Bluetooth network services are loaded'"
      info        : "It is recommended to disable unused hardware devices listed in Network preferences. Enabled, unused devices (such as AirPort and Bluetooth) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer."
      solution    : "Open System Preferences - > Network.
From the list of hardware devices, select Bluetooth.
Set this service to 'Inactive' by clicking the gear sign and selecting 'Make Service Inactive'. Remove service if required by site requirements by clicking the minus sign. (From the 'Configure' pop-up menu, choose 'Manually'.)"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-38536r1_rule,SANS-CSC|3,STIG-ID|OSX00390-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25321"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/networksetup -listallnetworkservices | /usr/bin/egrep '[Bb]luetooth' | /usr/bin/egrep -v '^\\\*' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00395 M6 - Unused hardware devices must be disabled for Firewire - 'No firewire network services are loaded'"
      info        : "It is recommended to disable unused hardware devices listed in Network preferences. Enabled, unused devices (Firewire) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer."
      solution    : "Open System Preferences - > Network.
From the list of hardware devices, select Firewire.
Set this service to 'Inactive' by clicking the gear sign and selecting 'Make Service Inactive'. Remove service if required by site requirements by clicking the minus sign. (From the 'Configure' pop-up menu, choose 'Manually'.)"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-38538r1_rule,SANS-CSC|3,STIG-ID|OSX00395-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25323"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/networksetup -listallnetworkservices | /usr/bin/egrep '[Ff]irewire' | /usr/bin/egrep -v '^\\\*' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system        : "Darwin"
      type          : CMD_EXEC
      description   : "OSX00400 M6 - System Preferences must be securely configured so IPv6 is turned off if not being used"
      info          : "It is recommended to disable unused hardware devices listed in Network preferences. Enabled, unused devices are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "Open System Preferences - > Network.
Click Advanced.
Click the TCP/IP tab and set 'Configure IPv6' to 'Off', if not actively being used.

NOTE- This must be disabled on each network interface."
      reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-37247r1_rule,SANS-CSC|3,STIG-ID|OSX00400-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25324"
      see_also      : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd           : "/sbin/ifconfig -a inet6 | /usr/bin/grep -v flags | /usr/bin/grep -v 'inet6 ::1' | /usr/bin/grep -v 'inet6 fe80::1%lo0'"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00420 M6 - A password must be required to wake a computer from sleep or screen saver - 'askForPassword = 1'"
      info         : "Require a password to wake a computer from sleep or screen saver. This helps prevent unauthorized access on unattended computers. Although there is a lock button for Security references, users do not need to be authorized as an administrator to make changes. Enable this password requirement for every user account on the computer."
      solution     : "Open a terminal session and enter the following command.

defaults -currentHost write com.apple.screensaver askForPassword -int 1"
      reference    : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-38560r1_rule,STIG-ID|OSX00420-M6,Vuln-ID|V-25328"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "askForPassword"
      plist_name   : "com.apple.screensaver"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00425 M6 - Automatic login must be disabled - 'autoLoginUser is not defined'"
      info        : "Disabling automatic login is necessary for any level of security. If automatic login is enabled, an intruder can log in without authenticating. Even automatically logging in with a restricted user account, it is still easier to perform malicious actions on the computer."
      solution    : "1. Open System Preferences->Security.
2. Select General tab.
3. Select 'Disable automatic login'."
      reference   : "800-53|AC-14,8500.2|IAAC-1,CAT|I,ITSG-33|AC-14,NESA|T5.6.1,PCI-DSS|2.2.3,Rule-ID|SV-37251r1_rule,SANS-CSC|16,STIG-ID|OSX00425-M6,Vuln-ID|V-25329"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow autoLoginUser | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00430 M6 - A password must be required to unlock each System Preference Pane - 'shared = FALSE'"
      info        : "Some system preferences are unlocked when logged in with an administrator account. By requiring a password, digital token, smart card, or biometric reader to unlock secure system preferences, this requires extra authentication."
      solution    : "1. Open System Preferences->Security.
2. Select General tab.
3. Select 'Require password to unlock each System Preferences Pane'."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,Rule-ID|SV-37254r1_rule,SANS-CSC|3,STIG-ID|OSX00430-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-25330"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /etc/authorization | /usr/bin/grep -C15 '>system.preferences<' | /usr/bin/grep -C1 '<key>shared</key>'"
      expect      : "<false/>"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00435 M6 - Automatic logout due to inactivity must be disabled - 'com.apple.autologout.AutoLogOutDelay = 0'"
      info        : "Although some might want to enable automatic logout based on inactivity, there are reasons why this feature should be disabled. First, it can disrupt workflow. Second, it can close applications or processes without approval (but a password-protected screen saver will not close applications). Third, because automatic logout can be interrupted, it provides a false sense of security."
      solution    : "1. Open System Preferences->Security.
2. Select General tab.
3. Deselect 'Log out after x minutes of inactivity'."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|ECSC-1,CAT|III,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-37262r1_rule,SANS-CSC|3,STIG-ID|OSX00435-M6,Vuln-ID|V-25331"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/.GlobalPreferences com.apple.autologout.AutoLogOutDelay"
      expect      : "^0$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00440 M6 - Secure virtual memory must be used - 'UseEncryptedSwap = 1'"
      info        : "Use secure virtual memory. The system's virtual memory swap file stores inactive physical memory contents, freeing physical memory. By default on some systems, the swap file is unencrypted. This file can contain confidential data, such as documents and passwords. Using secure virtual memory will secure the swap file at a cost of slightly slower speed (because Mac OS X must encrypt and decrypt the secure swap file)."
      solution    : "1. Open System Preferences->Security.
2. Select General tab.
3. Select 'Use Secure Virtual Memory'."
      reference   : "800-53|SI-16,8500.2|ECRC-1,CAT|II,PCI-DSS|2.2.3,Rule-ID|SV-37263r1_rule,SANS-CSC|17,STIG-ID|OSX00440-M6,Vuln-ID|V-25332"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.virtualMemory UseEncryptedSwap"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00445 M6 - Remote control infrared receiver must be disabled - 'DeviceEnabled = 0'"
      info        : "If not using a remote control, disable the infrared receiver. This prevents unauthorized users from controlling a computer through the infrared receiver."
      solution    : "1. Open System Preferences->Security.
2. Select General tab.
3. Select 'Disable remote control infrared receiver'."
      reference   : "800-171|3.1.18,800-53|AC-19,8500.2|ECSC-1,CAT|II,CSF|PR.AC-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,PCI-DSS|2.2.2,Rule-ID|SV-38561r1_rule,SANS-CSC|3,STIG-ID|OSX00445-M6,Vuln-ID|V-25333"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00455 M6 - Only essential services must be allowed through firewall - 'globalstate = 1'"
      info        : "Allowing only essential services through the firewall alleviates the potential for unwanted services to run on the system, and cuts down on system usage."
      solution    : "Open System Preferences -> Security.

Select Firewall tab.

Select the Advanced button.

Check 'Block all incoming connections' or remove any non-essential services and applications."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECND-1,CAT|II,CSCv6|9.2,ITSG-33|SC-7,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,PCI-DSS|1.4,Rule-ID|SV-38563r1_rule,SANS-CSC|10,STIG-ID|OSX00455-M6,Vuln-ID|V-25335"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.alf globalstate"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00465 M6 - Stealth Mode must be enabled on the firewall - 'stealthenabled = 1'"
      info        : "Enable Stealth Mode to prevent the computer from sending responses to uninvited traffic."
      solution    : "Open a terminal session and edit or create /Library/LaunchDaemons/org.freebsd.ipfw.plist and ensure it contains the following.

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE plist PUBLIC '-//Apple//DTD PLIST 1.0//EN'
'http-//www.apple.com/DTDs/ PropertyList-1.0.dtd'> <plist version='1.0'>
<dict>
 <key>Label</key>
  <string>org.freebsd.ipfw</string>
 <key>Program</key>
  <string>/sbin/ipfw</string>
 <key>ProgramArguments</key>
  <array>
   <string>/sbin/ipfw</string>
   <string>/etc/ipfw.conf</string>
  </array>
 <key>RunAtLoad</key>
  <true />
</dict>
</plist>

Edit or create /etc/ipfw.conf and ensure it contains the following line (the first number, a line number, may need to be changed if another line already begins with that number).

Add 20 deny icmp from any to me in icmptypes 8"
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,PCI-DSS|1.4,Rule-ID|SV-37266r1_rule,SANS-CSC|3,STIG-ID|OSX00465-M6,Vuln-ID|V-25337"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.alf stealthenabled"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00467 M6 - Bonjour must be disabled - 'com.apple.mDNSResponder is not loaded'"
      info        : "Bonjour is unnecessary in a managed environment and presents an attack surface.  Its behavior, which trusts the local network, is especially inappropriate on portable devices which may connect to untrusted networks."
      solution    : "Open a terminal session and edit or create /Library/LaunchDaemons/org.freebsd.ipfw.plist and ensure it contains the following-

<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE plist PUBLIC '-//Apple//DTD PLIST 1.0//EN'
'http-//www.apple.com/DTDs/ PropertyList-1.0.dtd'>
<plist version='1.0'>
<dict>
	<key>Label</key>
		<string>org.freebsd.ipfw</string>
	<key>Program</key>
		<string>/sbin/ipfw</string>
	<key>ProgramArguments</key>
		<array>
			<string>/sbin/ipfw</string>
			<string>/etc/ipfw.conf</string>
		</array>
	<key>RunAtLoad</key>
		<true />
</dict>
</plist>

Edit or create /etc/ipfw.conf and ensure it contains the following line (the first number, a line number, may need to be changed if another line already begins with that number)-

Add 10 deny udp from any to me dst-port 5353"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-38581r1_rule,SANS-CSC|3,STIG-ID|OSX00467-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25882"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.mDNSResponder | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00470 M6 - DVD or CD Sharing must be disabled - 'Disabled = TRUE'"
      info        : "DVD or CD sharing must be disabled because it allows users of other computers to remotely use the DVD or CD drive on a computer."
      solution    : "Open System Preferences->Sharing.
Uncheck the 'On' box for 'DVD or CD Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37268r1_rule,SANS-CSC|3,STIG-ID|OSX00470-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25338"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /var/db/launchd.db/com.apple.launchd/overrides.plist | /usr/bin/grep -A4 '<key>com.apple.ODSAgent' | /usr/bin/grep -A1 '<key>Disabled'"
      expect      : "\\s*<[Tt][Rr][Uu][Ee]/>"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : FILE_CHECK_NOT
          description : "OSX00475 M6 - Screen Sharing must be disabled"
          file        : "/Library/Preferences/com.apple.ScreenSharing.launchd"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CHECK_NOT
          description : "OSX00475 M6 - Screen Sharing must be disabled - 'OSX >= 10.6.3 /private/etc/ScreenSharing.launchd does not exist'"
          info        : "Screen sharing must be disabled because it allows users of other computers to remotely view and control the computer."
          solution    : "Open System Preferences->Sharing.
Uncheck the 'On' box for 'Screen Sharing' service."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,Rule-ID|SV-37273r1_rule,SANS-CSC|3,STIG-ID|OSX00475-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25339"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/private/etc/ScreenSharing.launchd"
        </custom_item>
      </then>

      <else>
        <custom_item>
          system      : "Darwin"
          type        : FILE_CHECK_NOT
          description : "OSX00475 M6 - Screen Sharing must be disabled - 'OSX <= 10.6.2 /Library/Preferences/com.apple.ScreenSharing.launchd does not exist'"
          info        : "Screen sharing must be disabled because it allows users of other computers to remotely view and control the computer."
          solution    : "Open System Preferences->Sharing.
Uncheck the 'On' box for 'Screen Sharing' service."
          reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,Rule-ID|SV-37273r1_rule,SANS-CSC|3,STIG-ID|OSX00475-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25339"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          file        : "/Library/Preferences/com.apple.ScreenSharing.launchd"
        </custom_item>
      </else>
    </if>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 M6 - File Sharing must be disabled - 'com.apple.smb.server EnabledServices Disk does not exist'"
      info        : "File sharing must be disabled because it gives users of other computers access to each user's Public folder."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-37274r1_rule,SANS-CSC|3,STIG-ID|OSX00480-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server EnabledServices | /usr/bin/grep '\\s*[Dd]isk' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00485 M6 - Printer Sharing must be disabled - 'com.apple.smb.server EnabledServices Print does not exist'"
      info        : "Printer sharing must be disabled because it allows other computers to access a printer connected to the computer."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Printer Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37278r1_rule,SANS-CSC|3,STIG-ID|OSX00485-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25341"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server EnabledServices | /usr/bin/grep '\\s*[Pp]rint' | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00490 M6 - Web Sharing must be disabled - 'Disabled = TRUE'"
      info        : "Web Sharing must be disabled because it allows a network user to view websites located in /Sites."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Web Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-37282r1_rule,SANS-CSC|3,STIG-ID|OSX00490-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25342"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /var/db/launchd.db/com.apple.launchd/overrides.plist | /usr/bin/grep -A4 '<key>org\.apache\.httpd' | /usr/bin/grep -A1 '<key>Disabled'"
      expect      : "\\s*<[Tt][Rr][Uu][Ee]/>"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00495 M6 - Remote Login must be disabled - 'Disabled = TRUE'"
      info        : "Remote Login must be disabled because it allows users to access the computer remotely."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Remote Login' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37284r1_rule,SANS-CSC|3,STIG-ID|OSX00495-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25343"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /var/db/launchd.db/com.apple.launchd/overrides.plist | /usr/bin/grep -A4 '<key>com\.openssh\.sshd' | /usr/bin/grep -A1 '<key>Disabled'"
      expect      : "\\s*<[Tt][Rr][Uu][Ee]/>"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00500 M6 - Apple Remote Desktop must be disabled - '/etc/RemoteManagement.launchd does not exist'"
      info        : "Apple Remote Desktop must be disabled because it allows the computer to be accessed using Apple Remote Desktop."
      solution    : "Open System Preferences->Sharing.

Uncheck the 'On' box for 'Remote Management' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-37288r1_rule,SANS-CSC|3,STIG-ID|OSX00500-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25346"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/RemoteManagement.launchd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00505 M6 - Remote Apple Events must be disabled - 'Disabled = TRUE'"
      info        : "Remote Apple Events must be disabled because it allows the computer to receive Apple events from other computers."
      solution    : "Open System Preferences->Sharing.

Uncheck the 'On' box for 'Remote Apple Events' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37290r1_rule,SANS-CSC|3,STIG-ID|OSX00505-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25348"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/bin/cat /var/db/launchd.db/com.apple.launchd/overrides.plist | /usr/bin/grep -A4 '<key>com.apple.AEServer' | /usr/bin/grep -A1 '<key>Disabled'"
      expect      : "\\s*<[Tt][Rr][Uu][Ee]/>"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00510 M6 - Xgrid Sharing must be disabled - 'Enabled = 0'"
      info        : "Xgrid Sharing must be disabled because it allows computers on a network to work together in a grid to process a job."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Xgrid Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-37293r1_rule,SANS-CSC|3,STIG-ID|OSX00510-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25349"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.xgrid.agent Enabled"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00515 M6 - Internet Sharing must be disabled - 'Enabled=0;'"
      info        : "Internet Sharing must be disabled because it allows other users to connect with computers on your local network, through your internet connection."
      solution    : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Internet Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-37296r1_rule,SANS-CSC|3,STIG-ID|OSX00515-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25350"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.nat | /usr/bin/grep -B2 '\\s*PrimaryInterface' | /usr/bin/grep '\\s*Enabled'"
      expect      : "\\s*[Ee]nabled\\s*=\\s*0;"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00520 M6 - Bluetooth Sharing must be disabled - 'PrefKeyServicesEnabled = 0'"
      info         : "Bluetooth Sharing must be disabled because it allows other Bluetooth-enabled computers and devices to share files with your computer."
      solution     : "1. Open System Preferences->Sharing.
2. Uncheck the 'On' box for 'Bluetooth Sharing' service."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,8500.2|ECWN-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-37299r1_rule,SANS-CSC|3,SANS-CSC|7,STIG-ID|OSX00520-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25351"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "0"
      byhost       : YES
      plist_item   : "PrefKeyServicesEnabled"
      plist_name   : "com.apple.Bluetooth"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00525 M6 - Mail must be configured using SSL"
      info        : "When setting up user mail accounts, select 'use SSL' in advanced options. This setting is for the Mail app included with OS X.  Instructions will be different for other mail applications, but all mail applications should be set up secured using some form of encryption.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Choose Mail > Preferences, Click Accounts.
Select an account, Click Advanced.
Select 'Use SSL'.
From the Authentication pop-up menu, select authentication method (e.g., MD5 Challenge-Response, NTLM, Kerberos Version 5 (GSSAPI), or Authenticated POP (APOP)).
Click Account Information.
From the Outgoing Mail Server (SMTP) pop-up menu, select Edit Server List.
From the server list, select your outgoing mail server and then click Advanced.
Select 'Secure Socket Layer (SSL)'.
From the Authentication pop-up menu, select authentication method (e.g., MD5 Challenge-Response, NTLM, Kerberos Version 5 (GSSAPI), or Authenticated POP (APOP)).
Close the preferences window, and then click 'Save' in the message that appears."
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-38567r1_rule,SANS-CSC|17,STIG-ID|OSX00525-M6,Vuln-ID|V-25354"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00530 M6 - iTunes Store must be disabled - 'Podcasts are disabled'"
      info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
      solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "disablePodcasts"
      plist_name   : "com.apple.iTunes"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00530 M6 - iTunes Store must be disabled - 'Radio streaming is disabled'"
      info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
      solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "disableRadio"
      plist_name   : "com.apple.iTunes"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00530 M6 - iTunes Store must be disabled - 'iTunes Store is disabled'"
      info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
      solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "disableMusicStore"
      plist_name   : "com.apple.iTunes"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00530 M6 - iTunes Store must be disabled - 'Allow Access to iTunes U is disabled'"
      info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
      solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "disableMusicStore"
      plist_name   : "com.apple.iTunes"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system       : "Darwin"
          type         : MACOSX_DEFAULTS_READ
          description  : "OSX00530 M6 - iTunes Store must be disabled - 'Ping is disabled'"
          regex        : "0"
          plist_item   : "disableMusicStore"
          plist_name   : "com.apple.iTunes"
          plist_option : CANNOT_BE_NULL
          plist_user   : "all"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system       : "Darwin"
          type         : MACOSX_DEFAULTS_READ
          description  : "OSX00530 M6 - iTunes Store must be disabled - 'Ping is disabled'"
          info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
          solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
          reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|III,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
          see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
          regex        : "1"
          plist_item   : "disablePing"
          plist_name   : "com.apple.iTunes"
          plist_option : CAN_BE_NULL
          plist_user   : "all"
        </custom_item>
      </then>
    </if>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00530 M6 - iTunes Store must be disabled - 'Shared Libraries are disabled'"
      info         : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. NOTE- The fix must be performed for each user."
      solution     : "Open Finder.
Select Applications.
Double click the iTunes application.
On the top menu bar click iTunes and from the drop down menu select Preferences.
Click on the Parental icon.
Check the following items to disable.
'Podcasts'
'Radio streaming'
'iTunes Store'
'Allow Access to iTunesU'
'Ping' (if it exists)
'Shared Libraries'
NOTE- This must be performed for each user."
      reference    : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|III,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-37301r1_rule,SANS-CSC|3,STIG-ID|OSX00530-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25355"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "disableSharedMusic"
      plist_name   : "com.apple.iTunes"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <custom_item>
      system       : "Darwin"
      type         : MACOSX_DEFAULTS_READ
      description  : "OSX00535 M6 - Finder must be set to always empty Trash securely = 'EmptyTrashSecurely = 1'"
      info         : "In Mac OS X, Finder can be configured to always securely erase items placed in the Trash. This prevents data placed in the Trash from being restored."
      solution     : "1. Open Finder-> Preferences -> Advanced.
2. Select 'Empty Trash Securely'.
This must be done for each user on the system."
      reference    : "800-171|3.4.2,800-53|CM-6,8500.2|ECRC-1,CAT|III,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-37303r1_rule,SANS-CSC|17,STIG-ID|OSX00535-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25356"
      see_also     : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      regex        : "1"
      plist_item   : "EmptyTrashSecurely"
      plist_name   : "com.apple.finder"
      plist_option : CANNOT_BE_NULL
      plist_user   : "all"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00540 M6 - iDisk must be removed from Finder sidebar"
      info        : "iDisk data is stored on Internet servers and is protected by MobileMe account. However, if MobileMe account is accessed by an unauthorized user, data can be compromised. Do not store sensitive data on iDisk. Keep sensitive data local and encrypted on a computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open Finder -> Preferences -> Sidebar.
2. De-select the iDisk icon.
This must be done for each user on the system."
      reference   : "8500.2|ECRC-1,CAT|II,Rule-ID|SV-37308r1_rule,SANS-CSC|17,STIG-ID|OSX00540-M6,Vuln-ID|V-25358"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00655 M6 - The root account must be disabled - 'AuthenticationAuthority:;DisabledUser'"
      info        : "The most powerful user account in Mac OS X is the system administrator or root account. By default, the root account on Mac OS X is disabled and it is recommended to not enable it. The root account is primarily used for performing UNIX commands. Generally, actions involving critical system files require performing those actions as root."
      solution    : "Open Finder
Click the Hard Drive icon.
Double Click System.
Double Click Library.
Double Click CoreServices.
Double Click Directory Utility.
Click the Lock and enter the password to unlock the options.
Click the Edit menu (Directory Utility bar on top).
Click Disable Root User."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|IAAC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSS|2.2.3,Rule-ID|SV-38568r1_rule,SANS-CSC|16,STIG-ID|OSX00655-M6,SWIFT-CSCv1|5.1,Vuln-ID|V-25371"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/bin/dscl . -read /Users/root AuthenticationAuthority"
      regex       : "AuthenticationAuthority:.*"
      expect      : "AuthenticationAuthority:\\s(No.such.key|;DisabledUser)"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00660 M6 - Physical security of the system must meet DoD requirements"
      info        : "Inadequate physical protection can undermine all other security precautions utilized to protect the system. This can jeopardize the confidentiality, availability, and integrity of the system. Physical security of the AIS is the first line of protection of any system.
Physical security of the Automated Information System (AIS) must meet DoD requirements.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Relocate equipment to a controlled access area."
      reference   : "8500.2|PECF-2,CAT|II,Rule-ID|SV-38583r1_rule,STIG-ID|OSX00660-M6,Vuln-ID|V-25372"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00665 M6 - Shared User Accounts must be disabled"
      info        : "Shared accounts do not provide individual accountability for system access and resource usage.
Shared user accounts are not permitted on the system.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Remove any shared accounts not meeting the exception requirements listed."
      reference   : "8500.2|IAGA-1,CAT|II,Rule-ID|SV-37313r1_rule,SANS-CSC|16,STIG-ID|OSX00665-M6,Vuln-ID|V-25373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00670 M6 - The Operating System must be current and at the latest release level"
      info        : "Failure to install the most current Operating System (OS) updates leaves a system vulnerable to exploitation. Current OS updates and patches correct known security and system vulnerabilities. If an OS is not at a supported level this will be upgraded to a Category I finding."
      solution    : "Install the current OS updates and patches."
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|VIVM-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-38569r1_rule,SANS-CSC|4,STIG-ID|OSX00670-M6,SWIFT-CSCv1|2.2,Vuln-ID|V-25374"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      cmd         : "/usr/sbin/softwareupdate --list --all | /usr/bin/awk '{print} END {if (NR == 0) print \"none\"}'"
      expect      : "none"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00675 M6 - System Recovery Backup procedures must be configured to comply with DoD requirements"
      info        : "Recovery of a damaged or compromised system in a timely basis is difficult without a system information backup. A system backup will usually include sensitive information, such as user accounts that could be used in an attack. As a valuable system resource, the system backup should be protected and stored in a physically secure location.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Implement data backup procedures complying with DoD requirements."
      reference   : "8500.2|CODB-1,CAT|III,Rule-ID|SV-37320r1_rule,SANS-CSC|8,STIG-ID|OSX00675-M6,Vuln-ID|V-25375"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 M6 - Access to audit configuration files must be restricted - '/etc/security/*'"
      info        : "Audit configuration files are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and enter the following command to set the file permissions.

chmod 555 /etc/security/ <audit control file>"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-38570r1_rule,SANS-CSC|14,STIG-ID|OSX00680-M6,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
      file        : "/etc/security/*"
      mask        : "222"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00685 M6 - An Emergency Administrator Account must be created"
      info        : "This check verifies an emergency administrator account has been created to ensure system availability in the event no administrators are able or available to access the system.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create and maintain an emergency administrator account for emergency situations."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-37322r1_rule,SANS-CSC|12,STIG-ID|OSX00685-M6,Vuln-ID|V-25376"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00690 M6 - Default and Emergency Administrator passwords must be changed when necessary"
      info        : "This check verifies the passwords for the default and emergency administrator accounts are changed at least annually or when any member of the administrative team leaves the organization.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Define a policy for required password changes for the default and backup administrator account."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-37325r1_rule,SANS-CSC|12,STIG-ID|OSX00690-M6,Vuln-ID|V-25377"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00695 M6 - Service account passwords must be changed annually or when a system administrator with knowledge of the password leaves"
      info        : "Setting application accounts to expire may cause applications to stop functioning. The site will have a policy for application account passwords manually generated and entered by a system administrator to be changed at least annually or when a system administrator with knowledge of the password leaves the organization. Application/service account passwords will be at least 15 characters and follow complexity requirements for all passwords.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create application/service account passwords at least 15 characters in length and meet complexity requirements. Change of application/service account passwords are manually generated and entered by a system administrator at least annually or whenever an administrator with knowledge of the password leaves the organization."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-37329r1_rule,SANS-CSC|12,STIG-ID|OSX00695-M6,Vuln-ID|V-25378"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00700 M6 - Automatic Screen Saver initiation must be enabled when smart card is removed from machine"
      info        : "When using a smart card for authentication the system must be configured to automatically lock the system when the smart card is removed.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open System Preferences.
Click the Security Icon.
Click the General Tab.
Select 'Activate screen saver when login token is removed'."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-38572r1_rule,SANS-CSC|3,STIG-ID|OSX00700-M6,Vuln-ID|V-25379"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00705 M6 - Spotlight Panel must be securely configured"
      info        : "Spotlight can be used to search a computer for files. Spotlight searches the name, the meta-information associated with each file, and the contents of each file. Spotlight finds files regardless of their placement in the file system. This still must be properly set access permissions on folders containing confidential files.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "To securely configure Spotlight preferences-
Open System Preferences.
Click the Spotlight Icon.
In the Search Results pane, deselect categories not wanted searchable by Spotlight.
Click the Privacy pane.
Click the Add button or drag a folder or disk into the Privacy pane.
Folders and disks in the Privacy pane are now not searchable by Spotlight."
      reference   : "8500.2|ECCD-1,CAT|II,Rule-ID|SV-37331r1_rule,SANS-CSC|3,STIG-ID|OSX00705-M6,Vuln-ID|V-25413"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_MacOSX_10.6_v1r3.audit"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx_10.6_v1r3_stig_20130426.zip"
    </report>
  </else>
</if>

</check_type>
