#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.24 $
# $Date: 2020/07/14 $
#
# Description	: This .audit file is written again the Center for Internet Security benchmark "DNS BIND 9.0 - 9.5 v2.0.0"
# 	  		https://workbench.cisecurity.org/files/652
# 	  		and was built against a default install of BIND on Red Hat via RPM.
#
# NOTE			: Some queries in this .audit require site-specific data to be known to the query in order to function properly.  Please note the following
# 			queries and edit their values accordingly.
#
# 			3.2.2 Restrict Query Origins 'mynets'
# 			3.2.3 Restrict Access to Cache 'trusted, local IP network'
# 			3.3.1 dnssec-keygen Algorithms 'IN KEY'
# 			3.3.1 dnssec-keygen Algorithms 'HMAC-SHA256'
# 			3.3.2 Include TSIG key in named.conf 'TSIG key 1'
# 			3.3.2 Include TSIG key in named.conf 'TSIG key 2'
# 			3.3.2 Include TSIG key in named.conf 'TSIG key 1 permissions'
# 			3.3.2 Include TSIG key in named.conf 'TSIG key 2 permissions'
# 			3.4 Restrict Zone-Transfers 'allow-transfer'
# 			3.4 Restrict Zone-Transfers 'Zone Transfer Server 1'
# 			3.4 Restrict Zone-Transfers 'Zone Transfer Server 2'
# 			3.5.1 Using Update Policy 'zone'
# 			3.5.1 Using Update Policy 'type master'
# 			3.5.1 Using Update Policy 'update-policy'
# 			3.5.1 Using Update Policy 'grant'
# 			3.5.1 Using Update Policy 'keys'
# 			3.5.2 Enable GSS-TSIG 'tkey-gssapi-credential'
# 			3.5.2 Enable GSS-TSIG 'tkey-domain'
# 			3.5.2 Enable GSS-TSIG 'algorithm'
# 			3.5.2 Enable GSS-TSIG 'key'
# 			3.5.3 DHCID
# 			3.6 Implement DNSSEC 'INCLUDE'
#
#<ui_metadata>
#<display_name>CIS ISC BIND 9.0/9.5 v2.0.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>ISC BIND 9.0/9.5</name>
#  <version>2.0.0</version>
#  <link>https://workbench.cisecurity.org/files/652</link>
#</spec>
#<labels>unix,cis,bind,bind_9.5,agent</labels>
#<benchmark_refs>LEVEL</benchmark_refs>
#<variables>
#  <variable>
#    <name>INTERNAL_NETWORK</name>
#    <default>192\\.0\\.2\\.0/24</default>
#    <description>Internal IP network</description>
#    <info>Your organization's internal IP address range.</info>
#  </variable>
#  <variable>
#    <name>DNSSEC_KEY_PATH</name>
#    <default>/etc/Kns1-ns2\\.cisecurity\\.org\\.\\+163\\+24158\\.key</default>
#    <description>DNSSEC Key Path</description>
#    <info>This is the full path to the dnssec .key file used by your organization.</info>
#  </variable>
#  <variable>
#    <name>DNSSEC_PRIVATE_PATH</name>
#    <default>/etc/Kns1-ns2\\.cisecurity\\.org\\.\\+157\\+12122\\.private</default>
#    <description>DNSSEC Private Path</description>
#    <info>This is the full path to the dnssec .private file used by your organization.</info>
#  </variable>
#  <variable>
#    <name>TSIG_KEY_PATH_1</name>
#    <default>/etc/ns1-slave1\\.key</default>
#    <description>TSIG Key 1 Path</description>
#    <info>This is the full path to the first TSIG key included in named.conf.</info>
#  </variable>
#  <variable>
#    <name>TSIG_KEY_PATH_2</name>
#    <default>/etc/ns1-slave2\\.key</default>
#    <description>TSIG Key 2 Path</description>
#    <info>This is the full path to the second TSIG key included in named.conf.</info>
#  </variable>
#  <variable>
#    <name>TRANSFER_SERVER_1</name>
#    <default>192\\.168\\.1\\.53</default>
#    <description>Zone Transfer Server 1</description>
#    <info>This is the zone transfer server associated with TSIG Key 1 included in named.conf.</info>
#  </variable>
#  <variable>
#    <name>TRANSFER_SERVER_2</name>
#    <default>192\\.168\\.1\\.54</default>
#    <description>Zone Transfer Server 2</description>
#    <info>This is the zone transfer server associated with TSIG Key 2 included in named.conf.</info>
#  </variable>
#  <variable>
#    <name>TSIG_KEY_NAME_1</name>
#    <default>ns1-slave1_key</default>
#    <description>TSIG Key 1 Name</description>
#    <info>This is name of the first TSIG key in named.conf and associated with Zone Transfer Server 1.</info>
#  </variable>
#  <variable>
#    <name>TSIG_KEY_NAME_2</name>
#    <default>ns1-slave2_key</default>
#    <description>TSIG Key 2 Name</description>
#    <info>This is name of the second TSIG key in named.conf and associated with Zone Transfer Server 2.</info>
#  </variable>
#  <variable>
#    <name>TRANSFER_ZONE_TSIG_KEY</name>
#    <default>ns1-dhcp_server1\\.key</default>
#    <description>Zone TSIG Key</description>
#    <info>This is TSIG key associated with the transfer zone.</info>
#  </variable>
#  <variable>
#    <name>TRANSFER_ZONE_NAME</name>
#    <default>dynamic\\.example\\.com</default>
#    <description>Transfer Zone Name</description>
#    <info>This is name of the transfer zone.</info>
#  </variable>
#  <variable>
#    <name>TKEY_CREDENTIAL</name>
#    <default>DNS/dns\\.example\\.com</default>
#    <description>GSS-TSIG Credential</description>
#    <info>This is the tkey-gssapi-credential value which should be used in the options section of named.conf.</info>
#  </variable>
#  <variable>
#    <name>TKEY_DOMAIN</name>
#    <default>dns\\.example\\.com</default>
#    <description>GSS-TSIG Domain</description>
#    <info>This is the tkey-domain value which should be used in the options section of named.conf.</info>
#  </variable>
#  <variable>
#    <name>GSS_KEY_NAME</name>
#    <default>dns\\.example\\.com</default>
#    <description>GSS Key Name</description>
#    <info>This is the GSS key name which should be used to define the algorithm in named.conf.</info>
#  </variable>
#  <variable>
#    <name>GSS_SECRET_KEY_NAME</name>
#    <default>Secret_GSS_Key</default>
#    <description>GSS Secret Key Name</description>
#    <info>This is the GSS secret key name which should be used to define the key in named.conf.</info>
#  </variable>
#  <variable>
#    <name>DHCID_KEY_PATH</name>
#    <default>ns1-dhcp\\.cissecurity\\.key</default>
#    <description>DHCID Key Path</description>
#    <info>This is the full path to the DHCID TSIG key which should be defined in named.conf.</info>
#  </variable>
#  <variable>
#    <name>DNSSEC_KEY_NAME</name>
#    <default>Kexample\\.com\\.\\+001\\+13453\\.key</default>
#    <description>DNSSEC Key Name</description>
#    <info>This is the name of the dnssec .key file used by your organization.</info>
#  </variable>
#  <variable>
#    <name>BLACKHOLE_ADDRESS</name>
#    <default>10/8; 192.168/16; 172.16/12;</default>
#    <description>Blackhole Addresses</description>
#    <info>This is the list of all private RFC 1918 addresses not in use by your organization.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "ISC BIND 9.0 or greater is instaled"
      rpm         : "bind-9.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "ISC BIND 9.5 or lower is instaled"
      rpm         : "bind-9.6.0-0"
      operator    : "lt"
      required    : YES
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS DNS BIND 9.0 - 9.5 v2.0.0"
    </report>

    <report type:"WARNING">
      description : "1.1.2 Utilize a Split-Horizon Architecture"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <report type:"WARNING">
      description : "1.1.3 Slave DNS servers"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <report type:"WARNING">
      description : "1.2 Validate Name Registration Security"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <report type:"WARNING">
      description : "1.3 Secure DNS service operating platform"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <report type:"WARNING">
      description : "1.4 Verify Security of Forwarding Partners"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "2.1.1 Secure Installation via ISC Source"
      info          : "NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      reference     : "800-53|SI-7,CSF|PR.DS-6,ITSG-33|SI-7,LEVEL|1NS,NESA|T3.4.1,NESA|T7.3.2,NESA|T7.3.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/rpm --verify bind"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "2.2 Run BIND as a non-root user 'id named'"
      reference     : "800-171|3.1.6,800-53|AC-6(2),CSF|PR.AC-4,ITSG-33|AC-6(2),LEVEL|1S,NESA|T5.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/usr/bin/id named"
      expect        : "^uid=[0-9]{2,}\\(named\\)"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "2.2 Run BIND as a non-root user '-u named'"
      reference   : "800-171|3.1.6,800-53|AC-6(2),CSF|PR.AC-4,ITSG-33|AC-6(2),LEVEL|1S,NESA|T5.1.1"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/rc.d/init.d/named"
      regex       : "^[\\s]*[dD][aA][eE][mM][oO][nN]"
      expect      : "[dD][aA][eE][mM][oO][nN]\\s+/usr/sbin/[\$]named\\s+-u\\s+named\\s+[\$]{OPTIONS};"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'bind'"
      reference   : "800-171|3.14.1,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,SWIFT-CSCv1|2.2"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "bind-9.5.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'bind-chroot'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "bind-chroot-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'bind-libs'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "bind-libs-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'bind-utils'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "bind-utils-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'syslog'"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/sysconfig/syslog"
      regex       : "^[\\s]*SYSLOGD_OPTIONS"
      expect      : "-a /var/named/chroot/dev/log"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm '/var/named/chroot/var/log'"
      info        : ""
      info        : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/log'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/log"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "2.3.2 RedHat bind-chroot Rpm 'ROOTDIR'"
      reference   : "800-171|3.13.3,800-53|SC-2,ITSG-33|SC-2,LEVEL|1S,NESA|T3.4.1,NIAv2|SS15b"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/sysconfig/named"
      regex       : "^[\\s]*ROOTDIR"
      expect      : "ROOTDIR\\s*=\\s*/var/named/chroot\\s*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot"
      owner       : "root"
      mask        : "7027"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/etc'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/etc"
      owner       : "root"
      mask        : "7027"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/etc/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/etc/*"
      owner       : "root"
      mask        : "7027"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var"
      owner       : "root"
      mask        : "7027"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/*"
      owner       : "root"
      mask        : "7027"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/dev'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/dev"
      owner       : "root"
      mask        : "7227"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/proc'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/proc"
      owner       : "root"
      mask        : "7222"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/run/named'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/run/named"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/run/named/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/run/named/*"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/tmp'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/tmp"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/tmp/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/tmp/*"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/log/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/log/*"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/data'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/data"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/data/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/data/*"
      owner       : "root"
      mask        : "7007"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/slaves'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/slaves"
      owner       : "root"
      mask        : "7007"
      required    : NO
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/slaves/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/slaves/*"
      owner       : "root"
      mask        : "7007"
      required    : NO
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/ddns'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/ddns"
      owner       : "root"
      mask        : "7007"
      required    : NO
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "2.4.1 Set permissions on BIND chroot-ed directories '/var/named/chroot/var/named/ddns/*'"
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/var/named/ddns/*"
      owner       : "root"
      mask        : "7007"
      required    : NO
      group       : "named"
    </custom_item>

#<custom_item>
# system		: "Linux"
# type		: CMD_EXEC
# description	: "2.4.1 Set permissions on BIND chroot-ed directories 'find'"
# reference : "LEVEL|1S"
# see_also : "https://workbench.cisecurity.org/files/652"
# cmd		: "/usr/bin/find / -xdev -user named -type d -perm -222"
# expect		: ""
#
# dont_echo_cmd	: YES
#</custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'libselinux-devel'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "libselinux-devel-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'libselinux'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "libselinux-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'selinux-policy-targeted'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "selinux-policy-targeted-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'selinux-policy-targeted-sources'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "selinux-policy-targeted-sources-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'selinux-doc'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "selinux-doc-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : RPM_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'checkpolicy'"
      reference   : "800-171|3.4.8,800-53|CM-7(5),CSCv6|2.2,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.5.1,ISO/IEC-27001|A.12.6.2,ITSG-33|SI-2,LEVEL|1S,PCI-DSSv3.1|12.3.7,PCI-DSSv3.2|12.3.7,SWIFT-CSCv1|2.3,TBA-FIISB|44.2.2,TBA-FIISB|49.2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      rpm         : "checkpolicy-0.0.0-0"
      operator    : "gt"
      required    : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'SELINUX'"
      reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|1S,NESA|T5.5.4,NESA|T7.5.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/selinux/config"
      regex       : "SELINUX=.*"
      expect      : "SELINUX=[eE][nN][fF][oO][rR][cC][iI][nN][gG]\\s*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "2.4.2 Restrict BIND Access with SELinux 'SELINUXTYPE'"
      reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|1S,NESA|T5.5.4,NESA|T7.5.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/selinux/config"
      regex       : "SELINUXTYPE=.*"
      expect      : "SELINUXTYPE=[tT][aA][rR][gG][eE][tT][eE][dD]\\s*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "2.4.2 Restrict BIND Access with SELinux 'named_disable_trans'"
      reference     : "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|1S,NESA|T5.5.4,NESA|T7.5.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/usr/sbin/getsebool named_disable_trans"
      expect        : "off"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "2.4.2 Restrict BIND Access with SELinux 'named_write_master_zones'"
      reference     : "800-171|3.1.1,800-171|3.1.2,800-53|AC-3(3),CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3(3),LEVEL|1S,NESA|T5.5.4,NESA|T7.5.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/usr/sbin/getsebool named_write_master_zones"
      expect        : "off"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.1 Hide BIND Version String"
      reference     : "800-53|SC-30(5),LEVEL|1S,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i version"
      expect        : "^\\s*[vV][eE][rR][sS][iI][oO][nN]\\s+\"[nN][oO][nN][eE]\";\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.1 Restrict Recursive Queries"
      info          : "NOTE : CIS allows this value to be in global options or in every zone. As zone files will vary per site, this query is written to examine"
      info          : "the global options. This removes the concern of zone files which may be created after auditing lacking the necessary values."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i allow-recursion"
      expect        : "[aA][lL][lL][oO][wW]-[rR][eE][cC][uU][rR][sS][iI][oO][nN]\\s+{\\s+[lL][oO][cC][aA][lL][hH][oO][sS][tT];\\s+[tT][rR][uU][sS][tT][eE][dD]_[cC][lL][iI][eE][nN][tT][sS]\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.2.2 Restrict Query Origins 'local'"
      reference   : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "^[\\s]*[aA][cC][lL]\\s+[\"][lL][oO][cC][aA][lL][\"]\\s+{\\s+127\.0\.0\.1;\\s+};"
      expect      : "^[\\s]*[aA][cC][lL]\\s+[\"][lL][oO][cC][aA][lL][\"]\\s+{\\s+127\.0\.0\.1;\\s+};"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.2.2 Restrict Query Origins 'mynets'"
      info        : "NOTE: Update INTERNAL_NETWORK with the appropriate value for the local environment."
      reference   : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "^[\\s]*[aA][cC][lL]\\s+[\"][mM][yY][nN][eE][tT][sS][\"]\\s"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\\\.0\\\\.2\\\\.0/24" in field "expect".
      expect      : "^[\\s]*[aA][cC][lL]\\s+[\"][mM][yY][nN][eE][tT][sS][\"]\\s+{\\s+192\\\\.0\\\\.2\\\\.0/24;\\s+};"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.2 Restrict Query Origins 'allow-query'"
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i allow-query"
      expect        : "^\\s*[aA][lL][lL][oO][wW]-[qQ][uU][eE][rR][yY]\\s+{\\s+[lL][oO][cC][aA][lL];\\s+[mM][yY][nN][eE][tT][sS];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.3 Restrict Access to Cache 'trusted, local IP network'"
      info          : "NOTE: Update INTERNAL_NETWORK with the appropriate value for the local environment."
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[aA][cC][lL]\ +\"[tT][rR][uU][sS][tT][eE][dD]\"/,/^};\\s*$/' /etc/named.conf"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\\\.0\\\\.2\\\\.0/24" in field "expect".
      expect        : "192\\\\.0\\\\.2\\\\.0/24;"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.3 Restrict Access to Cache 'trusted, localhost'"
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[aA][cC][lL]\ +\"[tT][rR][uU][sS][tT][eE][dD]\"/,/^};\\s*$/' /etc/named.conf"
      expect        : "[lL][oO][cC][aA][lL][hH][oO][sS][tT];"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.3 Restrict Access to Cache 'trusted, localnets'"
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[aA][cC][lL]\ +\"[tT][rR][uU][sS][tT][eE][dD]\"/,/^};\\s*$/' /etc/named.conf"
      expect        : "[lL][oO][cC][aA][lL][nN][eE][tT][sS];"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.3 Restrict Access to Cache 'allow-recursion'"
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i allow-recursion"
      expect        : "^\\s*[aA][lL][lL][oO][wW]-[rR][eE][cC][uU][rR][sS][iI][oO][nN]\\s+{\\s+[tT][rR][uU][sS][tT][eE][dD];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.3 Restrict Access to Cache 'allow-query-cache'"
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i allow-query-cache"
      expect        : "^\\s*[aA][lL][lL][oO][wW]-[qQ][uU][eE][rR][yY]-[cC][aA][cC][hH][eE]\\s+{\\s+[tT][rR][uU][sS][tT][eE][dD];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.2.4 Do not use BIND9 Views for split horizons"
      reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[vV][iI][eE][wW] +\"[eE][xX][tT][eE][rR][nN][aA][lL]\"/,/^};$/' /etc/named.conf | /bin/grep -i match-clients"
      expect        : "^\\s*[mM][aA][tT][cC][hH]-[cC][lL][iI][eE][nN][tT][sS]\\s+{\\s+[aA][nN][yY];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.3.1 dnssec-keygen Algorithms 'IN KEY'"
      info        : "NOTE: Update DNSSEC_KEY_PATH with the appropriate value for the local environment."
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/652"
# Note: Variable @DNSSEC_KEY_PATH@ replaced with "/etc/Kns1-ns2\\\\.cisecurity\\\\.org\\\\.\\\\+163\\\\+24158\\\\.key" in field "file".
      file        : "/etc/Kns1-ns2\\\\.cisecurity\\\\.org\\\\.\\\\+163\\\\+24158\\\\.key"
      regex       : "IN KEY 512"
      expect      : "[-a-zA-Z0-9.]+ IN KEY 512 3 [0-9]+ [+a-zA-Z0-9/=]{44}"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.3.1 dnssec-keygen Algorithms 'HMAC-SHA256'"
      info        : "NOTE: Update DNSSEC_PRIVATE_PATH with the appropriate value for the local environment."
      reference   : "800-171|3.13.11,800-53|SC-13,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,LEVEL|1S,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e"
      see_also    : "https://workbench.cisecurity.org/files/652"
# Note: Variable @DNSSEC_PRIVATE_PATH@ replaced with "/etc/Kns1-ns2\\\\.cisecurity\\\\.org\\\\.\\\\+157\\\\+12122\\\\.private" in field "file".
      file        : "/etc/Kns1-ns2\\\\.cisecurity\\\\.org\\\\.\\\\+157\\\\+12122\\\\.private"
      regex       : "^[\\s]*Algorithm:\\s"
      expect      : "HMAC[-_]SHA256"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.3.2 Include TSIG key in named.conf 'TSIG key 1'"
      info        : "NOTE: Update TSIG_KEY_PATH_1 with the appropriate value for the local environment."
      reference   : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
# Note: Variable @TSIG_KEY_PATH_1@ replaced with "/etc/ns1-slave1\\\\.key" in field "regex".
      regex       : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]/etc/ns1-slave1\\\\.key[\"];"
# Note: Variable @TSIG_KEY_PATH_1@ replaced with "/etc/ns1-slave1\\\\.key" in field "expect".
      expect      : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]/etc/ns1-slave1\\\\.key[\"];"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.3.2 Include TSIG key in named.conf 'TSIG key 2'"
      info        : "NOTE: Update TSIG_KEY_PATH_2 with the appropriate value for the local environment."
      reference   : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
# Note: Variable @TSIG_KEY_PATH_2@ replaced with "/etc/ns1-slave2\\\\.key" in field "regex".
      regex       : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]/etc/ns1-slave2\\\\.key[\"];"
# Note: Variable @TSIG_KEY_PATH_2@ replaced with "/etc/ns1-slave2\\\\.key" in field "expect".
      expect      : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]/etc/ns1-slave2\\\\.key[\"];"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "3.3.2 Include TSIG key in named.conf 'TSIG key 1 permissions'"
      info        : "NOTE : CIS only states 'Verify that the files permissions are limited.' for permissions here.  Assuming values of root:named, mode 550."
      info        : "NOTE: Update TSIG_KEY_PATH_1 with the appropriate value for the local environment."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TSIG_KEY_PATH_1@ replaced with "/etc/ns1-slave1\\\\.key" in field "file".
      file        : "/etc/ns1-slave1\\\\.key"
      owner       : "root"
      mask        : "7227"
      group       : "named"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CHECK
      description : "3.3.2 Include TSIG key in named.conf 'TSIG key 2 permissions'"
      info        : "NOTE : CIS only states 'Verify that the files permissions are limited.' for permissions here.  Assuming values of root:named, mode 550."
      info        : "NOTE: Update TSIG_KEY_PATH_2 with the appropriate value for the local environment."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TSIG_KEY_PATH_2@ replaced with "/etc/ns1-slave2\\\\.key" in field "file".
      file        : "/etc/ns1-slave2\\\\.key"
      owner       : "root"
      mask        : "7227"
      group       : "named"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.4 Restrict Zone-Transfers 'allow-transfer'"
      info          : "NOTE: Update TSIG_KEY_NAME_1 with the appropriate value for the local environment."
      info          : "NOTE: Update TSIG_KEY_NAME_2 with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i allow-transfer"
# Note: Variable @TSIG_KEY_NAME_1@ replaced with "ns1-slave1_key" in field "expect".
# Note: Variable @TSIG_KEY_NAME_2@ replaced with "ns1-slave2_key" in field "expect".
      expect        : "^\\s*[aA][lL][lL][oO][wW]-[tT][rR][aA][nN][sS][fF][eE][rR]\\s+{\\s+[kK][eE][yY]\\s+\"ns1-slave1_key\";\\s+[kK][eE][yY]\\s+\"ns1-slave2_key\"\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.4 Restrict Zone-Transfers 'Zone Transfer Server 1'"
      info          : "NOTE: Update TSIG_KEY_NAME_1 with the appropriate value for the local environment."
      info          : "NOTE: Update TRANSFER_SERVER_1 with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.53" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[sS][eE][rR][vV][eE][rR] 192\\\\.168\\\\.1\\\\.53/,/};/' /etc/named.conf | /bin/grep keys"
      expect        : "^\\s*[kK][eE][yY][sS]\\s+{\\s+\"TSIG_KEY_NAME_1\\s+[kK][eE][yY]\";\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.4 Restrict Zone-Transfers 'Zone Transfer Server 2'"
      info          : "NOTE: Update TSIG_KEY_NAME_2 with the appropriate value for the local environment."
      info          : "NOTE: Update TRANSFER_SERVER_2 with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_SERVER_2@ replaced with "192\\\\.168\\\\.1\\\\.54" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[sS][eE][rR][vV][eE][rR] 192\\\\.168\\\\.1\\\\.54/,/};/' /etc/named.conf | /bin/grep keys"
      expect        : "^\\s*[kK][eE][yY][sS]\\s+{\\s+\"TSIG_KEY_NAME_2\\s+[kK][eE][yY]\";\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.1 Using Update Policy 'zone'"
      info          : "NOTE : This query uses a sample master zone file/domain name and should be changed to reflect the target environment."
      info          : "NOTE: Update TRANSFER_ZONE_TSIG_KEY with the appropriate value for the local environment."
      info          : "NOTE: Update TRANSFER_ZONE_NAME with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_ZONE_TSIG_KEY@ replaced with "ns1-dhcp_server1\\\\.key" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[iI][nN][cC][lL][uU][dD][eE] *\"ns1-dhcp_server1\\\\.key\"/,/^};\\s*$/' /etc/named.conf"
# Note: Variable @TRANSFER_ZONE_NAME@ replaced with "dynamic\\\\.example\\\\.com" in field "expect".
      expect        : "[zZ][oO][nN][eE]\\s+\"dynamic\\\\.example\\\\.com\"\\s+{\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.1 Using Update Policy 'type master'"
      info          : "NOTE: Update TRANSFER_ZONE_NAME with the appropriate value for the local environment."
      reference     : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_ZONE_NAME@ replaced with "dynamic\\\\.example\\\\.com" in field "cmd".
      cmd           : "/bin/awk '/[zZ][oO][nN][eE] *\"dynamic\\\\.example\\\\.com\"/,/};\\s*$/' /etc/named.conf | /bin/grep -i type"
      expect        : "[tT][yY][pP][eE]\\s+[mM][aA][sS][tT][eE][rR]\\s;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.1 Using Update Policy 'update-policy'"
      info          : "NOTE: Update TRANSFER_ZONE_NAME with the appropriate value for the local environment."
      reference     : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_ZONE_NAME@ replaced with "dynamic\\\\.example\\\\.com" in field "cmd".
      cmd           : "/bin/awk '/[zZ][oO][nN][eE] *\"dynamic\\\\.example\\\\.com\"/,/};\\s*$/' /etc/named.conf | /bin/grep -i update"
      expect        : "[uU][pP][dD][aA][tT][eE]-[pP][oO][lL][iI][cC][yY]\\s{\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.1 Using Update Policy 'grant'"
      info          : "NOTE: Update TSIG_KEY_NAME_1 with the appropriate value for the local environment."
      info          : "NOTE: Update TRANSFER_ZONE_NAME with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[uU][pP][dD][aA][tT][eE]-[pP][oO][lL][iI][cC][yY]/,/};\\s*$/' /etc/named.conf | /bin/grep -i grant"
# Note: Variable @TSIG_KEY_NAME_1@ replaced with "ns1-slave1_key" in field "expect".
# Note: Variable @TRANSFER_ZONE_NAME@ replaced with "dynamic\\\\.example\\\\.com" in field "expect".
      expect        : "[gG][rR][aA][nN][tT]\\s+ns1-slave1_key\\s+[nN][aA][mM][eE]\\s+dynamic\\\\.example\\\\.com\\s+A;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.1 Using Update Policy 'keys'"
      info          : "NOTE: Update TRANSFER_SERVER_1 with the appropriate value for the local environment."
      info          : "NOTE: Update TSIG_KEY_NAME_1 with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @TRANSFER_SERVER_1@ replaced with "192\\\\.168\\\\.1\\\\.53" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[sS][eE][rR][vV][eE][rR] 192\\\\.168\\\\.1\\\\.53/,/};/' /etc/named.conf | /bin/grep -i keys"
# Note: Variable @TSIG_KEY_NAME_1@ replaced with "ns1-slave1_key" in field "expect".
      expect        : "[kK][eE][yY][sS]\\s+{\\s+ns1-slave1_key;\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.2 Enable GSS-TSIG 'tkey-gssapi-credential'"
      info          : "NOTE: Update TKEY_CREDENTIAL with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i server\\ tkey-gssapi-credential"
# Note: Variable @TKEY_CREDENTIAL@ replaced with "DNS/dns\\\\.example\\\\.com" in field "expect".
      expect        : "^\\s*[tT][kK][eE][yY]-[gG][sS][sS][aA][pP][iI]-[cC][rR][eE][dD][eE][nN][tT][iI][aA][lL]\\s+\"DNS/dns\\\\.example\\\\.com\";\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.2 Enable GSS-TSIG 'tkey-domain'"
      info          : "NOTE: Update TKEY_DOMAIN with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i server\\ tkey-domain"
# Note: Variable @TKEY_DOMAIN@ replaced with "dns\\\\.example\\\\.com" in field "expect".
      expect        : "^\\s*[tT][kK][eE][yY]-[dD][oO][mM][aA][iI][nN]\\s+\"dns\\\\.example\\\\.com\";\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.2 Enable GSS-TSIG 'algorithm'"
      info          : "NOTE: Update GSS_KEY_NAME with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @GSS_KEY_NAME@ replaced with "dns\\\\.example\\\\.com" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[kK][eE][yY] dns\\\\.example\\\\.com/,/};$/' /etc/named.conf | /bin/grep -i algorithm"
      expect        : "^\\s*[aA][lL][gG][oO][rR][iI][tT][hH][mM]\\s+[gG][sS][sS]-[tT][sS][iI][gG];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.5.2 Enable GSS-TSIG 'key'"
      info          : "NOTE: Update GSS_KEY_NAME with the appropriate value for the local environment."
      info          : "NOTE: Update GSS_SECRET_KEY_NAME with the appropriate value for the local environment."
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
# Note: Variable @GSS_KEY_NAME@ replaced with "dns\\\\.example\\\\.com" in field "cmd".
      cmd           : "/bin/awk '/^[\\s]*[kK][eE][yY] dns\\\\.example\\\\.com/,/};$/' /etc/named.conf | /bin/grep -i key"
# Note: Variable @GSS_SECRET_KEY_NAME@ replaced with "Secret_GSS_Key" in field "expect".
      expect        : "^\\s*[kK][eE][yY]\\s+Secret_GSS_Key;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.5.3 DHCID"
      info        : "NOTE: Update DHCID_KEY_PATH with the appropriate value for the local environment."
      reference   : "800-171|3.4.2,800-53|CM-6,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,LEVEL|1S,NESA|T3.2.1,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
# Note: Variable @DHCID_KEY_PATH@ replaced with "ns1-dhcp\\\\.cissecurity\\\\.key" in field "regex".
      regex       : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]ns1-dhcp\\\\.cissecurity\\\\.key[\"];\\s*$"
# Note: Variable @DHCID_KEY_PATH@ replaced with "ns1-dhcp\\\\.cissecurity\\\\.key" in field "expect".
      expect      : "^[\\s]*[iI][nN][cC][lL][uU][dD][eE]\\s+[\"]ns1-dhcp\\\\.cissecurity\\\\.key[\"];\\s*$"
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK
      description : "3.6 Implement DNSSEC 'INCLUDE'"
      info        : "NOTE : Per CIS, the following should be run after ensuring the file contents are in place :"
      info        : " dnssec-signzone -o example.com example.com"
      info        : "NOTE: Update DNSSEC_KEY_NAME with the appropriate value for the local environment."
      reference   : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/var/named/chroot/etc/example.com"
      regex       : "^[\\s]*[\$]INCLUDE\\s"
# Note: Variable @DNSSEC_KEY_NAME@ replaced with "Kexample\\\\.com\\\\.\\\\+001\\\\+13453\\\\.key" in field "expect".
      expect      : "^[\\s]*[\$]INCLUDE\\s+Kexample\\\\.com\\\\.\\\\+001\\\\+13453\\\\.key\\s*$"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.6 Implement DNSSEC 'dnssec-enable'"
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i dnssec-enable"
      expect        : "^\\s*[dD][nN][sS][sS][eE][cC]-[eE][nN][aA][bB][lL][eE]\\s+[yY][eE][sS];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.6 Implement DNSSEC 'dnssec-validation'"
      reference     : "800-53|SC-20,ITSG-33|SC-20,LEVEL|1S,NESA|T4.5.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[oO][pP][tT][iI][oO][nN][sS]/,/^};\\s*$/' /etc/named.conf | /bin/grep -i dnssec-validation"
      expect        : "^\\s*[dD][nN][sS][sS][eE][cC]-[vV][aA][lL][iI][dD][aA][tT][iI][oO][nN]\\s+[yY][eE][sS];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "3.7 Disable dnssec-accept-expired option"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "^[\\s]*[dD][nN][sS][sS][eE][cC]-[aA][cC][cC][eE][pP][tT]-[eE][xX][pP][iI][rR][eE][dD]"
      expect      : "^[\\s]*[dD][nN][sS][sS][eE][cC]-[aA][cC][cC][eE][pP][tT]-[eE][xX][pP][iI][rR][eE][dD]"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.8 Ignore erroneous or unwanted traffic 'Private RFC 1918 addresses'"
      info          : "NOTE : Update BLACKHOLE_ADDR with the appropriate values for the local environment"
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[bB][lL][aA][cC][kK][hH][oO][lL][eE]/,/};$/' /etc/named.conf"
# Note: Variable @BLACKHOLE_ADDRESS@ replaced with "10/8; 192.168/16; 172.16/12;" in field "expect".
      expect        : "^\\s*10/8; 192.168/16; 172.16/12;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.8 Ignore erroneous or unwanted traffic 'Multicast'"
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[bB][lL][aA][cC][kK][hH][oO][lL][eE],/};$/' /etc/named.conf"
      expect        : "^\\s*224/8;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "3.8 Ignore erroneous or unwanted traffic 'Link Local'"
      reference     : "800-171|3.13.1,800-53|SC-7(12),ITSG-33|SC-7(12),LEVEL|1S,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[bB][lL][aA][cC][kK][hH][oO][lL][eE]/,/};$/' /etc/named.conf"
      expect        : "^\\s*169\.254/16;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.1 Ensure revision current"
      info          : "NOTE : Versions of BIND higher than 9.5 exist and are allowed for in this query, though the benchmark is only assured to 9.5 ."
      reference     : "800-171|3.14.1,800-53|SI-2,CN-L3|8.1.10.5(a),CN-L3|8.1.10.5(b),CN-L3|8.1.4.4(e),CN-L3|8.5.4.1(b),CN-L3|8.5.4.1(d),CN-L3|8.5.4.1(e),CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,LEVEL|1S,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,SWIFT-CSCv1|2.2"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/usr/sbin/named -v"
      expect        : "^\\s*BIND 9\.[3-9]\."
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.2 Remove Nameserver ID"
      reference   : "800-53|SC-30(5),LEVEL|1S,NIAv2|GS8f,NIAv2|NS1,NIAv2|NS28"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "[sS][eE][rR][vV][eE][rR]-[iI][dD]"
      expect      : "[sS][eE][rR][vV][eE][rR]-[iI][dD]\\s+[nN][oO][nN][eE];"
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.1 Configure a syslog channel 'syslog daemon'"
      reference     : "800-171|3.3.8,800-53|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ITSG-33|AU-9(2),LEVEL|1S,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[sS][yY][sS][lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[sS][yY][sS][lL][oO][gG]\\s+[dD][aA][eE][mM][oO][nN];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.1 Configure a syslog channel 'severity info'"
      reference     : "800-171|3.3.8,800-53|AU-9(2),CN-L3|8.1.3.5(d),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ITSG-33|AU-9(2),LEVEL|1S,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[sS][yY][sS][lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[sS][eE][vV][eE][rR][iI][tT][yY]\\s+[iI][nN][fF][oO];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.1 Configure a syslog channel 'default local_syslog'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[dD][eE][fF][aA][uU][lL][tT]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][yY][sS][lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.1 Configure a syslog channel 'general local_syslog'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[gG][eE][nN][eE][rR][aA][lL]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][yY][sS][lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'secure.log'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[fF][iI][lL][eE]\\s+\"/var/run/named/secure.log\"\\s+[vV][eE][rR][sS][iI][oO][nN][sS]\\s+10\\s+[sS][iI][zZ][eE]\\s+20m;\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'severity'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[sS][eE][vV][eE][rR][iI][tT][yY]\\s+[dD][eE][bB][uU][gG];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'print-time'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[pP][rR][iI][nN][tT]-[tT][iI][mM][eE]\\s+[yY][eE][sS];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'config'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[cC][oO][nN][fF][iI][gG]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'dnssec'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG],/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[dD][nN][sS][sS][eE][cC]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'network'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[nN][eE][tT][wW][oO][rR][kK]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'security'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[sS][eE][cC][uU][rR][iI][tT][yY]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'update'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[uU][pP][dD][aA][tT][eE]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'xfer-in'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[xX][fF][eE][rR]-[iI][nN]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'xfer-out'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep -i category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[xX][fF][eE][rR]-[oO][uU][tT]\\s+{\\s+[lL][oO][cC][aA][lL]_[sS][eE][cC][uU][rR][iI][tT][yY]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'debug.log'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[dD][eE][bB][uU][gG]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[fF][iI][lL][eE] \"/var/run/named/debug.log\";\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'debug.log severity dynamic'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[dD][eE][bB][uU][gG]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[sS][eE][vV][eE][rR][iI][tT][yY]\\s+[dD][yY][nN][aA][mM][iI][cC];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'debug.log print-time'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/[cC][hH][aA][nN][nN][eE][lL] [lL][oO][cC][aA][lL]_[dD][eE][bB][uU][gG]_[lL][oO][gG]/,/};$/' /etc/named.conf"
      expect        : "^\\s*[pP][rR][iI][nN][tT]-[tT][iI][mM][eE]\\s+[yY][eE][sS];\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'default local_debug'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[dD][eE][fF][aA][uU][lL][tT]\\s+{\\s+[lL][oO][cC][aA][lL]_[dD][eE][bB][uU][gG]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system        : "Linux"
      type          : CMD_EXEC
      description   : "4.3.2 Configure a File Channel 'general local_debug'"
      reference     : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,LEVEL|1S,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1"
      see_also      : "https://workbench.cisecurity.org/files/652"
      cmd           : "/bin/awk '/^[\\s]*[lL][oO][gG][gG][iI][nN][gG]/,/^};$/' /etc/named.conf | /bin/grep category"
      expect        : "^\\s*[cC][aA][tT][eE][gG][oO][rR][yY]\\s+[gG][eE][nN][eE][rR][aA][lL]\\s+{\\s+[lL][oO][cC][aA][lL]_[dD][eE][bB][uU][gG]_[lL][oO][gG];\\s+};\\s*$"
      dont_echo_cmd : YES
    </custom_item>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.3.3 Disable the HTTP Statistics Server"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "[sS][tT][aA][tT][iI][sS][tT][iI][cC][sS]-[cC][hH][aA][nN][nN][eE][lL]"
      expect      : "[sS][tT][aA][tT][iI][sS][tT][iI][cC][sS]-[cC][hH][aA][nN][nN][eE][lL]"
    </custom_item>

    <report type:"WARNING">
      description : "4.4 Defend against Denial of Service Attacks"
      info        : "Per CIS, general recommendations are made for section 4.4:"
      info        : " 1. Security hardening of the server, including DoS mitigation configurations recommended in the appropriate Unix or Linux CIS benchmark"
      info        : " 2. Install redundant distributed DNS servers externally and internally"
      info        : " 3. Add filtering controls on the firewalls and routers in front of the DNS servers to eliminate many forms of unwanted traffic"
      info        : "NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      reference   : "LEVEL|1NS"
      see_also    : "https://workbench.cisecurity.org/files/652"
    </report>

    <custom_item>
      system      : "Linux"
      type        : FILE_CONTENT_CHECK_NOT
      description : "4.5 Do not define a static source port"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,LEVEL|1S,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,SWIFT-CSCv1|2.3"
      see_also    : "https://workbench.cisecurity.org/files/652"
      file        : "/etc/named.conf"
      regex       : "[qQ][uU][eE][rR][yY]-[sS][oO][uU][rR][cC][eE]"
      expect      : "[qQ][uU][eE][rR][yY]-[sS][oO][uU][rR][cC][eE]"
    </custom_item>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS DNS BIND 9.0 - 9.5 v2.0.0"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
    </report>
  </else>
</if>

</check_type>
