#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.26 $
# $Date: 2020/07/14 $
#
# Description	: This .audit is designed to query the Mac OS X 10.5 operating system
# 	  		as defined by the DISA STIG guidelines for Mac OS X 10.5 Version 1, Release 2
#
# 			The benchmark can be downloaded from:
#
# 			http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip
#
# NOTE			: Some queries in this .audit require site-specific data to be known to the query in order to function properly.  Please note the following
# 			queries and edit their values accordingly.
#
# 			OSX00100 - Create an access warning for the login window
# 			OSX00105 - Create an access warning for the command line
# 			OSX00155 - Enable remote logging
# 			OSX00195 - Software Update Server URL is restricted to authorized DoD server
# 			OSX00285 - Set a secure time server
#
#<ui_metadata>
#<display_name>DISA STIG Apple Mac OSX 10.5 v1r2</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Apple Mac OSX 10.5</name>
#  <version>1.2.0</version>
#  <link>http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip</link>
#</spec>
#<labels>unix,disa,macosx,macosx_10,macosx_10.5,agent</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>LOGIN_WINDOW_TEXT</name>
#    <default>Approved DOD Banner text</default>
#    <description>Login Window Banner</description>
#    <info>This is the banner text which should be displayed to users when logging into the GUI</info>
#  </variable>
#  <variable>
#    <name>BANNER_TEXT</name>
#    <default>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</default>
#    <description>Banner Text</description>
#    <info>This is the text for the warning a user receives when logging onto the system.</info>
#  </variable>
#  <variable>
#    <name>LOG_SERVER</name>
#    <default>example\\.log\\.server</default>
#    <description>Logging Server</description>
#    <info>This is the IP address assigned to your organization's central logging server</info>
#  </variable>
#  <variable>
#    <name>SOFTWARE_UPDATE_URL</name>
#    <default>http://su.example.com:8088/index.sucatalog</default>
#    <description>Software Update URL</description>
#    <info>This is the URL which should be used by the system for it's update information</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>time\\.nist\\.gov</default>
#    <description>NTP Server</description>
#    <info>This is the IP address or hostname of your organization's trusted time server</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<if>
  <condition type:"AND">
    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "Check if OS X 10.5 is installed"
      cmd         : "/usr/bin/defaults read /System/Library/CoreServices/SystemVersion ProductVersion"
      expect      : "^10\\.5\\.[0-9]*"
    </custom_item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "DISA_STIG_MacOSX_10.5_v1r2.audit"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00005 - Must have an HFS+ formatted drive."
      info        : "This is a category 1 finding because the ability to set access permissions and audit critical directories and files is only available by using the HFS+ file system. The capability to assign access permissions to file objects is a DoD policy requirement."
      solution    : "OSX00005-Manual option during image build process. Choose HFS+ formatted drive."
      reference   : "800-171|3.13.16,800-53|SC-28,8500.2|ECCD-1,8500.2|ECCD-2,CAT|I,CSF|PR.DS-1,ITSG-33|SC-28,Rule-ID|SV-31216r1_rule,Rule-ID|SV-31216r2_rule,SANS-CSC|3,STIG-ID|OSX00005,TBA-FIISB|28.1,Vuln-ID|V-25185"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/diskutil info /"
      expect      : "File System:[\\s\\t]+Journaled HFS\+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00010 - Do not install unnecessary packages."
      info        : "Removing unused packages frees disk space and reduces the risk of attackers finding vulnerabilities in unused components.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Review the packages that are installed using the following command- pkgutil / --pkgs  Determine if the installed packages are needed.  If not, verify any dependencies and use the rm command to remove them."
      reference   : "800-171|3.4.8,800-53|CM-7,8500.2|ECSC-1,CAT|II,CSF|PR.IP-1,CSF|PR.PT-3,ISO/IEC-27001|A.12.6.2,NIAv2|SS13a,PCI-DSS|2.2.4,Rule-ID|SV-31262r1_rule,SANS-CSC|3,STIG-ID|OSX00010,SWIFT-CSCv1|2.3,Vuln-ID|V-25187"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/pkgutil / --pkgs"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00012 - Verify file permissions"
      info        : "This command will check a very large number of files on the system against what the package manager's database indicates they should be.  This command will catch improperly loosened permissions.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Run the command- sudo diskutil repairPermissions /  Note- If permissions were made more restrictive than the package manager expects (as later rules require), then these tightened permissions will need to be reapplied after running this command."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|DCSW-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-32237r1_rule,STIG-ID|OSX00012,SWIFT-CSCv1|2.3,Vuln-ID|V-25881"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/diskutil verifyPermissions /"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00015 - Create administrator accounts with difficult-to-guess names"
      info        : "The administrator account has unlimited privileges to the system. Creating a complex name improves the protection of this account and the system. When creating an administrator account, do not use administrator, do not use the name of the machine, etc.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Select Finder. 2. Select Applications. 3. Select System Preferences. 4. Select Accounts. 5. Rename or recreate accounts with difficult-to-guess names."
      reference   : "800-171|3.1.1,800-53|AC-2,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS|2.1,Rule-ID|SV-31233r1_rule,SANS-CSC|16,STIG-ID|OSX00015,Vuln-ID|V-25200"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/dscl . -readall /Users | /usr/bin/egrep -i 'RealName: (admin|root|manager|superuser|operator|sysadm|supervisor)'"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <item>
      description : "OSX00020 - Maximum password age"
      info        : "The longer a password is in use, the greater the opportunity for someone to gain unauthorized knowledge of the passwords. Further, scheduled changing of passwords hinders the ability of unauthorized system users to crack passwords and gain access to a system."
      solution    : "Open a terminal session and use the following command to set the value for maximum password age- sudo pwpolicy -n  -setglobalpolicy 'maxMinutesUntilChangePassword=86400'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'maxMinutesUntilChangePassword=86400'."
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-31239r1_rule,SANS-CSC|16,STIG-ID|OSX00020,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-25204"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      name        : "max_password_age"
      value       : "MIN..86400"
    </item>

    <item>
      description : "OSX00025 - Minimum password age"
      info        : "Permitting passwords to be changed in immediate succession within the same day, allows users to cycle passwords through their history database. This enables users to effectively negate the purpose of mandating periodic password changes."
      solution    : "Open a terminal session and use the following command to set the value for minimum password age- sudo pwpolicy -n  -setglobalpolicy 'minMinutesUntilChangePassword=1440'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'minMinutesUntilChangePassword=1440'."
      reference   : "800-171|3.5.10,800-171|3.5.7,800-171|3.5.8,800-171|3.5.9,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM20,NIAv2|AM21,PCI-DSSv3.1|8.2.4,PCI-DSSv3.2|8.2.4,Rule-ID|SV-31267r1_rule,SANS-CSC|16,STIG-ID|OSX00025,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.2,Vuln-ID|V-25226"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      name        : "min_password_age"
      value       : "1440..MAX"
    </item>

    <item>
      description : "OSX00030 - Minimum password length"
      info        : "Information systems not protected with strong password schemes, including passwords of minimum length, provide the opportunity for anyone to crack the password, thus, gaining access to the system and causing the device, information, or the local network to be compromised or lead to a denial of service."
      solution    : "Open a terminal session and use the following command to set the value for minimum password length- sudo pwpolicy -n  -setglobalpolicy 'minChars=15'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'minChars=15'."
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31272r1_rule,SANS-CSC|16,STIG-ID|OSX00030,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25230"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      name        : "minimum_password_length"
      value       : "15..MAX"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00035/OSX00565 - Create complex passwords for user accounts - 'requiresAlpha'"
      info        : "Configure the local system to verify that newly-created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.
Sites are responsible for installing password complexity software that complies with current DoD requirements."
      solution    : "Open a terminal session and run the following command- sudo pwpolicy -n  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'. For non managed systems the path /Local/Default would need to be added to the command, an example would be- pwpolicy -n /Local/Default  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'"
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|ECPA-1,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31279r1_rule,Rule-ID|SV-31552r1_rule,SANS-CSC|12,SANS-CSC|16,STIG-ID|OSX00035,STIG-ID|OSX00565,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25236,Vuln-ID|V-25366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "requiresAlpha[\\s\\t]*=[\\s\\t]*1[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00035/OSX00565 - Create complex passwords for user accounts - 'requiresNumeric'"
      info        : "Configure the local system to verify that newly-created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.
Sites are responsible for installing password complexity software that complies with current DoD requirements."
      solution    : "Open a terminal session and run the following command- sudo pwpolicy -n  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'. For non managed systems the path /Local/Default would need to be added to the command, an example would be- pwpolicy -n /Local/Default  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'"
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|ECPA-1,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31279r1_rule,Rule-ID|SV-31552r1_rule,SANS-CSC|12,SANS-CSC|16,STIG-ID|OSX00035,STIG-ID|OSX00565,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25236,Vuln-ID|V-25366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "requiresNumeric[\\s\\t]*=[\\s\\t]*1[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00035/OSX00565 - Create complex passwords for user accounts - 'requiresMixedCase'"
      info        : "Configure the local system to verify that newly-created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.
Sites are responsible for installing password complexity software that complies with current DoD requirements."
      solution    : "Open a terminal session and run the following command- sudo pwpolicy -n  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'. For non managed systems the path /Local/Default would need to be added to the command, an example would be- pwpolicy -n /Local/Default  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'"
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|ECPA-1,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31279r1_rule,Rule-ID|SV-31552r1_rule,SANS-CSC|12,SANS-CSC|16,STIG-ID|OSX00035,STIG-ID|OSX00565,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25236,Vuln-ID|V-25366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "requiresMixedCase[\\s\\t]*=[\\s\\t]*1[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00035/OSX00565 - Create complex passwords for user accounts - 'requiresSymbol'"
      info        : "Configure the local system to verify that newly-created passwords conform to DoD password complexity policy. Passwords must contain 1 character from the following 4 classes- English uppercase letters, English lowercase letters, Westernized Arabic numerals, and non-alphanumeric characters.
Sites are responsible for installing password complexity software that complies with current DoD requirements."
      solution    : "Open a terminal session and run the following command- sudo pwpolicy -n  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'. For non managed systems the path /Local/Default would need to be added to the command, an example would be- pwpolicy -n /Local/Default  - setglobalpolicy 'requiresAlpha=1 requiresNumeric=1 requiresMixedCase=1 requiresSymbol=1'"
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|ECPA-1,8500.2|IAIA-1,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31279r1_rule,Rule-ID|SV-31552r1_rule,SANS-CSC|12,SANS-CSC|16,STIG-ID|OSX00035,STIG-ID|OSX00565,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25236,Vuln-ID|V-25366"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "requiresSymbol[\\s\\t]*=[\\s\\t]*1[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00040 - Check newly-created password content for account or user name."
      info        : "Configure the local system to verify that newly-created passwords do not contain user's account name or parts of the user's full name that exceed two consecutive characters."
      solution    : "Open a terminal session and use the following command to set the value for Password cannot be name- sudo pwpolicy -n  -setglobalpolicy 'passwordCannotBeName=1'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'passwordCannotBeName=1'."
      reference   : "800-171|3.5.7,800-53|IA-5,8500.2|IAIA-1,8500.2|IAIA-2,CAT|II,CIP|007-6-R5,CN-L3|7.1.2.7(e),CN-L3|7.1.3.1(b),CSF|PR.AC-1,HIPAA|164.308(a)(5)(ii)(D),ISO/IEC-27001|A.9.4.3,ITSG-33|IA-5,NESA|T5.2.3,NIAv2|AM19a,NIAv2|AM19b,NIAv2|AM19c,NIAv2|AM19d,NIAv2|AM22a,PCI-DSSv3.1|8.2.3,PCI-DSSv3.2|8.2.3,Rule-ID|SV-31281r1_rule,SANS-CSC|16,STIG-ID|OSX00040,SWIFT-CSCv1|4.1,TBA-FIISB|26.2.1,TBA-FIISB|26.2.4,Vuln-ID|V-25238"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "passwordCannotBeName[\\s\\t]*=[\\s\\t]*1[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00045 - Account lockout duration"
      info        : "The amount of time that a user's account is locked after multiple failed login attempts."
      solution    : "Open a terminal session and use the following command to set the value for Account lockout duration- sudo pwpolicy -n  -setglobalpolicy 'minutesUntilFailedLoginReset=0'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'minutesUntilFailedLoginReset=0'."
      reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CN-L3|7.1.2.7(f),CN-L3|7.1.3.1(c),ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-31284r1_rule,SANS-CSC|16,STIG-ID|OSX00045,Vuln-ID|V-25240"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "minutesUntilFailedLoginReset[\\s\\t]*=[\\s\\t]*0\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00050 - Account lockout threshold"
      info        : "The account lockout feature, when enabled, prevents brute-force password attacks on the system. The higher this value is, the less effective the account lockout feature will be in protecting the local system. The number of bad logon attempts should be reasonably small to minimize the possibility of a successful password attack while allowing for honest errors made during a normal user logon."
      solution    : "Open a terminal session and use the following command to set the value for Account lockout threshold- sudo pwpolicy -n  -setglobalpolicy 'maxFailedLoginAttemps=3'.

Note- For non-managed system, use the command- pwpolicy -n /Local/Default -setglobalpolicy 'maxFailedLoginAttemps=3'."
      reference   : "800-171|3.1.8,800-53|AC-7,8500.2|ECLO-1,8500.2|ECLO-2,CAT|II,CSCv6|16.7,ITSG-33|AC-7,NESA|T5.5.1,NIAv2|AM24,Rule-ID|SV-31288r1_rule,SANS-CSC|16,STIG-ID|OSX00050,TBA-FIISB|45.1.2,TBA-FIISB|45.2.1,TBA-FIISB|45.2.2,Vuln-ID|V-25241"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pwpolicy -n /Local/Default -getglobalpolicy"
      expect      : "maxFailedLoginAttempts[\\s\\t]*=[\\s\\t]*[1-3][\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00055/OSX00670- Application software updates/Operating System Updates"
      info        : "Major software vendors release security patches and hot fixes to their products when security vulnerabilities are discovered. It is essential that these updates be applied in a timely manner to prevent unauthorized persons from exploiting identified vulnerabilities. Unsupported software should be updated or removed.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Ensure all software is kept up-to-date with manufacturer's updates, especially security updates and patches. Note- Do not enable Automatic Updating as this will conflict with V-25298"
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|VIVM-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,ITSG-33|SI-2,NESA|T7.6.2,NESA|T7.7.1,NIAv2|AM38,NIAv2|AM39,NIAv2|PR9,NIAv2|SS14b,Rule-ID|SV-31297r1_rule,Rule-ID|SV-31529r1_rule,SANS-CSC|4,STIG-ID|OSX00055,SWIFT-CSCv1|2.2,Vuln-ID|V-25251,Vuln-ID|V-25374"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/softwareupdate -l"
      expect      : "No new software available"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00060 - Disable Wi-Fi Support Software - 'AppleAirPort.kext'"
      info        : "Many organizations restrict the use of wireless technology in their network environment. However, most Mac computers have wireless capability built in, and simply turning it off may not meet your organization's wireless technology restrictions. You might need to remove components from Mac OS X to disable them from being turned on in System Preferences. Although wireless technology gives your network more flexibility with your users, it can cause security vulnerabilities you may be unaware of. It is recommended that wherever possible, wireless access be disabled for security reasons. Important- Repeat these instructions every time a system update is installed."
      solution    : "To remove support for WiFi at the kext file level- open a terminal session and use the following commands to remove the following files.
sudo srm -rf /System/Library/Extensions/AppleAirPort.kext
sudo srm -rf /System/Library/Extensions/AppleAirPort2.kext
sudo srm -rf /System/Library/Extensions/AppleAirPortFW.kext
GUI procedures- 1. Open the /System/Library/Extensions folder.   2. Drag the following files to the Trash-  AppleAirPort.kext,   AppleAirPort2.kext, AppleAirPortFW.kext    3. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions  4. Choose Finder > Secure Empty Trash to delete the file.   5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|11.1,Rule-ID|SV-31299r1_rule,SANS-CSC|3,STIG-ID|OSX00060,SWIFT-CSCv1|2.3,Vuln-ID|V-25252"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleAirPort.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00060 - Disable Wi-Fi Support Software - 'AppleAirPort2.kext'"
      info        : "Many organizations restrict the use of wireless technology in their network environment. However, most Mac computers have wireless capability built in, and simply turning it off may not meet your organization's wireless technology restrictions. You might need to remove components from Mac OS X to disable them from being turned on in System Preferences. Although wireless technology gives your network more flexibility with your users, it can cause security vulnerabilities you may be unaware of. It is recommended that wherever possible, wireless access be disabled for security reasons. Important- Repeat these instructions every time a system update is installed."
      solution    : "To remove support for WiFi at the kext file level- open a terminal session and use the following commands to remove the following files.
sudo srm -rf /System/Library/Extensions/AppleAirPort.kext
sudo srm -rf /System/Library/Extensions/AppleAirPort2.kext
sudo srm -rf /System/Library/Extensions/AppleAirPortFW.kext
GUI procedures- 1. Open the /System/Library/Extensions folder.   2. Drag the following files to the Trash-  AppleAirPort.kext,   AppleAirPort2.kext, AppleAirPortFW.kext    3. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions  4. Choose Finder > Secure Empty Trash to delete the file.   5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|11.1,Rule-ID|SV-31299r1_rule,SANS-CSC|3,STIG-ID|OSX00060,SWIFT-CSCv1|2.3,Vuln-ID|V-25252"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleAirPort2.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00060 - Disable Wi-Fi Support Software - 'AppleAirPortFW.kext'"
      info        : "Many organizations restrict the use of wireless technology in their network environment. However, most Mac computers have wireless capability built in, and simply turning it off may not meet your organization's wireless technology restrictions. You might need to remove components from Mac OS X to disable them from being turned on in System Preferences. Although wireless technology gives your network more flexibility with your users, it can cause security vulnerabilities you may be unaware of. It is recommended that wherever possible, wireless access be disabled for security reasons. Important- Repeat these instructions every time a system update is installed."
      solution    : "To remove support for WiFi at the kext file level- open a terminal session and use the following commands to remove the following files.
sudo srm -rf /System/Library/Extensions/AppleAirPort.kext
sudo srm -rf /System/Library/Extensions/AppleAirPort2.kext
sudo srm -rf /System/Library/Extensions/AppleAirPortFW.kext
GUI procedures- 1. Open the /System/Library/Extensions folder.   2. Drag the following files to the Trash-  AppleAirPort.kext,   AppleAirPort2.kext, AppleAirPortFW.kext    3. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions  4. Choose Finder > Secure Empty Trash to delete the file.   5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|11.1,Rule-ID|SV-31299r1_rule,SANS-CSC|3,STIG-ID|OSX00060,SWIFT-CSCv1|2.3,Vuln-ID|V-25252"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleAirPortFW.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00065 - Disable Bluetooth Support Software - 'IOBluetoothFamily.kext'"
      info        : "Bluetooth technology and associated devices are susceptible to general wireless networking threats, such as denial of service attacks, eavesdropping, man-in-the-middle attacks, message modification, and resource misappropriation. Remove Bluetooth support for peripherals such as keyboards, mice, or phones. This task requires you to have administrator privileges.  Important- Repeat these instructions every time a system update is installed. Support should be removed at the kext file level."
      solution    : "Open a terminal session and enter the following commands to remove the files- sudo srm -rf /System/Library/Extensions/IOBluetoothFamily.kext
sudo srm -rf /System/Library/Extensions/IOBluetoothHIDDriver.kext   sudo touch /System/Library/Extensions"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31301r1_rule,SANS-CSC|3,STIG-ID|OSX00065,SWIFT-CSCv1|2.3,Vuln-ID|V-25253"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/IOBluetoothFamily.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00065 - Disable Bluetooth Support Software - 'IOBluetoothHIDDriver.kext'"
      info        : "Bluetooth technology and associated devices are susceptible to general wireless networking threats, such as denial of service attacks, eavesdropping, man-in-the-middle attacks, message modification, and resource misappropriation. Remove Bluetooth support for peripherals such as keyboards, mice, or phones. This task requires you to have administrator privileges.  Important- Repeat these instructions every time a system update is installed. Support should be removed at the kext file level."
      solution    : "Open a terminal session and enter the following commands to remove the files- sudo srm -rf /System/Library/Extensions/IOBluetoothFamily.kext
sudo srm -rf /System/Library/Extensions/IOBluetoothHIDDriver.kext   sudo touch /System/Library/Extensions"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31301r1_rule,SANS-CSC|3,STIG-ID|OSX00065,SWIFT-CSCv1|2.3,Vuln-ID|V-25253"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/IOBluetoothHIDDriver.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 - Disable Audio Recording Support Software - 'AppleOnboardAudio.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for the microphone and audio subsystem. This may disable audio playback. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files-
sudo srm -rf /System/Library/Extensions/AppleOnboardAudio.kext
sudo srm -rf /System/Library/Extensions/AppleUSBAudio.kext
sudo srm -rf /System/Library/Extensions/AppleDeviceTreeUpdater.kext
sudo srm -rf /System/Library/Extensions/IOAudioFamily.kext
sudo srm -rf /System/Library/Extensions/VirtualAudioDriver.kext
sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for audio components such as the microphone, drag the following files to the Trash- AppleOnboardAudio.kext, AppleUSBAudio.kext, AudioDeviceTreeUpdater.kext, IOAudioFamily.kext, and VirtualAudioDriver.kext
3. Open Terminal and enter the following command- $ sudo touch System/Library/Extensions   The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31303r1_rule,SANS-CSC|3,STIG-ID|OSX00070,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleOnboardAudio.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 - Disable Audio Recording Support Software - 'AppleUSBAudio.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for the microphone and audio subsystem. This may disable audio playback. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files-
sudo srm -rf /System/Library/Extensions/AppleOnboardAudio.kext
sudo srm -rf /System/Library/Extensions/AppleUSBAudio.kext
sudo srm -rf /System/Library/Extensions/AppleDeviceTreeUpdater.kext
sudo srm -rf /System/Library/Extensions/IOAudioFamily.kext
sudo srm -rf /System/Library/Extensions/VirtualAudioDriver.kext
sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for audio components such as the microphone, drag the following files to the Trash- AppleOnboardAudio.kext, AppleUSBAudio.kext, AudioDeviceTreeUpdater.kext, IOAudioFamily.kext, and VirtualAudioDriver.kext
3. Open Terminal and enter the following command- $ sudo touch System/Library/Extensions   The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31303r1_rule,SANS-CSC|3,STIG-ID|OSX00070,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleUSBAudio.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 - Disable Audio Recording Support Software - 'AppleDeviceTreeUpdater.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for the microphone and audio subsystem. This may disable audio playback. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files-
sudo srm -rf /System/Library/Extensions/AppleOnboardAudio.kext
sudo srm -rf /System/Library/Extensions/AppleUSBAudio.kext
sudo srm -rf /System/Library/Extensions/AppleDeviceTreeUpdater.kext
sudo srm -rf /System/Library/Extensions/IOAudioFamily.kext
sudo srm -rf /System/Library/Extensions/VirtualAudioDriver.kext
sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for audio components such as the microphone, drag the following files to the Trash- AppleOnboardAudio.kext, AppleUSBAudio.kext, AudioDeviceTreeUpdater.kext, IOAudioFamily.kext, and VirtualAudioDriver.kext
3. Open Terminal and enter the following command- $ sudo touch System/Library/Extensions   The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31303r1_rule,SANS-CSC|3,STIG-ID|OSX00070,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleDeviceTreeUpdater.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 - Disable Audio Recording Support Software - 'IOAudioFamily.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for the microphone and audio subsystem. This may disable audio playback. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files-
sudo srm -rf /System/Library/Extensions/AppleOnboardAudio.kext
sudo srm -rf /System/Library/Extensions/AppleUSBAudio.kext
sudo srm -rf /System/Library/Extensions/AppleDeviceTreeUpdater.kext
sudo srm -rf /System/Library/Extensions/IOAudioFamily.kext
sudo srm -rf /System/Library/Extensions/VirtualAudioDriver.kext
sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for audio components such as the microphone, drag the following files to the Trash- AppleOnboardAudio.kext, AppleUSBAudio.kext, AudioDeviceTreeUpdater.kext, IOAudioFamily.kext, and VirtualAudioDriver.kext
3. Open Terminal and enter the following command- $ sudo touch System/Library/Extensions   The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31303r1_rule,SANS-CSC|3,STIG-ID|OSX00070,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/IOAudioFamily.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00070 - Disable Audio Recording Support Software - 'VirtualAudioDriver.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for the microphone and audio subsystem. This may disable audio playback. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files-
sudo srm -rf /System/Library/Extensions/AppleOnboardAudio.kext
sudo srm -rf /System/Library/Extensions/AppleUSBAudio.kext
sudo srm -rf /System/Library/Extensions/AppleDeviceTreeUpdater.kext
sudo srm -rf /System/Library/Extensions/IOAudioFamily.kext
sudo srm -rf /System/Library/Extensions/VirtualAudioDriver.kext
sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for audio components such as the microphone, drag the following files to the Trash- AppleOnboardAudio.kext, AppleUSBAudio.kext, AudioDeviceTreeUpdater.kext, IOAudioFamily.kext, and VirtualAudioDriver.kext
3. Open Terminal and enter the following command- $ sudo touch System/Library/Extensions   The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31303r1_rule,SANS-CSC|3,STIG-ID|OSX00070,SWIFT-CSCv1|2.3,Vuln-ID|V-25254"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/VirtualAudioDriver.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00075 - Disable Video Recording Support Software - 'Apple_iSight.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for an external or built-in iSight camera. Note- The support for external iSight cameras should be removed on all machines. Removing only support for internal iSight cameras would still leave support for external cameras available. You can also have an Apple Authorized Technician remove the built-in video camera hardware from your Apple computer.
Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files- sudo srm -rf /System/Library/Extensions/Apple_iSight.kext
sudo srm -rf /System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext
sudo touch /System/Library/Extensions   GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for the external iSight camera, drag the following file to the Trash-Apple_iSight.kext.
3. To remove support for the built-in iSight camera, control click the IOUSBFamily.kext and select Show Package Contents.
4. Open the /Contents/PlugIns/ folder.
5. Drag the following file to the Trash- AppleUSBVideoSupport.kext
6. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
7. Choose Finder ->  Secure Empty Trash to delete the file. 8. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31305r1_rule,SANS-CSC|3,STIG-ID|OSX00075,SWIFT-CSCv1|2.3,Vuln-ID|V-25255"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/Apple_iSight.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00075 - Disable Video Recording Support Software - 'AppleUSBVideoSupport.kext'"
      info        : "Your computer might be in an environment where recording devices such as cameras
or microphones are not permitted. You can protect your organization's privacy by
disabling these devices. Remove support for an external or built-in iSight camera. Note- The support for external iSight cameras should be removed on all machines. Removing only support for internal iSight cameras would still leave support for external cameras available. You can also have an Apple Authorized Technician remove the built-in video camera hardware from your Apple computer.
Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the files- sudo srm -rf /System/Library/Extensions/Apple_iSight.kext
sudo srm -rf /System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext
sudo touch /System/Library/Extensions   GUI Procedures-   1. Open the /System/Library/Extensions folder.
2. To remove support for the external iSight camera, drag the following file to the Trash-Apple_iSight.kext.
3. To remove support for the built-in iSight camera, control click the IOUSBFamily.kext and select Show Package Contents.
4. Open the /Contents/PlugIns/ folder.
5. Drag the following file to the Trash- AppleUSBVideoSupport.kext
6. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library/) are deleted and rebuilt by Mac OS X.
7. Choose Finder ->  Secure Empty Trash to delete the file. 8. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31305r1_rule,SANS-CSC|3,STIG-ID|OSX00075,SWIFT-CSCv1|2.3,Vuln-ID|V-25255"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/IOUSBFamily.kext/Contents/Plugins/AppleUSBVideoSupport.kext"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00090 - Remove Infrared (IR) Support"
      info        : "To prevent unauthorized users from controlling your computer through the
infrared receiver. Remove IR hardware support. This task requires you to have administrator privileges. You can also have an Apple Authorized Technician remove IR hardware from your Apple computer. Important- Repeat these instructions every time a system update is installed."
      solution    : "Open a terminal session and enter the following commands to remove the file-  srm -rf /System/Library/Extensions/AppleIRController.kext     sudo touch /System/Library/Extensions    GUI Procedures-   1. Open the /System/Library/Extensions
2. Drag the following file to the Trash- AppleIRController.kext
3. Open Terminal and enter the following command- $ sudo touch /System/Library/Extensions The touch command changes the modified date of the /System/Library/Extensions folder. When the folder has a new modified date, the Extension cache files (located in /System/Library) are deleted and rebuilt automatically by Mac OS X.
4. Choose Finder -> Secure Empty Trash to delete the file.
5. Restart the system."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31311r1_rule,SANS-CSC|3,STIG-ID|OSX00090,SWIFT-CSCv1|2.3,Vuln-ID|V-25258"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/AppleIRController.kext"
    </custom_item>

# Applicable to only PowerPC Macs
#<custom_item>
# system             : "Darwin"
# type               : CMD_EXEC
# description        : "OSX00095 - Require an Open Firmware or EFI password"
# info               : "PowerPC-based computers use Open Firmware to control hardware. This is similar to the BIOS on an x86 PC. Open Firmware is the hardware base layer for Mac OS X and is a possible point of intrusion. By protecting it from unauthorized access, you can prevent attackers from gaining access to your computer."
# solution           : "1. Log in with an administrator account and open the Firmware Password Utility (located on the Mac OS X installation disc in /Applications/Utilities/).
#2. Click Change.
#3. Select 'Require password to change Open Firmware settings.'
#4. In the Password and Verify fields, enter a new Open Firmware or EFI password, and click OK.  This password can be up to eight characters.  Do not use the capital letter 'U' in an Open Firmware password. If you do, your password will not be recognized during the startup process.
#5. Close the Firmware Password Utility."
# see_also           : ""
# reference          : "CAT|I,SANS-CSC|3,STIG-ID|OSX00095,8500.2|ECSC-1,Rule-ID|SV-31313r1_rule,Vuln-ID|V-25259,PCI-DSS|2.2.3"
# cmd                : "/usr/sbin/nvram -p"
# expect             : "security-mode.+command"
#</custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00100 - Create an access warning for the login window"
      info        : "Configure the system to display a logon banner that meets the DoD standards for a valid legal notice to users. You can use a login window or Terminal access warning to provide notice of a computer's ownership, to warn against unauthorized access, or to remind authorized users of their consent to monitoring."
      info        : "NOTE: Update LOGIN_WINDOW_TEXT with the appropriate value for the local environment"
      solution    : "Use a login window or Terminal access warning to provide notice of a computer's ownership, to warn against unauthorized access, or to remind authorized users of their consent to monitoring"
      reference   : "800-171|3.1.9,800-53|AC-8,8500.2|ECWM-1,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-31315r1_rule,STIG-ID|OSX00100,Vuln-ID|V-25260"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.loginwindow LoginwindowText"
# Note: Variable @LOGIN_WINDOW_TEXT@ replaced with "Approved DOD Banner text" in field "expect".
      expect      : "Approved DOD Banner text"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : BANNER_CHECK
      description : "OSX00105 - Create an access warning for the command line"
      info        : "Configure the system to display a warning banner that meets the DoD standards with a valid legal notice to users. Terminal access warnings provide notice of a computer's ownership, to warn against unauthorized access, or to remind authorized users of their consent to monitoring."
      solution    : "1. Open a terminal session
2. Verify the /etc/motd file exists. If not, use the touch command to create the file.
3. Edit the file and enter the appropriate DoD warning banner information.
4. Save the file.
5. Open a new terminal session and verify the banner is displayed."
      reference   : "800-171|3.1.9,800-53|AC-8,8500.2|ECWM-1,CAT|II,ITSG-33|AC-8,NESA|M1.3.6,NESA|M5.2.5,NESA|T5.5.1,NIAv2|AM10a,NIAv2|AM10b,NIAv2|AM10c,NIAv2|AM10d,NIAv2|AM10e,Rule-ID|SV-31317r1_rule,STIG-ID|OSX00105,Vuln-ID|V-25261"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/motd"
# Note: Variable @BANNER_TEXT@ replaced with "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." in field "content".
      content     : "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n-At any time, the USG may inspect and seize data stored on this IS.\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00110 - Restrict sudo usage - 'timestamp_timeout'"
      info        : "Do not allow direct root login because the logs cannot identify which administrator logged in. Instead, log in using accounts with administrator privileges, and then use the sudo command to perform actions as root. These limit the use of the sudo command to a single command per authentication and also ensure that, even if a timeout is activated, that later sudo commands are limited to the terminal in which authentication occurred. Note- Admin privilege may be needed to perform some commands."
      solution    : "Open a terminal session and enter the following commands to set the values in the /etc/sudoers file-
echo 'Defaults tty_tickets' >> /etc/sudoers   echo 'Defaults timestamp_timeout=0' >> /etc/sudoers
Note- Admin privilege may be needed to perform some commands."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii),PCI-DSS|2.2.3,Rule-ID|SV-31319r1_rule,SANS-CSC|3,STIG-ID|OSX00110,Vuln-ID|V-25262"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sudoers"
      regex       : "^[\\s\\t]*Defaults[\\s\\t]+timestamp_timeout[\\s\\t]*=[\\s\\t]*0$"
      expect      : "^[\\s\\t]*Defaults[\\s\\t]+timestamp_timeout[\\s\\t]*=[\\s\\t]*0$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00110 - Restrict sudo usage - 'tty_tickets'"
      info        : "Do not allow direct root login because the logs cannot identify which administrator logged in. Instead, log in using accounts with administrator privileges, and then use the sudo command to perform actions as root. These limit the use of the sudo command to a single command per authentication and also ensure that, even if a timeout is activated, that later sudo commands are limited to the terminal in which authentication occurred. Note- Admin privilege may be needed to perform some commands."
      solution    : "Open a terminal session and enter the following commands to set the values in the /etc/sudoers file-
echo 'Defaults tty_tickets' >> /etc/sudoers   echo 'Defaults timestamp_timeout=0' >> /etc/sudoers
Note- Admin privilege may be needed to perform some commands."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECSC-1,CAT|I,CN-L3|7.1.2.2(g),CN-L3|7.1.3.2(c),CSF|PR.AC-4,CSF|PR.PT-3,HIPAA|164.310(a)(2)(iii),PCI-DSS|2.2.3,Rule-ID|SV-31319r1_rule,SANS-CSC|3,STIG-ID|OSX00110,Vuln-ID|V-25262"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sudoers"
      regex       : "^[\\s\\t]*Defaults[\\s\\t]+tty_tickets"
      expect      : "^[\\s\\t]*Defaults[\\s\\t]+tty_tickets"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00115 - Securely configure LDAPv3 access"
      info        : "When configuring LDAPv3, do not add DHCP-supplied LDAP servers to automatic search policies if you cannot secure the network the computer is running on. If you do, someone can create a rogue DHCP.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click the Connection tab and select 'Encrypt using SSL'"
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31323r1_rule,SANS-CSC|17,STIG-ID|OSX00115,Vuln-ID|V-25263"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00120 - LDAP Authentication, Use authentication when connecting to LDAPv3."
      info        : "When configuring LDAPv3 for LDAP authentication, do not add DHCP-supplied LDAP servers to automatic search policies if you cannot secure the network the computer is running on. If you do, someone can create a rogue DHCP. Use authentication when connecting to LDAPv3 directories and disable clear text passwords for all LDAPv3 directories. Digitally sign all LDAPv3 packets (requires Kerberos). Encrypt all LDAPv3 packets (requires SSL or Kerberos). Block man-in-the-middle attacks (requires Kerberos).

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click on Security tab and select 'Use authentication when connecting'"
      reference   : "8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31325r1_rule,SANS-CSC|17,STIG-ID|OSX00120,Vuln-ID|V-25264"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00121 - Disable clear text passwords for all LDAPv3 directories"
      info        : "Disable the use of clear text passwords when accessing LDAPv3 directories.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click the Security tab and select 'Disable clear text passwords'"
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|I,Rule-ID|SV-31775r1_rule,SANS-CSC|17,STIG-ID|OSX00121,Vuln-ID|V-25557"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00122 - Digitally sign all LDAPv3 packets"
      info        : "To protect the data between the client and LDAPv3 directory the traffic should be digitally signed.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click on Security tab and select 'Digitally sign all packets (requires Kerberos)'"
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31778r1_rule,SANS-CSC|17,STIG-ID|OSX00122,Vuln-ID|V-25559"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00123 - Encrypt all LDAPv3 packets"
      info        : "To ensure data confidentially all traffic between the client and the LDAPv3 should be encrypted.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click on Security tab and select 'Encrypt all packets (requires SSL or Kerberos)'"
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31781r1_rule,SANS-CSC|17,STIG-ID|OSX00123,Vuln-ID|V-25561"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00124 - LDAPv3 Block man-in-the-middle attacks"
      info        : "To prevent LDAPv3 man-in-the-middle attacks the system must be properly configured.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder
Click Applications
Double Click Utility
Double Click Directory Utility
Click the Show Advanced Options button
Click Services tab
Click the Lock and enter the password to unlock the options(if needed)
Click the LDAPv3 service
Click the Pencil icon
Highlight the Server Name/Configuration Name
Click Edit
Click the Security tab and select 'Block man-in-the-middle attacks (requires Kerberos)'"
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31783r1_rule,SANS-CSC|17,STIG-ID|OSX00124,Vuln-ID|V-25563"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00125 - Securely configure Active Directory Access"
      info        : "The 'Allow administration by' setting should not be used in sensitive environments. It can cause unintended privilege escalation issues because any member of the group specified will have administrator privileges on your computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open the Directory Utilities.  2. Click the Services tab.  3. Double-click on Active Directory.  4. Click on Show Advanced Options.  5. Click on Administrative tab and  deselect  'Allow administration by' option."
      reference   : "8500.2|DCNR-1,8500.2|ECCT-1,8500.2|ECCT-2,CAT|I,Rule-ID|SV-31327r1_rule,SANS-CSC|17,STIG-ID|OSX00125,Vuln-ID|V-25265"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <item>
      description : "OSX00135 - Assign POSIX access permissions based on user categories."
      info        : "Changing permissions on a user's home directory from 750 to 700 will disable
Apple file sharing. User's home directory POSIX permissions should be set to 700."
      solution    : "To use the command line utility, open a terminal session and  sudo chmod 700 for each users home directory."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31331r1_rule,SANS-CSC|3,STIG-ID|OSX00135,SWIFT-CSCv1|2.3,Vuln-ID|V-25267"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      name        : "accounts_bad_home_permissions"
      mask        : "077"
    </item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00140 - Enable security auditing"
      info        : "Auditing is the capture and maintenance of information about security-related events. Auditing helps determine the causes and the methods used for successful and failed access attempts."
      solution    : "1. Open a terminal session and edit the /etc/hostconfig file, by using the command (sudo pico /etc/hostconfig).
2. Add the following line to the file- AUDIT=-YES-
3. Save the file.
4. Restart the machine."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-31333r1_rule,SANS-CSC|14,STIG-ID|OSX00140,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25268"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/hostconfig"
      regex       : "^[\\s\\t]*AUDIT[\\s\\t]*=.+"
      expect      : "^[\\s\\t]*AUDIT[\\s\\t]*=[\\s\\t]*\-[Yy][Ee][Ss]\-$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00145 - Configure security auditing"
      info        : "Maintaining an audit trail of system activity logs can help identify configuration errors, troubleshoot service disruptions and analyze compromises that have occurred as well as detect an attack that has begun or is about to begin. Audit logs are necessary to provide a trail of evidence in case the system or network is compromised. Without an audit trail that provides information as to event that occurred and if it was successful or unsuccessful, it is difficult to analyze a series of events to determine the steps used by an attacker to compromise a system or network, or what exactly happened that led to a denial of service. Collecting data such as the successful and unsuccessful events is essential for analyzing the security of information assets and detecting signs of suspicious and unexpected behavior."
      solution    : "1. Install the Common Criteria Tools for OS X 10.5.
2. Open a terminal session and edit the /etc/security/audit_control file.
3. Find the line that begins with 'flags'.
4. Replace that line with the following- flags-lo,ad,-all,-fr,fd,fm,^-fa,^-fc,^-cl.
5. Save the file"
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-31335r3_rule,SANS-CSC|14,STIG-ID|OSX00145,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25269"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_control"
      regex       : "^[\\s\\t]*flags:.+"
      expect      : "^[\\s\\t]*flags:lo,ad,-all,-fr,fd,fm,\\^-fa,\\^-fc,\\^-cl"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00150 - Enable local logging"
      info        : "The default configuration in /etc/newsyslog.conf file is configured for local logging in the /var/log folder. The computer is set to rotate log files using the periodic launchd job according to time intervals specified in the /etc/newsyslog.conf file."
      solution    : "Open a terminal session and enter the command- sudo pico  /etc/newsyslog.conf  and set all count values to 14."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-31337r1_rule,SANS-CSC|14,STIG-ID|OSX00150,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25270"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_control"
      regex       : "^[\\s\\t]*flags:.+"
      expect      : "^[\\s\\t]*flags:lo,ad,-all,-fr,fd,fm,\\^-fa,\\^-fc,\\^-cl"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00150 - Enable local logging - count"
      info        : "The default configuration in /etc/newsyslog.conf file is configured for local logging in the /var/log folder. The computer is set to rotate log files using the periodic launchd job according to time intervals specified in the /etc/newsyslog.conf file."
      solution    : "Open a terminal session and enter the command- sudo pico  /etc/newsyslog.conf  and set all count values to 14."
      reference   : "800-53|AU-11,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CSF|PR.PT-1,ITSG-33|AU-11,NESA|M5.2.3,NESA|T3.6.2,NIAv2|SM7,Rule-ID|SV-31337r1_rule,SANS-CSC|14,STIG-ID|OSX00150,Vuln-ID|V-25270"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/newsyslog.conf"
      regex       : "/[^\\s\\t]+[\\s\\t]+[0-9]+[\\s\\t]+[0-9]+"
      expect      : "/[^\\s\\t]+[\\s\\t]+[0-9]+[\\s\\t]+14[\\s\\t]+"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00155 - Enable remote logging"
      info        : "In addition to local logging, consider using remote logging. Local logs can be altered if the computer is compromised."
      info        : "NOTE: Update LOG_SERVER with the appropriate value for the local environment"
      solution    : "1. Open a terminal session and enter the command- sudo pico /etc/syslog.conf
2. Add the following line to the top of the file, replacing your.log.server with the name or IP address of the log server, and keeping all other lines intact-
*.* @your.log.server
3. Exit, saving changes.
4. Reboot the system."
      reference   : "800-171|3.3.8,800-53|AU-9,8500.2|ECAR-1,8500.2|ECAR-2,8500.2|ECAR-3,CAT|II,CSF|PR.PT-1,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NIAv2|SS13e,PCI-DSSv3.1|10.5.3,PCI-DSSv3.1|10.5.4,PCI-DSSv3.2|10.5.3,PCI-DSSv3.2|10.5.4,Rule-ID|SV-31339r1_rule,SANS-CSC|14,STIG-ID|OSX00155,Vuln-ID|V-25271"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/syslog.conf"
# Note: Variable @LOG_SERVER@ replaced with "example\\\\.log\\\\.server" in field "regex".
      regex       : "^[\\s\\t]*\\*.\\*[\\s\\t]*\@example\\\\.log\\\\.server"
# Note: Variable @LOG_SERVER@ replaced with "example\\\\.log\\\\.server" in field "expect".
      expect      : "^[\\s\\t]*\\*.\\*[\\s\\t]*\@example\\\\.log\\\\.server"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00160 - Install an antivirus tool"
      info        : "Installing antivirus tools helps prevent infection of your computer by viruses and helps prevent your computer from becoming a host used to spread viruses to other computers. These tools quickly identify suspicious content and compare them to known malicious content. See the https-//www.cybercom.mil website for approved AV tools.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Install an approved antivirus tool on the system."
      reference   : "8500.2|ECVP-1,CAT|I,Rule-ID|SV-31341r1_rule,SANS-CSC|5,STIG-ID|OSX00160,Vuln-ID|V-25272"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00165 - Securely configure /etc/sshd_config - Prevent root login"
      info        : "Prevent logging in as root through SSH. This should be set for all SSH methods of authenticating."
      solution    : "1. Open a terminal session and enter the command- sudo pico  /etc/sshd_config
2. Edit the value PermitRootLogin and set it to No.
3. Save the file"
      reference   : "800-171|3.1.15,800-171|3.1.2,800-53|AC-17,8500.2|COBR-1,8500.2|ECPA-1,CAT|II,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,PCI-DSS|2.2.3,Rule-ID|SV-31343r1_rule,SANS-CSC|12,SANS-CSC|8,STIG-ID|OSX00165,SWIFT-CSCv1|5.1,Vuln-ID|V-25273"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sshd_config"
      regex       : "^[\\s\\t]*PermitRootLogin"
      expect      : "^[\\s\\t]*PermitRootLogin[\\s\\t]+[Nn][Oo]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00170 - Securely configure /etc/sshd_config - Login Grace Time"
      info        : "Reduces the time allowed to authenticate to 30 seconds."
      solution    : "1. Open a terminal session and enter the following command- sudo pico /etc/sshd_config
2. Edit the value- LoginGraceTime to 30.
3. Save the file."
      reference   : "800-171|3.1.11,800-53|AC-12,8500.2|ECSC-1,CAT|III,CN-L3|7.1.2.2(d),CN-L3|7.1.3.7(b),CSCv6|16.4,HIPAA|164.312(a)(2)(iii),ITSG-33|AC-12,NIAv2|NS49,PCI-DSSv3.1|12.3.8,PCI-DSSv3.1|8.1.8,PCI-DSSv3.2|12.3.8,PCI-DSSv3.2|8.1.8,PCI-DSS|2.2.3,Rule-ID|SV-31345r1_rule,SANS-CSC|3,STIG-ID|OSX00170,Vuln-ID|V-25274"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sshd_config"
      regex       : "^[\\s\\t]*LoginGraceTime"
      expect      : "^[\\s\\t]*LoginGraceTime[\\s\\t]+([3-9][0-9]+|[1-9][0-9][0-9]+)"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00175 - Securely configure /etc/sshd_config - Protocol version"
      info        : "Restrict OpenSSH so it uses only SSH Protocol 2. This should be set for all SSH methods of authenticating."
      solution    : "1. Open a terminal session and enter the following command- sudo pico /etc/sshd_config  2. Edit the value- Protocol  to 2.
3.Save the file."
      reference   : "800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CSF|PR.IP-1,CSF|PR.PT-3,PCI-DSS|2.2.3,Rule-ID|SV-31347r1_rule,SANS-CSC|3,STIG-ID|OSX00175,Vuln-ID|V-25275"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sshd_config"
      regex       : "^[\\s\\t]*Protocol"
      expect      : "^[\\s\\t]*Protocol[\\s\\t]+2$"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00180 - sshd Empty passwords"
      info        : "Denies access to accounts without passwords. This should be set for all SSH methods of authenticating."
      solution    : "1. Open a terminal session and enter the following command- sudo pico /etc/sshd_config
2. Change the value-PermitEmptyPasswords to No.
3. Save the file"
      reference   : "800-171|3.5.2,800-53|IA-5,8500.2|ECSC-1,CAT|I,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,PCI-DSS|2.2.3,Rule-ID|SV-31349r1_rule,SANS-CSC|3,STIG-ID|OSX00180,Vuln-ID|V-25276"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/sshd_config"
      regex       : "^[\\s\\t]*PermitEmptyPasswords"
      expect      : "^[\\s\\t]*PermitEmptyPasswords[\\s\\t]+[Nn][Oo]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00185 - Change Global umask"
      info        : "The default umask setting of 022 (in octal) removes group and other write permissions. Group members and other users can read and run these files or folders. Changing the umask setting to 027 enables group members to read files and folders and prevents others from accessing the files and folders."
      solution    : "1. Open a terminal session and enter the following command-  sudo echo 'umask 027' >> /etc/launchd.conf"
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,Rule-ID|SV-31351r1_rule,SANS-CSC|3,STIG-ID|OSX00185,Vuln-ID|V-25277"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl umask"
      expect      : "27"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00190 - Remove the MobileMe preference pane from System Preferences - 'Disable Sync'"
      info        : "Remove the MobileMe preference pane from System Preferences-MobileMe is a suite of Internet tools that help you synchronize data and other important information when you're away from the computer. In sensitive environments don't use MobileMe. If you must store critical data, only store it on your local computer. You should only transfer data over a secure network connection to a secure internal server. If you use MobileMe, enable it only for user accounts that don't have access to critical data. It is not recommended that you enable MobileMe for administrator or root user accounts."
      solution    : "1. Open System Preferences-> MobileMe.  2. On the Sync pane, uncheck 'Synchronization with MobileMe' and disable all other options.    Command Procedures-  Open a terminal session and enter the following commands to remove the file-  sudo rm -R  /System/Library/PreferencePanes/Mac.prefPane
sudo rm -R /System/Library/PreferencePanes/Internet.prefPane    sudo touch /System/Library/Extensions"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31353r1_rule,SANS-CSC|3,STIG-ID|OSX00190,SWIFT-CSCv1|2.3,Vuln-ID|V-25278"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults -currentHost read com.apple.DotMacSync ShouldSyncWithServer"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00190 - Remove the MobileMe preference pane from System Preferences - 'Mac.prefPane'"
      info        : "Remove the MobileMe preference pane from System Preferences-MobileMe is a suite of Internet tools that help you synchronize data and other important information when you're away from the computer. In sensitive environments don't use MobileMe. If you must store critical data, only store it on your local computer. You should only transfer data over a secure network connection to a secure internal server. If you use MobileMe, enable it only for user accounts that don't have access to critical data. It is not recommended that you enable MobileMe for administrator or root user accounts."
      solution    : "1. Open System Preferences-> MobileMe.  2. On the Sync pane, uncheck 'Synchronization with MobileMe' and disable all other options.    Command Procedures-  Open a terminal session and enter the following commands to remove the file-  sudo rm -R  /System/Library/PreferencePanes/Mac.prefPane
sudo rm -R /System/Library/PreferencePanes/Internet.prefPane    sudo touch /System/Library/Extensions"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31353r1_rule,SANS-CSC|3,STIG-ID|OSX00190,SWIFT-CSCv1|2.3,Vuln-ID|V-25278"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/PreferencePanes/Mac.prefPane"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00190 - Remove the MobileMe preference pane from System Preferences - 'Internet.prefPane'"
      info        : "Remove the MobileMe preference pane from System Preferences-MobileMe is a suite of Internet tools that help you synchronize data and other important information when you're away from the computer. In sensitive environments don't use MobileMe. If you must store critical data, only store it on your local computer. You should only transfer data over a secure network connection to a secure internal server. If you use MobileMe, enable it only for user accounts that don't have access to critical data. It is not recommended that you enable MobileMe for administrator or root user accounts."
      solution    : "1. Open System Preferences-> MobileMe.  2. On the Sync pane, uncheck 'Synchronization with MobileMe' and disable all other options.    Command Procedures-  Open a terminal session and enter the following commands to remove the file-  sudo rm -R  /System/Library/PreferencePanes/Mac.prefPane
sudo rm -R /System/Library/PreferencePanes/Internet.prefPane    sudo touch /System/Library/Extensions"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.2,Rule-ID|SV-31353r1_rule,SANS-CSC|3,STIG-ID|OSX00190,SWIFT-CSCv1|2.3,Vuln-ID|V-25278"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/PreferencePanes/Internet.prefPane"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00195 - Software Update Server URL is restricted to authorized DoD server"
      info        : "Your computer can look for software updates on an internal software update server. By using an internal software update server, you reduce the amount of data transferred outside of the network. Your organization can control which updates can be installed on your computer."
      info        : "NOTE: Update SOFTWARE_UPDATE_URL with the appropriate value for the local environment"
      solution    : "Open a terminal session and enter one of the following commands- defaults write com.apple.SoftwareUpdate CatalogURL 'new_SUS_URL' (where 'new_SUS_URL' is the URL or the address of the appropriate government SUS to be used)."
      reference   : "800-171|3.14.1,800-53|SI-2,8500.2|VIVM-1,CAT|II,CSF|ID.RA-1,CSF|PR.IP-12,NIAv2|NS26b,Rule-ID|SV-31355r1_rule,SANS-CSC|4,STIG-ID|OSX00195,SWIFT-CSCv1|2.2,Vuln-ID|V-25279"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults -currentHost read com.apple.SoftwareUpdate CatalogURL"
# Note: Variable @SOFTWARE_UPDATE_URL@ replaced with "http://su.example.com:8088/index.sucatalog" in field "expect".
      expect      : "http://su.example.com:8088/index.sucatalog"
    </custom_item>

    <custom_item>
      system        : "Darwin"
      type          : CMD_EXEC
      description   : "OSX00200 - Disable ability for administrative accounts to unlock Screen Saver"
      info          : "The default setting creates a possible point of attack, because the more users you have in the admin group the more you depend on those users to protect their user names and passwords. By changing the rule in system.login.screensaver  to authenticatesession-owner, users of the admin group cannot unlock the screen saver.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "1. Open a terminal session and edit the following file-  /etc/authorization
2. Change 'authenticate-session-owner-or-admin ' to  'authenticate-session-owner' in the 'system.login.screensaver' key.
3. Save the file."
      reference     : "800-171|3.1.5,800-53|AC-6,8500.2|ECPA-1,8500.2|PESL-1,CAT|II,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-31357r1_rule,SANS-CSC|12,STIG-ID|OSX00200,SWIFT-CSCv1|5.1,Vuln-ID|V-25280"
      see_also      : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd           : "/bin/cat /etc/authorization | /usr/bin/grep -C9 system.login.screensaver | grep authenticate-session-owner-or-admin"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00205 - Remove the setuid bit from the System Preferences.app file."
      info        : "Remove setuid bit from Install Assistant, because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges. There is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command-  chmod 775 /Applications/System Preferences.app/Contents/Resources/installAssistant."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31359r1_rule,SANS-CSC|3,STIG-ID|OSX00205,SWIFT-CSCv1|2.3,Vuln-ID|V-25281"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/Applications/System Preferences.app/Contents/Resources/installAssistant"
      mask        : "4002"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00210 - Remove setuid bit from ODBC Admin tool."
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command-  chmod 755 /Applications/Utilities/ODBC Administrator.app/Contents/Resources/iodbcadmintool"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31361r1_rule,SANS-CSC|3,STIG-ID|OSX00210,SWIFT-CSCv1|2.3,Vuln-ID|V-25282"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/Applications/Utilities/ODBC Administrator.app/Contents/Resources/iodbcadmintool"
      mask        : "4022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00215 - Remove setuid bit from Apple Remote Desktop"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 755 /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31363r1_rule,SANS-CSC|3,STIG-ID|OSX00215,SWIFT-CSCv1|2.3,Vuln-ID|V-25283"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent"
      mask        : "4022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00220 - Remove setuid bit from WebDAV Web Services"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 755 /System/Library/Extensions/webdav_fs.kext/Contents/Resources/load_webdav"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31365r1_rule,SANS-CSC|3,STIG-ID|OSX00220,SWIFT-CSCv1|2.3,Vuln-ID|V-25284"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Extensions/webdav_fs.kext/Contents/Resources/load_webdav"
      mask        : "4022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00225 - Remove setuid bit from Apple File Protocol."
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 755 /System/Library/Filesystems/AppleShare/afpLoad"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31367r1_rule,SANS-CSC|3,STIG-ID|OSX00225,SWIFT-CSCv1|2.3,Vuln-ID|V-25285"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Filesystems/AppleShare/afpLoad"
      mask        : "4022"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00230 - Remove setuid bit from Apple File Protocol Sharing"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 711 /System/Library/Filesystems/AppleShare/check_afp.app/Contents/MacOS/check_afp"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31369r1_rule,SANS-CSC|3,STIG-ID|OSX00230,SWIFT-CSCv1|2.3,Vuln-ID|V-25286"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/System/Library/Filesystems/AppleShare/check_afp.app/Contents/MacOS/check_afp"
      mask        : "4066"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00235 - Remove setuid bit from dumpemacs"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /usr/libexec/dumpemacs"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31371r1_rule,SANS-CSC|3,STIG-ID|OSX00235,SWIFT-CSCv1|2.3,Vuln-ID|V-25287"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/libexec/dumpemacs"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00240 - Remove setuid bit from XGrid"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /usr/libexec/xgrid/IdleTool"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31373r1_rule,SANS-CSC|3,STIG-ID|OSX00240,SWIFT-CSCv1|2.3,Vuln-ID|V-25288"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/libexec/xgrid/IdleTool"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00245 - Remove setuid bit from Hosting VPN Services"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /usr/sbin/vpnd"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31375r1_rule,SANS-CSC|3,STIG-ID|OSX00245,SWIFT-CSCv1|2.3,Vuln-ID|V-25289"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/sbin/vpnd"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00250 - Remove setuid bit from Network Configuration"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command-  chmod 555 /sbin/route"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31377r1_rule,SANS-CSC|3,STIG-ID|OSX00250,SWIFT-CSCv1|2.3,Vuln-ID|V-25290"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/sbin/route"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00255 - Remove setuid bit from IPC Statistics"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 511 /usr/bin/ipcs"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31379r1_rule,SANS-CSC|3,STIG-ID|OSX00255,SWIFT-CSCv1|2.3,Vuln-ID|V-25291"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/bin/ipcs"
      mask        : "4266"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00260 - Remove setuid bit from Remote Access (unsecure)"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /bin/rcp"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31381r1_rule,SANS-CSC|3,STIG-ID|OSX00260,SWIFT-CSCv1|2.3,Vuln-ID|V-25292"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/bin/rcp"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00265 - Remove setuid bit from Remote Access (unsecure rlogin)"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /usr/bin/rlogin"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31383r1_rule,SANS-CSC|3,STIG-ID|OSX00265,SWIFT-CSCv1|2.3,Vuln-ID|V-25293"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/bin/rlogin"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00270 - Remove setuid bit from Remote Access (rsh unsecure)"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command-  chmod 555 /usr/bin/rsh"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31385r1_rule,SANS-CSC|3,STIG-ID|OSX00270,SWIFT-CSCv1|2.3,Vuln-ID|V-25294"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/bin/rsh"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00275 - Remove setuid bit from System Activity Reporting"
      info        : "Because attackers try to influence or co-opt the execution of setuid programs in order to try to elevate their privileges, there is benefit in removing the setuid bit from programs that may not need it. There is also benefit in restricting to administrators the right to execute a setuid program."
      solution    : "1. Open a terminal session and enter the following command- chmod 555 /usr/lib/sa/sadc"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,8500.2|ECCD-2,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,PCI-DSS|2.2.3,Rule-ID|SV-31387r1_rule,SANS-CSC|3,STIG-ID|OSX00275,SWIFT-CSCv1|2.3,Vuln-ID|V-25295"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/lib/sa/sadc"
      mask        : "4222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00280 - Set the correct date and time - 'date'"
      info        : "Correct date and time settings are required for authentication protocols, like Kerberos. Incorrect date and time settings can cause security issues.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Date&Time Panel.  2. Set the correct date and time."
      reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,CAT|III,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-31389r1_rule,SANS-CSC|3,STIG-ID|OSX00280,Vuln-ID|V-25296"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/systemsetup -getdate"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00280 - Set the correct date and time - 'time'"
      info        : "Correct date and time settings are required for authentication protocols, like Kerberos. Incorrect date and time settings can cause security issues.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Date&Time Panel.  2. Set the correct date and time."
      reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,CAT|III,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,Rule-ID|SV-31389r1_rule,SANS-CSC|3,STIG-ID|OSX00280,Vuln-ID|V-25296"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/systemsetup -gettime"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00285 - Set a secure time server"
      info        : "Correct date and time settings are required for authentication protocols, like Kerberos. Incorrect date and time settings can cause security issues. You can use Date & Time preferences to set the date and time based on a Network Time Protocol (NTP) server. If you require automatic date and time, use a trusted, internal NTP server."
      info        : "NOTE: Update NTP_SERVER with the appropriate value for the local environment"
      solution    : "1. Open System Preferences> Date&Time Panel.  2.  Select 'Set date & time automatically'.  3.  In the box for the time server, type either the URL or IP address of a valid federal government NTP server or local domain controller."
      reference   : "800-171|3.3.7,800-53|AU-8,8500.2|ECSC-1,CAT|III,CSCv6|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,PCI-DSSv3.1|10.4,PCI-DSSv3.2|10.4,PCI-DSS|10.4,Rule-ID|SV-31391r1_rule,SANS-CSC|3,STIG-ID|OSX00285,Vuln-ID|V-25297"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/ntp.conf"
# Note: Variable @NTP_SERVER@ replaced with "time\\\\.nist\\\\.gov" in field "regex".
      regex       : "^[\\s\\t]*server[\\s\\t]*time\\\\.nist\\\\.gov"
# Note: Variable @NTP_SERVER@ replaced with "time\\\\.nist\\\\.gov" in field "expect".
      expect      : "^[\\s\\t]*server[\\s\\t]*time\\\\.nist\\\\.gov"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00290 - Disable Auto Update feature"
      info        : "You should install and verify updates on a test computer before installing them on your operational computer. When you install a software update using Software Update or an installer package, you must authenticate with an administrator's name and password. This reduces the chance of accidental or malicious installation of software updates.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Software Updates. 2. Click the Scheduled Check pane.  3. Deselect 'Check for updates' and 'Download important updates automatically'.    Command Procedues-  Open a terminal session and enter the following command to disable auto update feature- softwareupdate --schedule off"
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-31393r1_rule,SANS-CSC|3,STIG-ID|OSX00290,Vuln-ID|V-25298"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00295 - Disable Guest Account login"
      info        : "The guest account is used to give a user temporary access to your computer. The guest account should be disabled by default because it does not require a password to log in on the computer. If this account is enabled and not securely configured, malicious users can gain access to your computer without the use of a password."
      solution    : "1. Open System Preferences->Accounts Panel. 2. Click on Guest Account 3. Deselect 'Allow guests to login to this computer'."
      reference   : "800-171|3.1.1,800-53|AC-3,8500.2|IAAC-1,CAT|II,CSF|PR.AC-4,CSF|PR.PT-3,ISO/IEC-27001|A.9.4.1,ITSG-33|AC-3,NESA|T4.2.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.2,NESA|T7.5.3,NIAv2|AM3,NIAv2|SS29,PCI-DSS|2.1,PCI-DSS|2.2.3,Rule-ID|SV-31395r1_rule,SANS-CSC|16,STIG-ID|OSX00295,Vuln-ID|V-25299"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/dscl . -read /Users/Guest AuthenticationAuthority"
      expect      : "AuthenticationAuthority: ;basic;|.*\(eDSRecordNotFound\).*"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00300 - Do not allow guests to connect to shared folders"
      info        : "Whether or not the guest account itself is enabled, disable guest account access to shared files and folders by deselecting the 'Allow guest to connect to shared folders' checkbox. If you permit the guest account to access shared folders, an attacker can easily attempt to access shared folders without a password."
      solution    : "1. Open System Preferences->Accounts Panel. 2. Click on Guest Account.  3. Deselect 'Allow Guests to connect to shared folders'."
      reference   : "800-171|3.1.1,800-53|AC-2,8500.2|ECAN-1,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.2(d),CSF|DE.CM-1,CSF|DE.CM-3,CSF|PR.AC-1,CSF|PR.AC-4,ITSG-33|AC-2,NIAv2|AM28,NIAv2|NS5j,NIAv2|SS14e,PCI-DSS|2.2.3,Rule-ID|SV-31397r1_rule,SANS-CSC|15,SANS-CSC|3,STIG-ID|OSX00300,Vuln-ID|V-25300"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.AppleFileServer guestAccess"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00310 - Configure Login Window to display as entry for name and password."
      info        : "If not properly configured, the logon screen provides a list of local usernames available for logon. A user could use this information to attempt to login as a different user."
      solution    : "1. Open System Preferences->Accounts Panel. 2. Select Login Options.  3. Set 'Display login window as-' to 'Name & password'."
      reference   : "800-171|3.1.7,800-53|AC-6,8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,PCI-DSS|2.2.3,Rule-ID|SV-31401r1_rule,SANS-CSC|3,STIG-ID|OSX00310,Vuln-ID|V-25302"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow SHOWFULLNAME"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00315 - Do not show the Restart, Sleep, and Shutdown buttons"
      info        : "By disabling this button, the user cannot restart the computer without pressing the power key or logging in."
      solution    : "1. Open System Preferences->Accounts Panel.  2. Select Login Options.  3. Deselect the 'Show the Restart, Sleep, and Shutdown buttons' to disable this option."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|III,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,Rule-ID|SV-31403r1_rule,SANS-CSC|3,STIG-ID|OSX00315,SWIFT-CSCv1|5.1,Vuln-ID|V-25303"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow PowerOffDisabled"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00320 - Do not show Input menu in login window"
      info        : "Showing input menu in the login window could compromise the integrity of the information, and could also allow someone shoulder surfing to gain unauthorized access to the system."
      solution    : "1. Open System Preferences->Accounts Panel. 2. Select Login Options. 3.  Deselect 'Show input menu in login window' to disable this option."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|IAAC-1,CAT|I,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-31405r1_rule,SANS-CSC|16,STIG-ID|OSX00320,SWIFT-CSCv1|2.3,Vuln-ID|V-25304"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow showInputMenu"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00325 - Do not show password hints"
      info        : "Providing information in the password hint field could compromise the integrity of the password. Showing password hint could allow someone shoulder surfing to gain information that could lead to unauthorized access to the system."
      solution    : "1. Open System Preferences->Accounts Panel. 2. Select Login Options.  3.  Deselect 'Show password hints' to disable this option."
      reference   : "800-171|3.5.11,800-53|IA-6,8500.2|IAAC-1,CAT|I,ITSG-33|IA-6,NESA|T5.5.1,PCI-DSS|2.2.3,Rule-ID|SV-31407r1_rule,SANS-CSC|16,STIG-ID|OSX00325,Vuln-ID|V-25305"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow RetriesUntilHint"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00330 - Disable Fast User Switching"
      info        : "Fast User Switching allows multiple users to log in simultaneously. This makes it difficult
to track user actions and allows users to run malicious applications in the background
while another user is using the computer."
      solution    : "1. Open System Preferences->Accounts Panel.  2. Select Login Options.  3. Deselect 'Enable Fast User Switching' to disable this option."
      reference   : "800-53|AC-10,8500.2|IAAC-1,CAT|II,ITSG-33|AC-10,NESA|T5.5.1,PCI-DSS|2.2.2,Rule-ID|SV-31409r1_rule,SANS-CSC|16,STIG-ID|OSX00330,Vuln-ID|V-25306"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/.GlobalPreferences MultipleSessionEnabled"
      expect      : "0"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00335 - Do not use password-related hint field"
      info        : "If a hint is provided, the user is presented with the hint after three failed authentication attempts. Password-related information provided in the field could compromise the  integrity of the password. Adding contact information for your organization's technical support is convenient and doesn't compromise password integrity.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences -> Accounts Panel, for each account. 2. Click 'reset password' (Change Password for current user).  3. Remove any data that exists in the password hints field.
Note- The password Hints Field may include contact information for the organization's technical support."
      reference   : "8500.2|IAAC-1,CAT|I,PCI-DSS|2.2.3,Rule-ID|SV-31411r1_rule,SANS-CSC|16,STIG-ID|OSX00335,Vuln-ID|V-25307"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00340 - Do not allow computer to perform automatic actions for blank CD"
      info        : "To secure CDs and DVDs (blank), do not allow the computer to perform automatic actions when the user inserts a disc. When you disable automatic actions in System Preferences, you must disable these actions for every user account on the computer."
      solution    : "1. Open System Preferences - > CDs and DVDs. 2. Set 'When you insert a blank CD-' to 'Ignore'."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECSC-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31413r1_rule,SANS-CSC|3,STIG-ID|OSX00340,SWIFT-CSCv1|2.3,Vuln-ID|V-25308"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.digihub com.apple.digihub.blank.cd.appeared"
      expect      : "action = 1;"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00341 - Do not allow computer to perform automatic actions for blank DVD"
      info        : "To secure CDs and DVDs (blank), do not allow the computer to perform automatic actions when the user inserts a disc. When you disable automatic actions in System Preferences, you must disable these actions for every user account on the computer."
      solution    : "1. Open System Preferences - > CDs and DVDs. 2. Set 'When you insert a blank DVD-' to 'Ignore'."
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECCD-1,CAT|I,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31838r1_rule,SANS-CSC|3,STIG-ID|OSX00341,SWIFT-CSCv1|2.3,Vuln-ID|V-25606"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.digihub com.apple.digihub.blank.dvd.appeared"
      expect      : "action = 1;"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00345 - Do not allow computer to perform automatic actions for music CD"
      info        : "To secure CDs and DVDs (music), do not allow the computer to perform automatic actions when the user inserts a disc. When you disable automatic actions in System Preferences, you must disable these actions for every user account on the computer."
      solution    : "1. Open System Preferences - > CDs and DVDs. 2. Set 'When you insert a music CD-' to 'Ignore'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-31415r1_rule,SANS-CSC|3,STIG-ID|OSX00345,SWIFT-CSCv1|2.3,Vuln-ID|V-25309"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.digihub com.apple.digihub.cd.music.appeared"
      expect      : "action = 1;"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00350 - Do not allow computer to perform automatic actions for picture CD."
      info        : "To secure CDs and DVDs (pictures), do not allow the computer to perform automatic actions when the user inserts a disc. When you disable automatic actions in System Preferences, you must disable these actions for every user account on the computer."
      solution    : "1. Open System Preferences - > CDs and DVDs. 2. Set 'When you insert a picture CD-' to 'Ignore'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-31417r1_rule,SANS-CSC|3,STIG-ID|OSX00350,SWIFT-CSCv1|2.3,Vuln-ID|V-25310"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.digihub com.apple.digihub.cd.picture.appeared"
      expect      : "action = 1;"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00355 - Do not allow computer to perform automatic actions for video DVD"
      info        : "To secure CDs and DVDs (video), do not allow the computer to perform automatic actions when the user inserts a disc. When you disable automatic actions in System Preferences, you must disable these actions for every user account on the computer."
      solution    : "1. Open System Preferences - > CDs and DVDs. 2. Set 'When you insert a video DVD-' to 'Ignore'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|I,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-31419r1_rule,SANS-CSC|3,STIG-ID|OSX00355,SWIFT-CSCv1|2.3,Vuln-ID|V-25311"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.digihub com.apple.digihub.dvd.video.appeared"
      expect      : "action = 1;"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00360 - System must have a password-protected Screen Saver configured to DoD requirements."
      info        : "You need to configure a password-protected screen saver to prevent unauthorized users from accessing unattended computers. You should also set a short inactivity interval to decrease the amount of time the unattended computer is unlocked. This check has two steps, the first step is to turn on the screen saver option and set it to 15 minutes or less, the second step is to require a password to unlock the screen saver."
      solution    : "Open System Preferences->Desktop & Screen Saver. Select the screen saver tab. Set the 'Start screen saver' slider to 15 minutes or less."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-31421r1_rule,STIG-ID|OSX00360,Vuln-ID|V-25312"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults -currentHost read com.apple.screensaver idleTime"
      expect      : "(9[0-9][0-9]|[1-9][0-9][0-9][0-9]+)"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00370 - -Battery Options"
      info        : "You can also use the Options pane to make settings depending on your power supply (power adapter, UPS, or battery). Don't set the computer to restart after a power failure."
      solution    : "1. Open System Preferences - > Energy Saver - > Options Pane. 2.  Deselect 'Restart automatically after a power failure' to disable this option.
Note- For some Mac Books systems the 'Restart automatically after a power failure' option is located on the 'Power Adapter' pane."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|ECSC-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,Rule-ID|SV-31425r1_rule,SANS-CSC|3,STIG-ID|OSX00370,Vuln-ID|V-25314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/pmset -g"
      expect      : "autorestart[\\s\\t]*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00370 - Battery Options - 'systemsetup -getwaitforstartupafterpowerfailure'"
      info        : "You can also use the Options pane to make settings depending on your power supply (power adapter, UPS, or battery). Don't set the computer to restart after a power failure.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences - > Energy Saver - > Options Pane. 2.  Deselect 'Restart automatically after a power failure' to disable this option.
Note- For some Mac Books systems the 'Restart automatically after a power failure' option is located on the 'Power Adapter' pane."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|ECSC-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,Rule-ID|SV-31425r1_rule,SANS-CSC|3,STIG-ID|OSX00370,Vuln-ID|V-25314"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/systemsetup -getwaitforstartupafterpowerfailure"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00375 -  Secure screen saver corners - 'Top Left Corner'."
      info        : "Your computer should require authentication when waking from sleep or screen saver.
You can configure Expose & Spaces preferences to allow you to quickly
start the screen saver if you move your mouse cursor to a corner of the screen. Don't
configure a corner to disable the screen saver."
      solution    : "1. Open System Preferences->Expose & Spaces, Expose pane.  2.  Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-31429r1_rule,STIG-ID|OSX00375,Vuln-ID|V-25317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.dock wvous-tl-corner"
      expect      : "[0-5-7]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00375 -  Secure screen saver corners - 'Top Right Corner'."
      info        : "Your computer should require authentication when waking from sleep or screen saver.
You can configure Expose & Spaces preferences to allow you to quickly
start the screen saver if you move your mouse cursor to a corner of the screen. Don't
configure a corner to disable the screen saver."
      solution    : "1. Open System Preferences->Expose & Spaces, Expose pane.  2.  Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-31429r1_rule,STIG-ID|OSX00375,Vuln-ID|V-25317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.dock wvous-tr-corner"
      expect      : "[0-5-7]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00375 -  Secure screen saver corners - 'Bottom Left Corner'."
      info        : "Your computer should require authentication when waking from sleep or screen saver.
You can configure Expose & Spaces preferences to allow you to quickly
start the screen saver if you move your mouse cursor to a corner of the screen. Don't
configure a corner to disable the screen saver."
      solution    : "1. Open System Preferences->Expose & Spaces, Expose pane.  2.  Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-31429r1_rule,STIG-ID|OSX00375,Vuln-ID|V-25317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.dock wvous-bl-corner"
      expect      : "[0-5-7]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00375 -  Secure screen saver corners - 'Bottom Right Corner'."
      info        : "Your computer should require authentication when waking from sleep or screen saver.
You can configure Expose & Spaces preferences to allow you to quickly
start the screen saver if you move your mouse cursor to a corner of the screen. Don't
configure a corner to disable the screen saver."
      solution    : "1. Open System Preferences->Expose & Spaces, Expose pane.  2.  Remove any corners which are set to 'Disable Screen saver' in the 'Active Screen Corners' section for each user account."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,NESA|T2.3.8,NESA|T2.3.9,NIAv2|AM23a,NIAv2|AM23b,PCI-DSS|2.2.3,Rule-ID|SV-31429r1_rule,STIG-ID|OSX00375,Vuln-ID|V-25317"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.dock wvous-br-corner"
      expect      : "[0-5-7]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00380 - Do not allow Bluetooth devices to wake the computer."
      info        : "If Bluetooth is not required, turn it off. If Bluetooth is necessary, disable allowing Bluetooth devices to wake the computer."
      solution    : "1.  Open System Preferences ->  Keyboard & Mouse preferences.  2. Click Bluetooth tab.  3. Deselect 'Allow Bluetooth devices to wake this computer'."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31431r1_rule,SANS-CSC|3,STIG-ID|OSX00380,SWIFT-CSCv1|2.3,Vuln-ID|V-25318"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults -currentHost read /var/root/Library/Preferences/com.apple.Bluetooth BluetoothSystemWakeEnable"
      expect      : "(0|does not exist)"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00385 - Disable unused hardware devices for Airport"
      info        : "It is recommended that you disable unused hardware devices listed in Network preferences. Enabled, unused devices (such as AirPort and Bluetooth) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences - > Network.  2. From the list of hardware devices, select AirPort.  3. Set this service to 'Inactive' by clicking the gear sign and selecting 'Make Service Inactive'.  Remove service if required by site requirements by clicking the minus sign.   (From the 'Configure' pop-up menu, choose 'Manually'.)"
      reference   : "8500.2|ECSC-1,CAT|II,PCI-DSS|2.2.2,Rule-ID|SV-31434r1_rule,SANS-CSC|3,STIG-ID|OSX00385,Vuln-ID|V-25320"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00390 - Disable unused devices"
      info        : "It is recommend that you disable unused hardware devices listed in Network preferences. Enabled, unused devices (such as AirPort and Bluetooth) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer."
      solution    : "1. Open System Preferences - > Network. 2. From the list of hardware devices, select Bluetooth. 3. Set this service to Inactive by clicking the gear sign and selecting 'Make Service Inactive'. Remove service if required by site requirements by clicking the minus sign. (From the 'Configure' pop-up menu, choose 'Manually'.)"
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31436r1_rule,SANS-CSC|3,STIG-ID|OSX00390,SWIFT-CSCv1|2.3,Vuln-ID|V-25321"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.Bluetooth ControllerPowerState"
      expect      : "0"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00395 - Disable unused hardware devices for Firewire"
      info        : "It is recommend that you disable unused hardware devices listed in Network preferences. Enabled, unused devices (Firewire) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences - > Network. 2. From the list of hardware devices, select Firewire. 3. Set this service to 'Inactive' by clicking the gear sign and selecting 'Make Service Inactive'. Remove service if required by site requirements by clicking the minus sign. (From the 'Configure' pop-up menu, choose 'Manually'.)"
      reference   : "8500.2|ECSC-1,CAT|II,PCI-DSS|2.2.2,Rule-ID|SV-31439r1_rule,SANS-CSC|3,STIG-ID|OSX00395,Vuln-ID|V-25323"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system        : "Darwin"
      type          : CMD_EXEC
      description   : "OSX00400 - Disable IPv6 - 'IPv6 interface listing'"
      info          : "It is recommended that you disable unused hardware devices listed in Network preferences. Enabled, unused devices (such as AirPort and Bluetooth) are a security risk. Hardware is listed in Network preferences only if the hardware is installed in the computer. Note- this must be disabled on each network interface.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution      : "1. Open System Preferences - > Network.  2. Click Advanced 3. CLick the TCP/IP tab and set 'Configure IPv6' to 'Off',  if not actively being used.  Note- this must be disabled on each network interface."
      reference     : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31441r1_rule,SANS-CSC|3,STIG-ID|OSX00400,SWIFT-CSCv1|2.3,Vuln-ID|V-25324"
      see_also      : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd           : "/sbin/ifconfig -a inet6 | /usr/bin/grep -v flags | /usr/bin/grep -v 'inet6 ::1' | /usr/bin/grep -v 'inet6 fe80::1%lo0'"
      expect        : ""
      dont_echo_cmd : YES
      severity      : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "OSX00405 - Disable Auto play of movies."
      info        : "Allowing movies to play automatically will not allow the user to first perform an anti-virus scan of the files to detect malware or unauthorized code.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->QuickTime, Browser Pane.  2.  Deselect 'Play Movies Automatically'."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-31443r1_rule,SANS-CSC|3,STIG-ID|OSX00405,Vuln-ID|V-25325"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00410 - Disable disk cache of movies"
      info        : "Only download QuickTime movies from trusted, secure sources. By default, QuickTime stores downloaded movies in a cache. If someone gains access to your account, he/she can see your previously viewed movies, even if you did not save them as files. You can change QuickTime preferences to disable the storing of movies in a cache (in /Users/user name/Library/Caches/QuickTime/downloads/).

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->QuickTime, Browser Pane.  2.  Deselect 'Save Movies in disk cache'."
      reference   : "8500.2|DCSL-1,CAT|II,Rule-ID|SV-31445r1_rule,STIG-ID|OSX00410,Vuln-ID|V-25326"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00415 - Securely configure QuickTime Advanced preferences"
      info        : "Securely configure QuickTime Advanced preferences, Load Flash and ensure if option is given under Advanced tab, confirm value to be checked (i.e., 'Kiosk Mode' or 'Kiosk Mode- Hides option to save movies & to change settings from within the web browser').

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->QuickTime, Advanced Pane.  2.  Select 'Enable Kiosk Mode'."
      reference   : "8500.2|DCSL-1,CAT|II,Rule-ID|SV-31447r1_rule,STIG-ID|OSX00415,Vuln-ID|V-25327"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00420 - Require password to wake this computer from sleep or screen saver."
      info        : "Require a password to wake this computer from sleep or screen saver. This helps prevent unauthorized access on unattended computers. Although there is a lock button for Security references, users don't need to be authorized as an administrator to make changes. Enable this password requirement for every user account on the computer."
      solution    : "1. Open System Preferences->Security. 2 Select General tab. 3. Select 'Require password to wake this computer from sleep or screen saver'."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|PESL-1,CAT|II,CSCv6|16.5,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-31449r1_rule,STIG-ID|OSX00420,Vuln-ID|V-25328"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults -currentHost read com.apple.screensaver askForPassword"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00425 - Disable automatic login"
      info        : "Disabling automatic login is necessary for any level of security. If you enable automatic login, an intruder can log in without authenticating. Even if you automatically log in with a restricted user account, it is still easier to perform malicious actions on the computer."
      solution    : " 1. Open System Preferences->Security. 2. Select General tab. 3. Select 'Disable automatic login'."
      reference   : "800-53|AC-14,8500.2|IAAC-1,CAT|I,ITSG-33|AC-14,NESA|T5.6.1,PCI-DSS|2.2.3,Rule-ID|SV-31451r1_rule,SANS-CSC|16,STIG-ID|OSX00425,Vuln-ID|V-25329"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/.GlobalPreferences com.apple.userspref.DisableAutoLogin"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00430 -Require a password to unlock each System Preference Pane"
      info        : "Some system preferences are unlocked when you log in with an administrator account. By requiring a password, digital token, smart card, or biometric reader to unlock secure system preferences, you require extra authentication."
      solution    : "1. Open System Preferences->Security. 2. Select General tab. 3. Select 'Require password to unlock each System Preferences Pane'."
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|ECSC-1,CAT|II,CSF|PR.AC-4,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.4.4,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM31,NIAv2|GS3,NIAv2|GS4,NIAv2|GS8c,NIAv2|VL3b,PCI-DSS|2.2.3,Rule-ID|SV-31453r1_rule,SANS-CSC|3,STIG-ID|OSX00430,SWIFT-CSCv1|5.1,Vuln-ID|V-25330"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/cat /etc/authorization | /usr/bin/grep -C15 '>system.preferences<' | /usr/bin/grep -C1 '<key>shared</key>'"
      expect      : "<false/>"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00435 - Disable Logout after X minutes of activity"
      info        : "Although you might want to enable automatic logout based on inactivity, there are reasons why you should disable this feature. First, it can disrupt your workflow. Second, it can close applications or processes without your approval (but a password-protected screen saver will not close applications). Third, because automatic logout can be interrupted, it provides a false sense of security."
      solution    : "1. Open System Preferences->Security. 2. Select General tab. 3. Deselect 'Log out after x minutes of inactivity'."
      reference   : "800-171|3.1.10,800-53|AC-11,8500.2|ECSC-1,CAT|III,ISO/IEC-27001|A.11.2.8,ITSG-33|AC-11,PCI-DSS|2.2.3,Rule-ID|SV-31455r1_rule,SANS-CSC|3,STIG-ID|OSX00435,Vuln-ID|V-25331"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/.GlobalPreferences com.apple.autologout.AutoLogOutDelay"
      expect      : "0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00440 - Use secure virtual memory"
      info        : "Use secure virtual memory. The system's virtual memory swap file stores inactive physical memory contents, freeing your physical memory. By default on some systems, the swap file is unencrypted. This file can contain confidential data such as documents and passwords. By using secure virtual memory, you secure the swap file at a cost of slightly slower speed (because Mac OS X must encrypt and decrypt the secure swap file)."
      solution    : "1. Open System Preferences->Security. 2. Select General tab. 3. Select 'Use Secure Virtual Memory'."
      reference   : "800-53|SI-16,8500.2|ECRC-1,CAT|II,PCI-DSS|2.2.3,Rule-ID|SV-31457r1_rule,SANS-CSC|17,STIG-ID|OSX00440,Vuln-ID|V-25332"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.virtualMemory UseEncryptedSwap"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00445 - Disable remote control infrared receiver."
      info        : "If you are not using a remote control, disable the infrared receiver. This prevents unauthorized users from controlling your computer through the infrared receiver."
      solution    : "1. Open System Preferences->Security. 2. Select General tab. 3. Select 'Disable remote control infrared receiver'."
      reference   : "800-171|3.1.18,800-53|AC-19,8500.2|ECSC-1,CAT|II,CSF|PR.AC-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,PCI-DSS|2.2.2,Rule-ID|SV-31459r1_rule,SANS-CSC|3,STIG-ID|OSX00445,Vuln-ID|V-25333"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled"
      expect      : "0"
    </custom_item>

    <if>
      <condition type:"AND">
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00445 - Disable remote control infrared receiver."
          cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController DeviceEnabled"
          expect      : "1"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          system      : "Darwin"
          type        : CMD_EXEC
          description : "OSX00445 - Disable remote control infrared receiver - Paired."
          info        : "If you are not using a remote control, disable the infrared receiver. This prevents unauthorized users from controlling your computer through the infrared receiver."
          solution    : "1. Open System Preferences->Security. 2. Select General tab. 3. Select 'Disable remote control infrared receiver'."
          reference   : "800-171|3.1.18,800-53|AC-19,8500.2|ECSC-1,CAT|II,CSF|PR.AC-3,ISO/IEC-27001|A.6.2.1,ITSG-33|AC-19,PCI-DSS|2.2.2,Rule-ID|SV-31459r1_rule,SANS-CSC|3,STIG-ID|OSX00445,Vuln-ID|V-25333"
          see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
          cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.driver.AppleIRController UIDFilter"
          expect      : "[0-9]+"
        </custom_item>
      </then>
    </if>

    <report type:"WARNING">
      description : "OSX00450 - Pair infrared receiver with a specific IR remote (if receiver was not disabled previously)"
      info        : " If you use an Apple IR Remote Control, pair it to your computer by clicking Pair. When you pair it, no other IR remote can control your computer. IR receiver paired with a specific IR remote (if IR receiver was not disabled previously)

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Security Pane. 2. Select General tab. 3. Click 'Pair' to pair IR Remote Control to this system."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-31461r1_rule,SANS-CSC|3,STIG-ID|OSX00450,Vuln-ID|V-25334"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00455 - Allow only essential services through firewall."
      info        : "Allowing only essential services through the firewall alleviates the potential for unwanted services to run on the system and cuts down on system usage."
      solution    : "1. Open System Preferences->Security.
2. Select Firewall tab.
3. Select Set access for specific services and applications
4. Add only essential services and applications for incoming connections and remove unneeded services and applications."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECND-1,CAT|II,CSCv6|9.2,ITSG-33|SC-7,NIAv2|AM38,NIAv2|SS13d,NIAv2|SS26,Rule-ID|SV-31463r1_rule,SANS-CSC|10,STIG-ID|OSX00455,Vuln-ID|V-25335"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.alf globalstate"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00460 - Enable Firewall logging"
      info        : "Enable Firewall Logging to provide information about firewall activity."
      solution    : "1. Open System Preferences->Security. 2. Select Firewall tab. 3. Click on Advanced. 4. Select 'Enable Firewall logging'."
      reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,PCI-DSS|1.4,Rule-ID|SV-31465r1_rule,SANS-CSC|3,STIG-ID|OSX00460,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-25336"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.alf loggingenabled"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00465 - Enable Stealth Mode on the firewall (mobile platforms only)"
      info        : "Enable Stealth Mode to prevent the computer from sending responses to uninvited traffic."
      solution    : "1. Open System Preferences->Security. 2. Select Firewall tab. 3. Click on Advanced. 4. Select 'Enable Stealth mode'."
      reference   : "800-171|3.13.1,800-53|SC-7,8500.2|ECSC-1,CAT|II,CSF|PR.PT-4,ITSG-33|SC-7,NIAv2|GS8d,PCI-DSS|1.4,Rule-ID|SV-31467r1_rule,SANS-CSC|3,STIG-ID|OSX00465,Vuln-ID|V-25337"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/com.apple.alf stealthenabled"
      expect      : "1"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00467 - Disable Bonjour"
      info        : "Bonjour is unnecessary in a managed environment and presents an attack surface.  Its behavior, which trusts the local network, is especially inappropriate on portable devices which may connect to untrusted networks.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Run the command- sudo launchctl -w unload com.apple.mDNSResponder to disable Bonjour."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECSC-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-32239r1_rule,SANS-CSC|3,STIG-ID|OSX00467,SWIFT-CSCv1|2.3,Vuln-ID|V-25882"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.mDNSResponder"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <report type:"WARNING">
      description : "OSX00470 - Do not allow DVD or CD Sharing"
      info        : "Allows users of other computers to remotely use the DVD or CD drive on your computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'DVD or CD Sharing' service."
      reference   : "8500.2|ECCD-1,CAT|II,Rule-ID|SV-31469r1_rule,SANS-CSC|3,STIG-ID|OSX00470,Vuln-ID|V-25338"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK_NOT
      description : "OSX00475-Screen Sharing - '/Library/Preferences/com.apple.ScreenSharing.launchd' should not exist"
      info        : "Allows users of other computers to remotely view and control the computer."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Screen Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,Rule-ID|SV-31471r1_rule,SANS-CSC|3,STIG-ID|OSX00475,SWIFT-CSCv1|2.3,Vuln-ID|V-25339"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/Library/Preferences/com.apple.ScreenSharing.launchd"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 - File Sharing - unload '/System/Library/LaunchDaemons/ftp.plist'"
      info        : "Gives users of other computers access to each user's Public folder.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31473r1_rule,SANS-CSC|3,STIG-ID|OSX00480,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.ftpd"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 - File Sharing - com.apple.smb.server"
      info        : "Gives users of other computers access to each user's Public folder.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31473r1_rule,SANS-CSC|3,STIG-ID|OSX00480,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server EnabledServices"
      expect      : "(^$|does not exist)"
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 - File Sharing - unload '/System/Library/LaunchDaemons/nmbd.plist'"
      info        : "Gives users of other computers access to each user's Public folder.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31473r1_rule,SANS-CSC|3,STIG-ID|OSX00480,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep org.samba.nmbd"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 - File Sharing - unload '/System/Library/LaunchDaemons/smbd.plist'"
      info        : "Gives users of other computers access to each user's Public folder.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31473r1_rule,SANS-CSC|3,STIG-ID|OSX00480,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep org.samba.smbd"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00480 - File Sharing - unload '/System/Library/LaunchDaemons/com.apple.AppleFileServer.plist'"
      info        : "Gives users of other computers access to each user's Public folder.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'File Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,PCI-DSS|2.2.3,Rule-ID|SV-31473r1_rule,SANS-CSC|3,STIG-ID|OSX00480,SWIFT-CSCv1|2.3,Vuln-ID|V-25340"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.AppleFileServer"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK_NOT
      description : "OSX00485 - Printer Sharing - Port 631"
      info        : "Allows other computers to access a printer connected to this computer."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Printer Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-31475r1_rule,SANS-CSC|3,STIG-ID|OSX00485,SWIFT-CSCv1|2.3,Vuln-ID|V-25341"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/cups/cupsd.conf"
      regex       : "^[\\s\\t]*Port[\\s\\t]+631"
      expect      : "^[\\s\\t]*Port[\\s\\t]+631"
      required    : NO
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CONTENT_CHECK
      description : "OSX00485 - Printer Sharing - Listen localhost:631"
      info        : "Allows other computers to access a printer connected to this computer."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Printer Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-31475r1_rule,SANS-CSC|3,STIG-ID|OSX00485,SWIFT-CSCv1|2.3,Vuln-ID|V-25341"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/cups/cupsd.conf"
      regex       : "^[\\s\\t]*Listen[\\s\\t]+localhost:631"
      expect      : "^[\\s\\t]*Listen[\\s\\t]+localhost:631"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00490-Web Sharing - unload '/System/Library/LaunchDaemons/org.apache.httpd.plist'"
      info        : "Allows a network user to view websites located in /Sites.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Web Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31477r1_rule,SANS-CSC|3,STIG-ID|OSX00490,SWIFT-CSCv1|2.3,Vuln-ID|V-25342"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep org.apache.httpd"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00495 - Do not allow Remote Login"
      info        : "This feature allows users to access the computer remotely."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Remote Login' service."
      reference   : "800-171|3.1.1,800-171|3.1.2,800-53|AC-17,8500.2|ECCD-1,CAT|II,CIP|005-5-R2,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17,NESA|T5.4.5,Rule-ID|SV-31479r1_rule,SANS-CSC|3,STIG-ID|OSX00495,SWIFT-CSCv1|2.6,Vuln-ID|V-25343"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/systemsetup -getremotelogin"
      expect      : "^[\\s\\t]*Remote Login:[\\s\\t]*[Oo][Ff][Ff]"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00500 - Do not allow Remote Management"
      info        : "Allows the computer to be accessed using Apple Remote Desktop.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Remote Management' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.3,Rule-ID|SV-31483r1_rule,SANS-CSC|3,STIG-ID|OSX00500,SWIFT-CSCv1|2.3,Vuln-ID|V-25346"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep .AppleVNCServer"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00505 - Remote Apple Events - unload '/System/Library/LaunchDaemons/eppc.plist'"
      info        : "Allows the computer to receive Apple events from other computers.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Remote Apple Events' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31486r1_rule,SANS-CSC|3,STIG-ID|OSX00505,SWIFT-CSCv1|2.3,Vuln-ID|V-25348"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.AEServer"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00505-Remote Apple Events - unload '/System/Library/LaunchDaemons/com.apple.InternetSharing.plist'"
      info        : "Allows the computer to receive Apple events from other computers.

 NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Remote Apple Events' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31486r1_rule,SANS-CSC|3,STIG-ID|OSX00505,SWIFT-CSCv1|2.3,Vuln-ID|V-25348"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/bin/launchctl list | /usr/bin/grep com.apple.InternetSharing"
      expect      : ""
      severity    : MEDIUM
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00510 - Do not allow Xgrid Sharing - controller status"
      info        : "Allows computers on a network to work together in a grid to process a job."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Xgrid Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31488r1_rule,SANS-CSC|3,STIG-ID|OSX00510,SWIFT-CSCv1|2.3,Vuln-ID|V-25349"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/xgridctl controller status"
      expect      : "xgridcontrollerd[\\s\\t]+stopped"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00510 - Do not allow Xgrid Sharing - agent status"
      info        : "Allows computers on a network to work together in a grid to process a job."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Xgrid Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31488r1_rule,SANS-CSC|3,STIG-ID|OSX00510,SWIFT-CSCv1|2.3,Vuln-ID|V-25349"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/sbin/xgridctl agent status"
      expect      : "xgridagentd[\\s\\t]+stopped"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00515 - Do not allow Internet Sharing"
      info        : "Allows other users to connect with computers on your local network, through your Internet connection."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Internet Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31490r1_rule,SANS-CSC|3,STIG-ID|OSX00515,SWIFT-CSCv1|2.3,Vuln-ID|V-25350"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.nat NAT"
      expect      : "Enabled[\\s\\t]*=[\\s\\t]*0"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : CMD_EXEC
      description : "OSX00520 - Do not allow Bluetooth Sharing"
      info        : "Allows other Bluetooth-enabled computers and devices to share files with your computer."
      solution    : "1. Open System Preferences->Sharing. 2. Uncheck the 'On' box for 'Bluetooth Sharing' service."
      reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,8500.2|ECCD-1,8500.2|ECWN-1,CAT|II,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSS|2.2.2,Rule-ID|SV-31492r1_rule,SANS-CSC|3,SANS-CSC|7,STIG-ID|OSX00520,SWIFT-CSCv1|2.3,Vuln-ID|V-25351"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/defaults read com.apple.bluetooth PrefKeyServicesEnabled"
      expect      : "0"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00525 - Configure Mail using SSL"
      info        : "When setting up user mail accounts, select 'use SSL' in advanced options. This setting is for the Mail app included with OS X.  Instructions will be different for other mail applications, but all mail applications should be set up secured using some form of encryption. Note- if you are not using the Mac Mail application this check does not apply.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Choose Mail > Preferences, and then click Accounts.
2. Select an account, and then click Advanced.
3. Select 'Use SSL'.
4. From the Authentication pop-up menu, select authentication method (e.g., MD5 Challenge-Response, NTLM, Kerberos Version 5 (GSSAPI), or Authenticated POP (APOP)).
5. Click Account Information.
6. From the Outgoing Mail Server (SMTP) pop-up menu, select Edit Server List.
7. From the server list, select your outgoing mail server and then click Advanced.
8. Select 'Secure Socket Layer (SSL)'.
9. From the Authentication pop-up menu, select authentication method (e.g., MD5 Challenge-Response, NTLM, or Kerberos Version 5 (GSSAPI)).
10. Close the preferences window, and then click Save in the message that appears."
      reference   : "8500.2|ECCT-1,8500.2|ECCT-2,CAT|II,Rule-ID|SV-31496r1_rule,SANS-CSC|17,STIG-ID|OSX00525,Vuln-ID|V-25354"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00530 - Disable iTunes Store"
      info        : "iTunes store allows a user to purchase and download music, videos, and podcasts, which could inadvertently introduce malware on the system. Note- the fix must be performed for each user.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Open Finder,
Select Applications,
Double click the iTunes application,
On the top menu bar click iTunes and from the drop down menu select Preferences,
Click on the Parental icon,
Click on the Disable iTunes Store option.
Note- This must be performed for each user."
      reference   : "8500.2|ECSC-1,CAT|III,Rule-ID|SV-31498r1_rule,SANS-CSC|3,STIG-ID|OSX00530,Vuln-ID|V-25355"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00535 - Set Finder to always empty Trash securely"
      info        : "In Mac OS X Leopard, you can configure Finder to always securely erase items placed in the Trash. This prevents data you've placed in the Trash from being restored.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open Finder-> Preferences -> Advanced.  2. Select 'Empty Trash Securely'.  This must be done for each user on the system."
      reference   : "8500.2|ECRC-1,CAT|III,Rule-ID|SV-31500r1_rule,SANS-CSC|17,STIG-ID|OSX00535,Vuln-ID|V-25356"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00540 - Remove iDisk from Finder sidebar"
      info        : "Your iDisk data is stored on Internet servers and is protected by your MobileMe account. However, if your MobileMe account is accessed by an unauthorized user, your data can be compromised. Don't store sensitive data on iDisk. Keep sensitive data local and encrypted on your computer.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1 Open Finder -> Preferences -> Sidebar.  2.  De-select the iDisk icon.  This must be done for each user on the system."
      reference   : "8500.2|ECRC-1,CAT|II,Rule-ID|SV-31505r1_rule,SANS-CSC|17,STIG-ID|OSX00540,Vuln-ID|V-25358"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      type        : CMD_EXEC
      description : "OSX00655 - Disable root administrator account"
      info        : "The most powerful user account in Mac OS X is the system administrator or root account. By default, the root account on Mac OS X is disabled and it is recommended you do not enable it. The root account is primarily used for performing UNIX commands. Generally, actions that involve critical system files require you to perform those actions as root."
      solution    : "Open Finder
Click Applications
Click Utility
Double click Directory Utility
Click the Lock and enter the password to unlock the options
Click the Edit tab (Directory Utility bar on top)
Click Disable Root User"
      reference   : "800-171|3.1.5,800-53|AC-6,8500.2|IAAC-1,CAT|I,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),CSF|PR.AC-4,CSF|PR.DS-5,ITSG-33|AC-6,NESA|T5.1.1,NESA|T5.2.2,NESA|T5.4.1,NESA|T5.4.4,NESA|T5.4.5,NESA|T5.5.4,NESA|T5.6.1,NESA|T7.5.3,NIAv2|AM1,NIAv2|AM23f,NIAv2|SS13c,NIAv2|SS15c,PCI-DSS|2.2.3,Rule-ID|SV-31523r1_rule,SANS-CSC|16,STIG-ID|OSX00655,SWIFT-CSCv1|5.1,Vuln-ID|V-25371"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      cmd         : "/usr/bin/dscl . -read /Users/root AuthenticationAuthority"
      regex       : "AuthenticationAuthority:.*"
      expect      : "AuthenticationAuthority:\\s(No.such.key|DisabledUser)"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00660 - Physical Security"
      info        : "Inadequate physical protection can undermine all other security precautions utilized to protect the system. This can jeopardize the confidentiality, availability, and integrity of the system. Physical security of the AIS is the first line protection of any system.
Physical security of the Automated Information System (AIS) must meet DoD requirements.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Relocate equipment to a controlled access area."
      reference   : "8500.2|PECF-2,CAT|II,Rule-ID|SV-31525r1_rule,STIG-ID|OSX00660,Vuln-ID|V-25372"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00665 - Shared User Accounts are not permitted on the system"
      info        : "Shared accounts do not provide individual accountability for system access and resource usage. Shared user accounts are not permitted on the system.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Remove any shared accounts that do not meet the exception requirements listed."
      reference   : "8500.2|IAGA-1,CAT|II,Rule-ID|SV-31527r1_rule,SANS-CSC|16,STIG-ID|OSX00665,Vuln-ID|V-25373"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00675 - System Recovery Backups"
      info        : "Recovery of a damaged or compromised system in a timely basis is difficult without a system information backup. A system backup will usually include sensitive information such as user accounts that could be used in an attack. As a valuable system resource, the system backup should be protected and stored in a physically secure location.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Implement data backup procedures that comply with DoD requirements."
      reference   : "8500.2|CODB-1,CAT|III,Rule-ID|SV-31531r1_rule,SANS-CSC|8,STIG-ID|OSX00675,Vuln-ID|V-25375"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00685 - Emergency Administrator Account"
      info        : "This check verifies that a backup administrator account has been created to ensure system availability in the event that no administrators are able or available to access the system.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create and maintain an emergency admininstrator account for emergency situations."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-31533r1_rule,SANS-CSC|12,STIG-ID|OSX00685,Vuln-ID|V-25376"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00690 - Administrator Account Password Changes"
      info        : "This check verifies that the passwords for the default and emergency administrator accounts are changed at least annually or when any member of the administrative team leaves the organization.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Define a policy for required password changes for the default and backup admin account."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-31535r1_rule,SANS-CSC|12,STIG-ID|OSX00690,Vuln-ID|V-25377"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00695 - Application Account Passwords"
      info        : "Setting application accounts to expire may cause applications to stop functioning. The site will have a policy that application account passwords manually generated and entered by a system administrator are changed at least annually or when a system administrator with knowledge of the password leaves the organization. Application/service account passwords will be at least 15 characters and follow complexity requirements for all passwords. Interview the system administrators on their policy for application/service accounts. If it does not meet the above requirements, this is a finding.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "Create application/service account passwords that are at least 15 characters in length and meet complexity requirements. Change application/service account passwords that are manually generated and entered by a system administrator at least annually or whenever an administrator with knowledge of the password leaves the organization."
      reference   : "8500.2|ECPA-1,CAT|II,Rule-ID|SV-31537r1_rule,SANS-CSC|12,STIG-ID|OSX00695,Vuln-ID|V-25378"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <report type:"WARNING">
      description : "OSX00700 - Enable Automatic Screen Saver initiation when token removed from machine"
      info        : "Determines what should happen when the smart card for a logged-on user is removed from the smart card reader. Note- if you are not using a smart card application this check does not apply.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "1. Open System Preferences.
2. Click the Security Icon
3. Click the General Tab
4. Select 'Activate screen saver when login token is removed'."
      reference   : "8500.2|ECSC-1,CAT|II,Rule-ID|SV-31539r1_rule,SANS-CSC|3,STIG-ID|OSX00700,Vuln-ID|V-25379"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /usr/sbin/auditd"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/sbin/auditd"
      mask        : "222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /usr/sbin/audit"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/sbin/audit"
      mask        : "222"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /usr/sbin/auditreduce"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/usr/sbin/auditreduce"
      mask        : "033"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/rc.audit"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/rc.audit"
      mask        : "377"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/audit_control"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_control"
      mask        : "377"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/audit_class"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_class"
      mask        : "333"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/audit_event"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_event"
      mask        : "333"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/audit_user"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_user"
      mask        : "377"
    </custom_item>

    <custom_item>
      system      : "Darwin"
      type        : FILE_CHECK
      description : "OSX00680 - Incorrect Permission for Event Logs - /etc/security/audit_warn"
      info        : "Event logs are susceptible to unauthorized, and possibly anonymous, tampering if proper permissions are not applied."
      solution    : "Open a terminal session and set the following file permissions-

/usr/sbin/auditd	555
/usr/sbin/audit	555
/usr/sbin/auditreduce	744
/etc/security/rc.audit	400
/etc/security/audit_control	400
/etc/security/audit_class	444
/etc/security/audit_event	444
/etc/security/audit_user	400
/etc/security/audit_warn	555"
      reference   : "800-171|3.4.2,800-53|CM-6,8500.2|ECTP-1,CAT|II,CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-31541r1_rule,SANS-CSC|14,STIG-ID|OSX00680,SWIFT-CSCv1|2.3,Vuln-ID|V-25380"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
      file        : "/etc/security/audit_user"
      mask        : "222"
    </custom_item>

    <report type:"WARNING">
      description : "OSX00705 - Securely configure Spotlight Panel"
      info        : "You can use Spotlight to search your computer for files. Spotlight searches the name, the meta-information associated with each file, and the contents of each file. Spotlight finds files regardless of their placement in the file system. You must still properly set access permissions on folders containing confidential files.

 NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
      solution    : "To securely configure Spotlight preferences-
1. Open System Perferences
2. Click the Spotlight Icon.
2. In the Search Results pane, deselect categories you don't want searchable by Spotlight.
3. Click the Privacy pane.
4. Click the Add button or drag a folder or disk into the Privacy pane.
5. Folders and disks in the Privacy pane are now not searchable by Spotlight."
      reference   : "8500.2|ECCD-1,CAT|II,Rule-ID|SV-31599r1_rule,SANS-CSC|3,STIG-ID|OSX00705,Vuln-ID|V-25413"
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>
  </then>

  <else>
    <report type:"WARNING">
      description : "DISA_STIG_MacOSX_10.5_v1r2.audit"
      info        : "NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "http://iase.disa.mil/stigs/os/mac/u_mac_osx10.5_v1r2_stig_20110729.zip"
    </report>
  </else>
</if>

</check_type>
