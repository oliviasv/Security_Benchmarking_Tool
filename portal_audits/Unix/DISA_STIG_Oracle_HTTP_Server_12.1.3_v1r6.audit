#
# This script is Copyright (C) 2004-2020 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
# $Revision: 1.1 $
# $Date: 2020/07/14 $
#
# Description : This document implements the security configuration as recommended by the
#               DISA Oracle HTTP Server 12.1.3 v1r6 STIG.
#
#<ui_metadata>
#<display_name>DISA STIG Oracle HTTP Server 12.1.3 v1r6</display_name>
#<spec>
#  <type>DISA STIG</type>
#  <name>Oracle HTTP Server 12.1.3</name>
#  <version>1.6.0</version>
#  <link>https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip</link>
#</spec>
#<labels>unix,disa,oracle,http,webserver,agent</labels>
#<benchmark_refs>CAT,CCI,Rule-ID,STIG-ID,Vuln-ID,Group-ID</benchmark_refs>
#<variables>
#  <variable>
#    <name>ORACLE_HOME</name>
#    <default>/oracle/Middleware/Oracle_Home</default>
#    <description>Oracle Home Path</description>
#    <info>The path to the Oracle home. Do not include trailing slash.</info>
#  </variable>
#  <variable>
#    <name>DOMAIN_HOME</name>
#    <default>/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain</default>
#    <description>Domain Home Path</description>
#    <info>The path to the domain home. Do not include trailing slash.</info>
#  </variable>
#  <variable>
#    <name>COMPONENT_NAME</name>
#    <default>ohs1</default>
#    <description>Component Name</description>
#    <info>The component name set during configuration. Default is ohs1.</info>
#  </variable>
#  <variable>
#    <name>ORALOGDIR</name>
#    <default>/path/to/oracle/logs</default>
#    <description>Oracle Log Directory</description>
#    <info>A separate partition from the OHS software for Oracle logs.</info>
#  </variable>
#  <variable>
#    <name>ORALOGROTATIONPARAMS</name>
#    <default>S 10:70</default>
#    <description>Oracle Log Rotation Parameters</description>
#    <info>Set to satfisy NIST 800-92 logging requirements</info>
#  </variable>
#  <variable>
#    <name>LOG_USER</name>
#    <default>oracle</default>
#    <description>Log file username</description>
#    <info>Username used for ownership of log files</info>
#  </variable>
#  <variable>
#    <name>LOG_GROUP</name>
#    <default>oracle</default>
#    <description>Log file group</description>
#    <info>Group name used for ownership of log files</info>
#  </variable>
#  <variable>
#    <name>CN_NODE_CERT</name>
#    <default>oraclelocal</default>
#    <description>CN of the Node Manager Cert</description>
#    <info>CN used for the ListenAddress property of Node Manager</info>
#  </variable>
#  <variable>
#    <name>KEYSTORE_LOCATION</name>
#    <default>/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/security</default>
#    <description>Keystore Location Path</description>
#    <info>The path to the keystore location for DoD certificates.</info>
#  </variable>
#  <variable>
#    <name>IDENTITY_ALIAS</name>
#    <default>appIdentity1</default>
#    <description>Custom Identity Alias</description>
#    <info>Alias of the keystore PrivateKeyEntry containing the Node Manager identity</info>
#  </variable>
#  <variable>
#    <name>LISTEN_PORT</name>
#    <default>5556</default>
#    <description>Listen port for Node Manager</description>
#    <info>Your servers listen port from config.xml and nodemanager.properties.</info>
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Unix">

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000001 - OHS must have the mpm property set to use the worker Multi-Processing Module (MPM) as the preferred means to limit the number of allowed simultaneous requests."
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ohs.plugins.nodemanager.properties with an editor.

2. Set the 'mpm' property to a value of 'worker', add the property if it does not exist."
  reference   : "800-53|AC-10,CAT|II,CCI|CCI-000054,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-77643r1_rule,STIG-ID|OH12-1X-000001,Vuln-ID|V-63153"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ohs.plugins.nodemanager.properties"
  regex       : "^[\\s]*mpm"
  expect      : "^[\\s]*mpm[\\s]*=[\\s]*worker"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000002 - OHS must have the mpm_prefork_module directive disabled so as not conflict with the worker directive used to limit the number of allowed simultaneous requests."
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the '<IfModule mpm_prefork_module>' directive at the OHS server configuration scope.

3. Comment out the '<IfModule mpm_prefork_module>' directive and any directives that it contains."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000054,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78615r1_rule,STIG-ID|OH12-1X-000002,SWIFT-CSCv1|2.3,Vuln-ID|V-64125"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_prefork_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_prefork_module>"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000003 - OHS must have the MaxClients directive defined to limit the number of allowed simultaneous requests."
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'MaxClients' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Within the '<IfModule mpm_worker_module>' directive, set the 'MaxClients' directive to '2000' or less, add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|AC-10,CAT|II,CCI|CCI-000054,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-78617r1_rule,STIG-ID|OH12-1X-000003,Vuln-ID|V-64127"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule mpm_worker_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf | egrep '^\\s*MaxClients\\s+'"
  expect      : "[\\s]*MaxClients[\\s]+([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|1[0-9]{3}|2000)[\\s]*$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000004 - OHS must limit the number of threads within a worker process to limit the number of allowed simultaneous requests - ThreadsPerChild"
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ThreadsPerChild' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Within the '<IfModule mpm_worker_module>' directive, set the 'ThreadsPerChild' directive to '25', add the directive if it does not exist.

4. Search for the 'ThreadLimit' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

5. Within the '<IfModule mpm_worker_module>' directive, set the 'ThreadLimit' directive to '64', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|AC-10,CAT|II,CCI|CCI-000054,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-78619r1_rule,STIG-ID|OH12-1X-000004,Vuln-ID|V-64129"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule mpm_worker_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf | egrep '^\\s*ThreadsPerChild\\s+'"
  expect      : "[\\s]*ThreadsPerChild[\\s]+([1-9]|1[0-9]|2[0-5])[\\s]*$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000004 - OHS must limit the number of threads within a worker process to limit the number of allowed simultaneous requests - ThreadLimit"
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ThreadsPerChild' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Within the '<IfModule mpm_worker_module>' directive, set the 'ThreadsPerChild' directive to '25', add the directive if it does not exist.

4. Search for the 'ThreadLimit' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

5. Within the '<IfModule mpm_worker_module>' directive, set the 'ThreadLimit' directive to '64', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|AC-10,CAT|II,CCI|CCI-000054,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-78619r1_rule,STIG-ID|OH12-1X-000004,Vuln-ID|V-64129"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule mpm_worker_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf | egrep '^\\s*ThreadLimit\\s+'"
  expect      : "[\\s]*ThreadLimit[\\s]+([1-9]|[1-5][0-9]|6[0-4])[\\s]*$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000005 - OHS must limit the number of worker processes to limit the number of allowed simultaneous requests."
  info        : "Web server management includes the ability to control the number of users and user sessions that utilize a web server. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to several types of Denial of Service attacks.

Although there is some latitude concerning the settings themselves, the settings should follow DoD-recommended values, but the settings should be configurable to allow for future DoD direction. While the DoD will specify recommended values, the values can be adjusted to accommodate the operational requirement of a given system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ServerLimit' directive within '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Within the '<IfModule mpm_worker_module>' directive, set the 'ServerLimit' directive to the maximum of '16' and the calculation of 'MaxClients'/'ThreadsPerChild' immediately before the 'MaxClients' directive, add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|AC-10,CAT|II,CCI|CCI-000054,ITSG-33|AC-10,NESA|T5.5.1,Rule-ID|SV-78621r1_rule,STIG-ID|OH12-1X-000005,Vuln-ID|V-64131"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule mpm_worker_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf | egrep '^\\s*ServerLimit\\s+'"
  expect      : "^[\\s]*ServerLimit[\\s]+([1-9]|1[1-6])[\\s]*$"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000007 - OHS must have the LoadModule ossl_module directive enabled to encrypt remote connections in accordance with the categorization of data hosted by the web server."
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78623r1_rule,STIG-ID|OH12-1X-000007,SWIFT-CSCv1|2.6,Vuln-ID|V-64133"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000008 - OHS must have the SSLFIPS directive enabled to encrypt remote connections in accordance with the categorization of data hosted by the web server."
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78625r1_rule,STIG-ID|OH12-1X-000008,SWIFT-CSCv1|2.6,Vuln-ID|V-64135"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule ossl_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf | egrep '^\\s*SSLFIPS\\s+'"
  expect      : "[\\s]*SSLFIPS[\\s]+[Oo][Nn][\\s]*$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000009 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt remote connections in accordance with the categorization of data hosted by the web server - SSLEngine"
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.

2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.

3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.

4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78627r2_rule,STIG-ID|OH12-1X-000009,SWIFT-CSCv1|2.1,Vuln-ID|V-64137"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000009 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt remote connections in accordance with the categorization of data hosted by the web server - SSLProtocol"
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.

2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.

3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.

4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78627r2_rule,STIG-ID|OH12-1X-000009,SWIFT-CSCv1|2.1,Vuln-ID|V-64137"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000009 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt remote connections in accordance with the categorization of data hosted by the web server - SSLWallet"
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.

2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.

3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.

4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78627r2_rule,STIG-ID|OH12-1X-000009,SWIFT-CSCv1|2.1,Vuln-ID|V-64137"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000010 - OHS must have the SSLCipherSuite directive enabled to encrypt remote connections in accordance with the categorization of data hosted by the web server."
  info        : "The web server has several remote communications channels. Examples are user requests via http/https, communication to a backend database, or communication to authenticate users. The encryption used to communicate must match the data that is being retrieved or presented.

Methods of communication are http for publicly displayed information, https to encrypt when user data is being transmitted, VPN tunneling, or other encryption methods to a database."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be added or removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-000068,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78629r2_rule,STIG-ID|OH12-1X-000010,SWIFT-CSCv1|2.1,Vuln-ID|V-64139"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000011 - OHS must have the LoadModule ossl_module directive enabled to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server."
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78631r1_rule,STIG-ID|OH12-1X-000011,SWIFT-CSCv1|2.6,Vuln-ID|V-64141"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000012 - OHS must have the SSLFIPS directive enabled to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server."
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78633r1_rule,STIG-ID|OH12-1X-000012,SWIFT-CSCv1|2.6,Vuln-ID|V-64143"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "sed -n '/<IfModule ossl_module>/,/<\\/IfModule>/p' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf | egrep '^\\s*SSLFIPS\\s+'"
  expect      : "[\\s]*SSLFIPS[\\s]+[Oo][Nn][\\s]*$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000013 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server - SSLEngine"
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78635r2_rule,STIG-ID|OH12-1X-000013,SWIFT-CSCv1|2.1,Vuln-ID|V-64145"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000013 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server - SSLProtocol"
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78635r2_rule,STIG-ID|OH12-1X-000013,SWIFT-CSCv1|2.1,Vuln-ID|V-64145"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000013 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server - SSLWallet"
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78635r2_rule,STIG-ID|OH12-1X-000013,SWIFT-CSCv1|2.1,Vuln-ID|V-64145"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000014 - OHS must have the SSLCipherSuite directive enabled to protect the integrity of remote sessions in accordance with the categorization of data hosted by the web server."
  info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78637r1_rule,STIG-ID|OH12-1X-000014,SWIFT-CSCv1|2.1,Vuln-ID|V-64147"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Check for IfModule weblogic_module"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "egrep -i '^\s*<IfModule weblogic_module' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print} END {if (NR >= 1) print \"found\"}'"
      expect      : "^found$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000015 - OHS must have the SecureProxy directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78639r1_rule,STIG-ID|OH12-1X-000015,SWIFT-CSCv1|2.6,Vuln-ID|V-64149"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SecureProxy - \"s; l=0; p=0; } l>0 && /^\\s*SecureProxy\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000016 - OHS must have the WLSSLWallet directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78641r1_rule,STIG-ID|OH12-1X-000016,SWIFT-CSCv1|2.6,Vuln-ID|V-64151"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLSSLWallet - \"s; l=0; p=0; } l>0 && /^\\s*WLSSLWallet\\s+.*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000017 - OHS must have the WebLogicSSLVersion directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WebLogicSSLVersion' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WebLogicSSLVersion' directive to 'TLSv1_2 TLSv1_1 TLSv1', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78643r1_rule,STIG-ID|OH12-1X-000017,SWIFT-CSCv1|2.6,Vuln-ID|V-64153"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WebLogicSSLVersion - \"s; l=0; p=0; } l>0 && /^\\s*WebLogicSSLVersion\\s+TLSv1_2\\s+TLSv1_1\\s+TLSv1\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000018 - OHS must have the WLProxySSL directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78645r1_rule,STIG-ID|OH12-1X-000018,SWIFT-CSCv1|2.6,Vuln-ID|V-64155"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLProxySSL - \"s; l=0; p=0; } l>0 && /^\\s*WLProxySSL\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "OH12-1X-000015 - OHS must have the SecureProxy directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78639r1_rule,STIG-ID|OH12-1X-000015,SWIFT-CSCv1|2.6,Vuln-ID|V-64149"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000016 - OHS must have the WLSSLWallet directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78641r1_rule,STIG-ID|OH12-1X-000016,SWIFT-CSCv1|2.6,Vuln-ID|V-64151"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000017 - OHS must have the WebLogicSSLVersion directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WebLogicSSLVersion' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WebLogicSSLVersion' directive to 'TLSv1_2 TLSv1_1 TLSv1', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78643r1_rule,STIG-ID|OH12-1X-000017,SWIFT-CSCv1|2.6,Vuln-ID|V-64153"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000018 - OHS must have the WLProxySSL directive enabled to protect the integrity of remote sessions when integrated with WebLogic in accordance with the categorization of data hosted by the web server."
      info        : "Data exchanged between the user and the web server can range from static display data to credentials used to log into the hosted application. Even when data appears to be static, the non-displayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-001453,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78645r1_rule,STIG-ID|OH12-1X-000018,SWIFT-CSCv1|2.6,Vuln-ID|V-64155"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000019 - OHS must have the LoadModule log_config_module directive enabled to generate information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule log_config_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule log_config_module' directive to ''${PRODUCT_HOME}/modules/mod_log_config.so'', add the directive if it does not exist."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000067,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12,Rule-ID|SV-78647r1_rule,STIG-ID|OH12-1X-000019,SWIFT-CSCv1|6.4,Vuln-ID|V-64157"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+log_config_module"
  expect      : "^[\\s]*LoadModule[\\s]+log_config_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_log_config\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000020 - OHS must have the OraLogMode set to Oracle Diagnostic Logging text mode to generate information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogMode' directive at the OHS server configuration scope.

3. Set the 'OraLogMode' directive to 'odl-text', add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78649r1_rule,STIG-ID|OH12-1X-000020,Vuln-ID|V-64159"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogMode[\\s]+"
  expect      : "^[\\s]*OraLogMode[\\s]+odl-text"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000021 - OHS must have a log directory location defined to generate information for use by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogDir' directive at the OHS server configuration scope.

3. Set the 'OraLogDir' directive to an appropriate, protected location on a partition with sufficient space that is different from the partition on which the OHS software is installed; add the directive if it does not exist."
  reference   : "800-53|AU-4(1),CAT|II,CCI|CCI-000067,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-78651r1_rule,STIG-ID|OH12-1X-000021,Vuln-ID|V-64161"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogDir[\\s]+"
# Note: Variable @ORALOGDIR@ replaced with "/path/to/oracle/logs" in field "expect".
  expect      : "^[\\s]*OraLogDir[\\s]+/path/to/oracle/logs"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000022 - OHS must have the OraLogSeverity directive defined to generate adequate information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogSeverity' directive at the OHS server configuration scope.

3. Set the 'OraLogSeverity' directive to 'NOTIFICATION:32', add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78653r1_rule,STIG-ID|OH12-1X-000022,Vuln-ID|V-64163"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogSeverity[\\s]+"
  expect      : "^[\\s]*OraLogSeverity[\\s]+NOTIFICATION:32"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000023 - OHS must have the log rotation parameter set to allow generated information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogRotationParams' directive at the OHS server configuration scope.

3. As required, set the 'OraLogRotationParams' directive to satisfy the NIST 800-92 logging requirements, add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78655r1_rule,STIG-ID|OH12-1X-000023,Vuln-ID|V-64165"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogRotationParams[\\s]+"
# Note: Variable @ORALOGROTATIONPARAMS@ replaced with "S 10:70" in field "expect".
  expect      : "^[\\s]*OraLogRotationParams[\\s]+S 10:70"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000024 - OHS must have a log format defined to generate adequate information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78657r1_rule,STIG-ID|OH12-1X-000024,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64167"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000025 - OHS must have a SSL log format defined to allow generated information to be used by external applications or entities to monitor and control remote access in accordance with the categorization of data hosted by the web server."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78659r1_rule,STIG-ID|OH12-1X-000025,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64169"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000026 - OHS must have a log file defined for each site/virtual host to capture information to be used by external applications or entities to monitor and control remote access."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

By providing remote access information to an external monitoring system, the organization can monitor for cyber attacks and monitor compliance with remote access policies. The organization can also look at data organization wide and determine an attack or anomaly is occurring on the organization which might not be noticed if the data were kept local to the web server.

Examples of external applications used to monitor or control access would be audit log monitoring systems, dynamic firewalls, or infrastructure monitoring systems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000067,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78661r1_rule,STIG-ID|OH12-1X-000026,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64171"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000030 - Remote access to OHS must follow access policy or work in conjunction with enterprise tools designed to enforce policy requirements."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

A web server can be accessed remotely and must be able to enforce remote access policy requirements or work in conjunction with enterprise tools designed to enforce policy requirements.

Examples of the web server enforcing a remote access policy are implementing IP filtering rules, using https instead of http for communication, implementing secure tokens, and validating users.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Review the directives (e.g., '<VirtualHost>', '<Directory>', and '<Location>') at the OHS server and virtual host configuration scopes.

3. Configure the web server to require secure authentication as required, use SSL, and/or restrict access from nonsecure zones via 'Order', 'Deny', and 'Allow' directives.

Note: A product such as Oracle Access Manager may facilitate satisfying these requirements."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-002314,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78983r1_rule,STIG-ID|OH12-1X-000030,Vuln-ID|V-64493"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(order|deny|allow)' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000031 - OHS must have the Order, Allow, and Deny directives set within the Directory directives set to restrict inbound connections from nonsecure zones."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

A web server can be accessed remotely and must be capable of restricting access from what the DoD defines as nonsecure zones. Nonsecure zones are defined as any IP, subnet, or region that is defined as a threat to the organization. The nonsecure zones must be defined for public web servers logically located in a DMZ, as well as private web servers with perimeter protection devices. By restricting access from nonsecure zones, through internal web server access list, the web server can stop or slow denial of service (DoS) attacks on the web server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Directory>' directive at the OHS server and virtual host configuration scopes.

Note: This fix does not apply to the root directory, i.e. the <Directory /> directive.

3. Set the 'Order' directive to 'allow,deny', add the directive if it does not exist.

4. Set 'Allow' directives to 'from all' or to an IP range (e.g., 'from 123.123'), add the directives if they do not exist.

5. Set 'Deny' directives to an IP range (e.g., 'from 123.123') to specify nonsecure zones, add the directives if they do not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-002314,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78985r1_rule,STIG-ID|OH12-1X-000031,Vuln-ID|V-64495"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(order|deny|allow)' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000032 - OHS must have the Order, Allow, and Deny directives set within the Files directives set to restrict inbound connections from nonsecure zones."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

A web server can be accessed remotely and must be capable of restricting access from what the DoD defines as nonsecure zones. Nonsecure zones are defined as any IP, subnet, or region that is defined as a threat to the organization. The nonsecure zones must be defined for public web servers logically located in a DMZ, as well as private web servers with perimeter protection devices. By restricting access from nonsecure zones, through internal web server access list, the web server can stop or slow denial of service (DoS) attacks on the web server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Files>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'Order' directive to 'allow,deny', add the directive if it does not exist.

4. Set 'Allow' directives to 'from all' or to an IP range (e.g., 'from 123.123'), add the directives if they do not exist.

5. Set 'Deny' directives to an IP range (e.g., 'from 123.123') to specify nonsecure zones, add the directives if they do not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-002314,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78987r1_rule,STIG-ID|OH12-1X-000032,Vuln-ID|V-64497"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(order|deny|allow)' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000033 - OHS must have the Order, Allow, and Deny directives set within the Location directives set to restrict inbound connections from nonsecure zones."
  info        : "Remote access to the web server is any access that communicates through an external, non-organization-controlled network. Remote access can be used to access hosted applications or to perform management functions.

A web server can be accessed remotely and must be capable of restricting access from what the DoD defines as nonsecure zones. Nonsecure zones are defined as any IP, subnet, or region that is defined as a threat to the organization. The nonsecure zones must be defined for public web servers logically located in a DMZ, as well as private web servers with perimeter protection devices. By restricting access from nonsecure zones, through internal web server access list, the web server can stop or slow denial of service (DoS) attacks on the web server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Location>' directive at the OHS server and virtual host configuration scopes.

3. Set the 'Order' directive to 'allow,deny', add the directive if it does not exist.

4. Set 'Allow' directives to 'from all' or to an IP range (e.g., 'from 123.123'), add the directives if they do not exist.

5. Set 'Deny' directives to an IP range (e.g., 'from 123.123') to specify nonsecure zones, add the directives if they do not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-002314,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78989r1_rule,STIG-ID|OH12-1X-000033,Vuln-ID|V-64499"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(order|deny|allow)' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000034 - OHS must provide the capability to immediately disconnect or disable remote access to the hosted applications."
  info        : "During an attack on the web server or any of the hosted applications, the system administrator may need to disconnect or disable access by users to stop the attack.

The web server must provide a capability to disconnect users to a hosted application without compromising other hosted applications unless deemed necessary to stop the attack. Methods to disconnect or disable connections are to stop the application service for a specified hosted application, stop the web server, or block all connections through web server access list.

The web server capabilities used to disconnect or disable users from connecting to hosted applications and the web server must be documented to make certain that, during an attack, the proper action is taken to conserve connectivity to any other hosted application if possible and to make certain log data is conserved for later forensic analysis.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Directory>', '<Files>', or '<Location>' directive serving the application/content under attack at the OHS server, virtual host, or directory configuration scope.

3. Set the 'Order' directive to 'allow,deny', add the directive if it does not exist.

4. Comment out any 'Allow' directives to prohibit access to the application/content under attack if it exists.

5. Set 'Deny' directives to 'from all' to prohibit access to the application/content under attack, add the directive if it does not exist.

6. Issue a 'nmSoftRestart(serverName='componentName',serverType='OHS') from the WLST shell prompt."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-002322,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78991r1_rule,STIG-ID|OH12-1X-000034,Vuln-ID|V-64501"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(order|deny|allow)' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000035 - Non-privileged accounts on the hosting system must only access OHS security-relevant information and functions through a distinct administrative account."
  info        : "By separating web server security functions from non-privileged users, roles can be developed that can then be used to administer the web server. Forcing users to change from a non-privileged account to a privileged account when operating on the web server or on security-relevant information forces users to only operate as a web server administrator when necessary. Operating in this manner allows for better logging of changes and better forensic information and limits accidental changes to the web server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Configure sudo such that only the account that owns the OHS software can access it from the hosting system."
  reference   : "800-171|3.1.7,800-53|AC-6(10),CAT|II,CCI|CCI-002235,CSF|PR.AC-4,Rule-ID|SV-78993r1_rule,STIG-ID|OH12-1X-000035,Vuln-ID|V-64503"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
  cmd         : "for groups in $(cat /etc/group | cut -d: -f1); do egrep -s \"^[\\s]*\(%\)?[\\s]*$groups\" /etc/sudoers /etc/sudoers.d/*; done"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000040 - OHS must have the client requests logging module loaded to generate log records for system startup and shutdown, system access, and system authentication logging."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule log_config_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule log_config_module' directive to ''${PRODUCT_HOME}/modules/mod_log_config.so'', add the directive if it does not exist."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000169,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12,Rule-ID|SV-78663r1_rule,STIG-ID|OH12-1X-000040,SWIFT-CSCv1|6.4,Vuln-ID|V-64173"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+log_config_module"
  expect      : "^[\\s]*LoadModule[\\s]+log_config_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_log_config\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000041 - OHS must have OraLogMode set to Oracle Diagnostic Logging text mode to generate log records for system startup and shutdown, system access, and system authentication logging."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogMode' directive at the OHS server configuration scope.

3. Set the 'OraLogMode' directive to 'odl-text', add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78665r1_rule,STIG-ID|OH12-1X-000041,Vuln-ID|V-64175"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogMode[\\s]+"
  expect      : "^[\\s]*OraLogMode[\\s]+odl-text"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000042 - OHS must have a log directory location defined to generate log records for system startup and shutdown, system access, and system authentication logging."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogDir' directive at the OHS server configuration scope.

3. Set the 'OraLogDir' directive to an appropriate, protected location on a partition with sufficient space that is different from the partition on which the OHS software is installed; add the directive if it does not exist."
  reference   : "800-53|AU-4(1),CAT|II,CCI|CCI-000169,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-78667r1_rule,STIG-ID|OH12-1X-000042,Vuln-ID|V-64177"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogDir[\\s]+"
# Note: Variable @ORALOGDIR@ replaced with "/path/to/oracle/logs" in field "expect".
  expect      : "^[\\s]*OraLogDir[\\s]+/path/to/oracle/logs"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000043 - OHS must have a log level severity defined to generate adequate log records for system startup and shutdown, system access, and system authentication events."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogSeverity' directive at the OHS server configuration scope.

3. Set the 'OraLogSeverity' directive to 'NOTIFICATION:32', add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78669r1_rule,STIG-ID|OH12-1X-000043,Vuln-ID|V-64179"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogSeverity[\\s]+"
  expect      : "^[\\s]*OraLogSeverity[\\s]+NOTIFICATION:32"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000044 - OHS must have the log rotation parameter set to allow for the generation log records for system startup and shutdown, system access, and system authentication events."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogRotationParams' directive at the OHS server configuration scope.

3. As required, set the 'OraLogRotationParams' directive to satisfy the NIST 800-92 logging requirements, add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78671r1_rule,STIG-ID|OH12-1X-000044,Vuln-ID|V-64181"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogRotationParams[\\s]+"
# Note: Variable @ORALOGROTATIONPARAMS@ replaced with "S 10:70" in field "expect".
  expect      : "^[\\s]*OraLogRotationParams[\\s]+S 10:70"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000045 - OHS must have a log format defined to generate adequate logs by system startup and shutdown, system access, and system authentication events."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78673r1_rule,STIG-ID|OH12-1X-000045,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64183"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000046 - OHS must have a SSL log format defined to generate adequate logs by system startup and shutdown, system access, and system authentication events."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78675r1_rule,STIG-ID|OH12-1X-000046,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64185"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000047 - OHS must have a log file defined for each site/virtual host to capture logs generated by system startup and shutdown, system access, and system authentication events."
  info        : "Log records can be generated from various components within the web server (e.g., httpd, plug-ins to external backends, etc.). From a web server perspective, certain specific web server functionalities may be logged as well. The web server must allow the definition of what events are to be logged. As conditions change, the number and types of events to be logged may change, and the web server must be able to facilitate these changes.

The minimum list of logged events should be those pertaining to system startup and shutdown, system access, and system authentication events. If these events are not logged at a minimum, any type of forensic investigation would be missing pertinent information needed to replay what occurred."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000169,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78677r1_rule,STIG-ID|OH12-1X-000047,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64187"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000049 - OHS must capture, record, and log all content related to a user session."
  info        : "A user session to a web server is in the context of a user accessing a hosted application that extends to any plug-ins/modules and services that may execute on behalf of the user.

The web server must be capable of enabling a setting for troubleshooting, debugging, or forensic gathering purposes which will log all user session information related to the hosted application session. Without the capability to capture, record, and log all content related to a user session, investigations into suspicious user activity would be hampered.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with nicknames of 'dod' and 'dod_ssl' at the OHS server and virtual host configuration scopes.

3a. If the session id is contained within a cookie, modify the 'LogFormat' directive with nicknames of 'dod' and 'dod_ssl' to include 'sess:%{JSESSIONID}C', add the directive if it does not exist unless inherited from a larger scope.
3b. If the session id is contained within a header variable, modify the 'LogFormat' directives with nicknames of 'dod' and 'dod_ssl' to include 'sess:%{X-JSESSIONID}o' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001462,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-78679r1_rule,STIG-ID|OH12-1X-000049,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64189"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*LogFormat.*dod(_ssl)?' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000050 - OHS must have a log level severity defined to produce sufficient log records to establish what type of events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct type of event that occurred is important during forensic analysis. The correct determination of the event and when it occurred is important in relation to other events that happened at that same time.

Without sufficient information establishing what type of log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogSeverity' directive at the OHS server configuration scope.

3. Set the 'OraLogSeverity' directive to 'NOTIFICATION:32', add the directive if it does not exist."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000130,CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(1),NESA|T5.4.4,Rule-ID|SV-78681r1_rule,STIG-ID|OH12-1X-000050,Vuln-ID|V-64191"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogSeverity[\\s]+"
  expect      : "^[\\s]*OraLogSeverity[\\s]+NOTIFICATION:32"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000051 - OHS must have a log format defined for log records generated to capture sufficient information to establish what type of events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct type of event that occurred is important during forensic analysis. The correct determination of the event and when it occurred is important in relation to other events that happened at that same time.

Without sufficient information establishing what type of log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78683r1_rule,STIG-ID|OH12-1X-000051,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64193"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000052 - OHS must have a SSL log format defined for log records generated to capture sufficient information to establish what type of events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct type of event that occurred is important during forensic analysis. The correct determination of the event and when it occurred is important in relation to other events that happened at that same time.

Without sufficient information establishing what type of log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78685r1_rule,STIG-ID|OH12-1X-000052,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64195"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000053 - OHS must have a log file defined for each site/virtual host to capture sufficient information to establish what type of events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct type of event that occurred is important during forensic analysis. The correct determination of the event and when it occurred is important in relation to other events that happened at that same time.

Without sufficient information establishing what type of log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000130,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78687r1_rule,STIG-ID|OH12-1X-000053,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64197"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000054 - OHS must have a log format defined for log records generated to capture sufficient information to establish when an event occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct order of the events that occurred is important during forensic analysis. Events that appear harmless by themselves might be flagged as a potential threat when properly viewed in sequence. By also establishing the event date and time, an event can be properly viewed with an enterprise tool to fully see a possible threat in its entirety.

Without sufficient information establishing when the log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000131,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78689r1_rule,STIG-ID|OH12-1X-000054,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64199"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000055 - OHS must have a SSL log format defined for log records generated to capture sufficient information to establish when an event occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct order of the events that occurred is important during forensic analysis. Events that appear harmless by themselves might be flagged as a potential threat when properly viewed in sequence. By also establishing the event date and time, an event can be properly viewed with an enterprise tool to fully see a possible threat in its entirety.

Without sufficient information establishing when the log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000131,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78691r1_rule,STIG-ID|OH12-1X-000055,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64201"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000056 - OHS must have a log file defined for each site/virtual host to capture logs generated that allow the establishment of when an event occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct order of the events that occurred is important during forensic analysis. Events that appear harmless by themselves might be flagged as a potential threat when properly viewed in sequence. By also establishing the event date and time, an event can be properly viewed with an enterprise tool to fully see a possible threat in its entirety.

Without sufficient information establishing when the log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000131,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78693r1_rule,STIG-ID|OH12-1X-000056,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64203"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000057 - OHS must have a log format defined for log records that allow the establishment of where within OHS the events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct location or process within the web server where the events occurred is important during forensic analysis. Correctly determining the web service, plug-in, or module will add information to the overall reconstruction of the logged event. For example, an event that occurred during communication to a cgi module might be handled differently than an event that occurred during a communication session to a user.

Without sufficient information establishing where the log event occurred within the web server, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000132,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78695r1_rule,STIG-ID|OH12-1X-000057,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64205"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000058 - OHS must have a SSL log format defined for log records that allow the establishment of where within OHS the events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct location or process within the web server where the events occurred is important during forensic analysis. Correctly determining the web service, plug-in, or module will add information to the overall reconstruction of the logged event. For example, an event that occurred during communication to a cgi module might be handled differently than an event that occurred during a communication session to a user.

Without sufficient information establishing where the log event occurred within the web server, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000132,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78697r1_rule,STIG-ID|OH12-1X-000058,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64207"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000059 - OHS must have a log file defined for each site/virtual host to capture logs generated that allow the establishment of where within OHS the events occurred."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct location or process within the web server where the events occurred is important during forensic analysis. Correctly determining the web service, plug-in, or module will add information to the overall reconstruction of the logged event. For example, an event that occurred during communication to a cgi module might be handled differently than an event that occurred during a communication session to a user.

Without sufficient information establishing where the log event occurred within the web server, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000132,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78699r1_rule,STIG-ID|OH12-1X-000059,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64209"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000060 - OHS must have a log format defined for log records that allow the establishment of the source of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if the event compromised other assets within the enterprise.

Without sufficient information establishing the source of the logged event, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78701r1_rule,STIG-ID|OH12-1X-000060,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64211"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000061 - OHS must have a SSL log format defined for log records that allow the establishment of the source of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if the event compromised other assets within the enterprise.

Without sufficient information establishing the source of the logged event, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78703r1_rule,STIG-ID|OH12-1X-000061,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64213"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000062 - OHS must have a log file defined for each site/virtual host to capture logs generated that allow the establishment of the source of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if the event compromised other assets within the enterprise.

Without sufficient information establishing the source of the logged event, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78705r1_rule,STIG-ID|OH12-1X-000062,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64215"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000063 - OHS, behind a load balancer or proxy server, must produce log records containing the client IP information as the source and destination and not the load balancer or proxy IP information with each event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source of events will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the source occurred in other areas within the enterprise.

A web server behind a load balancer or proxy server, when not configured correctly, will record the load balancer or proxy server as the source of every logable event. When looking at the information forensically, this information is not helpful in the investigation of events. The web server must record with each event the client source of the event."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78707r1_rule,STIG-ID|OH12-1X-000063,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64217"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000064 - OHS, behind a load balancer or proxy server, must have the SSL log format set correctly to produce log records containing the client IP information as the source and destination and not the load balancer or proxy IP information with each event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source of events will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the source occurred in other areas within the enterprise.

A web server behind a load balancer or proxy server, when not configured correctly, will record the load balancer or proxy server as the source of every logable event. When looking at the information forensically, this information is not helpful in the investigation of events. The web server must record with each event the client source of the event."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78709r1_rule,STIG-ID|OH12-1X-000064,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64219"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000065 - OHS, behind a load balancer or proxy server, must have a log file defined for each site/virtual host to produce log records containing the client IP information as the source and destination and not the load balancer or proxy IP information with each event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct source, e.g., source IP, of the events is important during forensic analysis. Correctly determining the source of events will add information to the overall reconstruction of the logable event. By determining the source of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the source occurred in other areas within the enterprise.

A web server behind a load balancer or proxy server, when not configured correctly, will record the load balancer or proxy server as the source of every logable event. When looking at the information forensically, this information is not helpful in the investigation of events. The web server must record with each event the client source of the event."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000133,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78711r1_rule,STIG-ID|OH12-1X-000065,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64221"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000066 - OHS must have a log format defined to produce log records that contain sufficient information to establish the outcome (success or failure) of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the success or failure of an event is important during forensic analysis. Correctly determining the outcome will add information to the overall reconstruction of the logable event. By determining the success or failure of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the event occurred in other areas within the enterprise.

Without sufficient information establishing the success or failure of the logged event, investigation into the cause of event is severely hindered. The success or failure also provides a means to measure the impact of an event and help authorized personnel to determine the appropriate response. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000134,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78713r1_rule,STIG-ID|OH12-1X-000066,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64223"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000067 - OHS must have a SSL log format defined to produce log records that contain sufficient information to establish the outcome (success or failure) of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the success or failure of an event is important during forensic analysis. Correctly determining the outcome will add information to the overall reconstruction of the logable event. By determining the success or failure of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the event occurred in other areas within the enterprise.

Without sufficient information establishing the success or failure of the logged event, investigation into the cause of event is severely hindered. The success or failure also provides a means to measure the impact of an event and help authorized personnel to determine the appropriate response. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-000134,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78715r1_rule,STIG-ID|OH12-1X-000067,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64225"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000068 - OHS must have a log file defined for each site/virtual host to produce log records that contain sufficient information to establish the outcome (success or failure) of events."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the success or failure of an event is important during forensic analysis. Correctly determining the outcome will add information to the overall reconstruction of the logable event. By determining the success or failure of the event correctly, analysis of the enterprise can be undertaken to determine if events tied to the event occurred in other areas within the enterprise.

Without sufficient information establishing the success or failure of the logged event, investigation into the cause of event is severely hindered. The success or failure also provides a means to measure the impact of an event and help authorized personnel to determine the appropriate response. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-000134,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-78717r1_rule,STIG-ID|OH12-1X-000068,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64227"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*CustomLog.*dod(_ssl)?' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000069 - OHS must have a log format defined to produce log records containing sufficient information to establish the identity of any user/subject or process associated with an event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Determining user accounts, processes running on behalf of the user, and running process identifiers also enable a better understanding of the overall event. User tool identification is also helpful to determine if events are related to overall user access or specific client tools.

Log record content that may be necessary to satisfy the requirement of this control includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i' dod', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-001487,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78719r1_rule,STIG-ID|OH12-1X-000069,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64229"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i\" dod$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000070 - OHS must have a SSL log format defined to produce log records containing sufficient information to establish the identity of any user/subject or process associated with an event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Determining user accounts, processes running on behalf of the user, and running process identifiers also enable a better understanding of the overall event. User tool identification is also helpful to determine if events are related to overall user access or specific client tools.

Log record content that may be necessary to satisfy the requirement of this control includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'LogFormat' directive with a nickname of 'dod_ssl' at the OHS server and virtual host configuration scopes.

3. Set the 'LogFormat' directive to ''%h %l %u %t \'%r\' %>s %b \'%{Referer}i\' \'%{User-Agent}i\' ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-001487,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78721r1_rule,STIG-ID|OH12-1X-000070,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64231"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -R '^\\s*LogFormat.*dod_ssl$' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "LogFormat \"%h %l %u %t \\\\\"%r\\\\\" %>s %b \\\\\"%{Referer}i\\\\\" \\\\\"%{User-Agent}i\\\\\" ecid:%E xfor:%{X-Forwarded-For}i sslprot:%{SSL_PROTOCOL}x ciph:%{SSL_CIPHER}x\" dod_ssl$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000071 - OHS must have a log file defined for each site/virtual host to produce log records containing sufficient information to establish the identity of any user/subject or process associated with an event."
  info        : "Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Determining user accounts, processes running on behalf of the user, and running process identifiers also enable a better understanding of the overall event. User tool identification is also helpful to determine if events are related to overall user access or specific client tools.

Log record content that may be necessary to satisfy the requirement of this control includes: time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, file names involved, and access control or flow control rules invoked."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.1.12,800-53|AC-17(1),CAT|II,CCI|CCI-001487,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|PR.AC-3,CSF|PR.PT-4,ISO/IEC-27001|A.12.4.1,ITSG-33|AC-17(1),NESA|T5.4.4,NIAv2|SM8,Rule-ID|SV-78723r1_rule,STIG-ID|OH12-1X-000071,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64233"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": CustomLog - \"s; l=0; p=0 } l>0 && /^\\s*CustomLog \"\\|\\|\\${PRODUCT_HOME}\\/bin\\/odl_rotatelogs.*43200\" dod(_ssl)?/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000074 - OHS log files must only be accessible by privileged users - permissions"
  info        : "Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, user names, etc.

The web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server. The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78725r1_rule,STIG-ID|OH12-1X-000074,Vuln-ID|V-64235"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -perm /137 | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000074 - OHS log files must only be accessible by privileged users - user/group"
  info        : "Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, user names, etc.

The web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server. The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000162,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78725r1_rule,STIG-ID|OH12-1X-000074,Vuln-ID|V-64235"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @LOG_GROUP@ replaced with "oracle" in field "cmd".
# Note: Variable @LOG_USER@ replaced with "oracle" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -not -group oracle -not -user oracle | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000075 - The log information from OHS must be protected from unauthorized modification - permissions"
  info        : "Log data is essential in the investigation of events. The accuracy of the information is always pertinent. Information that is not accurate does not help in the revealing of potential security risks and may hinder the early discovery of a system compromise. One of the first steps an attacker will undertake is the modification or deletion of log records to cover his tracks and prolong discovery.

The web server must protect the log data from unauthorized modification. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from modification by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server.  The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78727r1_rule,STIG-ID|OH12-1X-000075,Vuln-ID|V-64237"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -perm /137 | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000075 - The log information from OHS must be protected from unauthorized modification - user/group"
  info        : "Log data is essential in the investigation of events. The accuracy of the information is always pertinent. Information that is not accurate does not help in the revealing of potential security risks and may hinder the early discovery of a system compromise. One of the first steps an attacker will undertake is the modification or deletion of log records to cover his tracks and prolong discovery.

The web server must protect the log data from unauthorized modification. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from modification by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server.  The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000163,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78727r1_rule,STIG-ID|OH12-1X-000075,Vuln-ID|V-64237"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @LOG_GROUP@ replaced with "oracle" in field "cmd".
# Note: Variable @LOG_USER@ replaced with "oracle" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -not -group oracle -not -user oracle | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000076 - The log information from OHS must be protected from unauthorized deletion - permissions"
  info        : "Log data is essential in the investigation of events. The accuracy of the information is always pertinent. Information that is not accurate does not help in the revealing of potential security risks and may hinder the early discovery of a system compromise. One of the first steps an attacker will undertake is the modification or deletion of audit records to cover his tracks and prolong discovery.

The web server must protect the log data from unauthorized deletion. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from deletion by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server.  The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78729r1_rule,STIG-ID|OH12-1X-000076,Vuln-ID|V-64239"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -perm /137 | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000076 - The log information from OHS must be protected from unauthorized deletion - user/group"
  info        : "Log data is essential in the investigation of events. The accuracy of the information is always pertinent. Information that is not accurate does not help in the revealing of potential security risks and may hinder the early discovery of a system compromise. One of the first steps an attacker will undertake is the modification or deletion of audit records to cover his tracks and prolong discovery.

The web server must protect the log data from unauthorized deletion. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from deletion by non-privileged users."
  solution    : "1. Change to the ORACLE_HOME/user_projects/domains/base_domain/servers directory.

2. Execute the command: find . -name *.log

3. Set the owner and group to the user and group used to run the web server.  The user and group are typically set to Oracle.

4. Set the permissions on all the log files returned to '640'."
  reference   : "800-171|3.3.8,800-53|AU-9,CAT|II,CCI|CCI-000164,CN-L3|7.1.2.3(d),CN-L3|7.1.3.3(f),CN-L3|8.1.3.5(c),CN-L3|8.1.4.3(c),CSF|PR.PT-1,ISO/IEC-27001|A.12.4.2,ITSG-33|AU-9,NESA|M5.2.3,NESA|M5.5.2,NESA|T3.6.4,NESA|T8.2.9,NIAv2|SM5,NIAv2|SM6,Rule-ID|SV-78729r1_rule,STIG-ID|OH12-1X-000076,Vuln-ID|V-64239"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @LOG_GROUP@ replaced with "oracle" in field "cmd".
# Note: Variable @LOG_USER@ replaced with "oracle" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers -name *.log -not -group oracle -not -user oracle | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "none"
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000077 - The log data and records from OHS must be backed up onto a different system or media."
  info        : "Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up log records to an unrelated system or onto separate media than the system the web server is actually running on helps to assure that, in the event of a catastrophic system failure, the log records will be retained.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Have the System Administrator back up the files located in the $DOMAIN_HOME/servers/<componentName>/logs directory."
  reference   : "CAT|II,CCI|CCI-001348,Rule-ID|SV-78731r1_rule,STIG-ID|OH12-1X-000077,Vuln-ID|V-64241"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000081 - OHS must be configured to store error log files to an appropriate storage device from which other tools can be configured to reference those log files for diagnostic/forensic purposes."
  info        : "A web server will typically utilize logging mechanisms for maintaining a historical log of activity that occurs within a hosted application. This information can then be used for diagnostic purposes, forensics purposes, or other purposes relevant to ensuring the availability and integrity of the hosted application.

While it is important to log events identified as being critical and relevant to security, it is equally important to notify the appropriate personnel in a timely manner so they are able to respond to events as they occur.

Manual review of the web server logs may not occur in a timely manner, and each event logged is open to interpretation by a reviewer. By integrating the web server into an overall or organization-wide log review, a larger picture of events can be viewed, and analysis can be done in a timely and reliable manner."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'OraLogDir' directive at the OHS server configuration scope.

3. Set the 'OraLogDir' directive to an appropriate, protected location on a partition with sufficient space that is different from the partition on which the OHS software is installed; add the directive if it does not exist."
  reference   : "800-53|AU-4(1),CAT|II,CCI|CCI-001851,CSF|PR.DS-4,CSF|PR.PT-1,Rule-ID|SV-78995r1_rule,STIG-ID|OH12-1X-000081,Vuln-ID|V-64505"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*OraLogDir[\\s]+"
# Note: Variable @ORALOGDIR@ replaced with "/path/to/oracle/logs" in field "expect".
  expect      : "^[\\s]*OraLogDir[\\s]+/path/to/oracle/logs"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000082 - OHS must be configured to store access log files to an appropriate storage device from which other tools can be configured to reference those log files for diagnostic/forensic purposes."
  info        : "A web server will typically utilize logging mechanisms for maintaining a historical log of activity that occurs within a hosted application. This information can then be used for diagnostic purposes, forensics purposes, or other purposes relevant to ensuring the availability and integrity of the hosted application.

While it is important to log events identified as being critical and relevant to security, it is equally important to notify the appropriate personnel in a timely manner so they are able to respond to events as they occur.

Manual review of the web server logs may not occur in a timely manner, and each event logged is open to interpretation by a reviewer. By integrating the web server into an overall or organization-wide log review, a larger picture of events can be viewed, and analysis can be done in a timely and reliable manner.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'CustomLog' directive at the OHS server and virtual host configuration scopes.

3a. If the virtual host is NOT configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod', add the directive if it does not exist unless inherited from a larger scope and reference a location where other tools can access the log files for diagnostic/forensic purposes.
3b. If the virtual host is configured for SSL, set the 'CustomLog' directive to ''||${PRODUCT_HOME}/bin/odl_rotatelogs <DESIRED_DIRECTORY_AND_FILE_NAME> 43200' dod_ssl', add the directive if it does not exist unless inherited from a larger scope and reference a location where other tools can access the log files for diagnostic/forensic purposes."
  reference   : "800-171|3.3.1,800-171|3.3.2,800-53|AU-12,CAT|II,CCI|CCI-001851,CN-L3|7.1.3.3(a),CN-L3|7.1.3.3(b),CN-L3|7.1.3.3(c),CN-L3|8.1.3.5(a),CN-L3|8.1.3.5(b),CN-L3|8.1.4.3(a),CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.1,ITSG-33|AU-12,NESA|T3.6.2,NESA|T3.6.5,NESA|T3.6.6,NIAv2|SM8,Rule-ID|SV-78997r1_rule,STIG-ID|OH12-1X-000082,SWIFT-CSCv1|6.4,TBA-FIISB|45.1.1,Vuln-ID|V-64507"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*CustomLog.*dod(_ssl)?' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000093 - OHS must have the LoadModule file_cache_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule file_cache_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule file_cache_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78733r1_rule,STIG-ID|OH12-1X-000093,SWIFT-CSCv1|2.3,Vuln-ID|V-64243"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*file_cache_module"
  expect      : "^[\\s]*LoadModule[\\s]*file_cache_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000094 - OHS must have the LoadModule vhost_alias_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule vhost_alias_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule vhost_alias_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78735r1_rule,STIG-ID|OH12-1X-000094,SWIFT-CSCv1|2.3,Vuln-ID|V-64245"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*vhost_alias_module"
  expect      : "^[\\s]*LoadModule[\\s]*vhost_alias_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000095 - OHS must have the LoadModule env_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule env_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule env_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78737r1_rule,STIG-ID|OH12-1X-000095,SWIFT-CSCv1|2.3,Vuln-ID|V-64247"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*env_module"
  expect      : "^[\\s]*LoadModule[\\s]*env_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000096 - OHS must have the LoadModule mime_magic_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule mime_magic_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule mime_magic_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78739r1_rule,STIG-ID|OH12-1X-000096,SWIFT-CSCv1|2.3,Vuln-ID|V-64249"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*mime_magic_module"
  expect      : "^[\\s]*LoadModule[\\s]*mime_magic_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000097 - OHS must have the LoadModule negotiation_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule negotiation_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule negotiation_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78741r1_rule,STIG-ID|OH12-1X-000097,SWIFT-CSCv1|2.3,Vuln-ID|V-64251"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*negotiation_module"
  expect      : "^[\\s]*LoadModule[\\s]*negotiation_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000098 - OHS must not have the LanguagePriority directive enabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'LanguagePriority' directive.

2. Search for the 'LanguagePriority' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'LanguagePriority' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78743r1_rule,STIG-ID|OH12-1X-000098,SWIFT-CSCv1|2.3,Vuln-ID|V-64253"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*LanguagePriority"
  expect      : "^[\\s]*LanguagePriority"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000099 - OHS must not have the ForceLanguagePriority directive enabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'ForceLanguagePriority' directive.

2. Search for the 'ForceLanguagePriority' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'ForceLanguagePriority' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78745r1_rule,STIG-ID|OH12-1X-000099,SWIFT-CSCv1|2.3,Vuln-ID|V-64255"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*ForceLanguagePriority"
  expect      : "^[\\s]*ForceLanguagePriority"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000100 - OHS must have the LoadModule status_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule status_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule status_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78747r1_rule,STIG-ID|OH12-1X-000100,SWIFT-CSCv1|2.3,Vuln-ID|V-64257"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*status_module"
  expect      : "^[\\s]*LoadModule[\\s]*status_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000101 - OHS must have the LoadModule info_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule info_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule info_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78749r1_rule,STIG-ID|OH12-1X-000101,SWIFT-CSCv1|2.3,Vuln-ID|V-64259"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*info_module"
  expect      : "^[\\s]*LoadModule[\\s]*info_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000102 - OHS must have the LoadModule include_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule include_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule include_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78751r1_rule,STIG-ID|OH12-1X-000102,SWIFT-CSCv1|2.3,Vuln-ID|V-64261"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*include_module"
  expect      : "^[\\s]*LoadModule[\\s]*include_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000103 - OHS must have the LoadModule autoindex_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule autoindex_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule autoindex_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78753r1_rule,STIG-ID|OH12-1X-000103,SWIFT-CSCv1|2.3,Vuln-ID|V-64263"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*autoindex_module"
  expect      : "^[\\s]*LoadModule[\\s]*autoindex_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000104 - OHS must have the IndexOptions directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains an 'IndexOptions' directive.

2. Search for the 'IndexOptions' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'IndexOptions' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78755r1_rule,STIG-ID|OH12-1X-000104,SWIFT-CSCv1|2.3,Vuln-ID|V-64265"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*IndexOptions[\\s]+"
  expect      : "^[\\s]*IndexOptions[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000105 - OHS must have the AddIconByEncoding directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains an 'AddIconByEncoding' directive.

2. Search for an 'AddIconByEncoding' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'AddIconByEncoding' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78757r1_rule,STIG-ID|OH12-1X-000105,SWIFT-CSCv1|2.3,Vuln-ID|V-64267"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*AddIconByEncoding[\\s]+"
  expect      : "^[\\s]*AddIconByEncoding[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000106 - OHS must have the AddIconByType directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains an 'AddIconByType' directive.

2. Search for an 'AddIconByType' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'AddIconByType' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78759r1_rule,STIG-ID|OH12-1X-000106,SWIFT-CSCv1|2.3,Vuln-ID|V-64269"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*AddIconByType[\\s]+"
  expect      : "^[\\s]*AddIconByType[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000107 - OHS must have the AddIcon directive disabled - OHS must have the AddIcon directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains an 'AddIcon' directive.

2. Search for an 'AddIcon' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'AddIcon' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78761r1_rule,STIG-ID|OH12-1X-000107,SWIFT-CSCv1|2.3,Vuln-ID|V-64271"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*AddIcon[\\s]+"
  expect      : "^[\\s]*AddIcon[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000108 - OHS must have the DefaultIcon directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'DefaultIcon' directive.

2. Search for a 'DefaultIcon' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'DefaultIcon' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78763r1_rule,STIG-ID|OH12-1X-000108,SWIFT-CSCv1|2.3,Vuln-ID|V-64273"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*DefaultIcon[\\s]+"
  expect      : "^[\\s]*DefaultIcon[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000109 - OHS must have the ReadmeName directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'ReadmeName' directive.

2. Search for a 'ReadmeName' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'ReadmeName' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78765r1_rule,STIG-ID|OH12-1X-000109,SWIFT-CSCv1|2.3,Vuln-ID|V-64275"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*ReadmeName[\\s]+"
  expect      : "^[\\s]*ReadmeName[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000110 - OHS must have the HeaderName directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'HeaderName' directive.

2. Search for a 'HeaderName' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'HeaderName' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78767r1_rule,STIG-ID|OH12-1X-000110,SWIFT-CSCv1|2.3,Vuln-ID|V-64277"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*HeaderName[\\s]+"
  expect      : "^[\\s]*HeaderName[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000111 - OHS must have the IndexIgnore directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains an 'IndexIgnore' directive.

2. Search for an 'IndexIgnore' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'IndexIgnore' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78769r1_rule,STIG-ID|OH12-1X-000111,SWIFT-CSCv1|2.3,Vuln-ID|V-64279"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*IndexIgnore[\\s]+"
  expect      : "^[\\s]*IndexIgnore[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000112 - OHS must have the LoadModule dir_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule dir_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule dir_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78771r1_rule,STIG-ID|OH12-1X-000112,SWIFT-CSCv1|2.3,Vuln-ID|V-64281"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*dir_module"
  expect      : "^[\\s]*LoadModule[\\s]*dir_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000113 - OHS must have the DirectoryIndex directive disabled - DirectoryIndex"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'DirectoryIndex' directive.

2. Search for the 'DirectoryIndex' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'DirectoryIndex' directive and any surrounding '<IfModule dir_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78773r1_rule,STIG-ID|OH12-1X-000113,SWIFT-CSCv1|2.3,Vuln-ID|V-64283"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*DirectoryIndex[\\s]+"
  expect      : "^[\\s]*DirectoryIndex[\\s]+"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000113 - OHS must have the DirectoryIndex directive disabled - IfModule dir_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'DirectoryIndex' directive.

2. Search for the 'DirectoryIndex' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'DirectoryIndex' directive and any surrounding '<IfModule dir_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78773r1_rule,STIG-ID|OH12-1X-000113,SWIFT-CSCv1|2.3,Vuln-ID|V-64283"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*<IfModule[\\s]*dir_module>"
  expect      : "^[\\s]*<IfModule[\\s]*dir_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000114 - OHS must have the LoadModule cgi_module directive disabled - autoindex_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_prefork_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_prefork_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78775r1_rule,STIG-ID|OH12-1X-000114,SWIFT-CSCv1|2.3,Vuln-ID|V-64285"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*autoindex_module"
  expect      : "^[\\s]*LoadModule[\\s]*autoindex_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000114 - OHS must have the LoadModule cgi_module directive disabled - mpm_prefork_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_prefork_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_prefork_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78775r1_rule,STIG-ID|OH12-1X-000114,SWIFT-CSCv1|2.3,Vuln-ID|V-64285"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_prefork_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_prefork_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000115 - OHS must have the LoadModule fastcgi_module disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule fastcgi_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule fastcgi_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78777r1_rule,STIG-ID|OH12-1X-000115,SWIFT-CSCv1|2.3,Vuln-ID|V-64287"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*fastcgi_module"
  expect      : "^[\\s]*LoadModule[\\s]*fastcgi_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000116 - OHS must have the LoadModule cgid_module directive disabled for mpm workers - cgid_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgid_module' directive within the '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgid_module' directive and surrounding '<IfModule mpm_worker_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78779r1_rule,STIG-ID|OH12-1X-000116,SWIFT-CSCv1|2.3,Vuln-ID|V-64289"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cgid_module"
  expect      : "^[\\s]*LoadModule[\\s]*cgid_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000116 - OHS must have the LoadModule cgid_module directive disabled for mpm workers - mpm_worker_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgid_module' directive within the '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgid_module' directive and surrounding '<IfModule mpm_worker_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78779r1_rule,STIG-ID|OH12-1X-000116,SWIFT-CSCv1|2.3,Vuln-ID|V-64289"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_worker_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_worker_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000117 - OHS must have the IfModule cgid_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<IfModule cgid_module>' directive.

2. Search for the '<IfModule cgid_module>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the '<IfModule cgid_module>' directive and any directives it may contain."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78781r1_rule,STIG-ID|OH12-1X-000117,SWIFT-CSCv1|2.3,Vuln-ID|V-64291"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*cgid_module>"
  expect      : "^[\\s]*<IfModule[\\s]*cgid_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000118 - OHS must have the LoadModule mpm_winnt_module directive disabled - cgi_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_winnt_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_winnt_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78783r1_rule,STIG-ID|OH12-1X-000118,SWIFT-CSCv1|2.3,Vuln-ID|V-64293"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cgid_module"
  expect      : "^[\\s]*LoadModule[\\s]*cgid_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000118 - OHS must have the LoadModule mpm_winnt_module directive disabled - mpm_winnt_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_winnt_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_winnt_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78783r1_rule,STIG-ID|OH12-1X-000118,SWIFT-CSCv1|2.3,Vuln-ID|V-64293"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000119 - OHS must have the ScriptAlias directive for CGI scripts disabled - ScriptAlias /cgi-bin/"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptAlias /cgi-bin/' directive within a '<IfModule alias_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptAlias /cgi-bin/' directive and its surrounding '<IfModule alias_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78785r1_rule,STIG-ID|OH12-1X-000119,SWIFT-CSCv1|2.3,Vuln-ID|V-64295"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*ScriptAlias[\\s]*/cgi-bin/"
  expect      : "^[\\s]*ScriptAlias[\\s]*/cgi-bin/"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000119 - OHS must have the ScriptAlias directive for CGI scripts disabled - alias_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptAlias /cgi-bin/' directive within a '<IfModule alias_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptAlias /cgi-bin/' directive and its surrounding '<IfModule alias_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78785r1_rule,STIG-ID|OH12-1X-000119,SWIFT-CSCv1|2.3,Vuln-ID|V-64295"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*alias_module>"
  expect      : "^[\\s]*<IfModule[\\s]*alias_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000120 - OHS must have the ScriptSock directive disabled - ScriptSock"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptSock' directive within a '<IfModule cgid_module>' directive at the OHS server configuration scope.  Note: 'ScriptSock' may appear as 'Scriptsock' within the httpd.conf file.

3. Comment out the 'ScriptSock' directive and its surrounding '<IfModule cgid_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78787r1_rule,STIG-ID|OH12-1X-000120,SWIFT-CSCv1|2.3,Vuln-ID|V-64297"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*ScriptSock"
  expect      : "^[\\s]*ScriptSock"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000120 - OHS must have the ScriptSock directive disabled - cgid_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptSock' directive within a '<IfModule cgid_module>' directive at the OHS server configuration scope.  Note: 'ScriptSock' may appear as 'Scriptsock' within the httpd.conf file.

3. Comment out the 'ScriptSock' directive and its surrounding '<IfModule cgid_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78787r1_rule,STIG-ID|OH12-1X-000120,SWIFT-CSCv1|2.3,Vuln-ID|V-64297"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*cgid_module>"
  expect      : "^[\\s]*<IfModule[\\s]*cgid_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000121 - OHS must have the cgi-bin directory disabled - httpd.conf"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/cgi-bin'>' directive at the OHS server and virtual host configuration scopes.

3. Comment out the '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/cgi-bin'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78789r2_rule,STIG-ID|OH12-1X-000121,SWIFT-CSCv1|2.3,Vuln-ID|V-64299"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000121 - OHS must have the cgi-bin directory disabled - ssl.conf"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/cgi-bin'>' directive at the OHS server and virtual host configuration scopes.

3. Comment out the '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/cgi-bin'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78789r2_rule,STIG-ID|OH12-1X-000121,SWIFT-CSCv1|2.3,Vuln-ID|V-64299"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000122 - OHS must have directives pertaining to certain scripting languages removed from virtual hosts."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<FilesMatch '\.(cgi|shtml|phtml|php)$'>' directive at the OHS server configuration scope.

3. Comment out the '<FilesMatch '\.(cgi|shtml|phtml|php)$'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78791r1_rule,STIG-ID|OH12-1X-000122,SWIFT-CSCv1|2.3,Vuln-ID|V-64301"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*<FilesMatch[\\s]*\"\\\.\\(cgi\|shtml\|phtml\|php\\)\\$\">"
  expect      : "^[\\s]*<FilesMatch[\\s]*\"\\\.\\(cgi\|shtml\|phtml\|php\\)\\$\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000123 - OHS must have the LoadModule asis_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule asis_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule asis_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78793r1_rule,STIG-ID|OH12-1X-000123,SWIFT-CSCv1|2.3,Vuln-ID|V-64303"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*asis_module"
  expect      : "^[\\s]*LoadModule[\\s]*asis_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000124 - OHS must have the LoadModule imagemap_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule imagemap_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule imagemap_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78795r1_rule,STIG-ID|OH12-1X-000124,SWIFT-CSCv1|2.3,Vuln-ID|V-64305"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*imagemap_module"
  expect      : "^[\\s]*LoadModule[\\s]*imagemap_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000125 - OHS must have the LoadModule actions_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule actions_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule actions_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78797r1_rule,STIG-ID|OH12-1X-000125,SWIFT-CSCv1|2.3,Vuln-ID|V-64307"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*actions_module"
  expect      : "^[\\s]*LoadModule[\\s]*actions_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000126 - OHS must have the LoadModule speling_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule speling_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule speling_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78799r1_rule,STIG-ID|OH12-1X-000126,SWIFT-CSCv1|2.3,Vuln-ID|V-64309"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*speling_module"
  expect      : "^[\\s]*LoadModule[\\s]*speling_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000127 - OHS must have the LoadModule userdir_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule userdir_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule userdir_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78801r1_rule,STIG-ID|OH12-1X-000127,SWIFT-CSCv1|2.3,Vuln-ID|V-64311"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*userdir_module"
  expect      : "^[\\s]*LoadModule[\\s]*userdir_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000128 - OHS must have the AliasMatch directive pertaining to the OHS manuals disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for an 'AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|pt-br|ru|tr))?(/.*)?$ '${PRODUCT_HOME}/manual$1'' directive at the OHS server configuration scope.

3. Comment out the 'AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|pt-br|ru|tr))?(/.*)?$ '${PRODUCT_HOME}/manual$1'' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78803r1_rule,STIG-ID|OH12-1X-000128,SWIFT-CSCv1|2.3,Vuln-ID|V-64313"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*AliasMatch[\\s]*\\^/manual\\(\\?:/\\(\\?:da\\|de\\|en\\|es\\|fr\\|ja\\|ko\\|pt-br\\|ru\\|tr\\|zh-cn\\)\\)\\?\\(/\\.\\*\\)\\?\\$ \"\\${PRODUCT_HOME}/manual\\$1\""
  expect      : "^[\\s]*AliasMatch[\\s]*\\^/manual\\(\\?:/\\(\\?:da\\|de\\|en\\|es\\|fr\\|ja\\|ko\\|pt-br\\|ru\\|tr\\|zh-cn\\)\\)\\?\\(/\\.\\*\\)\\?\\$ \"\\${PRODUCT_HOME}/manual\\$1\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000129 - OHS must have the Directory directive pointing to the OHS manuals disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a '<Directory '${PRODUCT_HOME}/manual'>' directive at the OHS server configuration scope.

3. Comment out the '<Directory '${PRODUCT_HOME}/manual'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78805r1_rule,STIG-ID|OH12-1X-000129,SWIFT-CSCv1|2.3,Vuln-ID|V-64315"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/manual\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/manual\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000130 - OHS must have the LoadModule auth_basic_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule auth_basic_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule auth_basic_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78807r1_rule,STIG-ID|OH12-1X-000130,SWIFT-CSCv1|2.3,Vuln-ID|V-64317"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*auth_basic_module"
  expect      : "^[\\s]*LoadModule[\\s]*auth_basic_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000131 - OHS must have the LoadModule authz_user_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule authz_user_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule authz_user_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78809r1_rule,STIG-ID|OH12-1X-000131,SWIFT-CSCv1|2.3,Vuln-ID|V-64319"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*authz_user_module"
  expect      : "^[\\s]*LoadModule[\\s]*authz_user_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000132 - OHS must have the LoadModule authn_file_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule authn_file_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule authn_file_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78811r1_rule,STIG-ID|OH12-1X-000132,SWIFT-CSCv1|2.3,Vuln-ID|V-64321"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*authn_file_module"
  expect      : "^[\\s]*LoadModule[\\s]*authn_file_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000133 - OHS must have the LoadModule authn_anon_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule authn_anon_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule authn_anon_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78813r1_rule,STIG-ID|OH12-1X-000133,SWIFT-CSCv1|2.3,Vuln-ID|V-64323"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*authn_anon_module"
  expect      : "^[\\s]*LoadModule[\\s]*authn_anon_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000134 - OHS must have the LoadModule proxy_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78815r1_rule,STIG-ID|OH12-1X-000134,SWIFT-CSCv1|2.3,Vuln-ID|V-64325"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000135 - OHS must have the LoadModule proxy_http_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_http_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_http_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78817r1_rule,STIG-ID|OH12-1X-000135,SWIFT-CSCv1|2.3,Vuln-ID|V-64327"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_http_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_http_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000136 - OHS must have the LoadModule proxy_ftp_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_ftp_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_ftp_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78819r1_rule,STIG-ID|OH12-1X-000136,SWIFT-CSCv1|2.3,Vuln-ID|V-64329"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_ftp_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_ftp_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000137 - OHS must have the LoadModule proxy_connect_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_connect_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_connnect_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78821r1_rule,STIG-ID|OH12-1X-000137,SWIFT-CSCv1|2.3,Vuln-ID|V-64331"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_connect_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_connect_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000138 - OHS must have the LoadModule proxy_balancer_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_balancer_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_balancer_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78823r1_rule,STIG-ID|OH12-1X-000138,SWIFT-CSCv1|2.3,Vuln-ID|V-64333"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_balancer_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_balancer_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000139 - OHS must have the LoadModule cern_meta_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cern_meta_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cern_meta_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78825r1_rule,STIG-ID|OH12-1X-000139,SWIFT-CSCv1|2.3,Vuln-ID|V-64335"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cern_meta_module"
  expect      : "^[\\s]*LoadModule[\\s]*cern_meta_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000140 - OHS must have the LoadModule expires_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule expires_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule expires_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78827r1_rule,STIG-ID|OH12-1X-000140,SWIFT-CSCv1|2.3,Vuln-ID|V-64337"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*expires_module"
  expect      : "^[\\s]*LoadModule[\\s]*expires_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000141 - OHS must have the LoadModule usertrack_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule usertrack_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule usertrack_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78829r1_rule,STIG-ID|OH12-1X-000141,SWIFT-CSCv1|2.3,Vuln-ID|V-64339"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*usertrack_module"
  expect      : "^[\\s]*LoadModule[\\s]*usertrack_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000142 - OHS must have the LoadModule uniqueid_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.
2. Search for the 'LoadModule unique_id_module' directive at the OHS server configuration scope.
3. Comment out the 'LoadModule unique_id_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78831r2_rule,STIG-ID|OH12-1X-000142,SWIFT-CSCv1|2.3,Vuln-ID|V-64341"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*unique_id_module"
  expect      : "^[\\s]*LoadModule[\\s]*unique_id_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000143 - OHS must have the LoadModule setenvif_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule setenvif_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule setenvif_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78833r1_rule,STIG-ID|OH12-1X-000143,SWIFT-CSCv1|2.3,Vuln-ID|V-64343"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*setenvif_module"
  expect      : "^[\\s]*LoadModule[\\s]*setenvif_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000144 - OHS must have the BrowserMatch directive disabled - BrowserMatch"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'BrowserMatch' directive.

2. Search for the 'BrowserMatch' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'BrowserMatch' directive and any surrounding '<IfModule dir_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78835r1_rule,STIG-ID|OH12-1X-000144,SWIFT-CSCv1|2.3,Vuln-ID|V-64345"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*BrowserMatch"
  expect      : "^[\\s]*BrowserMatch"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000144 - OHS must have the BrowserMatch directive disabled - dir_module"
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a 'BrowserMatch' directive.

2. Search for the 'BrowserMatch' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the 'BrowserMatch' directive and any surrounding '<IfModule dir_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78835r1_rule,STIG-ID|OH12-1X-000144,SWIFT-CSCv1|2.3,Vuln-ID|V-64345"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*dir_module>"
  expect      : "^[\\s]*<IfModule[\\s]*dir_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000145 - OHS must have the LoadModule dumpio_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule dumpio_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule dumpio_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78837r1_rule,STIG-ID|OH12-1X-000145,SWIFT-CSCv1|2.3,Vuln-ID|V-64347"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*dumpio_module"
  expect      : "^[\\s]*LoadModule[\\s]*dumpio_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000146 - OHS must have the IfModule dumpio_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a '<IfModule dumpio_module>' directive at the OHS server configuration scope.

3. Comment out the '<IfModule dumpio_module>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78839r1_rule,STIG-ID|OH12-1X-000146,SWIFT-CSCv1|2.3,Vuln-ID|V-64349"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*dumpio_module>"
  expect      : "^[\\s]*<IfModule[\\s]*dumpio_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000147 - OHS must have the Alias /icons/ directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for an 'Alias /icons/' directive at the OHS server configuration scope.

3. Comment out the 'Alias /icons/' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78841r1_rule,STIG-ID|OH12-1X-000147,SWIFT-CSCv1|2.3,Vuln-ID|V-64351"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*Alias[\\s]*/icons/"
  expect      : "^[\\s]*Alias[\\s]*/icons/"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000148 - OHS must have the path to the icons directory disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a '<Directory '${PRODUCT_HOME}/icons'>' directive at the OHS server configuration scope.

3. Comment out the '<Directory '$PRODUCT_HOME}/icons'>' directive and any directives that it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78843r1_rule,STIG-ID|OH12-1X-000148,SWIFT-CSCv1|2.3,Vuln-ID|V-64353"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/icons\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/icons\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000149 - OHS must have the IfModule mpm_winnt_module directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the '<IfModule mpm_winnt_module>' directive at the OHS server configuration scope.

3. Comment out the '<IfModule mpm_winnt_module>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78845r1_rule,STIG-ID|OH12-1X-000149,SWIFT-CSCv1|2.3,Vuln-ID|V-64355"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000150 - OHS must have the LoadModule proxy_module directive disabled."
  info        : "A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended.  Scanning for web servers that will also proxy requests into an otherwise protected network is a very common attack making the attack anonymous."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78851r1_rule,STIG-ID|OH12-1X-000150,SWIFT-CSCv1|2.3,Vuln-ID|V-64361"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000151 - OHS must have the LoadModule proxy_http_module directive disabled."
  info        : "A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended.  Scanning for web servers that will also proxy requests into an otherwise protected network is a very common attack making the attack anonymous."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_http_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_http_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78853r1_rule,STIG-ID|OH12-1X-000151,SWIFT-CSCv1|2.3,Vuln-ID|V-64363"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_http_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_http_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000152 - OHS must have the LoadModule proxy_ftp_module directive disabled."
  info        : "A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended.  Scanning for web servers that will also proxy requests into an otherwise protected network is a very common attack making the attack anonymous."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_ftp_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_ftp_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78855r1_rule,STIG-ID|OH12-1X-000152,SWIFT-CSCv1|2.3,Vuln-ID|V-64365"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_ftp_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_ftp_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000153 - OHS must have the LoadModule proxy_connect_module directive disabled."
  info        : "A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended.  Scanning for web servers that will also proxy requests into an otherwise protected network is a very common attack making the attack anonymous."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_connect_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_connnect_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78865r1_rule,STIG-ID|OH12-1X-000153,SWIFT-CSCv1|2.3,Vuln-ID|V-64375"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_connnect_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_connnect_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000154 - OHS must have the LoadModule proxy_balancer_module directive disabled."
  info        : "A web server should be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended.  Scanning for web servers that will also proxy requests into an otherwise protected network is a very common attack making the attack anonymous."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule proxy_balancer_module' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule proxy_balancer_module' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78867r1_rule,STIG-ID|OH12-1X-000154,SWIFT-CSCv1|2.3,Vuln-ID|V-64377"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*proxy_balancer_module"
  expect      : "^[\\s]*LoadModule[\\s]*proxy_balancer_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000156 - OHS must disable the directive pointing to the directory containing the OHS manuals."
  info        : "Web server documentation, sample code, example applications, and tutorials may be an exploitable threat to a web server because this type of code has not been evaluated and approved. A production web server must only contain components that are operationally necessary (e.g., compiled code, scripts, web-content, etc.).

Any documentation, sample code, example applications, and tutorials must be removed from a production web server. To make certain that the documentation and code are not installed or uninstalled completely; the web server must offer an option as part of the installation process to exclude these packages or to uninstall the packages if necessary."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a '<Directory '${PRODUCT_HOME}/manual'>' directive at the OHS server configuration scope.

3. Comment out the '<Directory '${PRODUCT_HOME}/manual'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78869r1_rule,STIG-ID|OH12-1X-000156,SWIFT-CSCv1|2.3,Vuln-ID|V-64379"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/manual\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${PRODUCT_HOME}/manual\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000157 - OHS must have the AliasMatch directive disabled for the OHS manuals."
  info        : "Web server documentation, sample code, example applications, and tutorials may be an exploitable threat to a web server because this type of code has not been evaluated and approved. A production web server must only contain components that are operationally necessary (e.g., compiled code, scripts, web-content, etc.).

Any documentation, sample code, example applications, and tutorials must be removed from a production web server. To make certain that the documentation and code are not installed or uninstalled completely; the web server must offer an option as part of the installation process to exclude these packages or to uninstall the packages if necessary."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for an 'AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|pt-br|ru|tr))?(/.*)?$ '${PRODUCT_HOME}/manual$1'' directive at the OHS server configuration scope.

3. Comment out the 'AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|pt-br|ru|tr))?(/.*)?$ '${PRODUCT_HOME}/manual$1'' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78871r1_rule,STIG-ID|OH12-1X-000157,SWIFT-CSCv1|2.3,Vuln-ID|V-64381"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*AliasMatch[\\s]*\\^/manual\\(\\?:/\\(\\?:de\\|en\\|es\\|fr\\|ja\\|ko\\|pt-br\\|ru\\|tr\\)\\)\\?\\(/\\.\\*\\)\\?\\$ \"\\${PRODUCT_HOME}/manual\\$1\""
  expect      : "^[\\s]*AliasMatch[\\s]*\\^/manual\\(\\?:/\\(\\?:de\\|en\\|es\\|fr\\|ja\\|ko\\|pt-br\\|ru\\|tr\\)\\)\\?\\(/\\.\\*\\)\\?\\$ \"\\${PRODUCT_HOME}/manual\\$1\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000160 - OHS must have the AddHandler directive disabled."
  info        : "Controlling what a user of a hosted application can access is part of the security posture of the web server. Any time a user can access more functionality than is needed for the operation of the hosted application poses a security issue. A user with too much access can view information that is not needed for the user's job role, or the user could use the function in an unintentional manner.

A MIME tells the web server what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type.

A shell is a program that serves as the basic interface between the user and the operating system, so hosted application users must not have access to these programs. Shell programs may execute shell escapes and can then perform unauthorized activities that could damage the security posture of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'AddHandler' directives at the OHS server, virtual host, and directory configuration scopes.

3. If an 'AddHandler' directive exists, remove it."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78873r1_rule,STIG-ID|OH12-1X-000160,SWIFT-CSCv1|2.3,Vuln-ID|V-64383"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*AddHandler"
  expect      : "^[\\s]*AddHandler"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000161 - OHS must have the LoadModule cgi_module directive disabled."
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_prefork_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_prefork_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78875r1_rule,STIG-ID|OH12-1X-000161,SWIFT-CSCv1|2.3,Vuln-ID|V-64385"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cgi_module"
  expect      : "^[\\s]*LoadModule[\\s]*cgi_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000162 - OHS must have the LoadModule cgid_module directive disabled - proxy_balancer_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgid_module' directive within the '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgid_module' directive and surrounding '<IfModule mpm_worker_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78877r1_rule,STIG-ID|OH12-1X-000162,SWIFT-CSCv1|2.3,Vuln-ID|V-64387"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cgid_module"
  expect      : "^[\\s]*LoadModule[\\s]*cgid_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000162 - OHS must have the LoadModule cgid_module directive disabled - mpm_worker_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgid_module' directive within the '<IfModule mpm_worker_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgid_module' directive and surrounding '<IfModule mpm_worker_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78877r1_rule,STIG-ID|OH12-1X-000162,SWIFT-CSCv1|2.3,Vuln-ID|V-64387"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_worker_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_worker_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000163 - OHS must have the IfModule cgid_module directive disabled for the OHS server, virtual host, and directory configuration."
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<IfModule cgid_module>' directive.

2. Search for the '<IfModule cgid_module>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Comment out the '<IfModule cgid_module>' directive and any directives it may contain."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78879r1_rule,STIG-ID|OH12-1X-000163,SWIFT-CSCv1|2.3,Vuln-ID|V-64389"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*<IfModule[\\s]*cgid_module>"
  expect      : "^[\\s]*<IfModule[\\s]*cgid_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000164 - OHS must have the LoadModule cgi_module directive disabled within the IfModule mpm_winnt_module directive - cgi_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_winnt_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_winnt_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78881r1_rule,STIG-ID|OH12-1X-000164,SWIFT-CSCv1|2.3,Vuln-ID|V-64391"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]*cgi_module"
  expect      : "^[\\s]*LoadModule[\\s]*cgi_module"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000164 - OHS must have the LoadModule cgi_module directive disabled within the IfModule mpm_winnt_module directive - mpm_winnt_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule cgi_module' directive within the '<IfModule mpm_winnt_module>' directive at the OHS server configuration scope.

3. Comment out the 'LoadModule cgi_module' directive and surrounding '<IfModule mpm_winnt_module>' directives if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|III,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78881r1_rule,STIG-ID|OH12-1X-000164,SWIFT-CSCv1|2.3,Vuln-ID|V-64391"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
  expect      : "^[\\s]*<IfModule[\\s]*mpm_winnt_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000165 - OHS must have the ScriptAlias /cgi-bin/ directive within a IfModule alias_module directive disabled - ScriptAlias /cgi-bin/"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptAlias /cgi-bin/' directive within a '<IfModule alias_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptAlias /cgi-bin/' directive and its surrounding '<IfModule alias_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78883r1_rule,STIG-ID|OH12-1X-000165,SWIFT-CSCv1|2.3,Vuln-ID|V-64393"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*ScriptAlias[\\s]*/cgi-bin/"
  expect      : "^[\\s]*ScriptAlias[\\s]*/cgi-bin/"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000165 - OHS must have the ScriptAlias /cgi-bin/ directive within a IfModule alias_module directive disabled - alias_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptAlias /cgi-bin/' directive within a '<IfModule alias_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptAlias /cgi-bin/' directive and its surrounding '<IfModule alias_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78883r1_rule,STIG-ID|OH12-1X-000165,SWIFT-CSCv1|2.3,Vuln-ID|V-64393"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*alias_module>"
  expect      : "^[\\s]*<IfModule[\\s]*alias_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000166 - OHS must have the ScriptSock directive within a IfModule cgid_module directive disabled - ScriptSock"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptSock' directive within a '<IfModule cgid_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptSock' directive and its surrounding '<IfModule cgid_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78885r1_rule,STIG-ID|OH12-1X-000166,SWIFT-CSCv1|2.3,Vuln-ID|V-64395"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*ScriptSock"
  expect      : "^[\\s]*ScriptSock"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000166 - OHS must have the ScriptSock directive within a IfModule cgid_module directive disabled - cgid_module"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for a 'ScriptSock' directive within a '<IfModule cgid_module>' directive at the OHS server configuration scope.

3. Comment out the 'ScriptSock' directive and its surrounding '<IfModule cgid_module>' directive if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78885r1_rule,STIG-ID|OH12-1X-000166,SWIFT-CSCv1|2.3,Vuln-ID|V-64395"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<IfModule[\\s]*cgid_module>"
  expect      : "^[\\s]*<IfModule[\\s]*cgid_module>"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000167 - OHS must have the cgi-bin directory disabled - httpd.conf"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/$COMPONENT_NAME}/cgi-bin'>' directive at the OHS server and virtual host configuration scopes.

3. Comment out the '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/$COMPONENT_NAME}/cgi-bin'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78887r1_rule,STIG-ID|OH12-1X-000167,SWIFT-CSCv1|2.3,Vuln-ID|V-64397"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000167 - OHS must have the cgi-bin directory disabled - ssl.conf"
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/$COMPONENT_NAME}/cgi-bin'>' directive at the OHS server and virtual host configuration scopes.

3. Comment out the '<Directory '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/$COMPONENT_NAME}/cgi-bin'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78887r1_rule,STIG-ID|OH12-1X-000167,SWIFT-CSCv1|2.3,Vuln-ID|V-64397"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
  expect      : "^[\\s]*<Directory[\\s]*\"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/cgi-bin\">"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000168 - OHS must have directives pertaining to certain scripting languages removed from virtual hosts."
  info        : "Scripts allow server side processing on behalf of the hosted application user or as processes needed in the implementation of hosted applications. Removing scripts not needed for application operation or deemed vulnerable helps to secure the web server.

To assure scripts are not added to the web server and run maliciously, those script mappings that are not needed or used by the web server for hosted application operation must be removed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a '<FilesMatch '\.(cgi|shtml|phtml|php)$'>' directive at the OHS server configuration scope.

3. Comment out the '<FilesMatch '\.(cgi|shtml|phtml|php)$'>' directive and any directives it contains if they exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78889r1_rule,STIG-ID|OH12-1X-000168,SWIFT-CSCv1|2.3,Vuln-ID|V-64399"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*<FilesMatch[\\s]*\"\\\.\\(cgi\|shtml\|phtml\|php\\)\\$\">"
  expect      : "^[\\s]*<FilesMatch[\\s]*\"\\\.\\(cgi\|shtml\|phtml\|php\\)\\$\">"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000169 - OHS must have resource mappings set to disable the serving of certain file types - Order allow,deny"
  info        : "Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and to identify which file types are not to be delivered to a client.

By not specifying which files can and which files cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.

The web server must only allow hosted application file types to be served to a user and all other types must be disabled."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for '<FilesMatch>' directives beyond the '<FilesMatch'^\.ht'>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the '<FilesMatch>' directive to ''^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'' or other value appropriate for the server/site to prevent inappropriate file access, add the directive if it does not exist.

4a. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Order' directive to 'allow,deny', add the directive if it does not exist.
4b. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist.
4c. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Satisfy' directive to 'All', add the directive if it does not exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78891r1_rule,STIG-ID|OH12-1X-000169,SWIFT-CSCv1|2.3,Vuln-ID|V-64401"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<FilesMatch \"\\^\\(\\?\\!/ { d = 1; t = $0; } d == 1 && /^\\s*[Oo]rder/ { f = $0; } d == 1 && /<\\/FilesMatch>/ { if (f ~ /^\\s*[Oo]rder\\s*[Aa]llow,\\s*[Dd]eny/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000169 - OHS must have resource mappings set to disable the serving of certain file types - Deny from all"
  info        : "Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and to identify which file types are not to be delivered to a client.

By not specifying which files can and which files cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.

The web server must only allow hosted application file types to be served to a user and all other types must be disabled."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for '<FilesMatch>' directives beyond the '<FilesMatch'^\.ht'>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the '<FilesMatch>' directive to ''^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'' or other value appropriate for the server/site to prevent inappropriate file access, add the directive if it does not exist.

4a. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Order' directive to 'allow,deny', add the directive if it does not exist.
4b. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist.
4c. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Satisfy' directive to 'All', add the directive if it does not exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78891r1_rule,STIG-ID|OH12-1X-000169,SWIFT-CSCv1|2.3,Vuln-ID|V-64401"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<FilesMatch \"\\^\\(\\?\\!/ { d = 1; t = $0; } d == 1 && /^\\s*[Dd]eny/ { f = $0; } d == 1 && /<\\/FilesMatch>/ { if (f ~ /^\\s*[Dd]eny\\s+[Ff]rom\\s+[Aa]ll/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000169 - OHS must have resource mappings set to disable the serving of certain file types - Satisfy all"
  info        : "Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and to identify which file types are not to be delivered to a client.

By not specifying which files can and which files cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.

The web server must only allow hosted application file types to be served to a user and all other types must be disabled."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for '<FilesMatch>' directives beyond the '<FilesMatch'^\.ht'>' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the '<FilesMatch>' directive to ''^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'' or other value appropriate for the server/site to prevent inappropriate file access, add the directive if it does not exist.

4a. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Order' directive to 'allow,deny', add the directive if it does not exist.
4b. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist.
4c. Within the '<FilesMatch '^(?!.*\.(gif|jpe?g|png|html?|js|css)).*$'>' directive, set the 'Satisfy' directive to 'All', add the directive if it does not exist."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78891r1_rule,STIG-ID|OH12-1X-000169,SWIFT-CSCv1|2.3,Vuln-ID|V-64401"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<FilesMatch \"\\^\\(\\?\\!/ { d = 1; t = $0; } d == 1 && /^\\s*[Ss]atisfy/ { f = $0; } d == 1 && /<\\/FilesMatch>/ { if (f ~ /^\\s*[Ss]atisfy\\s+[Aa]ll/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000172 - Users and scripts running on behalf of users must be contained to the document root or home directory tree of OHS."
  info        : "A web server is designed to deliver content and execute scripts or applications on the request of a client or user.  Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees that the user is not accessing information protected outside the application's realm.

The web server must also prohibit users from jumping outside the hosted application directory tree through access to the user's home directory, symbolic links or shortcuts, or through search paths for missing files."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Directory>' directive at OHS server and virtual host configuration scopes.

3. Set the 'Options' directive within the '<Directory>' directive to 'None', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000381,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-78893r1_rule,STIG-ID|OH12-1X-000172,SWIFT-CSCv1|2.3,Vuln-ID|V-64403"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory/ { d = 1; t = $0; } d == 1 && /^\\s*[Oo]ptions/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Oo]ptions\\s*[Nn]one/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000173 - OHS must be configured to use a specified IP address, port, and protocol - httpd.conf"
  info        : "The web server must be configured to listen on a specified IP address and port.  Without specifying an IP address and port for the web server to utilize, the web server will listen on all IP addresses available to the hosting server.  If the web server has multiple IP addresses, i.e., a management IP address, the web server will also accept connections on the management IP address.

Accessing the hosted application through an IP address normally used for non-application functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a 'Listen' directive at the OHS server configuration scope.

3. Set the 'Listen' directive to a value containing an IP address, port, and protocol (e.g., 'Listen 123.123.123.123:80 http' or 'Listen 456.456.456.456:443 https')."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-78895r1_rule,STIG-ID|OH12-1X-000173,SWIFT-CSCv1|2.3,Vuln-ID|V-64405"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*Listen"
  expect      : "^[\\s]*Listen[\\s]+((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}[\\s]+[0-9]+[\\s]+http(s)?"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000173 - OHS must be configured to use a specified IP address, port, and protocol - ssl.conf"
  info        : "The web server must be configured to listen on a specified IP address and port.  Without specifying an IP address and port for the web server to utilize, the web server will listen on all IP addresses available to the hosting server.  If the web server has multiple IP addresses, i.e., a management IP address, the web server will also accept connections on the management IP address.

Accessing the hosted application through an IP address normally used for non-application functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for a 'Listen' directive at the OHS server configuration scope.

3. Set the 'Listen' directive to a value containing an IP address, port, and protocol (e.g., 'Listen 123.123.123.123:80 http' or 'Listen 456.456.456.456:443 https')."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000382,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,Rule-ID|SV-78895r1_rule,STIG-ID|OH12-1X-000173,SWIFT-CSCv1|2.3,Vuln-ID|V-64405"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*Listen"
  expect      : "^[\\s]*Listen[\\s]+((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}[\\s]+[0-9]+[\\s]+http(s)?"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000176 - The Node Manager account password associated with the installation of OHS must be in accordance with DoD guidance for length, complexity, etc."
  info        : "During installation of the web server software, accounts are created for the web server to operate properly. The accounts installed can have either no password installed or a default password, which will be known and documented by the vendor and the user community.

The first things an attacker will try when presented with a login screen are the default user identifiers with default passwords. Installed applications may also install accounts with no password, making the login even easier. Once the web server is installed, the passwords for any created accounts should be changed and documented. The new passwords must meet the requirements for all passwords, i.e., upper/lower characters, numbers, special characters, time until change, reuse policy, etc.

Service accounts or system accounts that have no login capability do not need to have passwords set or changed."
  solution    : "1. Open $DOMAIN_HOME/config/nodemanager/nm_password.properties with an editor.

2. Remove the 'hashed' property and value.

3. Set the 'username' property to the account name to use for Node Manager, add the property if it does not exist.

4. Set the 'password' property to a password compliant with DoD requirements for password complexity to use for Node Manager, add the property if it does not exist.

5. Start/Restart Node Manager so that the password contained within $DOMAIN_HOME/config/nodemanager/nm_password.properties is encrypted.

6. Remove the 'username' and 'password' properties and along with their values from within $DOMAIN_HOME/config/nodemanager/nm_password.properties, but leave the new 'hashed' property and value."
  reference   : "800-171|3.5.2,800-53|IA-5,CAT|II,CCI|CCI-000366,CSF|PR.AC-1,ITSG-33|IA-5,NESA|T5.2.3,Rule-ID|SV-79083r1_rule,STIG-ID|OH12-1X-000176,SWIFT-CSCv1|2.3,Vuln-ID|V-64593"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/nodemanager/nm_password.properties"
  regex       : "^[\\s]([Uu]sername|[Pp]assword)"
  expect      : "^[\\s]([Uu]sername|[Pp]assword)"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000178 - OHS must have Entity tags (ETags) disabled - Header unset ETag"
  info        : "Entity tags (ETags) are used for cache management to save network bandwidth by not sending a web page to the requesting client if the cached version on the client is current.  When the client only has the ETag information, the client will make a request to the server with the ETag.  The server will then determine if the client can use the client cached version of the web page or if a new version is required.

As part of the ETag information, the server sends to the client the index node (inode) information for the file being requested.  The inode information gives an attacker sensitive information like inode number, multipart MIME boundaries and makes certain NFS attacks much simpler to execute."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'Header' and 'FileETag' directives at the OHS server, virtual host, or directory configuration scopes.

3a. Set the 'Header' directive to 'unset ETag', add the directive if it does not exist.
3b. Set the 'FileETag' directive to 'none', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79085r1_rule,STIG-ID|OH12-1X-000178,SWIFT-CSCv1|2.3,Vuln-ID|V-64595"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*Header"
  expect      : "^[\\s]*Header[\\s]+unset[\\s]+ETag"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000178 - OHS must have Entity tags (ETags) disabled - FileETag none"
  info        : "Entity tags (ETags) are used for cache management to save network bandwidth by not sending a web page to the requesting client if the cached version on the client is current.  When the client only has the ETag information, the client will make a request to the server with the ETag.  The server will then determine if the client can use the client cached version of the web page or if a new version is required.

As part of the ETag information, the server sends to the client the index node (inode) information for the file being requested.  The inode information gives an attacker sensitive information like inode number, multipart MIME boundaries and makes certain NFS attacks much simpler to execute."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'Header' and 'FileETag' directives at the OHS server, virtual host, or directory configuration scopes.

3a. Set the 'Header' directive to 'unset ETag', add the directive if it does not exist.
3b. Set the 'FileETag' directive to 'none', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79085r1_rule,STIG-ID|OH12-1X-000178,SWIFT-CSCv1|2.3,Vuln-ID|V-64595"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*FileETag"
  expect      : "^[\\s]*FileETag[\\s]+none"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000179 - The SecureListener property of the Node Manager configured to support OHS must be enabled for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

To protect the information being sent between WebLogic Scripting Tool and Node Manager, the Node Manager listening address must be secured."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'SecureListener' property.

3. Set the 'SecureListener' property to 'True'."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79087r1_rule,STIG-ID|OH12-1X-000179,SWIFT-CSCv1|2.3,Vuln-ID|V-64597"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*SecureListener"
  expect      : "^[\\s]*SecureListener[\\s]+[Tt]rue"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000180 - The ListenAddress property of the Node Manager configured to support OHS must match the CN of the certificate used by Node Manager."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

For connections to be made to the Node Manager, it must listen on an assigned address.  When this parameter is not set, the Node Manager will listen on all available addresses on the server.  This may lead to the Node Manager listening on networks, i.e., public network space, where Node Manager may become susceptible to attack instead of being limited to listening for connections on a controlled and secure management network.  It is also important that the address specified matches the CN of the Node Manager."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'ListenAddress' property.

3. Set the 'ListenAddress' property to the CN of the Node Manager certificate, add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79089r1_rule,STIG-ID|OH12-1X-000180,SWIFT-CSCv1|2.3,Vuln-ID|V-64599"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*ListenAddress"
# Note: Variable @CN_NODE_CERT@ replaced with "oraclelocal" in field "expect".
  expect      : "^[\\s]*ListenAddress[\\s]+oraclelocal"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000181 - The AuthenticationEnabled property of the Node Manager configured to support OHS must be configured to enforce authentication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

To accept connections from the WebLogic Scripting Tool, the Node Manager can be setup to authenticate the connections or not.  If connections are not authenticated, a hacker could connect to the Node Manager and initiate commands to OHS to gain further access, cause a DoS, or view protected information.  To protect against unauthenticated connections, the 'AuthenticationEnabled' directive must be set to 'true'."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'AuthenticationEnabled' property.

3. Set the 'AuthenticationEnabled' property 'True', add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79091r1_rule,STIG-ID|OH12-1X-000181,SWIFT-CSCv1|2.3,Vuln-ID|V-64601"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*AuthenticationEnabled"
  expect      : "^[\\s]*AuthenticationEnabled[\\s]+[Tt]rue"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000182 - The KeyStores property of the Node Manager configured to support OHS must be configured for secure communication."
  info        : "Oracle Node Manager is a utility that can be used to perform common operational tasks across Managed Servers.  These servers can be distributed across multiple machines and geographical locations.

The 'KeyStores' property is used to configure the keystore configuration that will be used by Node Manager to locate its identity (private key and digital certificate) and trust (trusted CA certificates).  The property must be set to 'CustomIdentityAndCustomTrust', which causes Node Manager to use an identity and trust keystore created by the SA."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'KeyStores' property.

3. Set the 'KeyStores' property to 'CustomIdentityAndCustomTrust', add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79093r1_rule,STIG-ID|OH12-1X-000182,SWIFT-CSCv1|2.3,Vuln-ID|V-64603"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*KeyStores"
  expect      : "^[\\s]*KeyStores[\\s]+CustomIdentityAndCustomTrust"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000183 - The CustomIdentityKeyStoreFileName property of the Node Manager configured to support OHS must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

The 'CustomIdentityKeyStoreFileName' property specifies the file name of the identity keystore.  This property is required when the 'KeyStores' property is set to 'CustomIdentityAndCustomTrust'.  Without specifying the 'CustomIdentityKeyStoreFileName' property, the Node Manager will not operate properly and may cause the system to fail into an unsecure state."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'CustomIdentityKeyStoreFileName' property.

3. Set the 'CustomIdentityKeyStoreFileName' property to a keystore location that contains a valid DoD certificate for the Node Manager identity, add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79095r1_rule,STIG-ID|OH12-1X-000183,SWIFT-CSCv1|2.3,Vuln-ID|V-64605"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*CustomIdentityKeyStoreFileName"
# Note: Variable @KEYSTORE_LOCATION@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/security" in field "expect".
  expect      : "^[\\s]*CustomIdentityKeyStoreFileName[\\s]+/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/security"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000184 - The CustomIdentityKeyStorePassPhrase property of the Node Manager configured to support OHS must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

The 'CustomIdentityKeyStorePassPhrase' property is used to protect the data within the keystore.  Without protection, the data within the keystore could be compromised allowing an attacker to use the certificates to gain trusted access to other systems or processes.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'CustomIdentityKeyStorePassPhrase' property.

3. Set the 'CustomIdentityKeyStorePassPhrase' property to the password of the keystore that contains a valid DoD certificate for the Node Manager identity, add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79097r1_rule,STIG-ID|OH12-1X-000184,SWIFT-CSCv1|2.3,Vuln-ID|V-64607"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*CustomIdentityKeyStorePassPhrase"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000185 - The CustomIdentityAlias property of the Node Manager configured to support OHS must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

The 'CustomIdentityAlias' specifies the alias when loading the private key into the keystore.  This property is required when the 'KeyStores' property is set to 'CustomIdentityAndCustomTrust'.  Without specifying the 'CustomIdentityKeyStoreFileName' property, the Node Manager will not operate properly and may cause the system to fail into an unsecure state."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'CustomIdentityAlias' property.

3. Set the 'CustomIdentityAlias' property to the alias of the keystore PrivateKeyEntry containing the Node Manager identity, add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79099r1_rule,STIG-ID|OH12-1X-000185,SWIFT-CSCv1|2.3,Vuln-ID|V-64609"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*CustomIdentityAlias"
# Note: Variable @IDENTITY_ALIAS@ replaced with "appIdentity1" in field "expect".
  expect      : "^[\\s]*CustomIdentityAlias[\\s]+appIdentity1"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000186 - The CustomIdentityPrivateKeyPassPhrase property of the Node Manager configured to support OHS must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

The 'CustomIdentityPrivateKeyPassPhrase' is the password that protects the private key when creating certificates.  If a password is not used, the private key is not protected and can be used by any user or attacker that can get access to the private key.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/nodemanager/nodemanager.properties with an editor.

2. Search for the 'CustomIdentityPrivateKeyPassPhrase' property.

3. Set the 'CustomIdentityPrivateKeyPassPhrase' property to the password protecting the Private Key of the Node Manager identity, add the property if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79101r1_rule,STIG-ID|OH12-1X-000186,SWIFT-CSCv1|2.3,Vuln-ID|V-64611"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties"
  regex       : "^[\\s]*CustomIdentityPrivateKeyPassPhrase"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : AUDIT_XML
  description : "OH12-1X-000187 - The listen-address element defined within the config.xml of the OHS Standalone domain that supports OHS must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the WebLogic Scripting Tool reads the parameters within the config.xml file to setup the communication to the Node Manager.  If the IP address to be used for communication is not specified, the WebLogic Scripting tool will not be able to setup a secure connection to Node Manager."
  solution    : "1. Open $DOMAIN_HOME/config/config.xml with an editor.

2. Search for the '<listen-address>' element within the '<node-manager>' element.

3. Set the '<listen-address>' element to the CN of the Node Manager certificate, add the element if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79103r1_rule,STIG-ID|OH12-1X-000187,SWIFT-CSCv1|2.3,Vuln-ID|V-64613"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/config.xml"
  xsl_stmt    : "<xsl:template match=\"/\">"
  xsl_stmt    : "<xsl:for-each select=\"//*[local-name() = 'node-manager']\">"
  xsl_stmt    : "Listen-address: <xsl:value-of select=\"./*[local-name() = 'listen-address']\" />"
  xsl_stmt    : "</xsl:for-each>"
  xsl_stmt    : "</xsl:template>"
  regex       : "Listen-address:"
# Note: Variable @CN_NODE_CERT@ replaced with "oraclelocal" in field "expect".
  expect      : "Listen-address: oraclelocal"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000188 - The listen-port element defined within the config.xml of the OHS Standalone Domain must be configured for secure communication."
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the WebLogic Scripting Tool reads the parameters within the config.xml file to setup the communication to the Node Manager.  If the port to be used for communication is not specified, the WebLogic Scripting tool will not be able to setup a secure connection to Node Manager."
  solution    : "1. Open $DOMAIN_HOME/config/config.xml with an editor.

2. Search for the '<listen-port>' element within the '<node-manager>' element.

3. Set the '<listen-port>' element to same value as the 'ListenPort' property found in $DOMAIN_HOME/nodemanager/nodemanager.properties, add the element if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79105r1_rule,STIG-ID|OH12-1X-000188,SWIFT-CSCv1|2.3,Vuln-ID|V-64615"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @LISTEN_PORT@ replaced with "5556" in field "cmd".
# Note: Variable @LISTEN_PORT@ replaced with "5556" in field "cmd".
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
  cmd         : "awk 'BEGIN { lp = \"\"; } /^\\s*ListenPort=/ {lp = $0; d = 0; f = \"\"; } /<node-manager/ { d = 1; t = $0; } d == 1 && /<listen-port/ { f = $0; } d == 1 && /<\\/node-manager>/ { if (f ~ /5556/ && lp ~ /5556/) { print \"nodemanager.properties: \"lp\"\\n\" \"config.xml: \"t f,\"\\nPass\"} else { print \"nodemanager.properties: \"lp\"\\n\" \"config.xml: \"t f,\"\\nFail, listen port not set or values do not match\"; }; d = 0; t = \"\"; f = \"\"; lp = \"\"; }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/nodemanager/nodemanager.properties /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/config.xml"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : FILE_CHECK
  description : "OH12-1X-000189 - The WLST_PROPERTIES environment variable defined for the OHS WebLogic Scripting Tool must be updated to reference an appropriate trust store so that it can communicate with the Node Manager supporting OHS - Permissions"
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the 'OHS' WebLogic Scripting Tool needs to trust the certificate presented by the Node Manager in order to setup secure communication with it.  If the 'OHS' WLST does not trust the certificate presented by Node Manager, the 'OHS' WebLogic Scripting tool will not be able to setup a secure connection to it."
  solution    : "1. Open $ORACLE_HOME/ohs/common/bin/setWlstEnv.sh. with an editor.  If the file does not exist, create the file.

2. Set 'WLST_PROPERTIES' environment variable to a valid trust keystore containing the Certificate Authority and Chain of Node Manager identity, add the property if it does not exist.

3. Issue a 'chmod 750 $ORACLE_HOME/ohs/common/bin/setWlstEnv.sh' to modify the permissions of the script."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-79107r1_rule,STIG-ID|OH12-1X-000189,SWIFT-CSCv1|2.3,Vuln-ID|V-64617"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @ORACLE_HOME@ replaced with "/oracle/Middleware/Oracle_Home" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/ohs/common/bin/setWlstEnv.sh"
  mask        : "027"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000189 - The WLST_PROPERTIES environment variable defined for the OHS WebLogic Scripting Tool must be updated to reference an appropriate trust store so that it can communicate with the Node Manager supporting OHS - WLST_PROPERTIES"
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the 'OHS' WebLogic Scripting Tool needs to trust the certificate presented by the Node Manager in order to setup secure communication with it.  If the 'OHS' WLST does not trust the certificate presented by Node Manager, the 'OHS' WebLogic Scripting tool will not be able to setup a secure connection to it.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $ORACLE_HOME/ohs/common/bin/setWlstEnv.sh. with an editor.  If the file does not exist, create the file.

2. Set 'WLST_PROPERTIES' environment variable to a valid trust keystore containing the Certificate Authority and Chain of Node Manager identity, add the property if it does not exist.

3. Issue a 'chmod 750 $ORACLE_HOME/ohs/common/bin/setWlstEnv.sh' to modify the permissions of the script."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79107r1_rule,STIG-ID|OH12-1X-000189,SWIFT-CSCv1|2.3,Vuln-ID|V-64617"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @ORACLE_HOME@ replaced with "/oracle/Middleware/Oracle_Home" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/ohs/common/bin/setWlstEnv.sh"
  regex       : "^[\\s]*(export[\\s]*)?WLST_PROPERTIES[\\s]*="
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CHECK
  description : "OH12-1X-000190 - The WLST_PROPERTIES environment variable defined for the Fusion Middleware WebLogic Scripting Tool must be updated to reference an appropriate trust store so that it can communicate with the Node Manager supporting OHS - Permissions"
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the 'Fusion Middleware' WebLogic Scripting Tool needs to trust the certificate presented by the Node Manager in order to setup secure communication with it.  If the 'Fusion Middleware' WLST does not trust the certificate presented by Node Manager, the 'Fusion Middleware' WebLogic Scripting tool will not be able to setup a secure connection to it."
  solution    : "1. Open $ORACLE_HOME/oracle_common/common/bin/setWlstEnv.sh. with an editor.  If the file does not exist, create the file.

2. Set 'WLST_PROPERTIES' environment variable to a valid trust keystore containing the Certificate Authority and Chain of Node Manager identity, add the property if it does not exist.

3. Issue a 'chmod 750 $ORACLE_HOME/oracle_common/common/bin/setWlstEnv.sh' to modify the permissions of the script."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-79109r1_rule,STIG-ID|OH12-1X-000190,SWIFT-CSCv1|2.3,Vuln-ID|V-64619"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @ORACLE_HOME@ replaced with "/oracle/Middleware/Oracle_Home" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/oracle_common/common/bin/setWlstEnv.sh"
  mask        : "027"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000190 - The WLST_PROPERTIES environment variable defined for the Fusion Middleware WebLogic Scripting Tool must be updated to reference an appropriate trust store so that it can communicate with the Node Manager supporting OHS - WLST_PROPERTIES"
  info        : "Oracle Node Manager is the utility that is used to perform common operational tasks for OHS.

When starting an OHS instance, the 'Fusion Middleware' WebLogic Scripting Tool needs to trust the certificate presented by the Node Manager in order to setup secure communication with it.  If the 'Fusion Middleware' WLST does not trust the certificate presented by Node Manager, the 'Fusion Middleware' WebLogic Scripting tool will not be able to setup a secure connection to it.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $ORACLE_HOME/oracle_common/common/bin/setWlstEnv.sh. with an editor.  If the file does not exist, create the file.

2. Set 'WLST_PROPERTIES' environment variable to a valid trust keystore containing the Certificate Authority and Chain of Node Manager identity, add the property if it does not exist.

3. Issue a 'chmod 750 $ORACLE_HOME/oracle_common/common/bin/setWlstEnv.sh' to modify the permissions of the script."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79109r1_rule,STIG-ID|OH12-1X-000190,SWIFT-CSCv1|2.3,Vuln-ID|V-64619"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @ORACLE_HOME@ replaced with "/oracle/Middleware/Oracle_Home" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/oracle_common/common/bin/setWlstEnv.sh"
  regex       : "^[\\s]*(export[\\s]*)?WLST_PROPERTIES[\\s]*="
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000192 - OHS must limit access to the Dynamic Monitoring Service (DMS)."
  info        : "The Oracle Dynamic Monitoring Service (DMS) enables application developers, support analysts, system administrators, and others to measure application specific performance information.  If OHS allows any machine to connect and monitor performance, an attacker could connect and gather information that could be used to cause a DoS for OHS.  Information that is shared could also be used to further an attack to other servers and devices through trusted relationships."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/admin.conf with an editor.

2. Search for the 'Allow' directive within the '<Location /dms/>' virtual host configuration scope.

3. Set the 'Allow' directive to 'from 127.0.0.1'."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79113r1_rule,STIG-ID|OH12-1X-000192,SWIFT-CSCv1|2.3,Vuln-ID|V-64623"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Location \\/dms\\// { d = 1; t = $0; } d == 1 && /^\\s*[Aa]llow/ { f = $0; } d == 1 && /<\\/Location>/ { if (f ~ /^\\s*[Aa]llow\\s*from\\s*127\\.0\\.0\\.1/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/admin.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000193 - OHS must have the AllowOverride directive set properly."
  info        : "The property 'AllowOverride' is used to allow directives to be set differently than those set for the overall architecture.  When the property is not set to 'None', OHS will check for directives in the htaccess files at each directory level until the requested resource is found for each URL request.  Allowing parameters to be overridden at different levels of an application becomes a security risk as the overall security of the hosted application can change dependencies on the URL being accessed.  Security management also becomes difficult as a misconfiguration can be mistakenly made."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'AllowOverride' directive at the directory configuration scope.

3. Set the 'AllowOverride' directive to 'None', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79115r1_rule,STIG-ID|OH12-1X-000193,SWIFT-CSCv1|2.3,Vuln-ID|V-64625"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory/ { d = 1; t = $0; } d == 1 && /^\\s*[Aa]llow[Oo]verride/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Aa]llow[Oo]verride\\s*[Nn]one/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000194 - OHS must be set to evaluate deny directives first when considering whether to serve a file."
  info        : "Part of securing OHS is allowing/denying access to the web server.  Deciding on the manor the allow/deny rules are evaluated can turn what was once an allowable access into being blocked if the evaluation is reversed.  By ordering the access as first deny and then allow, OHS will deny all access first and then look at the allow clauses to see who may access the server.  By structuring the evaluation in this manner, a misconfiguration will more likely deny a valid user than allow an illegitimate user that may compromise the system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the '<Directory />' directive within the OHS server configuration scope.

3. Set the 'Order' directive within the '<Directory />' directive to 'deny,allow', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79117r1_rule,STIG-ID|OH12-1X-000194,SWIFT-CSCv1|2.3,Vuln-ID|V-64627"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \\/>/ { d = 1; t = $0; } d == 1 && /^\\s*[Oo]rder/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Oo]rder\\s*[Dd]eny,[Aa]llow/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000195 - OHS must deny all access by default when considering whether to serve a file."
  info        : "Part of securing OHS is allowing/denying access to the web server.  Deciding on the manor the allow/deny rules are evaluated can turn what was once an allowable access into being blocked if the evaluation is reversed.  By ordering the access as first deny and then allow, OHS will deny all access first and then look at the allow clauses to see who may access the server.  By structuring the evaluation in this manner, a misconfiguration will more likely deny a valid user than allow an illegitimate user that may compromise the system."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the '<Directory />' directive within the OHS server configuration scope.

3. Set the 'Deny' directive within the '<Directory />' directive to 'from all', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79119r1_rule,STIG-ID|OH12-1X-000195,SWIFT-CSCv1|2.3,Vuln-ID|V-64629"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \\/>/ { d = 1; t = $0; } d == 1 && /^\\s*[Dd]eny/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Dd]eny\\s+[Ff]om\\s+[Aa]ll/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000196 - The OHS instance installation must not contain an .htaccess file."
  info        : ".htaccess files are used to override settings in the OHS configuration files.  The placement of the .htaccess file is also important as the settings will affect the directory where the file is located and any subdirectories below.  Allowing the use of .htaccess files, the hosted application security posture and overall OHS posture could change dependent on the URL being accessed.  Allowing the override of parameters in .htaccess files makes it difficult to truly know the security posture of the system and it also makes it difficult to understand what the security posture may have been if an attack is successful.  To thwart the overriding of parameters, .htaccess files must not be used and the 'AllowOverride' parameter must be set to 'none'."
  solution    : "1. cd $DOMAIN_HOME/config/fmwconfig/components/OHS

2. find . -name .htaccess -exec rm {} \;"
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79121r1_rule,STIG-ID|OH12-1X-000196,SWIFT-CSCv1|2.3,Vuln-ID|V-64631"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ -name .htaccess | awk '{print} END {if (NR == 0) print \"none\"}'"
  expect      : "^none$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000197 - The OHS instance configuration must not reference directories that contain an .htaccess file."
  info        : ".htaccess files are used to override settings in the OHS configuration files.  The placement of the .htaccess file is also important as the settings will affect the directory where the file is located and any subdirectories below.  Allowing the use of .htaccess files, the hosted application security posture and overall OHS posture could change dependent on the URL being accessed.  Allowing the override of parameters in .htaccess files makes it difficult to truly know the security posture of the system and it also makes it difficult to understand what the security posture may have been if an attack is successful.  To thwart the overriding of parameters, .htaccess files must not be used and the 'AllowOverride' parameter must be set to 'none'.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<Directory>' directives at the server and virtual host configuration scopes.

3. Go to the location specified as the value for each '<Directory>' directive (e.g., cd $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/ohs1/htdocs).

4. find . -name .htaccess -exec rm {} \;"
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79123r1_rule,STIG-ID|OH12-1X-000197,SWIFT-CSCv1|2.3,Vuln-ID|V-64633"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep \"^\\s*<Directory\" /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000198 - OHS must have the HostnameLookups directive enabled."
  info        : "Setting the 'HostnameLookups' to 'On' allows for more information to be logged in the event of an attack and subsequent investigation.  This information can be added to other information gathered to narrow the attacker location.  The DNS name can also be used for filtering access to the OHS hosted applications by denying particular types of hostnames."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'HostnameLookups' directive at the server, virtual host, and directory configuration scopes.

3. Set the 'HostnameLookups' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79125r1_rule,STIG-ID|OH12-1X-000198,SWIFT-CSCv1|2.3,Vuln-ID|V-64635"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*HostnameLookups[\\s]+"
  expect      : "^[\\s]*HostnameLookups[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000199 - OHS must have the ServerAdmin directive set properly."
  info        : "Making sure that information is given to the system administrator in a timely fashion is important.  This information can be system status, warnings that may need attention before system failure or actual failure notification.  Having this information sent to the system administrator when the issue arises allows for the system administrator to quickly take action and avoid potential DoS for customers."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'ServerAdmin' directive at the virtual host and directory configuration scopes.

3. Set the 'ServerAdmin' directive to an appropriate service-based email address for the organization, add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79127r1_rule,STIG-ID|OH12-1X-000199,SWIFT-CSCv1|2.3,Vuln-ID|V-64637"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  regex       : "^[\\s]*ServerAdmin[\\s]+"
  expect      : "^[\\s]*ServerAdmin[\\s]+[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000200 - OHS must restrict access methods - LimitExcept GET POST"
  info        : "The directive '<LimitExcept>' allows the system administrator to restrict what users may use which methods.  An example of methods would be GET, POST and DELETE.  These three are the most common used by applications and should be allowed.  Methods such as TRACE, if allowed, give an attacker a way to map the system so that vulnerabilities to the system can be researched and developed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<LimitExcept>' directive at the directory configuration scope.

3. Set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.

4. Within the '<LimitExcept GET POST>' directives, add the directive 'Deny' and set it to 'from all'."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79129r1_rule,STIG-ID|OH12-1X-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-64639"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory [^\\/]/ { d = 1; t = $0; } d == 1 && /^\\s*<LimitExcept/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*<LimitExcept GET POST/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000200 - OHS must restrict access methods - LimitExcept > Deny from all"
  info        : "The directive '<LimitExcept>' allows the system administrator to restrict what users may use which methods.  An example of methods would be GET, POST and DELETE.  These three are the most common used by applications and should be allowed.  Methods such as TRACE, if allowed, give an attacker a way to map the system so that vulnerabilities to the system can be researched and developed."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the '<LimitExcept>' directive at the directory configuration scope.

3. Set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.

4. Within the '<LimitExcept GET POST>' directives, add the directive 'Deny' and set it to 'from all'."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79129r1_rule,STIG-ID|OH12-1X-000200,SWIFT-CSCv1|2.3,Vuln-ID|V-64639"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<LimitExcept GET POST/ { d = 1; t = $0; } d == 1 && /^\\s*[Dd]eny/ { f = $0; } d == 1 && /<\\/LimitExcept>/ { if (f ~ /^\\s*[Dd]eny\\s+[Ff]rom\\s+[Aa]ll/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : FILE_CHECK_NOT
  description : "OH12-1X-000201 - The OHS htdocs directory must not contain any default files."
  info        : "Default files from the OHS installation should not be part of the htdocs directory.  These files are not always patched or supported and may become an attacker vector in the future."
  solution    : "1. cd $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/ohs1/htdocs

2. rm -rf OracleHTTPServer12c_files."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000366,CIP|007-6-R1,CN-L3|7.1.3.5(c),CN-L3|7.1.3.7(d),CN-L3|8.1.4.4(b),CSCv6|9.1,CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS13b,NIAv2|SS14a,NIAv2|SS14c,NIAv2|SS15a,PCI-DSSv3.1|2.2.2,PCI-DSSv3.1|2.2.3,PCI-DSSv3.2|2.2.2,PCI-DSSv3.2|2.2.3,Rule-ID|SV-79131r1_rule,STIG-ID|OH12-1X-000201,SWIFT-CSCv1|2.3,Vuln-ID|V-64641"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "DOMAIN_HOME@/config/fmwconfig/components/OHS/ohs1/htdocs/OracleHTTPServer12c_files"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000202 - OHS must have the SSLSessionCacheTimeout directive set properly."
  info        : "During an SSL session, information about the session is stored in the global/inter-process SSL Session Cache, the OpenSSL internal memory cache and for sessions resumed by TLS session resumption (RFC 5077).  This information must not be allowed to live forever, but expire and become invalid so that an attacker cannot hijack the session if not closed by the hosted application properly."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLSessionCacheTimeout' directive at the OHS server configuration scope.

3. Set the 'SSLSessionCacheTimeout' directive to '60', add the directive if it does not exist."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79133r1_rule,STIG-ID|OH12-1X-000202,SWIFT-CSCv1|2.3,Vuln-ID|V-64643"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLSessionCacheTimeout[\\s]+"
  expect      : "^[\\s]*SSLSessionCacheTimeout[\\s]+([1-9]|[1-5][0-9]|60)"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000203 - OHS must have the RewriteEngine directive enabled."
  info        : "The rewrite engine is used to evaluate URL requests and modify the requests on the fly.  Enabling this engine gives the system administrator the capability to trap potential attacks before reaching the hosted applications or to modify the URL to fix issues in the request before forwarding to the applications.  The rewrite engine becomes a pre-filtering tool to fix data issues before reaching the hosted applications where the URL format or data within the URL could cause buffer overflows, redirection or mobile code snippets that could become an issue if not filtered."
  solution    : "1. As required, open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'RewriteEngine' directive at the OHS server and virtual host configuration scopes.

3. Set the 'RewriteEngine' directive to 'On', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79135r1_rule,STIG-ID|OH12-1X-000203,SWIFT-CSCv1|2.3,Vuln-ID|V-64645"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /^\\s*<VirtualHost/ { d = 1; t = $0; } d == 1 && /^\\s*[Rr]ewrite[Ee]ngine/ { f = $0; } d == 1 && /<\\/VirtualHost>/ { if (f ~ /^\\s*[Rr]ewrite[Ee]ngine\\s+[Oo]n/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000204 - OHS must have the RewriteOptions directive set properly."
  info        : "The rules for the rewrite engine can be configured to inherit those from the parent and build upon that set of rules, to copy the rules from the parent if there are none defined or to only process the rules if the input is a URL.  Of these, the most secure is to inherit from the parent because of how this implemented.  The rules for the current configuration, process or directory, are loaded and then the parent are overlaid.  This means that the parent rule will always override the child rule.  This gives the server a more consistent security configuration."
  solution    : "1. As required, open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'RewriteOptions' directive at the OHS server and virtual host configuration scopes.

3. Set the 'RewriteOptions' directive to 'inherit', add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79137r1_rule,STIG-ID|OH12-1X-000204,SWIFT-CSCv1|2.3,Vuln-ID|V-64647"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /^\\s*<VirtualHost/ { d = 1; t = $0; } d == 1 && /^\\s*[Rr]ewrite[Oo]ptions/ { f = $0; } d == 1 && /<\\/VirtualHost>/ { if (f ~ /^\\s*[Rr]ewrite[Oo]ptions\\s+[Ii]nherit/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000205 - OHS must have the RewriteLogLevel directive set to the proper log level."
  info        : "Logging must not contain sensitive information or more information necessary than that needed to administer the system.  The log levels from the rewrite engine range from 0 to 9 where 0 is no logging and 9 being the most verbose.  A log level that gives enough information for an investigation if an attack occurs of enough information to troubleshoot issues should be selected.  Too much information makes the system vulnerable and may give attacker information to other resources or data within the hosted applications."
  solution    : "1. As required, open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'RewriteLogLevel' directive at the OHS server and virtual host configuration scopes.

3. Set the 'RewriteLogLevel' directive to '3'; add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79139r1_rule,STIG-ID|OH12-1X-000205,SWIFT-CSCv1|2.3,Vuln-ID|V-64649"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /^\\s*<VirtualHost/ { d = 1; t = $0; } d == 1 && /^\\s*[Rr]ewrite[Ll]og[Ll]evel/ { f = $0; } d == 1 && /<\\/VirtualHost>/ { if (f ~ /^\\s*[Rr]ewrite[Ll]og[Ll]evel\\s+3/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000206 - OHS must have the RewriteLog directive set properly."
  info        : "Specifying where the log files are written gives the system administrator the capability to store the files in a location other than the default, with system files or in a globally accessible location.  The system administrator can also specify a location that is accessible by any enterprise tools that may use the logged data to give a picture of the overall enterprise security posture.  If a file is not specified, OHS will still generate the log data, but it is not written and therefore, cannot be used to monitor the system or for forensic analysis.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. As required, open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'RewriteLog' directive at the OHS server and virtual host configuration scopes.

3. Set the 'RewriteLog' directive to the same location as the 'CustomLog' directive; add the directive if it does not exist unless inherited from a larger scope."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79141r1_rule,STIG-ID|OH12-1X-000206,SWIFT-CSCv1|2.3,Vuln-ID|V-64651"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; } /^\\s*<VirtualHost/ { d = 1; t = $0; } d == 1 && /^\\s*[Cc]ustom[Ll]og/ { f = $0; } d == 1 && /<\\/VirtualHost>/ { print t,f}' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000207 - All accounts installed with the web server software and tools must have passwords assigned and default passwords changed."
  info        : "During installation of the web server software, accounts are created for the web server to operate properly. The accounts installed can have either no password installed or a default password, which will be known and documented by the vendor and the user community.

The first things an attacker will try when presented with a login screen are the default user identifiers with default passwords. Installed applications may also install accounts with no password, making the login even easier. Once the web server is installed, the passwords for any created accounts should be changed and documented. The new passwords must meet the requirements for all passwords, i.e., upper/lower characters, numbers, special characters, time until change, reuse policy, etc.

Normally, a service account is established for OHS.  This is because a privileged account is not desirable and the server is designed to run for long uninterrupted periods of time.

The SA or Web Manager will need password access to OHS to restart the service in the event of an emergency as OHS is not to restart automatically after an unscheduled interruption.  If the password is not entrusted to an SA or web manager the ability to ensure the availability of OHS is compromised.

Service accounts or system accounts that have no login capability do not need to have passwords set or changed.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Inform the OHS Administrator as to what the password is for the OS account that owns the OHS Software."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79143r2_rule,STIG-ID|OH12-1X-000207,Vuln-ID|V-64653"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Check for yum"
      cmd         : "which yum | awk '{print} END {if (NR >= 1) print \"found\";}'"
      expect      : "^found$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000208 - A production OHS Installation must prohibit the installation of a compiler."
      info        : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses.  For example, the attacker's code can be uploaded and compiled on the server under attack.

    NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "Ask the System Administrator to remove any compilers installed on the system."
      reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79145r1_rule,STIG-ID|OH12-1X-000208,SWIFT-CSCv1|2.3,Vuln-ID|V-64655"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
      cmd         : "yum list installed | egrep \"(compiler|gcc|java|fortran)\" | awk '{print} END {if (NR == 0) print \"Compiler, GCC, Java, or Fortran compilers not found. Please manually review target to ensure compliance.\";}'"
      expect      : "Manual Review Required"
      severity    : MEDIUM
    </custom_item>
  </then>

  <else>
    <if>
      <condition type:"AND">
        <custom_item>
          type        : CMD_EXEC
          description : "Check for apt"
          cmd         : "which apt | awk '{print} END {if (NR >= 1) print \"found\";}'"
          expect      : "^found$"
        </custom_item>
      </condition>

      <then>
        <custom_item>
          type        : CMD_EXEC
          description : "OH12-1X-000208 - A production OHS Installation must prohibit the installation of a compiler."
          info        : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses.  For example, the attacker's code can be uploaded and compiled on the server under attack.

        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Ask the System Administrator to remove any compilers installed on the system."
          reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79145r1_rule,STIG-ID|OH12-1X-000208,SWIFT-CSCv1|2.3,Vuln-ID|V-64655"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
          cmd         : "dpkg -l | grep '^ii' | egrep \"(compiler|gcc|java|fortran)\" | awk '{print} END {if (NR == 0) print \"Compiler, GCC, Java, or Fortran compilers not found. Please manually review target to ensure compliance.\";}'"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </then>

      <else>
        <custom_item>
          type        : CMD_EXEC
          description : "OH12-1X-000208 - A production OHS Installation must prohibit the installation of a compiler."
          info        : "The presence of a compiler on a production server facilitates the malicious user's task of creating custom versions of programs and installing Trojan Horses or viruses.  For example, the attacker's code can be uploaded and compiled on the server under attack.

        NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
          solution    : "Ask the System Administrator to remove any compilers installed on the system."
          reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79145r1_rule,STIG-ID|OH12-1X-000208,SWIFT-CSCv1|2.3,Vuln-ID|V-64655"
          see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
          cmd         : "zypper se --installed-only | egrep \"(compiler|gcc|java|fortran)\" | awk '{print} END {if (NR == 0) print \"Compiler, GCC, Java, or Fortran compilers not found. Please manually review target to ensure compliance.\";}'"
          expect      : "Manual Review Required"
          severity    : MEDIUM
        </custom_item>
      </else>
    </if>
  </else>
</if>

<report type:"WARNING">
  description : "OH12-1X-000209 - A public OHS installation, if hosted on the NIPRNet, must be isolated in an accredited DoD DMZ Extension."
  info        : "To minimize exposure of private assets to unnecessary risk by attackers, public web servers must be isolated from internal systems.  Public web servers are by nature more vulnerable to attack from publically based sources, such as the public Internet. Once compromised, a public web server might be used as a base for further attack on private resources, unless additional layers of protection are implemented. Public web servers must be located in a DoD DMZ Extension, if hosted on the NIPRNet, with carefully controlled access. Failure to isolate resources in this way increase risk that private assets are exposed to attacks from public sources.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Relocate the OHS server to be in a DMZ, isolated from internal systems.

2. Confirm that the OHS server only has connections to supporting Application and Database Servers."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79147r1_rule,STIG-ID|OH12-1X-000209,Vuln-ID|V-64657"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000210 - A private OHS installation must be located on a separate controlled access subnet."
  info        : "Private web servers, which host sites that serve controlled access data, must be protected from outside threats in addition to insider threats. Insider threat may be accidental or intentional but, in either case, can cause a disruption in service of the web server. To protect the private web server from these threats, it must be located on a separate controlled access subnet and must not be a part of the public DMZ that houses the public web servers. It also cannot be located inside the enclave as part of the local general population LAN.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Relocate the OHS server to be on a local subnet, isolated from the DMZ.

2. Remove access to the OHS server from the LAN's general population."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79149r1_rule,STIG-ID|OH12-1X-000210,Vuln-ID|V-64659"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000211 - The version of the OHS installation must be vendor-supported."
  info        : "Many vulnerabilities are associated with older versions of software.  As hot fixes and patches are issued, these solutions are included in the next version of the server software.  Maintaining OHS at a current version makes the efforts of a malicious user to exploit the web service more difficult.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Install or upgrade to a version of OHS that is within the support timeframes for 'Fusion Middleware 12c' at http://www.oracle.com/us/support/library/lifetime-support-middleware-069163.pdf.

2. Confirm that the organization is current with respect to support payments."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79151r1_rule,STIG-ID|OH12-1X-000211,SWIFT-CSCv1|2.3,Vuln-ID|V-64661"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "grep -i \"Oracle-HTTP-Server\" /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/servers/ohs1/logs/*.log"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000212 - OHS must be certified with accompanying Fusion Middleware products."
  info        : "OHS is capable of being used with other Oracle products.  For the products to work properly and not introduce vulnerabilities or errors, Oracle certifies which versions work with each other.  Insisting that the certified versions be installed together in a production environment reduces the possibility of successful attacks, DoS through software system downtime and easier patch management for the SA.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Upgrade or patch OHS or other Oracle Fusion Middleware products to achieve a certified configuration per http://www.oracle.com/technetwork/middleware/fusion-middleware/documentation/fmw-1213certmatrix-2226694.xls."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79153r1_rule,STIG-ID|OH12-1X-000212,Vuln-ID|V-64663"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000214 - OHS tools must be restricted to the web manager and the web managers designees."
  info        : "All automated information systems are at risk of data loss due to disaster or compromise. Failure to provide adequate protection to the administration tools creates risk of potential theft or damage that may ultimately compromise the mission.  Adequate protection ensures that server administration operates with less risk of losses or operations outages.  The key web service administrative and configuration tools must be accessible only by the authorized web server administrators. All users granted this authority must be documented and approved by the ISSO. Access to OHS must be limited to authorized users and administrators.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Restrict access to the OS account that owns OHS, root, or tool with OHS management or monitoring capability such as Oracle Enterprise Manager (OEM)."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79155r1_rule,STIG-ID|OH12-1X-000214,Vuln-ID|V-64665"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000215 - All utility programs, not necessary for operations, must be removed or disabled."
  info        : "Just as running unneeded services and protocols is a danger to the web server at the lower levels of the OSI model, running unneeded utilities and programs is also a danger at the application layer of the OSI model. Office suites, development tools, and graphical editors are examples of such programs that are troublesome. Individual productivity tools have no legitimate place or use on an enterprise, production web server and they are also prone to their own security risks.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove any software that is unnecessary for OHS operation, other organization requirements, or is not appropriately patched or supported."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-79157r1_rule,STIG-ID|OH12-1X-000215,Vuln-ID|V-64667"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : FILE_CHECK
  description : "OH12-1X-000216 - The OHS htpasswd files (if present) must reflect proper ownership and permissions."
  info        : "In addition to OS restrictions, access rights to files and directories can be set on a web site using the web server software.  That is, in addition to allowing or denying all access rights, a rule can be specified that allows or denies partial access rights.  For example, users can be given read-only access rights to files, to view the information but not change the files.

This check verifies that the htpasswd file is only accessible by system administrators or web managers, with the account running the web service having group permissions of read and execute.  Htpasswd is a utility used by OHS to provide for password access to designated web sites."
  solution    : "Set permissions on htpasswd to 740 (i.e., chmod 740 $ORACLE_HOME/ohs/bin/htpasswd)."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSCv6|3.1,CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,Rule-ID|SV-79159r1_rule,STIG-ID|OH12-1X-000216,SWIFT-CSCv1|2.3,Vuln-ID|V-64669"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @ORACLE_HOME@ replaced with "/oracle/Middleware/Oracle_Home" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/ohs/bin/htpasswd"
  mask        : "037"
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000217 - A public OHS installation must limit email to outbound only."
  info        : "Incoming E-mail has been known to provide hackers with access to servers. Disabling the incoming mail service prevents this type of attacks. Additionally, Email represents the main use of the Internet. It is specialized application that requires the dedication of server resources. To combine this type of transaction processing function with the file serving role of the web server creates an inherent conflict. Supporting mail services on a web server opens the server to the risk of abuse as an email relay. This check verifies, by checking the OS, that incoming e-mail is not supported.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Configure the server to disallow inbound SMTP connections."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79161r1_rule,STIG-ID|OH12-1X-000217,Vuln-ID|V-64671"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000218 - OHS content and configuration files must be part of a routine backup program."
  info        : "Backing up web server data and web server application software after upgrades or maintenance ensures that recovery can be accomplished up to the current version.  It also provides a means to determine and recover from subsequent unauthorized changes to the software and data.

A tested and verifiable backup strategy will be implemented for web server software as well as all web server data files.  Backup and recovery procedures will be documented and the Web Manager or SA for the specific application will be responsible for the design, test, and implementation of the procedures.
 The site will have a contingency processing plan/disaster recovery plan that includes web servers. The contingency plan will be periodically tested in accordance with DoDI 8500.2 requirements.

The site will identify an off-site storage facility in accordance with DoDI 8500.2 requirements.  Off-site backups will be updated on a regular basis and the frequency will be documented in the contingency plan.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Backup the following files on a regular basis:

a) /etc/oraInst.loc
b) Directory identified by inventory_loc parameter within /etc/oraInst.loc
c) /etc/cap.ora
d) $MW_HOME

2. Perform a restore and start the restored OHS server on a test machine.

3. Test the functionality of the restored OHS software on the test machine."
  reference   : "CAT|III,CCI|CCI-000366,Rule-ID|SV-79163r1_rule,STIG-ID|OH12-1X-000218,Vuln-ID|V-64673"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000219 - OHS must be segregated from other services - OHS must be segregated from other services."
  info        : "The web server installation and configuration plan should not support the co-hosting of multiple services such as Domain Name Service (DNS), e-mail, databases, search engines, indexing, or streaming media on the same server that is providing the web publishing service.  By separating these services, physically or logically, additional defensive layers are established between the web service and the applicable application should either be compromised.

Disallowed or restricted services in the context of this vulnerability applies to services that are not directly associated with the delivery of web content. An operating system that supports a web server will not provide other services (e.g., domain controller, e-mail server, database server, etc.). Only those services necessary to support the web server and its hosted sites are specifically allowed and may include, but are not limited to, operating system, logging, anti-virus, host intrusion detection, administrative maintenance, or network requirements.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Move any software from the OHS installation that is not required for the operation or management of the OHS server to another physical or logical server."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79165r1_rule,STIG-ID|OH12-1X-000219,Vuln-ID|V-64675"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000220 - OHS must have all applicable patches (i.e., CPUs) applied/documented (OEM)."
  info        : "The IAVM process does not address all patches that have been identified for the host operating system or, in this case, the web server software environment. Many vendors have subscription services available to notify users of known security threats. The site needs to be aware of these fixes and make determinations based on local policy and what software features are installed, if these patches need to be applied.

In some cases, patches also apply to middleware and database systems. Maintaining the security of web servers requires frequent reviews of security notices. Many security notices mandate the installation of a software patch to overcome security vulnerabilities.

SAs and ISSOs should regularly check the vendor support web site for patches and information related to the web server software. All applicable security patches will be applied to the operating system and to the web server software. Security patches are deemed applicable if the product is installed, even if it is not used or is disabled.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Obtain the latest Fusion Middleware Patches applicable for Oracle HTTP Server from the My Oracle Support note associated with the latest Oracle CPU at http://www.oracle.com/technetwork/topics/security/alerts-086861.html#CriticalPatchUpdates.

2. Follow the instructions associated with each patch to successfully apply."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79167r1_rule,STIG-ID|OH12-1X-000220,Vuln-ID|V-64677"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000221 - A private OHS list of CAs in a trust hierarchy must lead to an authorized DoD PKI Root CA."
  info        : "A PKI certificate is a digital identifier that establishes the identity of an individual or a platform. A server that has a certificate provides users with third-party confirmation of authenticity. Most web browsers perform server authentication automatically; the user is notified only if the authentication fails. The authentication process between the server and the client is performed using the SSL/TLS protocol. Digital certificates are authenticated, issued, and managed by a trusted Certification Authority (CA).

The use of a trusted certificate validation hierarchy is crucial to the ability to control access to the server and prevent unauthorized access. This hierarchy needs to lead to the DoD PKI Root CA or to an approved External Certificate Authority (ECA) or are required for the server to function.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Go to the location of the OHS keystores (e.g., cd $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. For each wallet directory located there, do the following:

a) Issue the command '$ORACLE_HOME/oracle_common/bin/orapki wallet display -wallet <wallet_directory>'.
b) Remove the Identity Certificate if it was not issued by a DoD Certificate authority.
c) Remove each Trusted Certificate from the wallet that is not an appropriate DoD Certificate Authority with the command '$ORACLE_HOME/oracle_common/bin/orapki wallet remove -wallet <wallet_directory> -dn <dn_of_the_trusted_certificate> -trusted_cert'."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79169r1_rule,STIG-ID|OH12-1X-000221,Vuln-ID|V-64679"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000222 - OHS must have the ScoreBoardFile directive disabled."
  info        : "The ScoreBoardFile directive sets a file path which the server will use for Inter-Process Communication (IPC) among the Apache processes. If the directive is specified, then Apache will use the configured file for the inter-process communication. Therefore if it is specified it needs to be located in a secure directory. If the ScoreBoard file is placed in openly writable directory, other accounts could create a denial of service attack and prevent the server from starting by creating a file with the same name, and or users could monitor and disrupt the communication between the processes by reading and writing to the file."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ScoreBoardFile' directive at the server configuration scope.

3. Remove the 'ScoreBoardFile' directive."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000366,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-79171r1_rule,STIG-ID|OH12-1X-000222,SWIFT-CSCv1|2.3,Vuln-ID|V-64681"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*ScoreBoardFile"
  expect      : "^[\\s]*ScoreBoardFile"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000223 - The OHS document root directory must not be on a network share."
  info        : "Sharing of web server content is a security risk when a web server is involved. Users accessing the share anonymously could experience privileged access to the content of such directories. Network sharable directories expose those directories and their contents to unnecessary access. Any unnecessary exposure increases the risk that someone could exploit that access and either compromises the web content or cause web server performance problems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Remove the shares that are associated with any directory specified as a value for the 'DocumentRoot' directives."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-000366,ITSG-33|SI-11,Rule-ID|SV-79173r1_rule,STIG-ID|OH12-1X-000223,Vuln-ID|V-64683"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000224 - The OHS server root directory must not be on a network share."
  info        : "Sharing of the web server directory where the executables are stored is a security risk when a web server is involved.  Users that have access to the share may not be administrative users.  These users could make changes to the web server without going through proper change control or the users could inadvertently delete executables that are key to the proper operation of the web server.  Any unnecessary exposure increases the risk that someone could exploit that access and either compromises the web server or cause web server performance problems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf.

2. Search for the 'ServerRoot' directive at the OHS server configuration scope.

3. Remove the share that is associated with the directory specified as a value for the 'ServerRoot' directive."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-000366,ITSG-33|SI-11,Rule-ID|SV-79175r1_rule,STIG-ID|OH12-1X-000224,Vuln-ID|V-64685"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*ServerRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000225 - Symbolic links must not be used in the web content directory tree."
  info        : "A symbolic link allows a file or a directory to be referenced using a symbolic name raising a potential hazard if symbolic linkage is made to a sensitive area. When web scripts are executed and symbolic links are allowed, the web user could be allowed to access locations on the web server that are outside the scope of the web document root or home directory.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Within the directory specified by each 'DocumentRoot' directive, check recursively for any symbolic links (e.g., find . -type l -exec ls -ald {} \;).

4. Remove any symbolic links found in the 'DocumentRoot' directory tree."
  reference   : "800-53|SI-11,CAT|I,CCI|CCI-000366,ITSG-33|SI-11,Rule-ID|SV-79177r1_rule,STIG-ID|OH12-1X-000225,Vuln-ID|V-64687"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000226 - OHS administration must be performed over a secure path or at the local console."
  info        : "Logging into a web server remotely using an unencrypted protocol or service when performing updates and maintenance is a major risk.  Data, such as user account, is transmitted in plaintext and can easily be compromised.  When performing remote administrative tasks, a protocol or service that encrypts the communication channel must be used.

An alternative to remote administration of the web server is to perform web server administration locally at the console.  Local administration at the console implies physical access to the server.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure that both system and OHS administration are done through a secure path."
  reference   : "CAT|I,CCI|CCI-000366,Rule-ID|SV-79179r1_rule,STIG-ID|OH12-1X-000226,Vuln-ID|V-64689"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000227 - OHS must not contain any robots.txt files - OHS must not contain any robots.txt files."
  info        : "Search engines are constantly at work on the Internet.  Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web-site content.  In turn, these search engines make the content they obtain and catalog available to any public web user.

To request that a well behaved search engine not crawl and catalog a server, the web server may contain a file called robots.txt for each web site hosted.  This file contains directories and files that the web server SA desires not be crawled or cataloged, but this file can also be used, by an attacker or poorly coded search engine, as a directory and file index to a site.  This information may be used to reduce an attacker's time searching and traversing the web site to find files that might be relevant.  If information on hosted web sites needs to be protected from search engines and public view, other methods must be used.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Remove any robots.txt files from the directories specified in the 'DocumentRoot' directives."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-000366,ITSG-33|SI-11,Rule-ID|SV-79181r1_rule,STIG-ID|OH12-1X-000227,Vuln-ID|V-64691"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000228 - OHS must prohibit anonymous FTP user access to interactive scripts."
  info        : "The directories containing the CGI scripts, such as PERL, must not be accessible to anonymous users via FTP. This applies to all directories that contain scripts that can dynamically produce web pages in an interactive manner (i.e., scripts based upon user-provided input). Such scripts contain information that could be used to compromise a web service, access system resources, or deface a web site.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure that all file transfers to the server are authenticated, authorized, and secure."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79183r1_rule,STIG-ID|OH12-1X-000228,Vuln-ID|V-64693"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000229 - The OHS DocumentRoot directory must be in a separate partition from the OHS ServerRoot directory."
  info        : "Application partitioning enables an additional security measure by securing user traffic under one security context, while managing system and application files under another. Web content is accessible to an anonymous web user. For such an account to have access to system files of any type is a major security risk that is avoidable and desirable. Failure to partition the system files from the web site documents increases risk of attack via directory traversal, or impede web site availability due to drive space exhaustion.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Search for the 'ServerRoot' directive at the OHS server configuration scope.

4. Move the directory associated with the 'DocumentRoot' directive to a partition different from the partition associated with the directory specified by the 'ServerRoot' directive."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|II,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79185r1_rule,STIG-ID|OH12-1X-000229,SWIFT-CSCv1|2.3,Vuln-ID|V-64695"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*(Document|Server)Root' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000230 - The OHS DocumentRoot directory must be on a separate partition from OS root partition."
  info        : "Application partitioning enables an additional security measure by securing user traffic under one security context, while managing system and application files under another. Web content is accessible to an anonymous web user. For such an account to have access to system files of any type is a major security risk that is avoidable and desirable. Failure to partition the system files from the web site documents increases risk of attack via directory traversal, or impede web site availability due to drive space exhaustion.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor that contains a '<VirtualHost>' directive.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Move the directory associated with the 'DocumentRoot' directive to a partition different from root partition."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-000366,ITSG-33|SI-11,Rule-ID|SV-79187r1_rule,STIG-ID|OH12-1X-000230,Vuln-ID|V-64697"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000231 - Remote authors or content providers must have all files scanned for viruses and malicious code before uploading files to the Document Root directory."
  info        : "Remote web authors should not be able to upload files to the DocumentRoot directory structure without virus checking and checking for malicious or mobile code. A remote web user whose agency has a Memorandum of Agreement (MOA) with the hosting agency and has submitted a DoD form 2875 (System Authorization Access Request (SAAR)) or an equivalent document will be allowed to post files to a temporary location on the server. All posted files to this temporary location will be scanned for viruses and content checked for malicious or mobile code. Only files free of viruses and malicious or mobile code will be posted to the appropriate Document Root directory.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Install anti-virus software on the OHS server and configure it to automatically scan for any viruses, malicious code, and mobile code."
  reference   : "CAT|II,CCI|CCI-000366,Rule-ID|SV-79189r1_rule,STIG-ID|OH12-1X-000231,Vuln-ID|V-64699"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000232 - A public OHS server must use TLS if authentication is required to host web sites - SSLEngine"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000366,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79191r2_rule,STIG-ID|OH12-1X-000232,SWIFT-CSCv1|2.1,Vuln-ID|V-64701"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000232 - A public OHS server must use TLS if authentication is required to host web sites - SSLProtocol"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000366,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79191r2_rule,STIG-ID|OH12-1X-000232,SWIFT-CSCv1|2.1,Vuln-ID|V-64701"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000232 - A public OHS server must use TLS if authentication is required to host web sites - SSLWallet"
  info        : "Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.

Without the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.

FIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000366,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79191r2_rule,STIG-ID|OH12-1X-000232,SWIFT-CSCv1|2.1,Vuln-ID|V-64701"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000233 - OHS hosted web sites must utilize ports, protocols, and services according to PPSM guidelines."
  info        : "Failure to comply with DoD ports, protocols, and services (PPS) requirements can result in compromise of enclave boundary protections and/or functionality of the automated information system (AIS).

The ISSM will ensure web servers are configured to use only authorized PPS in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1, Ports, Protocols, and Services Management (PPSM), and the associated Ports, Protocols, and Services (PPS) Assurance Category Assignments List.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'Listen' directive at the OHS server configuration scope.

3. Set the 'Listen' directive to '80' for http ports and '443' for https ports."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|III,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79193r1_rule,STIG-ID|OH12-1X-000233,SWIFT-CSCv1|2.3,Vuln-ID|V-64703"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*Listen' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000234 - OHS must not have the directive PlsqlDatabasePassword set in clear text."
  info        : "OHS supports the use of the module mod_plsql, which allows applications to be hosted that are PL/SQL-based.  To access the database, the module must have a valid username, password and database name.  To keep the password from an attacker, the password must not be stored in plain text, but instead, obfuscated.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. At shell prompt, set 'ORACLE_HOME' environment variable to $ORACLE_HOME location and export the variable.

2. At shell prompt, set 'PATH' environment variable to '$ORACLE_HOME/ohs/bin:$ORACLE_HOME/bin:$ORACLE_HOME/perl/bin:$PATH' and export the variable.

3a. If AIX OS, at shell prompt, set 'LIBPATH' environment variable to '$ORACLE_HOME/lib:$LIBPATH' and export the variable.
3b. If HP-UX OS, at shell prompt, set 'SHLIB_PATH' environment variable to '$ORACLE_HOME/lib:$SHLIB_PATH' and export the variable.
3c. If Solaris OS, at shell prompt, set 'LD_LIBRARY_PATH' environment variable to '$ORACLE_HOME/lib32:$LD_LIBRARY_PATH' and export the variable.
3d. If Linux or Other Unix OS, at shell prompt, set 'LD_LIBRARY_PATH' environment variable to '$ORACLE_HOME/lib:$LD_LIBRARY_PATH' and export the variable.

4. Change the present working directory to '$ORACLE_HOME/ohs/bin' (e.g., cd $ORACLE_HOME/ohs/bin).

5. For each .conf file found to be at fault, execute dadTool.pl script (e.g., 'perl dadTool.pl -f $DOMAIN_HOME/config/fmwconfig/compoennts/OHS/<componentName>/mod_plsql/dads.conf')."
  reference   : "800-171|3.4.2,800-53|CM-6,CAT|I,CCI|CCI-000366,CN-L3|8.1.10.6(d),CSF|PR.IP-1,ITSG-33|CM-6,NESA|T3.2.1,Rule-ID|SV-79111r1_rule,STIG-ID|OH12-1X-000234,SWIFT-CSCv1|2.3,Vuln-ID|V-64621"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*PlsqlDatabasePassword' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000235 - If WebLogic is not in use with OHS, OHS must have the include mod_wl_ohs.conf directive disabled at the server level."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'include mod_wl_ohs.conf' directive at the OHS server configuration scope.

3. Comment out the 'include mod_wl_ohs.conf' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78847r1_rule,STIG-ID|OH12-1X-000235,SWIFT-CSCv1|2.3,Vuln-ID|V-64357"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*include[\\s]*mod_wl_ohs\\.conf"
  expect      : "^[\\s]*include[\\s]*mod_wl_ohs\\.conf"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK_NOT
  description : "OH12-1X-000236 - If mod_plsql is not in use with OHS, OHS must have the include moduleconf/* directive disabled."
  info        : "A web server can provide many features, services, and processes. Some of these may be deemed unnecessary or too unsecure to run on a production DoD system.

The web server must provide the capability to disable, uninstall, or deactivate functionality and services that are deemed to be non-essential to the web server mission or can adversely impact server performance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'include moduleconf/*' directive at the OHS server configuration scope.

Note: The complete line may be 'include moduleconf/*.conf*'.

3. Comment out the 'include moduleconf/*' directive if it exists."
  reference   : "800-171|3.4.6,800-171|3.4.7,800-53|CM-7,CAT|II,CCI|CCI-000381,CN-L3|7.1.3.5(c),CN-L3|8.1.4.4(a),CSF|PR.IP-1,CSF|PR.PT-3,ITSG-33|CM-7,NIAv2|SS15a,Rule-ID|SV-78849r1_rule,STIG-ID|OH12-1X-000236,SWIFT-CSCv1|2.3,Vuln-ID|V-64359"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*include[\\s]*moduleconf/\\*"
  expect      : "^[\\s]*include[\\s]*moduleconf/\\*"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000240 - OHS must have the LoadModule ossl_module directive enabled to encrypt passwords during transmission."
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78897r1_rule,STIG-ID|OH12-1X-000240,SWIFT-CSCv1|2.6,Vuln-ID|V-64407"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000241 - OHS must use FIPS modules to encrypt passwords during transmission."
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78899r1_rule,STIG-ID|OH12-1X-000241,SWIFT-CSCv1|2.6,Vuln-ID|V-64409"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000242 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt passwords during transmission - SSLEngine"
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78901r2_rule,STIG-ID|OH12-1X-000242,SWIFT-CSCv1|2.1,Vuln-ID|V-64411"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000242 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt passwords during transmission - SSLProtocol"
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78901r2_rule,STIG-ID|OH12-1X-000242,SWIFT-CSCv1|2.1,Vuln-ID|V-64411"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000242 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to encrypt passwords during transmission - SSLWallet"
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78901r2_rule,STIG-ID|OH12-1X-000242,SWIFT-CSCv1|2.1,Vuln-ID|V-64411"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000243 - OHS must have the SSLCipherSuite directive enabled to encrypt passwords during transmission."
  info        : "Data used to authenticate, especially passwords, needs to be protected at all times, and encryption is the standard method for protecting authentication data during transmission. Data used to authenticate can be passed to and from the web server for many reasons.

Examples include data passed from a user to the web server through an HTTPS connection for authentication, the web server authenticating to a backend database for data retrieval and posting, and the web server authenticating to a clustered web server manager for an update."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-000197,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78903r1_rule,STIG-ID|OH12-1X-000243,SWIFT-CSCv1|2.1,Vuln-ID|V-64413"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000244 - OHS must have the LoadModule ossl_module directive enabled to perform RFC 5280-compliant certification path validation."
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78905r1_rule,STIG-ID|OH12-1X-000244,SWIFT-CSCv1|2.6,Vuln-ID|V-64415"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000245 - OHS must use FIPS modules to perform RFC 5280-compliant certification path validation."
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78907r1_rule,STIG-ID|OH12-1X-000245,SWIFT-CSCv1|2.6,Vuln-ID|V-64417"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000246 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to perform RFC 5280-compliant certification path validation - SSLEngine"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78909r2_rule,STIG-ID|OH12-1X-000246,SWIFT-CSCv1|2.1,Vuln-ID|V-64419"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000246 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to perform RFC 5280-compliant certification path validation - SSLProtocol"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78909r2_rule,STIG-ID|OH12-1X-000246,SWIFT-CSCv1|2.1,Vuln-ID|V-64419"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000246 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to perform RFC 5280-compliant certification path validation - SSLWallet"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78909r2_rule,STIG-ID|OH12-1X-000246,SWIFT-CSCv1|2.1,Vuln-ID|V-64419"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000247 - OHS must have the SSLCipherSuite directive enabled to perform RFC 5280-compliant certification path validation."
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000185,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78911r1_rule,STIG-ID|OH12-1X-000247,SWIFT-CSCv1|2.1,Vuln-ID|V-64421"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000248 - OHS must have the SSLVerifyClient directive set within each SSL-enabled VirtualHost directive to perform RFC 5280-compliant certification path validation."
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLVerifyClient' directive at the OHS server, virtual host, and/or directory configuration scope.

3. Set the 'SSLVerifyClient' directive to 'require', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-78913r1_rule,STIG-ID|OH12-1X-000248,Vuln-ID|V-64423"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*SSLVerifyClient"
  expect      : "^[\\s]*SSLVerifyClient[\\s]+[Rr]equire"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000249 - OHS must have the SSLCARevocationFile and SSLCRLCheck directives within each SSL-enabled VirtualHost directive set to perform RFC 5280-compliant certification path validation when using single certification revocation - SSLCARevocationFile"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Place the certificate revocation list file within the wallet directory (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

3. Search for the 'SSLCARevocationFile' directive at the OHS server and virtual host configuration scopes.

4. Set the 'SSLCARevocationFile' directive to the location (i.e., file within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the combined .crl file issued by the DoD CAs, add the directive if it does not exist.

5. Set the 'SSLCRLCheck' directive to 'On', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-78915r1_rule,STIG-ID|OH12-1X-000249,Vuln-ID|V-64425"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*SSLCARevocationFile' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000249 - OHS must have the SSLCARevocationFile and SSLCRLCheck directives within each SSL-enabled VirtualHost directive set to perform RFC 5280-compliant certification path validation when using single certification revocation - SSLCRLCheck"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Place the certificate revocation list file within the wallet directory (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

3. Search for the 'SSLCARevocationFile' directive at the OHS server and virtual host configuration scopes.

4. Set the 'SSLCARevocationFile' directive to the location (i.e., file within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the combined .crl file issued by the DoD CAs, add the directive if it does not exist.

5. Set the 'SSLCRLCheck' directive to 'On', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-78915r1_rule,STIG-ID|OH12-1X-000249,Vuln-ID|V-64425"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*SSLCRLCheck' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000250 - OHS must have SSLCARevocationPath and SSLCRLCheck directives within each SSL-enabled VirtualHost directive set to perform RFC 5280-compliant certification path validation when using multiple certification revocation - SSLCARevocationPath"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Place the certificate revocation list files within the wallet directory (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. After confirming that the Certificate Authorities that signed the certificate revocation list files are in the Oracle wallet, create the hash symbolic link files for each of the certificate revocation list files (e.g., $ORACLE_HOME/oracle_common/bin/orapki crl hash -crl $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet/<my_base64.crl> -symlink $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet -wallet $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet).

3. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

4. Search for the 'SSLCARevocationPath' directive at the OHS server and virtual host configuration scopes.

5. Set the 'SSLCARevocationPath' directive to the path (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) that contains the hash symbolic links that point to the certificate revocation list files issued by the DoD CAs that are in Base64 format; add the directive if it does not exist.

6. Set the 'SSLCRLCheck' directive to 'On', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-78917r1_rule,STIG-ID|OH12-1X-000250,Vuln-ID|V-64427"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*SSLCARevocationFile' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000250 - OHS must have SSLCARevocationPath and SSLCRLCheck directives within each SSL-enabled VirtualHost directive set to perform RFC 5280-compliant certification path validation when using multiple certification revocation - SSLCRLCheck"
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Place the certificate revocation list files within the wallet directory (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. After confirming that the Certificate Authorities that signed the certificate revocation list files are in the Oracle wallet, create the hash symbolic link files for each of the certificate revocation list files (e.g., $ORACLE_HOME/oracle_common/bin/orapki crl hash -crl $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet/<my_base64.crl> -symlink $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet -wallet $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores/wallet).

3. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

4. Search for the 'SSLCARevocationPath' directive at the OHS server and virtual host configuration scopes.

5. Set the 'SSLCARevocationPath' directive to the path (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) that contains the hash symbolic links that point to the certificate revocation list files issued by the DoD CAs that are in Base64 format; add the directive if it does not exist.

6. Set the 'SSLCRLCheck' directive to 'On', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-000185,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-78917r1_rule,STIG-ID|OH12-1X-000250,Vuln-ID|V-64427"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*SSLCRLCheck' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000251 - OHS must be integrated with a tool such as Oracle Access Manager to enforce a client-side certificate revocation check through the OCSP protocol."
  info        : "A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or online certificate status protocol (OCSP) responses.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Use a product such as Oracle Access Manager for authentication.

2.  Implement OCSP validation within that product."
  reference   : "CAT|II,CCI|CCI-000185,Rule-ID|SV-78919r1_rule,STIG-ID|OH12-1X-000251,Vuln-ID|V-64429"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000253 - OHS must have the LoadModule ossl_module directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data."
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78921r1_rule,STIG-ID|OH12-1X-000253,SWIFT-CSCv1|2.6,Vuln-ID|V-64431"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000254 - OHS must have the SSLFIPS directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data."
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78923r1_rule,STIG-ID|OH12-1X-000254,SWIFT-CSCv1|2.6,Vuln-ID|V-64433"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000255 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data - SSLEngine"
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78925r2_rule,STIG-ID|OH12-1X-000255,SWIFT-CSCv1|2.1,Vuln-ID|V-64435"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000255 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data - SSLProtocol"
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78925r2_rule,STIG-ID|OH12-1X-000255,SWIFT-CSCv1|2.1,Vuln-ID|V-64435"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000255 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data - SSLWallet"
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78925r2_rule,STIG-ID|OH12-1X-000255,SWIFT-CSCv1|2.1,Vuln-ID|V-64435"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000256 - OHS must have the SSLCipherSuite directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting stored data."
  info        : "Encryption is only as good as the encryption modules utilized.  Unapproved cryptographic module algorithms cannot be verified, and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when storing encrypted data and configuration settings."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78927r1_rule,STIG-ID|OH12-1X-000256,SWIFT-CSCv1|2.1,Vuln-ID|V-64437"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000257 - OHS must have the LoadModule ossl_module directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication."
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78929r1_rule,STIG-ID|OH12-1X-000257,SWIFT-CSCv1|2.6,Vuln-ID|V-64439"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000258 - OHS must have the SSLFIPS directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication."
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78931r1_rule,STIG-ID|OH12-1X-000258,SWIFT-CSCv1|2.6,Vuln-ID|V-64441"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000259 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication - SSLEngine"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1'; add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78933r2_rule,STIG-ID|OH12-1X-000259,SWIFT-CSCv1|2.1,Vuln-ID|V-64443"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000259 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication - SSLProtocol"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1'; add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78933r2_rule,STIG-ID|OH12-1X-000259,SWIFT-CSCv1|2.1,Vuln-ID|V-64443"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000259 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication - SSLWallet"
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1'; add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities; add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78933r2_rule,STIG-ID|OH12-1X-000259,SWIFT-CSCv1|2.1,Vuln-ID|V-64443"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000260 - OHS must have the SSLCipherSuite directive enabled to meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication."
  info        : "Encryption is only as good as the encryption modules utilized. Unapproved cryptographic module algorithms cannot be verified and cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised due to weak algorithms.

FIPS 140-2 is the current standard for validating cryptographic modules and NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.

The web server must provide FIPS-compliant encryption modules when authenticating users and processes."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-000803,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78935r1_rule,STIG-ID|OH12-1X-000260,SWIFT-CSCv1|2.1,Vuln-ID|V-64445"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000265 - OHS utilizing mobile code must meet DoD-defined mobile code requirements."
  info        : "Mobile code in hosted applications allows the developer to add functionality and displays to hosted applications that are fluid, as opposed to a static web page. The data presentation becomes more appealing to the user, is easier to analyze, and navigation through the hosted application and data is much less complicated.

Some mobile code technologies in use in today's applications are: Java, JavaScript, ActiveX, PDF, Postscript, Shockwave movies, Flash animations, and VBScript. The DoD has created policies that define the usage of mobile code on DoD systems. The usage restrictions and implementation guidance apply to both the selection and use of mobile code installed on organizational servers and mobile code downloaded and executed on individual workstations.

The web server may host applications that contain mobile code and therefore, must meet the DoD-defined requirements regarding the deployment and/or use of mobile code. This includes digitally signing applets in order to provide a means for the client to establish application authenticity.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Ensure that any mobile code used by any of the applications hosted on OHS follow DoD policies regarding the acquisition, development, and/or use."
  reference   : "CAT|II,CCI|CCI-001166,Rule-ID|SV-78937r1_rule,STIG-ID|OH12-1X-000265,Vuln-ID|V-64447"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000266 - OHS accounts accessing the directory tree, the shell, or other operating system functions and utilities must only be administrative accounts."
  info        : "As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. Only the system administrator needs access to all the system's capabilities, while the web administrator and associated staff require access and control of the web content and web server configuration files.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Remove any accounts and privileges that are unnecessary for OHS to run or for other functionality provided by the server."
  reference   : "CAT|I,CCI|CCI-001082,Rule-ID|SV-78939r1_rule,STIG-ID|OH12-1X-000266,Vuln-ID|V-64449"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000281 - OHS must have the DocumentRoot directive set to a separate partition from the OHS system files."
  info        : "A web server is used to deliver content on the request of a client. The content delivered to a client must be controlled, allowing only hosted application files to be accessed and delivered. To allow a client access to system files of any type is a major security risk that is entirely avoidable. Obtaining such access is the goal of directory traversal and URL manipulation vulnerabilities. To facilitate such access by misconfiguring the web document (home) directory is a serious error. In addition, having the path on the same drive as the system folder compounds potential attacks such as drive space exhaustion.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Set the 'DocumentRoot' directive to a location that is on a separate drive from the $ORACLE_HOME and $DOMAIN_HOME directories."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001084,ITSG-33|SI-11,Rule-ID|SV-78941r1_rule,STIG-ID|OH12-1X-000281,Vuln-ID|V-64451"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000282 - OHS must have the Directory directive accompanying the DocumentRoot directive set to a separate partition from the OHS system files."
  info        : "A web server is used to deliver content on the request of a client. The content delivered to a client must be controlled, allowing only hosted application files to be accessed and delivered. To allow a client access to system files of any type is a major security risk that is entirely avoidable. Obtaining such access is the goal of directory traversal and URL manipulation vulnerabilities. To facilitate such access by misconfiguring the web document (home) directory is a serious error. In addition, having the path on the same drive as the system folder compounds potential attacks such as drive space exhaustion.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for a '<Directory ${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/{$COMPONENT_NAME}/htdocs'>' directive or '<Directory>' directive pointing to the location of the directory specified in the 'DocumentRoot' directive at the OHS server and virtual host configuration scopes.

3. Set the '<Directory>' directive to the location specified in the 'DocumentRoot' directive; add the directive along with appropriate enclosed directives if it does not exist."
  reference   : "800-53|SC-3,CAT|II,CCI|CCI-001084,ITSG-33|SC-3,NESA|T3.4.1,NESA|T4.3.1,NESA|T4.3.2,Rule-ID|SV-78943r1_rule,STIG-ID|OH12-1X-000282,Vuln-ID|V-64453"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*<Directory' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000283 - OHS must have the Timeout directive properly set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'Timeout' directive at the OHS server and virtual host configuration scopes.

3. Set the 'Timeout' directive to a value of '30', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5(1),CAT|II,CCI|CCI-001094,ITSG-33|SC-5(1),Rule-ID|SV-78945r1_rule,STIG-ID|OH12-1X-000283,Vuln-ID|V-64455"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Tt]imeout/ { if ($0 ~ /^\\s*[Tt]imeout\\s+([1-9]|[12][0-9]|30)$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000284 - OHS must have the KeepAlive directive properly set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'KeepAlive' directive at the OHS server and virtual host configuration scopes.

3. Set the 'KeepAlive' directive to a value of 'On', add the directive if it does not exist."
  reference   : "800-53|SC-5(1),CAT|II,CCI|CCI-001094,ITSG-33|SC-5(1),Rule-ID|SV-78947r1_rule,STIG-ID|OH12-1X-000284,Vuln-ID|V-64457"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Kk]eep[Aa]live/ { if ($0 ~ /^\\s*[Kk]eep[Aa]live\\s+[Oo]n/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000285 - OHS must have the KeepAliveTimeout properly set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'KeepAliveTimeout' directive at the OHS server and virtual host configuration scopes.

3. Set the 'KeepAliveTimeout' directive to a value of '5', add the directive if it does not exist."
  reference   : "800-53|SC-5(1),CAT|II,CCI|CCI-001094,ITSG-33|SC-5(1),Rule-ID|SV-78949r1_rule,STIG-ID|OH12-1X-000285,Vuln-ID|V-64459"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Kk]eep[Aa]live[Tt]imeout/ { if ($0 ~ /^\\s*[Kk]eep[Aa]live[Tt]imeout\\s+[1-5]$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000286 - OHS must have the MaxKeepAliveRequests directive properly set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'MaxKeepAliveRequests' directive at the OHS server and virtual host configuration scopes.

3. Set the 'MaxKeepAliveRequests' directive to a value of '500', add the directive if it does not exist."
  reference   : "800-53|SC-5(1),CAT|II,CCI|CCI-001094,ITSG-33|SC-5(1),Rule-ID|SV-78951r1_rule,STIG-ID|OH12-1X-000286,Vuln-ID|V-64461"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Mm]ax[Kk]eep[Aa]live[Rr]equests/ { if ($0 ~ /^\\s*[Mm]ax[Kk]eep[Aa]live[Rr]equests\\s+([1-9]|[1-8][0-9]|9[0-9]|[1-4][0-9]{2}|500)$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000287 - OHS must have the ListenBacklog properly set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ListenBacklog' directive at the OHS server configuration scope.

3. Set the 'ListenBacklog' directive to a value equal to the Maximum Syn Connection Backlog network parameter of the OS; add the directive if it does not exist."
  reference   : "800-53|SC-5(1),CAT|II,CCI|CCI-001094,ITSG-33|SC-5(1),Rule-ID|SV-78953r1_rule,STIG-ID|OH12-1X-000287,Vuln-ID|V-64463"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*[Ll]isten[Bb]acklog[\\s]*"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000288 - OHS must have the LimitRequestBody directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitRequestBody' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'LimitRequestBody' directive to a value of '10240', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78955r2_rule,STIG-ID|OH12-1X-000288,Vuln-ID|V-64465"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Rr]equest[Bb]ody/ { if ($0 ~ /^\\s*[Ll]imit[Rr]equest[Bb]ody\\s+([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|10[01][0-9]{2}|102[0-3][0-9]|10240)$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000289 - OHS must have the LimitRequestFields directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitRequestFields' directive at the OHS server and virtual host configuration scopes.

3. Set the 'LimitRequestFields' directive to a value of '40', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78957r1_rule,STIG-ID|OH12-1X-000289,Vuln-ID|V-64467"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Rr]equest[Ff]ields/ { if ($0 ~ /^\\s*[Ll]imit[Rr]equest[Ff]ields\\s+([1-9]|[1-3][0-9]|40)$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000290 - OHS must have the LimitRequestFieldSize directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitRequestFieldSize' directive at the OHS server and virtual host configuration scopes.

3. Set the 'LimitRequestFieldSize' directive to a value of '1024', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78959r1_rule,STIG-ID|OH12-1X-000290,Vuln-ID|V-64469"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Rr]equest[Ff]ield[Ss]ize/ { if ($0 ~ /^\\s*[Ll]imit[Rr]equest[Ff]ield[Ss]ize\\s+([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|10[01][0-9]|102[0-4])$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000291 - OHS must have the LimitRequestLine directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitRequestLine' directive at the OHS server and virtual host configuration scopes.

3. Set the 'LimitRequestLine' directive to a value of '512', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78961r1_rule,STIG-ID|OH12-1X-000291,Vuln-ID|V-64471"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Rr]equest[Ll]ine/ { if ($0 ~ /^\\s*[Ll]imit[Rr]equest[Ll]ine\\s+([1-9]|[1-8][0-9]|9[0-9]|[1-4][0-9]{2}|50[0-9]|51[0-2])$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000292 - OHS must have the LimitXMLRequestBody directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitXMLRequestBody' directive at the OHS server and virtual host configuration scopes.

3. Set the 'LimitXMLRequestBody' directive to a value of '10240', add the directive if it does not exist.

Note: This vulnerability can be documented locally with the ISSM/ISSO if the site has operational reasons for the use of a higher value."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78963r1_rule,STIG-ID|OH12-1X-000292,Vuln-ID|V-64473"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Xx]ml[Rr]equest[Bb]ody/ { if ($0 ~ /^\\s*[Ll]imit[Xx]ml[Rr]equest[Bb]ody\\s+([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|10[01][0-9]{2}|102[0-3][0-9]|10240)$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000293 - OHS must have the LimitInternalRecursion directive set to restrict the ability of users to launch Denial of Service (DoS) attacks against other information systems or networks."
  info        : "A web server can limit the ability of the web server being used in a DoS attack through several methods. The methods employed will depend upon the hosted applications and their resource needs for proper operation.

An example setting that could be used to limit the ability of the web server being used in a DoS attack is bandwidth throttling."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'LimitInternalRecursion' directive at the server and virtual host configuration scopes.

3. Set the 'LimitInternalRecursion' directive to '55', add the directive if it does not exist."
  reference   : "800-53|SC-5,CAT|II,CCI|CCI-001094,CSF|DE.CM-1,CSF|PR.DS-4,ITSG-33|SC-5,NESA|T3.3.1,NIAv2|GS10c,NIAv2|GS8e,Rule-ID|SV-78965r1_rule,STIG-ID|OH12-1X-000293,Vuln-ID|V-64475"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { failures = 0; } /^\\s*[Ll]imit[Ii]nternal[Rr]ecursion/ { if ($0 ~ /^\\s*[Ll]imit[Ii]nternal[Rr]ecursion\\s+([1-9]|[1-4][0-9]|5[0-5])$/) { print $0,\"Pass\"} else { print $0,\"Fail\"; failures++; }}; END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000294 - OHS must have the LoadModule ossl_module directive enabled to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized."
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-78999r1_rule,STIG-ID|OH12-1X-000294,SWIFT-CSCv1|2.6,Vuln-ID|V-64509"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000295 - OHS must have the SSLFIPS directive enabled to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized."
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79001r1_rule,STIG-ID|OH12-1X-000295,SWIFT-CSCv1|2.6,Vuln-ID|V-64511"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000296 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized - SSLEngine"
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79003r2_rule,STIG-ID|OH12-1X-000296,SWIFT-CSCv1|2.1,Vuln-ID|V-64513"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000296 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized - SSLProtocol"
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79003r2_rule,STIG-ID|OH12-1X-000296,SWIFT-CSCv1|2.1,Vuln-ID|V-64513"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000296 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized - SSLWallet"
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79003r2_rule,STIG-ID|OH12-1X-000296,SWIFT-CSCv1|2.1,Vuln-ID|V-64513"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000297 - OHS must have the SSLCipherSuite directive enabled to implement required cryptographic protections using cryptographic modules complying with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance when encrypting data that must be compartmentalized."
  info        : "Cryptography is only as strong as the encryption modules/algorithms employed to encrypt the data.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.

NSA has developed Type 1 algorithms for protecting classified information. The Committee on National Security Systems (CNSS) National Information Assurance Glossary (CNSS Instruction No. 4009) defines Type 1 products as:
'Cryptographic equipment, assembly or component classified or certified by NSA for encrypting and decrypting classified and sensitive national security information when appropriately keyed. Developed using established NSA business processes and containing NSA-approved algorithms are used to protect systems requiring the most stringent protection mechanisms.'

Although persons may have a security clearance, they may not have a 'need-to-know' and are required to be separated from the information in question. The web server must employ NSA-approved cryptography to protect classified information from those individuals who have no 'need-to-know' or when encryption of compartmentalized data is required by data classification."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note:  Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002450,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79005r1_rule,STIG-ID|OH12-1X-000297,SWIFT-CSCv1|2.1,Vuln-ID|V-64515"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000298 - OHS must have the LoadModule ossl_module directive enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs)."
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79007r1_rule,STIG-ID|OH12-1X-000298,SWIFT-CSCv1|2.6,Vuln-ID|V-64517"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000299 - OHS must have the SSLFIPS directive enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs)."
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79009r1_rule,STIG-ID|OH12-1X-000299,SWIFT-CSCv1|2.6,Vuln-ID|V-64519"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000300 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) - SSLEngine"
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79011r2_rule,STIG-ID|OH12-1X-000300,SWIFT-CSCv1|2.1,Vuln-ID|V-64521"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000300 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) - SSLProtocol"
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79011r2_rule,STIG-ID|OH12-1X-000300,SWIFT-CSCv1|2.1,Vuln-ID|V-64521"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000300 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs) - SSLWallet"
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79011r2_rule,STIG-ID|OH12-1X-000300,SWIFT-CSCv1|2.1,Vuln-ID|V-64521"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000301 - OHS must have the SSLCipherSuite directive enabled so SSL requests can be processed with client certificates only issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs)."
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note:  Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002470,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79013r1_rule,STIG-ID|OH12-1X-000301,SWIFT-CSCv1|2.1,Vuln-ID|V-64523"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000302 - OHS must have the SSLVerifyClient directive enabled to only accept client certificates issued by DoD PKI or DoD-approved PKI Certification Authorities (CAs)."
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLVerifyClient' directive at the OHS server, virtual host, and/or directory configuration scope.

3. Set the 'SSLVerifyClient' directive to 'require', add the directive if it does not exist."
  reference   : "800-53|IA-5(2),CAT|II,CCI|CCI-002470,CSF|PR.AC-1,ITSG-33|IA-5(2),Rule-ID|SV-79015r1_rule,STIG-ID|OH12-1X-000302,Vuln-ID|V-64525"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*SSLVerifyClient"
  expect      : "^[\\s]*SSLVerifyClient[\\s]+[Rr]equire"
</custom_item>

<report type:"WARNING">
  description : "OH12-1X-000303 - OHS must use wallets that have only DoD certificate authorities defined."
  info        : "Non-DoD approved PKIs have not been evaluated to ensure that they have security controls and identity vetting procedures in place which are sufficient for DoD systems to rely on the identity asserted in the certificate. PKIs lacking sufficient security controls and identity vetting procedures risk being compromised and issuing certificates that enable adversaries to impersonate legitimate users.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "1. Go to the location of the OHS keystores (e.g., cd $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/keystores).

2. For each wallet directory located there, do the following:

a) Issue the command '$ORACLE_HOME/oracle_common/bin/orapki wallet display -wallet <wallet_directory>'.
b) Remove each Trusted Certificate from the wallet that is not an appropriate DoD Certificate Authority with the command '$ORACLE_HOME/oracle_common/bin/orapki wallet remove -wallet <wallet_directory> -dn <dn_of_the_trusted_certificate> -trusted_cert'."
  reference   : "CAT|II,CCI|CCI-002470,Rule-ID|SV-79017r1_rule,STIG-ID|OH12-1X-000303,Vuln-ID|V-64527"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<report type:"WARNING">
  description : "OH12-1X-000307 - OHS must be tuned to handle the operational requirements of the hosted application."
  info        : "A Denial of Service (DoS) can occur when the web server is so overwhelmed that it can no longer respond to additional requests. A web server not properly tuned may become overwhelmed and cause a DoS condition even with expected traffic from users. To avoid a DoS, the web server must be tuned to handle the expected traffic for the hosted applications.

NOTE: Nessus has not performed this check. Please review the benchmark to ensure target compliance."
  solution    : "Set the following directives appropriately for the server and application:
MaxClients
MPM Module
-worker (StartServers, MinSpareThreads, MaxSpareThreads, ThreadsPerChild)
Timeout
KeepAlive
KeepAliveTimeout
MaxKeepAliveRequests
ListenBacklog
LimitRequestBody
LimitRequestFields
LimitRequestFieldSize
LimitRequestLine
LimitXMLRequestBody
LimitInternalRecursion"
  reference   : "CAT|II,CCI|CCI-002385,Rule-ID|SV-79019r1_rule,STIG-ID|OH12-1X-000307,Vuln-ID|V-64529"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
</report>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000308 - OHS must have the LoadModule ossl_module directive enabled to prevent unauthorized disclosure of information during transmission."
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79031r1_rule,STIG-ID|OH12-1X-000308,SWIFT-CSCv1|2.6,Vuln-ID|V-64541"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000309 - OHS must have the SSLFIPS directive enabled to prevent unauthorized disclosure of information during transmission."
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79033r1_rule,STIG-ID|OH12-1X-000309,SWIFT-CSCv1|2.6,Vuln-ID|V-64543"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000310 - OHS must have the SSLEngine, SSLProtocol, SSLWallet directives enabled and configured to prevent unauthorized disclosure of information during transmission - SSLEngine"
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79035r2_rule,STIG-ID|OH12-1X-000310,SWIFT-CSCv1|2.1,Vuln-ID|V-64545"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000310 - OHS must have the SSLEngine, SSLProtocol, SSLWallet directives enabled and configured to prevent unauthorized disclosure of information during transmission - SSLProtocol"
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79035r2_rule,STIG-ID|OH12-1X-000310,SWIFT-CSCv1|2.1,Vuln-ID|V-64545"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000310 - OHS must have the SSLEngine, SSLProtocol, SSLWallet directives enabled and configured to prevent unauthorized disclosure of information during transmission - SSLWallet"
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79035r2_rule,STIG-ID|OH12-1X-000310,SWIFT-CSCv1|2.1,Vuln-ID|V-64545"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000311 - OHS must have the SSLCipherSuite directive enabled to prevent unauthorized disclosure of information during transmission."
  info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|I,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79037r1_rule,STIG-ID|OH12-1X-000311,SWIFT-CSCv1|2.1,Vuln-ID|V-64547"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Check for IfModule weblogic_module"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "egrep -i '^\s*<IfModule weblogic_module' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print} END {if (NR >= 1) print \"found\"}'"
      expect      : "^found$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000312 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SecureProxy directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

    Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

    If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

    2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

    3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79039r1_rule,STIG-ID|OH12-1X-000312,SWIFT-CSCv1|2.6,Vuln-ID|V-64549"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SecureProxy - \"s; l=0; p=0; } l>0 && /^\\s*SecureProxy\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000313 - OHS must have the WLSSLWallet directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79041r1_rule,STIG-ID|OH12-1X-000313,SWIFT-CSCv1|2.6,Vuln-ID|V-64551"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLSSLWallet - \"s; l=0; p=0; } l>0 && /^\\s*WLSSLWallet\\s+.*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000314 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WebLogicSSLVersion directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WebLogicSSLVersion' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WebLogicSSLVersion' directive to 'TLSv1_2 TLSv1_1 TLSv1', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79043r1_rule,STIG-ID|OH12-1X-000314,SWIFT-CSCv1|2.6,Vuln-ID|V-64553"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WebLogicSSLVersion - \"s; l=0; p=0; } l>0 && /^\\s*WebLogicSSLVersion\\s+TLSv1_2\\s+TLSv1_1\\s+TLSv1\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000315 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLProxySSL directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79045r1_rule,STIG-ID|OH12-1X-000315,SWIFT-CSCv1|2.6,Vuln-ID|V-64555"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLProxySSL - \"s; l=0; p=0; } l>0 && /^\\s*WLProxySSL\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "OH12-1X-000312 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SecureProxy directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79039r1_rule,STIG-ID|OH12-1X-000312,SWIFT-CSCv1|2.6,Vuln-ID|V-64549"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000313 - OHS must have the WLSSLWallet directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79041r1_rule,STIG-ID|OH12-1X-000313,SWIFT-CSCv1|2.6,Vuln-ID|V-64551"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000314 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WebLogicSSLVersion directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WebLogicSSLVersion' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WebLogicSSLVersion' directive to 'TLSv1_2 TLSv1_1 TLSv1', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79043r1_rule,STIG-ID|OH12-1X-000314,SWIFT-CSCv1|2.6,Vuln-ID|V-64553"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000315 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLProxySSL directive enabled to prevent unauthorized disclosure of information during transmission."
      info        : "Preventing the disclosure of transmitted information requires that the web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS).

Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster.

If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79045r1_rule,STIG-ID|OH12-1X-000315,SWIFT-CSCv1|2.6,Vuln-ID|V-64555"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000320 - OHS must have the LoadModule ossl_module directive enabled to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version."
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79047r1_rule,STIG-ID|OH12-1X-000320,SWIFT-CSCv1|2.6,Vuln-ID|V-64557"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000321 - OHS must have the SSLFIPS directive enabled to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version."
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79049r1_rule,STIG-ID|OH12-1X-000321,SWIFT-CSCv1|2.6,Vuln-ID|V-64559"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000322 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version - SSLEngine"
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79051r2_rule,STIG-ID|OH12-1X-000322,SWIFT-CSCv1|2.1,Vuln-ID|V-64561"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000322 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version - SSLProtocol"
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79051r2_rule,STIG-ID|OH12-1X-000322,SWIFT-CSCv1|2.1,Vuln-ID|V-64561"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000322 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version - SSLWallet"
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79051r2_rule,STIG-ID|OH12-1X-000322,SWIFT-CSCv1|2.1,Vuln-ID|V-64561"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000323 - OHS must have the SSLCipherSuite directive enabled to maintain the confidentiality of controlled information during transmission through the use of an approved TLS version."
  info        : "Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled.

NIST SP 800-52 defines the approved TLS versions for government applications."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002418,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79053r1_rule,STIG-ID|OH12-1X-000323,SWIFT-CSCv1|2.1,Vuln-ID|V-64563"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000324 - OHS must have the LoadModule ossl_module directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79055r1_rule,STIG-ID|OH12-1X-000324,SWIFT-CSCv1|2.6,Vuln-ID|V-64565"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000325 - OHS must have the SSLFIPS directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79057r1_rule,STIG-ID|OH12-1X-000325,SWIFT-CSCv1|2.6,Vuln-ID|V-64567"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000326 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during preparation for transmission - SSLEngine"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79059r2_rule,STIG-ID|OH12-1X-000326,SWIFT-CSCv1|2.1,Vuln-ID|V-64569"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000326 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during preparation for transmission - SSLProtocol"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79059r2_rule,STIG-ID|OH12-1X-000326,SWIFT-CSCv1|2.1,Vuln-ID|V-64569"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000326 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during preparation for transmission - SSLWallet"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79059r2_rule,STIG-ID|OH12-1X-000326,SWIFT-CSCv1|2.1,Vuln-ID|V-64569"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000327 - OHS must have the SSLCipherSuite directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79061r1_rule,STIG-ID|OH12-1X-000327,SWIFT-CSCv1|2.1,Vuln-ID|V-64571"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Check for IfModule weblogic_module"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "egrep -i '^\s*<IfModule weblogic_module' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print} END {if (NR >= 1) print \"found\"}'"
      expect      : "^found$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000328 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SecureProxy directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79063r1_rule,STIG-ID|OH12-1X-000328,SWIFT-CSCv1|2.6,Vuln-ID|V-64573"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SecureProxy - \"s; l=0; p=0; } l>0 && /^\\s*SecureProxy\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000329 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WLSSLWallet directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79065r1_rule,STIG-ID|OH12-1X-000329,SWIFT-CSCv1|2.6,Vuln-ID|V-64575"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLSSLWallet - \"s; l=0; p=0; } l>0 && /^\\s*WLSSLWallet\\s+.*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000330 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLSProxySSL directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79067r1_rule,STIG-ID|OH12-1X-000330,SWIFT-CSCv1|2.6,Vuln-ID|V-64577"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLProxySSL - \"s; l=0; p=0; } l>0 && /^\\s*WLProxySSL\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "OH12-1X-000328 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SecureProxy directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79063r1_rule,STIG-ID|OH12-1X-000328,SWIFT-CSCv1|2.6,Vuln-ID|V-64573"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000329 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WLSSLWallet directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79065r1_rule,STIG-ID|OH12-1X-000329,SWIFT-CSCv1|2.6,Vuln-ID|V-64575"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000330 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLSProxySSL directive enabled to maintain the confidentiality and integrity of information during preparation for transmission."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications.

Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002420,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79067r1_rule,STIG-ID|OH12-1X-000330,SWIFT-CSCv1|2.6,Vuln-ID|V-64577"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000331 - OHS must have the LoadModule ossl_module directive enabled to maintain the confidentiality and integrity of information during reception."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'LoadModule ossl_module' directive at the OHS server configuration scope.

3. Set the 'LoadModule ossl_module' directive to ''${PRODUCT_HOME}/modules/mod_ossl.so'', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79069r1_rule,STIG-ID|OH12-1X-000331,SWIFT-CSCv1|2.6,Vuln-ID|V-64579"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*LoadModule[\\s]+ossl_module"
  expect      : "^[\\s]*LoadModule[\\s]+ossl_module[\\s]+\"\\${PRODUCT_HOME}/modules/mod_ossl\\.so\""
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000332 - OHS must have the SSLFIPS directive enabled to maintain the confidentiality and integrity of information during reception."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/ssl.conf with an editor.

2. Search for the 'SSLFIPS' directive at the OHS server configuration scope.

3. Set the 'SSLFIPS' directive to 'On', add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79071r1_rule,STIG-ID|OH12-1X-000332,SWIFT-CSCv1|2.6,Vuln-ID|V-64581"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/ssl.conf"
  regex       : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
  expect      : "^[\\s]*SSLFIPS[\\s]+[Oo]n"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000333 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during reception - SSLEngine"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79073r2_rule,STIG-ID|OH12-1X-000333,SWIFT-CSCv1|2.1,Vuln-ID|V-64583"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { if(text==NULL){text=\"SSLEngine not found\"}; print FILENAME\":\"l\": \"text; } /^\\s*SSLEngine.*$/ { text=$0; } /^\\s*<VirtualHost/ { l=FNR;text=NULL }'"
  expect      : "Manual Review Required to verify which VirtualHost directives require SSL"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000333 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during reception - SSLProtocol"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79073r2_rule,STIG-ID|OH12-1X-000333,SWIFT-CSCv1|2.1,Vuln-ID|V-64583"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLProtocol - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLProtocol\\s+TLSv1\\.2\\s+TLSv1\\.1\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000333 - OHS must have the SSLEngine, SSLProtocol, and SSLWallet directives enabled and configured to maintain the confidentiality and integrity of information during reception - SSLWallet"
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.
Note: Does not apply to admin.conf.
2a. Search for the 'SSLEngine' directive at the OHS server, virtual host, and/or directory configuration scopes.
2b. Set the 'SSLEngine' directive to 'On', add the directive if it does not exist.
3a. Search for the 'SSLProtocol' directive at the OHS server configuration, virtual host, and/or directory levels.
3b. Set the 'SSLProtocol' directive to 'TLSv1.2 TLSv1.1', add the directive if it does not exist.
4a. Search for the 'SSLWallet' directive at the OHS server configuration, virtual host, and/or directory levels.
4b. Set the 'SSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains only the identity certificate for the host and DoD Certificate Authorities, add the directive if it does not exist."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79073r2_rule,STIG-ID|OH12-1X-000333,SWIFT-CSCv1|2.1,Vuln-ID|V-64583"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLWallet - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLWallet\\s+/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000334 - OHS must have the SSLCipherSuite directive enabled to maintain the confidentiality and integrity of information during reception."
  info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
  solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that requires an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SSLCipherSuite' directive at the OHS server, virtual host, and/or directory configuration scopes.

3. Set the 'SSLCipherSuite' directive to 'SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA', add the directive if it does not exist.

Note: Ciphers may be removed from the list above per the organization's requirements or if vulnerabilities are found with a specific cipher."
  reference   : "800-171|3.1.13,800-53|SC-8(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.DS-2,CSF|PR.DS-5,ITSG-33|SC-8(2),ITSG-33|SC-9(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79075r1_rule,STIG-ID|OH12-1X-000334,SWIFT-CSCv1|2.1,Vuln-ID|V-64585"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk '/^\\s*<\\/VirtualHost>/ { s = \"Passed\"; if (e!=1 || p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SSLCipherSuite - \"s; l=0; e=0; p=0 } l>0 && /^\\s*SSLEngine\\s*[Oo][Nn]\\s*$/ { e=1 } l>0 && /^\\s*SSLCipherSuite\\s+SSL_RSA_WITH_3DES_EDE_CBC_SHA,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_CBC_SHA,RSA_WITH_AES_128_CBC_SHA256,RSA_WITH_AES_256_CBC_SHA256,RSA_WITH_AES_128_GCM_SHA256,RSA_WITH_AES_256_GCM_SHA384,ECDHE_ECDSA_WITH_AES_128_CBC_SHA,ECDHE_ECDSA_WITH_AES_256_CBC_SHA,ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,ECDHE_RSA_WITH_AES_128_CBC_SHA,ECDHE_RSA_WITH_AES_256_CBC_SHA\\s*$/ { p=1 } /^\\s*<VirtualHost/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
  expect      : "No failures found"
</custom_item>

<if>
  <condition type:"AND">
    <custom_item>
      type        : CMD_EXEC
      description : "Check for IfModule weblogic_module"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "egrep -i '^\s*<IfModule weblogic_module' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print} END {if (NR >= 1) print \"found\"}'"
      expect      : "^found$"
    </custom_item>
  </condition>

  <then>
    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000335 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SSLSecureProxy directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79077r1_rule,STIG-ID|OH12-1X-000335,SWIFT-CSCv1|2.6,Vuln-ID|V-64587"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": SecureProxy - \"s; l=0; p=0; } l>0 && /^\\s*SecureProxy\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000336 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WLSSLWallet directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79079r1_rule,STIG-ID|OH12-1X-000336,SWIFT-CSCv1|2.6,Vuln-ID|V-64589"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLSSLWallet - \"s; l=0; p=0; } l>0 && /^\\s*WLSSLWallet\\s+.*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>

    <custom_item>
      type        : CMD_EXEC
      description : "OH12-1X-000337 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLProxySSL directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79081r1_rule,STIG-ID|OH12-1X-000337,SWIFT-CSCv1|2.6,Vuln-ID|V-64591"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
      cmd         : "find /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1 -iname \"*.conf\" ! -iname \"admin.conf\" -print | xargs awk 'l>0 && /^\\s*<\\/IfModule>/ { s = \"Passed\"; if (p!=1) { s = \"Failed\"; failed += 1 }; print FILENAME\":\"l\": WLProxySSL - \"s; l=0; p=0; } l>0 && /^\\s*WLProxySSL\\s+[Oo][Nn]\\s*$/ { p=1 } /^\\s*<IfModule weblogic_module>\\s*$/ { l=FNR } END { if (failed >= 1) { print \"Failures found, please review output\" } else { print \"No failures found\" } }'"
      expect      : "No failures found"
    </custom_item>
  </then>

  <else>
    <report type:"PASSED">
      description : "OH12-1X-000335 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the SSLSecureProxy directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'SecureProxy' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'SecureProxy' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79077r1_rule,STIG-ID|OH12-1X-000335,SWIFT-CSCv1|2.6,Vuln-ID|V-64587"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000336 - If using the WebLogic Web Server Proxy Plugin and configuring end-to-end SSL, OHS must have the WLSSLWallet directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLSSLWallet' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLSSLWallet' directive to the location (i.e., folder within $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/keystores) of the Oracle wallet created via orapki with AES Encryption (-compat_v12 parameters) that contains the certificate chain served by the WebLogic host/port combination, add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79079r1_rule,STIG-ID|OH12-1X-000336,SWIFT-CSCv1|2.6,Vuln-ID|V-64589"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>

    <report type:"PASSED">
      description : "OH12-1X-000337 - If using the WebLogic Web Server Proxy Plugin and configuring SSL termination at OHS, OHS must have the WLProxySSL directive enabled to maintain the confidentiality and integrity of information during reception."
      info        : "Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.

Protecting the confidentiality and integrity of received information requires that application servers take measures to employ approved cryptography in order to protect the information during transmission over the network. This is usually achieved through the use of Transport Layer Security (TLS), SSL VPN, or IPsec tunnel.

The web server must utilize approved encryption when receiving transmitted data."
      solution    : "1. Open every .conf file (e.g., ssl.conf) included in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor that contains an SSL-enabled '<VirtualHost>' directive.

2. Search for the 'WLProxySSL' directive within an '<IfModule weblogic_module>' at the virtual host configuration scope.

3. Set the 'WLProxySSL' directive to 'On', add the directive if it does not exist."
      reference   : "800-171|3.1.13,800-53|AC-17(2),CAT|II,CCI|CCI-002422,CN-L3|7.1.2.7(g),CN-L3|7.1.3.1(d),CN-L3|8.1.4.1(c),CSF|PR.AC-3,CSF|PR.PT-4,ITSG-33|AC-17(2),NESA|T5.4.2,NIAv2|AM37,Rule-ID|SV-79081r1_rule,STIG-ID|OH12-1X-000337,SWIFT-CSCv1|2.6,Vuln-ID|V-64591"
      see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
    </report>
  </else>
</if>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000346 - OHS must display a default hosted application web page, not a directory listing, when a requested web page cannot be found."
  info        : "The goal is to completely control the web user's experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end.

Enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server's directory structure by locating directories without default pages. In the scenario, the web server will display to the user a listing of the files in the directory being accessed. By having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'DocumentRoot' directives at the server and virtual host configuration scopes.

3. Go to the location specified as the value for each 'DocumentRoot' directive (e.g., cd $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/ohs1/htdocs) and its subdirectories.

4. Create a standard or empty index.html file (e.g., echo > index.html) in the directory specified for 'DocumentRoot' and any subdirectories it may have."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78967r1_rule,STIG-ID|OH12-1X-000346,Vuln-ID|V-64477"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*DocumentRoot' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000347 - OHS must have the ServerSignature directive disabled."
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'ServerSignature' directive at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ServerSignature' directive to a value of 'Off', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78969r1_rule,STIG-ID|OH12-1X-000347,Vuln-ID|V-64479"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*ServerSignature' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "[^#][\\s]*[Ss]erver[Ss]ignature[\\s]+[Oo]ff"
</custom_item>

<custom_item>
  type        : FILE_CONTENT_CHECK
  description : "OH12-1X-000348 - OHS must have the ServerTokens directive set to limit the response header."
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf with an editor.

2. Search for the 'ServerTokens' directive at the OHS server configuration scope.

3. Set the 'ServerTokens' directive to a value of 'Custom DoD-Web-Server', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78971r1_rule,STIG-ID|OH12-1X-000348,Vuln-ID|V-64481"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "file".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "file".
  file        : "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/httpd.conf"
  regex       : "^[\\s]*[Ss]erver[Tt]okens[\\s]+[Cc]ustom[\\s]+Dod-Web-Server"
  expect      : "^[\\s]*[Ss]erver[Tt]okens[\\s]+[Cc]ustom[\\s]+Dod-Web-Server"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000349 - OHS must have the Alias /error directive defined to reference the directory accompanying the ErrorDocument directives to minimize the identity of OHS, patches, loaded modules, and directory paths in warning and error messages displayed to clients."
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'Alias /error/ '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error/'' directive at the OHS server and virtual host configuration scopes.

3. Set the 'Alias' directive to '/error/ '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error/'', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78973r1_rule,STIG-ID|OH12-1X-000349,Vuln-ID|V-64483"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*Alias /error/' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "[^#][\\s]*Alias /error/ \"\\${ORACLE_INSTANCE}/config/fmwconfig/components/\\${COMPONENT_TYPE}/instances/\\${COMPONENT_NAME}/error/\""
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - AllowOverride"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t = $0; } d == 1 && /^\\s*[Aa]llow[Oo]verride/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Aa]llow[Oo]verride\\s+[Nn]one/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - Options"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t = $0; } d == 1 && /^\\s*[Oo]ptions/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Oo]ptions\\s+[Nn]one/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - Order"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t = $0; } d == 1 && /^\\s*[Oo]rder/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Oo]rder\\s+[Aa]llow,\\s*[Dd]eny/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - Allow"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t = $0; } d == 1 && /^\\s*[Aa]llow/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Aa]llow\\s+[Ff]rom\\s+[Aa]ll/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - LimitExcept"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t = $0; } d == 1 && /^\\s*<[Ll]imit[Ee]xcept\\s+GET\\s+POST>/ { f = $0; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*<[Ll]imit[Ee]xcept\\s+GET\\s+POST>/) { print t,f,\"Pass\"} else { print t,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000350 - OHS must have the permissions set properly via the Directory directive accompanying the ErrorDocument directives to minimize improper access to the warning and error messages displayed to clients - LimitExcept > Deny"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every.conf file (e.g., ssl.conf) included in it with an editor.
2. Search for the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive at the OHS server and virtual host configuration scopes.
3. Set the '<Directory>' directive to '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'', add the directive if it does not exist.
4a. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'AllowOverride' directive to 'None', add the directive if it does not exist.
4b. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Options' directive to 'None', add the directive if it does not exist.
4c. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Order' directive to 'allow, deny', add the directive if it does not exist.
4d. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the 'Allow' directive to 'from all', add the directive if it does not exist.
4e. Within the '<Directory> '${ORACLE_INSTANCE}/config/fmwconfig/components/${COMPONENT_TYPE}/instances/${COMPONENT_NAME}/error'' directive, set the '<LimitExcept>' directive to 'GET POST', add the directive if it does not exist.
4e1. Within the '<LimitExcept GET POST>' directive, set the 'Deny' directive to 'from all', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78975r2_rule,STIG-ID|OH12-1X-000350,Vuln-ID|V-64485"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "awk 'BEGIN { d = 0; f = \"\"; failures = 0; } /<Directory \"\\${ORACLE_INSTANCE}\\/config\\/fmwconfig\\/components\\/\\${COMPONENT_TYPE}\\/instances\\/\\${COMPONENT_NAME}\\/error\">/ { d = 1; t1 = $0; } d == 1 && /^\\s*<[Ll]imit[Ee]xcept\\s+GET\\s+POST>/ { t2 = $0; d = 2; } /^\\s*[Dd]eny/ { f = $0; } d == 2 && /<\\/[Ll]imit[Ee]xcept>/ { d = 1; } d == 1 && /<\\/Directory>/ { if (f ~ /^\\s*[Dd]eny\\s+[Ff]rom\\s+[Aa]ll/) { print t1,t2,f,\"Pass\"} else { print t1,t2,f,\"Fail\"; failures++; }; d = 0; t = \"\"; f = \"\"; } END { print \"Number of failures: \" failures }' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Number of failures: 0"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 400"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+400\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 401"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+401\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 403"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+403\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 404"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+404\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 405"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+405\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 408"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+408\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 410"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+410\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 411"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+411\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 412"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+412\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 413"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+413\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 414"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+414\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 415"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+415\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 500"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+500\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 501"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+501\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 502"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+502\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 503"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+503\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000351 - OHS must have defined error pages for common error codes that minimize the identity of the web server, patches, loaded modules, and directory paths - ErrorDocument 506"
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for 'ErrorDocument' directives at the OHS server, virtual host, and directory configuration scopes.

3. Set the 'ErrorDocument' directives for HTTP errors 400, 401, 403 - 405, 408, 410 - 415, 500 - 503, and 506 (e.g., ErrorDocument 400 HTTP_BAD_REQUEST_en.html) to files that minimize the identity of the web server, patches, loaded modules, and directory paths, add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78977r1_rule,STIG-ID|OH12-1X-000351,Vuln-ID|V-64487"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument\\s+506\\s+' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf | awk '{print $0, \"Pass\"} END {if (NR == 0) print \"Fail\"}'"
  expect      : "Pass$"
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000352 - OHS must have production information removed from error documents to minimize the identity of OHS, patches, loaded modules, and directory paths in warning and error messages displayed to clients."
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server, backend systems being accessed, and plug-ins or modules being used.

Web servers will often display error messages to client users displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. The information given to users must be minimized to not aid in the blueprinting of the web server.

NOTE: Nessus has provided the target output to assist in reviewing the benchmark to ensure target compliance."
  solution    : "1. Go to the directory specified by the 'Alias /error/' directive in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf.  (e.g., cd $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/error).

2. Change the extension of each file located in $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/error from .html.var to .html (e.g., mv HTTP_NOT_FOUND.hmtl.var HTTP_NOT_FOUND_en.html).

3. Modify the content of each file to be static such that mod_include and mod_negotiation are not needed and that no OHS product information is discernable by a user encountering the error.

4. Set the appropriate 'ErrorDocument' directives in $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf to reference the appropriate file in $DOMAIN_HOME/config/fmwconfig/components/OHS/instances/<componentName>/httpd.conf, add the directives if they do not exist."
  reference   : "800-53|SI-11,CAT|III,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78979r1_rule,STIG-ID|OH12-1X-000352,Vuln-ID|V-64489"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep '^\\s*ErrorDocument' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "Manual Review Required"
  severity    : MEDIUM
</custom_item>

<custom_item>
  type        : CMD_EXEC
  description : "OH12-1X-000353 - Debugging and trace information used to diagnose OHS must be disabled."
  info        : "Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed. Since this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information."
  solution    : "1. Open $DOMAIN_HOME/config/fmwconfig/components/OHS/<componentName>/httpd.conf and every .conf file (e.g., ssl.conf) included in it with an editor.

2. Search for the 'TraceEnable' directive at the OHS server and virtual host configuration scopes.

3. Set the 'TraceEnable' directive to a value of 'Off', add the directive if it does not exist."
  reference   : "800-53|SI-11,CAT|II,CCI|CCI-001312,ITSG-33|SI-11,Rule-ID|SV-78981r1_rule,STIG-ID|OH12-1X-000353,Vuln-ID|V-64491"
  see_also    : "https://dl.dod.cyber.mil/wp-content/uploads/stigs/zip/U_Oracle_HTTP_Server_12-1-3_V1R6_STIG.zip"
# Note: Variable @DOMAIN_HOME@ replaced with "/oracle/Middleware/Oracle_Home/user_projects/domains/base_domain" in field "cmd".
# Note: Variable @COMPONENT_NAME@ replaced with "ohs1" in field "cmd".
  cmd         : "egrep -i '^\\s*TraceEnable' /oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/config/fmwconfig/components/OHS/ohs1/*.conf"
  expect      : "[^#][\\s]*[Tt]race[Ee]nable[\\s]+[Oo]ff"
</custom_item>

</check_type>
